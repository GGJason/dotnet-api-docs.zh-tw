### <a name="accessibility-improvements-in-windows-forms-controls"></a>Windows Form 控制項的協助工具增強功能

|   |   |
|---|---|
|詳細資料|Windows Form 會增進如何將它用於協助工具技術，以更佳的支援 Windows Form 的客戶。 這些需求包括下列變更：<ul><li>若要改善顯示高對比模式期間的變更。</li><li>變更以增進屬性瀏覽器體驗。 屬性瀏覽器的增強功能包括：</li><li>透過各種下拉式選取視窗進行更佳的鍵盤導覽。</li><li>減少不必要的定位停駐點。</li><li>更適當地報告控制項類型。</li><li>改善的朗讀程式行為。</li><li>若要在控制項中實作遺漏的使用者可存取性模式變更。</li></ul>|
|建議|<strong>如何選擇加入或退出這些變更</strong>為了讓應用程式可受益於這些變更，它必須在.NET Framework 4.7.1 上執行或更新版本。 應用程式可以從這些變更的其中一種下列獲益：<ul><li>它會將目標.NET Framework 4.7.1 重新編譯。 這些協助工具變更為預設會在目標為.NET Framework 4.7.1 的 Windows Form 應用程式上啟用或更新版本。</li><li>從舊版的協助工具行為選擇從中加入下列[AppContext 參數](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md)至<code>&lt;runtime&gt;</code>> 一節的 app.config 檔案，並將它設定為<code>false</code>，如下列範例所示。</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>.NET Framework 4.7.1 為目標的應用程式或更新版本並想要保留舊版協助工具的行為也可以選擇使用舊版的協助工具功能的明確設為這個 AppContext 參數<code>true</code>。如需使用者介面自動化的概觀，請參閱[UI 自動化概觀](~/docs/framework/ui-automation/ui-automation-overview.md)。<strong>新增支援使用者介面自動化模式和屬性</strong>協助工具用戶端可以利用新 WinForms 協助工具功能藉由使用通用的公開描述叫用模式。 這些模式不是 WinForms 特定。 比方說，協助工具用戶端可以呼叫 QueryInterface 方法 Cwnd 介面 (MAAS) 取得的 IServiceProvider 介面。 如果此介面可供使用，用戶端可以使用其 QueryService 方法來要求 IAccessibleEx 介面。 如需詳細資訊，請參閱[從用戶端使用的 IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx)。 從.NET Framework 4.7.1，IServiceProvider 開始和[IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) （如果適用的話） 可供 WinForms 協助工具物件。 .NET Framework 4.7.1 新增下列使用者介面自動化模式和屬性的支援：<ul><li><code>T:System.Windows.Forms.ToolStripSplitButton</code>和<code>T:System.Windows.Forms.ComboBox</code>控制支援[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code>控制項有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)屬性值<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</li><li><code>T:System.Windows.Forms.ToolStripItem</code>支援[名稱](xref:System.Windows.Automation.AutomationElement.NameProperty)屬性和[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</li><li><code>T:System.Windows.Forms.ToolStripDropDownItem</code>支援<xref:System.Windows.Forms.AccessibleEvents>指出 StateChange 和 NameChange 時展開或摺疊下拉式清單。</li><li><code>T:System.Windows.Forms.ToolStripDropDownButton</code>控制項有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)屬性值為<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</li><li><code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code>支援[切換模式](xref:System.Windows.Automation.TogglePattern)。</li><li><code>T:System.Windows.Forms.NumericUpDown</code>和<code>T:System.Windows.Forms.DomainUpDown</code>控制支援[名稱](xref:System.Windows.Automation.AutomationElement.NameProperty)，而且有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md)的<xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>。</li></ul><strong>對 PropertyGrid 控制的改進</strong>的.NET Framework 4.7.1 PropertyBrowser 控制項中加入下列改良功能：<ul><li><strong>詳細資料</strong>時，使用者輸入不正確的值中會顯示 [錯誤] 對話方塊中的按鈕<code>T:System.Windows.Forms.PropertyGrid</code>支援[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)、 狀態與名稱變更通知和[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)屬性值為<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</li><li>[訊息] 窗格會顯示當<strong>詳細資料</strong>展開按鈕的 [錯誤] 對話方塊現在鍵盤存取，並可讓 [朗讀程式] 通知錯誤訊息的內容。</li><li><xref:System.Windows.Forms.AccessibleRole>中的資料列<code>T:System.Windows.Forms.PropertyGrid</code>控制項已從&quot;列&quot;至&quot;儲存格&quot;。 資料格會對應至 UIA ControlType &quot;DataItem&quot;，可讓它支援適當的鍵盤快速鍵和朗讀程式的公告。</li><li><code>T:System.Windows.Forms.PropertyGrid</code>控制哪些代表標頭項目時的資料列<code>T:System.Windows.Forms.PropertyGrid</code>控制項有<code>P:System.Windows.Forms.PropertySort</code>屬性設定為<code>F:System.Windows.Forms.PropertySory.Categorized</code>有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)屬性值 <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></li><li><code>T:System.Windows.Forms.PropertyGrid</code>控制哪些代表標頭項目時的資料列<code>T:System.Windows.Forms.PropertyGrid</code>控制項有<code>P:System.Windows.Forms.PropertySort</code>屬性設定為<code>F:System.Windows.Forms.PropertySory.Categorized</code>支援[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</li><li>改善的鍵盤巡覽，格線之間工具列。 按下&quot;Shift Tab&quot;現在會選取第一個工具列按鈕，而不是整個工具列</li><li><code>T:System.Windows.Forms.PropertyGrid</code> 在高對比模式中顯示的控制項現在繪製目前的焦點矩形以圍繞對應的工具列按鈕<code>P:System.Windows.Forms.PropertySort</code>屬性值。</li><li><code>T:System.Windows.Forms.PropertyGrid</code> 顯示的高對比模式，並使用控制項<code>P:System.Windows.Forms.PropertySort</code>屬性設定為<code>F:System.Windows.Forms.PropertySory.Categorized</code>會立即顯示高對比的色彩中的類別標頭的背景。</li><li><code>T:System.Windows.Forms.PropertyGrid</code> 控制項最好是用來區別具有焦點的工具列項目和工具列項目表示的目前值<code>P:System.Windows.Forms.PropertySort</code>屬性。 此修正程式是由高對比變更及非高對比案例的變更所組成。</li><li><code>T:System.Windows.Forms.PropertyGrid</code> 控制工具列項目表示的目前值<code>P:System.Windows.Forms.PropertySort</code>屬性支援[切換模式](xref:System.Windows.Automation.TogglePattern)。</li><li>改善 [朗讀程式] 區分對齊選擇器中選取的對齊方式的支援。</li><li>當空<code>T:System.Windows.Forms.PropertyGrid</code>表單上顯示控制項，它現在會接收的焦點的位置之前它不會。</li></ul><strong>作業系統定義之色彩在高對比佈景主題中的使用</strong><ul><li><code>T:System.Windows.Forms.Button</code> 和<code>T:System.Windows.Forms.CheckBox</code>控制與<code>P:System.Windows.Forms.Control.FlatStyle</code>設<xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>，這是預設樣式，現在使用高對比佈景主題時選取的作業系統定義之色彩。 之前，文字和背景色彩不對比，而且難以讀取。</li><li><code>T:System.Windows.Forms.Button</code><code>T:System.Windows.Forms.CheckBox</code>， <code>T:System.Windows.Forms.RadioButton</code>， <code>T:System.Windows.Forms.Label</code>，<code>T:System.Windows.Forms.LinkLabel</code>和<code>T:System.Windows.Forms.GroupBox</code>與<code>P:System.Windows.Forms.Control.Enabled</code>設<em>false</em>，用來呈現在高對比佈景主題，導致對低對比中的文字的陰影的色彩背景。 現在這些控制項使用&quot;已停用文字&quot;OS 所定義的色彩。 此修正程式套用至控制項和<code>P:System.Windows.Forms.Control.FlatStyle</code>屬性以外的值設定<code>F:System.Windows.Forms.FlatStyle.System</code>。 第二個控制項所呈現的 OS。</li><li><code>T:System.Windows.Forms.DataGridView</code> 現在會呈現具有目前焦點所在的儲存格內容周圍的顯示矩形。 先前，這不是顯示在特定的高對比佈景主題。</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> 控制與<code>P:System.Windows.Forms.ToolStripItem.Enabled</code>屬性設定為<em>false</em>現在使用&quot;已停用文字&quot;OS 所定義的色彩。</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> 控制與<code>P:System.Windows.Forms.ToolStripItem.Checked</code>屬性設定為<em>true</em>現在呈現相關聯的核取記號，以相反的系統色彩。  先前的核取記號色彩已不對照足夠，且不可見。 在高對比佈景主題中。</li></ul>注意： Windows10 變更某些高對比系統色彩的值。 Windows Form 架構為基礎的 Win32 架構。 獲得最佳的體驗，在最新的 Windows 版本上執行，並加入最新的 OS 變更測試應用程式中加入資訊清單檔案，並取消註解下列程式碼：<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>改良的鍵盤導覽</strong><ul><li>當<code>T:System.Windows.Forms.ComboBox</code>控制項有<code>P:System.Windows.Forms.ComboBox.DropDownStyle</code>設<code>F:System.Windows.Forms.DropDownStyle.DropDownList</code>，且索引標籤中的第一個控制項的排序是在表單中，而它現在顯示焦點矩形，使用鍵盤來開啟父表單時。 之前這項變更，鍵盤焦點在這個控制項，但焦點指標不轉譯。</li></ul><strong>改善的朗讀程式支援</strong><ul><li><code>T:System.Windows.Forms.MonthCalendar</code>控制項新增至存取控制，包括要朗讀程式閱讀控制項的值，當先前無法的能力的輔助技術的支援。</li><li><code>T:System.Windows.Forms.CheckedListBox</code>控制項現在會告知 [朗讀程式] 時<code>P:System.Windows.Forms.CheckState</code>屬性已變更。 之前，[朗讀程式] 未收到通知，因此使用者不會收到通知，<code>P:System.Windows.Forms.CheckState</code>已經更新。</li><li><code>T:System.Windows.Forms.LinkLabel</code>控制項變更通知的文字在控制項中的 [朗讀程式] 的方式。 [朗讀程式] 之前，兩次宣布這段文字，並讀取&quot; &amp; &quot;符號為實際的文字，即使它們不會對使用者顯示。 重複的文字已移除了 [朗讀程式] 公告，以及不必要&quot; &amp; &quot;符號。</li><li><code>T:System.Windows.Forms.DataGridViewCell</code>控制項正確現在類型報表 [朗讀程式] 和其他輔助技術的唯讀狀態。</li><li>[朗讀程式] 現在就可以讀取系統功能表中的子視窗的[多重文件介面](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md)應用程式。</li><li>[朗讀程式] 現在就可以讀取<code>T:System.Windows.Forms.ToolStripMenuItem</code>控制與<code>P:System.Windows.Forms.ToolStripItem.Enabled</code>屬性設定為<em>false</em>。 [朗讀程式] 之前無法將焦點放在已停用的功能表項目，來讀取內容。</li></ul>|
|範圍|主要|
|版本|4.7.1|
|類型|正在重定目標|
|受影響的 API|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

