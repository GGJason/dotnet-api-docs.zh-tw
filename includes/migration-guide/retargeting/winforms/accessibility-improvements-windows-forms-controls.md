### <a name="accessibility-improvements-in-windows-forms-controls"></a><span data-ttu-id="423b8-101">Windows Form 控制項的協助工具增強功能</span><span class="sxs-lookup"><span data-stu-id="423b8-101">Accessibility improvements in Windows Forms controls</span></span>

|   |   |
|---|---|
|<span data-ttu-id="423b8-102">詳細資料</span><span class="sxs-lookup"><span data-stu-id="423b8-102">Details</span></span>|<span data-ttu-id="423b8-103">Windows Form 會增進如何將它用於協助工具技術，以更佳的支援 Windows Form 的客戶。</span><span class="sxs-lookup"><span data-stu-id="423b8-103">Windows Forms is improving how it works with accessibility technologies to better support Windows Forms customers.</span></span> <span data-ttu-id="423b8-104">這些需求包括下列變更：</span><span class="sxs-lookup"><span data-stu-id="423b8-104">These include the following changes:</span></span><ul><li><span data-ttu-id="423b8-105">若要改善顯示高對比模式期間的變更。</span><span class="sxs-lookup"><span data-stu-id="423b8-105">Changes to improve display during High Contrast mode.</span></span></li><li><span data-ttu-id="423b8-106">變更以增進屬性瀏覽器體驗。</span><span class="sxs-lookup"><span data-stu-id="423b8-106">Changes to improve the property browser experience.</span></span> <span data-ttu-id="423b8-107">屬性瀏覽器的增強功能包括：</span><span class="sxs-lookup"><span data-stu-id="423b8-107">Property browser improvements include:</span></span></li><li><span data-ttu-id="423b8-108">透過各種下拉式選取視窗進行更佳的鍵盤導覽。</span><span class="sxs-lookup"><span data-stu-id="423b8-108">Better keyboard navigation through the various drop-down selection windows.</span></span></li><li><span data-ttu-id="423b8-109">減少不必要的定位停駐點。</span><span class="sxs-lookup"><span data-stu-id="423b8-109">Reduced unnecessary tab stops.</span></span></li><li><span data-ttu-id="423b8-110">更適當地報告控制項類型。</span><span class="sxs-lookup"><span data-stu-id="423b8-110">Better reporting of control types.</span></span></li><li><span data-ttu-id="423b8-111">改善的朗讀程式行為。</span><span class="sxs-lookup"><span data-stu-id="423b8-111">Improved narrator behavior.</span></span></li><li><span data-ttu-id="423b8-112">若要在控制項中實作遺漏的使用者可存取性模式變更。</span><span class="sxs-lookup"><span data-stu-id="423b8-112">Changes to implement missing UI accessibility patterns in controls.</span></span></li></ul>|
|<span data-ttu-id="423b8-113">建議</span><span class="sxs-lookup"><span data-stu-id="423b8-113">Suggestion</span></span>|<span data-ttu-id="423b8-114"><strong>如何選擇加入或退出這些變更</strong>為了讓應用程式可受益於這些變更，它必須在.NET Framework 4.7.1 上執行或更新版本。</span><span class="sxs-lookup"><span data-stu-id="423b8-114"><strong>How to opt in or out of these changes</strong>In order for the application to benefit from these changes, it must run on the .NET Framework 4.7.1 or later.</span></span> <span data-ttu-id="423b8-115">應用程式可以從這些變更的其中一種下列獲益：</span><span class="sxs-lookup"><span data-stu-id="423b8-115">The application can benefit from these changes in either of the following ways:</span></span><ul><li><span data-ttu-id="423b8-116">它會將目標.NET Framework 4.7.1 重新編譯。</span><span class="sxs-lookup"><span data-stu-id="423b8-116">It is recompiled to target the .NET Framework 4.7.1.</span></span> <span data-ttu-id="423b8-117">這些協助工具變更為預設會在目標為.NET Framework 4.7.1 的 Windows Form 應用程式上啟用或更新版本。</span><span class="sxs-lookup"><span data-stu-id="423b8-117">These accessibility changes are enabled by default on Windows Forms applications that target the .NET Framework 4.7.1 or later.</span></span></li><li><span data-ttu-id="423b8-118">從舊版的協助工具行為選擇從中加入下列[AppContext 參數](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md)至<code>&lt;runtime&gt;</code>> 一節的 app.config 檔案，並將它設定為<code>false</code>，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="423b8-118">It opts out of the legacy accessibility behaviors by adding the following [AppContext switch](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) to the <code>&lt;runtime&gt;</code> section of the app.config file and setting it to <code>false</code>, as the following example shows.</span></span></li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><span data-ttu-id="423b8-119">.NET Framework 4.7.1 為目標的應用程式或更新版本並想要保留舊版協助工具的行為也可以選擇使用舊版的協助工具功能的明確設為這個 AppContext 參數<code>true</code>。如需使用者介面自動化的概觀，請參閱[UI 自動化概觀](~/docs/framework/ui-automation/ui-automation-overview.md)。<strong>新增支援使用者介面自動化模式和屬性</strong>協助工具用戶端可以利用新 WinForms 協助工具功能藉由使用通用的公開描述叫用模式。</span><span class="sxs-lookup"><span data-stu-id="423b8-119">Applications that target the .NET Framework 4.7.1 or later and want to preserve the legacy accessibility behavior can opt in to the use of legacy accessibility features by explicitly setting this AppContext switch to <code>true</code>.For an overview of UI automation, see the [UI Automation Overview](~/docs/framework/ui-automation/ui-automation-overview.md).<strong>Added support for UI Automation patterns and properties</strong>Accessibility clients can take advantage of new WinForms accessibility functionality by using common, publicly described invocation patterns.</span></span> <span data-ttu-id="423b8-120">這些模式不是 WinForms 特定。</span><span class="sxs-lookup"><span data-stu-id="423b8-120">These patterns are not WinForms-specific.</span></span> <span data-ttu-id="423b8-121">比方說，協助工具用戶端可以呼叫 QueryInterface 方法 Cwnd 介面 (MAAS) 取得的 IServiceProvider 介面。</span><span class="sxs-lookup"><span data-stu-id="423b8-121">For instance, accessibility clients can call the QueryInterface method on the IAccessible interface (MAAS) to obtain an IServiceProvider interface.</span></span> <span data-ttu-id="423b8-122">如果此介面可供使用，用戶端可以使用其 QueryService 方法來要求 IAccessibleEx 介面。</span><span class="sxs-lookup"><span data-stu-id="423b8-122">If this interface is available, clients can use its QueryService method to request an IAccessibleEx interface.</span></span> <span data-ttu-id="423b8-123">如需詳細資訊，請參閱[從用戶端使用的 IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx)。</span><span class="sxs-lookup"><span data-stu-id="423b8-123">For more information, see [Using IAccessibleEx from a Client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx).</span></span> <span data-ttu-id="423b8-124">從.NET Framework 4.7.1，IServiceProvider 開始和[IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) （如果適用的話） 可供 WinForms 協助工具物件。 .NET Framework 4.7.1 新增下列使用者介面自動化模式和屬性的支援：</span><span class="sxs-lookup"><span data-stu-id="423b8-124">Starting with the .NET Framework 4.7.1, IServiceProvider and [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (where applicable) are available for WinForms accessibility objects.The .NET Framework 4.7.1 adds support for the following UI automation patterns and properties:</span></span><ul><li><span data-ttu-id="423b8-125"><code>T:System.Windows.Forms.ToolStripSplitButton</code>和<code>T:System.Windows.Forms.ComboBox</code>控制支援[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="423b8-125">The <code>T:System.Windows.Forms.ToolStripSplitButton</code> and <code>T:System.Windows.Forms.ComboBox</code> controls support the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="423b8-126"><code>T:System.Windows.Forms.ToolStripMenuItem</code>控制項有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)屬性值<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="423b8-126">The <code>T:System.Windows.Forms.ToolStripMenuItem</code> control has a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="423b8-127"><code>T:System.Windows.Forms.ToolStripItem</code>支援[名稱](xref:System.Windows.Automation.AutomationElement.NameProperty)屬性和[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="423b8-127">The <code>T:System.Windows.Forms.ToolStripItem</code> control supports the [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) property and [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="423b8-128"><code>T:System.Windows.Forms.ToolStripDropDownItem</code>支援<xref:System.Windows.Forms.AccessibleEvents>指出 StateChange 和 NameChange 時展開或摺疊下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="423b8-128">The <code>T:System.Windows.Forms.ToolStripDropDownItem</code> control supports <xref:System.Windows.Forms.AccessibleEvents> indicating StateChange and NameChange when drop down is expanded or collapsed.</span></span></li><li><span data-ttu-id="423b8-129"><code>T:System.Windows.Forms.ToolStripDropDownButton</code>控制項有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)屬性值為<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="423b8-129">The <code>T:System.Windows.Forms.ToolStripDropDownButton</code> control has a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value of <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="423b8-130"><code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code>支援[切換模式](xref:System.Windows.Automation.TogglePattern)。</span><span class="sxs-lookup"><span data-stu-id="423b8-130">The <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> control supports the [Toggle Pattern](xref:System.Windows.Automation.TogglePattern).</span></span></li><li><span data-ttu-id="423b8-131"><code>T:System.Windows.Forms.NumericUpDown</code>和<code>T:System.Windows.Forms.DomainUpDown</code>控制支援[名稱](xref:System.Windows.Automation.AutomationElement.NameProperty)，而且有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md)的<xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="423b8-131">The <code>T:System.Windows.Forms.NumericUpDown</code> and <code>T:System.Windows.Forms.DomainUpDown</code> controls support the [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) and have a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) of <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</span></span></li></ul><span data-ttu-id="423b8-132"><strong>對 PropertyGrid 控制的改進</strong>的.NET Framework 4.7.1 PropertyBrowser 控制項中加入下列改良功能：</span><span class="sxs-lookup"><span data-stu-id="423b8-132"><strong>Improvements to the PropertyGrid control</strong>The .NET Framework 4.7.1 adds the following improvements to the PropertyBrowser control:</span></span><ul><li><span data-ttu-id="423b8-133"><strong>詳細資料</strong>時，使用者輸入不正確的值中會顯示 [錯誤] 對話方塊中的按鈕<code>T:System.Windows.Forms.PropertyGrid</code>支援[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)、 狀態與名稱變更通知和[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)屬性值為<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="423b8-133">The <strong>Details</strong> button in the error dialog that is displayed when the user enters an incorrect value in the <code>T:System.Windows.Forms.PropertyGrid</code> control supports the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), state and name change notifications, and a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property with a value of <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="423b8-134">[訊息] 窗格會顯示當<strong>詳細資料</strong>展開按鈕的 [錯誤] 對話方塊現在鍵盤存取，並可讓 [朗讀程式] 通知錯誤訊息的內容。</span><span class="sxs-lookup"><span data-stu-id="423b8-134">The message pane displayed when the <strong>Details</strong> button of the error dialog is expanded is now keyboard accessible and allows Narrator to announce the content of the error message.</span></span></li><li><span data-ttu-id="423b8-135"><xref:System.Windows.Forms.AccessibleRole>中的資料列<code>T:System.Windows.Forms.PropertyGrid</code>控制項已從&quot;列&quot;至&quot;儲存格&quot;。</span><span class="sxs-lookup"><span data-stu-id="423b8-135">The <xref:System.Windows.Forms.AccessibleRole> of rows in <code>T:System.Windows.Forms.PropertyGrid</code> control have changed from &quot;Row&quot; to &quot;Cell&quot;.</span></span> <span data-ttu-id="423b8-136">資料格會對應至 UIA ControlType &quot;DataItem&quot;，可讓它支援適當的鍵盤快速鍵和朗讀程式的公告。</span><span class="sxs-lookup"><span data-stu-id="423b8-136">The cell maps to UIA ControlType &quot;DataItem&quot;, which allows it to support appropriate keyboard shortcuts and Narrator announcements.</span></span></li><li><span data-ttu-id="423b8-137"><code>T:System.Windows.Forms.PropertyGrid</code>控制哪些代表標頭項目時的資料列<code>T:System.Windows.Forms.PropertyGrid</code>控制項有<code>P:System.Windows.Forms.PropertySort</code>屬性設定為<code>F:System.Windows.Forms.PropertySory.Categorized</code>有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)屬性值 <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="423b8-137">The <code>T:System.Windows.Forms.PropertyGrid</code> control rows which represent header items when the <code>T:System.Windows.Forms.PropertyGrid</code> control has a <code>P:System.Windows.Forms.PropertySort</code> property set to <code>F:System.Windows.Forms.PropertySory.Categorized</code> have a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value of <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></span></span></li><li><span data-ttu-id="423b8-138"><code>T:System.Windows.Forms.PropertyGrid</code>控制哪些代表標頭項目時的資料列<code>T:System.Windows.Forms.PropertyGrid</code>控制項有<code>P:System.Windows.Forms.PropertySort</code>屬性設定為<code>F:System.Windows.Forms.PropertySory.Categorized</code>支援[展開/摺疊模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="423b8-138">The <code>T:System.Windows.Forms.PropertyGrid</code> control rows which represent header items when the <code>T:System.Windows.Forms.PropertyGrid</code> control has a <code>P:System.Windows.Forms.PropertySort</code> property set to <code>F:System.Windows.Forms.PropertySory.Categorized</code> support the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="423b8-139">改善的鍵盤巡覽，格線之間工具列。</span><span class="sxs-lookup"><span data-stu-id="423b8-139">Improved keyboard navigation between the grid and the ToolBar above it.</span></span> <span data-ttu-id="423b8-140">按下&quot;Shift Tab&quot;現在會選取第一個工具列按鈕，而不是整個工具列</span><span class="sxs-lookup"><span data-stu-id="423b8-140">Pressing &quot;Shift-Tab&quot; now selects the first ToolBar button, instead of the whole ToolBar</span></span></li><li><span data-ttu-id="423b8-141"><code>T:System.Windows.Forms.PropertyGrid</code> 在高對比模式中顯示的控制項現在繪製目前的焦點矩形以圍繞對應的工具列按鈕<code>P:System.Windows.Forms.PropertySort</code>屬性值。</span><span class="sxs-lookup"><span data-stu-id="423b8-141"><code>T:System.Windows.Forms.PropertyGrid</code> controls displayed in High Contrast mode will now draw a focus rectangle around the ToolBar button which corresponds to the current <code>P:System.Windows.Forms.PropertySort</code> property value.</span></span></li><li><span data-ttu-id="423b8-142"><code>T:System.Windows.Forms.PropertyGrid</code> 顯示的高對比模式，並使用控制項<code>P:System.Windows.Forms.PropertySort</code>屬性設定為<code>F:System.Windows.Forms.PropertySory.Categorized</code>會立即顯示高對比的色彩中的類別標頭的背景。</span><span class="sxs-lookup"><span data-stu-id="423b8-142"><code>T:System.Windows.Forms.PropertyGrid</code> controls displayed in High Contrast mode and with a <code>P:System.Windows.Forms.PropertySort</code> property set to <code>F:System.Windows.Forms.PropertySory.Categorized</code> will now display the background of category headers in a highly contrasting color.</span></span></li><li><span data-ttu-id="423b8-143"><code>T:System.Windows.Forms.PropertyGrid</code> 控制項最好是用來區別具有焦點的工具列項目和工具列項目表示的目前值<code>P:System.Windows.Forms.PropertySort</code>屬性。</span><span class="sxs-lookup"><span data-stu-id="423b8-143"><code>T:System.Windows.Forms.PropertyGrid</code> controls better differentiates between ToolBar items with focus and the ToolBar items which indicate the current value of the <code>P:System.Windows.Forms.PropertySort</code> property.</span></span> <span data-ttu-id="423b8-144">此修正程式是由高對比變更及非高對比案例的變更所組成。</span><span class="sxs-lookup"><span data-stu-id="423b8-144">This fix consists of a High Contrast change and a change for non-High Contrast scenarios.</span></span></li><li><span data-ttu-id="423b8-145"><code>T:System.Windows.Forms.PropertyGrid</code> 控制工具列項目表示的目前值<code>P:System.Windows.Forms.PropertySort</code>屬性支援[切換模式](xref:System.Windows.Automation.TogglePattern)。</span><span class="sxs-lookup"><span data-stu-id="423b8-145"><code>T:System.Windows.Forms.PropertyGrid</code> control ToolBar items which indicates the current value of the <code>P:System.Windows.Forms.PropertySort</code> property support the [Toggle Pattern](xref:System.Windows.Automation.TogglePattern).</span></span></li><li><span data-ttu-id="423b8-146">改善 [朗讀程式] 區分對齊選擇器中選取的對齊方式的支援。</span><span class="sxs-lookup"><span data-stu-id="423b8-146">Improved Narrator support for distinguishing the selected alignment in the Alignment Picker.</span></span></li><li><span data-ttu-id="423b8-147">當空<code>T:System.Windows.Forms.PropertyGrid</code>表單上顯示控制項，它現在會接收的焦點的位置之前它不會。</span><span class="sxs-lookup"><span data-stu-id="423b8-147">When an empty <code>T:System.Windows.Forms.PropertyGrid</code> control is displayed on a form, it will now receive focus where previously it would not.</span></span></li></ul><span data-ttu-id="423b8-148"><strong>作業系統定義之色彩在高對比佈景主題中的使用</strong></span><span class="sxs-lookup"><span data-stu-id="423b8-148"><strong>Use of OS-defined colors in High Contrast themes</strong></span></span><ul><li><span data-ttu-id="423b8-149"><code>T:System.Windows.Forms.Button</code> 和<code>T:System.Windows.Forms.CheckBox</code>控制與<code>P:System.Windows.Forms.Control.FlatStyle</code>設<xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>，這是預設樣式，現在使用高對比佈景主題時選取的作業系統定義之色彩。</span><span class="sxs-lookup"><span data-stu-id="423b8-149"><code>T:System.Windows.Forms.Button</code> and <code>T:System.Windows.Forms.CheckBox</code> controls with <code>P:System.Windows.Forms.Control.FlatStyle</code> set to <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, which is the default style, now use OS-defined colors in High Contrast theme when selected.</span></span> <span data-ttu-id="423b8-150">之前，文字和背景色彩不對比，而且難以讀取。</span><span class="sxs-lookup"><span data-stu-id="423b8-150">Previously, text and background colors were not contrasting and were hard to read.</span></span></li><li><span data-ttu-id="423b8-151"><code>T:System.Windows.Forms.Button</code><code>T:System.Windows.Forms.CheckBox</code>， <code>T:System.Windows.Forms.RadioButton</code>， <code>T:System.Windows.Forms.Label</code>，<code>T:System.Windows.Forms.LinkLabel</code>和<code>T:System.Windows.Forms.GroupBox</code>與<code>P:System.Windows.Forms.Control.Enabled</code>設<em>false</em>，用來呈現在高對比佈景主題，導致對低對比中的文字的陰影的色彩背景。</span><span class="sxs-lookup"><span data-stu-id="423b8-151"><code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> and <code>T:System.Windows.Forms.GroupBox</code> with<code>P:System.Windows.Forms.Control.Enabled</code> set to <em>false</em>, used a shaded color to render text in High Contrast themes, resulting in low contrast against the background.</span></span> <span data-ttu-id="423b8-152">現在這些控制項使用&quot;已停用文字&quot;OS 所定義的色彩。</span><span class="sxs-lookup"><span data-stu-id="423b8-152">Now these controls use &quot;Disabled Text&quot; color defined by the OS.</span></span> <span data-ttu-id="423b8-153">此修正程式套用至控制項和<code>P:System.Windows.Forms.Control.FlatStyle</code>屬性以外的值設定<code>F:System.Windows.Forms.FlatStyle.System</code>。</span><span class="sxs-lookup"><span data-stu-id="423b8-153">This fix applies to controls with <code>P:System.Windows.Forms.Control.FlatStyle</code> property set to a value other than <code>F:System.Windows.Forms.FlatStyle.System</code>.</span></span> <span data-ttu-id="423b8-154">第二個控制項所呈現的 OS。</span><span class="sxs-lookup"><span data-stu-id="423b8-154">The latter controls are rendered by the OS.</span></span></li><li><span data-ttu-id="423b8-155"><code>T:System.Windows.Forms.DataGridView</code> 現在會呈現具有目前焦點所在的儲存格內容周圍的顯示矩形。</span><span class="sxs-lookup"><span data-stu-id="423b8-155"><code>T:System.Windows.Forms.DataGridView</code> now renders a visible rectangle around the content of the cell which has the current focus.</span></span> <span data-ttu-id="423b8-156">先前，這不是顯示在特定的高對比佈景主題。</span><span class="sxs-lookup"><span data-stu-id="423b8-156">Previously, this was not visible in certain High Contrast themes.</span></span></li><li><span data-ttu-id="423b8-157"><code>T:System.Windows.Forms.ToolStripMenuItem</code> 控制與<code>P:System.Windows.Forms.ToolStripItem.Enabled</code>屬性設定為<em>false</em>現在使用&quot;已停用文字&quot;OS 所定義的色彩。</span><span class="sxs-lookup"><span data-stu-id="423b8-157"><code>T:System.Windows.Forms.ToolStripMenuItem</code> controls with a <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> property set to <em>false</em> now use the &quot;Disabled Text&quot; color defined by the OS.</span></span></li><li><span data-ttu-id="423b8-158"><code>T:System.Windows.Forms.ToolStripMenuItem</code> 控制與<code>P:System.Windows.Forms.ToolStripItem.Checked</code>屬性設定為<em>true</em>現在呈現相關聯的核取記號，以相反的系統色彩。</span><span class="sxs-lookup"><span data-stu-id="423b8-158"><code>T:System.Windows.Forms.ToolStripMenuItem</code> controls with a <code>P:System.Windows.Forms.ToolStripItem.Checked</code> property set to <em>true</em> now render the associated check mark in a contrasting system color.</span></span>  <span data-ttu-id="423b8-159">先前的核取記號色彩已不對照足夠，且不可見。 在高對比佈景主題中。</span><span class="sxs-lookup"><span data-stu-id="423b8-159">Previously the check mark color was not contrasting enough and not visible in High Contrast themes.</span></span></li></ul><span data-ttu-id="423b8-160">注意： Windows10 變更某些高對比系統色彩的值。</span><span class="sxs-lookup"><span data-stu-id="423b8-160">NOTE: Windows10 has changed values for some high contrast system colors.</span></span> <span data-ttu-id="423b8-161">Windows Form 架構為基礎的 Win32 架構。</span><span class="sxs-lookup"><span data-stu-id="423b8-161">Windows Forms Framework is based on the Win32 framework.</span></span> <span data-ttu-id="423b8-162">獲得最佳的體驗，在最新的 Windows 版本上執行，並加入最新的 OS 變更測試應用程式中加入資訊清單檔案，並取消註解下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="423b8-162">For the best experience, run on the latest version of Windows and opt in to the latest OS changes by adding an app.manifest file in a test application and uncommenting the following code:</span></span><pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><span data-ttu-id="423b8-163"><strong>改良的鍵盤導覽</strong></span><span class="sxs-lookup"><span data-stu-id="423b8-163"><strong>Improved keyboard navigation</strong></span></span><ul><li><span data-ttu-id="423b8-164">當<code>T:System.Windows.Forms.ComboBox</code>控制項有<code>P:System.Windows.Forms.ComboBox.DropDownStyle</code>設<code>F:System.Windows.Forms.DropDownStyle.DropDownList</code>，且索引標籤中的第一個控制項的排序是在表單中，而它現在顯示焦點矩形，使用鍵盤來開啟父表單時。</span><span class="sxs-lookup"><span data-stu-id="423b8-164">When a <code>T:System.Windows.Forms.ComboBox</code> control has <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> set to <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> and is the first control in the tab order on the form, it now displays a focus rectangle when the parent form is opened using the keyboard.</span></span> <span data-ttu-id="423b8-165">之前這項變更，鍵盤焦點在這個控制項，但焦點指標不轉譯。</span><span class="sxs-lookup"><span data-stu-id="423b8-165">Before this change, keyboard focus was on this control, but a focus indicator was not rendered.</span></span></li></ul><span data-ttu-id="423b8-166"><strong>改善的朗讀程式支援</strong></span><span class="sxs-lookup"><span data-stu-id="423b8-166"><strong>Improved Narrator support</strong></span></span><ul><li><span data-ttu-id="423b8-167"><code>T:System.Windows.Forms.MonthCalendar</code>控制項新增至存取控制，包括要朗讀程式閱讀控制項的值，當先前無法的能力的輔助技術的支援。</span><span class="sxs-lookup"><span data-stu-id="423b8-167">The <code>T:System.Windows.Forms.MonthCalendar</code> control has added support for assistive technologies to access the control, including the ability for Narrator to read the value of the control when previously it could not.</span></span></li><li><span data-ttu-id="423b8-168"><code>T:System.Windows.Forms.CheckedListBox</code>控制項現在會告知 [朗讀程式] 時<code>P:System.Windows.Forms.CheckState</code>屬性已變更。</span><span class="sxs-lookup"><span data-stu-id="423b8-168">The <code>T:System.Windows.Forms.CheckedListBox</code> control now notifies Narrator when the <code>P:System.Windows.Forms.CheckState</code> property has been changed.</span></span> <span data-ttu-id="423b8-169">之前，[朗讀程式] 未收到通知，因此使用者不會收到通知，<code>P:System.Windows.Forms.CheckState</code>已經更新。</span><span class="sxs-lookup"><span data-stu-id="423b8-169">Previously, Narrator did not recieve notification and as a result users would not be informed that the <code>P:System.Windows.Forms.CheckState</code> had been updated.</span></span></li><li><span data-ttu-id="423b8-170"><code>T:System.Windows.Forms.LinkLabel</code>控制項變更通知的文字在控制項中的 [朗讀程式] 的方式。</span><span class="sxs-lookup"><span data-stu-id="423b8-170">The <code>T:System.Windows.Forms.LinkLabel</code> control has changed the way it notifies Narrator of the text of in the control.</span></span> <span data-ttu-id="423b8-171">[朗讀程式] 之前，兩次宣布這段文字，並讀取&quot; &amp; &quot;符號為實際的文字，即使它們不會對使用者顯示。</span><span class="sxs-lookup"><span data-stu-id="423b8-171">Previously, Narrator announced this text twice and read &quot;&amp;&quot; symbols as real text even though they are not visible to a user.</span></span> <span data-ttu-id="423b8-172">重複的文字已移除了 [朗讀程式] 公告，以及不必要&quot; &amp; &quot;符號。</span><span class="sxs-lookup"><span data-stu-id="423b8-172">The duplicated text was removed from the Narrator announcements, as well as unnecessary &quot;&amp;&quot; symbols.</span></span></li><li><span data-ttu-id="423b8-173"><code>T:System.Windows.Forms.DataGridViewCell</code>控制項正確現在類型報表 [朗讀程式] 和其他輔助技術的唯讀狀態。</span><span class="sxs-lookup"><span data-stu-id="423b8-173">The <code>T:System.Windows.Forms.DataGridViewCell</code> control types now correctly report the read-only status to Narrator and other assistive technologies.</span></span></li><li><span data-ttu-id="423b8-174">[朗讀程式] 現在就可以讀取系統功能表中的子視窗的[多重文件介面](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md)應用程式。</span><span class="sxs-lookup"><span data-stu-id="423b8-174">Narrator is now able to read the System Menu of child windows in [Multiple-Document Interface](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) applications.</span></span></li><li><span data-ttu-id="423b8-175">[朗讀程式] 現在就可以讀取<code>T:System.Windows.Forms.ToolStripMenuItem</code>控制與<code>P:System.Windows.Forms.ToolStripItem.Enabled</code>屬性設定為<em>false</em>。</span><span class="sxs-lookup"><span data-stu-id="423b8-175">Narrator is now able to read <code>T:System.Windows.Forms.ToolStripMenuItem</code> controls with a <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> property set to <em>false</em>.</span></span> <span data-ttu-id="423b8-176">[朗讀程式] 之前無法將焦點放在已停用的功能表項目，來讀取內容。</span><span class="sxs-lookup"><span data-stu-id="423b8-176">Previously, Narrator was unable to focus on disabled menu items to read hte content.</span></span></li></ul>|
|<span data-ttu-id="423b8-177">範圍</span><span class="sxs-lookup"><span data-stu-id="423b8-177">Scope</span></span>|<span data-ttu-id="423b8-178">主要</span><span class="sxs-lookup"><span data-stu-id="423b8-178">Major</span></span>|
|<span data-ttu-id="423b8-179">版本</span><span class="sxs-lookup"><span data-stu-id="423b8-179">Version</span></span>|<span data-ttu-id="423b8-180">4.7.1</span><span class="sxs-lookup"><span data-stu-id="423b8-180">4.7.1</span></span>|
|<span data-ttu-id="423b8-181">類型</span><span class="sxs-lookup"><span data-stu-id="423b8-181">Type</span></span>|<span data-ttu-id="423b8-182">正在重定目標</span><span class="sxs-lookup"><span data-stu-id="423b8-182">Retargeting</span></span>|
|<span data-ttu-id="423b8-183">受影響的 API</span><span class="sxs-lookup"><span data-stu-id="423b8-183">Affected APIs</span></span>|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[<span data-ttu-id="423b8-184">MonthCalendar.AccessibilityObject</span><span class="sxs-lookup"><span data-stu-id="423b8-184">MonthCalendar.AccessibilityObject</span></span>](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

