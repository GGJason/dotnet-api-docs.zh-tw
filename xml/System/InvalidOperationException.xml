<Type Name="InvalidOperationException" FullName="System.InvalidOperationException">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="310a76379e88bee1dcef1420b7010efdaf2c8a3d" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36429905" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class InvalidOperationException : SystemException" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi serializable beforefieldinit InvalidOperationException extends System.SystemException" />
  <TypeSignature Language="DocId" Value="T:System.InvalidOperationException" />
  <TypeSignature Language="VB.NET" Value="Public Class InvalidOperationException&#xA;Inherits SystemException" />
  <TypeSignature Language="C++ CLI" Value="public ref class InvalidOperationException : SystemException" />
  <TypeSignature Language="F#" Value="type InvalidOperationException = class&#xA;    inherit SystemException" />
  <AssemblyInfo>
    <AssemblyName>System.Runtime</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.10.0</AssemblyVersion>
    <AssemblyVersion>4.0.20.0</AssemblyVersion>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.1.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Exception</BaseTypeName>
    <BaseTypeName FrameworkAlternate="netframework-4.5">System.SystemException</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.Runtime.InteropServices.ComVisible(true)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="7fc5e-101">當方法呼叫對物件的目前狀態無效時所擲回的例外狀況。</span>
      <span class="sxs-lookup">
        <span data-stu-id="7fc5e-101">The exception that is thrown when a method call is invalid for the object's current state.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7fc5e-102"><xref:System.InvalidOperationException> 用於情況下，當叫用方法的錯誤無效的引數以外的原因所造成。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-102"><xref:System.InvalidOperationException> is used in cases when the failure to invoke a method is caused by reasons other than invalid arguments.</span></span> <span data-ttu-id="7fc5e-103">通常，它會擲回時，物件的狀態無法支援方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-103">Typically, it is thrown when the state of an object cannot support the method call.</span></span> <span data-ttu-id="7fc5e-104">例如，<xref:System.InvalidOperationException>例外狀況的方法擲回類似：</span><span class="sxs-lookup"><span data-stu-id="7fc5e-104">For example, an <xref:System.InvalidOperationException> exception is thrown by methods such as:</span></span>  
  
-   <span data-ttu-id="7fc5e-105"><xref:System.Collections.IEnumerator.MoveNext%2A?displayProperty=nameWithType> 如果建立列舉值之後，會修改物件的集合。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-105"><xref:System.Collections.IEnumerator.MoveNext%2A?displayProperty=nameWithType> if objects of a collection are modified after the enumerator is created.</span></span> <span data-ttu-id="7fc5e-106">如需詳細資訊，請參閱[變更反覆運算它時收集](#Iterating)。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-106">For more information, see [Changing a collection while iterating it](#Iterating).</span></span>  
  
-   <span data-ttu-id="7fc5e-107"><xref:System.Resources.ResourceSet.GetString%2A?displayProperty=nameWithType> 如果前已關閉的資源集合則會在方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-107"><xref:System.Resources.ResourceSet.GetString%2A?displayProperty=nameWithType> if the resource set is closed before the method call is made.</span></span>  
  
-   <span data-ttu-id="7fc5e-108"><xref:System.Xml.Linq.XContainer.Add%2A?displayProperty=nameWithType>或多個要加入的物件會不正確的結構化的 XML 文件中產生。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-108"><xref:System.Xml.Linq.XContainer.Add%2A?displayProperty=nameWithType>, if the object or objects to be added would result in an incorrectly structured XML document.</span></span>  
  
-   <span data-ttu-id="7fc5e-109">這種方法來操作從非主執行緒或 UI 執行緒 UI 嘗試。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-109">A method that attempts to manipulate the UI from a thread that is not the main or UI thread.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7fc5e-110">因為<xref:System.InvalidOperationException>擲回例外狀況在各種不同的情況下，務必閱讀所傳回的例外狀況訊息<xref:System.Exception.Message%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-110">Because the <xref:System.InvalidOperationException> exception can be thrown in a wide variety of circumstances, it is important to read the exception message returned by the <xref:System.Exception.Message%2A> property.</span></span>  
  
 <span data-ttu-id="7fc5e-111">本節內容：</span><span class="sxs-lookup"><span data-stu-id="7fc5e-111">In this section:</span></span>  
  
 <span data-ttu-id="7fc5e-112">[InvalidOperationException 例外狀況的一些常見原因](#Causes) </span><span class="sxs-lookup"><span data-stu-id="7fc5e-112">[Some common causes of InvalidOperationException exceptions](#Causes) </span></span>  
 [<span data-ttu-id="7fc5e-113">更新 UI 執行緒，從非 UI 執行緒</span><span class="sxs-lookup"><span data-stu-id="7fc5e-113">Updating a UI thread from a non-UI thread</span></span>](#UI)  
 [<span data-ttu-id="7fc5e-114">當它逐一查看集合的變更</span><span class="sxs-lookup"><span data-stu-id="7fc5e-114">Changing a collection while iterating it</span></span>](#Iterating)  
 [<span data-ttu-id="7fc5e-115">排序無法比較的物件陣列或集合</span><span class="sxs-lookup"><span data-stu-id="7fc5e-115">Sorting an array or collection whose objects cannot be compared</span></span>](#Sorting)  
 <span data-ttu-id="7fc5e-116">[轉型將&lt;T&gt;可為 null，為其基礎類型](#Nullable) </span><span class="sxs-lookup"><span data-stu-id="7fc5e-116">[Casting a Nullable&lt;T&gt; that is null to its underlying type](#Nullable) </span></span>  
 [<span data-ttu-id="7fc5e-117">在空集合上呼叫的 System.Linq.Enumerable 方法</span><span class="sxs-lookup"><span data-stu-id="7fc5e-117">Calling a System.Linq.Enumerable method on an empty collection</span></span>](#Empty)  
 [<span data-ttu-id="7fc5e-118">上不含一個元素的順序呼叫 Enumerable.Single 或 Enumerable.SingleOrDefault</span><span class="sxs-lookup"><span data-stu-id="7fc5e-118">Calling Enumerable.Single or Enumerable.SingleOrDefault on a sequence without one element</span></span>](#Single)  
 [<span data-ttu-id="7fc5e-119">動態跨應用程式網域欄位存取權</span><span class="sxs-lookup"><span data-stu-id="7fc5e-119">Dynamic cross-application domain field access</span></span>](#Emit)  
[<span data-ttu-id="7fc5e-120">擲回 InvalidOperationException 例外狀況</span><span class="sxs-lookup"><span data-stu-id="7fc5e-120">Throwing an InvalidOperationException exception</span></span>](#Throwing)  
[<span data-ttu-id="7fc5e-121">其他資訊</span><span class="sxs-lookup"><span data-stu-id="7fc5e-121">Miscellaneous information</span></span>](#Misc)  
  
<a name="Causes"></a>   
## <a name="some-common-causes-of-invalidoperationexception-exceptions"></a><span data-ttu-id="7fc5e-122">InvalidOperationException 例外狀況的一些常見原因</span><span class="sxs-lookup"><span data-stu-id="7fc5e-122">Some common causes of InvalidOperationException exceptions</span></span>  
 <span data-ttu-id="7fc5e-123">下列章節將示範一些常見中所在的情況下<xref:System.InvalidOperationException>應用程式中擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-123">The following sections show how some common cases in which in <xref:System.InvalidOperationException> exception is thrown in an app.</span></span> <span data-ttu-id="7fc5e-124">處理問題的方式需視特定情況而定。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-124">How you handle the issue depends on the specific situation.</span></span> <span data-ttu-id="7fc5e-125">大多數情況下，然而，例外狀況會導致從開發人員錯誤和<xref:System.InvalidOperationException>可以預測並避免例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-125">Most commonly, however, the exception results from developer error, and the <xref:System.InvalidOperationException> exception can be anticipated and avoided.</span></span>  
  
<a name="UI"></a>   
### <a name="updating-a-ui-thread-from-a-non-ui-thread"></a><span data-ttu-id="7fc5e-126">更新 UI 執行緒，從非 UI 執行緒</span><span class="sxs-lookup"><span data-stu-id="7fc5e-126">Updating a UI thread from a non-UI thread</span></span>  
 <span data-ttu-id="7fc5e-127">通常，背景工作執行緒可用來執行某些背景工作，包含收集要在應用程式的使用者介面中顯示的資料。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-127">Often, worker threads are used to perform some background work that involves gathering data to be displayed in an application's user interface.</span></span> <span data-ttu-id="7fc5e-128">不過。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-128">However.</span></span> <span data-ttu-id="7fc5e-129">大部分的 GUI （圖形化使用者介面） 應用程式架構，適用於.NET Framework，例如 Windows Form 和 Windows Presentation Foundation (WPF) 可讓您只會從執行緒建立及管理 UI （主要或 UI 執行緒） 存取 GUI 物件。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-129">most GUI (graphical user interface) application frameworks for the .NET Framework, such as Windows Forms and Windows Presentation Foundation (WPF),  let you access GUI objects only from the thread that creates and manages the UI (the Main or UI thread).</span></span> <span data-ttu-id="7fc5e-130"><xref:System.InvalidOperationException>您嘗試從 UI 執行緒以外的執行緒存取 UI 項目時，會擲回。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-130">An <xref:System.InvalidOperationException> is thrown when you try to access a UI element from a thread other than the UI thread.</span></span>  <span data-ttu-id="7fc5e-131">下表中顯示的例外狀況訊息文字。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-131">The text of the exception message is shown in the following table.</span></span>  
  
|<span data-ttu-id="7fc5e-132">應用程式類型</span><span class="sxs-lookup"><span data-stu-id="7fc5e-132">Application Type</span></span>|<span data-ttu-id="7fc5e-133">訊息</span><span class="sxs-lookup"><span data-stu-id="7fc5e-133">Message</span></span>|  
|----------------------|-------------|  
|<span data-ttu-id="7fc5e-134">WPF 應用程式</span><span class="sxs-lookup"><span data-stu-id="7fc5e-134">WPF app</span></span>|<span data-ttu-id="7fc5e-135">**呼叫執行緒無法存取此物件，因為另一個執行緒。**</span><span class="sxs-lookup"><span data-stu-id="7fc5e-135">**The calling thread cannot access this object because a different thread owns it.**</span></span>|  
|<span data-ttu-id="7fc5e-136">UWP 應用程式</span><span class="sxs-lookup"><span data-stu-id="7fc5e-136">UWP app</span></span>|<span data-ttu-id="7fc5e-137">**應用程式給不同執行緒中呼叫了封送處理的介面。**</span><span class="sxs-lookup"><span data-stu-id="7fc5e-137">**The application called an interface that was marshalled for a different thread.**</span></span>|  
|<span data-ttu-id="7fc5e-138">Windows Form 應用程式</span><span class="sxs-lookup"><span data-stu-id="7fc5e-138">Windows Forms app</span></span>|<span data-ttu-id="7fc5e-139">**跨執行緒作業無效： 控制項 'TextBox1' 從其所建立的執行緒以外的執行緒存取。**</span><span class="sxs-lookup"><span data-stu-id="7fc5e-139">**Cross-thread operation not valid: Control 'TextBox1' accessed from a thread other than the thread it was created on.**</span></span>|  
  
 <span data-ttu-id="7fc5e-140">適用於.NET Framework 的 UI 架構實作*發送器*模式，其中包含檢查是否正在 UI 執行緒上執行的 UI 元素成員呼叫的方法和 UI 執行緒上排定呼叫的其他方法：</span><span class="sxs-lookup"><span data-stu-id="7fc5e-140">UI frameworks for the .NET Framework implement a *dispatcher* pattern that includes a method to check whether a call to a member of a UI element is being executed on the UI thread, and other methods to schedule the call on the UI thread:</span></span>  
  
-   <span data-ttu-id="7fc5e-141">在 WPF 應用程式中，呼叫<xref:System.Windows.Threading.Dispatcher.CheckAccess%2A?displayProperty=nameWithType>方法，以判斷方法是否執行於非 UI 執行緒。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-141">In WPF apps, call the <xref:System.Windows.Threading.Dispatcher.CheckAccess%2A?displayProperty=nameWithType> method to determine if a method is running on a non-UI thread.</span></span> <span data-ttu-id="7fc5e-142">它會傳回`true`如果 UI 執行緒上執行的方法和`false`否則。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-142">It returns `true` if the method is running on the UI thread and `false` otherwise.</span></span> <span data-ttu-id="7fc5e-143">呼叫其中一個多載的<xref:System.Windows.Threading.Dispatcher.Invoke%2A?displayProperty=nameWithType>UI 執行緒上排定呼叫的方法。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-143">Call one of the overloads of the <xref:System.Windows.Threading.Dispatcher.Invoke%2A?displayProperty=nameWithType> method to schedule the call on the UI thread.</span></span>  
  
-   <span data-ttu-id="7fc5e-144">在 UWP 應用程式中，呼叫[CoreDispatcher.HasThreadAccess](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.hasthreadaccess.aspx)方法，以判斷方法是否執行於非 UI 執行緒。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-144">In UWP apps, call the [CoreDispatcher.HasThreadAccess](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.hasthreadaccess.aspx) method to determine if a method is running on a non-UI thread.</span></span> <span data-ttu-id="7fc5e-145">呼叫[CoreDispatcher.RunAsync](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.runasync.aspx)方法才能執行更新 UI 執行緒的委派。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-145">Call the  [CoreDispatcher.RunAsync](https://msdn.microsoft.com/library/windows/apps/windows.ui.core.coredispatcher.runasync.aspx) method to execute a delegate that updates the UI thread.</span></span> <span data-ttu-id="7fc5e-146">使用</span><span class="sxs-lookup"><span data-stu-id="7fc5e-146">Use the</span></span>  
  
-   <span data-ttu-id="7fc5e-147">在 Windows Form 應用程式，使用<xref:System.Windows.Forms.Control.InvokeRequired%2A?displayProperty=nameWithType>屬性來判斷方法是否執行於非 UI 執行緒。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-147">In Windows Forms apps, use the <xref:System.Windows.Forms.Control.InvokeRequired%2A?displayProperty=nameWithType> property to determine if a method is running on a non-UI thread.</span></span> <span data-ttu-id="7fc5e-148">呼叫其中一個多載的<xref:System.Windows.Forms.Control.Invoke%2A?displayProperty=nameWithType>方法才能執行更新 UI 執行緒的委派。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-148">Call one of the overloads of the <xref:System.Windows.Forms.Control.Invoke%2A?displayProperty=nameWithType> method to execute a delegate that updates the UI thread.</span></span>  
  
 <span data-ttu-id="7fc5e-149">下列範例說明<xref:System.InvalidOperationException>您嘗試更新 UI 項目從建立它的執行緒以外的執行緒時，會擲回的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-149">The following examples illustrate the <xref:System.InvalidOperationException> exception that is thrown when you attempt to update a UI element from a thread other than the thread that created it.</span></span>  <span data-ttu-id="7fc5e-150">每個範例，您必須建立兩個控制項：</span><span class="sxs-lookup"><span data-stu-id="7fc5e-150">Each example requires that you create two controls:</span></span>  
  
-   <span data-ttu-id="7fc5e-151">命名文字方塊控制項`textBox1`。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-151">A text box control named `textBox1`.</span></span>  <span data-ttu-id="7fc5e-152">在 Windows Form 應用程式中，您必須設定其<xref:System.Windows.Forms.TextBox.Multiline%2A>屬性`true`。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-152">In a Windows Forms app, you should set its <xref:System.Windows.Forms.TextBox.Multiline%2A> property to `true`.</span></span>  
  
-   <span data-ttu-id="7fc5e-153">按鈕控制項，名為`threadExampleBtn`。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-153">A button  control named `threadExampleBtn`.</span></span> <span data-ttu-id="7fc5e-154">這個範例將提供處理常式， `ThreadsExampleBtn_Click`，按鈕`Click`事件。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-154">The example provides a handler, `ThreadsExampleBtn_Click`, for the button's `Click` event.</span></span>  
  
 <span data-ttu-id="7fc5e-155">在每個案例中，`threadExampleBtn_Click`事件處理常式呼叫`DoSomeWork`方法兩次。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-155">In each case, the `threadExampleBtn_Click` event handler calls the `DoSomeWork` method twice.</span></span> <span data-ttu-id="7fc5e-156">第一次呼叫會以同步方式執行，而且會成功。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-156">The first call runs synchronously and succeeds.</span></span> <span data-ttu-id="7fc5e-157">但第二次呼叫，因為它以非同步方式執行在執行緒集區執行緒，嘗試從非 UI 執行緒更新 UI。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-157">But the second call, because it runs asynchronously on a thread pool thread, attempts to update the UI from a non-UI thread.</span></span> <span data-ttu-id="7fc5e-158">這會導致<xref:System.InvalidOperationException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-158">This results in a <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="7fc5e-159">WPF 和 UWP 應用程式</span><span class="sxs-lookup"><span data-stu-id="7fc5e-159">WPF and UWP apps</span></span>  
 [!code-csharp[System.InvalidOperationException.Threading.WPF1#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf1/cs/MainWindow.xaml.cs#1)]
 [!code-vb[System.InvalidOperationException.Threading.WPF1#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf1/vb/MainWindow.xaml.vb#1)]  
  
 <span data-ttu-id="7fc5e-160">下列版本`DoSomeWork`方法消除 WPF 應用程式中的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-160">The following version of the `DoSomeWork` method eliminates the exception in a WPF app.</span></span>  
  
 [!code-csharp[System.InvalidOperationException.Threading.WPF2#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf2/cs/MainWindowDispatcher.xaml.cs#3)]
 [!code-vb[System.InvalidOperationException.Threading.WPF2#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wpf2/vb/MainWindowDispatcher.xaml.vb#3)]  
  
 <span data-ttu-id="7fc5e-161">下列版本`DoSomeWork`方法消除例外狀況的 UWP 應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-161">The following version of the `DoSomeWork` method eliminates the exception in a UWP app.</span></span>  
  
 [!code-csharp[System.InvalidOperationException.Threading.UWP#4](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception.threading.uwp/cs/MainPage.xaml.cs#4)]
 [!code-vb[System.InvalidOperationException.Threading.UWP#4](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception.threading.uwp/vb/MainPage.xaml.vb#4)]  
  
 <span data-ttu-id="7fc5e-162">Windows Forms 應用程式</span><span class="sxs-lookup"><span data-stu-id="7fc5e-162">Windows Forms apps</span></span>  
 [!code-csharp[System.InvalidOperationException.Threading.WF#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf/cs/Form1.cs#2)]
 [!code-vb[System.InvalidOperationException.Threading.WF#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf/vb/Form1.vb#2)]  
  
 <span data-ttu-id="7fc5e-163">下列版本`DoSomeWork`方法會排除在 Windows Form 應用程式中的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-163">The following version of the `DoSomeWork` method eliminates the exception in a Windows Forms app.</span></span>  
  
 [!code-csharp[System.InvalidOperationException.Threading.WF2#5](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf2/cs/Form1.cs#5)]
 [!code-vb[System.InvalidOperationException.Threading.WF2#5](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Invalidoperationexception.threading.wf2/vb/Form1.vb#5)]  
  
<a name="Iterating"></a>   
### <a name="changing-a-collection-while-iterating-it"></a><span data-ttu-id="7fc5e-164">當它逐一查看集合的變更</span><span class="sxs-lookup"><span data-stu-id="7fc5e-164">Changing a collection while iterating it</span></span>  
 <span data-ttu-id="7fc5e-165">`foreach` C# 中的陳述式或`For Each`陳述式在 Visual Basic 中的用來逐一查看集合的成員和讀取或修改其個別項目。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-165">The `foreach` statement in C# or `For Each` statement in Visual Basic is used to iterate the members of a collection and to read or modify its individual elements.</span></span> <span data-ttu-id="7fc5e-166">不過，無法用來新增或移除集合中的項目。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-166">However, it can't be used to add or remove items from the collection.</span></span> <span data-ttu-id="7fc5e-167">如此一來，這會擲回<xref:System.InvalidOperationException>以訊息相似，例外狀況 」**集合已修改;列舉操作可能無法執行。**"</span><span class="sxs-lookup"><span data-stu-id="7fc5e-167">Doing this throws an  <xref:System.InvalidOperationException> exception with a message that is similar to, "**Collection was modified; enumeration operation may not execute.**"</span></span>  
  
 <span data-ttu-id="7fc5e-168">下列範例會反覆查看加入至集合的每個整數平方嘗試整數的集合。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-168">The following example iterates a collection of integers attempts to add the square of each integer to the collection.</span></span> <span data-ttu-id="7fc5e-169">此範例會擲回<xref:System.InvalidOperationException>與第一次呼叫<xref:System.Collections.Generic.List%601.Add%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-169">The example throws an <xref:System.InvalidOperationException> with the first call to the <xref:System.Collections.Generic.List%601.Add%2A?displayProperty=nameWithType> method.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Iterating1.cs#1)]
 [!code-vb[System.InvalidOperationException#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Iterating1.vb#1)]  
  
 <span data-ttu-id="7fc5e-170">您可以根據應用程式邏輯排除中的兩種方式，其中一個例外狀況：</span><span class="sxs-lookup"><span data-stu-id="7fc5e-170">You can eliminate the exception in one of two ways, depending on your application logic:</span></span>  
  
-   <span data-ttu-id="7fc5e-171">如果項目必須新增至集合中反覆運算它時，可以重複使用索引`for`陳述式來取代`foreach`或`For Each`。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-171">If elements must be added to the collection while iterating it, you can iterate it by index using the `for` statement instead of `foreach` or `For Each`.</span></span> <span data-ttu-id="7fc5e-172">下列範例會使用的陳述式來加入至集合的集合中的數字的平方。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-172">The following example uses the for statement to add the square of numbers in the collection to the collection.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Iterating2.cs#2)]
     [!code-vb[System.InvalidOperationException#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Iterating2.vb#2)]  
  
     <span data-ttu-id="7fc5e-173">請注意，您必須逐一查看集合藉由使用會逐一查看向後，結束迴圈 appropraitely 中，在迴圈內部計數器之前建立反覆項目數目從`Count`-1 至 0，或為此範例會執行，藉由指派數目中的項目數的陣列變數，並使用它來建立迴圈的上限。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-173">Note that you must establish the number of iterations before iterating the collection either by using a counter inside the loop that will exit the loop appropraitely, by iterating backward, from `Count` - 1 to 0, or, as the example does, by assigning the number of elements in the array to a variable and using it to establish the upper bound of the loop.</span></span> <span data-ttu-id="7fc5e-174">否則，如果項目加入至每個反覆項目上的集合，會無止盡的迴圈。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-174">Otherwise, if an element is added to the collection on every iteration, an endless loop results.</span></span>  
  
-   <span data-ttu-id="7fc5e-175">如果您不需要將項目加入集合中反覆運算它時，您可以儲存的項目會加入一個暫存集合中您將完成逐一查看集合時。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-175">If it is not necessary to add elements to the collection while iterating it, you can store the elements to be added in a temporary collection that you add when iterating the collection has finished.</span></span>  <span data-ttu-id="7fc5e-176">下列範例會使用此方式來新增暫時的集合，集合中的數字的平方然後再將合併到單一陣列物件的集合。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-176">The following example uses this approach to add the square of numbers in a collection to a temporary collection, and then to combine the collections into a single array object.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Iterating3.cs#3)]
     [!code-vb[System.InvalidOperationException#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Iterating3.vb#3)]  
  
<a name="Sorting"></a>   
### <a name="sorting-an-array-or-collection-whose-objects-cannot-be-compared"></a><span data-ttu-id="7fc5e-177">排序無法比較的物件陣列或集合</span><span class="sxs-lookup"><span data-stu-id="7fc5e-177">Sorting an array or collection whose objects cannot be compared</span></span>  
 <span data-ttu-id="7fc5e-178">一般用途的排序方法，例如<xref:System.Array.Sort%28System.Array%29?displayProperty=nameWithType>方法或<xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType>方法，通常需要至少一個要排序的物件實作<xref:System.IComparable%601>或<xref:System.IComparable>介面。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-178">General-purpose sorting methods, such as the <xref:System.Array.Sort%28System.Array%29?displayProperty=nameWithType> method or the <xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType> method, usually require that at least one of the objects to be sorted implement the <xref:System.IComparable%601> or the <xref:System.IComparable> interface.</span></span> <span data-ttu-id="7fc5e-179">如果您沒有，無法排序的集合或陣列，並在方法擲回<xref:System.InvalidOperationException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-179">If not, the collection or array cannot be sorted, and the method throws an  <xref:System.InvalidOperationException> exception.</span></span> <span data-ttu-id="7fc5e-180">下列範例會定義`Person`類別，兩個存放區`Person`泛型中的物件<xref:System.Collections.Generic.List%601>物件，並嘗試對它們進行排序。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-180">The following example defines a `Person` class, stores two `Person` objects in a generic <xref:System.Collections.Generic.List%601> object, and attempts to sort them.</span></span> <span data-ttu-id="7fc5e-181">從範例所示，呼叫輸出<xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType>方法會擲回<xref:System.InvalidOperationException>。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-181">As the output from the example shows, the call to the <xref:System.Collections.Generic.List%601.Sort?displayProperty=nameWithType> method throws an <xref:System.InvalidOperationException>.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#12](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort1.cs#12)]
 [!code-vb[System.InvalidOperationException#12](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort1.vb#12)]  
  
 <span data-ttu-id="7fc5e-182">您可以排除任何一種方式中的例外狀況：</span><span class="sxs-lookup"><span data-stu-id="7fc5e-182">You can eliminate the exception in any of three ways:</span></span>  
  
-   <span data-ttu-id="7fc5e-183">如果您可以擁有想要排序 （也就是如果您要控制其原始碼） 的類型，您可以修改來實作<xref:System.IComparable%601>或<xref:System.IComparable>介面。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-183">If you can own the type that you are trying to sort (that is, if you control its source code), you can modify it to implement the <xref:System.IComparable%601> or the <xref:System.IComparable> interface.</span></span> <span data-ttu-id="7fc5e-184">這需要，您實作<xref:System.IComparable%601.CompareTo%2A?displayProperty=nameWithType>或<xref:System.IComparable.CompareTo%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-184">This requires that you implement either the <xref:System.IComparable%601.CompareTo%2A?displayProperty=nameWithType> or the <xref:System.IComparable.CompareTo%2A> method.</span></span> <span data-ttu-id="7fc5e-185">介面實作新增至現有的類型不是一項重大變更。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-185">Adding an interface implementation to an existing type is not a breaking change.</span></span>  
  
     <span data-ttu-id="7fc5e-186">下列範例會使用這種方法提供<xref:System.IComparable%601>實作`Person`類別。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-186">The following example uses this approach to provide an <xref:System.IComparable%601> implementation  for the `Person` class.</span></span> <span data-ttu-id="7fc5e-187">集合或陣列的一般的排序方法，仍然可以呼叫，如範例輸出所示，成功地排序集合。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-187">You can still call the collection or array's general sorting method and, as the output from the example shows, the collection sorts successfully.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#13](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort2.cs#13)]
     [!code-vb[System.InvalidOperationException#13](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort2.vb#13)]  
  
-   <span data-ttu-id="7fc5e-188">如果您無法修改您嘗試排序的類型的原始程式碼，您可以定義特殊用途的排序類別可實作<xref:System.Collections.Generic.IComparer%601>介面。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-188">If you cannot modify the source code for the type you are trying to sort, you can define a special-purpose sorting class that implements the <xref:System.Collections.Generic.IComparer%601> interface.</span></span>  <span data-ttu-id="7fc5e-189">您可以呼叫的多載`Sort`方法包含<xref:System.Collections.Generic.IComparer%601>參數。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-189">You can call an overload of the `Sort` method that includes an  <xref:System.Collections.Generic.IComparer%601> parameter.</span></span> <span data-ttu-id="7fc5e-190">這個方法是特別有用，如果您想要開發可排序多個準則為基礎的物件的特定排序類別。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-190">This approach is especially useful if you want to develop a specialized sorting class that can sort objects based on multiple criteria.</span></span>  
  
     <span data-ttu-id="7fc5e-191">下列範例會使用此方法透過開發自訂`PersonComparer`類別，用來排序`Person`集合。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-191">The following example uses the approach by developing a custom `PersonComparer` class that is used to sort `Person` collections.</span></span>  <span data-ttu-id="7fc5e-192">接著，將這個類別的執行個體<xref:System.Collections.Generic.List%601.Sort%28System.Collections.Generic.IComparer%7B%600%7D%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-192">It then passes an instance of this class to the <xref:System.Collections.Generic.List%601.Sort%28System.Collections.Generic.IComparer%7B%600%7D%29?displayProperty=nameWithType> method.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#14](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort3.cs#14)]
     [!code-vb[System.InvalidOperationException#14](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort3.vb#14)]  
  
-   <span data-ttu-id="7fc5e-193">如果您無法修改類型的原始程式碼您正在嘗試排序，您可以建立<xref:System.Comparison%601>委派來執行排序。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-193">If you cannot modify the source code for the type you are trying to sort, you can create a  <xref:System.Comparison%601> delegate to perform the sorting.</span></span> <span data-ttu-id="7fc5e-194">委派簽章</span><span class="sxs-lookup"><span data-stu-id="7fc5e-194">The delegate signature is</span></span>  
  
    ```vb  
    Function Comparison(Of T)(x As T, y As T) As Integer  
    ```  
  
    ```csharp  
    int Comparison<T>(T x, T y)  
    ```  
  
     <span data-ttu-id="7fc5e-195">下列範例會使用此方法藉由定義`PersonComparison`方法符合<xref:System.Comparison%601>委派簽章。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-195">The following example uses the approach by defining a  `PersonComparison` method that matches the  <xref:System.Comparison%601> delegate signature.</span></span>  <span data-ttu-id="7fc5e-196">接著，將這個委派<xref:System.Collections.Generic.List%601.Sort%28System.Comparison%7B%600%7D%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-196">It then passes this delegate to the <xref:System.Collections.Generic.List%601.Sort%28System.Comparison%7B%600%7D%29?displayProperty=nameWithType> method.</span></span>  
  
     [!code-csharp[System.InvalidOperationException#15](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/List_Sort4.cs#15)]
     [!code-vb[System.InvalidOperationException#15](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/List_Sort4.vb#15)]  
  
<a name="Nullable"></a>   
### <a name="casting-a-nullablet-that-is-null-to-its-underlying-type"></a><span data-ttu-id="7fc5e-197">轉型將\<T > 為 null，為其基礎類型</span><span class="sxs-lookup"><span data-stu-id="7fc5e-197">Casting a Nullable\<T> that is null to its underlying type</span></span>  
 <span data-ttu-id="7fc5e-198">嘗試轉換<xref:System.Nullable%601>值為`null`轉為其基礎類型會擲回<xref:System.InvalidOperationException>例外狀況，並顯示錯誤訊息: 「**可為 Null 的物件必須具有值。**</span><span class="sxs-lookup"><span data-stu-id="7fc5e-198">Attempting to cast a <xref:System.Nullable%601> value that is `null` to its underlying type throws an <xref:System.InvalidOperationException> exception  and displays the error message, "**Nullable object must have a value.**</span></span>  
  
 <span data-ttu-id="7fc5e-199">下列範例會擲回<xref:System.InvalidOperationException>例外狀況時，它會嘗試以逐一查看陣列，其中包含`Nullable(Of Integer)`值。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-199">The following example throws an <xref:System.InvalidOperationException> exception  when it attempts to iterate an array that includes a `Nullable(Of Integer)` value.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#4](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Nullable1.cs#4)]
 [!code-vb[System.InvalidOperationException#4](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Nullable1.vb#4)]  
  
 <span data-ttu-id="7fc5e-200">若要避免這個例外狀況：</span><span class="sxs-lookup"><span data-stu-id="7fc5e-200">To prevent the exception:</span></span>  
  
-   <span data-ttu-id="7fc5e-201">使用<xref:System.Nullable%601.HasValue%2A?displayProperty=nameWithType>屬性，以選取那些不是的元素`null`。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-201">Use the <xref:System.Nullable%601.HasValue%2A?displayProperty=nameWithType> property to select only those elements that are not `null`.</span></span>  
  
-   <span data-ttu-id="7fc5e-202">呼叫其中一種<xref:System.Nullable%601.GetValueOrDefault%2A?displayProperty=nameWithType>提供的預設值的多載`null`值。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-202">Call one of the <xref:System.Nullable%601.GetValueOrDefault%2A?displayProperty=nameWithType> overloads to provide a default value for a `null` value.</span></span>  
  
 <span data-ttu-id="7fc5e-203">下列範例會執行同時避免<xref:System.InvalidOperationException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-203">The following example does both to avoid the  <xref:System.InvalidOperationException> exception.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#5](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Nullable2.cs#5)]
 [!code-vb[System.InvalidOperationException#5](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Nullable2.vb#5)]  
  
<a name="Empty"></a>   
### <a name="calling-a-systemlinqenumerable-method-on-an-empty-collection"></a><span data-ttu-id="7fc5e-204">在空集合上呼叫的 System.Linq.Enumerable 方法</span><span class="sxs-lookup"><span data-stu-id="7fc5e-204">Calling a System.Linq.Enumerable method on an empty collection</span></span>  
 <span data-ttu-id="7fc5e-205"><xref:System.Linq.Enumerable.Aggregate%2A?displayProperty=nameWithType>， <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType>， <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>， <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>， <xref:System.Linq.Enumerable.Max%2A?displayProperty=nameWithType>， <xref:System.Linq.Enumerable.Min%2A?displayProperty=nameWithType>， <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>，和<xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>方法在序列上執行作業，並傳回單一結果。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-205">The <xref:System.Linq.Enumerable.Aggregate%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Max%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Min%2A?displayProperty=nameWithType>,  <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>, and <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> methods perform operations on a sequence and return a single result.</span></span>   <span data-ttu-id="7fc5e-206">這些方法的某些多載會擲回<xref:System.InvalidOperationException>例外狀況序列若是空的雖然其他多載會傳回`null`。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-206">Some overloads of these methods throw an <xref:System.InvalidOperationException> exception when the sequence is empty, while other overloads return `null`.</span></span> <span data-ttu-id="7fc5e-207"><xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>方法也會擲回<xref:System.InvalidOperationException>例外狀況，當序列包含一個以上的項目。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-207">The <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method also throws an <xref:System.InvalidOperationException> exception when the sequence contains more than one element.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7fc5e-208">方法會擲回的大部分<xref:System.InvalidOperationException>例外狀況會多載。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-208">Most of the methods that throw an <xref:System.InvalidOperationException> exception are overloads.</span></span> <span data-ttu-id="7fc5e-209">請確定您了解您所選擇的多載的行為。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-209">Be sure that you understand the behavior of the overload that you choose.</span></span>  
  
 <span data-ttu-id="7fc5e-210">下表列出從例外狀況訊息<xref:System.InvalidOperationException>呼叫部分所擲回的例外狀況物件<xref:System.Linq.Enumerable?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-210">The following table lists the exception messages from the <xref:System.InvalidOperationException> exception objects thrown by calls to some <xref:System.Linq.Enumerable?displayProperty=nameWithType> methods.</span></span>  
  
|<span data-ttu-id="7fc5e-211">方法</span><span class="sxs-lookup"><span data-stu-id="7fc5e-211">Method</span></span>|<span data-ttu-id="7fc5e-212">訊息</span><span class="sxs-lookup"><span data-stu-id="7fc5e-212">Message</span></span>|  
|------------|-------------|  
|`Aggregate` <br /> `Average` <br /> `Last` <br /> `Max` <br /> `Min`|<span data-ttu-id="7fc5e-213">**序列未包含元素**</span><span class="sxs-lookup"><span data-stu-id="7fc5e-213">**Sequence contains no elements**</span></span>|  
|`First`|<span data-ttu-id="7fc5e-214">**序列包含沒有相符項目**</span><span class="sxs-lookup"><span data-stu-id="7fc5e-214">**Sequence contains no matching element**</span></span>|  
|`Single` <br /> `SingleOrDefault`|<span data-ttu-id="7fc5e-215">**序列包含一個以上相符的項目**</span><span class="sxs-lookup"><span data-stu-id="7fc5e-215">**Sequence contains more than one matching element**</span></span>|  
  
 <span data-ttu-id="7fc5e-216">排除或處理例外狀況的方式取決於您的應用程式假設以及在您呼叫的特定方法。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-216">How you eliminate or handle the exception depends on your application's assumptions and on the particular method you call.</span></span>  
  
-   <span data-ttu-id="7fc5e-217">當您刻意呼叫其中一種方法而不會檢查空的序列時，假設序列不是空白的、 和空的序列是未預期的元素。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-217">When you deliberately call one of these methods without checking for an empty sequence, you are assuming that the sequence is not empty, and that an empty sequence is an unexpected occurrence.</span></span> <span data-ttu-id="7fc5e-218">在此情況下，則捕捉或重新擲回例外狀況就適當。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-218">In this case, catching or rethrowing the exception is appropriate .</span></span>  
  
-   <span data-ttu-id="7fc5e-219">如果不小心將空序列檢查失敗，您可以呼叫其中一個多載的<xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType>多載來判斷序列是否包含任何項目。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-219">If your failure to check for an empty sequence was inadvertent, you can  call one of the overloads of the <xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType> overload to determine whether a sequence contains any elements.</span></span>  
  
    > [!TIP]
    >  <span data-ttu-id="7fc5e-220">呼叫<xref:System.Linq.Enumerable.Any%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType>再產生一連串的方法可以改善效能，如果要處理的資料可能包含大量項目，或如果產生序列的作業是高度耗費資源。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-220">Calling the <xref:System.Linq.Enumerable.Any%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> method before generating a sequence can improve performance if the data to be processed might contain a large number of elements or if operation that generates the sequence is expensive.</span></span>  
  
-   <span data-ttu-id="7fc5e-221">如果您已呼叫方法，例如<xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>， <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>，或<xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>，您也可以替代的替代方法，例如<xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType>， <xref:System.Linq.Enumerable.LastOrDefault%2A?displayProperty=nameWithType>，或<xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>，會傳回預設值，而不是成員的順序。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-221">If you've called a method such as <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.Last%2A?displayProperty=nameWithType>, or <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>, you can substitute an alternate method, such as <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType>, <xref:System.Linq.Enumerable.LastOrDefault%2A?displayProperty=nameWithType>, or  <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>, that returns a default value instead of a member of the sequence.</span></span>  
  
 <span data-ttu-id="7fc5e-222">範例提供其他詳細資料。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-222">The examples provide additional detail.</span></span>  
  
 <span data-ttu-id="7fc5e-223">下列範例會使用<xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType>方法來計算其值為大於 4 序列的平均值。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-223">The following example uses the <xref:System.Linq.Enumerable.Average%2A?displayProperty=nameWithType> method to compute the average of a sequence whose values are greater than 4.</span></span> <span data-ttu-id="7fc5e-224">由於原始陣列中的沒有任何值超過 4，任何值會包含在序列中，並且在方法擲回<xref:System.InvalidOperationException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-224">Since no values from the original array exceed 4, no values are included in the sequence, and the method throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#6](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable1.cs#6)]
 [!code-vb[System.InvalidOperationException#6](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable1.vb#6)]  
  
 <span data-ttu-id="7fc5e-225">例外狀況可以藉由呼叫排除<xref:System.Linq.Enumerable.Any%2A>方法來判斷序列是否包含任何項目之前呼叫方法的處理順序，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-225">The exception can be eliminated by calling the <xref:System.Linq.Enumerable.Any%2A> method to determine whether the sequence contains any elements before calling the method that processes the sequence, as the following example shows.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#7](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable2.cs#7)]
 [!code-vb[System.InvalidOperationException#7](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable2.vb#7)]  
  
 <span data-ttu-id="7fc5e-226"><xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>方法會傳回第一個項目序列中符合指定的條件的順序中的第一個項目。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-226">The <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> method returns the first item in a sequence or the first element in a sequence that satisfies a specified condition.</span></span> <span data-ttu-id="7fc5e-227">如果序列是空的因此也沒有第一個項目，它會擲回<xref:System.InvalidOperationException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-227">If the sequence is empty and therefore does not have a first element, it throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="7fc5e-228">在下列範例中，<xref:System.Linq.Enumerable.First%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType>方法會擲回<xref:System.InvalidOperationException>例外狀況因為 dbQueryResults 陣列沒有包含大於 4 的元素。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-228">In the following example, the <xref:System.Linq.Enumerable.First%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> method throws an <xref:System.InvalidOperationException> exception because the dbQueryResults array doesn't contain an element greater than 4.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#8](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable3.cs#8)]
 [!code-vb[System.InvalidOperationException#8](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable3.vb#8)]  
  
 <span data-ttu-id="7fc5e-229">您可以呼叫<xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType>方法，而非<xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>，傳回指定或預設值。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-229">You can call the <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType> method instead of <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> to return a specified or default value.</span></span> <span data-ttu-id="7fc5e-230">如果方法在序列中找不到第一個項目，它會傳回該資料類型的預設值。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-230">If the method does not find a first element in the sequence, it returns  the default value for that data type.</span></span>  <span data-ttu-id="7fc5e-231">預設值是`null`參考型別，零的數值資料類型，和<xref:System.DateTime.MinValue?displayProperty=nameWithType>如<xref:System.DateTime>型別。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-231">The default value is `null` for a reference type, zero for a numeric data type, and <xref:System.DateTime.MinValue?displayProperty=nameWithType> for the <xref:System.DateTime> type.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7fc5e-232">解譯所傳回的值<xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType>方法通常複雜類型的預設值可以是有效的值序列中的事實。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-232">Interpreting the value returned by the <xref:System.Linq.Enumerable.FirstOrDefault%2A?displayProperty=nameWithType> method is often complicated by the fact that the default value of the type can be a valid value in the sequence.</span></span> <span data-ttu-id="7fc5e-233">在此情況下，您呼叫<xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType>方法來判斷序列是否具有有效的成員，然後再呼叫<xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-233">In this case, you an call the <xref:System.Linq.Enumerable.Any%2A?displayProperty=nameWithType> method to determine whether the sequence has valid members before calling the <xref:System.Linq.Enumerable.First%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="7fc5e-234">下列範例會呼叫<xref:System.Linq.Enumerable.FirstOrDefault%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType>方法，以防止<xref:System.InvalidOperationException>前一個範例中擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-234">The following example calls the  <xref:System.Linq.Enumerable.FirstOrDefault%60%601%28System.Collections.Generic.IEnumerable%7B%60%600%7D%2CSystem.Func%7B%60%600%2CSystem.Boolean%7D%29?displayProperty=nameWithType> method to prevent the <xref:System.InvalidOperationException> exception thrown in the previous example.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#9](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable4.cs#9)]
 [!code-vb[System.InvalidOperationException#9](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable4.vb#9)]  
  
<a name="Single"></a>   
### <a name="calling-enumerablesingle-or-enumerablesingleordefault-on-a-sequence-without-one-element"></a><span data-ttu-id="7fc5e-235">上不含一個元素的順序呼叫 Enumerable.Single 或 Enumerable.SingleOrDefault</span><span class="sxs-lookup"><span data-stu-id="7fc5e-235">Calling Enumerable.Single or Enumerable.SingleOrDefault on a sequence without one element</span></span>  
 <span data-ttu-id="7fc5e-236"><xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>方法會傳回序列中，只有項目或序列中符合指定的條件的唯一項目。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-236">The <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> method returns the only element of a sequence, or the only element of a sequence that meets a specified condition.</span></span>    <span data-ttu-id="7fc5e-237">如果有任何項目在順序中，或如果有多個項目，方法會擲回<xref:System.InvalidOperationException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-237">If there are no elements in the sequence, or if there is more than one element , the method throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="7fc5e-238">您可以使用<xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>方法來傳回預設值，而不是擲回例外狀況，當序列中沒有包含任何項目。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-238">You can use the <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method to return a default value instead of throwing an exception when the sequence contains no elements.</span></span> <span data-ttu-id="7fc5e-239">不過，<xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>方法仍會擲回<xref:System.InvalidOperationException>例外狀況，當序列包含一個以上的項目。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-239">However, the <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method still throws an <xref:System.InvalidOperationException> exception  when the sequence contains more than one element.</span></span>  
  
 <span data-ttu-id="7fc5e-240">下表列出從例外狀況訊息<xref:System.InvalidOperationException>呼叫所擲回的例外狀況物件<xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>和<xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-240">The following table lists the exception messages from the <xref:System.InvalidOperationException> exception objects thrown by calls to the <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> and <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> methods.</span></span>  
  
|<span data-ttu-id="7fc5e-241">方法</span><span class="sxs-lookup"><span data-stu-id="7fc5e-241">Method</span></span>|<span data-ttu-id="7fc5e-242">訊息</span><span class="sxs-lookup"><span data-stu-id="7fc5e-242">Message</span></span>|  
|------------|-------------|  
|`Single`|<span data-ttu-id="7fc5e-243">**序列包含沒有相符項目**</span><span class="sxs-lookup"><span data-stu-id="7fc5e-243">**Sequence contains no matching element**</span></span>|  
|`Single` <br /> `SingleOrDefault`|<span data-ttu-id="7fc5e-244">**序列包含一個以上相符的項目**</span><span class="sxs-lookup"><span data-stu-id="7fc5e-244">**Sequence contains more than one matching element**</span></span>|  
  
 <span data-ttu-id="7fc5e-245">在下列範例中，呼叫<xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>方法會擲回<xref:System.InvalidOperationException>例外狀況因為順序不會包含大於 4 的元素。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-245">In the following example, the call to the <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> method throws an <xref:System.InvalidOperationException> exception because the sequence doesn't have an element greater than 4.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#10](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable5.cs#10)]
 [!code-vb[System.InvalidOperationException#10](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable5.vb#10)]  
  
 <span data-ttu-id="7fc5e-246">下列範例會嘗試防止<xref:System.InvalidOperationException>序列是空的改為呼叫時擲回的例外狀況<xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-246">The following example attempts to prevent the <xref:System.InvalidOperationException> exception thrown when a sequence is empty by instead calling the <xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="7fc5e-247">不過，由於此順序會傳回其值大於 2 的多個項目，它也會擲回<xref:System.InvalidOperationException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-247">However, because this sequence returns multiple elements whose value is greater than 2, it also throws an <xref:System.InvalidOperationException> exception.</span></span>  
  
 [!code-csharp[System.InvalidOperationException#11](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.invalidoperationexception/cs/Enumerable6.cs#11)]
 [!code-vb[System.InvalidOperationException#11](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.invalidoperationexception/vb/Enumerable6.vb#11)]  
  
 <span data-ttu-id="7fc5e-248">呼叫<xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType>方法會假設序列或符合指定的準則的順序包含只有一個項目。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-248">Calling the <xref:System.Linq.Enumerable.Single%2A?displayProperty=nameWithType> method assumes that either a sequence or the sequence that meets specified criteria contains only one element.</span></span>  <span data-ttu-id="7fc5e-249"><xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> 假設具有零個或一個結果，但沒有更多的順序。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-249"><xref:System.Linq.Enumerable.SingleOrDefault%2A?displayProperty=nameWithType> assumes a sequence with zero or one result, but no more.</span></span> <span data-ttu-id="7fc5e-250">這項假設您刻意建立一個，而且不符合這些條件，如果重新擲回或攔截產生<xref:System.InvalidOperationException>適合。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-250">If this assumption is a deliberate one on your part and these conditions are not met, rethrowing or catching the resulting <xref:System.InvalidOperationException> is appropriate.</span></span> <span data-ttu-id="7fc5e-251">否則，或如果您需要無效的條件會以某些頻率發生，您應該考慮使用其他<xref:System.Linq.Enumerable>方法，例如<xref:System.Linq.Enumerable.FirstOrDefault%2A>或<xref:System.Linq.Enumerable.Where%2A>。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-251">Otherwise, or if you expect that invalid conditions will occur with some frequency, you should consider using some other <xref:System.Linq.Enumerable> method, such as <xref:System.Linq.Enumerable.FirstOrDefault%2A> or <xref:System.Linq.Enumerable.Where%2A>.</span></span>  
  
<a name="Emit"></a>   
### <a name="dynamic-cross-application-domain-field-access"></a><span data-ttu-id="7fc5e-252">動態跨應用程式網域欄位存取權</span><span class="sxs-lookup"><span data-stu-id="7fc5e-252">Dynamic cross-application domain field access</span></span>  
 <span data-ttu-id="7fc5e-253"><xref:System.Reflection.Emit.OpCodes.Ldflda?displayProperty=nameWithType> Microsoft intermediate language (MSIL) 指令會擲回<xref:System.InvalidOperationException>如果包含的欄位想要擷取其位址的物件不在程式碼執行的應用程式定義域內的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-253">The <xref:System.Reflection.Emit.OpCodes.Ldflda?displayProperty=nameWithType> Microsoft intermediate language (MSIL) instruction throws an <xref:System.InvalidOperationException> exception if the object containing the field whose address you are trying to retrieve is not within the application domain in which your code is executing.</span></span> <span data-ttu-id="7fc5e-254">只能從它所在的應用程式網域存取欄位的位址。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-254">The address of a field can only be accessed from the application domain in which it resides.</span></span>  
  
<a name="Throwing"></a>   
## <a name="throwing-an-invalidoperationexception-exception"></a><span data-ttu-id="7fc5e-255">擲回 InvalidOperationException 例外狀況</span><span class="sxs-lookup"><span data-stu-id="7fc5e-255">Throwing an InvalidOperationException exception</span></span>  
 <span data-ttu-id="7fc5e-256">您應該擲回<xref:System.InvalidOperationException>基於某些原因您物件的狀態不支援特定的方法呼叫時，才例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-256">You should throw an <xref:System.InvalidOperationException> exception only when the state of your object for some reason does not support a particular method call.</span></span> <span data-ttu-id="7fc5e-257">也就是方法呼叫無效，在某些情況下或內容中，但不能用在其他人。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-257">That is, the method call is valid in some circumstances or contexts, but is invalid in others.</span></span>  
  
 <span data-ttu-id="7fc5e-258">如果方法引動過程失敗的原因是無效的引數，然後<xref:System.ArgumentException>或其衍生的類別，其中<xref:System.ArgumentNullException>或<xref:System.ArgumentOutOfRangeException>，應該改為擲回。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-258">If the method invocation failure is due to invalid arguments, then <xref:System.ArgumentException> or one of its derived classes, <xref:System.ArgumentNullException> or <xref:System.ArgumentOutOfRangeException>, should be thrown instead.</span></span>  
  
<a name="Misc"></a>   
## <a name="miscellaneous-information"></a><span data-ttu-id="7fc5e-259">其他資訊</span><span class="sxs-lookup"><span data-stu-id="7fc5e-259">Miscellaneous information</span></span>  
 <span data-ttu-id="7fc5e-260"><xref:System.InvalidOperationException> 會使用 HRESULT COR_E_INVALIDOPERATION，0x80131509 的值。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-260"><xref:System.InvalidOperationException> uses the HRESULT COR_E_INVALIDOPERATION, which has the value 0x80131509.</span></span>  
  
 <span data-ttu-id="7fc5e-261">如需執行個體的初始屬性值的清單<xref:System.InvalidOperationException>，請參閱<xref:System.InvalidOperationException.%23ctor%2A>建構函式。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-261">For a list of initial property values for an instance of <xref:System.InvalidOperationException>, see the <xref:System.InvalidOperationException.%23ctor%2A> constructors.</span></span>  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Exception" />
    <altmember cref="T:System.Collections.IEnumerator" />
    <altmember cref="T:System.Resources.ResourceSet" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="7fc5e-262">初始化 <see cref="T:System.InvalidOperationException" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-262">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InvalidOperationException ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InvalidOperationException();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="7fc5e-263">初始化 <see cref="T:System.InvalidOperationException" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-263">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7fc5e-264">這個建構函式初始化<xref:System.Exception.Message%2A>屬性的新執行個體的系統提供的訊息描述錯誤，例如 「 無法執行要求的作業。 」</span><span class="sxs-lookup"><span data-stu-id="7fc5e-264">This constructor initializes the <xref:System.Exception.Message%2A> property of the new instance to a system-supplied message that describes the error, such as "The requested operation cannot be performed."</span></span> <span data-ttu-id="7fc5e-265">此訊息會考量目前的系統文化特性。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-265">This message takes into account the current system culture.</span></span>  
  
 <span data-ttu-id="7fc5e-266">下表顯示 <xref:System.InvalidOperationException> 執行個體的初始屬性值。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-266">The following table shows the initial property values for an instance of <xref:System.InvalidOperationException>.</span></span>  
  
|<span data-ttu-id="7fc5e-267">屬性</span><span class="sxs-lookup"><span data-stu-id="7fc5e-267">Property</span></span>|<span data-ttu-id="7fc5e-268">值</span><span class="sxs-lookup"><span data-stu-id="7fc5e-268">Value</span></span>|  
|--------------|-----------|  
|<xref:System.Exception.InnerException%2A>|<span data-ttu-id="7fc5e-269">null 參考 (在 Visual Basic 中為 `Nothing`)。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-269">A null reference (`Nothing` in Visual Basic).</span></span>|  
|<xref:System.Exception.Message%2A>|<span data-ttu-id="7fc5e-270">當地語系化的錯誤訊息字串。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-270">The localized error message string.</span></span>|  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InvalidOperationException (string message);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InvalidOperationException(System::String ^ message);" />
      <MemberSignature Language="F#" Value="new InvalidOperationException : string -&gt; InvalidOperationException" Usage="new System.InvalidOperationException message" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="7fc5e-271">描述錯誤的訊息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-271">The message that describes the error.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7fc5e-272">使用指定的錯誤訊息，初始化 <see cref="T:System.InvalidOperationException" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-272">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class with a specified error message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7fc5e-273">這個建構函式初始化<xref:System.Exception.Message%2A?displayProperty=nameWithType>屬性的新的例外狀況使用`message`參數。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-273">This constructor initializes the <xref:System.Exception.Message%2A?displayProperty=nameWithType> property of the new exception using the `message` parameter.</span></span> <span data-ttu-id="7fc5e-274">`message` 的內容必須能讓人了解。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-274">The content of `message` is intended to be understood by humans.</span></span> <span data-ttu-id="7fc5e-275">這個建構函式的呼叫端必須確保這個字串已經被當地語系化 (為了目前系統的文化特性)。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-275">The caller of this constructor is required to ensure that this string has been localized for the current system culture.</span></span>  
  
 <span data-ttu-id="7fc5e-276">下表顯示 <xref:System.InvalidOperationException> 執行個體的初始屬性值。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-276">The following table shows the initial property values for an instance of <xref:System.InvalidOperationException>.</span></span>  
  
|<span data-ttu-id="7fc5e-277">屬性</span><span class="sxs-lookup"><span data-stu-id="7fc5e-277">Property</span></span>|<span data-ttu-id="7fc5e-278">值</span><span class="sxs-lookup"><span data-stu-id="7fc5e-278">Value</span></span>|  
|--------------|-----------|  
|<xref:System.Exception.InnerException%2A>|<span data-ttu-id="7fc5e-279">null 參考 (在 Visual Basic 中為 `Nothing`)。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-279">A null reference (`Nothing` in Visual Basic).</span></span>|  
|<xref:System.Exception.Message%2A>|<span data-ttu-id="7fc5e-280">錯誤訊息字串。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-280">The error message string.</span></span>|  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="protected InvalidOperationException (System.Runtime.Serialization.SerializationInfo info, System.Runtime.Serialization.StreamingContext context);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig specialname rtspecialname instance void .ctor(class System.Runtime.Serialization.SerializationInfo info, valuetype System.Runtime.Serialization.StreamingContext context) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor(System.Runtime.Serialization.SerializationInfo,System.Runtime.Serialization.StreamingContext)" />
      <MemberSignature Language="VB.NET" Value="Protected Sub New (info As SerializationInfo, context As StreamingContext)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; InvalidOperationException(System::Runtime::Serialization::SerializationInfo ^ info, System::Runtime::Serialization::StreamingContext context);" />
      <MemberSignature Language="F#" Value="new InvalidOperationException : System.Runtime.Serialization.SerializationInfo * System.Runtime.Serialization.StreamingContext -&gt; InvalidOperationException" Usage="new System.InvalidOperationException (info, context)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="info" Type="System.Runtime.Serialization.SerializationInfo" />
        <Parameter Name="context" Type="System.Runtime.Serialization.StreamingContext" />
      </Parameters>
      <Docs>
        <param name="info">
          <span data-ttu-id="7fc5e-281">存放序列物件資料的物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-281">The object that holds the serialized object data.</span>
          </span>
        </param>
        <param name="context">
          <span data-ttu-id="7fc5e-282">關於來源或目的端的內容資訊。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-282">The contextual information about the source or destination.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7fc5e-283">使用序列化資料，初始化 <see cref="T:System.InvalidOperationException" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-283">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class with serialized data.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7fc5e-284">進行還原序列化 (Deserialization) 期間會呼叫這個建構函式，以便重新構成經由資料流傳送的例外狀況物件。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-284">This constructor is called during deserialization to reconstitute the exception object transmitted over a stream.</span></span> <span data-ttu-id="7fc5e-285">如需詳細資訊，請參閱[XML 和 SOAP 序列化](~/docs/standard/serialization/xml-and-soap-serialization.md)。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-285">For more information, see [XML and SOAP Serialization](~/docs/standard/serialization/xml-and-soap-serialization.md).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InvalidOperationException (string message, Exception innerException);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string message, class System.Exception innerException) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.InvalidOperationException.#ctor(System.String,System.Exception)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (message As String, innerException As Exception)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InvalidOperationException(System::String ^ message, Exception ^ innerException);" />
      <MemberSignature Language="F#" Value="new InvalidOperationException : string * Exception -&gt; InvalidOperationException" Usage="new System.InvalidOperationException (message, innerException)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="innerException" Type="System.Exception" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="7fc5e-286">解釋例外狀況原因的錯誤訊息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-286">The error message that explains the reason for the exception.</span>
          </span>
        </param>
        <param name="innerException">
          <span data-ttu-id="7fc5e-287">做為目前例外狀況發生原因的例外狀況。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-287">The exception that is the cause of the current exception.</span>
          </span>
          <span data-ttu-id="7fc5e-288">如果 <c>innerException</c> 參數不是 Null 參考 (在 Visual Basic 中為 <see langword="Nothing" />)，則會在處理內部例外狀況的 <see langword="catch" /> 區塊中引發目前的例外狀況。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-288">If the <c>innerException</c> parameter is not a null reference (<see langword="Nothing" /> in Visual Basic), the current exception is raised in a <see langword="catch" /> block that handles the inner exception.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7fc5e-289">使用指定的錯誤訊息以及造成此例外狀況的內部例外狀況的參考，初始化 <see cref="T:System.InvalidOperationException" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7fc5e-289">Initializes a new instance of the <see cref="T:System.InvalidOperationException" /> class with a specified error message and a reference to the inner exception that is the cause of this exception.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7fc5e-290">被擲回以做為前一個例外狀況直接結果的例外狀況，應該在 <xref:System.Exception.InnerException%2A> 屬性中包含對前一個例外狀況的參考。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-290">An exception that is thrown as a direct result of a previous exception should include a reference to the previous exception in the <xref:System.Exception.InnerException%2A> property.</span></span> <span data-ttu-id="7fc5e-291"><xref:System.Exception.InnerException%2A> 屬性會傳回與傳入建構函式中相同的值；如果 `Nothing` 屬性不提供內部例外值給建構函式，則傳回 null 參考 (在 Visual Basic 中為 <xref:System.Exception.InnerException%2A>)。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-291">The <xref:System.Exception.InnerException%2A> property returns the same value that is passed into the constructor, or a null reference (`Nothing` in Visual Basic) if the <xref:System.Exception.InnerException%2A> property does not supply the inner exception value to the constructor.</span></span>  
  
 <span data-ttu-id="7fc5e-292">下表顯示 <xref:System.InvalidOperationException> 執行個體的初始屬性值。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-292">The following table shows the initial property values for an instance of <xref:System.InvalidOperationException>.</span></span>  
  
|<span data-ttu-id="7fc5e-293">屬性</span><span class="sxs-lookup"><span data-stu-id="7fc5e-293">Property</span></span>|<span data-ttu-id="7fc5e-294">值</span><span class="sxs-lookup"><span data-stu-id="7fc5e-294">Value</span></span>|  
|--------------|-----------|  
|<xref:System.Exception.InnerException%2A>|<span data-ttu-id="7fc5e-295">內部例外狀況參考。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-295">The inner exception reference.</span></span>|  
|<xref:System.Exception.Message%2A>|<span data-ttu-id="7fc5e-296">錯誤訊息字串。</span><span class="sxs-lookup"><span data-stu-id="7fc5e-296">The error message string.</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Exception" />
      </Docs>
    </Member>
  </Members>
</Type>