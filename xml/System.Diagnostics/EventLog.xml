<Type Name="EventLog" FullName="System.Diagnostics.EventLog">
  <Metadata><Meta Name="ms.openlocfilehash" Value="1157637142877c8e0f72b6d309ff09523ac44ed4" /><Meta Name="ms.sourcegitcommit" Value="adc8598fd19d91438cacaa8fa7ce613e28c8218e" /><Meta Name="ms.translationtype" Value="HT" /><Meta Name="ms.contentlocale" Value="zh-TW" /><Meta Name="ms.lasthandoff" Value="12/11/2018" /><Meta Name="ms.locfileid" Value="53233220" /></Metadata><TypeSignature Language="C#" Value="public class EventLog : System.ComponentModel.Component, System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit EventLog extends System.ComponentModel.Component implements class System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="DocId" Value="T:System.Diagnostics.EventLog" />
  <TypeSignature Language="VB.NET" Value="Public Class EventLog&#xA;Inherits Component&#xA;Implements ISupportInitialize" />
  <TypeSignature Language="C++ CLI" Value="public ref class EventLog : System::ComponentModel::Component, System::ComponentModel::ISupportInitialize" />
  <TypeSignature Language="F#" Value="type EventLog = class&#xA;    inherit Component&#xA;    interface ISupportInitialize" />
  <AssemblyInfo>
    <AssemblyName>System</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.ComponentModel.ISupportInitialize</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
      <AttributeName>System.ComponentModel.DefaultEvent("EntryWritten")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="xamarinmac-3.0">
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Diagnostics.EventLogInstaller))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="xamarinmac-3.0">
      <AttributeName>System.Diagnostics.MonitoringDescription("Represents an event log")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Designer("Microsoft.VisualStudio.Install.EventLogInstallableComponentDesigner, Microsoft.VisualStudio, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
      <AttributeName>System.Diagnostics.MonitoringDescription("EventLogDesc")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="2b88f-101">提供與 Windows 事件記錄檔的互動。</span><span class="sxs-lookup"><span data-stu-id="2b88f-101">Provides interaction with Windows event logs.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-102"><xref:System.Diagnostics.EventLog> 可讓您存取或自訂 Windows 事件記錄檔記錄重要的軟體或硬體事件的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-102"><xref:System.Diagnostics.EventLog> lets you access or customize Windows event logs, which record information about important software or hardware events.</span></span> <span data-ttu-id="2b88f-103">使用<xref:System.Diagnostics.EventLog>，您可以從現有的記錄檔讀取、 寫入記錄檔中的項目、 建立或刪除事件來源、 刪除記錄檔，並回應記錄項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-103">Using <xref:System.Diagnostics.EventLog>, you can read from existing logs, write entries to logs, create or delete event sources, delete logs, and respond to log entries.</span></span> <span data-ttu-id="2b88f-104">建立事件來源時，您也可以建立新的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-104">You can also create new logs when creating an event source.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="2b88f-105">此類型會實作<xref:System.IDisposable>介面。</span><span class="sxs-lookup"><span data-stu-id="2b88f-105">This type implements the <xref:System.IDisposable> interface.</span></span> <span data-ttu-id="2b88f-106">當您完成使用型別時，您應該處置它直接或間接。</span><span class="sxs-lookup"><span data-stu-id="2b88f-106">When you have finished using the type, you should dispose of it either directly or indirectly.</span></span> <span data-ttu-id="2b88f-107">若要直接處置型別，呼叫其<xref:System.IDisposable.Dispose%2A>方法中的`try` / `catch`區塊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-107">To dispose of the type directly, call its <xref:System.IDisposable.Dispose%2A> method in a `try`/`catch` block.</span></span> <span data-ttu-id="2b88f-108">若要處置它間接，使用的語言建構這類`using`（在 C# 中) 或`Using`（在 Visual Basic)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-108">To dispose of it indirectly, use a language construct such as `using` (in C#) or `Using` (in Visual Basic).</span></span> <span data-ttu-id="2b88f-109">如需詳細資訊，請參閱 「 使用物件，實作 IDisposable 」 一節<xref:System.IDisposable>介面 > 主題。</span><span class="sxs-lookup"><span data-stu-id="2b88f-109">For more information, see the "Using an Object that Implements IDisposable" section in the <xref:System.IDisposable> interface topic.</span></span>  
  
 <span data-ttu-id="2b88f-110">除了存取個別的事件記錄檔和其項目，<xref:System.Diagnostics.EventLog>類別可讓您存取所有事件記錄檔的集合。</span><span class="sxs-lookup"><span data-stu-id="2b88f-110">In addition to providing access to individual event logs and their entries, the <xref:System.Diagnostics.EventLog> class lets you access the collection of all event logs.</span></span> <span data-ttu-id="2b88f-111">您可以使用`static`的成員<xref:System.Diagnostics.EventLog>來刪除記錄，請取得記錄清單、 建立或刪除來源，或判斷電腦是否已包含特定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-111">You can use the `static` members of <xref:System.Diagnostics.EventLog> to delete logs, get log lists, create or delete a source, or determine if a computer already contains a particular source.</span></span>  
  
 <span data-ttu-id="2b88f-112">有三個預設事件記錄檔：應用程式、 系統及安全性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-112">There are three default event logs: Application, System, and Security.</span></span> <span data-ttu-id="2b88f-113">安全性記錄檔是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="2b88f-113">A Security log is read-only.</span></span> <span data-ttu-id="2b88f-114">其他應用程式和服務安裝，例如 Active Directory 中，可能會有額外的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-114">Other applications and services you install, such as Active Directory, might have additional event logs.</span></span>  
  
 <span data-ttu-id="2b88f-115">使用時，有一些安全性考量<xref:System.Diagnostics.EventLog>類別。</span><span class="sxs-lookup"><span data-stu-id="2b88f-115">There are security considerations when using the <xref:System.Diagnostics.EventLog> class.</span></span> <span data-ttu-id="2b88f-116"><xref:System.Diagnostics.EventLog> 需要<xref:System.Diagnostics.EventLogPermission>特定的動作，在.NET Framework 2.0 和更新版本中或在.NET Framework 1.0 和 1.1 版中的完全信任權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-116"><xref:System.Diagnostics.EventLog> requires <xref:System.Diagnostics.EventLogPermission> permissions for specific actions in the .NET Framework 2.0 and later versions, or full trust in the .NET Framework 1.0 and 1.1.</span></span> <span data-ttu-id="2b88f-117">我們建議<xref:System.Diagnostics.EventLogPermission>不授與部分信任程式碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-117">We recommend that <xref:System.Diagnostics.EventLogPermission> not be granted to partially trusted code.</span></span>  <span data-ttu-id="2b88f-118">您應該永遠不會傳遞任何事件記錄檔物件，包括<xref:System.Diagnostics.EventLogEntryCollection>和<xref:System.Diagnostics.EventLogEntry>較不受信任的程式碼的物件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-118">You should never pass any event log object, including <xref:System.Diagnostics.EventLogEntryCollection> and <xref:System.Diagnostics.EventLogEntry> objects, to less trusted code.</span></span> <span data-ttu-id="2b88f-119">例如，建立<xref:System.Diagnostics.EventLog>物件，寫入項目，然後再將傳遞<xref:System.Diagnostics.EventLog>物件到部分受信任的程式碼可以建立安全性問題，因為能夠讀取和寫入事件記錄檔可執行動作，例如發出的程式碼事件記錄檔訊息，另一個應用程式的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-119">For example, creating an <xref:System.Diagnostics.EventLog> object, writing an entry, and then passing the <xref:System.Diagnostics.EventLog> object to partially trusted code can create a security issue, because the ability to read and write to the event log allows code to perform actions such as issuing event log messages in the name of another application.</span></span>  
  
 <span data-ttu-id="2b88f-120">從 Windows Vista 開始，使用者帳戶控制 (UAC) 會決定使用者的認證。</span><span class="sxs-lookup"><span data-stu-id="2b88f-120">Starting with Windows Vista, User Account Control (UAC) determines the credentials of a user.</span></span> <span data-ttu-id="2b88f-121">如果您是內建 Administrators 群組的成員，系統會將兩個執行階段存取語彙基元 (Token) 指派給您：標準使用者存取語彙基元及管理員存取語彙基元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-121">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="2b88f-122">根據預設，您會屬於標準使用者角色。</span><span class="sxs-lookup"><span data-stu-id="2b88f-122">By default, you are in the standard user role.</span></span> <span data-ttu-id="2b88f-123">若要執行的程式碼存取安全性記錄檔，您必須先將您的認證從標準使用者提高為系統管理員。</span><span class="sxs-lookup"><span data-stu-id="2b88f-123">To run the code that accesses the Security log, you must first elevate your credentials from standard user to administrator.</span></span> <span data-ttu-id="2b88f-124">您可以藉由開啟應用程式的捷徑功能表來啟動應用程式時 （如果您使用滑鼠，以滑鼠右鍵按一下應用程式圖示），並指出您想要以系統管理員身分執行。</span><span class="sxs-lookup"><span data-stu-id="2b88f-124">You can do this when you start an application by opening the shortcut menu for the application (if you're using a mouse, right-click the application icon) and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="2b88f-125">您可以使用<xref:System.Diagnostics.EventLog>若要建立自訂的事件記錄檔，您可以透過伺服器檢視的 事件檢視器。</span><span class="sxs-lookup"><span data-stu-id="2b88f-125">You can use <xref:System.Diagnostics.EventLog> to create custom event logs that you can view through the server's Event Viewer.</span></span> <span data-ttu-id="2b88f-126">使用<xref:System.Diagnostics.EventLog.RegisterDisplayName%2A>方法，以在事件檢視器中顯示您的事件記錄檔的當地語系化的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-126">Use the <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> method to display a localized name for your event log in the Event Viewer.</span></span> <span data-ttu-id="2b88f-127">使用<xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>來設定事件記錄檔的行為，當它達到最大記錄檔大小的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-127">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to configure the behavior of your event log when it reaches its maximum log size.</span></span>  
  
 <span data-ttu-id="2b88f-128">若要讀取事件記錄檔，請指定 記錄檔名稱 (<xref:System.Diagnostics.EventLog.Log%2A>屬性) 和伺服器電腦名稱 (<xref:System.Diagnostics.EventLog.MachineName%2A>事件記錄檔的屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-128">To read from an event log, specify the log name (<xref:System.Diagnostics.EventLog.Log%2A> property) and server computer name (<xref:System.Diagnostics.EventLog.MachineName%2A> property for the event log.</span></span> <span data-ttu-id="2b88f-129">如果您未指定伺服器的電腦名稱，本機電腦中，"。"，會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-129">If you don't specify the server computer name, the local computer, ".", is assumed.</span></span> <span data-ttu-id="2b88f-130">您不需要指定事件來源 (<xref:System.Diagnostics.EventLog.Source%2A>屬性)，因為來源是只有需要寫入記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-130">It's not necessary to specify the event source (<xref:System.Diagnostics.EventLog.Source%2A> property), because a source is required only for writing to logs.</span></span> <span data-ttu-id="2b88f-131"><xref:System.Diagnostics.EventLog.Entries%2A>屬性會自動填入的項目事件記錄檔的清單。</span><span class="sxs-lookup"><span data-stu-id="2b88f-131">The  <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated with the event log's list of entries.</span></span>  
  
 <span data-ttu-id="2b88f-132">若要寫入事件記錄檔，指定或建立事件來源 (<xref:System.Diagnostics.EventLog.Source%2A>屬性)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-132">To write to an event log, specify or create an event source (<xref:System.Diagnostics.EventLog.Source%2A> property).</span></span> <span data-ttu-id="2b88f-133">您必須具有系統管理認證，以建立新的事件來源電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-133">You must have administrative credentials on the computer to create a new event source.</span></span> <span data-ttu-id="2b88f-134">事件來源會註冊您的應用程式事件記錄檔做為有效的來源項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-134">The event source registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="2b88f-135">您可以使用事件來源寫入一次只能有一個記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-135">You can use the event source  to write to only one log at a time.</span></span> <span data-ttu-id="2b88f-136"><xref:System.Diagnostics.EventLog.Source%2A>屬性可以是任何隨機字串，但必須是相異的電腦上的其他來源的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-136">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any random string, but the name must be distinct from other sources on the computer.</span></span> <span data-ttu-id="2b88f-137">事件來源通常是應用程式或另一個的識別字串的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-137">The event source is typically the name of the application or another identifying string.</span></span> <span data-ttu-id="2b88f-138">嘗試建立重複<xref:System.Diagnostics.EventLog.Source%2A>值就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="2b88f-138">Trying to create a duplicate <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="2b88f-139">不過，單一的事件記錄檔可以與多個來源相關聯。</span><span class="sxs-lookup"><span data-stu-id="2b88f-139">However, a single event log can be associated with multiple sources.</span></span>  
  
 <span data-ttu-id="2b88f-140">如果與相關聯的事件記錄檔的事件來源<xref:System.Diagnostics.EventLog>執行個體不存在，會建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-140">If the event source for the event log associated with the <xref:System.Diagnostics.EventLog> instance doesn't exist, a new event source is created.</span></span> <span data-ttu-id="2b88f-141">若要建立事件來源，在 Windows Vista 和更新版本或 Windows Server 2003，您必須具有系統管理認證。</span><span class="sxs-lookup"><span data-stu-id="2b88f-141">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative credentials.</span></span>  
  
 <span data-ttu-id="2b88f-142">這項需求是因為所有的事件記錄檔，包括安全性記錄檔，必須搜尋以判斷事件來源是否為唯一。</span><span class="sxs-lookup"><span data-stu-id="2b88f-142">This requirement is because all event logs, including Security logs, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="2b88f-143">從 Windows Vista 開始，使用者沒有權限以存取安全性記錄檔中;因此，<xref:System.Security.SecurityException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="2b88f-143">Starting with Windows Vista, users do not have permission to access the Security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="2b88f-144">使用具名的 mutex 建立或刪除事件來源時，需要同步處理的基礎程式碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-144">Creating or deleting an event source requires synchronization of the underlying code by using a named mutex.</span></span> <span data-ttu-id="2b88f-145">如果高特殊權限的應用程式鎖定具名的 mutex，嘗試建立或刪除事件來源產生應用程式停止回應，直到鎖定解除為止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-145">If a highly privileged application locks the named mutex, trying to create or delete an event source causes the application to stop responding until the lock is released.</span></span> <span data-ttu-id="2b88f-146">若要避免此問題，永遠不會授與<xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode>不受信任的程式碼的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-146">To help prevent this problem, never grant <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission to untrusted code.</span></span> <span data-ttu-id="2b88f-147">颾魤 ㄛ<xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode>權限可能會允許略過其他權限，以及只應該授與高度信任程式碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-147">In addition, <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission potentially allows other permissions to be bypassed and should only be granted to highly trusted code.</span></span>  
  
 <span data-ttu-id="2b88f-148">應用程式和服務應該將寫入應用程式記錄檔或自訂的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-148">Applications and services should write to the Application log or to a custom log.</span></span> <span data-ttu-id="2b88f-149">裝置驅動程式應該寫入至系統記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-149">Device drivers should write to the System log.</span></span> <span data-ttu-id="2b88f-150">如果您沒有明確設定<xref:System.Diagnostics.EventLog.Log%2A>屬性預設為應用程式記錄檔的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-150">If you do not explicitly set the <xref:System.Diagnostics.EventLog.Log%2A> property, the event log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-151">沒有要保護的應用程式，從撰寫為任何已註冊的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-151">There is nothing to protect an application from writing as any registered source.</span></span>  <span data-ttu-id="2b88f-152">如果應用程式授與<xref:System.Diagnostics.EventLogPermissionAccess.Write>權限，它可以寫入之事件的任何有效的來源電腦上登錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-152">If an application is granted <xref:System.Diagnostics.EventLogPermissionAccess.Write> permission, it can write events for any valid source registered on the computer.</span></span>  
  
 <span data-ttu-id="2b88f-153">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>將事件寫入事件記錄檔的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-153">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods to write events to an event log.</span></span> <span data-ttu-id="2b88f-154">您必須指定要寫入事件，事件來源您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-154">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="2b88f-155">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-155">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-156">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-156">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-157">如果作業系統尚未重新整理其事件來源的清單，而且您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-157">If the operating system hasn't refreshed its list of event sources, and you try to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-158">您可以使用，以設定新的來源<xref:System.Diagnostics.EventLogInstaller>物件或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-158">You can configure a new source by using an <xref:System.Diagnostics.EventLogInstaller> object or the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-159">您必須具有系統管理認證，以建立新的事件來源電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-159">You must have administrative credentials on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-160">每個來源一次; 可以寫入只有一個事件記錄檔不過，您的應用程式也可以使用多個來源，以寫入多個事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-160">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="2b88f-161">例如，您的應用程式可能需要多個來源設定為不同的事件記錄檔或不同的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-161">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span> <span data-ttu-id="2b88f-162">若要變更現有的來源的設定詳細資料，您必須刪除來源，並再建立新的組態。</span><span class="sxs-lookup"><span data-stu-id="2b88f-162">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="2b88f-163">如果其他應用程式或元件使用現有的來源，建立新的來源與更新的組態，而不是刪除現有的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-163">If other applications or components use the existing source, create a new source with the updated configuration instead of deleting the existing source.</span></span>  
  
 <span data-ttu-id="2b88f-164">您可以在您的事件類別目錄和訊息字串的當地語系化資源註冊事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-164">You can register the event source with localized resources for your event category and message strings.</span></span> <span data-ttu-id="2b88f-165">您的應用程式可以使用資源識別碼，而不是指定實際的字串值寫入事件記錄檔項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-165">Your application can write event log entries by using resource identifiers instead of specifying the actual string values.</span></span> <span data-ttu-id="2b88f-166">請參閱<xref:System.Diagnostics.EventLogInstaller>和<xref:System.Diagnostics.EventSourceCreationData>類別，如需有關設定您的來源資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-166">Refer to the <xref:System.Diagnostics.EventLogInstaller> and <xref:System.Diagnostics.EventSourceCreationData> classes for more information about configuring your source with resource files.</span></span>  
  
 <span data-ttu-id="2b88f-167">如果您的應用程式會將字串值，直接寫入事件記錄檔，您不必設定資源的來源檔案內容。</span><span class="sxs-lookup"><span data-stu-id="2b88f-167">If your application writes string values directly to the event log, you do not have to set the resource file properties for the source.</span></span> <span data-ttu-id="2b88f-168">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-168">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-169">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-169">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-170">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-170">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-171">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-171">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="2b88f-172">當寫入事件時，您至少必須指定的訊息字串或將訊息字串的資源識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-172">When writing events, you must at least specify either a message string or the resource identifier for a message string.</span></span> <span data-ttu-id="2b88f-173">其他事件屬性是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="2b88f-173">Other event properties are optional.</span></span> <span data-ttu-id="2b88f-174">選擇性的事件設定的範例包括下列各項：</span><span class="sxs-lookup"><span data-stu-id="2b88f-174">Examples of optional event settings include the following:</span></span>  
  
-   <span data-ttu-id="2b88f-175">您可以設定<xref:System.Diagnostics.EventLogEntryType>來指定 事件檢視器顯示之項目的圖示。</span><span class="sxs-lookup"><span data-stu-id="2b88f-175">You can set the <xref:System.Diagnostics.EventLogEntryType> to specify the icon that the Event Viewer displays for the entry.</span></span>  
  
-   <span data-ttu-id="2b88f-176">如果您的應用程式會使用分類來篩選事件，您可以指定事件的類別識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-176">You can specify a category identifier for the event, if your application uses categories for filtering the events.</span></span>  
  
-   <span data-ttu-id="2b88f-177">如果您想要指定的事件相關聯的其他資訊，您可以將二進位資料附加至您的事件項目中。</span><span class="sxs-lookup"><span data-stu-id="2b88f-177">You can attach binary data to your event entry if you want to associate additional information with a given event.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="2b88f-178">事件記錄會消耗磁碟空間、 處理器時間，以及其他系統資源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-178">Event logging consumes disk space, processor time, and other system resources.</span></span> <span data-ttu-id="2b88f-179">請務必記錄必要的資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-179">It is important to log only essential information.</span></span> <span data-ttu-id="2b88f-180">我們建議您將事件記錄檔呼叫放在錯誤路徑，而不是在主要程式碼路徑中，因此它們不效能產生負面影響。</span><span class="sxs-lookup"><span data-stu-id="2b88f-180">We recommend that you place event log calls in an error path, rather than in the main code path, so they don't adversely affect performance.</span></span>  
  
 <span data-ttu-id="2b88f-181">如需執行個體的初始屬性值的清單<xref:System.Diagnostics.EventLog>，請參閱<xref:System.Diagnostics.EventLog.%23ctor%2A>建構函式。</span><span class="sxs-lookup"><span data-stu-id="2b88f-181">For a list of initial property values for an instance of <xref:System.Diagnostics.EventLog>, see the <xref:System.Diagnostics.EventLog.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-182">下列範例會建立事件來源`MySource`如果尚未存在，它的項目寫入事件記錄檔`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-182">The following example creates the event source `MySource` if it doesn't already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-183">從 Windows Vista 開始，您必須以系統管理員身分執行此應用程式。</span><span class="sxs-lookup"><span data-stu-id="2b88f-183">Starting with Windows Vista, you must run this application as an administrator.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Diagnostics.EventLogInstaller" />
    <altmember cref="T:System.Diagnostics.EventLogEntry" />
    <altmember cref="T:System.Diagnostics.EntryWrittenEventArgs" />
    <altmember cref="T:System.ServiceProcess.ServiceBase" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="2b88f-184">初始化 <see cref="T:System.Diagnostics.EventLog" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-184">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="2b88f-185">初始化 <see cref="T:System.Diagnostics.EventLog" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-185">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="2b88f-186">不讓執行個體和任何記錄檔產生關聯。</span><span class="sxs-lookup"><span data-stu-id="2b88f-186">Does not associate the instance with any log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-187">然後再呼叫<xref:System.Diagnostics.EventLog.WriteEntry%2A>，指定<xref:System.Diagnostics.EventLog.Source%2A>屬性<xref:System.Diagnostics.EventLog>執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-187">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="2b88f-188">如果您僅讀取<xref:System.Diagnostics.EventLog.Entries%2A>從記錄檔中，您也可以指定僅<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-188">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-189">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-189">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-190">下表顯示的執行個體的初始屬性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-190">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="2b88f-191">屬性</span><span class="sxs-lookup"><span data-stu-id="2b88f-191">Property</span></span>|<span data-ttu-id="2b88f-192">初始值</span><span class="sxs-lookup"><span data-stu-id="2b88f-192">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="2b88f-193">空字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-193">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="2b88f-194">空字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-194">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="2b88f-195">在本機電腦 ("。")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-195">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-196">下列範例會建立來源`MySource`如果不存在，它的項目寫入事件記錄檔`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-196">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-197">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-197">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-198">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-198">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog logName" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="2b88f-199">本機電腦上的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-199">The name of the log on the local computer.</span></span></param>
        <summary><span data-ttu-id="2b88f-200">初始化 <see cref="T:System.Diagnostics.EventLog" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-200">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="2b88f-201">讓執行個體與本機電腦上的記錄檔產生關聯。</span><span class="sxs-lookup"><span data-stu-id="2b88f-201">Associates the instance with a log on the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-202">設定這個多載<xref:System.Diagnostics.EventLog.Log%2A>屬性設`logName`參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-202">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter.</span></span> <span data-ttu-id="2b88f-203">然後再呼叫<xref:System.Diagnostics.EventLog.WriteEntry%2A>，指定<xref:System.Diagnostics.EventLog.Source%2A>屬性<xref:System.Diagnostics.EventLog>執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-203">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="2b88f-204">如果您僅讀取<xref:System.Diagnostics.EventLog.Entries%2A>從記錄檔中，您也可以指定僅<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-204">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-205">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-205">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span> <span data-ttu-id="2b88f-206">這個多載的建構函式指定<xref:System.Diagnostics.EventLog.Log%2A>屬性，但您可以變更此讀取前<xref:System.Diagnostics.EventLog.Entries%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-206">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> property, but you can change this before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="2b88f-207">如果您在指定的來源<xref:System.Diagnostics.EventLog.Source%2A>屬性是唯一的電腦，後續呼叫上的其他來源<xref:System.Diagnostics.EventLog.WriteEntry%2A>建立記錄，其指定的名稱，如果不存在。</span><span class="sxs-lookup"><span data-stu-id="2b88f-207">If the source you specify in the <xref:System.Diagnostics.EventLog.Source%2A> property is unique from other sources on the computer, a subsequent call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> creates a log with the specified name, if it does not already exist.</span></span>  
  
 <span data-ttu-id="2b88f-208">下表顯示的執行個體的初始屬性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-208">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="2b88f-209">屬性</span><span class="sxs-lookup"><span data-stu-id="2b88f-209">Property</span></span>|<span data-ttu-id="2b88f-210">初始值</span><span class="sxs-lookup"><span data-stu-id="2b88f-210">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="2b88f-211">空字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-211">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="2b88f-212">`logName` 參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-212">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="2b88f-213">在本機電腦 ("。")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-213">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-214">下列範例會讀取事件記錄檔，而"myNewLog 」，在本機電腦中的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-214">The following example reads entries in the event log, "myNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="2b88f-215">記錄檔名稱為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-215">The log name is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-216">記錄檔名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-216">The log name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-217">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-217">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-218">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-218">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string * string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog (logName, machineName)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="2b88f-219">指定電腦上的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-219">The name of the log on the specified computer.</span></span></param>
        <param name="machineName"><span data-ttu-id="2b88f-220">記錄檔所在處的電腦。</span><span class="sxs-lookup"><span data-stu-id="2b88f-220">The computer on which the log exists.</span></span></param>
        <summary><span data-ttu-id="2b88f-221">初始化 <see cref="T:System.Diagnostics.EventLog" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-221">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="2b88f-222">讓執行個體與指定電腦上的記錄檔產生關聯。</span><span class="sxs-lookup"><span data-stu-id="2b88f-222">Associates the instance with a log on the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-223">設定這個多載<xref:System.Diagnostics.EventLog.Log%2A>屬性，以`logName`參數和<xref:System.Diagnostics.EventLog.MachineName%2A>屬性設`machineName`參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-223">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter and the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter.</span></span> <span data-ttu-id="2b88f-224">然後再呼叫<xref:System.Diagnostics.EventLog.WriteEntry%2A>，指定<xref:System.Diagnostics.EventLog.Source%2A>屬性<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-224">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="2b88f-225">如果您僅讀取<xref:System.Diagnostics.EventLog.Entries%2A>從記錄檔中，您也可以指定僅<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-225">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-226">這個多載的建構函式指定<xref:System.Diagnostics.EventLog.Log%2A>並<xref:System.Diagnostics.EventLog.MachineName%2A>屬性，但是您可以變更之前讀取<xref:System.Diagnostics.EventLog.Entries%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-226">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties, but you can change either before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="2b88f-227">下表顯示的執行個體的初始屬性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-227">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="2b88f-228">屬性</span><span class="sxs-lookup"><span data-stu-id="2b88f-228">Property</span></span>|<span data-ttu-id="2b88f-229">初始值</span><span class="sxs-lookup"><span data-stu-id="2b88f-229">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="2b88f-230">空字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-230">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="2b88f-231">`logName` 參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-231">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="2b88f-232">`machineName` 參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-232">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-233">下列範例會讀取事件記錄檔，而 「 myNewLog"，"myServer"的電腦上的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-233">The following example reads entries in the event log, "myNewLog", on the computer "myServer".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="2b88f-234">記錄檔名稱為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-234">The log name is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-235">記錄檔名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-235">The log name is invalid.</span></span>  
  
<span data-ttu-id="2b88f-236">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-236">-or-</span></span> 
<span data-ttu-id="2b88f-237">電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-237">The computer name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-238">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-238">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-239">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-239">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName, string source);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName, string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String, source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName, System::String ^ source);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string * string * string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog (logName, machineName, source)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="2b88f-240">指定電腦上的記錄檔名稱</span><span class="sxs-lookup"><span data-stu-id="2b88f-240">The name of the log on the specified computer</span></span></param>
        <param name="machineName"><span data-ttu-id="2b88f-241">記錄檔所在處的電腦。</span><span class="sxs-lookup"><span data-stu-id="2b88f-241">The computer on which the log exists.</span></span></param>
        <param name="source"><span data-ttu-id="2b88f-242">事件記錄檔項目的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-242">The source of event log entries.</span></span></param>
        <summary><span data-ttu-id="2b88f-243">初始化 <see cref="T:System.Diagnostics.EventLog" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-243">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="2b88f-244">讓執行個體和指定電腦上的記錄檔產生關聯，並建立或指派指定的來源給 <see cref="T:System.Diagnostics.EventLog" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-244">Associates the instance with a log on the specified computer and creates or assigns the specified source to the <see cref="T:System.Diagnostics.EventLog" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-245">這個建構函式設定<xref:System.Diagnostics.EventLog.Log%2A>屬性，以`logName`參數，<xref:System.Diagnostics.EventLog.MachineName%2A>屬性設`machineName`參數，而<xref:System.Diagnostics.EventLog.Source%2A>屬性設`source`參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-245">This constructor sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter, the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter, and the <xref:System.Diagnostics.EventLog.Source%2A> property to the `source` parameter.</span></span> <span data-ttu-id="2b88f-246"><xref:System.Diagnostics.EventLog.Source%2A>寫入事件記錄檔時，就需要屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-246">The <xref:System.Diagnostics.EventLog.Source%2A> property is required when writing to an event log.</span></span> <span data-ttu-id="2b88f-247">不過，如果您僅讀取事件記錄檔，只有<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>（只要事件記錄檔，在伺服器上都有一個已經與它關聯的來源），都需要屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-247">However, if you are only reading from an event log, only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties are required (as long as the event log on the server has a source already associated with it).</span></span> <span data-ttu-id="2b88f-248">如果您僅讀取事件記錄檔，另一個多載的建構函式可能已足夠。</span><span class="sxs-lookup"><span data-stu-id="2b88f-248">If you are only reading from the event log, another overload of the constructor might suffice.</span></span>  
  
 <span data-ttu-id="2b88f-249">下表顯示的執行個體的初始屬性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-249">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="2b88f-250">屬性</span><span class="sxs-lookup"><span data-stu-id="2b88f-250">Property</span></span>|<span data-ttu-id="2b88f-251">初始值</span><span class="sxs-lookup"><span data-stu-id="2b88f-251">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="2b88f-252">`source` 參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-252">The `source` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="2b88f-253">`logName` 參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-253">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="2b88f-254">`machineName` 參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-254">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-255">下列範例會的項目寫入事件記錄檔時，「 MyNewLog"，本機電腦上，使用"MySource"的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-255">The following example writes an entry to an event log, "MyNewLog", on the local computer, using the source "MySource".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="2b88f-256">記錄檔名稱為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-256">The log name is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-257">記錄檔名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-257">The log name is invalid.</span></span>  
  
<span data-ttu-id="2b88f-258">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-258">-or-</span></span> 
<span data-ttu-id="2b88f-259">電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-259">The computer name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-260">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-260">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-261">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-261">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName="BeginInit">
      <MemberSignature Language="C#" Value="public void BeginInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void BeginInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.BeginInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub BeginInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void BeginInit();" />
      <MemberSignature Language="F#" Value="abstract member BeginInit : unit -&gt; unit&#xA;override this.BeginInit : unit -&gt; unit" Usage="eventLog.BeginInit " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.BeginInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="2b88f-262">開始初始化表單或為另一個元件所使用的 <see cref="T:System.Diagnostics.EventLog" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-262">Begins the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or used by another component.</span></span> <span data-ttu-id="2b88f-263">初始化會於執行階段時執行。</span><span class="sxs-lookup"><span data-stu-id="2b88f-263">The initialization occurs at runtime.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-264">[!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)]設計環境會使用這個方法來開始初始化用於表單或另一個元件所使用的元件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-264">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to start the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="2b88f-265"><xref:System.Diagnostics.EventLog.EndInit%2A>方法結束初始化。</span><span class="sxs-lookup"><span data-stu-id="2b88f-265">The <xref:System.Diagnostics.EventLog.EndInit%2A> method ends the initialization.</span></span> <span data-ttu-id="2b88f-266">使用<xref:System.Diagnostics.EventLog.BeginInit%2A>和<xref:System.Diagnostics.EventLog.EndInit%2A>方法可防止控制項完全初始化之前使用。</span><span class="sxs-lookup"><span data-stu-id="2b88f-266">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevent the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-267"><see cref="T:System.Diagnostics.EventLog" /> 已經初始化。</span><span class="sxs-lookup"><span data-stu-id="2b88f-267"><see cref="T:System.Diagnostics.EventLog" /> is already initialized.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-268">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-268">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-269">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-269">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.EndInit" />
      </Docs>
    </Member>
    <Member MemberName="Clear">
      <MemberSignature Language="C#" Value="public void Clear ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Clear() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Clear" />
      <MemberSignature Language="VB.NET" Value="Public Sub Clear ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Clear();" />
      <MemberSignature Language="F#" Value="member this.Clear : unit -&gt; unit" Usage="eventLog.Clear " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="2b88f-270">移除事件記錄檔的所有項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-270">Removes all entries from the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-271">事件記錄檔的設定，判斷它們可以包含的項目數量的大小上限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-271">Event logs are set with a maximum size that determines how many entries they can contain.</span></span> <span data-ttu-id="2b88f-272">事件記錄檔已滿時，它會停止記錄新事件的資訊，或開始覆寫先前項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-272">When an event log is full, it stops recording new event information or begins to overwrite earlier entries.</span></span> <span data-ttu-id="2b88f-273">如果停止事件記錄，您可以使用這個方法來清除現有的項目記錄，並允許它重新啟動記錄事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-273">If event recording stops, you can use this method to clear the log of existing entries and allow it to start recording events again.</span></span> <span data-ttu-id="2b88f-274">您必須清除事件記錄檔項目記錄檔所在電腦的系統管理員權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-274">You must have administrator permissions to the computer on which the log resides to clear event log entries.</span></span>  
  
 <span data-ttu-id="2b88f-275"><xref:System.Diagnostics.EventLog.Clear%2A> 關閉事件記錄檔，釋出事件控制代碼，新的擷取讀取和寫入控制代碼，並重新開啟事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-275"><xref:System.Diagnostics.EventLog.Clear%2A> closes the event log, releases the event handles, retrieves new read and write handles, and reopens the event log.</span></span> <span data-ttu-id="2b88f-276">方法的呼叫之後收到的事件不會清除現有的事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-276">Events received after the call to the method are not cleared along with the existing events.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-277">下列範例會清除事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-277">The following example clears an event log.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="2b88f-278">由於應用程式、 系統、 安全性和其他非自訂記錄檔可能包含重要的資訊;請務必指定自訂的記錄檔，然後再執行此程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="2b88f-278">Because Application, System, Security, and other non-custom logs can contain crucial information; be sure to specify a custom log before executing this example code.</span></span> <span data-ttu-id="2b88f-279">此範例會刪除自訂記錄檔`myNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-279">This example deletes the custom log `myNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Clear Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Clear Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Clear Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-280">事件記錄檔未成功清除。</span><span class="sxs-lookup"><span data-stu-id="2b88f-280">The event log was not cleared successfully.</span></span>  
  
<span data-ttu-id="2b88f-281">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-281">-or-</span></span> 
<span data-ttu-id="2b88f-282">無法開啟記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-282">The log cannot be opened.</span></span> <span data-ttu-id="2b88f-283">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-283">A Windows error code is not available.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-284">沒有指定 <see cref="P:System.Diagnostics.EventLog.Log" /> 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-284">A value is not specified for the <see cref="P:System.Diagnostics.EventLog.Log" /> property.</span></span> <span data-ttu-id="2b88f-285">確定記錄檔名稱不是空字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-285">Make sure the log name is not an empty string.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-286">檔案不存在。</span><span class="sxs-lookup"><span data-stu-id="2b88f-286">The log does not exist.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-287">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-287">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-288">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-288">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="eventLog.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="2b88f-289">關閉事件記錄檔，並釋放讀取和寫入控制代碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-289">Closes the event log and releases read and write handles.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-290"><xref:System.Diagnostics.EventLog.Close%2A>方法會呼叫受保護的<xref:System.ComponentModel.Component.Dispose%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-290">The <xref:System.Diagnostics.EventLog.Close%2A> method is called by the protected <xref:System.ComponentModel.Component.Dispose%2A> method.</span></span> <span data-ttu-id="2b88f-291">您不需要叫用<xref:System.Diagnostics.EventLog.Close%2A>再呼叫<xref:System.ComponentModel.Component.Dispose%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-291">You do not need to invoke <xref:System.Diagnostics.EventLog.Close%2A> before calling <xref:System.ComponentModel.Component.Dispose%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-292">事件記錄檔的讀取控制代碼或寫入控制代碼未成功釋放。</span><span class="sxs-lookup"><span data-stu-id="2b88f-292">The event log's read handle or write handle was not released successfully.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-293">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-293">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-294">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-294">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <MemberGroup MemberName="CreateEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="2b88f-295">建立能夠將事件資訊寫入系統上的特定記錄檔的應用程式。</span><span class="sxs-lookup"><span data-stu-id="2b88f-295">Establishes an application as able to write event information to a particular log on the system.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (System.Diagnostics.EventSourceCreationData sourceData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(class System.Diagnostics.EventSourceCreationData sourceData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.Diagnostics.EventSourceCreationData)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (sourceData As EventSourceCreationData)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::Diagnostics::EventSourceCreationData ^ sourceData);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : System.Diagnostics.EventSourceCreationData -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource sourceData" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceData" Type="System.Diagnostics.EventSourceCreationData" />
      </Parameters>
      <Docs>
        <param name="sourceData"><span data-ttu-id="2b88f-296">事件來源及其目標事件記錄檔的組態屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-296">The configuration properties for the event source and its target event log.</span></span></param>
        <summary><span data-ttu-id="2b88f-297">使用事件來源及對應的事件記錄檔指定的組態屬性，建立有效的事件來源，以撰寫當地語系化的事件訊息。</span><span class="sxs-lookup"><span data-stu-id="2b88f-297">Establishes a valid event source for writing localized event messages, using the specified configuration properties for the event source and the corresponding event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-298">若要設定新的來源項目寫入事件記錄檔，在本機電腦或遠端電腦上使用此多載。</span><span class="sxs-lookup"><span data-stu-id="2b88f-298">Use this overload to configure a new source for writing entries to an event log on the local computer or a remote computer.</span></span> <span data-ttu-id="2b88f-299">您不需要使用這個方法來讀取事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-299">It is not necessary to use this method to read from an event log.</span></span>  
  
 <span data-ttu-id="2b88f-300"><xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法會使用輸入`sourceData` <xref:System.Diagnostics.EventSourceCreationData.Source%2A>，<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>和<xref:System.Diagnostics.EventSourceCreationData.MachineName%2A>屬性，以建立新的來源和其相關聯的事件記錄檔的目標電腦上的登錄值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-300">The <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method uses the input `sourceData`<xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> and <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> properties to create registry values on the target computer for the new source and its associated event log.</span></span> <span data-ttu-id="2b88f-301">新的來源名稱不符合現有的來源名稱或在目標電腦上現有的事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-301">A new source name cannot match an existing source name or an existing event log name on the target computer.</span></span> <span data-ttu-id="2b88f-302">如果<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>屬性未設定時，來源會註冊為應用程式事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-302">If the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property is not set, the source is registered for the Application event log.</span></span> <span data-ttu-id="2b88f-303">如果<xref:System.Diagnostics.EventSourceCreationData.MachineName%2A>未設定，來源登錄在本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-303">If the <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> is not set, the source is registered on the local computer.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-304">若要建立事件來源，在 Windows Vista 和更新版本或 Windows Server 2003，您必須具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-304">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="2b88f-305">這項需求的原因是所有的事件記錄檔，包括安全性、 必須要搜尋以判斷事件來源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="2b88f-305">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="2b88f-306">從 Windows Vista 開始，使用者沒有權限以存取安全性記錄檔中;因此，<xref:System.Security.SecurityException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="2b88f-306">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="2b88f-307">從 Windows Vista 開始，使用者帳戶控制 (UAC) 會決定使用者的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-307">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="2b88f-308">如果您是內建 Administrators 群組的成員，系統會將兩個執行階段存取語彙基元 (Token) 指派給您：標準使用者存取語彙基元及管理員存取語彙基元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-308">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="2b88f-309">根據預設，您會屬於標準使用者角色。</span><span class="sxs-lookup"><span data-stu-id="2b88f-309">By default, you are in the standard user role.</span></span> <span data-ttu-id="2b88f-310">若要執行的程式碼存取安全性記錄檔，您必須先將您的權限從標準使用者提高為系統管理員。</span><span class="sxs-lookup"><span data-stu-id="2b88f-310">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="2b88f-311">您可以在啟動應用程式時，以滑鼠右鍵按一下應用程式圖示，並指出您想要以系統管理員身分執行，藉此提高為系統管理員權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-311">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="2b88f-312">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>將事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-312">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="2b88f-313">您必須指定要寫入事件，事件來源您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-313">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="2b88f-314">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-314">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-315">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-315">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-316">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-316">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-317">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-317">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-318">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-318">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-319">您可以建立現有的事件記錄檔或新的事件記錄檔的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-319">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="2b88f-320">當您建立新的事件記錄檔的新來源時，系統會註冊為該記錄檔中，來源，但直到第一個項目寫入至其中，才會建立記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-320">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="2b88f-321">作業系統會將事件記錄檔儲存為檔案。</span><span class="sxs-lookup"><span data-stu-id="2b88f-321">The operating system stores event logs as files.</span></span> <span data-ttu-id="2b88f-322">當您使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要建立新的事件記錄檔，相關聯的檔案會儲存在指定的電腦上的 %SystemRoot%\System32\Config 目錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-322">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="2b88f-323">檔案名稱由附加的前 8 個字元設定<xref:System.Diagnostics.EventLog.Log%2A>".evt"副檔名的屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-323">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="2b88f-324">每個來源只有一個事件記錄檔只能寫入一次;不過，您的應用程式也可以使用多個來源，以寫入多個事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-324">Each source can only write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="2b88f-325">例如，您的應用程式可能需要多個來源設定為不同的事件記錄檔或不同的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-325">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="2b88f-326">您可以在事件類別目錄和訊息字串的當地語系化的資源檔與註冊事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-326">You can register the event source with localized resource file(s) for your event category and message strings.</span></span> <span data-ttu-id="2b88f-327">您的應用程式可以寫入事件記錄項目使用資源識別碼，而不是指定實際的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-327">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="2b88f-328">事件檢視器會尋找並顯示目前語言設定為基礎的當地語系化的資源檔中的對應字串使用的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-328">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="2b88f-329">您可以註冊個別的檔案，事件類別目錄、 訊息和參數插入字串，或您可以註冊相同的資源檔，所有的三種類型的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-329">You can register a separate file for event categories, messages and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="2b88f-330">使用<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>， <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>， <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>，和<xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>屬性來設定要當地語系化的項目寫入事件記錄檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-330">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="2b88f-331">如果您的應用程式會將字串值，直接寫入事件記錄檔，您不需要設定這些屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-331">If your application writes strings values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="2b88f-332">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-332">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-333">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-333">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-334">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-334">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-335">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-335">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="2b88f-336">若要變更現有的來源的設定詳細資料，您必須刪除來源，並再建立新的組態。</span><span class="sxs-lookup"><span data-stu-id="2b88f-336">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="2b88f-337">如果其他應用程式或元件使用現有的來源，請使用更新的組態，而不是刪除現有來源建立新的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-337">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-338">如果來源設定為事件記錄檔，且重新設定為另一個事件記錄檔，您必須重新啟動電腦，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-338">If a source is configured for an event log, and you reconfigure it for another event log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-339">下列範例會判斷是否事件來源名為`SampleApplicationSource`登錄在本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-339">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="2b88f-340">如果事件來源不存在，此範例會設定為來源的訊息資源檔，並建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-340">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="2b88f-341">最後，範例會設定事件記錄檔，使用中的資源識別碼值的當地語系化的顯示名稱`DisplayNameMsgId`中的資源檔路徑和`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-341">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="2b88f-342">此範例會使用下列的訊息文字檔案，內建資源庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="2b88f-342">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="2b88f-343">訊息文字檔案是從其中建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-343">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="2b88f-344">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-344">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="2b88f-345">具體而言，資源識別元 5001 定義事件記錄檔的當地語系化名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-345">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-346">在 <paramref name="sourceData" /> 中指定的電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-346">The computer name specified in <paramref name="sourceData" /> is not valid.</span></span>  
  
<span data-ttu-id="2b88f-347">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-347">\- or -</span></span> 
<span data-ttu-id="2b88f-348"><paramref name="sourceData" /> 中所指定的來源名稱為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-348">The source name specified in <paramref name="sourceData" /> is <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-349">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-349">\- or -</span></span> 
<span data-ttu-id="2b88f-350">在 <paramref name="sourceData" /> 中指定的記錄檔名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-350">The log name specified in <paramref name="sourceData" /> is not valid.</span></span> <span data-ttu-id="2b88f-351">事件記錄檔名稱必須由可列印字元組成，不得包括字元 '\*'、'?' 或 '\\'。</span><span class="sxs-lookup"><span data-stu-id="2b88f-351">Event log names must consist of printable characters and cannot include the characters '\*', '?', or '\\'.</span></span>  
  
<span data-ttu-id="2b88f-352">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-352">\- or -</span></span> 
<span data-ttu-id="2b88f-353">在 <paramref name="sourceData" /> 中指定的記錄檔名稱無效，無法建立使用者記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-353">The log name specified in <paramref name="sourceData" /> is not valid for user log creation.</span></span> <span data-ttu-id="2b88f-354">事件記錄檔名稱 AppEvent、SysEvent 和 SecEvent 會保留供系統使用。</span><span class="sxs-lookup"><span data-stu-id="2b88f-354">The Event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span></span>  
  
<span data-ttu-id="2b88f-355">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-355">\- or -</span></span> 
<span data-ttu-id="2b88f-356">此記錄檔名稱符合現有的事件來源名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-356">The log name matches an existing event source name.</span></span>  
  
<span data-ttu-id="2b88f-357">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-357">\- or -</span></span> 
<span data-ttu-id="2b88f-358">指定 <paramref name="sourceData" /> 來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-358">The source name specified in <paramref name="sourceData" /> results in a registry key path longer than 254 characters.</span></span>  
  
<span data-ttu-id="2b88f-359">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-359">\- or -</span></span> 
<span data-ttu-id="2b88f-360">在 <paramref name="sourceData" /> 中指定的記錄檔名稱的前 8 個字元不是唯一的。</span><span class="sxs-lookup"><span data-stu-id="2b88f-360">The first 8 characters of the log name specified in <paramref name="sourceData" /> are not unique.</span></span>  
  
<span data-ttu-id="2b88f-361">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-361">\- or -</span></span> 
<span data-ttu-id="2b88f-362">已經登錄 <paramref name="sourceData" /> 中指定的來源名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-362">The source name specified in <paramref name="sourceData" /> is already registered.</span></span>  
  
<span data-ttu-id="2b88f-363">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-363">\- or -</span></span> 
<span data-ttu-id="2b88f-364">在 <paramref name="sourceData" /> 中指定的來源名稱符合現有的事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-364">The source name specified in <paramref name="sourceData" /> matches an existing event log name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-365">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-365">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="2b88f-366"><paramref name="sourceData" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-366"><paramref name="sourceData" /> is <see langword="null" />.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-367">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-367">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-368">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-368">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventSourceCreationData" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="T:System.Diagnostics.EventLogInstaller" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource (source, logName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-369">應用程式登錄在本機電腦上的來源名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-369">The source name by which the application is registered on the local computer.</span></span></param>
        <param name="logName"><span data-ttu-id="2b88f-370">寫入來源項目的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-370">The name of the log the source's entries are written to.</span></span> <span data-ttu-id="2b88f-371">可能的值包括應用程式、系統或自訂事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-371">Possible values include Application, System, or a custom event log.</span></span></param>
        <summary><span data-ttu-id="2b88f-372">建立指定的來源名稱做為有效的事件來源，以便將項目寫入本機電腦上的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-372">Establishes the specified source name as a valid event source for writing entries to a log on the local computer.</span></span> <span data-ttu-id="2b88f-373">這個方法也可以在本機電腦上建立新的自訂記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-373">This method can also create a new custom log on the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-374">使用此多載來建立自訂的記錄檔，或建立並註冊<xref:System.Diagnostics.EventLog.Source%2A>到本機電腦上現有的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-374">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the local computer.</span></span>  
  
 <span data-ttu-id="2b88f-375">如果`logName`已`null`或空字串 ("") 當您呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>，記錄檔預設為應用程式記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-375">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="2b88f-376">如果記錄檔不存在本機電腦上，系統會建立自訂記錄檔，並註冊您的應用程式<xref:System.Diagnostics.EventLog.Source%2A>該記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-376">If the log does not exist on the local computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-377">若要建立事件來源，在 Windows Vista 和更新版本或 Windows Server 2003，您必須具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-377">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="2b88f-378">這項需求的原因是所有的事件記錄檔，包括安全性、 必須要搜尋以判斷事件來源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="2b88f-378">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="2b88f-379">從 Windows Vista 開始，使用者沒有權限以存取安全性記錄檔中;因此，<xref:System.Security.SecurityException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="2b88f-379">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="2b88f-380">在 Windows Vista (含) 以後版本中，使用者帳戶控制 (UAC) 會判斷使用者的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-380">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="2b88f-381">如果您是內建 Administrators 群組的成員，系統會將兩個執行階段存取語彙基元 (Token) 指派給您：標準使用者存取語彙基元及管理員存取語彙基元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-381">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="2b88f-382">根據預設，您會屬於標準使用者角色。</span><span class="sxs-lookup"><span data-stu-id="2b88f-382">By default, you are in the standard user role.</span></span> <span data-ttu-id="2b88f-383">若要執行的程式碼存取安全性記錄檔，您必須先將您的權限從標準使用者提高為系統管理員。</span><span class="sxs-lookup"><span data-stu-id="2b88f-383">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="2b88f-384">您可以在啟動應用程式時，以滑鼠右鍵按一下應用程式圖示，並指出您想要以系統管理員身分執行，藉此提高為系統管理員權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-384">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="2b88f-385">您只需要建立事件來源，如果您要寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-385">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="2b88f-386">前一個項目寫入事件記錄檔中，您必須向事件來源事件記錄檔為有效的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-386">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="2b88f-387">當您撰寫的記錄項目時，系統會使用<xref:System.Diagnostics.EventLog.Source%2A>尋找適當的記錄檔，在其中放置您的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-387">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="2b88f-388">如果您正在讀取事件記錄檔，您可以指定<xref:System.Diagnostics.EventLog.Source%2A>，或有<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-388">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-389">您不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果您要連接到本機電腦上的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-389">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="2b88f-390">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>讀取時從記錄檔，在本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-390">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> when reading from a log, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-391">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>將事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-391">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="2b88f-392">您必須指定要寫入事件，事件來源您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-392">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="2b88f-393">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-393">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-394">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-394">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-395">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-395">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-396">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-396">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-397">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-397">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-398">您可以建立現有的事件記錄檔或新的事件記錄檔的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-398">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="2b88f-399">當您建立新的事件記錄檔的新來源時，系統會註冊為該記錄檔中，來源，但直到第一個項目寫入至其中，才會建立記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-399">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="2b88f-400">作業系統會將事件記錄檔儲存為檔案。</span><span class="sxs-lookup"><span data-stu-id="2b88f-400">The operating system stores event logs as files.</span></span> <span data-ttu-id="2b88f-401">當您使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要建立新的事件記錄檔，相關聯的檔案會儲存在指定的電腦上的 %SystemRoot%\System32\Config 目錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-401">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="2b88f-402">檔案名稱由附加的前 8 個字元設定<xref:System.Diagnostics.EventLog.Log%2A>".evt"副檔名的屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-402">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="2b88f-403">來源必須是唯一的本機電腦上，新的來源名稱不符合現有的來源名稱或現有的事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-403">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="2b88f-404">每個來源一次; 可以寫入只有一個事件記錄檔不過，您的應用程式也可以使用多個來源，以寫入多個事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-404">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="2b88f-405">例如，您的應用程式可能需要多個來源設定為不同的事件記錄檔或不同的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-405">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="2b88f-406">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-406">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-407">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-407">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-408">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-408">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-409">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-409">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="2b88f-410">若要變更現有的來源的設定詳細資料，您必須刪除來源，並再建立新的組態。</span><span class="sxs-lookup"><span data-stu-id="2b88f-410">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="2b88f-411">如果其他應用程式或元件使用現有的來源，請使用更新的組態，而不是刪除現有來源建立新的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-411">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-412">如果來源已對應至記錄重新對應至新的記錄檔，您必須重新啟動電腦，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-412">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-413">下列範例會建立來源`MySource`如果不存在，它的項目寫入事件記錄檔`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-413">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-414"><paramref name="source" /> 為空字串 ("") 或 <see langword="null" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-414"><paramref name="source" /> is an empty string ("") or <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-415">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-415">\- or -</span></span> 
 <span data-ttu-id="2b88f-416"><paramref name="logName" /> 不是有效的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-416"><paramref name="logName" /> is not a valid event log name.</span></span> <span data-ttu-id="2b88f-417">事件記錄檔名稱必須由可列印字元組成，不得包括字元 '\*'、'?' 或 '\\'。</span><span class="sxs-lookup"><span data-stu-id="2b88f-417">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span></span>  
  
<span data-ttu-id="2b88f-418">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-418">\- or -</span></span> 
 <span data-ttu-id="2b88f-419"><paramref name="logName" /> 不適用於建立使用者記錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-419"><paramref name="logName" /> is not valid for user log creation.</span></span> <span data-ttu-id="2b88f-420">事件記錄檔名稱 AppEvent、SysEvent 和 SecEvent 會保留供系統使用。</span><span class="sxs-lookup"><span data-stu-id="2b88f-420">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span></span>  
  
<span data-ttu-id="2b88f-421">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-421">\- or -</span></span> 
<span data-ttu-id="2b88f-422">此記錄檔名稱符合現有的事件來源名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-422">The log name matches an existing event source name.</span></span>  
  
<span data-ttu-id="2b88f-423">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-423">\- or -</span></span> 
<span data-ttu-id="2b88f-424">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-424">The source name results in a registry key path longer than 254 characters.</span></span>  
  
<span data-ttu-id="2b88f-425">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-425">\- or -</span></span> 
<span data-ttu-id="2b88f-426"><paramref name="logName" /> 的前 8 個字元符合現有事件記錄檔名稱的前 8 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-426">The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name.</span></span>  
  
<span data-ttu-id="2b88f-427">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-427">\- or -</span></span> 
<span data-ttu-id="2b88f-428">來源因為已經存在於本機電腦上而無法登錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-428">The source cannot be registered because it already exists on the local computer.</span></span>  
  
<span data-ttu-id="2b88f-429">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-429">\- or -</span></span> 
<span data-ttu-id="2b88f-430">來源名稱符合現有的事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-430">The source name matches an existing event log name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-431">無法在目標電腦上開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-431">The registry key for the event log could not be opened on the local computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-432">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-432">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-433">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-433">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : string * string * string -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource (source, logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete("use CreateEventSource(EventSourceCreationData) instead")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.Obsolete("This method has been deprecated.  Please use System.Diagnostics.EventLog.CreateEventSource(EventSourceCreationData sourceData) instead.  http://go.microsoft.com/fwlink/?linkid=14202")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-434">將應用程式註冊在指定電腦上的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-434">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="logName"><span data-ttu-id="2b88f-435">寫入來源項目的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-435">The name of the log the source's entries are written to.</span></span> <span data-ttu-id="2b88f-436">可能的值包括應用程式、系統或自訂事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-436">Possible values include Application, System, or a custom event log.</span></span> <span data-ttu-id="2b88f-437">如果您未指定值，<paramref name="logName" /> 會預設為應用程式。</span><span class="sxs-lookup"><span data-stu-id="2b88f-437">If you do not specify a value, <paramref name="logName" /> defaults to Application.</span></span></param>
        <param name="machineName"><span data-ttu-id="2b88f-438">要註冊這個事件來源的電腦名稱，或者表示本機電腦的 "."。</span><span class="sxs-lookup"><span data-stu-id="2b88f-438">The name of the computer to register this event source with, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="2b88f-439">建立指定的來源名稱做為有效的事件來源，以便將項目寫入指定之電腦上的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-439">Establishes the specified source name as a valid event source for writing entries to a log on the specified computer.</span></span> <span data-ttu-id="2b88f-440">這個方法也可以用來在指定的電腦上建立新的自訂記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-440">This method can also be used to create a new custom log on the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-441">使用此多載來建立自訂的記錄檔，或建立並註冊<xref:System.Diagnostics.EventLog.Source%2A>至指定的電腦上現有的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-441">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the specified computer.</span></span>  
  
 <span data-ttu-id="2b88f-442">如果`logName`已`null`或空字串 ("") 當您呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>，記錄檔預設為應用程式記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-442">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="2b88f-443">如果記錄檔不存在指定的電腦上，系統會建立自訂記錄檔，並註冊您的應用程式<xref:System.Diagnostics.EventLog.Source%2A>該記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-443">If the log does not exist on the specified computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
 <span data-ttu-id="2b88f-444">您只需要建立事件來源，如果您要寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-444">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="2b88f-445">前一個項目寫入事件記錄檔中，您必須向事件來源事件記錄檔為有效的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-445">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="2b88f-446">當您撰寫的記錄項目時，系統會使用<xref:System.Diagnostics.EventLog.Source%2A>尋找適當的記錄檔，在其中放置您的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-446">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="2b88f-447">如果您正在讀取事件記錄檔，您可以指定<xref:System.Diagnostics.EventLog.Source%2A>，或有<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-447">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-448">若要建立事件來源，在 Windows Vista 和更新版本或 Windows Server 2003，您必須具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-448">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="2b88f-449">這項需求的原因是所有的事件記錄檔，包括安全性、 必須要搜尋以判斷事件來源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="2b88f-449">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="2b88f-450">在 Windows Vista 和更新版本，使用者沒有權限以存取安全性記錄檔中;因此，<xref:System.Security.SecurityException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="2b88f-450">In Windows Vista and later, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="2b88f-451">在 Windows Vista (含) 以後版本中，使用者帳戶控制 (UAC) 會判斷使用者的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-451">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="2b88f-452">如果您是內建 Administrators 群組的成員，系統會將兩個執行階段存取語彙基元 (Token) 指派給您：標準使用者存取語彙基元及管理員存取語彙基元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-452">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="2b88f-453">根據預設，您會屬於標準使用者角色。</span><span class="sxs-lookup"><span data-stu-id="2b88f-453">By default, you are in the standard user role.</span></span> <span data-ttu-id="2b88f-454">若要執行的程式碼存取安全性記錄檔，您必須先將您的權限從標準使用者提高為系統管理員。</span><span class="sxs-lookup"><span data-stu-id="2b88f-454">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="2b88f-455">您可以在啟動應用程式時，以滑鼠右鍵按一下應用程式圖示，並指出您想要以系統管理員身分執行，藉此提高為系統管理員權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-455">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="2b88f-456">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>將事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-456">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="2b88f-457">您必須指定要寫入事件，事件來源您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-457">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="2b88f-458">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-458">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-459">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-459">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-460">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-460">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-461">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-461">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-462">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-462">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-463">您可以建立現有的事件記錄檔或新的事件記錄檔的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-463">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="2b88f-464">當您建立新的事件記錄檔的新來源時，系統會註冊為該記錄檔中，來源，但直到第一個項目寫入至其中，才會建立記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-464">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="2b88f-465">作業系統會將事件記錄檔儲存為檔案。</span><span class="sxs-lookup"><span data-stu-id="2b88f-465">The operating system stores event logs as files.</span></span> <span data-ttu-id="2b88f-466">當您使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要建立新的事件記錄檔，相關聯的檔案會儲存在指定的電腦上的 %SystemRoot%\System32\Config 目錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-466">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="2b88f-467">檔案名稱由附加的前 8 個字元設定<xref:System.Diagnostics.EventLog.Log%2A>".evt"副檔名的屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-467">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="2b88f-468">來源必須是唯一的本機電腦上，新的來源名稱不符合現有的來源名稱或現有的事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-468">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="2b88f-469">每個來源一次; 可以寫入只有一個事件記錄檔不過，您的應用程式也可以使用多個來源，以寫入多個事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-469">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="2b88f-470">例如，您的應用程式可能需要多個來源設定為不同的事件記錄檔或不同的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-470">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="2b88f-471">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-471">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-472">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-472">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-473">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-473">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-474">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-474">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="2b88f-475">若要變更現有的來源的設定詳細資料，您必須刪除來源，並再建立新的組態。</span><span class="sxs-lookup"><span data-stu-id="2b88f-475">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="2b88f-476">如果其他應用程式或元件使用現有的來源，請使用更新的組態，而不是刪除現有來源建立新的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-476">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-477">如果來源已對應至記錄重新對應至新的記錄檔，您必須重新啟動電腦，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-477">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-478">下列範例會建立來源`MySource`電腦上`MyServer`，並將項目寫入事件記錄檔`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-478">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-479"><paramref name="machineName" /> 不是有效的電腦名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-479">The <paramref name="machineName" /> is not a valid computer name.</span></span>  
  
<span data-ttu-id="2b88f-480">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-480">\- or -</span></span> 
 <span data-ttu-id="2b88f-481"><paramref name="source" /> 為空字串 ("") 或 <see langword="null" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-481"><paramref name="source" /> is an empty string ("") or <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-482">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-482">\- or -</span></span> 
 <span data-ttu-id="2b88f-483"><paramref name="logName" /> 不是有效的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-483"><paramref name="logName" /> is not a valid event log name.</span></span> <span data-ttu-id="2b88f-484">事件記錄檔名稱必須由可列印字元組成，不得包括字元 '\*'、'?' 或 '\\'。</span><span class="sxs-lookup"><span data-stu-id="2b88f-484">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span></span>  
  
<span data-ttu-id="2b88f-485">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-485">\- or -</span></span> 
 <span data-ttu-id="2b88f-486"><paramref name="logName" /> 不適用於建立使用者記錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-486"><paramref name="logName" /> is not valid for user log creation.</span></span> <span data-ttu-id="2b88f-487">事件記錄檔名稱 AppEvent、SysEvent 和 SecEvent 會保留供系統使用。</span><span class="sxs-lookup"><span data-stu-id="2b88f-487">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span></span>  
  
<span data-ttu-id="2b88f-488">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-488">\- or -</span></span> 
<span data-ttu-id="2b88f-489">此記錄檔名稱符合現有的事件來源名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-489">The log name matches an existing event source name.</span></span>  
  
<span data-ttu-id="2b88f-490">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-490">\- or -</span></span> 
<span data-ttu-id="2b88f-491">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-491">The source name results in a registry key path longer than 254 characters.</span></span>  
  
<span data-ttu-id="2b88f-492">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-492">\- or -</span></span> 
<span data-ttu-id="2b88f-493"><paramref name="logName" /> 的前 8 個字元符合指定電腦上現有事件記錄檔名稱的前 8 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-493">The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name on the specified computer.</span></span>  
  
<span data-ttu-id="2b88f-494">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-494">\- or -</span></span> 
<span data-ttu-id="2b88f-495">來源因為已經存在於指定的電腦上而無法登錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-495">The source cannot be registered because it already exists on the specified computer.</span></span>  
  
<span data-ttu-id="2b88f-496">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-496">\- or -</span></span> 
<span data-ttu-id="2b88f-497">來源名稱符合現有的事件來源名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-497">The source name matches an existing event source name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-498">無法在目標電腦上開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-498">The registry key for the event log could not be opened on the specified computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-499">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-499">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-500">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-500">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Delete">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="2b88f-501">移除記錄檔資源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-501">Removes a log resource.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member Delete : string -&gt; unit" Usage="System.Diagnostics.EventLog.Delete logName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="2b88f-502">要刪除的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-502">The name of the log to delete.</span></span> <span data-ttu-id="2b88f-503">可能的值包括：應用程式、安全性、系統和電腦上的任何自訂事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-503">Possible values include: Application, Security, System, and any custom event logs on the computer.</span></span></param>
        <summary><span data-ttu-id="2b88f-504">將事件記錄檔從本機電腦移除。</span><span class="sxs-lookup"><span data-stu-id="2b88f-504">Removes an event log from the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-505">在本機電腦上您想要刪除的記錄檔時，請使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-505">Use this method when the log you want to delete is on the local computer.</span></span> <span data-ttu-id="2b88f-506">提供您有適當的登錄權限，您可以刪除電腦上的任何記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-506">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="2b88f-507"><xref:System.Diagnostics.EventLog.Delete%2A> 移除所指定的記錄檔`logName`從本機電腦。</span><span class="sxs-lookup"><span data-stu-id="2b88f-507"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the local computer.</span></span> <span data-ttu-id="2b88f-508">如果您想要刪除原始檔登錄到記錄檔，請呼叫<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-508">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="2b88f-509">如果您只想要刪除的記錄項目，呼叫<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-509">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="2b88f-510"><xref:System.Diagnostics.EventLog.Delete%2A> 並<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，讓它們可以呼叫類別本身。</span><span class="sxs-lookup"><span data-stu-id="2b88f-510"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="2b88f-511">您不需要建立的新執行個體<xref:System.Diagnostics.EventLog>呼叫這些方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-511">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="2b88f-512"><xref:System.Diagnostics.EventLog.Delete%2A>方法會先刪除保留的記錄檔的內容檔案。</span><span class="sxs-lookup"><span data-stu-id="2b88f-512">The <xref:System.Diagnostics.EventLog.Delete%2A> method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="2b88f-513">然後，它會存取登錄並移除該記錄檔註冊的所有事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-513">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="2b88f-514">如果您重新建立在稍後的時間點的記錄，您應該註冊事件來源同樣地，若要重複使用。</span><span class="sxs-lookup"><span data-stu-id="2b88f-514">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="2b88f-515">如果您不會註冊事件來源，而且其他使用者不需要指定記錄檔名稱寫入的事件來源，將應用程式事件記錄檔中建立事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-515">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="2b88f-516">因此，應用程式，先前能夠寫入您刪除並重新建立記錄檔中的項目會寫入應用程式記錄檔相反的因為它現在包含事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-516">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-517">重新建立事件記錄檔可以是相當困難的工作。</span><span class="sxs-lookup"><span data-stu-id="2b88f-517">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="2b88f-518">避免刪除任何系統建立的事件記錄檔，例如應用程式記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-518">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="2b88f-519">正在刪除記錄，以透過呼叫<xref:System.Diagnostics.EventLog.Delete%2A>會自動刪除該記錄檔註冊的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-519">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="2b88f-520">這可讓其他應用程式使用該記錄檔無法作業。</span><span class="sxs-lookup"><span data-stu-id="2b88f-520">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-521">下列範例會刪除記錄檔從本機電腦。</span><span class="sxs-lookup"><span data-stu-id="2b88f-521">The following example deletes a log from the local computer.</span></span> <span data-ttu-id="2b88f-522">此範例會判斷其來源的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-522">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-523">多個來源可能會寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-523">More than one source might write to an event log.</span></span> <span data-ttu-id="2b88f-524">之前刪除自訂記錄檔，請確定沒有其他寫入該記錄檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-524">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-525"><paramref name="logName" /> 為空字串 ("") 或 <see langword="null" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-525"><paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-526">無法在目標電腦上開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-526">The registry key for the event log could not be opened on the local computer.</span></span>  
  
<span data-ttu-id="2b88f-527">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-527">\- or -</span></span> 
<span data-ttu-id="2b88f-528">計數器不在指定的電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-528">The log does not exist on the local computer.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-529">事件記錄檔未成功清除。</span><span class="sxs-lookup"><span data-stu-id="2b88f-529">The event log was not cleared successfully.</span></span>  
  
<span data-ttu-id="2b88f-530">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-530">-or-</span></span> 
<span data-ttu-id="2b88f-531">無法開啟記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-531">The log cannot be opened.</span></span> <span data-ttu-id="2b88f-532">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-532">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-533">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-533">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-534">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-534">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member Delete : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.Delete (logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="2b88f-535">要刪除的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-535">The name of the log to delete.</span></span> <span data-ttu-id="2b88f-536">可能的值包括：應用程式、安全性、系統和所指定電腦上的任何自訂事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-536">Possible values include: Application, Security, System, and any custom event logs on the specified computer.</span></span></param>
        <param name="machineName"><span data-ttu-id="2b88f-537">要刪除記錄檔的電腦的名稱，或者表示本機電腦的 "."。</span><span class="sxs-lookup"><span data-stu-id="2b88f-537">The name of the computer to delete the log from, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="2b88f-538">將事件記錄檔從指定的電腦移除。</span><span class="sxs-lookup"><span data-stu-id="2b88f-538">Removes an event log from the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-539">在遠端電腦上您想要刪除的記錄檔時，請使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-539">Use this method when the log you want to delete is on a remote computer.</span></span> <span data-ttu-id="2b88f-540">提供您有適當的登錄權限，您可以刪除電腦上的任何記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-540">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="2b88f-541"><xref:System.Diagnostics.EventLog.Delete%2A> 移除所指定的記錄檔`logName`所指定的電腦從`machineName`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-541"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the computer specified by `machineName`.</span></span> <span data-ttu-id="2b88f-542">如果您想要刪除原始檔登錄到記錄檔，請呼叫<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-542">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="2b88f-543">如果您只想要刪除的記錄項目，呼叫<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-543">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="2b88f-544"><xref:System.Diagnostics.EventLog.Delete%2A> 並<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，讓它們可以呼叫類別本身。</span><span class="sxs-lookup"><span data-stu-id="2b88f-544"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="2b88f-545">您不需要建立的執行個體<xref:System.Diagnostics.EventLog>呼叫這些方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-545">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="2b88f-546">這個方法會先刪除保留的記錄檔的內容檔案。</span><span class="sxs-lookup"><span data-stu-id="2b88f-546">This method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="2b88f-547">然後，它會存取登錄並移除該記錄檔註冊的所有事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-547">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="2b88f-548">如果您重新建立在稍後的時間點的記錄，您應該註冊事件來源同樣地，若要重複使用。</span><span class="sxs-lookup"><span data-stu-id="2b88f-548">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="2b88f-549">如果您不會註冊事件來源，而且其他使用者不需要指定記錄檔名稱寫入的事件來源，將應用程式事件記錄檔中建立事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-549">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="2b88f-550">因此，應用程式，先前能夠寫入您刪除並重新建立記錄檔中的項目會寫入應用程式記錄檔相反的因為它現在包含事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-550">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-551">重新建立事件記錄檔可以是相當困難的工作。</span><span class="sxs-lookup"><span data-stu-id="2b88f-551">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="2b88f-552">避免刪除任何系統建立的事件記錄檔，例如應用程式記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-552">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="2b88f-553">正在刪除記錄，以透過呼叫<xref:System.Diagnostics.EventLog.Delete%2A>會自動刪除該記錄檔註冊的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-553">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="2b88f-554">這可讓其他應用程式使用該記錄檔無法作業。</span><span class="sxs-lookup"><span data-stu-id="2b88f-554">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-555">下列範例會刪除記錄檔，從指定的電腦。</span><span class="sxs-lookup"><span data-stu-id="2b88f-555">The following example deletes a log from the specified computer.</span></span> <span data-ttu-id="2b88f-556">此範例會判斷其來源的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-556">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-557">多個來源可能會寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-557">More than one source might write to an event log.</span></span> <span data-ttu-id="2b88f-558">之前刪除自訂記錄檔，請確定沒有其他寫入該記錄檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-558">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-559"><paramref name="logName" /> 為空字串 ("") 或 <see langword="null" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-559"><paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-560">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-560">\- or -</span></span> 
 <span data-ttu-id="2b88f-561"><paramref name="machineName" /> 不是有效的電腦名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-561"><paramref name="machineName" /> is not a valid computer name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-562">無法在目標電腦上開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-562">The registry key for the event log could not be opened on the specified computer.</span></span>  
  
<span data-ttu-id="2b88f-563">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-563">\- or -</span></span> 
<span data-ttu-id="2b88f-564">計數器不在指定的電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-564">The log does not exist on the specified computer.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-565">事件記錄檔未成功清除。</span><span class="sxs-lookup"><span data-stu-id="2b88f-565">The event log was not cleared successfully.</span></span>  
  
<span data-ttu-id="2b88f-566">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-566">-or-</span></span> 
<span data-ttu-id="2b88f-567">無法開啟記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-567">The log cannot be opened.</span></span> <span data-ttu-id="2b88f-568">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-568">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-569">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-569">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-570">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-570">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="2b88f-571">將應用程式的事件來源登錄從事件記錄檔移除。</span><span class="sxs-lookup"><span data-stu-id="2b88f-571">Removes an application's event source registration from the event log.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source);" />
      <MemberSignature Language="F#" Value="static member DeleteEventSource : string -&gt; unit" Usage="System.Diagnostics.EventLog.DeleteEventSource source" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-572">應用程式在事件記錄檔系統中登錄的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-572">The name by which the application is registered in the event log system.</span></span></param>
        <summary><span data-ttu-id="2b88f-573">將事件來源登錄從本機電腦的事件記錄檔移除。</span><span class="sxs-lookup"><span data-stu-id="2b88f-573">Removes the event source registration from the event log of the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-574">使用這個方法來移除註冊<xref:System.Diagnostics.EventLog.Source%2A>從本機電腦。</span><span class="sxs-lookup"><span data-stu-id="2b88f-574">Use this method to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from the local computer.</span></span> <span data-ttu-id="2b88f-575"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 存取本機電腦上的登錄，並移除應用程式有效的事件來源的註冊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-575"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the local computer and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="2b88f-576">如果您不再需要它寫入該記錄檔中的項目，您可以為有效的事件來源移除您的元件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-576">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="2b88f-577">例如，您可能會執行這項操作如果您需要變更您的元件和一個記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-577">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="2b88f-578">因為來源一次只能註冊一個記錄檔，變更記錄檔需要您移除目前的註冊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-578">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="2b88f-579"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 移除只登錄到記錄檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-579"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="2b88f-580">如果您想要移除記錄檔本身，呼叫<xref:System.Diagnostics.EventLog.Delete%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-580">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="2b88f-581">如果您只想要刪除的記錄項目，呼叫<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-581">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="2b88f-582"><xref:System.Diagnostics.EventLog.Delete%2A> 並<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，讓它們可以呼叫類別本身。</span><span class="sxs-lookup"><span data-stu-id="2b88f-582"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="2b88f-583">您不需要建立的執行個體<xref:System.Diagnostics.EventLog>呼叫這些方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-583">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="2b88f-584">正在刪除記錄，以透過呼叫<xref:System.Diagnostics.EventLog.Delete%2A>會自動刪除該記錄檔註冊的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-584">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="2b88f-585">這可讓其他應用程式使用該記錄檔無法作業。</span><span class="sxs-lookup"><span data-stu-id="2b88f-585">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-586">如果來源已對應至記錄重新對應至新的記錄檔，您必須重新啟動電腦，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-586">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-587">下列範例會從本機電腦刪除的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-587">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="2b88f-588">此範例會判斷其來源的記錄檔，，然後刪除記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-588">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-589">多個來源可能會寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-589">More than one source might write to an event log.</span></span> <span data-ttu-id="2b88f-590">之前刪除自訂記錄檔，請確定沒有其他寫入該記錄檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-590">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-591">本機電腦的登錄中沒有 <paramref name="source" /> 參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-591">The <paramref name="source" /> parameter does not exist in the registry of the local computer.</span></span>  
  
<span data-ttu-id="2b88f-592">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-592">\- or -</span></span> 
<span data-ttu-id="2b88f-593">您沒有事件記錄檔登錄機碼的寫入權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-593">You do not have write access on the registry key for the event log.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-594">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-594">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-595">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-595">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member DeleteEventSource : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.DeleteEventSource (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-596">應用程式在事件記錄檔系統中登錄的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-596">The name by which the application is registered in the event log system.</span></span></param>
        <param name="machineName"><span data-ttu-id="2b88f-597">要移除登錄的電腦名稱，或者表示本機電腦的 "."。</span><span class="sxs-lookup"><span data-stu-id="2b88f-597">The name of the computer to remove the registration from, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="2b88f-598">將應用程式的事件來源登錄從指定的電腦移除。</span><span class="sxs-lookup"><span data-stu-id="2b88f-598">Removes the application's event source registration from the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-599">若要移除註冊使用此多載<xref:System.Diagnostics.EventLog.Source%2A>從遠端電腦。</span><span class="sxs-lookup"><span data-stu-id="2b88f-599">Use this overload to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from a remote computer.</span></span> <span data-ttu-id="2b88f-600"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 存取所指定的電腦上的登錄`machineName`，並移除您的應用程式，為有效的事件來源的註冊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-600"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the computer specified by `machineName` and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="2b88f-601">如果您不再需要它寫入該記錄檔中的項目，您可以為有效的事件來源移除您的元件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-601">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="2b88f-602">例如，您可能會執行這項操作如果您需要變更您的元件和一個記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-602">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="2b88f-603">因為來源一次只能註冊一個記錄檔，變更記錄檔需要您移除目前的註冊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-603">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="2b88f-604"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 移除只登錄到記錄檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-604"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="2b88f-605">如果您想要移除記錄檔本身，呼叫<xref:System.Diagnostics.EventLog.Delete%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-605">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="2b88f-606">如果您只想要刪除的記錄項目，呼叫<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-606">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="2b88f-607"><xref:System.Diagnostics.EventLog.Delete%2A> 並<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，讓它們可以呼叫類別本身。</span><span class="sxs-lookup"><span data-stu-id="2b88f-607"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="2b88f-608">您不需要建立的執行個體<xref:System.Diagnostics.EventLog>呼叫這些方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-608">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="2b88f-609">正在刪除記錄，以透過呼叫<xref:System.Diagnostics.EventLog.Delete%2A>會自動刪除該記錄檔註冊的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-609">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="2b88f-610">這可讓其他應用程式使用該記錄檔無法作業。</span><span class="sxs-lookup"><span data-stu-id="2b88f-610">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-611">如果來源已對應至記錄重新對應至新的記錄檔，您必須重新啟動電腦，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-611">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-612">下列範例會從指定的電腦刪除的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-612">The following example deletes a source from the specified computer.</span></span> <span data-ttu-id="2b88f-613">此範例會判斷其來源的記錄檔，，然後刪除記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-613">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-614">多個來源可能會寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-614">More than one source might write to an event log.</span></span> <span data-ttu-id="2b88f-615">之前刪除自訂記錄檔，請確定沒有其他寫入該記錄檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-615">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-616"><paramref name="machineName" /> 參數無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-616">The <paramref name="machineName" /> parameter is invalid.</span></span>  
  
<span data-ttu-id="2b88f-617">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-617">\- or -</span></span> 
<span data-ttu-id="2b88f-618">指定電腦的登錄中沒有 <paramref name="source" /> 參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-618">The <paramref name="source" /> parameter does not exist in the registry of the specified computer.</span></span>  
  
<span data-ttu-id="2b88f-619">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-619">\- or -</span></span> 
<span data-ttu-id="2b88f-620">您沒有事件記錄檔登錄機碼的寫入權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-620">You do not have write access on the registry key for the event log.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-621">無法刪除 <paramref name="source" />，因為在登錄中，<paramref name="source" /> 的父登錄機碼並未包含具有相同名稱的子機碼 (Subkey)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-621"><paramref name="source" /> cannot be deleted because in the registry, the parent registry key for <paramref name="source" /> does not contain a subkey with the same name.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-622">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-622">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-623">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-623">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberSignature Language="F#" Value="override this.Dispose : bool -&gt; unit" Usage="eventLog.Dispose disposing" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing"><span data-ttu-id="2b88f-624"><see langword="true" /> 表示釋放 Managed 和 Unmanaged 資源，<see langword="false" /> 則表示只釋放 Unmanaged 資源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-624"><see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span></span></param>
        <summary><span data-ttu-id="2b88f-625">釋放 <see cref="T:System.Diagnostics.EventLog" /> 所使用的 Unmanaged 資源，並選擇性釋放 Managed 資源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-625">Releases the unmanaged resources used by the <see cref="T:System.Diagnostics.EventLog" />, and optionally releases the managed resources.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-626">這個方法會呼叫公用`Dispose()`方法和<xref:System.Object.Finalize%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-626">This method is called by the public `Dispose()` method and the <xref:System.Object.Finalize%2A> method.</span></span> <span data-ttu-id="2b88f-627">`Dispose()` 叫用受保護`Dispose(Boolean)`方法`disposing`參數設為`true`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-627">`Dispose()` invokes the protected `Dispose(Boolean)` method with the `disposing` parameter set to `true`.</span></span> <span data-ttu-id="2b88f-628"><xref:System.Object.Finalize%2A> 叫用`Dispose`具有`disposing`設定為`false`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-628"><xref:System.Object.Finalize%2A> invokes `Dispose` with `disposing` set to `false`.</span></span>  
  
 <span data-ttu-id="2b88f-629">當`disposing`參數為 true 時，這個方法由任何 managed 物件持有的資源全部釋出這個<xref:System.Diagnostics.EventLog>參考。</span><span class="sxs-lookup"><span data-stu-id="2b88f-629">When the `disposing` parameter is true, this method releases all resources held by any managed objects that this <xref:System.Diagnostics.EventLog> references.</span></span> <span data-ttu-id="2b88f-630">這個方法會叫用每個參考物件的 `Dispose()` 方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-630">This method invokes the `Dispose()` method of each referenced object.</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides"><para><span data-ttu-id="2b88f-631">
            <see langword="Dispose" /> 可以被其他物件呼叫多次。</span><span class="sxs-lookup"><span data-stu-id="2b88f-631">
            <see langword="Dispose" /> can be called multiple times by other objects.</span></span> <span data-ttu-id="2b88f-632">當覆寫<see langword="Dispose(Boolean)" />小心不要參考先前處置好的呼叫中的物件<see langword="Dispose" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-632">When overriding <see langword="Dispose(Boolean)" /> be careful not to reference objects that have been previously disposed of in an earlier call to <see langword="Dispose" />.</span></span> <span data-ttu-id="2b88f-633">如需有關如何實作<see langword="Dispose(Boolean)" />，請參閱 &lt;&lt;c2&gt; [ 實作 Dispose 方法](~/docs/standard/garbage-collection/implementing-dispose.md)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-633">For more information about how to implement <see langword="Dispose(Boolean)" />, see [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).</span></span>  
  
<span data-ttu-id="2b88f-634">如需詳細資訊<see langword="Dispose" />並<see cref="M:System.Object.Finalize" />，請參閱[清除 Unmanaged 資源總](~/docs/standard/garbage-collection/unmanaged.md)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-634">For more information about <see langword="Dispose" /> and <see cref="M:System.Object.Finalize" />, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md).</span></span></para></block>
      </Docs>
    </Member>
    <Member MemberName="EnableRaisingEvents">
      <MemberSignature Language="C#" Value="public bool EnableRaisingEvents { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableRaisingEvents" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberSignature Language="VB.NET" Value="Public Property EnableRaisingEvents As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableRaisingEvents { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableRaisingEvents : bool with get, set" Usage="System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("If enabled raises event when a log is written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogMonitoring")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-635">取得或設定值，表示 <see cref="T:System.Diagnostics.EventLog" /> 是否接收 <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> 事件通知。</span><span class="sxs-lookup"><span data-stu-id="2b88f-635">Gets or sets a value indicating whether the <see cref="T:System.Diagnostics.EventLog" /> receives <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event notifications.</span></span></summary>
        <value><span data-ttu-id="2b88f-636">如果 <see cref="T:System.Diagnostics.EventLog" /> 在項目寫入到記錄檔時接收通知，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-636"><see langword="true" /> if the <see cref="T:System.Diagnostics.EventLog" /> receives notification when an entry is written to the log; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-637"><xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A>屬性會決定是否<xref:System.Diagnostics.EventLog>引發事件時寫入記錄檔項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-637">The <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> property determines whether the <xref:System.Diagnostics.EventLog> raises events when entries are written to the log.</span></span> <span data-ttu-id="2b88f-638">將屬性何時`true`，會收到的元件<xref:System.Diagnostics.EventLog.EntryWritten>事件將會收到通知任何時間項目會寫入至記錄檔中指定<xref:System.Diagnostics.EventLog.Log%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-638">When the property is `true`, components that receive the <xref:System.Diagnostics.EventLog.EntryWritten> event will receive notification any time an entry is written to the log that is specified in the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="2b88f-639">如果<xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A>是`false`，不會引發事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-639">If <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> is `false`, no events are raised.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-640">只有當項目會寫入本機電腦上，您可以接收事件通知。</span><span class="sxs-lookup"><span data-stu-id="2b88f-640">You can receive event notifications only when entries are written on the local computer.</span></span> <span data-ttu-id="2b88f-641">您無法接收通知的遠端電腦上寫入的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-641">You cannot receive notifications for entries written on remote computers.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-642">下列範例會處理<xref:System.Diagnostics.EventLog.EntryWritten>事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-642">The following example handles an <xref:System.Diagnostics.EventLog.EntryWritten> event.</span></span>  
  
 [!code-cpp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-643">事件記錄位於遠端電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-643">The event log is on a remote computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-644">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-644">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-645">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-645">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
      </Docs>
    </Member>
    <Member MemberName="EndInit">
      <MemberSignature Language="C#" Value="public void EndInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void EndInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.EndInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub EndInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void EndInit();" />
      <MemberSignature Language="F#" Value="abstract member EndInit : unit -&gt; unit&#xA;override this.EndInit : unit -&gt; unit" Usage="eventLog.EndInit " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.EndInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="2b88f-646">結束對表單或為另一個元件所使用之 <see cref="T:System.Diagnostics.EventLog" /> 的初始化。</span><span class="sxs-lookup"><span data-stu-id="2b88f-646">Ends the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or by another component.</span></span> <span data-ttu-id="2b88f-647">初始化會於執行階段時執行。</span><span class="sxs-lookup"><span data-stu-id="2b88f-647">The initialization occurs at runtime.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-648">[!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)]設計環境會使用這個方法來結束初始化用於表單或另一個元件所使用的元件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-648">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to end the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="2b88f-649"><xref:System.Diagnostics.EventLog.BeginInit%2A>方法會啟動初始化。</span><span class="sxs-lookup"><span data-stu-id="2b88f-649">The <xref:System.Diagnostics.EventLog.BeginInit%2A> method starts the initialization.</span></span> <span data-ttu-id="2b88f-650">使用<xref:System.Diagnostics.EventLog.BeginInit%2A>和<xref:System.Diagnostics.EventLog.EndInit%2A>方法，防止控制項被完全初始化之前使用。</span><span class="sxs-lookup"><span data-stu-id="2b88f-650">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevents the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-651">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-651">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-652">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-652">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.BeginInit" />
      </Docs>
    </Member>
    <Member MemberName="Entries">
      <MemberSignature Language="C#" Value="public System.Diagnostics.EventLogEntryCollection Entries { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Diagnostics.EventLogEntryCollection Entries" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Entries" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Entries As EventLogEntryCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::EventLogEntryCollection ^ Entries { System::Diagnostics::EventLogEntryCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Entries : System.Diagnostics.EventLogEntryCollection" Usage="System.Diagnostics.EventLog.Entries" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("The entries in the log.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogEntries")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netcore-2.1;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLogEntryCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-653">取得事件記錄檔的內容。</span><span class="sxs-lookup"><span data-stu-id="2b88f-653">Gets the contents of the event log.</span></span></summary>
        <value><span data-ttu-id="2b88f-654">將項目保存在事件記錄檔中的 <see cref="T:System.Diagnostics.EventLogEntryCollection" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-654">An <see cref="T:System.Diagnostics.EventLogEntryCollection" /> holding the entries in the event log.</span></span> <span data-ttu-id="2b88f-655">每個項目與 <see cref="T:System.Diagnostics.EventLogEntry" /> 類別的執行個體相關聯。</span><span class="sxs-lookup"><span data-stu-id="2b88f-655">Each entry is associated with an instance of the <see cref="T:System.Diagnostics.EventLogEntry" /> class.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-656">使用<xref:System.Diagnostics.EventLog.Entries%2A>時讀取事件記錄檔的成員。</span><span class="sxs-lookup"><span data-stu-id="2b88f-656">Use the <xref:System.Diagnostics.EventLog.Entries%2A> member when reading from the event log.</span></span>  
  
 <span data-ttu-id="2b88f-657">因為屬性是唯讀，則您無法修改項目，或寫入記錄檔使用<xref:System.Diagnostics.EventLog.Entries%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-657">Because the property is read-only, you cannot modify an entry or write to the log using <xref:System.Diagnostics.EventLog.Entries%2A>.</span></span> <span data-ttu-id="2b88f-658">相反地，指定<xref:System.Diagnostics.EventLog.Source%2A>並呼叫<xref:System.Diagnostics.EventLog.WriteEntry%2A>撰寫新的記錄項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-658">Instead, specify a <xref:System.Diagnostics.EventLog.Source%2A> and call <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write a new log entry.</span></span> <span data-ttu-id="2b88f-659">您可以使用<xref:System.Diagnostics.EventLog.Entries%2A>來計算事件記錄檔中的項目數，並檢視每個<xref:System.Diagnostics.EventLogEntry>集合中。</span><span class="sxs-lookup"><span data-stu-id="2b88f-659">You can use <xref:System.Diagnostics.EventLog.Entries%2A> to count the number of entries in the event log, and view each <xref:System.Diagnostics.EventLogEntry> in the collection.</span></span> <span data-ttu-id="2b88f-660">使用索引<xref:System.Diagnostics.EventLogEntryCollection.Item%2A>成員，才能擷取資訊的特定項目，例如<xref:System.Diagnostics.EventLogEntry.Message%2A>， <xref:System.Diagnostics.EventLogEntry.Category%2A>， <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>，或<xref:System.Diagnostics.EventLogEntry.EntryType%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-660">Use the indexed <xref:System.Diagnostics.EventLogEntryCollection.Item%2A> member to retrieve information about a specific entry, such as <xref:System.Diagnostics.EventLogEntry.Message%2A>, <xref:System.Diagnostics.EventLogEntry.Category%2A>, <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>, or <xref:System.Diagnostics.EventLogEntry.EntryType%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-661">您不需要指定<xref:System.Diagnostics.EventLog.Source%2A>時只能讀取記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-661">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log.</span></span> <span data-ttu-id="2b88f-662">您可以只指定<xref:System.Diagnostics.EventLog.Log%2A>名稱和<xref:System.Diagnostics.EventLog.MachineName%2A>（伺服器電腦名稱） 屬性<xref:System.Diagnostics.EventLog>執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-662">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) properties for the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="2b88f-663">在任一情況下，<xref:System.Diagnostics.EventLog.Entries%2A>成員會自動填入的項目事件記錄檔的清單。</span><span class="sxs-lookup"><span data-stu-id="2b88f-663">In either case, the <xref:System.Diagnostics.EventLog.Entries%2A> member is automatically populated with the event log's list of entries.</span></span> <span data-ttu-id="2b88f-664">您可以讀取個別項目這份清單中選取適當的項目索引。</span><span class="sxs-lookup"><span data-stu-id="2b88f-664">You can select the appropriate index for an item in this list to read individual entries.</span></span>  
  
 <span data-ttu-id="2b88f-665">讀取和寫入記錄項目之間的重要區別是不需要明確地呼叫讀取的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-665">An important distinction between reading and writing log entries is that it is not necessary to explicitly call a read method.</span></span> <span data-ttu-id="2b88f-666">之後<xref:System.Diagnostics.EventLog.Log%2A>並<xref:System.Diagnostics.EventLog.MachineName%2A>都有指定，<xref:System.Diagnostics.EventLog.Entries%2A>屬性會自動填入。</span><span class="sxs-lookup"><span data-stu-id="2b88f-666">After the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> are specified, the <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated.</span></span> <span data-ttu-id="2b88f-667">如果您變更的值<xref:System.Diagnostics.EventLog.Log%2A>或是<xref:System.Diagnostics.EventLog.MachineName%2A>屬性，<xref:System.Diagnostics.EventLog.Entries%2A>屬性會填入您閱讀下一次。</span><span class="sxs-lookup"><span data-stu-id="2b88f-667">If you change the value of the <xref:System.Diagnostics.EventLog.Log%2A> or <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog.Entries%2A> property is repopulated the next time you read it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-668">您不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果您要連接到記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-668">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="2b88f-669">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本機電腦中，"。"，會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-669">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer, ".", is assumed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-670">下列範例會讀取事件記錄檔中，「 MyNewLog 」，在本機電腦上的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-670">The following example reads entries in the event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Entries Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Entries Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Entries Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-671">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-671">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-672">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-672">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
      </Docs>
    </Member>
    <Member MemberName="EntryWritten">
      <MemberSignature Language="C#" Value="public event System.Diagnostics.EntryWrittenEventHandler EntryWritten;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Diagnostics.EntryWrittenEventHandler EntryWritten" />
      <MemberSignature Language="DocId" Value="E:System.Diagnostics.EventLog.EntryWritten" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event EntryWritten As EntryWrittenEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Diagnostics::EntryWrittenEventHandler ^ EntryWritten;" />
      <MemberSignature Language="F#" Value="member this.EntryWritten : System.Diagnostics.EntryWrittenEventHandler " Usage="member this.EntryWritten : System.Diagnostics.EntryWrittenEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Raised for each EventLog entry written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogEntryWritten")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EntryWrittenEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-673">發生於項目寫入至本機電腦上的事件記錄檔時。</span><span class="sxs-lookup"><span data-stu-id="2b88f-673">Occurs when an entry is written to an event log on the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-674">若要取得事件通知，您必須設定<xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A>至`true`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-674">To get event notifications, you must set <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> to `true`.</span></span> <span data-ttu-id="2b88f-675">項目寫入本機電腦上時，您只可以接收事件通知。</span><span class="sxs-lookup"><span data-stu-id="2b88f-675">You can only receive event notifications when entries are written on the local computer.</span></span> <span data-ttu-id="2b88f-676">您無法接收通知的遠端電腦上寫入的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-676">You cannot receive notifications for entries written on remote computers.</span></span>  
  
 <span data-ttu-id="2b88f-677">當您建立 <xref:System.Diagnostics.EventLog.EntryWritten> 委派 (Delegate) 時，就可以識別即將處理此事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-677">When you create an <xref:System.Diagnostics.EventLog.EntryWritten> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="2b88f-678">若要使事件與您的事件處理常式產生關聯，請將委派的執行個體 (Instance) 加入至事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-678">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="2b88f-679">每當事件發生時，直到您移除委派，會呼叫事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="2b88f-679">The event handler is called whenever the event occurs, until you remove the delegate.</span></span> <span data-ttu-id="2b88f-680">如需有關如何使用委派處理事件的詳細資訊，請參閱[處理和引發事件](~/docs/standard/events/index.md)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-680">For more information about handling events with delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
 <span data-ttu-id="2b88f-681">系統會回應<xref:System.Diagnostics.EventLog.WriteEntry%2A>只有當最後一個寫入事件發生至少六秒之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-681">The system responds to <xref:System.Diagnostics.EventLog.WriteEntry%2A> only if the last write event occurred at least six seconds previously.</span></span> <span data-ttu-id="2b88f-682">這表示您只會收到一個<xref:System.Diagnostics.EventLog.EntryWritten>六秒的間隔內的事件通知，即使多個事件記錄的變更時發生。</span><span class="sxs-lookup"><span data-stu-id="2b88f-682">This implies you will only receive one <xref:System.Diagnostics.EventLog.EntryWritten> event notification within a six-second interval, even if more than one event log change occurs.</span></span> <span data-ttu-id="2b88f-683">如果您插入夠長的睡眠間隔 （大約 10 秒） 之間的呼叫<xref:System.Diagnostics.EventLog.WriteEntry%2A>，您不太可能遺漏事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-683">If you insert a sufficiently long sleep interval (around 10 seconds) between calls to <xref:System.Diagnostics.EventLog.WriteEntry%2A>, you are less likely to miss an event.</span></span> <span data-ttu-id="2b88f-684">不過，如果寫入事件的發生頻率，您可能會收到事件通知，直到下一個間隔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-684">However, if write events occur more frequently, you might not recieve the event notification until the next interval.</span></span> <span data-ttu-id="2b88f-685">一般而言，遺失的事件通知不會遺失，但延遲。</span><span class="sxs-lookup"><span data-stu-id="2b88f-685">Typically, missed event notifications are not lost, but delayed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-686">下列範例會處理項目寫入事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-686">The following example handles an entry written event.</span></span>  
  
 [!code-cpp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EntryWritten Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-687">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-687">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-688">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-688">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Exists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="2b88f-689">判斷指定的記錄檔是否存在。</span><span class="sxs-lookup"><span data-stu-id="2b88f-689">Determines whether the specified log exists.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member Exists : string -&gt; bool" Usage="System.Diagnostics.EventLog.Exists logName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="2b88f-690">要搜尋的記錄檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-690">The name of the log to search for.</span></span> <span data-ttu-id="2b88f-691">可能的值包括：應用程式、安全性、系統、其他應用程式特定的記錄檔 (例如，與 Active Directory 關聯的記錄檔)，或者電腦上的任何自訂記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-691">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span></span></param>
        <summary><span data-ttu-id="2b88f-692">判斷記錄檔是否存在於本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-692">Determines whether the log exists on the local computer.</span></span></summary>
        <returns><span data-ttu-id="2b88f-693">如果記錄檔存在於本機電腦上，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-693"><see langword="true" /> if the log exists on the local computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-694">使用此方法來判斷是否記錄檔存在於本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-694">Use this method to determine if a log exists on the local computer.</span></span> <span data-ttu-id="2b88f-695">如果您想要判斷來源是否存在於本機電腦，也就是使用<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-695">If you want to determine whether a source exists on the local computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-696">由於這個方法會存取登錄，您還必須擁有適當的登錄權限，本機電腦上，否則，查詢會傳回`false`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-696">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="2b88f-697">是因為您無法在相同電腦上讓新的記錄檔的現有記錄檔名稱，然後再建立新的記錄檔使用此方法來判斷是否指定`logName`已存在於本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-697">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if the specified `logName` already exists on the local computer.</span></span> <span data-ttu-id="2b88f-698">`logName`參數不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="2b88f-698">The `logName` parameter is not case sensitive.</span></span>  
  
 <span data-ttu-id="2b88f-699"><xref:System.Diagnostics.EventLog.Exists%2A> 是`static`方法，所以它可以呼叫類別本身。</span><span class="sxs-lookup"><span data-stu-id="2b88f-699"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="2b88f-700">您不需要建立的執行個體<xref:System.Diagnostics.EventLog>呼叫<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-700">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_Exists_1#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_Exists_1/CPP/eventlog_exists_1.cpp#1)]
 [!code-csharp[EventLog_Exists_1#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_Exists_1/CS/eventlog_exists_1.cs#1)]
 [!code-vb[EventLog_Exists_1#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_Exists_1/VB/eventlog_exists_1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-701">logName 是 <see langword="null" /> 或者是空值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-701">The logName is <see langword="null" /> or the value is empty.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-702">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-702">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-703">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-703">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member Exists : string * string -&gt; bool" Usage="System.Diagnostics.EventLog.Exists (logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="2b88f-704">要搜尋的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-704">The log for which to search.</span></span> <span data-ttu-id="2b88f-705">可能的值包括：應用程式、安全性、系統、其他應用程式特定的記錄檔 (例如，與 Active Directory 關聯的記錄檔)，或者電腦上的任何自訂記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-705">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span></span></param>
        <param name="machineName"><span data-ttu-id="2b88f-706">要在其上搜尋記錄檔的電腦的名稱，或者表示本機電腦的 "."。</span><span class="sxs-lookup"><span data-stu-id="2b88f-706">The name of the computer on which to search for the log, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="2b88f-707">判斷記錄檔是否存在於指定的電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-707">Determines whether the log exists on the specified computer.</span></span></summary>
        <returns><span data-ttu-id="2b88f-708">如果記錄檔存在於指定的電腦上，則為 <see langword="true" />；否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-708"><see langword="true" /> if the log exists on the specified computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-709">使用此方法來判斷遠端電腦上是否有記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-709">Use this method to determine if a log exists on a remote computer.</span></span> <span data-ttu-id="2b88f-710">如果您想要判斷來源是否存在的遠端電腦上，使用<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-710">If you want to determine whether a source exists on a remote computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-711">由於這個方法會存取登錄，您必須擁有適當的登錄權限指定電腦上，否則，查詢會傳回`false`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-711">Because this method accesses the registry, you must have the appropriate registry permissions on the specified computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="2b88f-712">是因為您無法在相同電腦上讓新的記錄檔的現有記錄檔名稱，然後再建立新的記錄檔使用此方法以判斷是一個具有指定之`logName`已存在於所指定的伺服器上`machineName`參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-712">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if one with the specified `logName` already exists on the server specified by the `machineName` parameter.</span></span> <span data-ttu-id="2b88f-713">`logName`和`machineName`參數不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="2b88f-713">The `logName` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="2b88f-714"><xref:System.Diagnostics.EventLog.Exists%2A> 是`static`方法，所以它可以呼叫類別本身。</span><span class="sxs-lookup"><span data-stu-id="2b88f-714"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="2b88f-715">您不需要建立的新執行個體<xref:System.Diagnostics.EventLog>呼叫<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-715">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-716"><paramref name="machineName" /> 參數是無效的格式。</span><span class="sxs-lookup"><span data-stu-id="2b88f-716">The <paramref name="machineName" /> parameter is an invalid format.</span></span> <span data-ttu-id="2b88f-717">確認要搜尋的電腦採用的適合的語法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-717">Make sure you have used proper syntax for the computer on which you are searching.</span></span>  
  
<span data-ttu-id="2b88f-718">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-718">-or-</span></span> 
<span data-ttu-id="2b88f-719"><paramref name="logName" /> 是 <see langword="null" /> 或者是空值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-719">The <paramref name="logName" /> is <see langword="null" /> or the value is empty.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-720">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-720">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-721">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-721">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetEventLogs">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="2b88f-722">建立事件記錄檔的陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-722">Creates an array of the event logs.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs () As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs();" />
      <MemberSignature Language="F#" Value="static member GetEventLogs : unit -&gt; System.Diagnostics.EventLog[]" Usage="System.Diagnostics.EventLog.GetEventLogs " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="2b88f-723">搜尋本機電腦上的所有事件記錄檔，並建立含有清單的 <see cref="T:System.Diagnostics.EventLog" /> 物件陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-723">Searches for all event logs on the local computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span></span></summary>
        <returns><span data-ttu-id="2b88f-724">表示本機電腦上記錄檔的類型 <see cref="T:System.Diagnostics.EventLog" /> 的陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-724">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the local computer.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-725">陣列<xref:System.Diagnostics.EventLog>物件是在本機電腦上的所有事件記錄檔的快照集時呼叫<xref:System.Diagnostics.EventLog.GetEventLogs%2A>為止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-725">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the local computer when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="2b88f-726">這不是動態集合，因此不會反映刪除或建立即時的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-726">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="2b88f-727">您應該確認陣列中的記錄檔存在，才能讀取或寫入其中。</span><span class="sxs-lookup"><span data-stu-id="2b88f-727">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="2b88f-728">陣列通常會包含至少三個記錄檔：應用程式、 系統及安全性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-728">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="2b88f-729">如果您在本機電腦上建立自訂記錄檔，它們會出現在陣列以及。</span><span class="sxs-lookup"><span data-stu-id="2b88f-729">If you created custom logs on the local computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="2b88f-730">若要擷取的事件記錄檔清單，您必須使用適當的登錄權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-730">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="2b88f-731">這些權限完全相同的呼叫所需<xref:System.Diagnostics.EventLog.Exists%2A>和<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-731">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-732">下列範例會列舉在本機電腦上定義的事件記錄檔，並顯示每個事件記錄檔的組態詳細資料。</span><span class="sxs-lookup"><span data-stu-id="2b88f-732">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.SystemException"><span data-ttu-id="2b88f-733">您沒有讀取登錄的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-733">You do not have read access to the registry.</span></span>  
  
<span data-ttu-id="2b88f-734">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-734">-or-</span></span> 
<span data-ttu-id="2b88f-735">電腦上沒有事件記錄檔服務。</span><span class="sxs-lookup"><span data-stu-id="2b88f-735">There is no event log service on the computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-736">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-736">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-737">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-737">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs (machineName As String) As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetEventLogs : string -&gt; System.Diagnostics.EventLog[]" Usage="System.Diagnostics.EventLog.GetEventLogs machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="2b88f-738">要在其上搜尋事件記錄檔的電腦。</span><span class="sxs-lookup"><span data-stu-id="2b88f-738">The computer on which to search for event logs.</span></span></param>
        <summary><span data-ttu-id="2b88f-739">搜尋指定電腦上的所有事件記錄檔，並建立含有清單的 <see cref="T:System.Diagnostics.EventLog" /> 物件陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-739">Searches for all event logs on the given computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span></span></summary>
        <returns><span data-ttu-id="2b88f-740">表示指定電腦上記錄檔的類型 <see cref="T:System.Diagnostics.EventLog" /> 的陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-740">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the given computer.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-741">陣列<xref:System.Diagnostics.EventLog>物件是所指定的電腦上的所有事件記錄檔的快照集`machineName`參數時呼叫<xref:System.Diagnostics.EventLog.GetEventLogs%2A>為止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-741">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the computer specified by the `machineName` parameter when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="2b88f-742">這不是動態集合，因此不會反映刪除或建立即時的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-742">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="2b88f-743">您應該確認陣列中的記錄檔存在，才能讀取或寫入其中。</span><span class="sxs-lookup"><span data-stu-id="2b88f-743">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="2b88f-744">陣列通常會包含至少三個記錄檔：應用程式、 系統及安全性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-744">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="2b88f-745">如果您指定的電腦上建立自訂記錄檔，它們會出現在陣列以及。</span><span class="sxs-lookup"><span data-stu-id="2b88f-745">If you created custom logs on the specified computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="2b88f-746"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> 已`static`方法，所以它可呼叫<xref:System.Diagnostics.EventLog>類別本身。</span><span class="sxs-lookup"><span data-stu-id="2b88f-746"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> is a `static` method, so it can be called on the <xref:System.Diagnostics.EventLog> class itself.</span></span> <span data-ttu-id="2b88f-747">您不需要建立的執行個體<xref:System.Diagnostics.EventLog>撥打電話給方法的物件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-747">It is not necessary to create an instance of an <xref:System.Diagnostics.EventLog> object to make a call to the method.</span></span>  
  
 <span data-ttu-id="2b88f-748">若要擷取的事件記錄檔清單，您必須使用適當的登錄權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-748">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="2b88f-749">這些權限完全相同的呼叫所需<xref:System.Diagnostics.EventLog.Exists%2A>和<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-749">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-750">下列範例會取得電腦"位於 myServer"上的記錄檔清單。</span><span class="sxs-lookup"><span data-stu-id="2b88f-750">The following example gets a list of logs on the computer "myServer".</span></span> <span data-ttu-id="2b88f-751">然後，它會輸出每個記錄檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-751">It then outputs the name of each log.</span></span>  
  
 [!code-cpp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-752"><paramref name="machineName" /> 參數是無效的電腦名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-752">The <paramref name="machineName" /> parameter is an invalid computer name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-753">您沒有讀取登錄的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-753">You do not have read access to the registry.</span></span>  
  
<span data-ttu-id="2b88f-754">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-754">-or-</span></span> 
<span data-ttu-id="2b88f-755">電腦上沒有事件記錄檔服務。</span><span class="sxs-lookup"><span data-stu-id="2b88f-755">There is no event log service on the computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-756">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-756">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-757">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-757">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="Log">
      <MemberSignature Language="C#" Value="public string Log { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Log" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Log" />
      <MemberSignature Language="VB.NET" Value="Public Property Log As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Log { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Log : string with get, set" Usage="System.Diagnostics.EventLog.Log" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the log that is read and written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogLog")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-758">取得或設定要讀取或寫入的事件記錄檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-758">Gets or sets the name of the log to read from or write to.</span></span></summary>
        <value><span data-ttu-id="2b88f-759">記錄檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-759">The name of the log.</span></span> <span data-ttu-id="2b88f-760">可以是應用程式、系統、安全性或者自訂的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-760">This can be Application, System, Security, or a custom log name.</span></span> <span data-ttu-id="2b88f-761">預設為空字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-761">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-762">預設會在伺服器上，有三個記錄檔：應用程式、 系統及安全性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-762">Three log files exist by default on the server: Application, System, and Security.</span></span> <span data-ttu-id="2b88f-763">應用程式和服務使用的應用程式記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-763">Applications and services use the Application log file.</span></span> <span data-ttu-id="2b88f-764">裝置驅動程式會使用系統記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-764">Device drivers use the System log file.</span></span> <span data-ttu-id="2b88f-765">開啟稽核時，系統會產生成功和失敗稽核事件安全性記錄檔中。</span><span class="sxs-lookup"><span data-stu-id="2b88f-765">The system generates success and failure audit events in the Security log when auditing is turned on.</span></span> <span data-ttu-id="2b88f-766">如果您有其他應用程式安裝，例如在 Windows 伺服器上的 Active Directory 可能有其他的預設記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-766">If you have other applications installed, like Active Directory on Windows servers, there might be other default log files.</span></span> <span data-ttu-id="2b88f-767">此外，您可以建立自訂記錄檔，在本機或遠端電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-767">In addition, you can create custom log files on a local or remote computer.</span></span> <span data-ttu-id="2b88f-768">自訂的記錄檔可協助組織以更詳細的方式比您的元件會將事件寫入預設應用程式記錄檔時所允許的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-768">Custom logs help organize your entries in a more detailed way than is allowed when your components write events to the default Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-769">記錄檔名稱僅限於 8 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-769">Log names are limited to eight characters.</span></span> <span data-ttu-id="2b88f-770">根據系統，MyLogSample1 MyLogSample2 等相同的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-770">According to the system, MyLogSample1 and MyLogSample2 are the same log.</span></span>  
  
 <span data-ttu-id="2b88f-771">如果您寫入事件記錄檔，並不夠指定<xref:System.Diagnostics.EventLog.Log%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-771">If you write to an event log, it is not enough to specify the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="2b88f-772">您必須使<xref:System.Diagnostics.EventLog.Source%2A>與將它連接到特定的記錄檔事件記錄檔資源的屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-772">You must associate a <xref:System.Diagnostics.EventLog.Source%2A> property with your event log resource to connect it to a particular log.</span></span> <span data-ttu-id="2b88f-773">您不需要指定<xref:System.Diagnostics.EventLog.Source%2A>僅讀取記錄檔，但事件來源時必須與伺服器的登錄中的事件記錄檔資源相關聯。</span><span class="sxs-lookup"><span data-stu-id="2b88f-773">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log, but an event source must be associated with the event log resource in the server's registry.</span></span> <span data-ttu-id="2b88f-774">您可以只指定<xref:System.Diagnostics.EventLog.Log%2A>名稱和<xref:System.Diagnostics.EventLog.MachineName%2A>從中讀取的 （伺服器電腦名稱）。</span><span class="sxs-lookup"><span data-stu-id="2b88f-774">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) to read from it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-775">您不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果您要連接到記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-775">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="2b88f-776">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-776">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-777">如果<xref:System.Diagnostics.EventLog.Source%2A>未指定屬性，呼叫<xref:System.Diagnostics.EventLog.Log%2A>會傳回空字串，如果<xref:System.Diagnostics.EventLog.Log%2A>尚未明確設定 (藉由設定<xref:System.Diagnostics.EventLog.Log%2A>屬性，或透過建構函式)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-777">If the <xref:System.Diagnostics.EventLog.Source%2A> property has not been specified, a call to <xref:System.Diagnostics.EventLog.Log%2A> returns an empty string if <xref:System.Diagnostics.EventLog.Log%2A> has not been explicitly set (by setting the <xref:System.Diagnostics.EventLog.Log%2A> property, or through the constructor).</span></span> <span data-ttu-id="2b88f-778">如果<xref:System.Diagnostics.EventLog.Source%2A>已指定，<xref:System.Diagnostics.EventLog.Log%2A>傳回註冊該來源所在的記錄檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-778">If the <xref:System.Diagnostics.EventLog.Source%2A> has been specified, <xref:System.Diagnostics.EventLog.Log%2A> returns the name of the log to which that source was registered.</span></span>  
  
 <span data-ttu-id="2b88f-779">來源一次只能註冊一個記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-779">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="2b88f-780">如果<xref:System.Diagnostics.EventLog.Source%2A>的執行個體已設定屬性<xref:System.Diagnostics.EventLog>，您無法變更<xref:System.Diagnostics.EventLog.Log%2A>屬性，該<xref:System.Diagnostics.EventLog>而不需要變更的值<xref:System.Diagnostics.EventLog.Source%2A>或呼叫<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>第一次。</span><span class="sxs-lookup"><span data-stu-id="2b88f-780">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.Log%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="2b88f-781">如果您變更<xref:System.Diagnostics.EventLog.Log%2A>屬性之後<xref:System.Diagnostics.EventLog.Source%2A>屬性已設定，寫入記錄項目就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="2b88f-781">If you change the <xref:System.Diagnostics.EventLog.Log%2A> property after the <xref:System.Diagnostics.EventLog.Source%2A> property has been set, writing a log entry throws an exception.</span></span>  
  
 <span data-ttu-id="2b88f-782">作業系統會將事件記錄檔儲存為檔案。</span><span class="sxs-lookup"><span data-stu-id="2b88f-782">The operating system stores event logs as files.</span></span> <span data-ttu-id="2b88f-783">當您使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要建立新的事件記錄檔，相關聯的檔案會儲存在指定的電腦上的 %SystemRoot%\System32\Config 目錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-783">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="2b88f-784">檔案名稱由附加的前 8 個字元設定<xref:System.Diagnostics.EventLog.Log%2A>".evt"副檔名的屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-784">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="2b88f-785">您無法建立新的記錄檔使用<xref:System.Diagnostics.EventLog.Log%2A>單獨 （不含指定記錄檔的來源） 的屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-785">You cannot create a new log using the <xref:System.Diagnostics.EventLog.Log%2A> property alone (without specifying a source for the log).</span></span> <span data-ttu-id="2b88f-786">您可以呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>，傳遞做為參數，新的記錄檔名稱，然後呼叫<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-786">You can call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, passing in a new log name as a parameter, and then call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="2b88f-787">不過，其目的通常是要建立 （和項目寫入） 新的應用程式特定記錄檔，或從現有的記錄檔讀取。</span><span class="sxs-lookup"><span data-stu-id="2b88f-787">However, the intent is usually either to create (and write entries to) new application-specific logs, or to read from existing logs.</span></span>  
  
 <span data-ttu-id="2b88f-788">如果<xref:System.Diagnostics.EventLog.Log%2A>值變更時，事件記錄檔就會關閉，並釋放所有的事件控制代碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-788">If the <xref:System.Diagnostics.EventLog.Log%2A> value changes, the event log is closed and all event handles are released.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="2b88f-789">如果您設定<xref:System.Diagnostics.EventLog.Log%2A>屬性不存在的記錄檔的名稱，系統會將附加<xref:System.Diagnostics.EventLog>應用程式記錄檔，但不會警告您它正在使用不是您所指定的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-789">If you set the <xref:System.Diagnostics.EventLog.Log%2A> property to the name of a log that does not exist, the system attaches the <xref:System.Diagnostics.EventLog> to the Application log, but does not warn you that it is using a log other than the one you specified.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-790">下列範例會讀取事件記錄檔中，「 NewEventLog 」，在本機電腦上的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-790">The following example reads entries in the event log, "NewEventLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Log Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Log Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Log Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Log Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-791">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-791">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-792">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-792">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
      </Docs>
    </Member>
    <Member MemberName="LogDisplayName">
      <MemberSignature Language="C#" Value="public string LogDisplayName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string LogDisplayName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.LogDisplayName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LogDisplayName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ LogDisplayName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.LogDisplayName : string" Usage="System.Diagnostics.EventLog.LogDisplayName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-793">取得事件記錄檔的易記名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-793">Gets the event log's friendly name.</span></span></summary>
        <value><span data-ttu-id="2b88f-794">名稱，表示系統的事件檢視器中的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-794">A name that represents the event log in the system's event viewer.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-795">在 Windows Vista 和更新版本，使用者沒有存取安全性記錄檔的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-795">In Windows Vista and later, users do not have permission to access the security log.</span></span> <span data-ttu-id="2b88f-796">如果您正在執行 Windows Vista 或更新版本，身為使用者，您會收到<xref:System.Security.SecurityException>當您嘗試存取安全性記錄檔中事件的顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-796">If you are running Windows Vista or later as a user, you will get a <xref:System.Security.SecurityException> when you attempt to access the display name for an event in the security log.</span></span>  
>   
>  <span data-ttu-id="2b88f-797">在 Windows Vista (含) 以後版本中，使用者帳戶控制 (UAC) 會判斷使用者的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-797">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="2b88f-798">如果您是內建 Administrators 群組的成員，系統會將兩個執行階段存取語彙基元 (Token) 指派給您：標準使用者存取語彙基元及管理員存取語彙基元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-798">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="2b88f-799">根據預設，您會屬於標準使用者角色。</span><span class="sxs-lookup"><span data-stu-id="2b88f-799">By default, you are in the standard user role.</span></span> <span data-ttu-id="2b88f-800">若要執行的程式碼存取安全性記錄檔，您必須先將您的權限從標準使用者提高為系統管理員。</span><span class="sxs-lookup"><span data-stu-id="2b88f-800">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="2b88f-801">您可以在啟動應用程式時，以滑鼠右鍵按一下應用程式圖示，並指出您想要以系統管理員身分執行，藉此提高為系統管理員權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-801">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-802">下列範例會列舉在本機電腦上所定義的事件記錄檔，並顯示<xref:System.Diagnostics.EventLog.LogDisplayName%2A>每個事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-802">The following example enumerates the event logs defined on the local computer and displays the <xref:System.Diagnostics.EventLog.LogDisplayName%2A> for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-803">指定的 <see cref="P:System.Diagnostics.EventLog.Log" /> 不存在這部電腦的登錄中。</span><span class="sxs-lookup"><span data-stu-id="2b88f-803">The specified <see cref="P:System.Diagnostics.EventLog.Log" /> does not exist in the registry for this computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-804">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-804">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-805">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-805">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="2b88f-806">提供讀取指定的登錄機碼的能力。</span><span class="sxs-lookup"><span data-stu-id="2b88f-806">for the ability to read the specified registry key.</span></span> <span data-ttu-id="2b88f-807">相關聯的列舉型別： <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-807">Associated enumeration: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span></span></permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="2b88f-808">能夠存取指定的登錄鍵，如果它是遠端的索引鍵。</span><span class="sxs-lookup"><span data-stu-id="2b88f-808">for the ability to access the specified registry key if it is a remote key.</span></span> <span data-ttu-id="2b88f-809">相關聯的列舉型別： <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-809">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      </Docs>
    </Member>
    <Member MemberName="LogNameFromSourceName">
      <MemberSignature Language="C#" Value="public static string LogNameFromSourceName (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string LogNameFromSourceName(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.LogNameFromSourceName(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function LogNameFromSourceName (source As String, machineName As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ LogNameFromSourceName(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member LogNameFromSourceName : string * string -&gt; string" Usage="System.Diagnostics.EventLog.LogNameFromSourceName (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-810">事件來源的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-810">The name of the event source.</span></span></param>
        <param name="machineName"><span data-ttu-id="2b88f-811">要在其上搜尋記錄檔的電腦的名稱，或者表示本機電腦的 "."。</span><span class="sxs-lookup"><span data-stu-id="2b88f-811">The name of the computer on which to look, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="2b88f-812">取得登錄指定來源的記錄檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-812">Gets the name of the log to which the specified source is registered.</span></span></summary>
        <returns><span data-ttu-id="2b88f-813">與登錄中指定的來源關聯的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-813">The name of the log associated with the specified source in the registry.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-814">事件來源會指出項目會記錄事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-814">The event source indicates what logs the event.</span></span> <span data-ttu-id="2b88f-815">它通常是應用程式的名稱或名稱的子元件的應用程式，如果應用程式很大。</span><span class="sxs-lookup"><span data-stu-id="2b88f-815">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="2b88f-816">應用程式和服務應該寫入應用程式記錄檔或自訂的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-816">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="2b88f-817">裝置驅動程式應該寫入至系統記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-817">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="2b88f-818">當您建立新的來源，可以只撰寫一個記錄檔一次，則系統會登錄事件記錄檔與您的應用程式做為有效的來源項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-818">When you create a new source, which can only write to one log at a time, the system registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="2b88f-819"><xref:System.Diagnostics.EventLog.Source%2A>屬性可以是任何字串，但名稱不能由其他電腦上的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-819">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any string, but the name cannot be used by other sources on the computer.</span></span> <span data-ttu-id="2b88f-820">嘗試建立重複<xref:System.Diagnostics.EventLog.Source%2A>值就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="2b88f-820">An attempt to create a duplicated <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="2b88f-821">不過，單一的事件記錄檔可以有許多不同的來源寫入它。</span><span class="sxs-lookup"><span data-stu-id="2b88f-821">However, a single event log can have many different sources writing to it.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-822">下列範例會從本機電腦刪除的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-822">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="2b88f-823">此範例會判斷其來源的記錄檔，，然後刪除記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-823">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-824">多個來源可能會寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-824">More than one source might write to an event log.</span></span> <span data-ttu-id="2b88f-825">之前刪除自訂記錄檔，請確定沒有其他寫入該記錄檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-825">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-826">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-826">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-827">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-827">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MachineName : string with get, set" Usage="System.Diagnostics.EventLog.MachineName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.DefaultValue(".")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the machine that this log get written to.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogMachineName")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-828">取得或設定要在其上讀取或寫入事件的電腦的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-828">Gets or sets the name of the computer on which to read or write events.</span></span></summary>
        <value><span data-ttu-id="2b88f-829">事件記錄檔所在處的伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-829">The name of the server on which the event log resides.</span></span> <span data-ttu-id="2b88f-830">預設值是本機電腦 (".")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-830">The default is the local computer (".").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-831">如果您寫入事件記錄檔時，就必須將<xref:System.Diagnostics.EventLog.Source%2A>與您的事件記錄檔物件，將它連接到特定的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-831">If you write to an event log, you must associate a <xref:System.Diagnostics.EventLog.Source%2A> with your event log object to connect it to a particular log.</span></span> <span data-ttu-id="2b88f-832">您不需要指定<xref:System.Diagnostics.EventLog.Source%2A>只讀取記錄時的屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-832">It is not necessary to specify the <xref:System.Diagnostics.EventLog.Source%2A> property when only reading from a log.</span></span> <span data-ttu-id="2b88f-833">您可以只指定<xref:System.Diagnostics.EventLog.Log%2A>名稱和<xref:System.Diagnostics.EventLog.MachineName%2A>（伺服器電腦名稱）。</span><span class="sxs-lookup"><span data-stu-id="2b88f-833">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-834">您不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果您要連接到記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-834">You need not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="2b88f-835">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-835">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-836">來源一次只能註冊一個記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-836">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="2b88f-837">如果<xref:System.Diagnostics.EventLog.Source%2A>的執行個體已設定屬性<xref:System.Diagnostics.EventLog>，您無法變更<xref:System.Diagnostics.EventLog.MachineName%2A>屬性，該<xref:System.Diagnostics.EventLog>而不需要變更的值<xref:System.Diagnostics.EventLog.Source%2A>或呼叫<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>第一次。</span><span class="sxs-lookup"><span data-stu-id="2b88f-837">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.MachineName%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="2b88f-838">如果您變更<xref:System.Diagnostics.EventLog.MachineName%2A>屬性，<xref:System.Diagnostics.EventLog>關閉所有控制代碼，並重新附加至記錄檔和新的電腦上的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-838">If you change the <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog> closes all handles and reattaches to the log and source on the new computer.</span></span>  
  
 <span data-ttu-id="2b88f-839"><xref:System.Diagnostics.EventLog.MachineName%2A>值不可為空字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-839">The <xref:System.Diagnostics.EventLog.MachineName%2A> value cannot be an empty string.</span></span> <span data-ttu-id="2b88f-840">如果它沒有明確設定，則預設為本機電腦 ("。")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-840">If it is not explicitly set, it defaults to the local computer (".").</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-841">下列範例會讀取事件記錄檔中，「 NewEventLog"，指定電腦上的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-841">The following example reads entries in the event log, "NewEventLog", on a specified computer.</span></span>  
  
 [!code-cpp[Classic EventLog.MachineName Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.MachineName Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.MachineName Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-842">電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-842">The computer name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-843">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-843">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-844">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-844">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.GetEventLogs" />
      </Docs>
    </Member>
    <Member MemberName="MaximumKilobytes">
      <MemberSignature Language="C#" Value="public long MaximumKilobytes { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumKilobytes" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumKilobytes As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumKilobytes { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumKilobytes : int64 with get, set" Usage="System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netcore-2.1;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-845">取得或設定最大事件記錄檔大小 (以 KB 為單位)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-845">Gets or sets the maximum event log size in kilobytes.</span></span></summary>
        <value><span data-ttu-id="2b88f-846">最大事件記錄檔大小 (以 KB 為單位)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-846">The maximum event log size in kilobytes.</span></span> <span data-ttu-id="2b88f-847">預設值為 512，表示最大記錄檔大小為 512 KB。</span><span class="sxs-lookup"><span data-stu-id="2b88f-847">The default is 512, indicating a maximum file size of 512 kilobytes.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-848"><xref:System.Diagnostics.EventLog.MaximumKilobytes%2A>屬性代表的事件記錄檔的大小限制。</span><span class="sxs-lookup"><span data-stu-id="2b88f-848">The <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property represents the size limit of the event log file.</span></span> <span data-ttu-id="2b88f-849">當事件記錄檔到達大小上限，已設定的<xref:System.Diagnostics.EventLog.OverflowAction%2A>值會決定是否會捨棄新的項目，或新的項目是否覆寫較舊的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-849">When the event log reaches the size limit, the configured <xref:System.Diagnostics.EventLog.OverflowAction%2A> value determines whether new entries are discarded, or whether new entries overwrite older entries.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-850">這個屬性表示此執行個體所代表的事件記錄檔的組態設定。</span><span class="sxs-lookup"><span data-stu-id="2b88f-850">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="2b88f-851">當事件記錄檔達到大小上限時，此屬性會指定作業系統如何處理新的項目寫入事件記錄檔註冊的所有事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-851">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-852">下列範例會列舉在本機電腦上定義的事件記錄檔，並顯示每個事件記錄檔的組態詳細資料。</span><span class="sxs-lookup"><span data-stu-id="2b88f-852">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="2b88f-853">指定的值小於 64 或大於 4194240，或者不是 64 的偶數倍數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-853">The specified value is less than 64, or greater than 4194240, or not an even multiple of 64.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-854">這個 <see cref="P:System.Diagnostics.EventLog.Log" /> 值不是有效的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-854">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span></span>  
  
<span data-ttu-id="2b88f-855">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-855">\- or -</span></span> 
<span data-ttu-id="2b88f-856">無法在目標電腦上開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-856">The registry key for the event log could not be opened on the target computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-857">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-857">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-858">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-858">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      </Docs>
    </Member>
    <Member MemberName="MinimumRetentionDays">
      <MemberSignature Language="C#" Value="public int MinimumRetentionDays { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinimumRetentionDays" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property MinimumRetentionDays As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int MinimumRetentionDays { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinimumRetentionDays : int" Usage="System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-859">取得事件記錄檔項目的保留天數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-859">Gets the number of days to retain entries in the event log.</span></span></summary>
        <value><span data-ttu-id="2b88f-860">保留事件記錄檔項目的天數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-860">The number of days that entries in the event log are retained.</span></span> <span data-ttu-id="2b88f-861">預設值為 7。</span><span class="sxs-lookup"><span data-stu-id="2b88f-861">The default value is 7.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-862">使用<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>檢查事件記錄檔的目前設定的屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-862">Use the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property to examine the current setting for an event log.</span></span> <span data-ttu-id="2b88f-863">使用<xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>變更最小的數字的事件記錄檔中的每個項目必須保留的天數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-863">Use <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> to change the minimum number of days that each entry in the event log must be retained.</span></span>  
  
 <span data-ttu-id="2b88f-864"><xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值取決於事件記錄檔設定的溢位行為。</span><span class="sxs-lookup"><span data-stu-id="2b88f-864">The <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value depends on the configured overflow behavior of the event log.</span></span> <span data-ttu-id="2b88f-865">如果<xref:System.Diagnostics.OverflowAction>事件記錄檔的屬性設定為<xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>，然後在<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值為 0。</span><span class="sxs-lookup"><span data-stu-id="2b88f-865">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is 0.</span></span> <span data-ttu-id="2b88f-866">如果<xref:System.Diagnostics.OverflowAction>事件記錄檔的屬性設定為<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>，然後在<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值為-1。</span><span class="sxs-lookup"><span data-stu-id="2b88f-866">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is -1.</span></span> <span data-ttu-id="2b88f-867">如果<xref:System.Diagnostics.OverflowAction>事件記錄檔的屬性設定為<xref:System.Diagnostics.OverflowAction.OverwriteOlder>，然後在<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值是小於或等於零，且代表事件記錄檔已滿時，事件記錄檔項目的保留的天數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-867">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is greater than zero, and represents the number of days to retain event log entries when the event log is full.</span></span>  
  
 <span data-ttu-id="2b88f-868">當事件記錄檔達到大小限制時，才會發生溢位行為。</span><span class="sxs-lookup"><span data-stu-id="2b88f-868">The overflow behavior only occurs when an event log reaches its size limit.</span></span> <span data-ttu-id="2b88f-869">當<xref:System.Diagnostics.EventLog>有其<xref:System.Diagnostics.EventLog.OverflowAction%2A>設為<xref:System.Diagnostics.OverflowAction.OverwriteOlder>，和事件記錄檔達到大小上限，則會將新的項目寫入只可以取代項目，其存留期超過<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>期間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-869">When an <xref:System.Diagnostics.EventLog> has its <xref:System.Diagnostics.EventLog.OverflowAction%2A> set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, and the event log reaches its maximum size, then new entries are written only if they can replace entries whose age exceeds the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> period.</span></span> <span data-ttu-id="2b88f-870">保留的最小週期的事件項目時，適當的事件記錄檔會定期封存。</span><span class="sxs-lookup"><span data-stu-id="2b88f-870">Retaining event entries for a minimum period is appropriate when the event log is archived regularly.</span></span> <span data-ttu-id="2b88f-871">否則，可能會遺失事件記錄檔已達到限制時的新項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-871">Otherwise, you risk losing new entries when the event log reaches its limit.</span></span> <span data-ttu-id="2b88f-872">若要避免遺失新的事件資訊，設定最小的保留天數，根據您特定的事件記錄檔的封存排程的事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-872">To avoid losing new event information, set the minimum retention days for events based on your archive schedule for a particular event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-873">下列範例會列舉在本機電腦上定義的事件記錄檔，並顯示每個事件記錄檔的組態詳細資料。</span><span class="sxs-lookup"><span data-stu-id="2b88f-873">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-874">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-874">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-875">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-875">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
      </Docs>
    </Member>
    <Member MemberName="ModifyOverflowPolicy">
      <MemberSignature Language="C#" Value="public void ModifyOverflowPolicy (System.Diagnostics.OverflowAction action, int retentionDays);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ModifyOverflowPolicy(valuetype System.Diagnostics.OverflowAction action, int32 retentionDays) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub ModifyOverflowPolicy (action As OverflowAction, retentionDays As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ModifyOverflowPolicy(System::Diagnostics::OverflowAction action, int retentionDays);" />
      <MemberSignature Language="F#" Value="member this.ModifyOverflowPolicy : System.Diagnostics.OverflowAction * int -&gt; unit" Usage="eventLog.ModifyOverflowPolicy (action, retentionDays)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Diagnostics.OverflowAction" />
        <Parameter Name="retentionDays" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="2b88f-876">將新的項目寫入事件記錄檔的溢位行為。</span><span class="sxs-lookup"><span data-stu-id="2b88f-876">The overflow behavior for writing new entries to the event log.</span></span></param>
        <param name="retentionDays"><span data-ttu-id="2b88f-877">每一個事件記錄檔項目會保留的最小天數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-877">The minimum number of days each event log entry is retained.</span></span> <span data-ttu-id="2b88f-878">只有當 <paramref name="action" /> 設定為 <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" /> 時，才會使用這個參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-878">This parameter is used only if <paramref name="action" /> is set to <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span></span></param>
        <summary><span data-ttu-id="2b88f-879">當事件記錄檔到達最大檔案大小時，變更寫入新項目的已設定行為。</span><span class="sxs-lookup"><span data-stu-id="2b88f-879">Changes the configured behavior for writing new entries when the event log reaches its maximum file size.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-880">事件記錄檔的溢位行為會指定要寫入的記錄檔已達到其最大檔案大小，新的項目時，會發生什麼事。</span><span class="sxs-lookup"><span data-stu-id="2b88f-880">The overflow behavior for an event log specifies what happens when new entries are to be written to a log that has reached its maximum file size.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-881">溢位行為在事件記錄檔達到檔案大小上限時，才會生效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-881">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="2b88f-882">溢位行為不會影響新的項目寫入記錄檔可容納額外的事件記錄項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-882">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
 <span data-ttu-id="2b88f-883"><xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>方法則會設定事件記錄檔的溢位行為。</span><span class="sxs-lookup"><span data-stu-id="2b88f-883">The <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method configures the overflow behavior of an event log.</span></span> <span data-ttu-id="2b88f-884"><xref:System.Diagnostics.EventLog> 執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-884"><xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="2b88f-885">呼叫這個方法所指定的事件記錄檔之後<xref:System.Diagnostics.EventLog.Log%2A>屬性，<xref:System.Diagnostics.EventLog.OverflowAction%2A>和<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>屬性的值反映的新設定的溢位行為。</span><span class="sxs-lookup"><span data-stu-id="2b88f-885">After calling this method for the event log specified by the <xref:System.Diagnostics.EventLog.Log%2A> property, the <xref:System.Diagnostics.EventLog.OverflowAction%2A> and <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property values reflect the newly configured overflow behavior.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-886">這個屬性表示此執行個體所代表的事件記錄檔的組態設定。</span><span class="sxs-lookup"><span data-stu-id="2b88f-886">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="2b88f-887">當事件記錄檔達到大小上限時，此屬性會指定作業系統如何處理新的項目寫入事件記錄檔註冊的所有事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-887">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
 <span data-ttu-id="2b88f-888">設定`action`參數來<xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>表示，新的項目會覆寫舊的項目時<xref:System.Diagnostics.EventLog>達到最大值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-888">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded> to indicate that a new entry overwrites the oldest entry when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="2b88f-889">如果`action`參數設定為<xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>，則`retentionDays`參數值會被忽略。</span><span class="sxs-lookup"><span data-stu-id="2b88f-889">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, the `retentionDays` parameter value is ignored.</span></span>  
  
 <span data-ttu-id="2b88f-890">設定`action`參數來<xref:System.Diagnostics.OverflowAction.OverwriteOlder>表示，每個新的項目會覆寫較舊的項目時<xref:System.Diagnostics.EventLog>達到最大值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-890">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteOlder> to indicate that each new entry overwrites older entries when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="2b88f-891">指定在記錄檔中使用的事件必須保留的天數`retentionDays`參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-891">Specify the number of days that events must be retained in the log using the `retentionDays` parameter.</span></span> <span data-ttu-id="2b88f-892">寫入的保留範圍內的事件不會覆寫新的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-892">Events written within the retention range are not overwritten by new entries.</span></span>  
  
 <span data-ttu-id="2b88f-893">設定`action`參數來<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>捨棄新的事件，當達到最大記錄大小。</span><span class="sxs-lookup"><span data-stu-id="2b88f-893">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> to discard new events when the maximum log size is reached.</span></span> <span data-ttu-id="2b88f-894">如果`action`參數設定為<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>，則`retentionDays`參數值會被忽略。</span><span class="sxs-lookup"><span data-stu-id="2b88f-894">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, the `retentionDays` parameter value is ignored.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="2b88f-895">將溢位的原則設定為<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>指定事件記錄檔已滿時，就會捨棄新的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-895">Setting the overflow policy to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> specifies that new entries are discarded when the event log is full.</span></span> <span data-ttu-id="2b88f-896">如果您使用此設定，請確定事件記錄檔定期封存和清除，以避免達到其大小上限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-896">If you use this setting, ensure the event log is regularly archived and cleared to avoid reaching its maximum size limit.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-897">下列範例顯示針對指定的事件記錄檔中，已設定的溢位原則，並允許使用者選取新的溢位原則設定事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-897">The following example displays the configured overflow policy for a specified event log, and allows the user to select a new overflow policy setting for the event log.</span></span>  
  
 [!code-cpp[EventLogProperties#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#3)]
 [!code-csharp[EventLogProperties#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#3)]
 [!code-vb[EventLogProperties#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="2b88f-898"><paramref name="action" /> 不是有效的 <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> 值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-898"><paramref name="action" /> is not a valid <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> value.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="2b88f-899"><paramref name="retentionDays" /> 小於 1 或大於 365。</span><span class="sxs-lookup"><span data-stu-id="2b88f-899"><paramref name="retentionDays" /> is less than one, or larger than 365.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-900">這個 <see cref="P:System.Diagnostics.EventLog.Log" /> 值不是有效的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-900">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span></span>  
  
<span data-ttu-id="2b88f-901">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-901">\- or -</span></span> 
<span data-ttu-id="2b88f-902">無法在目標電腦上開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-902">The registry key for the event log could not be opened on the target computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-903">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-903">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-904">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-904">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="OverflowAction">
      <MemberSignature Language="C#" Value="public System.Diagnostics.OverflowAction OverflowAction { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Diagnostics.OverflowAction OverflowAction" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.OverflowAction" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property OverflowAction As OverflowAction" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::OverflowAction OverflowAction { System::Diagnostics::OverflowAction get(); };" />
      <MemberSignature Language="F#" Value="member this.OverflowAction : System.Diagnostics.OverflowAction" Usage="System.Diagnostics.EventLog.OverflowAction" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.OverflowAction</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-905">當事件記錄檔到達最大記錄檔大小時，取得儲存新項目的已設定行為。</span><span class="sxs-lookup"><span data-stu-id="2b88f-905">Gets the configured behavior for storing new entries when the event log reaches its maximum log file size.</span></span></summary>
        <value><span data-ttu-id="2b88f-906"><see cref="T:System.Diagnostics.OverflowAction" /> 值，指定當事件記錄檔到達最大記錄檔大小時，儲存新項目的已設定行為。</span><span class="sxs-lookup"><span data-stu-id="2b88f-906">The <see cref="T:System.Diagnostics.OverflowAction" /> value that specifies the configured behavior for storing new entries when the event log reaches its maximum log size.</span></span> <span data-ttu-id="2b88f-907">預設值為 <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-907">The default is <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-908">在新的事件會寫入事件記錄檔大小變大。</span><span class="sxs-lookup"><span data-stu-id="2b88f-908">Event logs grow in size as new events are written to them.</span></span> <span data-ttu-id="2b88f-909">每個事件記錄檔已設定的最大大小的限制;<xref:System.Diagnostics.EventLog.MaximumKilobytes%2A>屬性會定義事件記錄檔大小所允許的 kb 數目上限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-909">Each event log has a configured maximum size limit; the <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property defines the maximum number of kilobytes allowed for the event log file size.</span></span>  
  
 <span data-ttu-id="2b88f-910">使用<xref:System.Diagnostics.EventLog.OverflowAction%2A>檢查事件記錄檔的最大大小的已設定的溢位行為的屬性值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-910">Use the <xref:System.Diagnostics.EventLog.OverflowAction%2A> property value to examine the configured overflow behavior for an event log at its maximum size.</span></span> <span data-ttu-id="2b88f-911">使用<xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>方法，以變更事件記錄檔的溢位行為。</span><span class="sxs-lookup"><span data-stu-id="2b88f-911">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to change the overflow behavior for an event log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-912">溢位行為在事件記錄檔達到檔案大小上限時，才會生效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-912">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="2b88f-913">溢位行為不會影響新的項目寫入記錄檔可容納額外的事件記錄項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-913">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-914">下列範例會列舉在本機電腦上定義的事件記錄檔，並顯示每個事件記錄檔的組態詳細資料。</span><span class="sxs-lookup"><span data-stu-id="2b88f-914">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-915">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-915">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-916">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-916">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="RegisterDisplayName">
      <MemberSignature Language="C#" Value="public void RegisterDisplayName (string resourceFile, long resourceId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void RegisterDisplayName(string resourceFile, int64 resourceId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Sub RegisterDisplayName (resourceFile As String, resourceId As Long)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void RegisterDisplayName(System::String ^ resourceFile, long resourceId);" />
      <MemberSignature Language="F#" Value="member this.RegisterDisplayName : string * int64 -&gt; unit" Usage="eventLog.RegisterDisplayName (resourceFile, resourceId)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="resourceFile" Type="System.String" />
        <Parameter Name="resourceId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="resourceFile"><span data-ttu-id="2b88f-917">當地語系化資源檔的完整指定路徑。</span><span class="sxs-lookup"><span data-stu-id="2b88f-917">The fully specified path to a localized resource file.</span></span></param>
        <param name="resourceId"><span data-ttu-id="2b88f-918">資源識別項，可為資源檔內的當地語系化字串編排索引。</span><span class="sxs-lookup"><span data-stu-id="2b88f-918">The resource identifier that indexes a localized string within the resource file.</span></span></param>
        <summary><span data-ttu-id="2b88f-919">指定事件記錄檔的當地語系化名稱，這會顯示在伺服器的 [事件檢視器] 中。</span><span class="sxs-lookup"><span data-stu-id="2b88f-919">Specifies the localized name of the event log, which is displayed in the server Event Viewer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-920">使用<xref:System.Diagnostics.EventLog.RegisterDisplayName%2A>註冊，並顯示自訂事件記錄檔的事件檢視器的當地語系化的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-920">Use <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> to register and display a localized name in the Event Viewer for custom event logs.</span></span>  
  
 <span data-ttu-id="2b88f-921">指定的資源識別碼必須對應到資源檔中定義的當地語系化字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-921">The specified resource identifier must correspond to a localized string defined in the resource file.</span></span> <span data-ttu-id="2b88f-922">事件檢視器會顯示使用當地語系化的字串和目前的文化特性設定的自訂事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-922">The Event Viewer displays the custom event log name using the localized string and the current culture settings.</span></span> <span data-ttu-id="2b88f-923">例如，您可以定義多個資源檔中的不同文化特性的當地語系化的事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-923">For example, you can define multiple event log names localized for different cultures in your resource file.</span></span> <span data-ttu-id="2b88f-924">事件檢視器會顯示對應到目前使用者的文化特性設定當地語系化的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-924">The Event Viewer displays the localized string corresponding to the culture settings of the current user.</span></span>  
  
 <span data-ttu-id="2b88f-925">如果事件檢視器無法載入當地語系化的字串，從資源檔，或如果沒有顯示名稱已登錄事件記錄檔，事件檢視器顯示中定義的事件記錄檔名稱<xref:System.Diagnostics.EventLog.Log%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-925">If the Event Viewer cannot load the localized string from the resource file, or if no display name was registered for the event log, then the Event Viewer displays the event log name defined in <xref:System.Diagnostics.EventLog.Log%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-926">您不需要註冊預先定義的事件記錄檔的顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-926">You do not need to register a display name for the pre-defined event logs.</span></span> <span data-ttu-id="2b88f-927">作業系統會註冊應用程式、 系統及安全性事件記錄檔的當地語系化的顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-927">The operating system registers the localized display names for the Application, System, and Security event logs.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-928">下列範例會判斷是否事件來源名為`SampleApplicationSource`登錄在本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-928">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="2b88f-929">如果事件來源不存在，此範例會設定為來源的訊息資源檔，並建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-929">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="2b88f-930">最後，範例會設定事件記錄檔，使用中的資源識別碼值的當地語系化的顯示名稱`DisplayNameMsgId`中的資源檔路徑和`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-930">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="2b88f-931">此範例會使用下列的訊息文字檔案，內建資源庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="2b88f-931">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="2b88f-932">訊息文字檔案是從其中建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-932">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="2b88f-933">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-933">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="2b88f-934">具體而言，資源識別元 5001 定義事件記錄檔的當地語系化名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-934">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-935">這個 <see cref="P:System.Diagnostics.EventLog.Log" /> 值不是有效的記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-935">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span></span>  
  
<span data-ttu-id="2b88f-936">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-936">\- or -</span></span> 
<span data-ttu-id="2b88f-937">無法在目標電腦上開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-937">The registry key for the event log could not be opened on the target computer.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="2b88f-938"><paramref name="resourceFile" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-938"><paramref name="resourceFile" /> is <see langword="null" />.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-939">用於管理的電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-939">for administering event log information on the computer.</span></span> <span data-ttu-id="2b88f-940">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-940">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.LogDisplayName" />
      </Docs>
    </Member>
    <Member MemberName="Source">
      <MemberSignature Language="C#" Value="public string Source { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Source" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Source" />
      <MemberSignature Language="VB.NET" Value="Public Property Source As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Source { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Source : string with get, set" Usage="System.Diagnostics.EventLog.Source" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("The application name that writes the log.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogSource")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-941">取得或設定寫入至事件記錄檔時登錄和使用的來源名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-941">Gets or sets the source name to register and use when writing to the event log.</span></span></summary>
        <value><span data-ttu-id="2b88f-942">這個名稱 (具有事件記錄檔)，被登錄為項目的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-942">The name registered with the event log as a source of entries.</span></span> <span data-ttu-id="2b88f-943">預設為空字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-943">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-944">事件來源會指出項目會記錄事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-944">The event source indicates what logs the event.</span></span> <span data-ttu-id="2b88f-945">它通常是應用程式的名稱或名稱的子元件的應用程式，如果應用程式很大。</span><span class="sxs-lookup"><span data-stu-id="2b88f-945">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="2b88f-946">應用程式和服務應該寫入應用程式記錄檔或自訂的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-946">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="2b88f-947">裝置驅動程式應該寫入至系統記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-947">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="2b88f-948">您只需要指定事件來源，如果您要寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-948">You only need to specify an event source if you are writing to an event log.</span></span> <span data-ttu-id="2b88f-949">前一個項目寫入事件記錄檔中，您必須向事件來源事件記錄檔為有效的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-949">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="2b88f-950">當您撰寫的記錄項目時，系統會使用<xref:System.Diagnostics.EventLog.Source%2A>屬性，以尋找適當的記錄檔，在其中放置您的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-950">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> property to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="2b88f-951">如果您正在讀取事件記錄檔，您可以指定<xref:System.Diagnostics.EventLog.Source%2A>，或有<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-951">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-952">您不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果您要連接到本機電腦上的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-952">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="2b88f-953">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-953">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-954">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>將事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-954">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="2b88f-955">您必須指定要寫入事件，事件來源您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-955">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="2b88f-956">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-956">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-957">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-957">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-958">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-958">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-959">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-959">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-960">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-960">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-961">您可以建立現有的事件記錄檔或新的事件記錄檔的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-961">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="2b88f-962">當您建立新的事件記錄檔的新來源時，系統會註冊為該記錄檔中，來源，但直到第一個項目寫入至其中，才會建立記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-962">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="2b88f-963">來源必須是唯一的本機電腦上，新的來源名稱不符合現有的來源名稱或現有的事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-963">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="2b88f-964">每個來源一次; 可以寫入只有一個事件記錄檔不過，您的應用程式也可以使用多個來源，以寫入多個事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-964">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="2b88f-965">例如，您的應用程式可能需要多個來源設定為不同的事件記錄檔或不同的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-965">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="2b88f-966">如果您變更<xref:System.Diagnostics.EventLog.Source%2A>值，<xref:System.Diagnostics.EventLog>來登錄它已關閉，且會釋放所有的事件控制代碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-966">If you change the <xref:System.Diagnostics.EventLog.Source%2A> value, the <xref:System.Diagnostics.EventLog> to which it is registered is closed and all event handles are released.</span></span>  
  
 <span data-ttu-id="2b88f-967">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-967">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-968">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-968">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-969">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-969">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-970">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-970">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="2b88f-971">若要變更現有的來源的設定詳細資料，您必須刪除來源，並再建立新的組態。</span><span class="sxs-lookup"><span data-stu-id="2b88f-971">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="2b88f-972">如果其他應用程式或元件使用現有的來源，請使用更新的組態，而不是刪除現有來源建立新的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-972">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-973">如果來源已對應至記錄重新對應至新的記錄檔，您必須重新啟動電腦，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-973">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-974">下列範例會建立來源`MySource`如果不存在，它的項目寫入事件記錄檔`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-974">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-975">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-975">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-976">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-976">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-977">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-977">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SourceExists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="2b88f-978">搜尋指定事件來源的電腦的登錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-978">Searches a computer's registry for a given event source.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source);" />
      <MemberSignature Language="F#" Value="static member SourceExists : string -&gt; bool" Usage="System.Diagnostics.EventLog.SourceExists source" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-979">事件來源的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-979">The name of the event source.</span></span></param>
        <summary><span data-ttu-id="2b88f-980">判斷事件來源是否登錄於本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-980">Determines whether an event source is registered on the local computer.</span></span></summary>
        <returns><span data-ttu-id="2b88f-981">如果事件來源登錄於本機電腦上，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-981"><see langword="true" /> if the event source is registered on the local computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-982">使用這個方法，以判斷事件來源是否存在於本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-982">Use this method to determine whether an event source exists on the local computer.</span></span> <span data-ttu-id="2b88f-983">如果您想要判斷記錄檔是否存在於本機電腦，也就是使用<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-983">If you want to determine whether a log exists on the local computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-984">由於這個方法會存取登錄，您還必須擁有適當的登錄權限，本機電腦上，否則，<xref:System.Security.SecurityException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="2b88f-984">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-985">若要搜尋的事件來源，在 Windows Vista 和更新版本或 Windows Server 2003，您必須具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-985">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="2b88f-986">這項需求的原因是所有的事件記錄檔，包括安全性、 必須要搜尋以判斷事件來源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="2b88f-986">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="2b88f-987">從 Windows Vista 開始，使用者沒有權限以存取安全性記錄檔中;因此，<xref:System.Security.SecurityException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="2b88f-987">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="2b88f-988">從 Windows Vista 開始，使用者帳戶控制 (UAC) 會決定使用者的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-988">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="2b88f-989">如果您是內建 Administrators 群組的成員，系統會將兩個執行階段存取語彙基元 (Token) 指派給您：標準使用者存取語彙基元及管理員存取語彙基元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-989">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="2b88f-990">根據預設，您會屬於標準使用者角色。</span><span class="sxs-lookup"><span data-stu-id="2b88f-990">By default, you are in the standard user role.</span></span> <span data-ttu-id="2b88f-991">若要執行存取效能計數器的程式碼，您必須先將您的權限從標準使用者提高為系統管理員。</span><span class="sxs-lookup"><span data-stu-id="2b88f-991">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="2b88f-992">您可以在啟動應用程式時，以滑鼠右鍵按一下應用程式圖示，並指出您想要以系統管理員身分執行，藉此提高為系統管理員權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-992">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-993">執行下一個服務<xref:System.ServiceProcess.ServiceAccount.LocalSystem>帳戶沒有執行這個方法所需的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-993">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="2b88f-994">解決方法是檢查 事件來源是否存在於<xref:System.ServiceProcess.ServiceInstaller>，而且如果它不存在，安裝程式中建立的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-994">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="2b88f-995">因為您無法提供新的來源的同一部電腦上現有的來源名稱，然後再嘗試使用這個方法來呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>以確保來源所指定的名稱與`source`不存在本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-995">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the local computer.</span></span> <span data-ttu-id="2b88f-996">`source`參數不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="2b88f-996">The `source` parameter is not case-sensitive.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-997">下列範例會建立來源`MySource`如果不存在，它的項目寫入事件記錄檔`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-997">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="2b88f-998">找不到 <paramref name="source" />，但無法搜尋部分或全部的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-998"><paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-999">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-999">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1000">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1000">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
      </Docs>
    </Member>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member SourceExists : string * string -&gt; bool" Usage="System.Diagnostics.EventLog.SourceExists (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-1001">事件來源的名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1001">The name of the event source.</span></span></param>
        <param name="machineName"><span data-ttu-id="2b88f-1002">要在其上進行尋找的電腦的名稱，或者表示本機電腦的 "."。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1002">The name the computer on which to look, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="2b88f-1003">判斷事件來源是否登錄於指定的電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1003">Determines whether an event source is registered on a specified computer.</span></span></summary>
        <returns><span data-ttu-id="2b88f-1004">如果事件來源註冊於指定的電腦上，則為 <see langword="true" />；否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1004"><see langword="true" /> if the event source is registered on the given computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1005">使用這個方法來判斷所指定的電腦上是否存在的事件來源`machineName`參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1005">Use this method to determine whether an event source exists on the computer specified by the `machineName` parameter.</span></span> <span data-ttu-id="2b88f-1006">如果您想要判斷記錄檔是否存在於指定的電腦，使用<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1006">If you want to determine whether a log exists on the specified computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-1007">由於這個方法會存取登錄，您必須擁有適當的登錄權限指定伺服器上否則，<xref:System.Security.SecurityException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1007">Because this method accesses the registry, you must have the appropriate registry permissions on the given server; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1008">若要搜尋的事件來源，在 Windows Vista 和更新版本或 Windows Server 2003，您必須具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1008">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="2b88f-1009">這項需求的原因是所有的事件記錄檔，包括安全性、 必須要搜尋以判斷事件來源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1009">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="2b88f-1010">從 Windows Vista 開始，使用者沒有權限以存取安全性記錄檔中;因此，<xref:System.Security.SecurityException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1010">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="2b88f-1011">從 Windows Vista 開始，使用者帳戶控制 (UAC) 會決定使用者的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1011">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="2b88f-1012">如果您是內建 Administrators 群組的成員，系統會將兩個執行階段存取語彙基元 (Token) 指派給您：標準使用者存取語彙基元及管理員存取語彙基元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1012">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="2b88f-1013">根據預設，您會屬於標準使用者角色。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1013">By default, you are in the standard user role.</span></span> <span data-ttu-id="2b88f-1014">若要執行存取效能計數器的程式碼，您必須先將您的權限從標準使用者提高為系統管理員。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1014">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="2b88f-1015">您可以在啟動應用程式時，以滑鼠右鍵按一下應用程式圖示，並指出您想要以系統管理員身分執行，藉此提高為系統管理員權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1015">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1016">執行下一個服務<xref:System.ServiceProcess.ServiceAccount.LocalSystem>帳戶沒有執行這個方法所需的權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1016">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="2b88f-1017">解決方法是檢查 事件來源是否存在於<xref:System.ServiceProcess.ServiceInstaller>，而且如果它不存在，安裝程式中建立的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1017">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="2b88f-1018">因為您無法提供新的來源的同一部電腦上現有的來源名稱，然後再嘗試使用這個方法來呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>以確保來源所指定的名稱與`source`不存在的電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1018">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the computer.</span></span> <span data-ttu-id="2b88f-1019">`source`和`machineName`參數不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1019">The `source` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="2b88f-1020"><xref:System.Diagnostics.EventLog.SourceExists%2A> 是`static`方法，所以它可以呼叫類別本身。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1020"><xref:System.Diagnostics.EventLog.SourceExists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="2b88f-1021">您不需要建立的執行個體<xref:System.Diagnostics.EventLog>呼叫<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1021">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-1022">下列範例會建立來源`MySource`電腦上`MyServer`，並將項目寫入事件記錄檔`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1022">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1023"><paramref name="machineName" /> 為無效的電腦名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1023"><paramref name="machineName" /> is an invalid computer name.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="2b88f-1024">找不到 <paramref name="source" />，但無法搜尋部分或全部的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1024"><paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1025">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1025">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1026">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1026">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SynchronizingObject : System.ComponentModel.ISynchronizeInvoke with get, set" Usage="System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netcore-2.1;netframework-4.8;dotnet-plat-ext-2.1;netcore-2.2;dotnet-plat-ext-2.2">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("An object that synchronizes event handler calls.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogSynchronizingObject")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="2b88f-1027">取得或設定物件，其用於封送處理 (Marshal) 因為 <see cref="T:System.Diagnostics.EventLog" /> 項目寫入事件而發出的事件處理常式呼叫。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1027">Gets or sets the object used to marshal the event handler calls issued as a result of an <see cref="T:System.Diagnostics.EventLog" /> entry written event.</span></span></summary>
        <value><span data-ttu-id="2b88f-1028"><see cref="T:System.ComponentModel.ISynchronizeInvoke" />，用來封送處理因為事件記錄檔上的 <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> 事件而發出的事件處理常式呼叫。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1028">The <see cref="T:System.ComponentModel.ISynchronizeInvoke" /> used to marshal event-handler calls issued as a result of an <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event on the event log.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1029">當<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>已`null`，方法處理<xref:System.Diagnostics.EventLog.EntryWritten>系統執行緒集區的執行緒上呼叫事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1029">When <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is `null`, methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event are called on a thread from the system thread pool.</span></span> <span data-ttu-id="2b88f-1030">如需有關系統執行緒集區的詳細資訊，請參閱<xref:System.Threading.ThreadPool>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1030">For more information on system thread pools, see <xref:System.Threading.ThreadPool>.</span></span>  
  
 <span data-ttu-id="2b88f-1031">當<xref:System.Diagnostics.EventLog.EntryWritten>事件由 visual 的 Windows Form 元件，例如按鈕，存取透過系統執行緒集區的元件可能無法運作，或可能會導致例外狀況處理。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1031">When the <xref:System.Diagnostics.EventLog.EntryWritten> event is handled by a visual Windows Forms component, such as a button, accessing the component through the system thread pool might not work, or might result in an exception.</span></span> <span data-ttu-id="2b88f-1032">藉由設定避免這<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>至 Windows Form 元件，因而導致處理方法<xref:System.Diagnostics.EventLog.EntryWritten>元件建立所在的相同執行緒上呼叫的事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1032">Avoid this by setting <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> to a Windows Forms component, which causes the methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event to be called on the same thread on which the component was created.</span></span>  
  
 <span data-ttu-id="2b88f-1033">如果<xref:System.Diagnostics.EventLog>使用於內部[!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)]在 Windows Form 設計工具中，<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>會自動設為控制包含<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1033">If the <xref:System.Diagnostics.EventLog> is used inside [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] in a Windows Forms designer, <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is automatically set to the control containing the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="2b88f-1034">比方說，如果您放置<xref:System.Diagnostics.EventLog>Form1 設計工具上 (繼承自<xref:System.Windows.Forms.Form>)<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>屬性<xref:System.Diagnostics.EventLog>設為 Form1 的執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1034">For example, if you place an <xref:System.Diagnostics.EventLog> on a designer for Form1 (which inherits from <xref:System.Windows.Forms.Form>) the <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> property of <xref:System.Diagnostics.EventLog> is set to the instance of Form1.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1035">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1035">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1036">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1036">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
        <altmember cref="T:System.Threading.ThreadPool" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEntry">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="2b88f-1037">將項目寫入事件記錄檔中。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1037">Writes an entry in the event log.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string -&gt; unit" Usage="eventLog.WriteEntry message" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="2b88f-1038">要寫入事件記錄檔的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1038">The string to write to the event log.</span></span></param>
        <summary><span data-ttu-id="2b88f-1039">將具有指定訊息文字的資訊類型項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1039">Writes an information type entry, with the given message text, to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1040">使用這個方法將資訊項目寫入事件記錄檔與此相關聯<xref:System.Diagnostics.EventLog>執行個體。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1040">Use this method to write an information entry to the event log associated with this <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="2b88f-1041">如果您想要指定任何其他<xref:System.Diagnostics.EventLogEntryType>，請使用不同的多載的<xref:System.Diagnostics.EventLog.WriteEntry%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1041">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1042">`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1042">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1043">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1043">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="2b88f-1044">您必須設定<xref:System.Diagnostics.EventLog.Source%2A>屬性上的您<xref:System.Diagnostics.EventLog>元件之前，您可以寫入記錄檔中的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1044">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="2b88f-1045">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1045">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="2b88f-1046">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1046">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1047">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1047">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1048">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1048">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1049">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1049">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1050">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1050">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1051">如果在指定的來源<xref:System.Diagnostics.EventLog.Source%2A>屬性的<xref:System.Diagnostics.EventLog>執行個體已不會寫入您的元件，在電腦上註冊<xref:System.Diagnostics.EventLog.WriteEntry%2A>呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>並註冊來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1051">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1052">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>為您<xref:System.Diagnostics.EventLog>執行個體，然後再呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1052">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-1053">如果系統必須註冊<xref:System.Diagnostics.EventLog.Source%2A>透過呼叫<xref:System.Diagnostics.EventLog.WriteEntry%2A>並<xref:System.Diagnostics.EventLog.Log%2A>未在設定屬性您<xref:System.Diagnostics.EventLog>執行個體，預設為應用程式記錄檔的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1053">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1054">許多上面所列的例外狀況所產生的註冊程序期間引發的錯誤<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1054">Many of the exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-1055">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1055">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1056"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1056">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="2b88f-1057">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>寫入使用當地語系化的訊息資源檔之事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1057">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="2b88f-1058">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1058">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1059">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1059">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1060">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1060">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1061">如果您將項目寫入遠端電腦時，訊息 （文字字串） 的值可能無法預期如果遠端電腦未執行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1061">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1062">如果`message`參數包含 NUL 字元，而事件記錄檔中的訊息會在 NUL 字元終止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1062">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-1063">下列範例會建立來源`MySource`如果不存在，它的項目寫入事件記錄檔`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1063">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1064">還沒有設定 <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1064">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="2b88f-1065">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1065">-or-</span></span> 
<span data-ttu-id="2b88f-1066">該方法已嘗試登錄新的事件來源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1066">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="2b88f-1067">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1067">\- or -</span></span> 
<span data-ttu-id="2b88f-1068">來源已經登錄用於不同的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1068">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="2b88f-1069">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1069">\- or -</span></span> 
<span data-ttu-id="2b88f-1070">訊息字串的長度超過 31,839 個位元組 (在 Windows Vista 之前的 Windows 作業系統中為 32,766 位元組)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1070">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="2b88f-1071">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1071">\- or -</span></span> 
<span data-ttu-id="2b88f-1072">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1072">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1073">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1073">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1074">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1074">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1075">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1075">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1076">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1076">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1077">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1077">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType -&gt; unit" Usage="eventLog.WriteEntry (message, type)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="2b88f-1078">要寫入事件記錄檔的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1078">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="2b88f-1079">其中一個 <see cref="T:System.Diagnostics.EventLogEntryType" /> 值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1079">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <summary><span data-ttu-id="2b88f-1080">將具有指定訊息文字的錯誤、警告、資訊、成功稽核或失敗稽核項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1080">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1081">使用這個方法來寫入指定的項目<xref:System.Diagnostics.EventLogEntryType>事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1081">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log.</span></span> <span data-ttu-id="2b88f-1082">`type`由圖示，然後在 事件檢視器記錄檔中的 類型 欄中的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1082">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1083">`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1083">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1084">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1084">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="2b88f-1085">您必須設定<xref:System.Diagnostics.EventLog.Source%2A>屬性上的您<xref:System.Diagnostics.EventLog>元件之前，您可以寫入記錄檔中的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1085">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="2b88f-1086">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1086">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="2b88f-1087">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1087">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1088">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1088">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1089">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1089">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1090">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1090">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1091">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1091">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1092">如果在指定的來源<xref:System.Diagnostics.EventLog.Source%2A>屬性的<xref:System.Diagnostics.EventLog>執行個體已不會寫入您的元件，在電腦上註冊<xref:System.Diagnostics.EventLog.WriteEntry%2A>呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>並註冊來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1092">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1093">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>為您<xref:System.Diagnostics.EventLog>執行個體，然後再呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1093">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-1094">如果系統必須註冊<xref:System.Diagnostics.EventLog.Source%2A>透過呼叫<xref:System.Diagnostics.EventLog.WriteEntry%2A>並<xref:System.Diagnostics.EventLog.Log%2A>未在設定屬性您<xref:System.Diagnostics.EventLog>執行個體，預設為應用程式記錄檔的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1094">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1095">以上所列的許多例外狀況所產生的註冊程序期間引發的錯誤<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1095">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-1096">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1096">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1097"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1097">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="2b88f-1098">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>寫入使用當地語系化的訊息資源檔之事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1098">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="2b88f-1099">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1099">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1100">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1100">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1101">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1101">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1102">如果您將項目寫入遠端電腦時，訊息 （文字字串） 的值可能無法預期如果遠端電腦未執行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1102">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1103">如果`message`參數包含 NUL 字元，而事件記錄檔中的訊息會在 NUL 字元終止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1103">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-1104">下列範例會警告項目寫入事件記錄檔時，「 MyNewLog 」，在本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1104">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1105">還沒有設定 <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1105">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="2b88f-1106">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1106">-or-</span></span> 
<span data-ttu-id="2b88f-1107">該方法已嘗試登錄新的事件來源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1107">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="2b88f-1108">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1108">\- or -</span></span> 
<span data-ttu-id="2b88f-1109">來源已經登錄用於不同的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1109">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="2b88f-1110">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1110">\- or -</span></span> 
<span data-ttu-id="2b88f-1111">訊息字串的長度超過 31,839 個位元組 (在 Windows Vista 之前的 Windows 作業系統中為 32,766 位元組)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1111">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="2b88f-1112">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1112">\- or -</span></span> 
<span data-ttu-id="2b88f-1113">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1113">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="2b88f-1114"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1114"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1115">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1115">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1116">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1116">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1117">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1117">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1118">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1118">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1119">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1119">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-1120">將應用程式註冊在指定電腦上的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1120">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="2b88f-1121">要寫入事件記錄檔的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1121">The string to write to the event log.</span></span></param>
        <summary><span data-ttu-id="2b88f-1122">使用指定的登錄事件來源，將具有指定訊息文字的資訊類型項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1122">Writes an information type entry with the given message text to the event log, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1123">您可以使用這個方法，將資訊項目寫入事件記錄檔，使用已註冊為適當的記錄檔的事件來源的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1123">Use this method to write an information entry to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="2b88f-1124">如果您想要指定任何其他<xref:System.Diagnostics.EventLogEntryType>，請使用不同的多載的<xref:System.Diagnostics.EventLog.WriteEntry%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1124">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-1125">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1125">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="2b88f-1126">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1126">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1127">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1127">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1128">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1128">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1129">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1129">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1130">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1130">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1131">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1131">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1132"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1132">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="2b88f-1133">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>寫入使用當地語系化的訊息資源檔之事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1133">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="2b88f-1134">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1134">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1135">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1135">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1136">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1136">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1137">如果`message`參數包含 NUL 字元，而事件記錄檔中的訊息會在 NUL 字元終止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1137">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="2b88f-1138">`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1138">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1139">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1139">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-1140">下列範例會建立來源`MySource`如果不存在，它的項目寫入事件記錄檔`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1140">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1141"><paramref name="source" /> 值是空白字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1141">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="2b88f-1142">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1142">\- or -</span></span> 
<span data-ttu-id="2b88f-1143"><paramref name="source" /> 值為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1143">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-1144">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1144">\- or -</span></span> 
<span data-ttu-id="2b88f-1145">訊息字串的長度超過 31,839 個位元組 (在 Windows Vista 之前的 Windows 作業系統中為 32,766 位元組)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1145">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="2b88f-1146">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1146">\- or -</span></span> 
<span data-ttu-id="2b88f-1147">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1147">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1148">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1148">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1149">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1149">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1150">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1150">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1151">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1151">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1152">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1152">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="2b88f-1153">要寫入事件記錄檔的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1153">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="2b88f-1154">其中一個 <see cref="T:System.Diagnostics.EventLogEntryType" /> 值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1154">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="2b88f-1155">事件的應用程式特定識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1155">The application-specific identifier for the event.</span></span></param>
        <summary><span data-ttu-id="2b88f-1156">將有指定訊息文字和應用程式定義的事件識別項的項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1156">Writes an entry with the given message text and application-defined event identifier to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1157">使用此方法來撰寫應用程式定義的項目`eventID`事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1157">Use this method to write an entry with an application-defined `eventID` to the event log.</span></span> <span data-ttu-id="2b88f-1158">`eventID`來源以及唯一識別事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1158">The `eventID` together with the source uniquely identify an event.</span></span> <span data-ttu-id="2b88f-1159">每個應用程式可以定義自己已編號的事件，而且它們所對應的描述字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1159">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="2b88f-1160">事件檢視器會顯示這些字串值，以協助使用者了解發生的錯誤，並建議要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1160">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1161">`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1161">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1162">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1162">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="2b88f-1163">除了事件識別碼，您可以指定<xref:System.Diagnostics.EventLogEntryType>事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1163">In addition to the event identifier, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="2b88f-1164">`type`由圖示，然後在 事件檢視器記錄檔中的 類型 欄中的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1164">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="2b88f-1165">這個參數會指出事件類型是錯誤、 警告、 資訊、 成功稽核或失敗稽核。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1165">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="2b88f-1166">您必須設定<xref:System.Diagnostics.EventLog.Source%2A>屬性上的您<xref:System.Diagnostics.EventLog>元件之前，您可以寫入記錄檔中的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1166">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="2b88f-1167">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1167">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="2b88f-1168">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1168">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1169">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1169">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1170">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1170">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1171">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1171">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1172">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1172">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1173">如果在指定的來源<xref:System.Diagnostics.EventLog.Source%2A>屬性的<xref:System.Diagnostics.EventLog>執行個體已不會寫入您的元件，在電腦上註冊<xref:System.Diagnostics.EventLog.WriteEntry%2A>呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>並註冊來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1173">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1174">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>為您<xref:System.Diagnostics.EventLog>執行個體，然後再呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1174">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-1175">如果系統必須註冊<xref:System.Diagnostics.EventLog.Source%2A>透過呼叫<xref:System.Diagnostics.EventLog.WriteEntry%2A>並<xref:System.Diagnostics.EventLog.Log%2A>未在設定屬性您<xref:System.Diagnostics.EventLog>執行個體，預設為應用程式記錄檔的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1175">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1176">以上所列的許多例外狀況所產生的註冊程序期間引發的錯誤<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1176">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-1177">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1177">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1178"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1178">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="2b88f-1179">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>寫入使用當地語系化的訊息資源檔之事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1179">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="2b88f-1180">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1180">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1181">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1181">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1182">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1182">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1183">如果您將項目寫入遠端電腦時，訊息 （文字字串） 的值可能無法預期如果遠端電腦未執行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1183">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1184">如果`message`參數包含 NUL 字元，而事件記錄檔中的訊息會在 NUL 字元終止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1184">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1185">還沒有設定 <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1185">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="2b88f-1186">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1186">-or-</span></span> 
<span data-ttu-id="2b88f-1187">該方法已嘗試登錄新的事件來源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1187">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="2b88f-1188">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1188">\- or -</span></span> 
<span data-ttu-id="2b88f-1189">來源已經登錄用於不同的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1189">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="2b88f-1190">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1190">\- or -</span></span> 
 <span data-ttu-id="2b88f-1191"><paramref name="eventID" /> 小於零或大於 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1191"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="2b88f-1192">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1192">\- or -</span></span> 
<span data-ttu-id="2b88f-1193">訊息字串的長度超過 31,839 個位元組 (在 Windows Vista 之前的 Windows 作業系統中為 32,766 位元組)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1193">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="2b88f-1194">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1194">\- or -</span></span> 
<span data-ttu-id="2b88f-1195">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1195">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1196">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1196">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="2b88f-1197"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1197"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1198">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1198">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1199">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1199">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1200">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1200">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1201">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1201">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-1202">將應用程式註冊在指定電腦上的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1202">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="2b88f-1203">要寫入事件記錄檔的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1203">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="2b88f-1204">其中一個 <see cref="T:System.Diagnostics.EventLogEntryType" /> 值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1204">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <summary><span data-ttu-id="2b88f-1205">用指定的登錄事件來源，將有指定訊息文字的錯誤、警告、資訊、成功稽核或失敗稽核項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1205">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1206">使用這個方法來寫入指定的項目<xref:System.Diagnostics.EventLogEntryType>事件記錄檔中，使用來源已經註冊為適當的記錄檔的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1206">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="2b88f-1207">`type`由圖示，然後在 事件檢視器記錄檔中的 類型 欄中的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1207">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1208">`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1208">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1209">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1209">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="2b88f-1210">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1210">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="2b88f-1211">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1211">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1212">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1212">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1213">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1213">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1214">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1214">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1215">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1215">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1216">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1216">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1217"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1217">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="2b88f-1218">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>寫入使用當地語系化的訊息資源檔之事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1218">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="2b88f-1219">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1219">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1220">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1220">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1221">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1221">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1222">如果`message`參數包含 NUL 字元，而事件記錄檔中的訊息會在 NUL 字元終止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1222">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-1223">下列範例會警告項目寫入事件記錄檔時，「 MyNewLog 」，在本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1223">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1224"><paramref name="source" /> 值是空白字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1224">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="2b88f-1225">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1225">\- or -</span></span> 
<span data-ttu-id="2b88f-1226"><paramref name="source" /> 值為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1226">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-1227">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1227">\- or -</span></span> 
<span data-ttu-id="2b88f-1228">訊息字串的長度超過 31,839 個位元組 (在 Windows Vista 之前的 Windows 作業系統中為 32,766 位元組)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1228">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="2b88f-1229">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1229">\- or -</span></span> 
<span data-ttu-id="2b88f-1230">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1230">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1231">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1231">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="2b88f-1232"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1232"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1233">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1233">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1234">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1234">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1235">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1235">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1236">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1236">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int * int16 -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID, category)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="2b88f-1237">要寫入事件記錄檔的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1237">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="2b88f-1238">其中一個 <see cref="T:System.Diagnostics.EventLogEntryType" /> 值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1238">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="2b88f-1239">事件的應用程式特定識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1239">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="2b88f-1240">與訊息相關的應用程式特定的子分類。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1240">The application-specific subcategory associated with the message.</span></span></param>
        <summary><span data-ttu-id="2b88f-1241">將具有指定訊息文字、應用程式定義的事件識別項和應用程式定義的分類的項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1241">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1242">使用此方法來撰寫應用程式定義的項目`category`事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1242">Use this method to write an entry with an application-defined `category` to the event log.</span></span> <span data-ttu-id="2b88f-1243">事件檢視器會使用要寫入的事件來源篩選事件的類別目錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1243">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="2b88f-1244">事件檢視器可以顯示類別目錄做為數值，或它可以做為資源識別項使用的類別，來顯示的當地語系化類別目錄字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1244">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1245">`category`參數應該是正數值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1245">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="2b88f-1246">負類別目錄值會顯示為互補的正數值在事件檢視器。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1246">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="2b88f-1247">例如，-10 會顯示為 65526，-1 為 65535。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1247">For example, a -10 appears as 65,526, a -1 as 65,535.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1248">`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1248">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1249">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1249">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="2b88f-1250">若要顯示在事件檢視器中的當地語系化類別目錄字串，您必須使用事件來源類別資源檔，以設定和設定`category`分類資源檔中的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1250">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="2b88f-1251">如果事件來源並沒有設定的分類資源檔，或指定`category`不會編製索引的字串，在類別資源檔案中，則 事件檢視器會顯示該項目的數值分類值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1251">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="2b88f-1252">設定的分類資源檔，以及類別目錄中的字串數目資源檔案中，使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>類別。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1252">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="2b88f-1253">除了在類別中，您可以指定正在寫入事件記錄檔事件的事件識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1253">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="2b88f-1254">事件識別碼，以及事件來源，可唯一識別事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1254">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="2b88f-1255">每個應用程式可以定義自己已編號的事件，而且它們所對應的描述字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1255">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="2b88f-1256">事件檢視器會顯示這些字串值，以協助使用者了解發生的錯誤，並建議要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1256">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="2b88f-1257">最後，您可以指定<xref:System.Diagnostics.EventLogEntryType>事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1257">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="2b88f-1258">`type`由圖示，然後在 事件檢視器記錄檔中的 類型 欄中的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1258">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="2b88f-1259">這個參數會指出事件類型是錯誤、 警告、 資訊、 成功稽核或失敗稽核。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1259">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="2b88f-1260">您必須設定<xref:System.Diagnostics.EventLog.Source%2A>屬性上的您<xref:System.Diagnostics.EventLog>元件之前，您可以寫入記錄檔中的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1260">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="2b88f-1261">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1261">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="2b88f-1262">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1262">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1263">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1263">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1264">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1264">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1265">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1265">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1266">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1266">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1267">如果在指定的來源<xref:System.Diagnostics.EventLog.Source%2A>屬性的<xref:System.Diagnostics.EventLog>執行個體已不會寫入您的元件，在電腦上註冊<xref:System.Diagnostics.EventLog.WriteEntry%2A>呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>並註冊來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1267">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1268">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>為您<xref:System.Diagnostics.EventLog>執行個體，然後再呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1268">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-1269">如果系統必須註冊<xref:System.Diagnostics.EventLog.Source%2A>透過呼叫<xref:System.Diagnostics.EventLog.WriteEntry%2A>並<xref:System.Diagnostics.EventLog.Log%2A>未在設定屬性您<xref:System.Diagnostics.EventLog>執行個體，預設為應用程式記錄檔的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1269">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1270">以上所列的許多例外狀況所產生的註冊程序期間引發的錯誤<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1270">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-1271">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1271">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1272"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1272">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="2b88f-1273">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>寫入使用當地語系化的訊息資源檔之事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1273">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="2b88f-1274">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1274">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1275">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1275">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1276">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1276">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1277">如果您將項目寫入遠端電腦時，訊息 （文字字串） 的值可能無法預期如果遠端電腦未執行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1277">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1278">如果`message`參數包含 NUL 字元，而事件記錄檔中的訊息會在 NUL 字元終止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1278">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1279">還沒有設定 <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1279">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="2b88f-1280">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1280">-or-</span></span> 
<span data-ttu-id="2b88f-1281">該方法已嘗試登錄新的事件來源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1281">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="2b88f-1282">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1282">\- or -</span></span> 
<span data-ttu-id="2b88f-1283">來源已經登錄用於不同的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1283">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="2b88f-1284">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1284">\- or -</span></span> 
 <span data-ttu-id="2b88f-1285"><paramref name="eventID" /> 小於零或大於 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1285"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="2b88f-1286">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1286">\- or -</span></span> 
<span data-ttu-id="2b88f-1287">訊息字串的長度超過 31,839 個位元組 (在 Windows Vista 之前的 Windows 作業系統中為 32,766 位元組)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1287">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="2b88f-1288">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1288">\- or -</span></span> 
<span data-ttu-id="2b88f-1289">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1289">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1290">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1290">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="2b88f-1291"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1291"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1292">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1292">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1293">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1293">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1294">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1294">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1295">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1295">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-1296">將應用程式註冊在指定電腦上的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1296">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="2b88f-1297">要寫入事件記錄檔的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1297">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="2b88f-1298">其中一個 <see cref="T:System.Diagnostics.EventLogEntryType" /> 值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1298">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="2b88f-1299">事件的應用程式特定識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1299">The application-specific identifier for the event.</span></span></param>
        <summary><span data-ttu-id="2b88f-1300">使用指定的登錄事件來源，將有指定訊息文字和應用程式定義的事件識別項的項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1300">Writes an entry with the given message text and application-defined event identifier to the event log, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1301">使用此方法來撰寫應用程式定義的項目`eventID`事件記錄檔中，使用來源已經註冊為適當的記錄檔的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1301">Use this method to write an entry with an application-defined `eventID` to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="2b88f-1302">`eventID`，以及原始程式碼，可唯一識別事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1302">The `eventID`, along with the source, uniquely identify an event.</span></span> <span data-ttu-id="2b88f-1303">每個應用程式可以定義自己已編號的事件，而且它們所對應的描述字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1303">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="2b88f-1304">事件檢視器會顯示這些字串值，以協助使用者了解發生的錯誤，並建議要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1304">Event viewers present these strings to the user to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1305">`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1305">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1306">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1306">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="2b88f-1307">除了事件識別碼，這個多載<xref:System.Diagnostics.EventLog.WriteEntry%2A>可讓您指定<xref:System.Diagnostics.EventLogEntryType>事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1307">In addition to the event identifier, this overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A> lets you specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="2b88f-1308">`type`由圖示，然後在 事件檢視器記錄檔中的 類型 欄中的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1308">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="2b88f-1309">這個參數會指出事件類型是錯誤、 警告、 資訊、 成功稽核或失敗稽核。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1309">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="2b88f-1310">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1310">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="2b88f-1311">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1311">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1312">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1312">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1313">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1313">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1314">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1314">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1315">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1315">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1316">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1316">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1317"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1317">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="2b88f-1318">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>寫入使用當地語系化的訊息資源檔之事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1318">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="2b88f-1319">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1319">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1320">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1320">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1321">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1321">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1322">如果`message`參數包含 NUL 字元，而事件記錄檔中的訊息會在 NUL 字元終止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1322">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_4#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_4/CPP/eventlog_writeentry_4.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_4#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_4/CS/eventlog_writeentry_4.cs#1)]
 [!code-vb[EventLog_WriteEntry_4#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_4/VB/eventlog_writeentry_4.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1323"><paramref name="source" /> 值是空白字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1323">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="2b88f-1324">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1324">\- or -</span></span> 
<span data-ttu-id="2b88f-1325"><paramref name="source" /> 值為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1325">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-1326">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1326">\- or -</span></span> 
 <span data-ttu-id="2b88f-1327"><paramref name="eventID" /> 小於零或大於 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1327"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="2b88f-1328">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1328">\- or -</span></span> 
<span data-ttu-id="2b88f-1329">訊息字串的長度超過 31,839 個位元組 (在 Windows Vista 之前的 Windows 作業系統中為 32,766 位元組)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1329">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="2b88f-1330">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1330">\- or -</span></span> 
<span data-ttu-id="2b88f-1331">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1331">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1332">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1332">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="2b88f-1333"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1333"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1334">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1334">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1335">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1335">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1336">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1336">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1337">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1337">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int * int16 * byte[] -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID, category, rawData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="2b88f-1338">要寫入事件記錄檔的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1338">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="2b88f-1339">其中一個 <see cref="T:System.Diagnostics.EventLogEntryType" /> 值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1339">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="2b88f-1340">事件的應用程式特定識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1340">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="2b88f-1341">與訊息相關的應用程式特定的子分類。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1341">The application-specific subcategory associated with the message.</span></span></param>
        <param name="rawData"><span data-ttu-id="2b88f-1342">保存與項目相關的二進位資料的位元組陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1342">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <summary><span data-ttu-id="2b88f-1343">將有指定訊息文字、應用程式定義的事件識別項和應用程式定義的分類的項目寫入事件記錄檔，並將二進位資料附加到訊息。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1343">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, and appends binary data to the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1344">您可以使用此多載，寫入事件記錄檔中的應用程式定義的事件特定資料。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1344">Use this overload to write application-defined event-specific data to the event log.</span></span> <span data-ttu-id="2b88f-1345">事件檢視器不會解譯這項資料;它只能在組合的十六進位和文字格式顯示未經處理資料。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1345">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="2b88f-1346">使用事件特定資料盡量節制，包括它只有在確定會很有用交給偵錯問題。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1346">Use event-specific data sparingly, including it only if you are sure it will be useful to someone debugging the problem.</span></span> <span data-ttu-id="2b88f-1347">您也可以使用事件特定資料，來儲存應用程式可以處理獨立於事件檢視器的資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1347">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="2b88f-1348">比方說，您可以特別為您的事件，撰寫一個檢視器，或編寫一個程式，會掃描記錄檔，並建立報告，其中包含從事件特定資料的資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1348">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="2b88f-1349">除了二進位資料，您可以指定應用程式定義的類別目錄和應用程式定義的事件識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1349">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="2b88f-1350">事件檢視器會使用要寫入的事件來源篩選事件的類別目錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1350">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="2b88f-1351">事件檢視器可以顯示類別目錄做為數值，或它可以做為資源識別項使用的類別，來顯示的當地語系化類別目錄字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1351">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1352">`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1352">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1353">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1353">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1354">`category`參數應該是正數值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1354">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="2b88f-1355">負類別目錄值會顯示為互補的正數值在事件檢視器。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1355">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="2b88f-1356">例如，-10 會顯示為 65526，-1 為 65535。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1356">For example, a -10 appears as 65,526, a -1 as 65,535.</span></span>  
  
 <span data-ttu-id="2b88f-1357">若要顯示在事件檢視器中的當地語系化類別目錄字串，您必須使用事件來源類別資源檔，以設定和設定`category`分類資源檔中的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1357">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="2b88f-1358">如果事件來源並沒有設定的分類資源檔，或指定`category`不會編製索引的字串，在類別資源檔案中，則 事件檢視器會顯示該項目的數值分類值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1358">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="2b88f-1359">設定的分類資源檔，以及類別目錄中的字串數目資源檔案中，使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>類別。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1359">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="2b88f-1360">事件識別碼，以及事件來源，可唯一識別事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1360">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="2b88f-1361">每個應用程式可以定義自己已編號的事件，而且它們所對應的描述字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1361">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="2b88f-1362">事件檢視器會顯示這些字串值，以協助使用者了解發生的錯誤，並建議要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1362">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="2b88f-1363">最後，您可以指定<xref:System.Diagnostics.EventLogEntryType>事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1363">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="2b88f-1364">`type`由圖示，然後在 事件檢視器記錄檔中的 類型 欄中的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1364">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="2b88f-1365">這個參數會指出事件類型是錯誤、 警告、 資訊、 成功稽核或失敗稽核。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1365">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="2b88f-1366">您必須設定<xref:System.Diagnostics.EventLog.Source%2A>屬性上的您<xref:System.Diagnostics.EventLog>元件之前，您可以寫入記錄檔中的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1366">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="2b88f-1367">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1367">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="2b88f-1368">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1368">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1369">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1369">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1370">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1370">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1371">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1371">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1372">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1372">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1373">如果在指定的來源<xref:System.Diagnostics.EventLog.Source%2A>屬性的<xref:System.Diagnostics.EventLog>執行個體已不會寫入您的元件，在電腦上註冊<xref:System.Diagnostics.EventLog.WriteEntry%2A>呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>並註冊來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1373">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1374">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>為您<xref:System.Diagnostics.EventLog>執行個體，然後再呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1374">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-1375">如果系統必須註冊<xref:System.Diagnostics.EventLog.Source%2A>透過呼叫<xref:System.Diagnostics.EventLog.WriteEntry%2A>並<xref:System.Diagnostics.EventLog.Log%2A>未在設定屬性您<xref:System.Diagnostics.EventLog>執行個體，預設為應用程式記錄檔的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1375">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1376">以上所列的許多例外狀況所產生的註冊程序期間引發的錯誤<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1376">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="2b88f-1377">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1377">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1378"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1378">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="2b88f-1379">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>寫入使用當地語系化的訊息資源檔之事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1379">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="2b88f-1380">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1380">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1381">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1381">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1382">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1382">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1383">如果您將項目寫入遠端電腦時，訊息 （文字字串） 的值可能無法預期如果遠端電腦未執行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1383">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1384">如果`message`參數包含 NUL 字元，而事件記錄檔中的訊息會在 NUL 字元終止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1384">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_5#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_5/CPP/eventlog_writeentry_5.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_5#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_5/CS/eventlog_writeentry_5.cs#1)]
 [!code-vb[EventLog_WriteEntry_5#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_5/VB/eventlog_writeentry_5.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1385">還沒有設定 <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1385">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="2b88f-1386">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1386">-or-</span></span> 
<span data-ttu-id="2b88f-1387">該方法已嘗試登錄新的事件來源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1387">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="2b88f-1388">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1388">\- or -</span></span> 
<span data-ttu-id="2b88f-1389">來源已經登錄用於不同的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1389">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="2b88f-1390">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1390">\- or -</span></span> 
 <span data-ttu-id="2b88f-1391"><paramref name="eventID" /> 小於零或大於 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1391"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="2b88f-1392">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1392">\- or -</span></span> 
<span data-ttu-id="2b88f-1393">訊息字串的長度超過 31,839 個位元組 (在 Windows Vista 之前的 Windows 作業系統中為 32,766 位元組)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1393">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="2b88f-1394">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1394">\- or -</span></span> 
<span data-ttu-id="2b88f-1395">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1395">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1396">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1396">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="2b88f-1397"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1397"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1398">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1398">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1399">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1399">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1400">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1400">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1401">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1401">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int * int16 -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID, category)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-1402">將應用程式註冊在指定電腦上的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1402">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="2b88f-1403">要寫入事件記錄檔的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1403">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="2b88f-1404">其中一個 <see cref="T:System.Diagnostics.EventLogEntryType" /> 值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1404">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="2b88f-1405">事件的應用程式特定識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1405">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="2b88f-1406">與訊息相關的應用程式特定的子分類。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1406">The application-specific subcategory associated with the message.</span></span></param>
        <summary><span data-ttu-id="2b88f-1407">使用指定的登錄事件來源，將有指定訊息文字、應用程式定義的事件識別項和應用程式定義的分類的項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1407">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, using the specified registered event source.</span></span> <span data-ttu-id="2b88f-1408"><paramref name="category" /> 可以讓事件檢視器用來篩選記錄檔中的事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1408">The <paramref name="category" /> can be used by the Event Viewer to filter events in the log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1409">使用此方法來撰寫應用程式定義的項目`category`事件記錄檔中，使用 已註冊為適當的記錄檔的事件來源的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1409">Use this method to write an entry with an application-defined `category` to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="2b88f-1410">事件檢視器會使用要寫入的事件來源篩選事件的類別目錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1410">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="2b88f-1411">事件檢視器可以顯示類別目錄做為數值，或它可以做為資源識別項使用的類別，來顯示的當地語系化類別目錄字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1411">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1412">`category`參數應該是正數值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1412">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="2b88f-1413">負類別目錄值會顯示為互補的正數值在事件檢視器。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1413">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="2b88f-1414">例如，-10 會顯示為 65526，-1 為 65535。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1414">For example, a -10 appears as 65,526, a -1 as 65,535.</span></span>  
  
 <span data-ttu-id="2b88f-1415">若要顯示在事件檢視器中的當地語系化類別目錄字串，您必須使用事件來源類別資源檔，以設定和設定`category`分類資源檔中的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1415">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="2b88f-1416">如果事件來源並沒有設定的分類資源檔，或指定`category`不會編製索引的字串，在類別資源檔案中，則 事件檢視器會顯示該項目的數值分類值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1416">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="2b88f-1417">設定的分類資源檔，以及類別目錄中的字串數目資源檔案中，使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>類別。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1417">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="2b88f-1418">除了在類別中，您可以指定正在寫入事件記錄檔事件的事件識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1418">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="2b88f-1419">事件識別碼，以及事件來源，可唯一識別事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1419">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="2b88f-1420">每個應用程式可以定義自己已編號的事件，而且它們所對應的描述字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1420">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="2b88f-1421">事件檢視器會顯示這些字串值，以協助使用者了解發生的錯誤，並建議要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1421">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="2b88f-1422">最後，您可以指定<xref:System.Diagnostics.EventLogEntryType>事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1422">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="2b88f-1423">`type`由圖示，然後在 事件檢視器記錄檔中的 類型 欄中的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1423">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="2b88f-1424">這個參數會指出事件類型是錯誤、 警告、 資訊、 成功稽核或失敗稽核。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1424">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="2b88f-1425">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1425">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="2b88f-1426">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1426">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1427">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1427">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1428">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1428">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1429">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1429">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1430">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1430">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1431">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1431">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1432"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1432">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="2b88f-1433">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>寫入使用當地語系化的訊息資源檔之事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1433">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="2b88f-1434">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1434">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1435">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1435">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1436">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1436">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1437">如果`message`參數包含 NUL 字元，而事件記錄檔中的訊息會在 NUL 字元終止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1437">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="2b88f-1438">`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1438">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1439">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1439">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_1_3#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#1)]
 [!code-vb[EventLog_WriteEntry_1_3#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1440"><paramref name="source" /> 值是空白字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1440">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="2b88f-1441">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1441">\- or -</span></span> 
<span data-ttu-id="2b88f-1442"><paramref name="source" /> 值為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1442">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-1443">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1443">\- or -</span></span> 
 <span data-ttu-id="2b88f-1444"><paramref name="eventID" /> 小於零或大於 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1444"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="2b88f-1445">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1445">\- or -</span></span> 
<span data-ttu-id="2b88f-1446">訊息字串的長度超過 31,839 個位元組 (在 Windows Vista 之前的 Windows 作業系統中為 32,766 位元組)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1446">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="2b88f-1447">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1447">\- or -</span></span> 
<span data-ttu-id="2b88f-1448">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1448">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1449">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1449">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="2b88f-1450"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1450"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1451">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1451">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1452">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1452">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1453">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1453">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1454">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1454">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int * int16 * byte[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID, category, rawData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-1455">將應用程式註冊在指定電腦上的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1455">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="2b88f-1456">要寫入事件記錄檔的字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1456">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="2b88f-1457">其中一個 <see cref="T:System.Diagnostics.EventLogEntryType" /> 值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1457">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="2b88f-1458">事件的應用程式特定識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1458">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="2b88f-1459">與訊息相關的應用程式特定的子分類。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1459">The application-specific subcategory associated with the message.</span></span></param>
        <param name="rawData"><span data-ttu-id="2b88f-1460">保存與項目相關的二進位資料的位元組陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1460">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <summary><span data-ttu-id="2b88f-1461">將有指定訊息文字、應用程式定義的事件識別項和應用程式定義的分類的項目寫入事件記錄檔 (使用指定的登錄事件來源)，並將二進位資料附加到訊息。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1461">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log (using the specified registered event source) and appends binary data to the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1462">使用這個方法，將應用程式定義的事件特定資料寫入事件記錄檔，使用已註冊為適當的記錄檔的事件來源的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1462">Use this method to write application-defined event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="2b88f-1463">事件檢視器不會解譯這項資料;它只能在組合的十六進位和文字格式顯示未經處理資料。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1463">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="2b88f-1464">謹慎使用; 使用事件特定的資料確定會很有用時，才將它包含。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1464">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="2b88f-1465">您也可以使用事件特定資料，來儲存應用程式可以處理獨立於事件檢視器的資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1465">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="2b88f-1466">比方說，您可以特別為您的事件，撰寫一個檢視器，或編寫一個程式，會掃描記錄檔，並建立報告，其中包含從事件特定資料的資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1466">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="2b88f-1467">除了二進位資料，您可以指定應用程式定義的類別目錄和應用程式定義的事件識別項。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1467">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="2b88f-1468">事件檢視器會使用要寫入的事件來源篩選事件的類別目錄。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1468">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="2b88f-1469">事件檢視器可以顯示類別目錄做為數值，或它可以做為資源識別項使用的類別，來顯示的當地語系化類別目錄字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1469">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1470">`category`參數應該是正數值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1470">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="2b88f-1471">負類別目錄值會顯示為互補的正數值在事件檢視器。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1471">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="2b88f-1472">例如，-10，會顯示為 65526，-1 為 65535。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1472">For example, a -10 will appear as 65,526, a -1 as 65,535.</span></span>  
  
 <span data-ttu-id="2b88f-1473">若要顯示在事件檢視器中的當地語系化類別目錄字串，您必須使用事件來源類別資源檔，以設定和設定`category`分類資源檔中的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1473">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="2b88f-1474">如果事件來源並沒有設定的分類資源檔，或指定`category`不會編製索引的字串，在類別資源檔案中，則 事件檢視器會顯示該項目的數值分類值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1474">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="2b88f-1475">設定的分類資源檔，以及類別目錄中的字串數目資源檔案中，使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>類別。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1475">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="2b88f-1476">事件識別碼，以及事件來源，可唯一識別事件。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1476">Event identifiers, together with the event source, uniquely identify an event.</span></span> <span data-ttu-id="2b88f-1477">每個應用程式可以定義自己已編號的事件，而且它們所對應的描述字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1477">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="2b88f-1478">事件檢視器會顯示這些字串值，以協助使用者了解發生的錯誤，並建議要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1478">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="2b88f-1479">最後，您可以指定<xref:System.Diagnostics.EventLogEntryType>事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1479">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="2b88f-1480">`type`由圖示，然後在 事件檢視器記錄檔中的 類型 欄中的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1480">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="2b88f-1481">這個參數會指出事件類型是錯誤、 警告、 資訊、 成功稽核或失敗稽核。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1481">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="2b88f-1482">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1482">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="2b88f-1483">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1483">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1484">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1484">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1485">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1485">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1486">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1486">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1487">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1487">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1488">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1488">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1489"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1489">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="2b88f-1490">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>寫入使用當地語系化的訊息資源檔之事件的方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1490">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="2b88f-1491">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1491">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1492">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1492">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1493">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1493">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1494">如果`message`參數包含 NUL 字元，而事件記錄檔中的訊息會在 NUL 字元終止。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1494">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="2b88f-1495">`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1495">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1496">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1496">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#2)]
 [!code-csharp[EventLog_WriteEntry_1_3#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#2)]
 [!code-vb[EventLog_WriteEntry_1_3#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1497"><paramref name="source" /> 值是空白字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1497">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="2b88f-1498">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1498">\- or -</span></span> 
<span data-ttu-id="2b88f-1499"><paramref name="source" /> 值為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1499">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-1500">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1500">\- or -</span></span> 
 <span data-ttu-id="2b88f-1501"><paramref name="eventID" /> 小於零或大於 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1501"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="2b88f-1502">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1502">\- or -</span></span> 
<span data-ttu-id="2b88f-1503">訊息字串的長度超過 31,839 個位元組 (在 Windows Vista 之前的 Windows 作業系統中為 32,766 位元組)。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1503">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
<span data-ttu-id="2b88f-1504">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1504">\- or -</span></span> 
<span data-ttu-id="2b88f-1505">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1505">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="2b88f-1506"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1506"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1507">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1507">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1508">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1508">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1509">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1509">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1510">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1510">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1511">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1511">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEvent">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="2b88f-1512">將當地語系化的事件項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1512">Writes a localized event entry to the event log.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="member this.WriteEvent : System.Diagnostics.EventInstance * obj[] -&gt; unit" Usage="eventLog.WriteEvent (instance, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance"><span data-ttu-id="2b88f-1513"><see cref="T:System.Diagnostics.EventInstance" /> 執行個體，表示當地語系化的事件記錄項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1513">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="values"><span data-ttu-id="2b88f-1514">要合併到事件記錄項目訊息文字的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1514">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="2b88f-1515">將當地語系化的項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1515">Writes a localized entry to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1516">若要當地語系化的項目寫入事件記錄檔中使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1516">Use this method to write a localized entry to the event log.</span></span> <span data-ttu-id="2b88f-1517">您可以指定事件屬性使用的資源識別項，而不是字串值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1517">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="2b88f-1518">事件檢視器使用的資源識別元來顯示的當地語系化的資源檔中的對應字串<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1518">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="2b88f-1519">在您撰寫使用資源識別碼的事件之前，您必須註冊來源與對應的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1519">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="2b88f-1520">輸入`instance`執行個體指定的事件訊息和屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1520">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="2b88f-1521">設定<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`輸入來源的訊息資源檔中定義的訊息。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1521">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="2b88f-1522">您可以選擇性地設定<xref:System.Diagnostics.EventInstance.CategoryId%2A>並<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`以定義您的事件項目分類和事件類型的輸入。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1522">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="2b88f-1523">您也可以指定要插入當地語系化的訊息文字的語言無關字串陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1523">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="2b88f-1524">設定`values`至`null`如果事件訊息不包含取代字串的格式預留位置。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1524">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="2b88f-1525">您必須設定<xref:System.Diagnostics.EventLog.Source%2A>屬性，在您<xref:System.Diagnostics.EventLog>元件之前使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1525">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="2b88f-1526">指定的來源必須設定當地語系化的項目寫入記錄檔。來源最小值必須具有定義的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1526">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="2b88f-1527">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1527">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="2b88f-1528">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1528">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1529">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1529">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1530">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1530">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1531">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1531">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1532">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1532">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1533">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1533">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1534">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，如果您的應用程式事件記錄檔中直接寫入字串值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1534">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="2b88f-1535">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1535">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1536">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1536">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1537">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1537">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1538">如果您將項目寫入遠端的電腦時，值`message`字串可能不是您預期如果遠端電腦未執行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1538">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="2b88f-1539">此外，`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1539">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1540">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1540">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-1541">下列範例會寫入兩個稽核事件記錄檔的項目`myNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1541">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="2b88f-1542">此範例會建立新的事件來源和新的事件記錄檔，如果不存在本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1542">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="2b88f-1543">事件訊息文字被指定資源檔中使用的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1543">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="2b88f-1544">此範例會使用下列的訊息文字檔案，內建資源庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1544">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="2b88f-1545">訊息文字檔案是從其中建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1545">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="2b88f-1546">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1546">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1547">還沒有設定 <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1547">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="2b88f-1548">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1548">-or-</span></span> 
<span data-ttu-id="2b88f-1549">該方法已嘗試登錄新的事件來源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1549">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="2b88f-1550">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1550">\- or -</span></span> 
<span data-ttu-id="2b88f-1551">來源已經登錄用於不同的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1551">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="2b88f-1552">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1552">\- or -</span></span> 
 <span data-ttu-id="2b88f-1553"><paramref name="instance.InstanceId" /> 小於零或大於 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1553"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="2b88f-1554">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1554">\- or -</span></span> 
 <span data-ttu-id="2b88f-1555"><paramref name="values" /> 擁有超過 256 個項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1555"><paramref name="values" /> has more than 256 elements.</span></span>  
  
<span data-ttu-id="2b88f-1556">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1556">\- or -</span></span> 
<span data-ttu-id="2b88f-1557">其中一個 <paramref name="values" /> 項目的長度超過 32766 個位元組。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1557">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
<span data-ttu-id="2b88f-1558">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1558">\- or -</span></span> 
<span data-ttu-id="2b88f-1559">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1559">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="2b88f-1560"><paramref name="instance" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1560"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1561">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1561">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1562">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1562">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1563">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1563">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1564">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1564">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1565">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1565">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="member this.WriteEvent : System.Diagnostics.EventInstance * byte[] * obj[] -&gt; unit" Usage="eventLog.WriteEvent (instance, data, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance"><span data-ttu-id="2b88f-1566"><see cref="T:System.Diagnostics.EventInstance" /> 執行個體，表示當地語系化的事件記錄項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1566">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="data"><span data-ttu-id="2b88f-1567">保存與項目相關的二進位資料的位元組陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1567">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <param name="values"><span data-ttu-id="2b88f-1568">要合併到事件記錄項目訊息文字的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1568">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="2b88f-1569">以指定的事件資料、訊息取代字串和相關聯的二進位資料來寫入事件記錄檔項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1569">Writes an event log entry with the given event data, message replacement strings, and associated binary data.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1570">使用此方法來寫入事件記錄檔的當地語系化的項目，與其他事件特定的資料。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1570">Use this method to write a localized entry with additional event-specific data to the event log.</span></span> <span data-ttu-id="2b88f-1571">您可以指定事件屬性使用的資源識別項，而不是字串值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1571">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="2b88f-1572">事件檢視器使用的資源識別元來顯示的當地語系化的資源檔中的對應字串<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1572">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="2b88f-1573">在您撰寫使用資源識別碼的事件之前，您必須註冊來源與對應的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1573">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="2b88f-1574">輸入`instance`執行個體指定的事件訊息和屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1574">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="2b88f-1575">設定<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`輸入來源的訊息資源檔中定義的訊息。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1575">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="2b88f-1576">您可以選擇性地設定<xref:System.Diagnostics.EventInstance.CategoryId%2A>並<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`以定義您的事件項目分類和事件類型的輸入。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1576">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="2b88f-1577">您也可以指定要插入當地語系化的訊息文字的語言無關字串陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1577">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="2b88f-1578">設定`values`至`null`如果事件訊息不包含取代字串的格式預留位置。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1578">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="2b88f-1579">指定的二進位資料與事件時就必須提供事件的其他詳細資料。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1579">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="2b88f-1580">例如，使用`data`納入有關特定錯誤的參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1580">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="2b88f-1581">事件檢視器不會解譯相關聯的事件資料它會顯示資料組合的十六進位和文字格式。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1581">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="2b88f-1582">謹慎使用; 使用事件特定的資料確定會很有用時，才將它包含。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1582">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="2b88f-1583">您也可以使用事件特定資料，來儲存應用程式可以處理獨立於事件檢視器的資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1583">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="2b88f-1584">比方說，您無法專為您的事件，撰寫一個檢視器，或編寫程式，以掃描事件記錄檔，並建立報告，其中包含從事件特定資料的資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1584">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="2b88f-1585">您必須設定<xref:System.Diagnostics.EventLog.Source%2A>屬性，在您<xref:System.Diagnostics.EventLog>元件之前使用的元件之前<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1585">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="2b88f-1586">指定的來源必須設定當地語系化的項目寫入記錄檔。來源最小值必須具有定義的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1586">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="2b88f-1587">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1587">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="2b88f-1588">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1588">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1589">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1589">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1590">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1590">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1591">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1591">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1592">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1592">You must have administrative rights on the computer to create a new event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1593">如果您未指定<xref:System.Diagnostics.EventLog.MachineName%2A>為您<xref:System.Diagnostics.EventLog>執行個體，然後再呼叫<xref:System.Diagnostics.EventLog.WriteEvent%2A>，本機電腦 ("。") 會假設。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1593">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.WriteEvent%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="2b88f-1594">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1594">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1595">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，如果您的應用程式事件記錄檔中直接寫入字串值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1595">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="2b88f-1596">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1596">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1597">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1597">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1598">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1598">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b88f-1599">如果您將項目寫入遠端的電腦時，值`message`字串可能不是您預期如果遠端電腦未執行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1599">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="2b88f-1600">此外，`message`字串不能包含 %*n*，其中*n*是整數值 (例如，%1)，因為事件檢視器會將它視為插入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1600">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="2b88f-1601">「 網際網路 」 通訊協定版本 6 (IPv6) 位址可以包含這個字元順序，因為無法記錄事件訊息包含 IPv6 位址。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1601">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-1602">下列範例會寫入兩個稽核事件記錄檔的項目`myNewLog`。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1602">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="2b88f-1603">此範例會建立新的事件來源和新的事件記錄檔，如果不存在本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1603">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="2b88f-1604">事件訊息文字被指定資源檔中使用的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1604">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="2b88f-1605">此範例會使用下列的訊息文字檔案，內建資源庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1605">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="2b88f-1606">訊息文字檔案是從其中建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1606">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="2b88f-1607">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1607">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1608">還沒有設定 <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1608">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
<span data-ttu-id="2b88f-1609">-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1609">-or-</span></span> 
<span data-ttu-id="2b88f-1610">該方法已嘗試登錄新的事件來源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的電腦名稱無效。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1610">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
<span data-ttu-id="2b88f-1611">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1611">\- or -</span></span> 
<span data-ttu-id="2b88f-1612">來源已經登錄用於不同的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1612">The source is already registered for a different event log.</span></span>  
  
<span data-ttu-id="2b88f-1613">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1613">\- or -</span></span> 
 <span data-ttu-id="2b88f-1614"><paramref name="instance.InstanceId" /> 小於零或大於 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1614"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="2b88f-1615">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1615">\- or -</span></span> 
 <span data-ttu-id="2b88f-1616"><paramref name="values" /> 擁有超過 256 個項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1616"><paramref name="values" /> has more than 256 elements.</span></span>  
  
<span data-ttu-id="2b88f-1617">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1617">\- or -</span></span> 
<span data-ttu-id="2b88f-1618">其中一個 <paramref name="values" /> 項目的長度超過 32766 個位元組。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1618">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
<span data-ttu-id="2b88f-1619">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1619">\- or -</span></span> 
<span data-ttu-id="2b88f-1620">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1620">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="2b88f-1621"><paramref name="instance" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1621"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1622">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1622">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1623">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1623">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1624">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1624">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1625">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1625">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1626">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1626">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="static member WriteEvent : string * System.Diagnostics.EventInstance * obj[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEvent (source, instance, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-1627">為指定電腦上的應用程式註冊的事件來源名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1627">The name of the event source registered for the application on the specified computer.</span></span></param>
        <param name="instance"><span data-ttu-id="2b88f-1628"><see cref="T:System.Diagnostics.EventInstance" /> 執行個體，表示當地語系化的事件記錄項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1628">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="values"><span data-ttu-id="2b88f-1629">要合併到事件記錄項目訊息文字的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1629">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="2b88f-1630">以指定的事件資料、訊息取代字串，以及使用指定的已登錄事件來源，寫入事件記錄檔項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1630">Writes an event log entry with the given event data and message replacement strings, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1631">使用這個方法將當地語系化的項目寫入事件記錄檔，使用已註冊為適當的記錄檔的事件來源的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1631">Use this method to write a localized entry to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="2b88f-1632">您可以指定事件屬性使用的資源識別項，而不是字串值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1632">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="2b88f-1633">事件檢視器會顯示對應的字串來源的當地語系化的資源檔使用的資源識別元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1633">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="2b88f-1634">在您撰寫使用資源識別碼的事件之前，您必須註冊來源與對應的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1634">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="2b88f-1635">輸入`instance`執行個體指定的事件訊息和屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1635">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="2b88f-1636">設定<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`輸入來源的訊息資源檔中定義的訊息。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1636">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="2b88f-1637">您可以選擇性地設定<xref:System.Diagnostics.EventInstance.CategoryId%2A>並<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`以定義您的事件項目分類和事件類型的輸入。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1637">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="2b88f-1638">您也可以指定要插入當地語系化的訊息文字的語言無關字串陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1638">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="2b88f-1639">設定`values`至`null`如果事件訊息不包含取代字串的格式預留位置。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1639">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="2b88f-1640">您必須針對事件記錄檔註冊指定的來源，才能使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1640">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="2b88f-1641">指定的來源必須設定當地語系化的項目寫入記錄檔。來源最小值必須具有定義的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1641">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="2b88f-1642">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1642">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="2b88f-1643">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1643">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1644">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1644">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1645">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1645">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1646">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1646">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1647">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1647">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1648">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1648">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1649">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，如果您的應用程式事件記錄檔中直接寫入字串值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1649">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="2b88f-1650">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1650">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1651">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1651">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1652">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1652">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-1653">下列範例會參考事件項目和警告事件項目寫入現有的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1653">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="2b88f-1654">事件訊息文字被指定資源檔中使用的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1654">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="2b88f-1655">此範例假設來源已經註冊對應的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1655">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="2b88f-1656">此範例會使用下列的訊息文字檔案，內建資源庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1656">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="2b88f-1657">訊息文字檔案是從其中建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1657">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="2b88f-1658">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1658">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1659"><paramref name="source" /> 值是空白字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1659">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="2b88f-1660">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1660">\- or -</span></span> 
<span data-ttu-id="2b88f-1661"><paramref name="source" /> 值為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1661">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-1662">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1662">\- or -</span></span> 
 <span data-ttu-id="2b88f-1663"><paramref name="instance.InstanceId" /> 小於零或大於 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1663"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="2b88f-1664">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1664">\- or -</span></span> 
 <span data-ttu-id="2b88f-1665"><paramref name="values" /> 擁有超過 256 個項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1665"><paramref name="values" /> has more than 256 elements.</span></span>  
  
<span data-ttu-id="2b88f-1666">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1666">\- or -</span></span> 
<span data-ttu-id="2b88f-1667">其中一個 <paramref name="values" /> 項目的長度超過 32766 個位元組。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1667">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
<span data-ttu-id="2b88f-1668">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1668">\- or -</span></span> 
<span data-ttu-id="2b88f-1669">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1669">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="2b88f-1670"><paramref name="instance" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1670"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1671">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1671">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1672">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1672">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1673">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1673">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1674">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1674">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1675">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1675">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="static member WriteEvent : string * System.Diagnostics.EventInstance * byte[] * obj[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEvent (source, instance, data, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Diagnostics.EventLog</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="2b88f-1676">為指定電腦上的應用程式註冊的事件來源名稱。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1676">The name of the event source registered for the application on the specified computer.</span></span></param>
        <param name="instance"><span data-ttu-id="2b88f-1677"><see cref="T:System.Diagnostics.EventInstance" /> 執行個體，表示當地語系化的事件記錄項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1677">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="data"><span data-ttu-id="2b88f-1678">保存與項目相關的二進位資料的位元組陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1678">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <param name="values"><span data-ttu-id="2b88f-1679">要合併到事件記錄項目訊息文字的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1679">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="2b88f-1680">以指定的事件資料、訊息取代字串和相關聯的二進位資料，以及使用指定的已登錄事件來源，寫入事件記錄檔項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1680">Writes an event log entry with the given event data, message replacement strings, and associated binary data, and using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2b88f-1681">使用這個方法將當地語系化的項目，與其他事件特定的資料寫入事件記錄檔，使用已註冊為適當的記錄檔的事件來源的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1681">Use this method to write a localized entry with additional event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="2b88f-1682">您可以指定事件屬性使用的資源識別項，而不是字串值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1682">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="2b88f-1683">事件檢視器會顯示對應的字串來源的當地語系化的資源檔使用的資源識別元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1683">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="2b88f-1684">在您撰寫使用資源識別碼的事件之前，您必須註冊來源與對應的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1684">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="2b88f-1685">輸入`instance`執行個體指定的事件訊息和屬性。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1685">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="2b88f-1686">設定<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`輸入來源的訊息資源檔中定義的訊息。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1686">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="2b88f-1687">您可以選擇性地設定<xref:System.Diagnostics.EventInstance.CategoryId%2A>並<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`以定義您的事件項目分類和事件類型的輸入。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1687">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="2b88f-1688">您也可以指定要插入當地語系化的訊息文字的語言無關字串陣列。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1688">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="2b88f-1689">設定`values`至`null`如果事件訊息不包含取代字串的格式預留位置。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1689">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="2b88f-1690">指定的二進位資料與事件時就必須提供事件的其他詳細資料。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1690">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="2b88f-1691">例如，使用`data`納入有關特定錯誤的參數。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1691">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="2b88f-1692">事件檢視器不會解譯相關聯的事件資料它會顯示資料組合的十六進位和文字格式。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1692">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="2b88f-1693">謹慎使用; 使用事件特定的資料確定會很有用時，才將它包含。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1693">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="2b88f-1694">您也可以使用事件特定資料，來儲存應用程式可以處理獨立於事件檢視器的資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1694">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="2b88f-1695">比方說，您無法專為您的事件，撰寫一個檢視器，或編寫程式，以掃描事件記錄檔，並建立報告，其中包含從事件特定資料的資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1695">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="2b88f-1696">您必須針對事件記錄檔註冊指定的來源，才能使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1696">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="2b88f-1697">指定的來源必須設定當地語系化的項目寫入記錄檔。來源最小值必須具有定義的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1697">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="2b88f-1698">您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1698">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="2b88f-1699">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1699">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="2b88f-1700">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1700">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="2b88f-1701">如果作業系統不重新整理其事件來源的清單，而您嘗試寫入新的來源的事件寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1701">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="2b88f-1702">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1702">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="2b88f-1703">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1703">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="2b88f-1704">寫入當地語系化的項目或寫入的直接存取的字串，則必須設定的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1704">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="2b88f-1705">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，如果您的應用程式事件記錄檔中直接寫入字串值。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1705">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="2b88f-1706">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1706">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="2b88f-1707">比方說，使用資源檔，設定一個來源，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法寫入事件記錄檔的資源識別項的項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1707">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="2b88f-1708">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1708">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2b88f-1709">下列範例會參考事件項目和警告事件項目寫入現有的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1709">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="2b88f-1710">事件訊息文字被指定資源檔中使用的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1710">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="2b88f-1711">此範例假設來源已經註冊對應的資源檔。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1711">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="2b88f-1712">此範例會使用下列的訊息文字檔案，內建資源庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1712">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="2b88f-1713">訊息文字檔案是從其中建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1713">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="2b88f-1714">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1714">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="2b88f-1715"><paramref name="source" /> 值是空白字串 ("")。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1715">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
<span data-ttu-id="2b88f-1716">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1716">\- or -</span></span> 
<span data-ttu-id="2b88f-1717"><paramref name="source" /> 值為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1717">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
<span data-ttu-id="2b88f-1718">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1718">\- or -</span></span> 
 <span data-ttu-id="2b88f-1719"><paramref name="instance.InstanceId" /> 小於零或大於 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1719"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
<span data-ttu-id="2b88f-1720">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1720">\- or -</span></span> 
 <span data-ttu-id="2b88f-1721"><paramref name="values" /> 擁有超過 256 個項目。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1721"><paramref name="values" /> has more than 256 elements.</span></span>  
  
<span data-ttu-id="2b88f-1722">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1722">\- or -</span></span> 
<span data-ttu-id="2b88f-1723">其中一個 <paramref name="values" /> 項目的長度超過 32766 個位元組。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1723">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
<span data-ttu-id="2b88f-1724">\-或-</span><span class="sxs-lookup"><span data-stu-id="2b88f-1724">\- or -</span></span> 
<span data-ttu-id="2b88f-1725">來源名稱產生的登錄機碼路徑長度超過 254 個字元。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1725">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="2b88f-1726"><paramref name="instance" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1726"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="2b88f-1727">無法開啟事件記錄檔的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1727">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="2b88f-1728">作業系統在將事件項目寫入事件記錄檔時回報錯誤。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1728">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="2b88f-1729">無法使用 Windows 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1729">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="2b88f-1730">用於寫入在電腦上的事件記錄檔資訊。</span><span class="sxs-lookup"><span data-stu-id="2b88f-1730">for writing the event log information on the computer.</span></span> <span data-ttu-id="2b88f-1731">相關聯的列舉型別： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="2b88f-1731">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
  </Members>
</Type>