<Type Name="EventSourceCreationData" FullName="System.Diagnostics.EventSourceCreationData">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="cc5fb64c08e7407b6912a57b42da416cf47201c6" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class EventSourceCreationData" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit EventSourceCreationData extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Diagnostics.EventSourceCreationData" />
  <TypeSignature Language="VB.NET" Value="Public Class EventSourceCreationData" />
  <TypeSignature Language="C++ CLI" Value="public ref class EventSourceCreationData" />
  <AssemblyInfo>
    <AssemblyName>System</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="8d257-101">表示用於在本機電腦或遠端電腦上建立事件記錄檔來源的組態設定。</span>
      <span class="sxs-lookup">
        <span data-stu-id="8d257-101">Represents the configuration settings used to create an event log source on the local computer or a remote computer.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="8d257-102">使用<xref:System.Diagnostics.EventSourceCreationData>類別來設定當地語系化的項目寫入事件記錄檔的新來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-102">Use the <xref:System.Diagnostics.EventSourceCreationData> class to configure a new source for writing localized entries to an event log.</span></span> <span data-ttu-id="8d257-103">您不需要使用這個類別來讀取事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-103">It is not necessary to use this class to read from an event log.</span></span>  
  
 <span data-ttu-id="8d257-104">這個類別會定義新的事件來源和其相關聯的事件記錄檔的組態設定。</span><span class="sxs-lookup"><span data-stu-id="8d257-104">This class defines the configuration settings for a new event source and its associated event log.</span></span> <span data-ttu-id="8d257-105">相關聯的事件記錄檔可以是本機電腦或遠端電腦上。</span><span class="sxs-lookup"><span data-stu-id="8d257-105">The associated event log can be on the local computer or a remote computer.</span></span> <span data-ttu-id="8d257-106">若要建立新的或現有的事件記錄檔的新來源在本機電腦上，設定<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>和<xref:System.Diagnostics.EventSourceCreationData.Source%2A>屬性<xref:System.Diagnostics.EventSourceCreationData>呼叫<xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="8d257-106">To create a new source for a new or existing event log on the local computer, set the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> and <xref:System.Diagnostics.EventSourceCreationData.Source%2A> properties of an <xref:System.Diagnostics.EventSourceCreationData> and call the <xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="8d257-107">這個方法會建立您在中指定的事件來源<xref:System.Diagnostics.EventSourceCreationData.Source%2A>屬性和暫存器中指定該事件記錄檔<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>。</span><span class="sxs-lookup"><span data-stu-id="8d257-107">This method creates the event source you specify in the <xref:System.Diagnostics.EventSourceCreationData.Source%2A> property and registers it for the event log specified in <xref:System.Diagnostics.EventSourceCreationData.LogName%2A>.</span></span> <span data-ttu-id="8d257-108">此行為是類似於使用<xref:System.Diagnostics.EventLogInstaller>類別，以註冊事件來源的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-108">This behavior is similar to using the <xref:System.Diagnostics.EventLogInstaller> class to register an event source for an event log.</span></span>  
  
 <span data-ttu-id="8d257-109">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法將事件寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-109">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods to write events to an event log.</span></span> <span data-ttu-id="8d257-110">您必須指定事件來源寫入事件。您必須建立並設定事件來源寫入來源的第一個項目之前。</span><span class="sxs-lookup"><span data-stu-id="8d257-110">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="8d257-111">在您的應用程式的安裝期間建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-111">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="8d257-112">這可讓作業系統重新整理其已註冊的事件來源的清單和其設定的時間。</span><span class="sxs-lookup"><span data-stu-id="8d257-112">This allows time for the operating system to refresh its list of registered event sources and their configurations.</span></span> <span data-ttu-id="8d257-113">如果作業系統不重新整理其事件來源的清單，而且您嘗試寫入的事件，該新的來源寫入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="8d257-113">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="8d257-114">您可以設定新的來源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="8d257-114">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="8d257-115">您必須建立新的事件來源電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="8d257-115">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="8d257-116">您可以建立現有的事件記錄檔或新的事件記錄檔事件來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-116">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="8d257-117">當您建立新的事件記錄檔的新來源時，系統會註冊為該記錄檔中，來源，但寫入第一個項目之前，不會建立記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-117">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="8d257-118">每個來源只能寫入一個事件記錄檔一次。不過，您的應用程式可以使用多個來源來寫入多個事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-118">Each source can only write to one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="8d257-119">例如，您的應用程式可能需要多個來源設定為不同的事件記錄檔或不同的資源檔案。</span><span class="sxs-lookup"><span data-stu-id="8d257-119">For example, your application might need multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="8d257-120">若要變更現有來源的設定詳細資料，您必須刪除來源，並再建立使用新的設定。</span><span class="sxs-lookup"><span data-stu-id="8d257-120">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="8d257-121">如果其他應用程式或元件使用現有的來源，請使用更新的組態，而不會刪除現有的來源建立新的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-121">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
 <span data-ttu-id="8d257-122">您可以向事件來源的當地語系化資源的事件類別目錄和訊息字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-122">You can register the event source with localized resources for your event category and message strings.</span></span> <span data-ttu-id="8d257-123">您的應用程式可以寫入事件記錄項目使用的資源識別項，而非指定實際的字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-123">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="8d257-124">事件檢視器會尋找並顯示目前的語言設定為基礎的當地語系化的資源檔中的對應字串使用的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="8d257-124">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="8d257-125">您可以註冊的事件類別目錄、 訊息和參數插入字串中，個別的檔案，或您可以註冊相同的資源檔，所有的三種類型的字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-125">You can register a separate file for event categories, messages, and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="8d257-126">使用<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>， <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>， <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>，和<xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>內容來設定要當地語系化的項目寫入事件記錄檔的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-126">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="8d257-127">如果您的應用程式會將字串值，直接寫入事件記錄檔，您不需要設定這些屬性。</span><span class="sxs-lookup"><span data-stu-id="8d257-127">If your application writes string values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="8d257-128">必須設定來源，寫入當地語系化的項目或寫入直接的字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-128">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="8d257-129"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法事件記錄檔中直接寫入指定的字串; 它不會使用可當地語系化的訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-129">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="8d257-130">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法，以使用當地語系化的訊息資源檔寫入事件。</span><span class="sxs-lookup"><span data-stu-id="8d257-130">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="8d257-131">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-131">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="8d257-132">例如，設定一個來源的資源檔，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法來寫入項目使用事件記錄檔的資源識別項。</span><span class="sxs-lookup"><span data-stu-id="8d257-132">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="8d257-133">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將使用該來源的事件記錄檔中直接寫入字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-133">Then create a different source without resource files and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="8d257-134">下列程式碼範例會設定事件來源的組態屬性，從命令列引數。</span><span class="sxs-lookup"><span data-stu-id="8d257-134">The following code example sets the configuration properties for an event source from command-line arguments.</span></span> <span data-ttu-id="8d257-135">輸入引數指定事件來源名稱、 事件記錄檔名稱、 電腦名稱和事件訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-135">The input arguments specify the event source name, event log name, computer name, and event message resource file.</span></span> <span data-ttu-id="8d257-136">程式碼範例會驗證來源與現有的事件來源，不會衝突，並接著會建立新的事件來源指定事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-136">The code example verifies that the source does not conflict with an existing event source, and then creates the new event source for the specified event log.</span></span>  
  
 [!code-cpp[EventLog_EventSourceCreation_Properties#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CPP/source.cpp#1)]
 [!code-csharp[EventLog_EventSourceCreation_Properties#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CS/source.cs#1)]
 [!code-vb[EventLog_EventSourceCreation_Properties#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <permission cref="T:System.Security.Permissions.SecurityPermission">
      <span data-ttu-id="8d257-137">函式呼叫的任何成員<see cref="T:System.Diagnostics.EventSourceCreationData" />以完全信任。</span>
      <span class="sxs-lookup">
        <span data-stu-id="8d257-137">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
      </span>
      <span data-ttu-id="8d257-138">相關聯的列舉型別： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
      <span class="sxs-lookup">
        <span data-stu-id="8d257-138">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
      </span>
    </permission>
    <altmember cref="T:System.Diagnostics.EventLog" />
    <altmember cref="T:System.Diagnostics.EventLogInstaller" />
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventSourceCreationData (string source, string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string source, string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventSourceCreationData.#ctor(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (source As String, logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventSourceCreationData(System::String ^ source, System::String ^ logName);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="8d257-139">使用事件記錄檔登錄作為項目來源的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-139">The name to register with the event log as a source of entries.</span>
          </span>
        </param>
        <param name="logName">
          <span data-ttu-id="8d257-140">來源中的項目要寫入的記錄檔名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-140">The name of the log to which entries from the source are written.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="8d257-141">會利用指定的事件來源和事件記錄檔名稱，初始化 <see cref="T:System.Diagnostics.EventSourceCreationData" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-141">Initializes a new instance of the <see cref="T:System.Diagnostics.EventSourceCreationData" /> class with a specified event source and event log name.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="8d257-142">若要將項目寫入事件記錄檔中，您必須先建立事件記錄檔事件來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-142">To write entries to an event log, you must first create an event source for the event log.</span></span> <span data-ttu-id="8d257-143">若要註冊新的來源，初始化<xref:System.Diagnostics.EventSourceCreationData>執行個體，請設定您的應用程式，以及呼叫的執行個體屬性<xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="8d257-143">To register a new source, initialize an <xref:System.Diagnostics.EventSourceCreationData> instance, configure the instance properties for your application, and call the <xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="8d257-144">來源已登錄之後，您可以寫入項目從來源使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="8d257-144">After the source is registered, you can write entries from the source using the <xref:System.Diagnostics.EventLog.WriteEvent%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods.</span></span>  
  
 <span data-ttu-id="8d257-145">您可以向事件來源的當地語系化資源的事件類別目錄和訊息字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-145">You can register the event source with localized resources for your event category and message strings.</span></span> <span data-ttu-id="8d257-146">您的應用程式可以寫入事件記錄項目使用的資源識別項，而非指定實際的字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-146">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="8d257-147">事件檢視器會尋找並顯示目前的語言設定為基礎的當地語系化的資源檔中的對應字串使用的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="8d257-147">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="8d257-148">您可以註冊的事件類別目錄、 訊息和參數插入字串中，個別的檔案，或您可以註冊相同的資源檔，所有的三種類型的字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-148">You can register a separate file for event categories, messages, and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="8d257-149">使用<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>， <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>， <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>，和<xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>內容來設定要當地語系化的項目寫入事件記錄檔的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-149">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="8d257-150">如果您的應用程式會將字串值，直接寫入事件記錄檔，您不需要設定這些屬性。</span><span class="sxs-lookup"><span data-stu-id="8d257-150">If your application writes string values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="8d257-151">必須設定來源，寫入當地語系化的項目或寫入直接的字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-151">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="8d257-152">如果您的應用程式將使用的資源識別元和字串值的項目寫入，您必須註冊兩個不同的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-152">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="8d257-153">例如，設定一個來源的資源檔，然後使用該來源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法來寫入項目使用事件記錄檔的資源識別項。</span><span class="sxs-lookup"><span data-stu-id="8d257-153">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="8d257-154">然後建立不同的來源，如果沒有資源檔，並使用該來源中的<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法，將字串直接寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-154">Then create a different source without resource files and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log.</span></span>  
  
 <span data-ttu-id="8d257-155">下表顯示的初始屬性值的<xref:System.Diagnostics.EventSourceCreationData>。</span><span class="sxs-lookup"><span data-stu-id="8d257-155">The following table shows initial property values for an <xref:System.Diagnostics.EventSourceCreationData>.</span></span>  
  
|<span data-ttu-id="8d257-156">屬性</span><span class="sxs-lookup"><span data-stu-id="8d257-156">Property</span></span>|<span data-ttu-id="8d257-157">初始值</span><span class="sxs-lookup"><span data-stu-id="8d257-157">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventSourceCreationData.Source%2A>|<span data-ttu-id="8d257-158">`source` 參數。</span><span class="sxs-lookup"><span data-stu-id="8d257-158">The `source` parameter.</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>|<span data-ttu-id="8d257-159">`logName` 參數。</span><span class="sxs-lookup"><span data-stu-id="8d257-159">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.MachineName%2A>|<span data-ttu-id="8d257-160">在本機電腦 ("。")。</span><span class="sxs-lookup"><span data-stu-id="8d257-160">The local computer (".").</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>|<span data-ttu-id="8d257-161">零</span><span class="sxs-lookup"><span data-stu-id="8d257-161">Zero</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>|<span data-ttu-id="8d257-162">`null` (在 Visual Basic 中為 `Nothing`)。</span><span class="sxs-lookup"><span data-stu-id="8d257-162">`null` (`Nothing` in Visual Basic).</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>|<span data-ttu-id="8d257-163">`null` (在 Visual Basic 中為 `Nothing`)。</span><span class="sxs-lookup"><span data-stu-id="8d257-163">`null` (`Nothing` in Visual Basic).</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>|<span data-ttu-id="8d257-164">`null` (在 Visual Basic 中為 `Nothing`)。</span><span class="sxs-lookup"><span data-stu-id="8d257-164">`null` (`Nothing` in Visual Basic).</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="8d257-165">下列程式碼範例會判斷事件來源是否命名`SampleApplicationSource`註冊本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="8d257-165">The following code example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="8d257-166">如果事件來源不存在，此範例會設定為來源的訊息資源檔，並建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-166">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="8d257-167">最後，程式碼範例會設定事件記錄檔，使用中的資源識別碼值的當地語系化的顯示名稱`DisplayNameMsgId`和中的資源檔案路徑`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="8d257-167">Finally, the code example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="8d257-168">程式碼範例會使用下列的訊息文字檔案，內建資源程式庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="8d257-168">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="8d257-169">訊息文字檔案是建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-169">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="8d257-170">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="8d257-170">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="8d257-171">函式呼叫的任何成員<see cref="T:System.Diagnostics.EventSourceCreationData" />以完全信任。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-171">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="8d257-172">相關聯的列舉型別： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-172">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.Source" />
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.LogName" />
      </Docs>
    </Member>
    <Member MemberName="CategoryCount">
      <MemberSignature Language="C#" Value="public int CategoryCount { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 CategoryCount" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.CategoryCount" />
      <MemberSignature Language="VB.NET" Value="Public Property CategoryCount As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int CategoryCount { int get(); void set(int value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="8d257-173">取得或設定分類資源檔中的分類數目。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-173">Gets or sets the number of categories in the category resource file.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="8d257-174">分類資源檔中的分類數目。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-174">The number of categories in the category resource file.</span>
          </span>
          <span data-ttu-id="8d257-175">預設值是零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-175">The default value is zero.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="8d257-176">使用<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>和<xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>来寫入事件的屬性當地語系化類別目錄字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-176">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> and <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> properties to write events with localized category strings.</span></span> <span data-ttu-id="8d257-177">如果您提供類別，當您撰寫事件，事件檢視器顯示事件項目類別。</span><span class="sxs-lookup"><span data-stu-id="8d257-177">The Event Viewer displays the category for an event entry if you supply a category when you write the event.</span></span> <span data-ttu-id="8d257-178">事件記錄檔分類是應用程式定義的字串，用來協助篩選事件，或提供事件的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="8d257-178">Event log categories are application-defined strings that help filter events, or provide further information on the event.</span></span> <span data-ttu-id="8d257-179">例如，您的應用程式可以定義不同的類別，不同的元件或不同的作業。</span><span class="sxs-lookup"><span data-stu-id="8d257-179">For example, your application can define separate categories for different components or different operations.</span></span>  
  
 <span data-ttu-id="8d257-180">事件類別是選擇性的。如果您的應用程式不會使用類別，請勿設定<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>和<xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="8d257-180">Event categories are optional; if your application does not use categories, do not set the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> and <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> properties.</span></span>  
  
 <span data-ttu-id="8d257-181">定義事件訊息及建置事件資源檔的相關詳細資訊，請參閱 「 訊息編譯器 」 中的主題 Platform SDK 文件，網址為[ http://msdn.microsoft.com ](http://msdn.microsoft.com/)。</span><span class="sxs-lookup"><span data-stu-id="8d257-181">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="8d257-182">下列程式碼範例會判斷事件來源是否命名`SampleApplicationSource`註冊本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="8d257-182">The following code example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="8d257-183">如果事件來源不存在，此範例會設定為來源的訊息資源檔，並建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-183">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="8d257-184">最後，程式碼範例會設定事件記錄檔，使用中的資源識別碼值的當地語系化的顯示名稱`DisplayNameMsgId`和中的資源檔案路徑`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="8d257-184">Finally, the code example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="8d257-185">程式碼範例會使用下列的訊息文字檔案，內建資源程式庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="8d257-185">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="8d257-186">訊息文字檔案是建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-186">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="8d257-187">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="8d257-187">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="8d257-188">屬性會設定為負數或設定為大於 <see cref="F:System.UInt16.MaxValue" /> 的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-188">The property is set to a negative value or to a value larger than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="8d257-189">函式呼叫的任何成員<see cref="T:System.Diagnostics.EventSourceCreationData" />以完全信任。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-189">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="8d257-190">相關聯的列舉型別： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-190">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.CategoryResourceFile" />
        <altmember cref="P:System.Diagnostics.EventLogInstaller.CategoryCount" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
      </Docs>
    </Member>
    <Member MemberName="CategoryResourceFile">
      <MemberSignature Language="C#" Value="public string CategoryResourceFile { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string CategoryResourceFile" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.CategoryResourceFile" />
      <MemberSignature Language="VB.NET" Value="Public Property CategoryResourceFile As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ CategoryResourceFile { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="8d257-191">取得或設定資源檔路徑，這個資源檔包含來源的分類字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-191">Gets or sets the path of the resource file that contains category strings for the source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="8d257-192">分類資源檔的路徑。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-192">The path of the category resource file.</span>
          </span>
          <span data-ttu-id="8d257-193">預設為空字串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-193">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="8d257-194">使用<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>和<xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>来寫入事件的屬性當地語系化類別目錄字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-194">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> and <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> properties to write events with localized category strings.</span></span> <span data-ttu-id="8d257-195">如果您提供類別，當您撰寫事件，事件檢視器顯示事件項目類別。</span><span class="sxs-lookup"><span data-stu-id="8d257-195">The Event Viewer displays the category for an event entry if you supply a category when you write the event.</span></span> <span data-ttu-id="8d257-196">事件記錄檔分類是應用程式定義的字串，用來協助篩選事件，或提供事件的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="8d257-196">Event log categories are application-defined strings that help filter events, or provide further information on the event.</span></span> <span data-ttu-id="8d257-197">例如，您的應用程式可以定義不同的類別，不同的元件或不同的作業。</span><span class="sxs-lookup"><span data-stu-id="8d257-197">For example, your application can define separate categories for different components or different operations.</span></span>  
  
 <span data-ttu-id="8d257-198">事件類別是選擇性的。如果您的應用程式不會使用類別，請勿設定<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>和<xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="8d257-198">Event categories are optional; if your application does not use categories, do not set the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> and <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> properties.</span></span>  
  
 <span data-ttu-id="8d257-199">定義事件訊息及建置事件資源檔的相關詳細資訊，請參閱 「 訊息編譯器 」 中的主題 Platform SDK 文件，網址為[ http://msdn.microsoft.com ](http://msdn.microsoft.com/)。</span><span class="sxs-lookup"><span data-stu-id="8d257-199">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="8d257-200">下列程式碼範例會判斷事件來源是否命名`SampleApplicationSource`註冊本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="8d257-200">The following code example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="8d257-201">如果事件來源不存在，此範例會設定為來源的訊息資源檔，並建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-201">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="8d257-202">最後，程式碼範例會設定事件記錄檔，使用中的資源識別碼值的當地語系化的顯示名稱`DisplayNameMsgId`和中的資源檔案路徑`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="8d257-202">Finally, the code example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="8d257-203">程式碼範例會使用下列的訊息文字檔案，內建資源程式庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="8d257-203">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="8d257-204">訊息文字檔案是建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-204">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="8d257-205">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="8d257-205">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="8d257-206">函式呼叫的任何成員<see cref="T:System.Diagnostics.EventSourceCreationData" />以完全信任。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-206">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="8d257-207">相關聯的列舉型別： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-207">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.CategoryCount" />
        <altmember cref="P:System.Diagnostics.EventLogInstaller.CategoryResourceFile" />
      </Docs>
    </Member>
    <Member MemberName="LogName">
      <MemberSignature Language="C#" Value="public string LogName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string LogName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.LogName" />
      <MemberSignature Language="VB.NET" Value="Public Property LogName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ LogName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="8d257-208">取得或設定要讓來源寫入項目的事件記錄檔名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-208">Gets or sets the name of the event log to which the source writes entries.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="8d257-209">事件記錄檔的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-209">The name of the event log.</span>
          </span>
          <span data-ttu-id="8d257-210">這可以是應用程式、系統或自訂的記錄檔名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-210">This can be Application, System, or a custom log name.</span>
          </span>
          <span data-ttu-id="8d257-211">預設值是「應用程式」。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-211">The default value is "Application."</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="8d257-212">使用<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>屬性來識別您的應用程式使用新的來源將項目寫入事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-212">Use the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property to identify the event log that your application writes entries to using the new source.</span></span> <span data-ttu-id="8d257-213">事件記錄檔可以是新的記錄檔或現有的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-213">The event log can be a new log or an existing log.</span></span> <span data-ttu-id="8d257-214">應用程式和服務應該寫入應用程式記錄檔或自訂的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-214">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="8d257-215">裝置驅動程式應該寫入至系統記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-215">Device drivers should write to the System log.</span></span> <span data-ttu-id="8d257-216">如果您沒有明確設定<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>屬性、 事件記錄檔預設值為應用程式記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-216">If you do not explicitly set the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property, the event log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="8d257-217">安全性記錄檔為唯讀。</span><span class="sxs-lookup"><span data-stu-id="8d257-217">The Security log is read-only.</span></span>  
  
 <span data-ttu-id="8d257-218">若要以新來源的現有記錄檔為目標，設定<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>屬性設為現有的事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="8d257-218">To target an existing log for the new source, set the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property to the existing event log name.</span></span> <span data-ttu-id="8d257-219">若要建立新的事件記錄檔的來源，您必須設定<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="8d257-219">To create a new event log for the source, you must set the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property.</span></span> <span data-ttu-id="8d257-220">事件記錄檔名稱必須由可列印字元組成，不得包括字元 '\*'、'?' 或 '\\'。</span><span class="sxs-lookup"><span data-stu-id="8d257-220">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span></span> <span data-ttu-id="8d257-221">事件記錄檔名稱的前 8 個字元必須是不同的事件記錄檔指定的電腦上的現有名稱的前 8 個字元。</span><span class="sxs-lookup"><span data-stu-id="8d257-221">The first 8 characters of the event log name must be different from the first 8 characters of existing names of event logs on the specified computer.</span></span>  
  
 <span data-ttu-id="8d257-222">作業系統會將事件記錄檔儲存為檔案。</span><span class="sxs-lookup"><span data-stu-id="8d257-222">The operating system stores event logs as files.</span></span> <span data-ttu-id="8d257-223">當您使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法來建立新的事件記錄檔，相關聯的檔案會儲存在指定的電腦上的 %SystemRoot%\System32\Config 目錄。</span><span class="sxs-lookup"><span data-stu-id="8d257-223">When you use <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="8d257-224">檔案名稱由所附加的前 8 個字元設定<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>副檔名".evt"檔案名稱的屬性。</span><span class="sxs-lookup"><span data-stu-id="8d257-224">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property with the ".evt" file name extension.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="8d257-225">下列程式碼範例會設定事件來源的組態屬性，從命令列引數。</span><span class="sxs-lookup"><span data-stu-id="8d257-225">The following code example sets the configuration properties for an event source from command-line arguments.</span></span> <span data-ttu-id="8d257-226">輸入引數指定事件來源名稱、 事件記錄檔名稱、 電腦名稱和事件訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-226">The input arguments specify the event source name, event log name, computer name, and event message resource file.</span></span> <span data-ttu-id="8d257-227">這個範例是針對所提供之較大範例的一部分<xref:System.Diagnostics.EventSourceCreationData>類別。</span><span class="sxs-lookup"><span data-stu-id="8d257-227">This example is part of a larger example provided for the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 [!code-cpp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CPP/source.cpp#2)]
 [!code-csharp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CS/source.cs#2)]
 [!code-vb[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="8d257-228">函式呼叫的任何成員<see cref="T:System.Diagnostics.EventSourceCreationData" />以完全信任。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-228">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="8d257-229">相關聯的列舉型別： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-229">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLogInstaller.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="8d257-230">取得或設定要註冊事件來源的電腦名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-230">Gets or sets the name of the computer on which to register the event source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="8d257-231">要註冊事件來源的系統名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-231">The name of the system on which to register the event source.</span>
          </span>
          <span data-ttu-id="8d257-232">預設值是本機電腦 (".")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-232">The default is the local computer (".").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="8d257-233"><xref:System.Diagnostics.EventSourceCreationData.MachineName%2A>值不可為空字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-233">The <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> value cannot be an empty string.</span></span> <span data-ttu-id="8d257-234">若未明確設定的電腦名稱，則預設為本機電腦 ("。")。</span><span class="sxs-lookup"><span data-stu-id="8d257-234">If the machine name is not explicitly set, it defaults to the local computer (".").</span></span>  
  
 <span data-ttu-id="8d257-235">註冊時在遠端電腦上的來源，您必須具有足夠權限的登錄值寫入該電腦上具有系統管理權限。</span><span class="sxs-lookup"><span data-stu-id="8d257-235">When registering a source on a remote computer, you must have administrative rights on that computer to write the registry values with sufficient permissions.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="8d257-236">下列程式碼範例會設定事件來源的組態屬性，從命令列引數。</span><span class="sxs-lookup"><span data-stu-id="8d257-236">The following code example sets the configuration properties for an event source from command-line arguments.</span></span> <span data-ttu-id="8d257-237">輸入引數指定事件來源名稱、 事件記錄檔名稱、 電腦名稱和事件訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-237">The input arguments specify the event source name, event log name, computer name, and event message resource file.</span></span> <span data-ttu-id="8d257-238">這個範例是針對所提供之較大範例的一部分<xref:System.Diagnostics.EventSourceCreationData>類別。</span><span class="sxs-lookup"><span data-stu-id="8d257-238">This example is part of a larger example provided for the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 [!code-cpp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CPP/source.cpp#2)]
 [!code-csharp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CS/source.cs#2)]
 [!code-vb[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="8d257-239">電腦名稱無效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-239">The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="8d257-240">函式呼叫的任何成員<see cref="T:System.Diagnostics.EventSourceCreationData" />以完全信任。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-240">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="8d257-241">相關聯的列舉型別： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-241">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.Source" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="MessageResourceFile">
      <MemberSignature Language="C#" Value="public string MessageResourceFile { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MessageResourceFile" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.MessageResourceFile" />
      <MemberSignature Language="VB.NET" Value="Public Property MessageResourceFile As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MessageResourceFile { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="8d257-242">取得或設定訊息資源檔路徑，這個資源檔包含來源的訊息格式化字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-242">Gets or sets the path of the message resource file that contains message formatting strings for the source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="8d257-243">訊息資源檔的路徑。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-243">The path of the message resource file.</span>
          </span>
          <span data-ttu-id="8d257-244">預設為空字串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-244">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="8d257-245">使用<xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>設定來將當地語系化的事件訊息寫入事件記錄檔來源的屬性。</span><span class="sxs-lookup"><span data-stu-id="8d257-245">Use the <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> property to configure an event log source to write localized event messages.</span></span> <span data-ttu-id="8d257-246">事件訊息是應用程式定義的字串，描述使用者事件。</span><span class="sxs-lookup"><span data-stu-id="8d257-246">Event messages are application-defined strings that describe the event to the user.</span></span>  
  
 <span data-ttu-id="8d257-247">您的應用程式可以寫入事件記錄檔項目使用資源識別項。</span><span class="sxs-lookup"><span data-stu-id="8d257-247">Your application can write event log entries using resource identifiers.</span></span> <span data-ttu-id="8d257-248">資源識別元索引位於訊息<xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>。</span><span class="sxs-lookup"><span data-stu-id="8d257-248">A resource identifier indexes a message located in the <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>.</span></span> <span data-ttu-id="8d257-249">事件檢視器會尋找並顯示目前的語言設定為基礎的當地語系化的訊息資源檔中的對應字串使用的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="8d257-249">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized message resource file based on current language settings.</span></span>  
  
 <span data-ttu-id="8d257-250">必須設定事件來源，寫入當地語系化的項目或寫入直接的字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-250">The event source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="8d257-251">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法，以撰寫當地語系化的項目，設定與訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-251">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write localized entries for a source configured with a message resource file.</span></span>  
  
 <span data-ttu-id="8d257-252">如果您的應用程式中寫入事件訊息字串直接管理，而不是使用的資源識別項中當地語系化的資源檔，請勿設定<xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="8d257-252">If your application writes event message strings directly, rather than using a resource identifier in a localized resource file, do not set the <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> property.</span></span>  
  
 <span data-ttu-id="8d257-253">定義事件訊息及建置事件資源檔的相關詳細資訊，請參閱 「 訊息編譯器 」 中的主題 Platform SDK 文件，網址為[ http://msdn.microsoft.com ](http://msdn.microsoft.com/)。</span><span class="sxs-lookup"><span data-stu-id="8d257-253">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="8d257-254">下列程式碼範例會判斷事件來源是否命名`SampleApplicationSource`註冊本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="8d257-254">The following code example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="8d257-255">如果事件來源不存在，此範例會設定為來源的訊息資源檔，並建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-255">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="8d257-256">最後，程式碼範例會設定事件記錄檔，使用中的資源識別碼值的當地語系化的顯示名稱`DisplayNameMsgId`和中的資源檔案路徑`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="8d257-256">Finally, the code example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="8d257-257">程式碼範例會使用下列的訊息文字檔案，內建資源程式庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="8d257-257">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="8d257-258">訊息文字檔案是建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-258">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="8d257-259">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="8d257-259">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="8d257-260">函式呼叫的任何成員<see cref="T:System.Diagnostics.EventSourceCreationData" />以完全信任。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-260">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="8d257-261">相關聯的列舉型別： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-261">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLogInstaller.MessageResourceFile" />
      </Docs>
    </Member>
    <Member MemberName="ParameterResourceFile">
      <MemberSignature Language="C#" Value="public string ParameterResourceFile { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ParameterResourceFile" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.ParameterResourceFile" />
      <MemberSignature Language="VB.NET" Value="Public Property ParameterResourceFile As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ParameterResourceFile { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="8d257-262">取得或設定資源檔路徑，這個資源檔包含來源的訊息參數字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-262">Gets or sets the path of the resource file that contains message parameter strings for the source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="8d257-263">參數資源檔的路徑。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-263">The path of the parameter resource file.</span>
          </span>
          <span data-ttu-id="8d257-264">預設為空字串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-264">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="8d257-265">使用<xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>設定事件記錄檔寫入與當地語系化的事件訊息來源的屬性插入參數字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-265">Use the <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> property to configure an event log source to write localized event messages with inserted parameter strings.</span></span> <span data-ttu-id="8d257-266">指定在每個當地語系化的事件訊息<xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>屬性可以包含插入字串的預留位置。</span><span class="sxs-lookup"><span data-stu-id="8d257-266">Each localized event message specified in the <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> property can contain placeholders for insertion strings.</span></span> <span data-ttu-id="8d257-267">這些預留位置用來指定的位置和語言無關的字串，事件訊息中的資源識別項。</span><span class="sxs-lookup"><span data-stu-id="8d257-267">These placeholders are used to specify the position and resource identifier for a language-independent string within the event message.</span></span> <span data-ttu-id="8d257-268">事件檢視器會填入預留位置使用的對應字串<xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>並且針對當地語系化的事件項目將事件記錄檔訊息格式化。</span><span class="sxs-lookup"><span data-stu-id="8d257-268">The Event Viewer fills in the placeholders using the corresponding strings from the <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> and formats the event log message for the localized event entry.</span></span>  
  
 <span data-ttu-id="8d257-269">比方說，訊息的文字檔案的下列區段會定義的參數預留位置的字串：</span><span class="sxs-lookup"><span data-stu-id="8d257-269">For example, the following section of a message text file defines a string with a parameter placeholder:</span></span>  
  
```  
  
MessageId = 1501  
Severity = Success  
Facility = Application  
SymbolicName = COMPONENT_STARTING  
Language=English  
Component %%6050 is starting.  
.  
```  
  
 <span data-ttu-id="8d257-270">在參數資源檔中，插入字串必須定義與資源識別項對應至預留位置，如下所示：</span><span class="sxs-lookup"><span data-stu-id="8d257-270">Within the parameter resource file, the insertion string must be defined with the resource identifier that corresponds to the placeholder, as shown below:</span></span>  
  
```  
MessageId = 6050  
Severity = Success  
Facility = Application  
SymbolicName = COMPONENT_NAME_MSGID  
Language=English  
TRIGGER.EXE  
.  
```  
  
 <span data-ttu-id="8d257-271">必須設定事件來源，寫入當地語系化的項目或寫入直接的字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-271">The event source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="8d257-272">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法，以撰寫當地語系化的項目，設定與訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-272">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write localized entries for a source configured with a message resource file.</span></span>  
  
 <span data-ttu-id="8d257-273">如果您的應用程式會將事件訊息字串直接寫入事件記錄檔，或您<xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>屬性不包含訊息與參數插入預留位置，請勿設定<xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="8d257-273">If your application writes event message strings directly to the event log, or if your <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> property does not contain messages with parameter insertion placeholders, do not set the <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> property.</span></span>  
  
 <span data-ttu-id="8d257-274">定義事件訊息及建置事件資源檔的相關詳細資訊，請參閱 「 訊息編譯器 」 中的主題 Platform SDK 文件，網址為[ http://msdn.microsoft.com ](http://msdn.microsoft.com/)。</span><span class="sxs-lookup"><span data-stu-id="8d257-274">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="8d257-275">下列程式碼範例會判斷事件來源是否命名`SampleApplicationSource`註冊本機電腦上。</span><span class="sxs-lookup"><span data-stu-id="8d257-275">The following code example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="8d257-276">如果事件來源不存在，此範例會設定為來源的訊息資源檔，並建立新的事件來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-276">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="8d257-277">最後，程式碼範例會設定事件記錄檔，使用中的資源識別碼值的當地語系化的顯示名稱`DisplayNameMsgId`和中的資源檔案路徑`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="8d257-277">Finally, the code example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="8d257-278">程式碼範例會使用下列的訊息文字檔案，內建資源程式庫 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="8d257-278">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="8d257-279">訊息文字檔案是建立訊息資源檔的來源。</span><span class="sxs-lookup"><span data-stu-id="8d257-279">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="8d257-280">訊息文字檔案定義的資源識別碼和類別目錄、 事件訊息和參數插入字串的文字。</span><span class="sxs-lookup"><span data-stu-id="8d257-280">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="8d257-281">具體而言，資源識別碼 1004年定義的訊息會使用預留位置為資源識別元 5002 定義的參數字串。</span><span class="sxs-lookup"><span data-stu-id="8d257-281">Specifically, the message defined for resource identifier 1004 uses a placeholder for a parameter string defined for resource identifier 5002.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="8d257-282">函式呼叫的任何成員<see cref="T:System.Diagnostics.EventSourceCreationData" />以完全信任。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-282">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="8d257-283">相關聯的列舉型別： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-283">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLogInstaller.ParameterResourceFile" />
      </Docs>
    </Member>
    <Member MemberName="Source">
      <MemberSignature Language="C#" Value="public string Source { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Source" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.Source" />
      <MemberSignature Language="VB.NET" Value="Public Property Source As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Source { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="8d257-284">取得或設定要使用事件記錄檔登錄為事件來源的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-284">Gets or sets the name to register with the event log as an event source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="8d257-285">使用事件記錄檔登錄作為項目來源的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-285">The name to register with the event log as a source of entries.</span>
          </span>
          <span data-ttu-id="8d257-286">預設為空字串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-286">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="8d257-287">來源名稱通常是應用程式名稱或大型應用程式內的元件名稱。</span><span class="sxs-lookup"><span data-stu-id="8d257-287">The source name is often the name of the application, or the name of a component within a large application.</span></span> <span data-ttu-id="8d257-288"><xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType>方法會使用<xref:System.Diagnostics.EventSourceCreationData.Source%2A>， <xref:System.Diagnostics.EventSourceCreationData.LogName%2A>，和<xref:System.Diagnostics.EventSourceCreationData.MachineName%2A>屬性來建立新的來源和其相關聯的事件記錄檔的目標電腦上的登錄值。</span><span class="sxs-lookup"><span data-stu-id="8d257-288">The <xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType> method uses the <xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A>, and <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> properties to create registry values on the target computer for the new source and its associated event log.</span></span> <span data-ttu-id="8d257-289">新的來源名稱不符合現有的來源名稱或在目標電腦上的現有事件記錄檔名稱。</span><span class="sxs-lookup"><span data-stu-id="8d257-289">A new source name cannot match an existing source name or an existing event log name on the target computer.</span></span>  
  
 <span data-ttu-id="8d257-290">建立來源的登錄值之後，您的應用程式可以使用來源設定的事件記錄檔中寫入項目。</span><span class="sxs-lookup"><span data-stu-id="8d257-290">After the registry values for the source are created, your application can use the source to write entries to the configured event log.</span></span>  
  
 <span data-ttu-id="8d257-291">每個來源只能寫入一個事件記錄檔一次。不過，您的應用程式可以使用多個來源來寫入多個事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-291">Each source can only write to one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="8d257-292">例如，您的應用程式可能需要多個來源設定為不同的事件記錄檔或不同的資源檔案。</span><span class="sxs-lookup"><span data-stu-id="8d257-292">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="8d257-293">下列程式碼範例會設定事件來源的組態屬性，從命令列引數。</span><span class="sxs-lookup"><span data-stu-id="8d257-293">The following code example sets the configuration properties for an event source from command-line arguments.</span></span> <span data-ttu-id="8d257-294">輸入引數指定事件來源名稱、 事件記錄檔名稱、 電腦名稱和事件訊息資源檔。</span><span class="sxs-lookup"><span data-stu-id="8d257-294">The input arguments specify the event source name, event log name, computer name, and event message resource file.</span></span> <span data-ttu-id="8d257-295">這個範例是針對所提供之較大範例的一部分<xref:System.Diagnostics.EventSourceCreationData>類別。</span><span class="sxs-lookup"><span data-stu-id="8d257-295">This example is part of a larger example provided for the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 [!code-cpp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CPP/source.cpp#2)]
 [!code-csharp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CS/source.cs#2)]
 [!code-vb[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="8d257-296">函式呼叫的任何成員<see cref="T:System.Diagnostics.EventSourceCreationData" />以完全信任。</span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-296">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="8d257-297">相關聯的列舉型別： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="8d257-297">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLogInstaller.Source" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
  </Members>
</Type>