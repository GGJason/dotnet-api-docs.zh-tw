<Type Name="IDataEnvironment" FullName="System.ComponentModel.Design.Data.IDataEnvironment">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="a61ff2d6d64dfb5125733eaf76c22f60b93d5ef0" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36709333" />
  </Metadata>
  <TypeSignature Language="C#" Value="public interface IDataEnvironment" />
  <TypeSignature Language="ILAsm" Value=".class public interface auto ansi abstract IDataEnvironment" />
  <TypeSignature Language="DocId" Value="T:System.ComponentModel.Design.Data.IDataEnvironment" />
  <TypeSignature Language="VB.NET" Value="Public Interface IDataEnvironment" />
  <TypeSignature Language="C++ CLI" Value="public interface class IDataEnvironment" />
  <TypeSignature Language="F#" Value="type IDataEnvironment = interface" />
  <AssemblyInfo>
    <AssemblyName>System.Design</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="7b57e-101">定義資料服務的介面，允許控制項設計開發人員將資料存放區或資料庫相關功能整合到設計環境。</span>
      <span class="sxs-lookup">
        <span data-stu-id="7b57e-101">Defines an interface to data services that enables control designers to integrate data store or database-related functionality into their design environment.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7b57e-102">物件，用於實作<xref:System.ComponentModel.Design.Data.IDataEnvironment>介面可以存取應用程式在執行階段可使用的資料連接。</span><span class="sxs-lookup"><span data-stu-id="7b57e-102">An object that implements the <xref:System.ComponentModel.Design.Data.IDataEnvironment> interface can access the data connections available to an application at design time.</span></span> <span data-ttu-id="7b57e-103"><xref:System.ComponentModel.Design.Data.IDataEnvironment>介面提供方法來列出可用的資料連接、 建立新的資料連接、 從連線中，擷取結構描述資訊和應用程式的組態檔中儲存資料連線設定資訊。</span><span class="sxs-lookup"><span data-stu-id="7b57e-103">The <xref:System.ComponentModel.Design.Data.IDataEnvironment> interface provides methods to list available data connections, create new data connections, retrieve schema information from a connection, and save data-connection configuration information to the application's configuration file.</span></span>  
  
 <span data-ttu-id="7b57e-104"><xref:System.ComponentModel.Design.Data.IDataEnvironment>介面可讓您在設計環境中，連接的資料互動，但它並不適合做為資料管理的應用程式開發介面。</span><span class="sxs-lookup"><span data-stu-id="7b57e-104">The <xref:System.ComponentModel.Design.Data.IDataEnvironment> interface enables you to interact with data connections in the design environment, but it is not intended as a data-management API.</span></span>  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName="BuildConnection">
      <MemberSignature Language="C#" Value="public System.ComponentModel.Design.Data.DesignerDataConnection BuildConnection (System.Windows.Forms.IWin32Window owner, System.ComponentModel.Design.Data.DesignerDataConnection initialConnection);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.ComponentModel.Design.Data.DesignerDataConnection BuildConnection(class System.Windows.Forms.IWin32Window owner, class System.ComponentModel.Design.Data.DesignerDataConnection initialConnection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ComponentModel.Design.Data.IDataEnvironment.BuildConnection(System.Windows.Forms.IWin32Window,System.ComponentModel.Design.Data.DesignerDataConnection)" />
      <MemberSignature Language="VB.NET" Value="Public Function BuildConnection (owner As IWin32Window, initialConnection As DesignerDataConnection) As DesignerDataConnection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::ComponentModel::Design::Data::DesignerDataConnection ^ BuildConnection(System::Windows::Forms::IWin32Window ^ owner, System::ComponentModel::Design::Data::DesignerDataConnection ^ initialConnection);" />
      <MemberSignature Language="F#" Value="abstract member BuildConnection : System.Windows.Forms.IWin32Window * System.ComponentModel.Design.Data.DesignerDataConnection -&gt; System.ComponentModel.Design.Data.DesignerDataConnection" Usage="iDataEnvironment.BuildConnection (owner, initialConnection)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Design</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.ComponentModel.Design.Data.DesignerDataConnection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="owner" Type="System.Windows.Forms.IWin32Window" />
        <Parameter Name="initialConnection" Type="System.ComponentModel.Design.Data.DesignerDataConnection" />
      </Parameters>
      <Docs>
        <param name="owner">
          <span data-ttu-id="7b57e-105">連接對話方塊的父視窗。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-105">The parent window for the connection dialog.</span>
          </span>
        </param>
        <param name="initialConnection">
          <span data-ttu-id="7b57e-106">要編輯的連接 (如果有的話)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-106">The connection, if any, to edit.</span>
          </span>
          <span data-ttu-id="7b57e-107">若要建立新連接，<c>initialConnection</c> 應該是 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-107">To create a new connection, <c>initialConnection</c> should be <see langword="null" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7b57e-108">使用設計工具的新連接使用者介面，建立新資料連接或編輯現有的連接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-108">Creates a new data connection or edits an existing connection using the design tool's new connection user interface.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7b57e-109">新的或編輯過的 <see cref="T:System.ComponentModel.Design.Data.DesignerDataConnection" /> 物件，如果使用者取消，則為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-109">A new or edited <see cref="T:System.ComponentModel.Design.Data.DesignerDataConnection" /> object, or <see langword="null" /> if the user canceled.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7b57e-110">使用<xref:System.ComponentModel.Design.Data.IDataEnvironment.BuildConnection%2A>方法來啟動設計環境來建立或編輯資料連接的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="7b57e-110">Use the <xref:System.ComponentModel.Design.Data.IDataEnvironment.BuildConnection%2A> method to activate the design environment's user interface for creating or editing data connections.</span></span> <span data-ttu-id="7b57e-111">如果`initialConnection`參數是`null`，它會指出使用者是否要建立新的連接。</span><span class="sxs-lookup"><span data-stu-id="7b57e-111">If the `initialConnection` parameter is `null`, it indicates the user wants to create a new connection.</span></span> <span data-ttu-id="7b57e-112">如果`initialConnection`參數是<xref:System.ComponentModel.Design.Data.DesignerDataConnection>物件，它會指出使用者想要編輯現有的連接。</span><span class="sxs-lookup"><span data-stu-id="7b57e-112">If the `initialConnection` parameter is a <xref:System.ComponentModel.Design.Data.DesignerDataConnection> object, it indicates the user wants to edit an existing connection.</span></span>  
  
 <span data-ttu-id="7b57e-113">設計環境會負責建立資料連接，將連接加入至連接的全域清單或 Web 應用程式的組態檔，並加入新連接<xref:System.ComponentModel.Design.Data.IDataEnvironment.Connections%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="7b57e-113">Your design environment is responsible for creating the data connection, adding the connection either to a global list of connections or to the Web application's configuration file, and adding the new connection to the <xref:System.ComponentModel.Design.Data.IDataEnvironment.Connections%2A> property.</span></span>  
  
 <span data-ttu-id="7b57e-114">新的連接應該包含應用程式必須在執行階段建立的資料連接的資訊。</span><span class="sxs-lookup"><span data-stu-id="7b57e-114">The new connection should include the information that the application needs to create a data connection at run time.</span></span> <span data-ttu-id="7b57e-115">如果您要在設計環境中使用資料連接，請使用<xref:System.ComponentModel.Design.Data.IDataEnvironment.GetDesignTimeConnection%2A>方法以傳回<xref:System.Data.Common.DbConnection>將設計環境從連線到資料存放區的物件。</span><span class="sxs-lookup"><span data-stu-id="7b57e-115">If you need to use the data connection in the design environment, use the <xref:System.ComponentModel.Design.Data.IDataEnvironment.GetDesignTimeConnection%2A> method to return a <xref:System.Data.Common.DbConnection> object that will connect to the data store from the design environment.</span></span>  
  
 <span data-ttu-id="7b57e-116">如果使用者選擇取消此新的連線建立程序，<xref:System.ComponentModel.Design.Data.IDataEnvironment.BuildConnection%2A>方法應傳回`null`。</span><span class="sxs-lookup"><span data-stu-id="7b57e-116">If the user chooses to cancel the new connection creation process, the <xref:System.ComponentModel.Design.Data.IDataEnvironment.BuildConnection%2A> method should return `null`.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="BuildQuery">
      <MemberSignature Language="C#" Value="public string BuildQuery (System.Windows.Forms.IWin32Window owner, System.ComponentModel.Design.Data.DesignerDataConnection connection, System.ComponentModel.Design.Data.QueryBuilderMode mode, string initialQueryText);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string BuildQuery(class System.Windows.Forms.IWin32Window owner, class System.ComponentModel.Design.Data.DesignerDataConnection connection, valuetype System.ComponentModel.Design.Data.QueryBuilderMode mode, string initialQueryText) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ComponentModel.Design.Data.IDataEnvironment.BuildQuery(System.Windows.Forms.IWin32Window,System.ComponentModel.Design.Data.DesignerDataConnection,System.ComponentModel.Design.Data.QueryBuilderMode,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function BuildQuery (owner As IWin32Window, connection As DesignerDataConnection, mode As QueryBuilderMode, initialQueryText As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ BuildQuery(System::Windows::Forms::IWin32Window ^ owner, System::ComponentModel::Design::Data::DesignerDataConnection ^ connection, System::ComponentModel::Design::Data::QueryBuilderMode mode, System::String ^ initialQueryText);" />
      <MemberSignature Language="F#" Value="abstract member BuildQuery : System.Windows.Forms.IWin32Window * System.ComponentModel.Design.Data.DesignerDataConnection * System.ComponentModel.Design.Data.QueryBuilderMode * string -&gt; string" Usage="iDataEnvironment.BuildQuery (owner, connection, mode, initialQueryText)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Design</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="owner" Type="System.Windows.Forms.IWin32Window" />
        <Parameter Name="connection" Type="System.ComponentModel.Design.Data.DesignerDataConnection" />
        <Parameter Name="mode" Type="System.ComponentModel.Design.Data.QueryBuilderMode" />
        <Parameter Name="initialQueryText" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="owner">
          <span data-ttu-id="7b57e-117">對話方塊的父視窗。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-117">The parent window for the dialog.</span>
          </span>
        </param>
        <param name="connection">
          <span data-ttu-id="7b57e-118">要用於查詢的資料連接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-118">The data connection to use for the query.</span>
          </span>
        </param>
        <param name="mode">
          <span data-ttu-id="7b57e-119">其中一個 <see cref="T:System.ComponentModel.Design.Data.QueryBuilderMode" /> 值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-119">One of the <see cref="T:System.ComponentModel.Design.Data.QueryBuilderMode" /> values.</span>
          </span>
        </param>
        <param name="initialQueryText">
          <span data-ttu-id="7b57e-120">查詢的初始值，<see cref="F:System.String.Empty" /> 表示建立新查詢。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-120">The initial value of the query or <see cref="F:System.String.Empty" /> to create a new query.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7b57e-121">啟動對話方塊以建置 SQL 查詢字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-121">Launches a dialog to build a SQL query string.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7b57e-122">包含 SQL 查詢的字串，如果使用者取消，則為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-122">A string containing the SQL query, or <see langword="null" /> if the user canceled.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7b57e-123"><xref:System.ComponentModel.Design.Data.IDataEnvironment.BuildQuery%2A>方法會啟動編輯或建立 SQL 查詢字串的設計環境的 UI。</span><span class="sxs-lookup"><span data-stu-id="7b57e-123">The <xref:System.ComponentModel.Design.Data.IDataEnvironment.BuildQuery%2A> method launches the design environment's UI for editing or creating SQL query strings.</span></span> <span data-ttu-id="7b57e-124">如果`initialQueryText`參數是<xref:System.String.Empty>，它會指出使用者是否要建立新的查詢。</span><span class="sxs-lookup"><span data-stu-id="7b57e-124">If the `initialQueryText` parameter is <xref:System.String.Empty>, it indicates the user wants to create a new query.</span></span> <span data-ttu-id="7b57e-125">如果`initialQueryText`參數包含字串，表示使用者想要編輯現有的查詢。</span><span class="sxs-lookup"><span data-stu-id="7b57e-125">If the `initialQueryText` parameter contains a string, it indicates the user wants to edit the existing query.</span></span>  
  
 <span data-ttu-id="7b57e-126">`mode`參數表示的使用者想要建置的查詢類型; 請選取、 更新、 插入或刪除。</span><span class="sxs-lookup"><span data-stu-id="7b57e-126">The `mode` parameter indicates the type of query the user wants to build; either select, update, insert, or delete.</span></span> <span data-ttu-id="7b57e-127">可以使用您的使用者介面`mode`設定本身所要的查詢類型，將使用者限制為只針對類型的查詢有需要，請使用有效的 SQL 陳述式和/或驗證查詢對所需的類型參數。</span><span class="sxs-lookup"><span data-stu-id="7b57e-127">Your user interface can use the `mode` parameter to configure itself for the type of query desired, limit the user to using SQL statements valid only for the type of query desired, and/or validate the query against the desired type.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ConfigureConnection">
      <MemberSignature Language="C#" Value="public System.ComponentModel.Design.Data.DesignerDataConnection ConfigureConnection (System.Windows.Forms.IWin32Window owner, System.ComponentModel.Design.Data.DesignerDataConnection connection, string name);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.ComponentModel.Design.Data.DesignerDataConnection ConfigureConnection(class System.Windows.Forms.IWin32Window owner, class System.ComponentModel.Design.Data.DesignerDataConnection connection, string name) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ComponentModel.Design.Data.IDataEnvironment.ConfigureConnection(System.Windows.Forms.IWin32Window,System.ComponentModel.Design.Data.DesignerDataConnection,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ConfigureConnection (owner As IWin32Window, connection As DesignerDataConnection, name As String) As DesignerDataConnection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::ComponentModel::Design::Data::DesignerDataConnection ^ ConfigureConnection(System::Windows::Forms::IWin32Window ^ owner, System::ComponentModel::Design::Data::DesignerDataConnection ^ connection, System::String ^ name);" />
      <MemberSignature Language="F#" Value="abstract member ConfigureConnection : System.Windows.Forms.IWin32Window * System.ComponentModel.Design.Data.DesignerDataConnection * string -&gt; System.ComponentModel.Design.Data.DesignerDataConnection" Usage="iDataEnvironment.ConfigureConnection (owner, connection, name)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Design</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.ComponentModel.Design.Data.DesignerDataConnection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="owner" Type="System.Windows.Forms.IWin32Window" />
        <Parameter Name="connection" Type="System.ComponentModel.Design.Data.DesignerDataConnection" />
        <Parameter Name="name" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="owner">
          <span data-ttu-id="7b57e-128">對話方塊的父視窗 (如果有的話)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-128">The parent window for the dialog, if any.</span>
          </span>
        </param>
        <param name="connection">
          <span data-ttu-id="7b57e-129">
            <see cref="T:System.ComponentModel.Design.Data.DesignerDataConnection" /> 物件，包含所要儲存的連接資料。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-129">A <see cref="T:System.ComponentModel.Design.Data.DesignerDataConnection" /> object containing the connection data to save.</span>
          </span>
        </param>
        <param name="name">
          <span data-ttu-id="7b57e-130">新連接組態項目的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-130">The name of the new connection configuration entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7b57e-131">將連接字串寫入應用程式組態檔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-131">Writes a connection string to the application's configuration file.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7b57e-132">
            <see cref="T:System.ComponentModel.Design.Data.DesignerDataConnection" /> 物件，包含已儲存的連接資料，並且 <see cref="P:System.ComponentModel.Design.Data.DesignerDataConnection.Name" /> 屬性設為 <paramref name="name" />，而 <see cref="P:System.ComponentModel.Design.Data.DesignerDataConnection.IsConfigured" /> 屬性設為 <see langword="true" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-132">A <see cref="T:System.ComponentModel.Design.Data.DesignerDataConnection" /> object containing the saved connection data with the <see cref="P:System.ComponentModel.Design.Data.DesignerDataConnection.Name" /> property set to <paramref name="name" />, and the <see cref="P:System.ComponentModel.Design.Data.DesignerDataConnection.IsConfigured" /> property set to <see langword="true" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7b57e-133"><xref:System.ComponentModel.Design.Data.IDataEnvironment.ConfigureConnection%2A>方法會寫入應用程式的組態檔中的連接。</span><span class="sxs-lookup"><span data-stu-id="7b57e-133">The <xref:System.ComponentModel.Design.Data.IDataEnvironment.ConfigureConnection%2A> method writes a connection to the application's configuration file.</span></span> <span data-ttu-id="7b57e-134">連接字串和提供者名稱會寫入[connectionStrings 項目 （ASP.NET 設定結構描述）](http://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de)名為根據的組態項目`name`參數。</span><span class="sxs-lookup"><span data-stu-id="7b57e-134">The connection string and provider name are written to the [connectionStrings Element (ASP.NET Settings Schema)](http://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de) configuration element named according to the `name` parameter.</span></span> <span data-ttu-id="7b57e-135"><xref:System.ComponentModel.Design.Data.DesignerDataConnection.Name%2A>屬性`connection`參數已忽略。</span><span class="sxs-lookup"><span data-stu-id="7b57e-135">The <xref:System.ComponentModel.Design.Data.DesignerDataConnection.Name%2A> property of the `connection` parameter is ignored.</span></span>  
  
 <span data-ttu-id="7b57e-136">實作<xref:System.ComponentModel.Design.Data.IDataEnvironment.ConfigureConnection%2A>方法應該擲回下列例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7b57e-136">Implementations of the <xref:System.ComponentModel.Design.Data.IDataEnvironment.ConfigureConnection%2A> method should throw the following exceptions.</span></span>  
  
|<span data-ttu-id="7b57e-137">例外</span><span class="sxs-lookup"><span data-stu-id="7b57e-137">Exception</span></span>|<span data-ttu-id="7b57e-138">原因</span><span class="sxs-lookup"><span data-stu-id="7b57e-138">Reason</span></span>|  
|---------------|------------|  
|<xref:System.ArgumentException>|<span data-ttu-id="7b57e-139">應用程式的組態檔中有重複的名稱。</span><span class="sxs-lookup"><span data-stu-id="7b57e-139">A duplicate name exists in the application's configuration file.</span></span>|  
|<span data-ttu-id="7b57e-140"><xref:System.IO.FileNotFoundException><xref:System.UnauthorizedAccessException>，或其他適當的檔案 IO 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7b57e-140"><xref:System.IO.FileNotFoundException>, <xref:System.UnauthorizedAccessException>, or other appropriate file IO exception.</span></span>|<span data-ttu-id="7b57e-141">無法更新應用程式的組態檔。</span><span class="sxs-lookup"><span data-stu-id="7b57e-141">The application's configuration file cannot be updated.</span></span> <span data-ttu-id="7b57e-142">您<xref:System.ComponentModel.Design.Data.IDataEnvironment.ConfigureConnection%2A>方法實作應擲回適當的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7b57e-142">Your <xref:System.ComponentModel.Design.Data.IDataEnvironment.ConfigureConnection%2A> method implementation should throw an appropriate exception.</span></span>|  
|<xref:System.ComponentModel.Design.CheckoutException>|<span data-ttu-id="7b57e-143">應用程式的組態檔無法從原始檔控制系統簽出。</span><span class="sxs-lookup"><span data-stu-id="7b57e-143">The application's configuration file cannot be checked out from the source control system.</span></span>|  
  
 <span data-ttu-id="7b57e-144">請考慮使用中的組態管理 Api<xref:System.Configuration>來讀取和寫入的應用程式組態檔的命名空間。</span><span class="sxs-lookup"><span data-stu-id="7b57e-144">Consider using the configuration-management APIs in the <xref:System.Configuration> namespace to read and write the application's configuration file.</span></span> <span data-ttu-id="7b57e-145"><xref:System.Configuration.ConnectionStringsSection>類別將讀取和寫入[connectionStrings 項目 （ASP.NET 設定結構描述）](http://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de)組態項目。</span><span class="sxs-lookup"><span data-stu-id="7b57e-145">The <xref:System.Configuration.ConnectionStringsSection> class will read and write the [connectionStrings Element (ASP.NET Settings Schema)](http://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de) configuration element.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Connections">
      <MemberSignature Language="C#" Value="public System.Collections.ICollection Connections { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Collections.ICollection Connections" />
      <MemberSignature Language="DocId" Value="P:System.ComponentModel.Design.Data.IDataEnvironment.Connections" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Connections As ICollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Collections::ICollection ^ Connections { System::Collections::ICollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Connections : System.Collections.ICollection" Usage="System.ComponentModel.Design.Data.IDataEnvironment.Connections" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Design</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ICollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="7b57e-146">取得目前設計工作階段中所定義的資料連接集合。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-146">Gets a collection of data connections defined in the current design session.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="7b57e-147">
            <see cref="T:System.ComponentModel.Design.Data.DesignerDataConnection" /> 物件的集合，表示目前設計工作階段中的可用資料連接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-147">A collection of <see cref="T:System.ComponentModel.Design.Data.DesignerDataConnection" /> objects representing the data connections available in the current design session.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7b57e-148"><xref:System.ComponentModel.Design.Data.IDataEnvironment.Connections%2A>屬性會傳回適用於設計階段連接集合。</span><span class="sxs-lookup"><span data-stu-id="7b57e-148">The <xref:System.ComponentModel.Design.Data.IDataEnvironment.Connections%2A> property returns the set of connections available at design time.</span></span> <span data-ttu-id="7b57e-149">實作<xref:System.ComponentModel.Design.Data.IDataEnvironment.Connections%2A>屬性可傳回目前 Web 應用程式中定義連接的清單或在全域層級，例如在設計環境中維護的資料連接的清單定義的連接清單。</span><span class="sxs-lookup"><span data-stu-id="7b57e-149">Your implementation of the <xref:System.ComponentModel.Design.Data.IDataEnvironment.Connections%2A> property can return either the list of connections defined in the current Web application, or a list of connections defined at a global level, such as a list of data connections maintained by the design environment.</span></span>  
  
 <span data-ttu-id="7b57e-150">集合中的每個連接都應該有唯一的連接字串。</span><span class="sxs-lookup"><span data-stu-id="7b57e-150">Each connection in the collection should have a unique connection string.</span></span> <span data-ttu-id="7b57e-151">如果您的集合包含來自應用程式的組態檔的連線和全域連接，您的實作必須處理從全域清單和組態檔的連接上具有相同的連接字串的情況。</span><span class="sxs-lookup"><span data-stu-id="7b57e-151">If your collection includes both connections from the application's configuration file and global connections, your implementation must handle the case where connections from the global list and the configuration file have the same connection string.</span></span> <span data-ttu-id="7b57e-152">在此情況下，建議您排除重複項目，並使用只連線設定檔。</span><span class="sxs-lookup"><span data-stu-id="7b57e-152">In this case, it is recommended that you eliminate duplicates and use the configuration-file connection only.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="GetCodeExpression">
      <MemberSignature Language="C#" Value="public System.CodeDom.CodeExpression GetCodeExpression (System.ComponentModel.Design.Data.DesignerDataConnection connection);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.CodeDom.CodeExpression GetCodeExpression(class System.ComponentModel.Design.Data.DesignerDataConnection connection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ComponentModel.Design.Data.IDataEnvironment.GetCodeExpression(System.ComponentModel.Design.Data.DesignerDataConnection)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetCodeExpression (connection As DesignerDataConnection) As CodeExpression" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::CodeDom::CodeExpression ^ GetCodeExpression(System::ComponentModel::Design::Data::DesignerDataConnection ^ connection);" />
      <MemberSignature Language="F#" Value="abstract member GetCodeExpression : System.ComponentModel.Design.Data.DesignerDataConnection -&gt; System.CodeDom.CodeExpression" Usage="iDataEnvironment.GetCodeExpression connection" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Design</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.CodeDom.CodeExpression</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="connection" Type="System.ComponentModel.Design.Data.DesignerDataConnection" />
      </Parameters>
      <Docs>
        <param name="connection">
          <span data-ttu-id="7b57e-153">從應用程式組態檔中所要擷取的連接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-153">The connection to retrieve from the application's configuration file.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7b57e-154">傳回程式碼運算式，其中包含從應用程式組態檔中擷取連接字串時所需的原始程式碼。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-154">Returns a code expression that contains the source code required to retrieve a connection string from the application's configuration file.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7b57e-155">
            <see cref="T:System.CodeDom.CodeExpression" /> 物件，其中包含從應用程式組態檔中擷取連接字串時所需的原始程式碼。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-155">A <see cref="T:System.CodeDom.CodeExpression" /> object containing the source code required to retrieve a connection string from the application's configuration file.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="GetConnectionSchema">
      <MemberSignature Language="C#" Value="public System.ComponentModel.Design.Data.IDesignerDataSchema GetConnectionSchema (System.ComponentModel.Design.Data.DesignerDataConnection connection);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.ComponentModel.Design.Data.IDesignerDataSchema GetConnectionSchema(class System.ComponentModel.Design.Data.DesignerDataConnection connection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ComponentModel.Design.Data.IDataEnvironment.GetConnectionSchema(System.ComponentModel.Design.Data.DesignerDataConnection)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetConnectionSchema (connection As DesignerDataConnection) As IDesignerDataSchema" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::ComponentModel::Design::Data::IDesignerDataSchema ^ GetConnectionSchema(System::ComponentModel::Design::Data::DesignerDataConnection ^ connection);" />
      <MemberSignature Language="F#" Value="abstract member GetConnectionSchema : System.ComponentModel.Design.Data.DesignerDataConnection -&gt; System.ComponentModel.Design.Data.IDesignerDataSchema" Usage="iDataEnvironment.GetConnectionSchema connection" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Design</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.ComponentModel.Design.Data.IDesignerDataSchema</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="connection" Type="System.ComponentModel.Design.Data.DesignerDataConnection" />
      </Parameters>
      <Docs>
        <param name="connection">
          <span data-ttu-id="7b57e-156">要傳回其結構描述資訊的資料連接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-156">The data connection for which to return schema information.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7b57e-157">取得指定之資料連接的結構描述。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-157">Gets the schema for the specified data connection.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7b57e-158">
            <see cref="T:System.ComponentModel.Design.Data.IDesignerDataSchema" /> 物件，包含指定之資料連接的結構描述資訊，如果沒有可用的結構描述資訊，則為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-158">An <see cref="T:System.ComponentModel.Design.Data.IDesignerDataSchema" /> object containing the schema information for the specified data connection, or <see langword="null" /> if no schema information is available.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7b57e-159"><xref:System.ComponentModel.Design.Data.IDataEnvironment.GetConnectionSchema%2A>方法會傳回指定之資料連接的資料庫結構描述。</span><span class="sxs-lookup"><span data-stu-id="7b57e-159">The <xref:System.ComponentModel.Design.Data.IDataEnvironment.GetConnectionSchema%2A> method returns the database schema for the specified data connection.</span></span> <span data-ttu-id="7b57e-160">如果結構描述無法使用，或連接的提供者無法使用，<xref:System.ComponentModel.Design.Data.IDataEnvironment.GetConnectionSchema%2A>應該傳回`null`。</span><span class="sxs-lookup"><span data-stu-id="7b57e-160">If the schema is unavailable, or if the provider for the connection is unavailable, the <xref:System.ComponentModel.Design.Data.IDataEnvironment.GetConnectionSchema%2A> should return `null`.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="GetDesignTimeConnection">
      <MemberSignature Language="C#" Value="public System.Data.Common.DbConnection GetDesignTimeConnection (System.ComponentModel.Design.Data.DesignerDataConnection connection);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Data.Common.DbConnection GetDesignTimeConnection(class System.ComponentModel.Design.Data.DesignerDataConnection connection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ComponentModel.Design.Data.IDataEnvironment.GetDesignTimeConnection(System.ComponentModel.Design.Data.DesignerDataConnection)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetDesignTimeConnection (connection As DesignerDataConnection) As DbConnection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Data::Common::DbConnection ^ GetDesignTimeConnection(System::ComponentModel::Design::Data::DesignerDataConnection ^ connection);" />
      <MemberSignature Language="F#" Value="abstract member GetDesignTimeConnection : System.ComponentModel.Design.Data.DesignerDataConnection -&gt; System.Data.Common.DbConnection" Usage="iDataEnvironment.GetDesignTimeConnection connection" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Design</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.Common.DbConnection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="connection" Type="System.ComponentModel.Design.Data.DesignerDataConnection" />
      </Parameters>
      <Docs>
        <param name="connection">
          <span data-ttu-id="7b57e-161">所需的資料連接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-161">The desired data connection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="7b57e-162">取得設計階段可使用的資料庫連接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-162">Gets a database connection that can be used at design time.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="7b57e-163">在設計階段可使用的 <see cref="T:System.Data.Common.DbConnection" /> 物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="7b57e-163">A <see cref="T:System.Data.Common.DbConnection" /> object that can be used at design time.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="7b57e-164"><xref:System.ComponentModel.Design.Data.IDataEnvironment.GetDesignTimeConnection%2A>方法會傳回有效，請開啟連接至資料存放區中可用的控制項設計工具。</span><span class="sxs-lookup"><span data-stu-id="7b57e-164">The <xref:System.ComponentModel.Design.Data.IDataEnvironment.GetDesignTimeConnection%2A> method returns a valid, open connection to the data store that can be used by the control designer.</span></span>  
  
 <span data-ttu-id="7b57e-165">控制項設計工具應該使用<xref:System.ComponentModel.Design.Data.IDataEnvironment.GetDesignTimeConnection%2A>取得資料連接和不應嘗試開啟連線，使用<xref:System.ComponentModel.Design.Data.DesignerDataConnection.ConnectionString%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="7b57e-165">Control designers should use the <xref:System.ComponentModel.Design.Data.IDataEnvironment.GetDesignTimeConnection%2A> to obtain a data connection and should not attempt to open a connection using the <xref:System.ComponentModel.Design.Data.DesignerDataConnection.ConnectionString%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>