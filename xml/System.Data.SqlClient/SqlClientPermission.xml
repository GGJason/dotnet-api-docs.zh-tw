<Type Name="SqlClientPermission" FullName="System.Data.SqlClient.SqlClientPermission">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="a3a261d424bc159d60d3f1ab23ad93af0cbb4aa3" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36680288" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class SqlClientPermission : System.Data.Common.DBDataPermission" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi serializable sealed beforefieldinit SqlClientPermission extends System.Data.Common.DBDataPermission" />
  <TypeSignature Language="DocId" Value="T:System.Data.SqlClient.SqlClientPermission" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class SqlClientPermission&#xA;Inherits DBDataPermission" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlClientPermission sealed : System::Data::Common::DBDataPermission" />
  <TypeSignature Language="F#" Value="type SqlClientPermission = class&#xA;    inherit DBDataPermission" />
  <AssemblyInfo>
    <AssemblyName>System.Data</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Security.Permissions</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Data.Common.DBDataPermission</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="018dd-101">使 .NET Framework Data Provider for SQL Server 可以協助確保使用者具有足夠的安全性等級來存取資料來源。</span>
      <span class="sxs-lookup">
        <span data-stu-id="018dd-101">Enables the .NET Framework Data Provider for SQL Server to help make sure that a user has a security level sufficient to access a data source.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="018dd-102"><xref:System.Data.Common.DBDataPermission.IsUnrestricted%2A>屬性會優先於<xref:System.Data.Common.DBDataPermission.AllowBlankPassword%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="018dd-102">The <xref:System.Data.Common.DBDataPermission.IsUnrestricted%2A> property takes precedence over the <xref:System.Data.Common.DBDataPermission.AllowBlankPassword%2A> property.</span></span> <span data-ttu-id="018dd-103">因此，如果您設定<xref:System.Data.Common.DBDataPermission.AllowBlankPassword%2A>至`false`，您也必須設定<xref:System.Data.Common.DBDataPermission.IsUnrestricted%2A>至`false`以防止使用者進行連接，使用空白密碼。</span><span class="sxs-lookup"><span data-stu-id="018dd-103">Therefore, if you set <xref:System.Data.Common.DBDataPermission.AllowBlankPassword%2A> to `false`, you must also set <xref:System.Data.Common.DBDataPermission.IsUnrestricted%2A> to `false` to prevent a user from making a connection using a blank password.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="018dd-104">當使用 ADO.NET 程式碼存取安全性權限，最正確的模式是限制最嚴格的情況下 （完全沒有權限） 開始，然後加入程式碼必須執行之特殊工作所需的特定權限。</span><span class="sxs-lookup"><span data-stu-id="018dd-104">When using code access security permissions for ADO.NET, the correct pattern is to start with the most restrictive case (no permissions at all) and then add the specific permissions that are needed for the particular task that the code needs to perform.</span></span> <span data-ttu-id="018dd-105">相反的模式，以所有權限開始，然後再拒絕特定權限，並不安全，因為有許多方法可表示相同的連接字串。</span><span class="sxs-lookup"><span data-stu-id="018dd-105">The opposite pattern, starting with all permissions and then denying a specific permission, is not secure, because there are many ways of expressing the same connection string.</span></span> <span data-ttu-id="018dd-106">例如，如果您以所有權限開始，然後嘗試拒絕連接字串 "server=someserver" 的用法，您仍可使用 "server=someserver.mycompany.com" 字串。</span><span class="sxs-lookup"><span data-stu-id="018dd-106">For example, if you start with all permissions and then attempt to deny the use of the connection string "server=someserver", the string "server=someserver.mycompany.com" would still be allowed.</span></span> <span data-ttu-id="018dd-107">只要以不授與任何權限開始，您就能減少權限集合具有漏洞的機會。</span><span class="sxs-lookup"><span data-stu-id="018dd-107">By always starting by granting no permissions at all, you reduce the chances that there are holes in the permission set.</span></span>  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="018dd-108">初始化 <see cref="T:System.Data.SqlClient.SqlClientPermission" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-108">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlClientPermission" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlClientPermission ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlClientPermission.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlClientPermission();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Security.Permissions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Obsolete("SqlClientPermission() has been deprecated.  Use the SqlClientPermission(PermissionState.None) constructor.  http://go.microsoft.com/fwlink/?linkid=14202", true)</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="018dd-109">初始化 <see cref="T:System.Data.SqlClient.SqlClientPermission" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-109">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlClientPermission" /> class.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlClientPermission (System.Security.Permissions.PermissionState state);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(valuetype System.Security.Permissions.PermissionState state) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlClientPermission.#ctor(System.Security.Permissions.PermissionState)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (state As PermissionState)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlClientPermission(System::Security::Permissions::PermissionState state);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlClientPermission : System.Security.Permissions.PermissionState -&gt; System.Data.SqlClient.SqlClientPermission" Usage="new System.Data.SqlClient.SqlClientPermission state" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Security.Permissions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="state" Type="System.Security.Permissions.PermissionState" />
      </Parameters>
      <Docs>
        <param name="state">
          <span data-ttu-id="018dd-110">其中一個 <see cref="T:System.Security.Permissions.PermissionState" /> 值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-110">One of the <see cref="T:System.Security.Permissions.PermissionState" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="018dd-111">初始化 <see cref="T:System.Data.SqlClient.SqlClientPermission" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-111">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlClientPermission" /> class.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlClientPermission (System.Security.Permissions.PermissionState state, bool allowBlankPassword);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(valuetype System.Security.Permissions.PermissionState state, bool allowBlankPassword) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlClientPermission.#ctor(System.Security.Permissions.PermissionState,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (state As PermissionState, allowBlankPassword As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlClientPermission(System::Security::Permissions::PermissionState state, bool allowBlankPassword);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlClientPermission : System.Security.Permissions.PermissionState * bool -&gt; System.Data.SqlClient.SqlClientPermission" Usage="new System.Data.SqlClient.SqlClientPermission (state, allowBlankPassword)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Security.Permissions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Obsolete("SqlClientPermission(PermissionState state, Boolean allowBlankPassword) has been deprecated.  Use the SqlClientPermission(PermissionState.None) constructor.  http://go.microsoft.com/fwlink/?linkid=14202", true)</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters>
        <Parameter Name="state" Type="System.Security.Permissions.PermissionState" />
        <Parameter Name="allowBlankPassword" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="state">
          <span data-ttu-id="018dd-112">其中一個 <see cref="T:System.Security.Permissions.PermissionState" /> 值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-112">One of the <see cref="T:System.Security.Permissions.PermissionState" /> values.</span>
          </span>
        </param>
        <param name="allowBlankPassword">
          <span data-ttu-id="018dd-113">指出是否允許空白密碼。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-113">Indicates whether a blank password is allowed.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="018dd-114">初始化 <see cref="T:System.Data.SqlClient.SqlClientPermission" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-114">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlClientPermission" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="018dd-115"><xref:System.Security.Permissions.PermissionState>列舉型別會優先於<xref:System.Data.Common.DBDataPermission.AllowBlankPassword%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="018dd-115">The <xref:System.Security.Permissions.PermissionState> enumeration takes precedence over the <xref:System.Data.Common.DBDataPermission.AllowBlankPassword%2A> property.</span></span> <span data-ttu-id="018dd-116">因此，如果您設定<xref:System.Data.Common.DBDataPermission.AllowBlankPassword%2A>至`false`，您也必須設定<xref:System.Security.Permissions.PermissionState>至`None`以防止使用者進行連接，使用空白密碼。</span><span class="sxs-lookup"><span data-stu-id="018dd-116">Therefore, if you set <xref:System.Data.Common.DBDataPermission.AllowBlankPassword%2A> to `false`, you must also set <xref:System.Security.Permissions.PermissionState> to `None` to prevent a user from making a connection using a blank password.</span></span> <span data-ttu-id="018dd-117">如需示範如何使用安全性要求的範例，請參閱[程式碼存取安全性和 ADO.NET](~/docs/framework/data/adonet/code-access-security.md)。</span><span class="sxs-lookup"><span data-stu-id="018dd-117">For an example demonstrating how to use security demands, see [Code Access Security and ADO.NET](~/docs/framework/data/adonet/code-access-security.md).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Add">
      <MemberSignature Language="C#" Value="public override void Add (string connectionString, string restrictions, System.Data.KeyRestrictionBehavior behavior);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Add(string connectionString, string restrictions, valuetype System.Data.KeyRestrictionBehavior behavior) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlClientPermission.Add(System.String,System.String,System.Data.KeyRestrictionBehavior)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Add (connectionString As String, restrictions As String, behavior As KeyRestrictionBehavior)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Add(System::String ^ connectionString, System::String ^ restrictions, System::Data::KeyRestrictionBehavior behavior);" />
      <MemberSignature Language="F#" Value="override this.Add : string * string * System.Data.KeyRestrictionBehavior -&gt; unit" Usage="sqlClientPermission.Add (connectionString, restrictions, behavior)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Security.Permissions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="connectionString" Type="System.String" />
        <Parameter Name="restrictions" Type="System.String" />
        <Parameter Name="behavior" Type="System.Data.KeyRestrictionBehavior" />
      </Parameters>
      <Docs>
        <param name="connectionString">
          <span data-ttu-id="018dd-118">連接字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-118">The connection string.</span>
          </span>
        </param>
        <param name="restrictions">
          <span data-ttu-id="018dd-119">索引鍵限制。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-119">The key restrictions.</span>
          </span>
        </param>
        <param name="behavior">
          <span data-ttu-id="018dd-120">其中一個 <see cref="T:System.Data.KeyRestrictionBehavior" /> 列舉型別 (Enumeration)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-120">One of the <see cref="T:System.Data.KeyRestrictionBehavior" /> enumerations.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="018dd-121">將新連接字串和一組限制關鍵字加入至 <see cref="T:System.Data.SqlClient.SqlClientPermission" /> 物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-121">Adds a new connection string and a set of restricted keywords to the <see cref="T:System.Data.SqlClient.SqlClientPermission" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="018dd-122">若要設定特定的權限物件所允許的連接字串中使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="018dd-122">Use this method to configure which connection strings are allowed by a particular permission object.</span></span> <span data-ttu-id="018dd-123">如果您想要只允許特定連接字串和其他內容，例如，使用下列程式碼片段：</span><span class="sxs-lookup"><span data-stu-id="018dd-123">For example, use the following code fragment if you want to only allow a specific connection string and nothing else:</span></span>  
  
 `permission.Add("server=MyServer; database=MyDatabase; Integrated Security=true", "", KeyRestrictionBehavior.AllowOnly)`  
  
 <span data-ttu-id="018dd-124">下列範例可讓您使用任何資料庫，但只能在伺服器上名為 MyServer，與任何使用者名稱和密碼組合，並不包含任何其他連接字串關鍵字的連接字串：</span><span class="sxs-lookup"><span data-stu-id="018dd-124">The following example allows connection strings that use any database, but only on the server named MyServer, with any user and password combination and containing no other connection string keywords:</span></span>  
  
 `permission.Add("server=MyServer;", "database=; user id=; password=;", KeyRestrictionBehavior.AllowOnly)`  
  
 <span data-ttu-id="018dd-125">下列範例會使用與上面相同的案例，但允許連線到設定為鏡像伺服器時可以使用容錯移轉夥伴：</span><span class="sxs-lookup"><span data-stu-id="018dd-125">The following example uses the same scenario as above but allows for a failover partner that can be used when connecting to servers configured for mirroring:</span></span>  
  
 `permission.Add("server=MyServer; failover partner=MyMirrorServer", "database=; user id=; password=;", KeyRestrictionBehavior.AllowOnly)`  
  
> [!NOTE]
>  <span data-ttu-id="018dd-126">當使用 ADO.NET 程式碼存取安全性權限，最正確的模式是限制最嚴格的情況下 （完全沒有權限） 開始，然後加入程式碼必須執行之特殊工作所需的特定權限。</span><span class="sxs-lookup"><span data-stu-id="018dd-126">When using code access security permissions for ADO.NET, the correct pattern is to start with the most restrictive case (no permissions at all) and then add the specific permissions that are needed for the particular task that the code needs to perform.</span></span> <span data-ttu-id="018dd-127">相反的模式，以所有權限開始，然後嘗試拒絕特定權限，並不安全，因為有許多方法可表示相同的連接字串。</span><span class="sxs-lookup"><span data-stu-id="018dd-127">The opposite pattern, starting with all permissions and then trying to deny a specific permission, is not secure, because there are many ways of expressing the same connection string.</span></span> <span data-ttu-id="018dd-128">例如，如果您以所有權限開始，然後嘗試拒絕連接字串 "server=someserver" 的用法，您仍可使用 "server=someserver.mycompany.com" 字串。</span><span class="sxs-lookup"><span data-stu-id="018dd-128">For example, if you start with all permissions and then attempt to deny the use of the connection string "server=someserver", the string "server=someserver.mycompany.com" would still be allowed.</span></span> <span data-ttu-id="018dd-129">只要以不授與任何權限開始，您就能減少權限集合具有漏洞的機會。</span><span class="sxs-lookup"><span data-stu-id="018dd-129">By always starting by granting no permissions at all, you reduce the chances that there are holes in the permission set.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Copy">
      <MemberSignature Language="C#" Value="public override System.Security.IPermission Copy ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Security.IPermission Copy() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlClientPermission.Copy" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function Copy () As IPermission" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Security::IPermission ^ Copy();" />
      <MemberSignature Language="F#" Value="override this.Copy : unit -&gt; System.Security.IPermission" Usage="sqlClientPermission.Copy " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Security.Permissions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Security.IPermission</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="018dd-130">傳回 <see cref="T:System.Data.SqlClient.SqlClientPermission" /> 做為 <see cref="T:System.Security.IPermission" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-130">Returns the <see cref="T:System.Data.SqlClient.SqlClientPermission" /> as an <see cref="T:System.Security.IPermission" />.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="018dd-131">目前權限物件的複本。</span>
          <span class="sxs-lookup">
            <span data-stu-id="018dd-131">A copy of the current permission object.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
  </Members>
</Type>