<Type Name="ApplicationDeployment" FullName="System.Deployment.Application.ApplicationDeployment">
  <TypeSignature Language="C#" Value="public sealed class ApplicationDeployment" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ApplicationDeployment extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Deployment.Application.ApplicationDeployment" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class ApplicationDeployment" />
  <TypeSignature Language="C++ CLI" Value="public ref class ApplicationDeployment sealed" />
  <AssemblyInfo>
    <AssemblyName>System.Deployment</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="ceb61-101">支援以程式設計方式更新目前的部署，而且可處理視需要下載檔案的工作。</span><span class="sxs-lookup"><span data-stu-id="ceb61-101">Supports updates of the current deployment programmatically, and handles on-demand downloading of files.</span></span> <span data-ttu-id="ceb61-102">這個類別無法被繼承。</span><span class="sxs-lookup"><span data-stu-id="ceb61-102">This class cannot be inherited.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-103">您可以設定您[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式檢查更新，並安裝它們自動透過`subscription`部署資訊清單的項目。</span><span class="sxs-lookup"><span data-stu-id="ceb61-103">You can configure your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application to check for updates and install them automatically through the `subscription` element of the deployment manifest.</span></span> <span data-ttu-id="ceb61-104">某些應用程式，不過，需要更細微地控制其更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-104">Some applications, however, need finer control over their updates.</span></span> <span data-ttu-id="ceb61-105">您可能想要以程式設計的方式，安裝必要的更新，並提示使用者安裝在方便的選擇性更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-105">You may want to install required updates programmatically, and prompt users to install optional updates at their convenience.</span></span> <span data-ttu-id="ceb61-106">藉由關閉訂用帳戶更新部署資訊清單中，您可以取得應用程式的更新原則的完整的控制權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-106">By turning off subscription updates in the deployment manifest, you can take complete control of your application's update policies.</span></span> <span data-ttu-id="ceb61-107">或者，您可以使用自動訂閱搭配<xref:System.Deployment.Application.ApplicationDeployment>，這可讓[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]定期更新應用程式，但會使用<xref:System.Deployment.Application.ApplicationDeployment>發行後，儘速下載重大更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-107">Alternatively, you can use automatic subscription in conjunction with <xref:System.Deployment.Application.ApplicationDeployment>, which enables [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] to update the application periodically, but uses <xref:System.Deployment.Application.ApplicationDeployment> to download critical updates shortly after they are released.</span></span>  
  
 <span data-ttu-id="ceb61-108">您可以測試是否部署有可用的更新使用<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A>或<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A>方法; 第二個方法會引發<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted>事件成功完成。</span><span class="sxs-lookup"><span data-stu-id="ceb61-108">You can test whether your deployment has an available update by using either the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> or the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> method; the latter method raises the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> event on successful completion.</span></span> <span data-ttu-id="ceb61-109"><xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A> 傳回的更新，例如其版本號碼，以及它是否為目前使用者的必要的更新的重要資訊。</span><span class="sxs-lookup"><span data-stu-id="ceb61-109"><xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A> returns important information about the update, such as its version number and whether it is a required update for current users.</span></span> <span data-ttu-id="ceb61-110">如果有可用的更新，可以安裝使用<xref:System.Deployment.Application.ApplicationDeployment.Update%2A>或<xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>; 第二種方法就會引發<xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted>事件之後的更新安裝已完成。</span><span class="sxs-lookup"><span data-stu-id="ceb61-110">If an update is available, you can install it by using <xref:System.Deployment.Application.ApplicationDeployment.Update%2A> or <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>; the latter method raises the <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> event after installation of the update is complete.</span></span> <span data-ttu-id="ceb61-111">大型的更新，您可以接收進度通知透過<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged>和<xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged>事件，並使用中的資訊<xref:System.ComponentModel.ProgressChangedEventArgs>來通知使用者下載狀態。</span><span class="sxs-lookup"><span data-stu-id="ceb61-111">For large updates, you can receive progress notifications through the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged> and <xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged> events, and use the information in <xref:System.ComponentModel.ProgressChangedEventArgs> to notify the user of the download status.</span></span>  
  
 <span data-ttu-id="ceb61-112">您也可以使用<xref:System.Deployment.Application.ApplicationDeployment>下載大型檔案和隨選的組件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-112">You can also use <xref:System.Deployment.Application.ApplicationDeployment> to download large files and assemblies on demand.</span></span> <span data-ttu-id="ceb61-113">這些檔案必須標示為 「 選用 」 部署的應用程式資訊清單中，讓它們不會在安裝期間下載。</span><span class="sxs-lookup"><span data-stu-id="ceb61-113">These files must be marked as "optional" within the deployment's application manifest so that they are not downloaded during installation.</span></span> <span data-ttu-id="ceb61-114">您也可以使用應用程式的期間下載的檔案在任何時間點<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A>或<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-114">You can download the files at any point during the application's duration by using the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> or the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method.</span></span> <span data-ttu-id="ceb61-115">您可以下載組件，再將它們載入到記憶體所提供的事件處理常式<xref:System.AppDomain.AssemblyResolve>事件<xref:System.AppDomain>類別。</span><span class="sxs-lookup"><span data-stu-id="ceb61-115">You can download assemblies before they are loaded into memory by supplying an event handler for the <xref:System.AppDomain.AssemblyResolve> event on the <xref:System.AppDomain> class.</span></span> <span data-ttu-id="ceb61-116">如需詳細資訊，請參閱[逐步解說：下載組件隨選與 ClickOnce 部署應用程式開發介面使用設計工具](http://msdn.microsoft.com/library/59a0dd5f-1cab-4f2f-b780-0ab7399905d5)。</span><span class="sxs-lookup"><span data-stu-id="ceb61-116">For more information, see [Walkthrough: Downloading Assemblies on Demand with the ClickOnce Deployment API Using the Designer](http://msdn.microsoft.com/library/59a0dd5f-1cab-4f2f-b780-0ab7399905d5).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ceb61-117">如果您更新[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式執行應用程式時，使用者將不會看到更新直到您呼叫<xref:System.Windows.Forms.Application.Restart%2A>方法<xref:System.Windows.Forms.Application>，以關閉應用程式的目前執行的執行個體，並立即重新啟動它。</span><span class="sxs-lookup"><span data-stu-id="ceb61-117">If you update a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application while the application is running, the user will not see the updates until you call the <xref:System.Windows.Forms.Application.Restart%2A> method of the <xref:System.Windows.Forms.Application>, which will close the current running instance of the application and immediately restart it.</span></span>  
  
 <span data-ttu-id="ceb61-118"><xref:System.Deployment.Application.ApplicationDeployment> 沒有公用建構函式。取得內類別的執行個體[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式，透過<xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="ceb61-118"><xref:System.Deployment.Application.ApplicationDeployment> has no public constructor; you obtain instances of the class within a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application through the <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> property.</span></span> <span data-ttu-id="ceb61-119">您使用<xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A>屬性，確認目前的應用程式是[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-119">You use the <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> property to verify that the current application is a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application.</span></span>  
  
 <span data-ttu-id="ceb61-120"><xref:System.Deployment.Application.ApplicationDeployment> 支援更新的檢查，以及下載更新的檔案以非同步方式使用新[事件架構非同步模式概觀](~/docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)，而這會公開為類別事件完成回呼。</span><span class="sxs-lookup"><span data-stu-id="ceb61-120"><xref:System.Deployment.Application.ApplicationDeployment> supports checking for updates and downloading updated files asynchronously by using the new [Event-based Asynchronous Pattern Overview](~/docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md), which exposes completion callbacks as class events.</span></span> <span data-ttu-id="ceb61-121"><xref:System.Deployment.Application.ApplicationDeployment> 啟動和管理執行緒，並傳回正確 UI 執行緒上呼叫您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-121"><xref:System.Deployment.Application.ApplicationDeployment> starts and manages the threads for you, and calls your application back on the correct UI thread.</span></span> <span data-ttu-id="ceb61-122">透過此類別中，您可以更新而無需鎖定應用程式，如此使用者就可以繼續安裝更新時使用。</span><span class="sxs-lookup"><span data-stu-id="ceb61-122">Through this class, you can update without locking up the application, so that the user can continue working while the update installs.</span></span> <span data-ttu-id="ceb61-123">如果在更新發生時，使用者必須停止所有工作，請考慮改為使用同步方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-123">If the user must stop all work while an update takes place, consider using the synchronous methods instead.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ceb61-124">執行非同步的更新需要您的應用程式匯入同時<xref:System.Deployment.Application>和<xref:System.ComponentModel>命名空間。</span><span class="sxs-lookup"><span data-stu-id="ceb61-124">Performing asynchronous updates requires that your application import both the <xref:System.Deployment.Application> and <xref:System.ComponentModel> namespaces.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-125">下列程式碼範例會在應用程式載入時判斷是否有可用的; 新的更新如果必要的更新功能，在程式碼範例會以非同步方式安裝更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-125">The following code example determines at application load time whether a new update is available; if a required update is available, the code example installs the update asynchronously.</span></span> <span data-ttu-id="ceb61-126">此程式碼應該加入至表單，其中包含<xref:System.Windows.Forms.TextBox>名為`downloadStatus`。</span><span class="sxs-lookup"><span data-stu-id="ceb61-126">This code should be added to a form that contains a <xref:System.Windows.Forms.TextBox> named `downloadStatus`.</span></span>  
  
 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName="ActivationUri">
      <MemberSignature Language="C#" Value="public Uri ActivationUri { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Uri ActivationUri" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.ActivationUri" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ActivationUri As Uri" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Uri ^ ActivationUri { Uri ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Uri</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-127">取得用來啟動應用程式部署資訊清單的 URL。</span><span class="sxs-lookup"><span data-stu-id="ceb61-127">Gets the URL used to launch the deployment manifest of the application.</span></span></summary>
        <value><span data-ttu-id="ceb61-128">如果字串長度為零<c>TrustUrlParameters</c>部署資訊清單中的屬性是<see langword="false" />，或如果使用者已經提供開啟部署的 UNC 或已從本機開啟它。</span><span class="sxs-lookup"><span data-stu-id="ceb61-128">A zero-length string if the <c>TrustUrlParameters</c> property in the deployment manifest is <see langword="false" />, or if the user has supplied a UNC to open the deployment or has opened it locally.</span></span> <span data-ttu-id="ceb61-129">否則，傳回值就會是用來啟動應用程式的完整 URL，包括所有參數。</span><span class="sxs-lookup"><span data-stu-id="ceb61-129">Otherwise, the return value is the full URL used to launch the application, including any parameters.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-130">這個屬性會在完全信任和部分信任的應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-130">This property will work in both fully trusted and partially trusted applications.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-131">下列程式碼示範如何使用 URL 參數來擷取<xref:System.Deployment.Application.ApplicationDeployment.ActivationUri%2A>，以及如何使用<xref:System.Web.HttpUtility>類別來安全地剖析查詢字串。</span><span class="sxs-lookup"><span data-stu-id="ceb61-131">The following code shows how to retrieve the URL parameters by using <xref:System.Deployment.Application.ApplicationDeployment.ActivationUri%2A>, and how to use the <xref:System.Web.HttpUtility> class to parse the query string safely.</span></span> <span data-ttu-id="ceb61-132">相同的查詢字串變數的多個項目將會傳回一個項目中合併<xref:System.Collections.Specialized.NameValueCollection>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-132">Multiple occurrences of the same query string variable are consolidated in one entry of the returned <xref:System.Collections.Specialized.NameValueCollection>.</span></span>  
  
 [!code-csharp[ClickOnceQueryString#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceQueryString/CS/Form1.cs#1)]
 [!code-vb[ClickOnceQueryString#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceQueryString/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="CheckForDetailedUpdate">
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ceb61-133">執行與 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" /> 相同的作業，但傳回與可用更新相關的擴充資訊。</span><span class="sxs-lookup"><span data-stu-id="ceb61-133">Performs the same operation as <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />, but returns extended information about the available update.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CheckForDetailedUpdate">
      <MemberSignature Language="C#" Value="public System.Deployment.Application.UpdateCheckInfo CheckForDetailedUpdate ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Deployment.Application.UpdateCheckInfo CheckForDetailedUpdate() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate" />
      <MemberSignature Language="VB.NET" Value="Public Function CheckForDetailedUpdate () As UpdateCheckInfo" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Deployment::Application::UpdateCheckInfo ^ CheckForDetailedUpdate();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.UpdateCheckInfo</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="ceb61-134">執行與 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" /> 相同的作業，但傳回與可用更新相關的擴充資訊。</span><span class="sxs-lookup"><span data-stu-id="ceb61-134">Performs the same operation as <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />, but returns extended information about the available update.</span></span></summary>
        <returns><span data-ttu-id="ceb61-135">可用更新的 <see cref="T:System.Deployment.Application.UpdateCheckInfo" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-135">An <see cref="T:System.Deployment.Application.UpdateCheckInfo" /> for the available update.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-136"><xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A>同步呼叫者可以取得相同的方法可讓擴充使用非同步呼叫者取得的資訊<xref:System.Deployment.Application.CheckForUpdateCompletedEventArgs>類別。</span><span class="sxs-lookup"><span data-stu-id="ceb61-136">The <xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A> method lets synchronous callers get the same extended information that asynchronous callers get using the <xref:System.Deployment.Application.CheckForUpdateCompletedEventArgs> class.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-137">下列程式碼範例使用<xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A>擷取最新的更新資訊。</span><span class="sxs-lookup"><span data-stu-id="ceb61-137">The following code example uses <xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A> to retrieve the information about the latest update.</span></span> <span data-ttu-id="ceb61-138">如果有更新存在，會自動安裝，只有在必要的更新。否則，它會提示使用者。</span><span class="sxs-lookup"><span data-stu-id="ceb61-138">If an update exists, it installs it automatically only if it is a required update; otherwise, it prompts the user.</span></span>  
  
 [!code-cpp[ClickOnceAPI#7](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#7)]
 [!code-csharp[ClickOnceAPI#7](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#7)]
 [!code-vb[ClickOnceAPI#7](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ceb61-139">目前的應用程式並未設定為支援更新，或是有另一個更新檢查作業已在進行中。</span><span class="sxs-lookup"><span data-stu-id="ceb61-139">The current application is either not configured to support updates, or there is another update check operation already in progress.</span></span></exception>
        <exception cref="T:System.Deployment.Application.DeploymentDownloadException"><span data-ttu-id="ceb61-140">無法下載部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="ceb61-140">The deployment manifest cannot be downloaded.</span></span> <span data-ttu-id="ceb61-141">這個例外狀況將顯示在 <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> 事件的 <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> 屬性中。</span><span class="sxs-lookup"><span data-stu-id="ceb61-141">This exception will appear in the <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> property of the <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> event.</span></span></exception>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="ceb61-142">部署資訊清單已損毀。</span><span class="sxs-lookup"><span data-stu-id="ceb61-142">The deployment manifest is corrupted.</span></span> <span data-ttu-id="ceb61-143">在您嘗試將此應用程式部署至使用者電腦時，請重新產生應用程式的部署清單。</span><span class="sxs-lookup"><span data-stu-id="ceb61-143">Regenerate the application's manifest before you attempt to deploy this application to users.</span></span> <span data-ttu-id="ceb61-144">這個例外狀況將顯示在 <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> 事件的 <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> 屬性中。</span><span class="sxs-lookup"><span data-stu-id="ceb61-144">This exception will appear in the <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> property of the <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> event.</span></span></exception>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-145">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-145">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-146">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-146">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="CheckForDetailedUpdate">
      <MemberSignature Language="C#" Value="public System.Deployment.Application.UpdateCheckInfo CheckForDetailedUpdate (bool persistUpdateCheckResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Deployment.Application.UpdateCheckInfo CheckForDetailedUpdate(bool persistUpdateCheckResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Function CheckForDetailedUpdate (persistUpdateCheckResult As Boolean) As UpdateCheckInfo" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Deployment::Application::UpdateCheckInfo ^ CheckForDetailedUpdate(bool persistUpdateCheckResult);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.UpdateCheckInfo</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="persistUpdateCheckResult" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="persistUpdateCheckResult"><span data-ttu-id="ceb61-147">如果是 <see langword="false" />，則會以無訊息模式套用更新，而且不會顯示對話方塊。</span><span class="sxs-lookup"><span data-stu-id="ceb61-147">If <see langword="false" />, the update will be applied silently and no dialog box will be displayed.</span></span></param>
        <summary><span data-ttu-id="ceb61-148">執行與 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" /> 相同的作業，但傳回與可用更新相關的擴充資訊。</span><span class="sxs-lookup"><span data-stu-id="ceb61-148">Performs the same operation as <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />, but returns extended information about the available update.</span></span></summary>
        <returns><span data-ttu-id="ceb61-149">可用更新的 <see cref="T:System.Deployment.Application.UpdateCheckInfo" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-149">An <see cref="T:System.Deployment.Application.UpdateCheckInfo" /> for the available update.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="CheckForUpdate">
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ceb61-150">檢查 <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" />，以判斷是否有新的更新可用。</span><span class="sxs-lookup"><span data-stu-id="ceb61-150">Checks <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> to determine whether a new update is available.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CheckForUpdate">
      <MemberSignature Language="C#" Value="public bool CheckForUpdate ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool CheckForUpdate() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />
      <MemberSignature Language="VB.NET" Value="Public Function CheckForUpdate () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool CheckForUpdate();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="ceb61-151">檢查 <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" />，以判斷是否有新的更新可用。</span><span class="sxs-lookup"><span data-stu-id="ceb61-151">Checks <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> to determine whether a new update is available.</span></span></summary>
        <returns>
          <span data-ttu-id="ceb61-152">如果有新的更新可用則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-152"><see langword="true" /> if a new update is available; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-153"><xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A>方法會比較目前已安裝的部署的版本與版本，請參閱部署資訊清單中指定<xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-153">The <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> method compares the version of the currently installed deployment with the version specified in the deployment manifest found at <xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>.</span></span> <span data-ttu-id="ceb61-154">如果伺服器上的版本是已安裝的版本不同，它會傳回`true`。</span><span class="sxs-lookup"><span data-stu-id="ceb61-154">If the version on the server is different from the installed version, it returns `true`.</span></span>  
  
 <span data-ttu-id="ceb61-155">這個方法會封鎖，直到檢查已完成。</span><span class="sxs-lookup"><span data-stu-id="ceb61-155">This method will block until the check has completed.</span></span> <span data-ttu-id="ceb61-156">若要以非同步方式檢查更新，請使用<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A>方法改為。</span><span class="sxs-lookup"><span data-stu-id="ceb61-156">To check for an update asynchronously, use the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> method instead.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ceb61-157">如果<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A>發現，已有更新可用，並且在使用者選擇不安裝它，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]會提示使用者更新可用的應用程式執行的下一次。</span><span class="sxs-lookup"><span data-stu-id="ceb61-157">If <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> discovers that an update is available, and the user chooses not to install it, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will prompt the user that an update is available the next time the application is run.</span></span> <span data-ttu-id="ceb61-158">沒有任何方法可以停用這個提示。</span><span class="sxs-lookup"><span data-stu-id="ceb61-158">There is no way to disable this prompting.</span></span> <span data-ttu-id="ceb61-159">(如果應用程式是必要的更新，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]它不用提示直接安裝。)</span><span class="sxs-lookup"><span data-stu-id="ceb61-159">(If the application is a required update, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will install it without prompting.)</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-160">下列程式碼範例會檢查應用程式更新。如果有的話，它會安裝它以同步方式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-160">The following code example checks for an application update; if one is available, it installs it synchronously.</span></span>  
  
 [!code-cpp[ClickOnceAPI#5](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#5)]
 [!code-csharp[ClickOnceAPI#5](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#5)]
 [!code-vb[ClickOnceAPI#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ceb61-161">如果您在更新進行中呼叫 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" /> 方法，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 會立即擲回這個例外狀況。</span><span class="sxs-lookup"><span data-stu-id="ceb61-161">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] throws this exception immediately if you call the <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" /> method while an update is already in progress.</span></span></exception>
        <exception cref="T:System.Deployment.Application.DeploymentDownloadException"><span data-ttu-id="ceb61-162">無法下載部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="ceb61-162">The deployment manifest cannot be downloaded.</span></span></exception>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="ceb61-163">部署資訊清單已損毀。</span><span class="sxs-lookup"><span data-stu-id="ceb61-163">The deployment manifest is corrupted.</span></span> <span data-ttu-id="ceb61-164">您可能需要重新部署應用程式以修正這個問題。</span><span class="sxs-lookup"><span data-stu-id="ceb61-164">You will likely need to redeploy the application to fix this problem.</span></span></exception>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-165">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-165">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-166">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-166">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate" />
      </Docs>
    </Member>
    <Member MemberName="CheckForUpdate">
      <MemberSignature Language="C#" Value="public bool CheckForUpdate (bool persistUpdateCheckResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool CheckForUpdate(bool persistUpdateCheckResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Function CheckForUpdate (persistUpdateCheckResult As Boolean) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool CheckForUpdate(bool persistUpdateCheckResult);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="persistUpdateCheckResult" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="persistUpdateCheckResult"><span data-ttu-id="ceb61-167">如果是 <see langword="false" />，則會以無訊息模式套用更新，而且不會顯示對話方塊。</span><span class="sxs-lookup"><span data-stu-id="ceb61-167">If <see langword="false" />, the update will be applied silently and no dialog box will be displayed.</span></span></param>
        <summary><span data-ttu-id="ceb61-168">檢查 <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" />，以判斷是否有新的更新可用。</span><span class="sxs-lookup"><span data-stu-id="ceb61-168">Checks <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> to determine whether a new update is available.</span></span></summary>
        <returns>
          <span data-ttu-id="ceb61-169">如果有新的更新可用則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-169"><see langword="true" /> if a new update is available; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="CheckForUpdateAsync">
      <MemberSignature Language="C#" Value="public void CheckForUpdateAsync ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void CheckForUpdateAsync() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" />
      <MemberSignature Language="VB.NET" Value="Public Sub CheckForUpdateAsync ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CheckForUpdateAsync();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="ceb61-170">以非同步方式檢查 <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" />，以判斷是否有新的更新可用。</span><span class="sxs-lookup"><span data-stu-id="ceb61-170">Checks <see cref="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" /> asynchronously to determine whether a new update is available.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-171"><xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> 立即傳回並啟動個別的執行緒以下載更新的應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-171"><xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> returns immediately and starts a separate thread for downloading the updated application.</span></span> <span data-ttu-id="ceb61-172">當方法完成或取消時，便會產生<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted>事件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-172">When the method completes or is canceled, it raises the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> event.</span></span> <span data-ttu-id="ceb61-173">您可以使用<xref:System.ComponentModel.AsyncCompletedEventArgs>中這個事件處理常式，以判斷是否已取消作業，或如果已在更新期間引發例外狀況。</span><span class="sxs-lookup"><span data-stu-id="ceb61-173">You can use <xref:System.ComponentModel.AsyncCompletedEventArgs> in this event handler to determine whether the operation was canceled, or if an exception was raised during update.</span></span>  
  
 <span data-ttu-id="ceb61-174">您可以藉由呼叫取消非同步更新<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsyncCancel%2A>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-174">You can cancel an asynchronous update by calling <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsyncCancel%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ceb61-175">如果<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A>發現，已有更新可用，並且在使用者選擇不安裝它，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]會提示使用者更新可用的應用程式執行的下一次。</span><span class="sxs-lookup"><span data-stu-id="ceb61-175">If <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A> discovers that an update is available, and the user chooses not to install it, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will prompt the user that an update is available the next time the application is run.</span></span> <span data-ttu-id="ceb61-176">沒有任何方法可以停用這個提示。</span><span class="sxs-lookup"><span data-stu-id="ceb61-176">There is no way to disable this prompting.</span></span> <span data-ttu-id="ceb61-177">(如果應用程式是必要的更新，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]它不用提示直接安裝。)</span><span class="sxs-lookup"><span data-stu-id="ceb61-177">(If the application is a required update, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will install it without prompting.)</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-178">下列範例會以非同步方式檢查更新，並安裝更新，如果有的話。</span><span class="sxs-lookup"><span data-stu-id="ceb61-178">The following example checks for an update asynchronously, and installs the update if one exists.</span></span>  
  
 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ceb61-179">如果您在更新進行中呼叫 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> 方法，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 會立即擲回這個例外狀況。</span><span class="sxs-lookup"><span data-stu-id="ceb61-179">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] throws this exception immediately if you call the <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> method while an update is already in progress.</span></span></exception>
        <exception cref="T:System.Deployment.Application.DeploymentDownloadException"><span data-ttu-id="ceb61-180">無法下載部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="ceb61-180">The deployment manifest cannot be downloaded.</span></span> <span data-ttu-id="ceb61-181">這個例外狀況會出現在 <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> 事件的 <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> 屬性中。</span><span class="sxs-lookup"><span data-stu-id="ceb61-181">This exception appears in the <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> property of the <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> event.</span></span></exception>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="ceb61-182">部署資訊清單已損毀。</span><span class="sxs-lookup"><span data-stu-id="ceb61-182">The deployment manifest is corrupted.</span></span> <span data-ttu-id="ceb61-183">您可能需要重新部署應用程式以修正這個問題。</span><span class="sxs-lookup"><span data-stu-id="ceb61-183">You will likely need to redeploy the application to fix this problem.</span></span> <span data-ttu-id="ceb61-184">這個例外狀況會出現在 <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> 事件的 <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> 屬性中。</span><span class="sxs-lookup"><span data-stu-id="ceb61-184">This exception appears in the <see cref="P:System.ComponentModel.AsyncCompletedEventArgs.Error" /> property of the <see cref="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" /> event.</span></span></exception>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-185">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-185">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-186">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-186">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsyncCancel" />
      </Docs>
    </Member>
    <Member MemberName="CheckForUpdateAsyncCancel">
      <MemberSignature Language="C#" Value="public void CheckForUpdateAsyncCancel ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void CheckForUpdateAsyncCancel() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsyncCancel" />
      <MemberSignature Language="VB.NET" Value="Public Sub CheckForUpdateAsyncCancel ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CheckForUpdateAsyncCancel();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="ceb61-187">取消非同步更新檢查。</span><span class="sxs-lookup"><span data-stu-id="ceb61-187">Cancels the asynchronous update check.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-188">使用這個方法來取消使用起始更新檢查<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-188">Use this method to cancel an update check initiated with the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A> method.</span></span>  
  
 <span data-ttu-id="ceb61-189">這個方法便不會取消任何背景更新，可能已經在進行中，例如啟動訂閱的更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-189">This method will not cancel any background update that may already be in progress, such as an update started as part of a subscription.</span></span> <span data-ttu-id="ceb61-190">如需訂用帳戶的詳細資訊，請參閱[選擇 ClickOnce 更新策略](http://msdn.microsoft.com/library/d8b6e7bb-4ea0-47f3-91cd-48580bdceccc)。</span><span class="sxs-lookup"><span data-stu-id="ceb61-190">For more information about subscriptions, see [Choosing a ClickOnce Update Strategy](http://msdn.microsoft.com/library/d8b6e7bb-4ea0-47f3-91cd-48580bdceccc).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CheckForUpdateCompleted">
      <MemberSignature Language="C#" Value="public event System.Deployment.Application.CheckForUpdateCompletedEventHandler CheckForUpdateCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Deployment.Application.CheckForUpdateCompletedEventHandler CheckForUpdateCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event CheckForUpdateCompleted As CheckForUpdateCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Deployment::Application::CheckForUpdateCompletedEventHandler ^ CheckForUpdateCompleted;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.CheckForUpdateCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-191">在 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> 完成時發生。</span><span class="sxs-lookup"><span data-stu-id="ceb61-191">Occurs when <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> has completed.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-192"><xref:System.Deployment.Application.CheckForUpdateCompletedEventArgs>類別將會通知您，以及其他項目、 更新的版本、 多大的更新時，可用的更新是必要或選擇性。</span><span class="sxs-lookup"><span data-stu-id="ceb61-192">The <xref:System.Deployment.Application.CheckForUpdateCompletedEventArgs> class will tell you, among other things, the version of the update, how large the update is, and whether the available update is required or optional.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-193">下列程式碼範例使用<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted>來決定是否要要求使用者安裝可用的應用程式更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-193">The following code example uses <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> to decide whether to ask the user to install the available application update.</span></span> <span data-ttu-id="ceb61-194">如果更新是強制升級，<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted>事件處理常式不會提示使用者。</span><span class="sxs-lookup"><span data-stu-id="ceb61-194">If the update is a mandatory upgrade, the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateCompleted> event handler does not prompt the user.</span></span> <span data-ttu-id="ceb61-195">這個範例需要您部署包含在 Windows Forms 應用程式<xref:System.Windows.Forms.StatusStrip>控制項，以及此控制項包含<xref:System.Windows.Forms.ToolStripStatusLabel>控制項，名為`downloadStatus`。</span><span class="sxs-lookup"><span data-stu-id="ceb61-195">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`.</span></span>  
  
 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CheckForUpdateProgressChanged">
      <MemberSignature Language="C#" Value="public event System.Deployment.Application.DeploymentProgressChangedEventHandler CheckForUpdateProgressChanged;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Deployment.Application.DeploymentProgressChangedEventHandler CheckForUpdateProgressChanged" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event CheckForUpdateProgressChanged As DeploymentProgressChangedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Deployment::Application::DeploymentProgressChangedEventHandler ^ CheckForUpdateProgressChanged;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.DeploymentProgressChangedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-196">在呼叫 <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> 後有可用的進度更新時發生。</span><span class="sxs-lookup"><span data-stu-id="ceb61-196">Occurs when a progress update is available on a <see cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" /> call.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-197"><xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged> 報表上下載狀態的應用程式的部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="ceb61-197"><xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged> reports on the download status of the application's deployment manifest.</span></span> <span data-ttu-id="ceb61-198">這可以是使用者會透過低速網路連線來下載部署的重要資訊。</span><span class="sxs-lookup"><span data-stu-id="ceb61-198">This can be important information for users who are downloading the deployment over slow network connections.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-199">下列程式碼範例使用<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged>來通知使用者下載部署資訊清單中有多少保留的事件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-199">The following code example uses the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateProgressChanged> event to inform the user how much of the deployment manifest is left to download.</span></span> <span data-ttu-id="ceb61-200">這個範例需要您部署包含在 Windows Forms 應用程式<xref:System.Windows.Forms.StatusStrip>控制項，以及此控制項包含<xref:System.Windows.Forms.ToolStripStatusLabel>控制項，名為`downloadStatus`...</span><span class="sxs-lookup"><span data-stu-id="ceb61-200">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`..</span></span>  
  
 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CurrentDeployment">
      <MemberSignature Language="C#" Value="public static System.Deployment.Application.ApplicationDeployment CurrentDeployment { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Deployment.Application.ApplicationDeployment CurrentDeployment" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.CurrentDeployment" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property CurrentDeployment As ApplicationDeployment" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Deployment::Application::ApplicationDeployment ^ CurrentDeployment { System::Deployment::Application::ApplicationDeployment ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.ApplicationDeployment</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-201">傳回這個部署目前的 <see cref="T:System.Deployment.Application.ApplicationDeployment" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-201">Returns the current <see cref="T:System.Deployment.Application.ApplicationDeployment" /> for this deployment.</span></span></summary>
        <value><span data-ttu-id="ceb61-202">目前的部署。</span><span class="sxs-lookup"><span data-stu-id="ceb61-202">The current deployment.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-203">您無法建立執行個體<xref:System.Deployment.Application.ApplicationDeployment>直接在您的應用程式; 您必須擷取有效的執行個體，透過<xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="ceb61-203">You cannot create instances of <xref:System.Deployment.Application.ApplicationDeployment> directly in your application; you must retrieve a valid instance through the <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> property.</span></span>  
  
 <span data-ttu-id="ceb61-204"><xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A>靜態屬性會使用已部署的應用程式只能從有效[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="ceb61-204">The <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> static property is valid only from within an application that was deployed using [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)].</span></span> <span data-ttu-id="ceb61-205">嘗試從非呼叫這個屬性[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式將會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="ceb61-205">Attempts to call this property from non-[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] applications will throw an exception.</span></span> <span data-ttu-id="ceb61-206">如果您正在開發的應用程式，可能會或可能不會部署使用[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]，使用<xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A>屬性來測試是否為目前的處理序[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-206">If you are developing an application that may or may not be deployed using [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)], use the <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> property to test whether the current program is a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-207">下列程式碼範例會擷取<xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A>和檢查以判斷是否已在過去三天內更新應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-207">The following code example retrieves <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> and checks to determine whether the application has been updated in the past three days.</span></span>  
  
 [!code-cpp[ClickOnceAPI#3](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#3)]
 [!code-csharp[ClickOnceAPI#3](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#3)]
 [!code-vb[ClickOnceAPI#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="ceb61-208">您嘗試從非 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 應用程式呼叫此靜態屬性。</span><span class="sxs-lookup"><span data-stu-id="ceb61-208">You attempted to call this static property from a non-[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application.</span></span></exception>
        <altmember cref="P:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed" />
      </Docs>
    </Member>
    <Member MemberName="CurrentVersion">
      <MemberSignature Language="C#" Value="public Version CurrentVersion { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Version CurrentVersion" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.CurrentVersion" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CurrentVersion As Version" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Version ^ CurrentVersion { Version ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Version</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-209">取得目前執行中應用程式執行個體的部署版本。</span><span class="sxs-lookup"><span data-stu-id="ceb61-209">Gets the version of the deployment for the current running instance of the application.</span></span></summary>
        <value><span data-ttu-id="ceb61-210">目前的部署版本。</span><span class="sxs-lookup"><span data-stu-id="ceb61-210">The current deployment version.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-211"><xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A> 將不同<xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A>如果已安裝新的更新，但尚未呼叫<xref:System.Windows.Forms.Application.Restart%2A>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-211"><xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A> will differ from <xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A> if a new update has been installed but you have not yet called <xref:System.Windows.Forms.Application.Restart%2A>.</span></span> <span data-ttu-id="ceb61-212">如果為執行自動更新設定部署資訊清單，您可以比較這兩個值來判斷如果應該重新啟動應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-212">If the deployment manifest is configured to perform automatic updates, you can compare these two values to determine if you should restart the application.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-213">下列程式碼範例會定義方法，決定是否[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]已更新應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-213">The following code example defines a method that determines whether [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] has updated the application.</span></span>  
  
 [!code-cpp[ClickOnceAPI#3](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#3)]
 [!code-csharp[ClickOnceAPI#3](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#3)]
 [!code-vb[ClickOnceAPI#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#3)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-214">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-214">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-215">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-215">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
        <altmember cref="P:System.Deployment.Application.ApplicationDeployment.UpdatedVersion" />
      </Docs>
    </Member>
    <Member MemberName="DataDirectory">
      <MemberSignature Language="C#" Value="public string DataDirectory { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string DataDirectory" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.DataDirectory" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property DataDirectory As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ DataDirectory { System::String ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-216">取得 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 資料目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="ceb61-216">Gets the path to the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] data directory.</span></span></summary>
        <value><span data-ttu-id="ceb61-217">字串，其中含有本機磁碟上應用程式資料目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="ceb61-217">A string containing the path to the application's data directory on the local disk.</span></span></value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="DownloadFileGroup">
      <MemberSignature Language="C#" Value="public void DownloadFileGroup (string groupName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void DownloadFileGroup(string groupName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFileGroup (groupName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFileGroup(System::String ^ groupName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="groupName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="groupName"><span data-ttu-id="ceb61-218">要下載的具名檔案群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-218">The named group of files to download.</span></span> <span data-ttu-id="ceb61-219">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 應用程式中所有標記為 "optional" 的檔案都需要群組名稱。</span><span class="sxs-lookup"><span data-stu-id="ceb61-219">All files marked "optional" in a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application require a group name.</span></span></param>
        <summary><span data-ttu-id="ceb61-220">視需要下載一組選擇性檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-220">Downloads a set of optional files on demand.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-221">在[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式中，在初始化或更新期間將不會下載標示為 「 選用 」 應用程式資訊清單中的檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-221">In a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application, the files marked "optional" in the application manifest are not downloaded during initialization or update.</span></span> <span data-ttu-id="ceb61-222">您可以使用<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A>方法，使它們不會耗用網路資源和磁碟空間之前確定使用者需要這些下載的所有檔案屬於視情況下，具名群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-222">You can use the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> method to download all of the files belonging to a named group on demand, so that they do not consume network resources and disk space until you are sure the user requires them.</span></span> <span data-ttu-id="ceb61-223">例如，某些使用者可能需要使用包含在您的應用程式每日，但是其他使用者可能永遠不會叫用的資料分析封裝。</span><span class="sxs-lookup"><span data-stu-id="ceb61-223">For example, certain users may need to use a data analysis package included in your application on a daily basis, while other users may never invoke it.</span></span>  
  
 <span data-ttu-id="ceb61-224">若要使用您已下載的組件<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A>，附加至事件接聽程式<xref:System.AppDomain.AssemblyResolve>事件<xref:System.AppDomain.CurrentDomain%2A>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-224">To use an assembly you have downloaded with <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A>, you attach an event listener to the <xref:System.AppDomain.AssemblyResolve> event on the <xref:System.AppDomain.CurrentDomain%2A>.</span></span> <span data-ttu-id="ceb61-225">如需範例，請參閱 =[逐步解說： 依 ClickOnce 部署應用程式開發介面使用設計工具的要求下載組件](http://msdn.microsoft.com/library/59a0dd5f-1cab-4f2f-b780-0ab7399905d5)。</span><span class="sxs-lookup"><span data-stu-id="ceb61-225">For an example, see =[Walkthrough: Downloading Assemblies on Demand with the ClickOnce Deployment API Using the Designer](http://msdn.microsoft.com/library/59a0dd5f-1cab-4f2f-b780-0ab7399905d5).</span></span>  
  
 <span data-ttu-id="ceb61-226">所有的檔案會下載到[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式快取且因此隔離的應用程式目前的版本。</span><span class="sxs-lookup"><span data-stu-id="ceb61-226">All files are downloaded to the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application cache and are therefore isolated to the current version of the application.</span></span> <span data-ttu-id="ceb61-227">讓我們假設應用程式下載的檔案群組之後，使用者會安裝新版本的應用程式，但稍後又還原為舊版的應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-227">Let's say that after an application downloads a file group, the user installs a new version of the application, but later reverts to the previous version of the application.</span></span> <span data-ttu-id="ceb61-228">在此情況下，先前的版本仍將保有原先下載的檔案的複本。</span><span class="sxs-lookup"><span data-stu-id="ceb61-228">In this case, the previous version will still have the copies of the files it originally downloaded.</span></span> <span data-ttu-id="ceb61-229">如需有關如何存取資料檔案的詳細資訊，請參閱[存取本機和 ClickOnce 應用程式中的遠端資料](http://msdn.microsoft.com/library/be5cbe12-6cb6-49c9-aa59-a1624e1eef3d)。</span><span class="sxs-lookup"><span data-stu-id="ceb61-229">For more information about accessing data files, see [Accessing Local and Remote Data in ClickOnce Applications](http://msdn.microsoft.com/library/be5cbe12-6cb6-49c9-aa59-a1624e1eef3d).</span></span>  
  
 <span data-ttu-id="ceb61-230"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 在部分信任的應用程式，也就是適用於任何[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式以執行有限的權限。</span><span class="sxs-lookup"><span data-stu-id="ceb61-230"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> works in partially trusted applications, that is, in any [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application running with restricted permission.</span></span> <span data-ttu-id="ceb61-231">不過，如果您嘗試以動態方式載入組件，您的應用程式將需要完全信任。</span><span class="sxs-lookup"><span data-stu-id="ceb61-231">However, if you attempt to load assemblies dynamically, your application will require full trust.</span></span>  
  
 <span data-ttu-id="ceb61-232">目前不支援視需要下載的資料檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-232">On-demand downloading of data files is currently not supported.</span></span>  
  
 <span data-ttu-id="ceb61-233">您的應用程式不會回應使用者輸入，直到<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A>方法會傳回。</span><span class="sxs-lookup"><span data-stu-id="ceb61-233">Your application will not be responsive to user input until the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> method returns.</span></span> <span data-ttu-id="ceb61-234">如果您要下載檔案而不會中斷使用者的工作流程中，使用<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>方法改為。</span><span class="sxs-lookup"><span data-stu-id="ceb61-234">If you need to download files without interrupting the user's workflow, use the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method instead.</span></span>  
  
 <span data-ttu-id="ceb61-235">您無法單獨其檔名下載單一檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-235">You cannot download a single file by its file name alone.</span></span> <span data-ttu-id="ceb61-236">若要下載單一檔案，將其指派的群組名稱您[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]部署及下載群組使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-236">To download a single file, assign it a group name in your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] deployment and download the group using this method.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-237">下列程式碼範例示範如何依需求將組件載入所接聽的<xref:System.AppDomain.AssemblyResolve>事件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-237">The following code example demonstrates how to load an assembly on demand by listening for the <xref:System.AppDomain.AssemblyResolve> event.</span></span>  
  
 [!code-csharp[ClickOnceOnDemandCmdLine#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceOnDemandCmdLine/CS/Form1.cs#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ceb61-238"><paramref name="groupName" /> 參數為 null 或長度為零。</span><span class="sxs-lookup"><span data-stu-id="ceb61-238">The <paramref name="groupName" /> parameter is null or zero-length.</span></span></exception>
        <altmember cref="Overload:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync" />
      </Docs>
    </Member>
    <MemberGroup MemberName="DownloadFileGroupAsync">
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="ceb61-239">視需要在背景中下載一組選擇性檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-239">Downloads, on demand, a set of optional files in the background.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DownloadFileGroupAsync">
      <MemberSignature Language="C#" Value="public void DownloadFileGroupAsync (string groupName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void DownloadFileGroupAsync(string groupName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFileGroupAsync (groupName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFileGroupAsync(System::String ^ groupName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="groupName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="groupName"><span data-ttu-id="ceb61-240">要下載的具名檔案群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-240">The named group of files to download.</span></span> <span data-ttu-id="ceb61-241">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 應用程式中所有標記為 "optional" 的檔案都需要群組名稱。</span><span class="sxs-lookup"><span data-stu-id="ceb61-241">All files marked "optional" in a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application require a group name.</span></span></param>
        <summary><span data-ttu-id="ceb61-242">視需要在背景中下載一組選擇性檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-242">Downloads, on demand, a set of optional files in the background.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-243">在[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式中，在初始化或更新期間將不會下載標示為 「 選用 」 應用程式資訊清單中的檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-243">In a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application, the files marked "optional" in the application manifest are not downloaded during initialization or update.</span></span> <span data-ttu-id="ceb61-244">您可以使用<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>方法，使它們不會耗用網路資源和磁碟空間之前確定使用者需要這些下載的所有檔案屬於視情況下，具名群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-244">You can use the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method to download all of the files belonging to a named group on demand, so that they do not consume network resources and disk space until you are sure the user requires them.</span></span> <span data-ttu-id="ceb61-245">這種方法適用於靜態檔案，不僅應用程式可能不需要的組件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-245">This approach works not only for static files, but also for assemblies that an application may or may not require.</span></span> <span data-ttu-id="ceb61-246">例如，某些使用者可能需要使用包含在您的應用程式每日，但是其他使用者可能永遠不會叫用的資料分析封裝。</span><span class="sxs-lookup"><span data-stu-id="ceb61-246">For example, certain users may need to use a data analysis package included in your application on a daily basis, while other users may never invoke it.</span></span>  
  
 <span data-ttu-id="ceb61-247">若要下載組件，視，附加事件接聽程式<xref:System.AppDomain.AssemblyResolve>事件<xref:System.AppDomain.CurrentDomain%2A>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-247">To download assemblies on demand, attach an event listener to the <xref:System.AppDomain.AssemblyResolve> event on the <xref:System.AppDomain.CurrentDomain%2A>.</span></span> <span data-ttu-id="ceb61-248">如需範例，請參閱[逐步解說： 依 ClickOnce 部署 API 的要求下載組件](http://msdn.microsoft.com/library/d20e2789-8621-4806-b5b7-841122da1456)。</span><span class="sxs-lookup"><span data-stu-id="ceb61-248">For an example, see [Walkthrough: Downloading Assemblies on Demand with the ClickOnce Deployment API](http://msdn.microsoft.com/library/d20e2789-8621-4806-b5b7-841122da1456).</span></span>  
  
 <span data-ttu-id="ceb61-249">所有組件會下載到[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式快取。</span><span class="sxs-lookup"><span data-stu-id="ceb61-249">All assemblies are downloaded to the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application cache.</span></span>  
  
 <span data-ttu-id="ceb61-250">所有靜態檔案會下載到[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式的資料目錄，且會因此隔離的應用程式目前的版本。</span><span class="sxs-lookup"><span data-stu-id="ceb61-250">All static files are downloaded to the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application's data directory and are therefore isolated to the current version of the application.</span></span> <span data-ttu-id="ceb61-251">讓我們假設應用程式下載的檔案群組之後，使用者會安裝新版本的應用程式，但稍後又還原為舊版的應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-251">Let's say that after an application downloads a file group, the user installs a new version of the application, but later reverts to the previous version of the application.</span></span> <span data-ttu-id="ceb61-252">在此情況下，先前的版本仍將保有原先下載的檔案的複本。</span><span class="sxs-lookup"><span data-stu-id="ceb61-252">In this case, the previous version will still have the copies of the files it originally downloaded.</span></span> <span data-ttu-id="ceb61-253">如需存取靜態檔案的詳細資訊，請參閱[存取本機和 ClickOnce 應用程式中的遠端資料](http://msdn.microsoft.com/library/be5cbe12-6cb6-49c9-aa59-a1624e1eef3d)。</span><span class="sxs-lookup"><span data-stu-id="ceb61-253">For more information about accessing static files, see [Accessing Local and Remote Data in ClickOnce Applications](http://msdn.microsoft.com/library/be5cbe12-6cb6-49c9-aa59-a1624e1eef3d).</span></span>  
  
 <span data-ttu-id="ceb61-254">您可以下載多個檔案群組，同時使用<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-254">You can download multiple file groups simultaneously using <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>.</span></span> <span data-ttu-id="ceb61-255">您可以使用來區分其間<xref:System.Deployment.Application.DeploymentProgressChangedEventArgs.Group%2A>屬性<xref:System.Deployment.Application.DeploymentProgressChangedEventArgs>類別，這會傳遞至<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged>事件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-255">You can distinguish among them by using the <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs.Group%2A> property of the <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs> class, which is passed to the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged> event.</span></span> <span data-ttu-id="ceb61-256">如果您需要將更複雜的狀態，您可以使用<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>傳入`state`物件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-256">If you need to pass more complex state, you can use <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> to pass in a `state` object.</span></span>  
  
 <span data-ttu-id="ceb61-257"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 在部分信任的應用程式，也就是適用於任何[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式以執行有限的權限。</span><span class="sxs-lookup"><span data-stu-id="ceb61-257"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> works in partially trusted applications, that is, in any [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application running with restricted permission.</span></span> <span data-ttu-id="ceb61-258">不過，如果您嘗試以動態方式載入組件，您的應用程式將需要完全信任。</span><span class="sxs-lookup"><span data-stu-id="ceb61-258">However, if you are attempting to load assemblies dynamically, your application will require full trust.</span></span>  
  
 <span data-ttu-id="ceb61-259">目前不支援視需要下載的資料檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-259">On-demand downloading of data files is currently not supported.</span></span>  
  
 <span data-ttu-id="ceb61-260">您無法單獨其檔名下載單一檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-260">You cannot download a single file by its file name alone.</span></span> <span data-ttu-id="ceb61-261">若要下載單一檔案，將其指派的群組名稱您[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]部署及下載群組使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-261">To download a single file, assign it a group name in your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] deployment and download the group using this method.</span></span>  
  
 <span data-ttu-id="ceb61-262">若要取消非同步下載，請呼叫<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsyncCancel%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-262">To cancel an asynchronous download, call the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsyncCancel%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ceb61-263"><paramref name="groupName" /> 參數為 null 或長度為零。</span><span class="sxs-lookup"><span data-stu-id="ceb61-263">The <paramref name="groupName" /> parameter is null or zero-length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ceb61-264">您一次無法初始化超過一個 <paramref name="groupName" /> 下載。</span><span class="sxs-lookup"><span data-stu-id="ceb61-264">You cannot initiate more than one download of <paramref name="groupName" /> at a time.</span></span></exception>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFileGroupAsync">
      <MemberSignature Language="C#" Value="public void DownloadFileGroupAsync (string groupName, object userState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void DownloadFileGroupAsync(string groupName, object userState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync(System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFileGroupAsync (groupName As String, userState As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFileGroupAsync(System::String ^ groupName, System::Object ^ userState);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="groupName" Type="System.String" />
        <Parameter Name="userState" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="groupName"><span data-ttu-id="ceb61-265">要下載的具名檔案群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-265">The named group of files to download.</span></span> <span data-ttu-id="ceb61-266">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 應用程式中所有標記為 "optional" 的檔案都需要群組名稱。</span><span class="sxs-lookup"><span data-stu-id="ceb61-266">All files marked "optional" in a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application require a group name.</span></span></param>
        <param name="userState"><span data-ttu-id="ceb61-267">任意物件，包含非同步作業的狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="ceb61-267">An arbitrary object containing state information for the asynchronous operation.</span></span></param>
        <summary><span data-ttu-id="ceb61-268">視需要在背景中下載一組選擇性檔案，並將應用程式狀態傳遞給事件回呼。</span><span class="sxs-lookup"><span data-stu-id="ceb61-268">Downloads, on demand, a set of optional files in the background, and passes a piece of application state to the event callbacks.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-269">在[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式中，在初始化或更新期間將不會下載標示為 「 選用 」 應用程式資訊清單中的檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-269">In a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application, the files marked "optional" in the application manifest are not downloaded during initialization or update.</span></span> <span data-ttu-id="ceb61-270">您可以使用<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>方法，使它們不會耗用網路資源和磁碟空間之前確定使用者需要這些下載的所有檔案屬於視情況下，具名群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-270">You can use the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method to download all of the files belonging to a named group on demand, so that they do not consume network resources and disk space until you are sure the user requires them.</span></span> <span data-ttu-id="ceb61-271">這種方法適用於靜態檔案，不僅應用程式可能不需要的組件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-271">This approach works not only for static files, but also for assemblies that an application may or may not require.</span></span> <span data-ttu-id="ceb61-272">例如，某些使用者可能需要使用包含在您的應用程式每日，但是其他使用者可能永遠不會叫用的資料分析封裝。</span><span class="sxs-lookup"><span data-stu-id="ceb61-272">For example, certain users may need to use a data analysis package included in your application on a daily basis, while other users may never invoke it.</span></span> <span data-ttu-id="ceb61-273">若要下載組件，視，附加事件接聽程式<xref:System.AppDomain.AssemblyResolve>事件<xref:System.AppDomain.CurrentDomain%2A>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-273">To download assemblies on demand, attach an event listener to the <xref:System.AppDomain.AssemblyResolve> event on the <xref:System.AppDomain.CurrentDomain%2A>.</span></span>  
  
 <span data-ttu-id="ceb61-274">您可以同時下載多個檔案群組，使用<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-274">You can download multiple file groups simultaneously by using the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method.</span></span> <span data-ttu-id="ceb61-275">您可以使用來區分其間<xref:System.Deployment.Application.DeploymentProgressChangedEventArgs.Group%2A>屬性<xref:System.Deployment.Application.DeploymentProgressChangedEventArgs>類別，這會傳遞至<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged>事件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-275">You can distinguish among them by using the <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs.Group%2A> property of the <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs> class, which is passed to the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged> event.</span></span> <span data-ttu-id="ceb61-276">如果您需要將更複雜的狀態，您可以使用</span><span class="sxs-lookup"><span data-stu-id="ceb61-276">If you need to pass a more complex state, you can use</span></span>  
  
 <span data-ttu-id="ceb61-277"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> 傳入`state`物件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-277"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> to pass in a `state` object.</span></span>  
  
 <span data-ttu-id="ceb61-278">所有靜態檔案會下載到[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式的資料目錄，且會因此隔離的應用程式目前的版本。</span><span class="sxs-lookup"><span data-stu-id="ceb61-278">All static files are downloaded to the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application's data directory and are therefore isolated to the current version of the application.</span></span> <span data-ttu-id="ceb61-279">如需存取靜態檔案的詳細資訊，請參閱[存取本機和 ClickOnce 應用程式中的遠端資料](http://msdn.microsoft.com/library/be5cbe12-6cb6-49c9-aa59-a1624e1eef3d)。</span><span class="sxs-lookup"><span data-stu-id="ceb61-279">For more information about accessing static files, see [Accessing Local and Remote Data in ClickOnce Applications](http://msdn.microsoft.com/library/be5cbe12-6cb6-49c9-aa59-a1624e1eef3d).</span></span> <span data-ttu-id="ceb61-280">。</span><span class="sxs-lookup"><span data-stu-id="ceb61-280">.</span></span> <span data-ttu-id="ceb61-281">比方說，之後，應用程式下載的檔案群組、 使用者安裝新版的應用程式，但稍後又還原為舊版的應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-281">Let's say that after an application downloads a file group, the user installs a new version of the application, but later  user reverts to the previous version of the application.</span></span> <span data-ttu-id="ceb61-282">在此情況下，先前的版本仍將保有原先下載的檔案的複本。</span><span class="sxs-lookup"><span data-stu-id="ceb61-282">In this case, the previous version will still have the copies of the files it originally downloaded.</span></span>  
  
 <span data-ttu-id="ceb61-283"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> 在部分信任的應用程式，也就是適用於任何[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式以執行有限的權限。</span><span class="sxs-lookup"><span data-stu-id="ceb61-283"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> works in partially trusted applications, that is, in any [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application running with restricted permission.</span></span> <span data-ttu-id="ceb61-284">不過，如果您嘗試以動態方式載入組件，您的應用程式將需要完全信任。</span><span class="sxs-lookup"><span data-stu-id="ceb61-284">However, if you are attempting to load assemblies dynamically, your application will require full trust.</span></span>  
  
 <span data-ttu-id="ceb61-285">目前不支援視需要下載的資料檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-285">On-demand downloading of data files is currently not supported.</span></span>  
  
 <span data-ttu-id="ceb61-286">若要取消非同步下載，請呼叫<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsyncCancel%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-286">To cancel an asynchronous download, call the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsyncCancel%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="ceb61-287"><paramref name="groupName" /> 參數為 null 或長度為零。</span><span class="sxs-lookup"><span data-stu-id="ceb61-287">The <paramref name="groupName" /> parameter is null or zero-length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ceb61-288">您一次無法初始化超過一個 <paramref name="groupName" /> 下載。</span><span class="sxs-lookup"><span data-stu-id="ceb61-288">You cannot initiate more than one download of <paramref name="groupName" /> at a time.</span></span></exception>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFileGroupAsyncCancel">
      <MemberSignature Language="C#" Value="public void DownloadFileGroupAsyncCancel (string groupName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void DownloadFileGroupAsyncCancel(string groupName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsyncCancel(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFileGroupAsyncCancel (groupName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFileGroupAsyncCancel(System::String ^ groupName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="groupName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="groupName"><span data-ttu-id="ceb61-289">要下載的具名檔案群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-289">The named group of files to download.</span></span> <span data-ttu-id="ceb61-290">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 應用程式中所有標記為 "optional" 的檔案都需要群組名稱。</span><span class="sxs-lookup"><span data-stu-id="ceb61-290">All files marked "optional" in a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application require a group name.</span></span></param>
        <summary><span data-ttu-id="ceb61-291">取消非同步檔案下載。</span><span class="sxs-lookup"><span data-stu-id="ceb61-291">Cancels an asynchronous file download.</span></span></summary>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="ceb61-292"><paramref name="groupName" /> 不可以是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-292"><paramref name="groupName" /> cannot be <see langword="null" />.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="DownloadFileGroupCompleted">
      <MemberSignature Language="C#" Value="public event System.Deployment.Application.DownloadFileGroupCompletedEventHandler DownloadFileGroupCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Deployment.Application.DownloadFileGroupCompletedEventHandler DownloadFileGroupCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event DownloadFileGroupCompleted As DownloadFileGroupCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Deployment::Application::DownloadFileGroupCompletedEventHandler ^ DownloadFileGroupCompleted;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.DownloadFileGroupCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-293">在檔案下載完成時，發生在主應用程式執行緒上。</span><span class="sxs-lookup"><span data-stu-id="ceb61-293">Occurs on the main application thread when a file download is complete.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-294"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupCompleted>事件是在執行緒上呼叫主應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-294">The <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupCompleted> event is called on the main application thread.</span></span> <span data-ttu-id="ceb61-295">它是執行緒安全地呼叫直接在這個回呼的應用程式的 Windows Form 控制項。</span><span class="sxs-lookup"><span data-stu-id="ceb61-295">It is thread safe to call your application's Windows Forms controls directly within this callback.</span></span>  
  
 <span data-ttu-id="ceb61-296">請檢查<xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>屬性<xref:System.ComponentModel.AsyncCompletedEventArgs>提供給這個回呼。</span><span class="sxs-lookup"><span data-stu-id="ceb61-296">Check the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of the <xref:System.ComponentModel.AsyncCompletedEventArgs> supplied to this callback.</span></span> <span data-ttu-id="ceb61-297">如果這個屬性是`null`，下載已成功; 如果不是`null`、 安裝並未成功，而且您可以找到有關透過安裝失敗的詳細資訊<xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="ceb61-297">If this property is `null`, the download was successful; if it is not `null`, the installation did not succeed, and you can find more information about the installation failure through the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-298">下列程式碼範例會下載說明檔案，在背景中的群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-298">The following code example downloads a group of Help files in the background.</span></span> <span data-ttu-id="ceb61-299">這個範例需要您部署包含在 Windows Forms 應用程式<xref:System.Windows.Forms.StatusStrip>控制項，以及此控制項包含<xref:System.Windows.Forms.ToolStripStatusLabel>控制項，名為`downloadStatus`...</span><span class="sxs-lookup"><span data-stu-id="ceb61-299">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`..</span></span>  
  
 [!code-cpp[ClickOnceAPI#8](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#8)]
 [!code-csharp[ClickOnceAPI#8](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#8)]
 [!code-vb[ClickOnceAPI#8](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#8)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="DownloadFileGroupProgressChanged">
      <MemberSignature Language="C#" Value="public event System.Deployment.Application.DeploymentProgressChangedEventHandler DownloadFileGroupProgressChanged;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Deployment.Application.DeploymentProgressChangedEventHandler DownloadFileGroupProgressChanged" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event DownloadFileGroupProgressChanged As DeploymentProgressChangedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Deployment::Application::DeploymentProgressChangedEventHandler ^ DownloadFileGroupProgressChanged;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.DeploymentProgressChangedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-300">在檔案下載作業中有可用的狀態資訊時發生，該作業是藉呼叫 <see cref="Overload:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync" /> 來初始化。</span><span class="sxs-lookup"><span data-stu-id="ceb61-300">Occurs when status information is available on a file download operation initiated by a call to <see cref="Overload:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-301"><xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged>事件是在執行緒上呼叫主應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-301">The <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupProgressChanged> event is called on the main application thread.</span></span> <span data-ttu-id="ceb61-302">它是執行緒安全地呼叫直接在這個回呼的應用程式的 Windows Form 控制項。</span><span class="sxs-lookup"><span data-stu-id="ceb61-302">It is thread safe to call your application's Windows Forms controls directly within this callback.</span></span>  
  
 <span data-ttu-id="ceb61-303">使用所提供的資訊<xref:System.Deployment.Application.DeploymentProgressChangedEventArgs>將進度資訊傳達給您的使用者。</span><span class="sxs-lookup"><span data-stu-id="ceb61-303">Use the information supplied in <xref:System.Deployment.Application.DeploymentProgressChangedEventArgs> to communicate progress information to your users.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-304">下列程式碼範例會下載說明檔案，在背景中的群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-304">The following code example downloads a group of Help files in the background.</span></span> <span data-ttu-id="ceb61-305">這個範例需要您部署包含在 Windows Forms 應用程式<xref:System.Windows.Forms.StatusStrip>控制項，以及此控制項包含<xref:System.Windows.Forms.ToolStripStatusLabel>控制項，名為`downloadStatus`。</span><span class="sxs-lookup"><span data-stu-id="ceb61-305">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`.</span></span>  
  
 [!code-cpp[ClickOnceAPI#8](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#8)]
 [!code-csharp[ClickOnceAPI#8](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#8)]
 [!code-vb[ClickOnceAPI#8](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#8)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="IsFileGroupDownloaded">
      <MemberSignature Language="C#" Value="public bool IsFileGroupDownloaded (string groupName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool IsFileGroupDownloaded(string groupName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.IsFileGroupDownloaded(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function IsFileGroupDownloaded (groupName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool IsFileGroupDownloaded(System::String ^ groupName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="groupName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="groupName"><span data-ttu-id="ceb61-306">要下載的具名檔案群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-306">The named group of files to download.</span></span> <span data-ttu-id="ceb61-307">[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 應用程式中所有標記為 "optional" 的檔案都需要群組名稱。</span><span class="sxs-lookup"><span data-stu-id="ceb61-307">All files marked "optional" in a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application require a group name.</span></span></param>
        <summary><span data-ttu-id="ceb61-308">檢查具名檔案群組是否已下載至用戶端電腦。</span><span class="sxs-lookup"><span data-stu-id="ceb61-308">Checks whether the named file group has already been downloaded to the client computer.</span></span></summary>
        <returns>
          <span data-ttu-id="ceb61-309">如果已下載目前應用程式版本的檔案群組則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-309"><see langword="true" /> if the file group has already been downloaded for the current version of this application; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="ceb61-310">如果已安裝新版應用程式，且新版本尚未在檔案群組中加入、移除或改變檔案，則 <see cref="M:System.Deployment.Application.ApplicationDeployment.IsFileGroupDownloaded(System.String)" /> 會傳回 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-310">If a new version of the application has been installed, and the new version has not added, removed, or altered files in the file group, <see cref="M:System.Deployment.Application.ApplicationDeployment.IsFileGroupDownloaded(System.String)" /> returns <see langword="true" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-311"><xref:System.Deployment.Application.ApplicationDeployment.IsFileGroupDownloaded%2A> 適用於在部分信任應用程式中沒有任何安全性要求。</span><span class="sxs-lookup"><span data-stu-id="ceb61-311"><xref:System.Deployment.Application.ApplicationDeployment.IsFileGroupDownloaded%2A> works in a partially trusted application without any security demands.</span></span>  
  
 <span data-ttu-id="ceb61-312">當您更新應用程式，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]將來自舊版本的任何指定資料檔複製到新版本的資料目錄。</span><span class="sxs-lookup"><span data-stu-id="ceb61-312">When you update an application, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] copies any on-demand data files from the previous version into the new version's data directory.</span></span> <span data-ttu-id="ceb61-313">如果您要下載這些檔案的新版本，您應該移除任何您想要防止舊版本，並將它移到新版本的資料。</span><span class="sxs-lookup"><span data-stu-id="ceb61-313">If you download a new version of these files, you should remove any data you want to keep from the old version and move it into the new version.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-314">下列程式碼範例會下載中的所有檔案`HelpFiles`群組至磁碟。</span><span class="sxs-lookup"><span data-stu-id="ceb61-314">The following code example downloads all of the files in the `HelpFiles` group to disk.</span></span>  
  
 [!code-cpp[ClickOnceAPI#8](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#8)]
 [!code-csharp[ClickOnceAPI#8](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#8)]
 [!code-vb[ClickOnceAPI#8](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException">
          <span data-ttu-id="ceb61-315"><paramref name="groupName" /> 不是應用程式資訊清單中所定義的檔案群組。</span><span class="sxs-lookup"><span data-stu-id="ceb61-315"><paramref name="groupName" /> is not a file group defined in the application manifest.</span></span></exception>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup(System.String)" />
        <altmember cref="Overload:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync" />
      </Docs>
    </Member>
    <Member MemberName="IsFirstRun">
      <MemberSignature Language="C#" Value="public bool IsFirstRun { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool IsFirstRun" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.IsFirstRun" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property IsFirstRun As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool IsFirstRun { bool get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-316">取得值，指出這是否是應用程式第一次在用戶端電腦上執行。</span><span class="sxs-lookup"><span data-stu-id="ceb61-316">Gets a value indicating whether this is the first time this application has run on the client computer.</span></span></summary>
        <value>
          <span data-ttu-id="ceb61-317">如果這一版的應用程式從未在用戶端電腦上執行則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-317"><see langword="true" /> if this version of the application has never run on the client computer before; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-318">使用<xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A>來判斷是否需要執行任何一次初始化作業，您的應用程式執行的第一次。</span><span class="sxs-lookup"><span data-stu-id="ceb61-318">Use <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> to determine whether you need to perform any one-time initialization operations the first time your application runs.</span></span>  
  
 <span data-ttu-id="ceb61-319">不要假設<xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A>設定`true`表示應用程式的這個執行個體是第一個對使用者顯示其使用者介面。</span><span class="sxs-lookup"><span data-stu-id="ceb61-319">Do not assume that a <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> setting of `true` indicates that this instance of an application is the first one to show its user interface to the user.</span></span> <span data-ttu-id="ceb61-320">由於系統排程處理序的方式，應用程式的一個執行個體可能包含其<xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A>屬性設定為`true`，但另一個執行個體可能會呈現在螢幕上的第一個。</span><span class="sxs-lookup"><span data-stu-id="ceb61-320">Due to the way the system schedules processes, one instance of the application may have its <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> property set to `true`, but another instance may be the first to render on the screen.</span></span> <span data-ttu-id="ceb61-321">每當使用者將從一個版本升級到下一步 時，會重設這個屬性的值。</span><span class="sxs-lookup"><span data-stu-id="ceb61-321">The value of this property is reset whenever the user upgrades from one version to the next.</span></span> <span data-ttu-id="ceb61-322">如果您想要執行的作業，只有第一個時間的任何版本的應用程式執行，您必須執行額外的測試，例如檢查您建立第一次的檔案是否存在，或儲存旗標，使用**應用程式設定**。</span><span class="sxs-lookup"><span data-stu-id="ceb61-322">If you want to perform an operation only the very first time any version of the application is run, you will need to perform an additional test, such as checking for the existence of a file you created the first time, or storing a flag using **Application Settings**.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-323">下列程式碼範例使用<xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A>來決定是否要檢查的檔案群組的更新`HelpFiles`。</span><span class="sxs-lookup"><span data-stu-id="ceb61-323">The following code example uses <xref:System.Deployment.Application.ApplicationDeployment.IsFirstRun%2A> to decide whether to check for an update to the file group `HelpFiles`.</span></span> <span data-ttu-id="ceb61-324">如果更新一或多個檔案，它會呼叫<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A>來取得新的版本。</span><span class="sxs-lookup"><span data-stu-id="ceb61-324">If one or more of the files have been updated, it calls <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> to obtain the new versions.</span></span>  
  
 [!code-csharp[ClickOnceAPI#9](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#9)]
 [!code-vb[ClickOnceAPI#9](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#9)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-325">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-325">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-326">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-326">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="IsNetworkDeployed">
      <MemberSignature Language="C#" Value="public static bool IsNetworkDeployed { get; }" />
      <MemberSignature Language="ILAsm" Value=".property bool IsNetworkDeployed" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property IsNetworkDeployed As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool IsNetworkDeployed { bool get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-327">取得值，指出目前的應用程式是否為 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-327">Gets a value indicating whether the current application is a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application.</span></span></summary>
        <value>
          <span data-ttu-id="ceb61-328">如果這是 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 應用程式則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-328"><see langword="true" /> if this is a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-329">如果您希望應用程式都可以執行內部和外部[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]（例如，如果您要偵錯應用程式在本機電腦上的部署之前） 的部署、 測試<xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A>存取之前<xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="ceb61-329">If you want your application to run both inside and outside of a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] deployment (for example, if you need to debug your application on the local computer before deploying it), test <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> before accessing the <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> property.</span></span>  
  
 <span data-ttu-id="ceb61-330"><xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> 會傳回`true`不論是否安裝應用程式或裝載於線上，也不論是否已安裝網站、 檔案共用或 CD-ROM。</span><span class="sxs-lookup"><span data-stu-id="ceb61-330"><xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> will return `true` regardless of whether the application is installed or hosted online, and regardless of whether it was installed from a Web site, file share, or CD-ROM.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-331">下列程式碼範例會擷取<xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A>使用<xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A>第一次以確保參考不是`null`。</span><span class="sxs-lookup"><span data-stu-id="ceb61-331">The following code example retrieves <xref:System.Deployment.Application.ApplicationDeployment.CurrentDeployment%2A> by using <xref:System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed%2A> first to ensure that the reference is not `null`.</span></span>  
  
 [!code-cpp[ClickOnceAPI#2](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#2)]
 [!code-csharp[ClickOnceAPI#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-332">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-332">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-333">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-333">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="TimeOfLastUpdateCheck">
      <MemberSignature Language="C#" Value="public DateTime TimeOfLastUpdateCheck { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime TimeOfLastUpdateCheck" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property TimeOfLastUpdateCheck As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime TimeOfLastUpdateCheck { DateTime get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-334">取得 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 上次檢查應用程式更新的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="ceb61-334">Gets the date and the time [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] last checked for an application update.</span></span></summary>
        <value><span data-ttu-id="ceb61-335">上次更新檢查的 <see cref="T:System.DateTime" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-335">The <see cref="T:System.DateTime" /> of the last update check.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-336">A[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式可以設定為訂用帳戶更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-336">A [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application can be configured for subscription updates.</span></span> <span data-ttu-id="ceb61-337">在此案例中，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]輪詢部署資訊清單中定義的間隔，自動的應用程式的部署位置，並判斷是否有可用更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-337">In this scenario, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] polls an application's deployment location automatically at intervals defined in the deployment manifest, and determines whether there is an update available.</span></span> <span data-ttu-id="ceb61-338"><xref:System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck%2A> 傳回上次更新檢查，不論它是否已起始藉由訂閱或使用明確的核取的時間<xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A>， <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A>， <xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A>， <xref:System.Deployment.Application.ApplicationDeployment.Update%2A>，或<xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-338"><xref:System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck%2A> returns the time of the last update check regardless of whether it was initiated by a subscription or by an explicit check using the <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdate%2A>, <xref:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync%2A>, <xref:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate%2A>, <xref:System.Deployment.Application.ApplicationDeployment.Update%2A>, or <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> method.</span></span>  
  
 <span data-ttu-id="ceb61-339">如果沒有更新檢查已執行，因為已安裝應用程式，<xref:System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck%2A>傳回的安裝時間。</span><span class="sxs-lookup"><span data-stu-id="ceb61-339">If no update check has been performed since the application was installed, <xref:System.Deployment.Application.ApplicationDeployment.TimeOfLastUpdateCheck%2A> returns the installation time.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-340">下列程式碼範例會檢查是否[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]過去三天內可用的更新已檢查應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-340">The following code example checks whether a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application has been checked for available updates in the past three days.</span></span>  
  
 [!code-cpp[ClickOnceAPI#3](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#3)]
 [!code-csharp[ClickOnceAPI#3](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#3)]
 [!code-vb[ClickOnceAPI#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#3)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-341">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-341">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-342">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-342">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="Update">
      <MemberSignature Language="C#" Value="public bool Update ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool Update() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.Update" />
      <MemberSignature Language="VB.NET" Value="Public Function Update () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool Update();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="ceb61-343">啟動此應用程式最新版本的同步下載和安裝。</span><span class="sxs-lookup"><span data-stu-id="ceb61-343">Starts a synchronous download and installation of the latest version of this application.</span></span></summary>
        <returns>
          <span data-ttu-id="ceb61-344">如果已更新應用程式則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-344"><see langword="true" /> if an application has been updated; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-345">當您發行新版本的應用程式所指定的位置時，更新被視為應用程式<xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>，且應用程式的部署資訊清單中的版本號碼大於應用程式的版本號碼目前使用者的電腦上安裝。</span><span class="sxs-lookup"><span data-stu-id="ceb61-345">An application is considered updated when you publish a new version of the application to the location specified by <xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>, and the version number in the application's deployment manifest is greater than the version number of the application currently installed on the user's computer.</span></span>  
  
 <span data-ttu-id="ceb61-346"><xref:System.Deployment.Application.ApplicationDeployment.Update%2A>呼叫將會封鎖，直到更新下載到用戶端電腦和安裝到[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]快取; 在此期間，應用程式不會對使用者的回應。</span><span class="sxs-lookup"><span data-stu-id="ceb61-346">The <xref:System.Deployment.Application.ApplicationDeployment.Update%2A> call will block until the update has been downloaded to the client computer and installed into the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] cache; during this time, the application will not be responsive to the user.</span></span> <span data-ttu-id="ceb61-347">如果您想要維護應用程式的回應，或下載，使用期間顯示進度報表<xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>方法改為。</span><span class="sxs-lookup"><span data-stu-id="ceb61-347">If you want to maintain application responsiveness or display a progress report during download, use the <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> method instead.</span></span>  
  
 <span data-ttu-id="ceb61-348"><xref:System.Deployment.Application.ApplicationDeployment.Update%2A> 下載的所有未標示為 「 選用 」 應用程式資訊清單中的檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-348"><xref:System.Deployment.Application.ApplicationDeployment.Update%2A> downloads all of the files that are not marked as "optional" in the application manifest.</span></span> <span data-ttu-id="ceb61-349">您可以下載選用的檔案，視使用<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A>或<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-349">You can download optional files on demand by using the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> or the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method.</span></span>  
  
 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]<span data-ttu-id="ceb61-350"> 可能已更新應用程式會自動呼叫時<xref:System.Deployment.Application.ApplicationDeployment.Update%2A>方法; 如果發生這種情況，呼叫此方法會擲回<xref:System.InvalidOperationException>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-350"> may already be updating the application automatically when you call the <xref:System.Deployment.Application.ApplicationDeployment.Update%2A> method; if that happens, calls to this method will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="ceb61-351">如果您已在您部署中，更新一個或多個檔案，但不是重新整理應用程式資訊清單，您會收到<xref:System.Deployment.Application.InvalidDeploymentException>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-351">If you have updated one or more files in your deployment, but you have not refreshed your application manifest, you will receive an <xref:System.Deployment.Application.InvalidDeploymentException>.</span></span> <span data-ttu-id="ceb61-352">大部分的情況下，重新部署您[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]應用程式來解決這個問題。</span><span class="sxs-lookup"><span data-stu-id="ceb61-352">Most of the time, redeploying your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application solves this problem.</span></span> <span data-ttu-id="ceb61-353">如果在部署資訊清單或應用程式資訊清單的公開金鑰簽章無效或遺漏，也會發生這個例外狀況。</span><span class="sxs-lookup"><span data-stu-id="ceb61-353">You will also receive this exception if a public-key signature on a deployment manifest or application manifest is invalid or missing.</span></span>  
  
 <span data-ttu-id="ceb61-354">更新可能會要求比舊版應用程式的高層級的本機電腦上的信任。</span><span class="sxs-lookup"><span data-stu-id="ceb61-354">An update may request a higher level of trust on the local computer than the previous version of the application.</span></span> <span data-ttu-id="ceb61-355">如果應用程式會使用受信任的應用程式部署，common language runtime (CLR) 信任管理員會檢查部署資訊清單，以判斷它是否包含有效的信任授權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-355">If the application uses Trusted Application Deployment, the common language runtime (CLR) trust manager examines the deployment manifest to determine whether it contains a valid trust license.</span></span> <span data-ttu-id="ceb61-356">如果部署資訊清單不包含有效的信任授權、[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]會停止安裝，並擲回<xref:System.Deployment.Application.TrustNotGrantedException>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-356">If the deployment manifest does not contain a valid trust license, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] stops the installation and throws a <xref:System.Deployment.Application.TrustNotGrantedException>.</span></span> <span data-ttu-id="ceb61-357"><xref:System.Deployment.Application.ApplicationDeployment.Update%2A>方法永遠不顯示提示，詢問使用者是否要授與應用程式執行的權限。</span><span class="sxs-lookup"><span data-stu-id="ceb61-357">The <xref:System.Deployment.Application.ApplicationDeployment.Update%2A> method will never display a prompt asking the user whether they want to grant the application permission to run.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-358">下列程式碼範例會檢查應用程式更新。如果有可用的更新，它會安裝它以同步方式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-358">The following code example checks for an application update; if an update is available, it installs it synchronously.</span></span>  
  
 [!code-cpp[ClickOnceAPI#6](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#6)]
 [!code-csharp[ClickOnceAPI#6](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#6)]
 [!code-vb[ClickOnceAPI#6](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#6)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Deployment.Application.TrustNotGrantedException"><span data-ttu-id="ceb61-359">本機電腦尚未授與應用程式執行所需的使用權限等級。</span><span class="sxs-lookup"><span data-stu-id="ceb61-359">The local computer did not grant the application the permission level it requested to execute.</span></span></exception>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="ceb61-360">您的 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 部署已損毀。</span><span class="sxs-lookup"><span data-stu-id="ceb61-360">Your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] deployment is corrupted.</span></span> <span data-ttu-id="ceb61-361">如需有關如何診斷並更正此問題的秘訣，請參閱[對 ClickOnce 部署進行疑難排解](http://msdn.microsoft.com/library/58e90012-f68b-4852-8ae9-58e361cbcc32)。</span><span class="sxs-lookup"><span data-stu-id="ceb61-361">For tips on how to diagnose and correct the problem, see [Troubleshooting ClickOnce Deployments](http://msdn.microsoft.com/library/58e90012-f68b-4852-8ae9-58e361cbcc32).</span></span></exception>
        <exception cref="T:System.Deployment.Application.DeploymentDownloadException"><span data-ttu-id="ceb61-362">無法從網路上的位置下載新部署。</span><span class="sxs-lookup"><span data-stu-id="ceb61-362">The new deployment could not be downloaded from its location on the network.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="ceb61-363">應用程式目前正在更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-363">The application is currently being updated.</span></span></exception>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-364">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-364">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-365">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-365">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdateAsync" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForUpdate" />
        <altmember cref="M:System.Deployment.Application.ApplicationDeployment.CheckForDetailedUpdate" />
      </Docs>
    </Member>
    <Member MemberName="UpdateAsync">
      <MemberSignature Language="C#" Value="public void UpdateAsync ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void UpdateAsync() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" />
      <MemberSignature Language="VB.NET" Value="Public Sub UpdateAsync ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UpdateAsync();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="ceb61-366">啟動此應用程式最新版本的非同步下載和安裝。</span><span class="sxs-lookup"><span data-stu-id="ceb61-366">Starts an asynchronous download and installation of the latest version of this application.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-367">當您發行新版本的應用程式所指定的位置時，更新被視為應用程式<xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>，且應用程式的部署資訊清單中的版本號碼大於應用程式的版本號碼目前使用者的電腦上安裝。</span><span class="sxs-lookup"><span data-stu-id="ceb61-367">An application is considered updated when you publish a new version of the application to the location specified by <xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A>, and the version number in the application's deployment manifest is greater than the version number of the application currently installed on the user's computer.</span></span>  
  
 <span data-ttu-id="ceb61-368">下載更新時[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]將會引發<xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged>主應用程式執行緒，以通知您下載狀態上的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-368">While downloading the update, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will raise the <xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged> event handler on the main application thread to inform you of the status of the download.</span></span> <span data-ttu-id="ceb61-369">非同步更新完成，或在遇到例外狀況，[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]將會引發<xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted>主應用程式執行緒上的事件。</span><span class="sxs-lookup"><span data-stu-id="ceb61-369">When the asynchronous update finishes or encounters an exception, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] will raise the <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> event on the main application thread.</span></span> <span data-ttu-id="ceb61-370">檢查<xref:System.ComponentModel.AsyncCompletedEventArgs>提供給此事件，以判斷更新是否成功。</span><span class="sxs-lookup"><span data-stu-id="ceb61-370">Examine the <xref:System.ComponentModel.AsyncCompletedEventArgs> supplied to this event to determine whether the update succeeded.</span></span>  
  
 <span data-ttu-id="ceb61-371">如果<xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>擲回例外狀況[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]呼叫<xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted>並設定<xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>屬性<xref:System.ComponentModel.AsyncCompletedEventArgs>擲回的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="ceb61-371">If <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> throws an exception, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] calls <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> and sets the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of <xref:System.ComponentModel.AsyncCompletedEventArgs> to the exception that was thrown.</span></span>  
  
 <span data-ttu-id="ceb61-372"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> 將下載未標示為 「 選用 」 應用程式資訊清單中的部署中的所有檔案。</span><span class="sxs-lookup"><span data-stu-id="ceb61-372"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> will download all files in a deployment not marked as "optional" in the application manifest.</span></span> <span data-ttu-id="ceb61-373">您可以下載選用的檔案，視使用<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A>或<xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="ceb61-373">You can download optional files on demand by using the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroup%2A> or the <xref:System.Deployment.Application.ApplicationDeployment.DownloadFileGroupAsync%2A> method.</span></span>  
  
 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]<span data-ttu-id="ceb61-374"> 可能已更新應用程式會自動呼叫時<xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>方法; 如果發生這種情況，呼叫此方法會擲回<xref:System.InvalidOperationException>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-374"> may already be updating the application automatically when you call the <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> method; if that happens, calls to this method will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="ceb61-375">如果您已在您部署中，更新一個或多個檔案，但不是重新整理應用程式資訊清單，您會收到<xref:System.Deployment.Application.InvalidDeploymentException>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-375">If you have updated one or more files in your deployment, but you have not refreshed your application manifest, you will receive an <xref:System.Deployment.Application.InvalidDeploymentException>.</span></span> <span data-ttu-id="ceb61-376">大部分的情況下，重建您的應用程式資訊清單來解決這個問題。</span><span class="sxs-lookup"><span data-stu-id="ceb61-376">Most of the time, rebuilding your application manifest solves this problem.</span></span> <span data-ttu-id="ceb61-377">如果在部署資訊清單或應用程式資訊清單的公開金鑰簽章無效或遺漏，也會發生這個例外狀況。</span><span class="sxs-lookup"><span data-stu-id="ceb61-377">You will also receive this exception if a public-key signature on a deployment manifest or application manifest is invalid or missing.</span></span>  
  
 <span data-ttu-id="ceb61-378">更新可能會要求比舊版應用程式的高層級的本機電腦上的信任。</span><span class="sxs-lookup"><span data-stu-id="ceb61-378">An update may request a higher level of trust on the local computer than the previous version of the application.</span></span> <span data-ttu-id="ceb61-379">如果應用程式會使用受信任的應用程式部署，common language runtime (CLR) 信任管理員會檢查部署資訊清單，以判斷它是否包含有效的信任授權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-379">If the application uses Trusted Application Deployment, the common language runtime (CLR) trust manager examines the deployment manifest to determine whether it contains a valid trust license.</span></span> <span data-ttu-id="ceb61-380">如果部署資訊清單不包含有效的信任授權、[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]會停止安裝，並擲回<xref:System.Deployment.Application.TrustNotGrantedException>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-380">If the deployment manifest does not contain a valid trust license, [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] stops the installation and throws a <xref:System.Deployment.Application.TrustNotGrantedException>.</span></span> <span data-ttu-id="ceb61-381"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> 永遠不顯示提示，詢問使用者是否要授與應用程式執行的權限。</span><span class="sxs-lookup"><span data-stu-id="ceb61-381"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A> will never display a prompt asking the user if they want to grant the application permission to run.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-382">下列程式碼範例會判斷新的更新是否可以使用在應用程式載入時間。如果必要的更新功能，它會以非同步方式安裝更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-382">The following code example determines whether a new update is available at application load time; if a required update is available, it installs the update asynchronously.</span></span> <span data-ttu-id="ceb61-383">這個範例需要您部署包含在 Windows Forms 應用程式<xref:System.Windows.Forms.StatusStrip>控制項，以及此控制項包含<xref:System.Windows.Forms.ToolStripStatusLabel>控制項，名為`downloadStatus`。</span><span class="sxs-lookup"><span data-stu-id="ceb61-383">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`.</span></span>  
  
 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Deployment.Application.TrustNotGrantedException"><span data-ttu-id="ceb61-384">本機電腦沒有授與此應用程式其所要求執行的使用權限等級。</span><span class="sxs-lookup"><span data-stu-id="ceb61-384">The local computer did not grant this application the permission level it requested to execute.</span></span></exception>
        <exception cref="T:System.Deployment.Application.InvalidDeploymentException"><span data-ttu-id="ceb61-385">您的 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 部署已損毀。</span><span class="sxs-lookup"><span data-stu-id="ceb61-385">Your [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] deployment is corrupted.</span></span> <span data-ttu-id="ceb61-386">如需有關如何診斷並更正此問題的秘訣，請參閱[對 ClickOnce 部署進行疑難排解](http://msdn.microsoft.com/library/58e90012-f68b-4852-8ae9-58e361cbcc32)。</span><span class="sxs-lookup"><span data-stu-id="ceb61-386">For tips on how to diagnose and correct the problem, see [Troubleshooting ClickOnce Deployments](http://msdn.microsoft.com/library/58e90012-f68b-4852-8ae9-58e361cbcc32).</span></span></exception>
        <exception cref="T:System.Deployment.Application.DeploymentDownloadException"><span data-ttu-id="ceb61-387">無法從網路上的位置下載新部署。</span><span class="sxs-lookup"><span data-stu-id="ceb61-387">The new deployment could not be downloaded from its location on the network.</span></span></exception>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-388">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-388">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-389">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-389">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
        <altmember cref="E:System.Deployment.Application.ApplicationDeployment.UpdateCompleted" />
      </Docs>
    </Member>
    <Member MemberName="UpdateAsyncCancel">
      <MemberSignature Language="C#" Value="public void UpdateAsyncCancel ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void UpdateAsyncCancel() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.ApplicationDeployment.UpdateAsyncCancel" />
      <MemberSignature Language="VB.NET" Value="Public Sub UpdateAsyncCancel ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UpdateAsyncCancel();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="ceb61-390">取消由 <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" /> 初始化的非同步更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-390">Cancels an asynchronous update initiated by <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-391"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsyncCancel%2A> 只會取消由呼叫起始更新<xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>; 它並不會取消訂閱的一部分所啟動的更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-391"><xref:System.Deployment.Application.ApplicationDeployment.UpdateAsyncCancel%2A> only cancels an update initiated by a call to <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsync%2A>; it does not cancel an update started as part of a subscription.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-392">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-392">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-393">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-393">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="UpdateCompleted">
      <MemberSignature Language="C#" Value="public event System.ComponentModel.AsyncCompletedEventHandler UpdateCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.ComponentModel.AsyncCompletedEventHandler UpdateCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.UpdateCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event UpdateCompleted As AsyncCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::ComponentModel::AsyncCompletedEventHandler ^ UpdateCompleted;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.ComponentModel.AsyncCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-394">在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 已完成升級應用程式時發生，該升級是藉由呼叫 <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" /> 而產生。</span><span class="sxs-lookup"><span data-stu-id="ceb61-394">Occurs when [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] has finished upgrading the application as the result of a call to <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-395"><xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted>事件是在執行緒上呼叫主應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-395">The <xref:System.Deployment.Application.ApplicationDeployment.UpdateCompleted> event is called on the main application thread.</span></span> <span data-ttu-id="ceb61-396">您可以呼叫您的應用程式直接在這個回呼的 Windows Form 控制項而不觸發例外狀況。</span><span class="sxs-lookup"><span data-stu-id="ceb61-396">You may call your application's Windows Forms controls directly within this callback without triggering an exception.</span></span>  
  
 <span data-ttu-id="ceb61-397">請檢查<xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>屬性<xref:System.ComponentModel.AsyncCompletedEventArgs>提供給這個回呼。</span><span class="sxs-lookup"><span data-stu-id="ceb61-397">Check the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of the <xref:System.ComponentModel.AsyncCompletedEventArgs> supplied to this callback.</span></span> <span data-ttu-id="ceb61-398">如果這個屬性是`null`，安裝是否成功; 如果不是`null`、 安裝並未成功，而且您可以找到透過此安裝失敗的詳細資訊<xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="ceb61-398">If this property is `null`, the installation was successful; if it is not `null`, the installation did not succeed, and you can find more information about this installation failure through the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property.</span></span> <span data-ttu-id="ceb61-399">一旦已下載的更新，您必須呼叫<xref:System.Windows.Forms.Application.Restart%2A>方法<xref:System.Windows.Forms.Application>使用較新版本的應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-399">Once the update has been downloaded, you will need to call the <xref:System.Windows.Forms.Application.Restart%2A> method on the <xref:System.Windows.Forms.Application> to use the newer version of the application.</span></span>  
  
 <span data-ttu-id="ceb61-400">如果更新安裝已取消由呼叫<xref:System.Deployment.Application.ApplicationDeployment.UpdateAsyncCancel%2A>、<xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A>屬性<xref:System.ComponentModel.AsyncCompletedEventArgs>類別將為`true`。</span><span class="sxs-lookup"><span data-stu-id="ceb61-400">If the installation of the update was canceled by a call to <xref:System.Deployment.Application.ApplicationDeployment.UpdateAsyncCancel%2A>, the <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> property of the <xref:System.ComponentModel.AsyncCompletedEventArgs> class will be `true`.</span></span>  
  
 <span data-ttu-id="ceb61-401">若要使用此事件處理常式，您的應用程式必須匯入同時<xref:System.Deployment.Application>和<xref:System.ComponentModel>命名空間。</span><span class="sxs-lookup"><span data-stu-id="ceb61-401">To use this event handler, your application must import both the <xref:System.Deployment.Application> and <xref:System.ComponentModel> namespaces.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-402">下列程式碼範例會在應用程式載入時判斷是否有可用的; 新的更新如果必要的更新功能，它會以非同步方式安裝更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-402">The following code example determines at application load time whether a new update is available; if a required update is available, it installs the update asynchronously.</span></span> <span data-ttu-id="ceb61-403">這個範例需要您部署包含在 Windows Forms 應用程式<xref:System.Windows.Forms.StatusStrip>控制項，以及此控制項包含<xref:System.Windows.Forms.ToolStripStatusLabel>控制項，名為`downloadStatus`。</span><span class="sxs-lookup"><span data-stu-id="ceb61-403">The example requires that you deploy a Windows Forms application that includes a <xref:System.Windows.Forms.StatusStrip> control, and that this control contain a <xref:System.Windows.Forms.ToolStripStatusLabel> control named `downloadStatus`.</span></span>  
  
 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="UpdatedApplicationFullName">
      <MemberSignature Language="C#" Value="public string UpdatedApplicationFullName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string UpdatedApplicationFullName" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.UpdatedApplicationFullName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property UpdatedApplicationFullName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ UpdatedApplicationFullName { System::String ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-404">取得應用程式在更新之後的完整名稱。</span><span class="sxs-lookup"><span data-stu-id="ceb61-404">Gets the full name of the application after it has been updated.</span></span></summary>
        <value><span data-ttu-id="ceb61-405"><see cref="T:System.String" />，包含應用程式的完整名稱。</span><span class="sxs-lookup"><span data-stu-id="ceb61-405">A <see cref="T:System.String" /> that contains the full name of the application.</span></span></value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="UpdatedVersion">
      <MemberSignature Language="C#" Value="public Version UpdatedVersion { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Version UpdatedVersion" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.UpdatedVersion" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property UpdatedVersion As Version" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Version ^ UpdatedVersion { Version ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Version</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-406">取得最近下載的更新版本。</span><span class="sxs-lookup"><span data-stu-id="ceb61-406">Gets the version of the update that was recently downloaded.</span></span></summary>
        <value><span data-ttu-id="ceb61-407">描述更新版本的 <see cref="T:System.Version" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-407">The <see cref="T:System.Version" /> describing the version of the update.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-408"><xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A> 不同於<xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A>如果已安裝新的更新，但尚未呼叫<xref:System.Windows.Forms.Application.Restart%2A>上<xref:System.Windows.Forms.Application>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-408"><xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A> differs from <xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A> if a new update has been installed but you have not yet called <xref:System.Windows.Forms.Application.Restart%2A> on the <xref:System.Windows.Forms.Application>.</span></span> <span data-ttu-id="ceb61-409">如果應用程式的部署資訊清單設定為執行自動更新，您可以比較這兩個值，以判斷是否應該重新啟動應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-409">If the application's deployment manifest is configured to perform automatic updates, you can compare these two values to determine whether you should restart the application.</span></span>  
  
 <span data-ttu-id="ceb61-410">如果應用程式尚未更新，<xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A>傳回相同的值做為<xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A>。</span><span class="sxs-lookup"><span data-stu-id="ceb61-410">If the application has not been updated, <xref:System.Deployment.Application.ApplicationDeployment.UpdatedVersion%2A> returns the same value as <xref:System.Deployment.Application.ApplicationDeployment.CurrentVersion%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-411">下列程式碼範例會定義方法，決定是否[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]已更新應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-411">The following code example defines a method that determines whether [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] has updated the application.</span></span>  
  
 [!code-cpp[ClickOnceAPI#4](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#4)]
 [!code-csharp[ClickOnceAPI#4](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#4)]
 [!code-vb[ClickOnceAPI#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#4)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-412">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-412">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-413">相關聯的列舉型別： <see cref="T:System.Security.Permissions.PermissionState" /></span><span class="sxs-lookup"><span data-stu-id="ceb61-413">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="UpdateLocation">
      <MemberSignature Language="C#" Value="public Uri UpdateLocation { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Uri UpdateLocation" />
      <MemberSignature Language="DocId" Value="P:System.Deployment.Application.ApplicationDeployment.UpdateLocation" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property UpdateLocation As Uri" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Uri ^ UpdateLocation { Uri ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Uri</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-414">取得這個應用程式進行自我更新的來源網站或檔案共用。</span><span class="sxs-lookup"><span data-stu-id="ceb61-414">Gets the Web site or file share from which this application updates itself.</span></span></summary>
        <value><span data-ttu-id="ceb61-415">更新路徑，以 HTTP、HTTPS 或檔案 URL 表示，或是以 Windows 網路檔案路徑 (UNC) 表示。</span><span class="sxs-lookup"><span data-stu-id="ceb61-415">The update path, expressed as an HTTP, HTTPS, or file URL; or as a Windows network file path (UNC).</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-416"><xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A> 可能會從用來下載應用程式一開始，如果應用程式的部署已設定為使用更新的重新導向的網站不同。</span><span class="sxs-lookup"><span data-stu-id="ceb61-416"><xref:System.Deployment.Application.ApplicationDeployment.UpdateLocation%2A> may be different from the Web site used to download the application initially if the application's deployment is configured to use update redirection.</span></span>  
  
 <span data-ttu-id="ceb61-417">只在應用程式的部署資訊清單中，可以變更此值。</span><span class="sxs-lookup"><span data-stu-id="ceb61-417">This value can be changed only in the application's deployment manifest.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.PermissionSet"><span data-ttu-id="ceb61-418">若要在本機電腦的完整存取權。</span><span class="sxs-lookup"><span data-stu-id="ceb61-418">For full access to the local computer.</span></span> <span data-ttu-id="ceb61-419">關聯的列舉型別：<see cref="T:System.Security.Permissions.PermissionState" />。</span><span class="sxs-lookup"><span data-stu-id="ceb61-419">Associated enumeration: <see cref="T:System.Security.Permissions.PermissionState" />.</span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="UpdateProgressChanged">
      <MemberSignature Language="C#" Value="public event System.Deployment.Application.DeploymentProgressChangedEventHandler UpdateProgressChanged;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Deployment.Application.DeploymentProgressChangedEventHandler UpdateProgressChanged" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event UpdateProgressChanged As DeploymentProgressChangedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Deployment::Application::DeploymentProgressChangedEventHandler ^ UpdateProgressChanged;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Deployment.Application.DeploymentProgressChangedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="ceb61-420">在 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 有因呼叫 <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" /> 方法以初始化更新作業之新狀態資訊時發生。</span><span class="sxs-lookup"><span data-stu-id="ceb61-420">Occurs when [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] has new status information for an update operation initiated by calling the <see cref="M:System.Deployment.Application.ApplicationDeployment.UpdateAsync" /> method.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ceb61-421"><xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged>事件是在執行緒上呼叫主應用程式。</span><span class="sxs-lookup"><span data-stu-id="ceb61-421">The <xref:System.Deployment.Application.ApplicationDeployment.UpdateProgressChanged> event is called on the main application thread.</span></span> <span data-ttu-id="ceb61-422">您可以呼叫您的應用程式直接在這個回呼的 Windows Form 控制項而不觸發例外狀況。</span><span class="sxs-lookup"><span data-stu-id="ceb61-422">You may call your application's Windows Forms controls directly within this callback without triggering an exception.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ceb61-423">下列程式碼範例會在應用程式載入時判斷是否有可用的; 新的更新如果必要的更新功能，它會以非同步方式安裝更新。</span><span class="sxs-lookup"><span data-stu-id="ceb61-423">The following code example determines at application load time whether a new update is available; if a required update is available, it installs the update asynchronously.</span></span>  
  
 [!code-cpp[ClickOnceAPI#1](~/samples/snippets/cpp/VS_Snippets_Winforms/ClickOnceAPI/cpp/form1.cpp#1)]
 [!code-csharp[ClickOnceAPI#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ClickOnceAPI/CS/Form1.cs#1)]
 [!code-vb[ClickOnceAPI#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ClickOnceAPI/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>