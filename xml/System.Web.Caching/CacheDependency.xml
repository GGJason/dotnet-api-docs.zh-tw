<Type Name="CacheDependency" FullName="System.Web.Caching.CacheDependency">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="971848a65c6d20655c657ffc94cd2e88f373bb0d" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
    <Meta Name="ms.locfileid" Value="30530842" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class CacheDependency : IDisposable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi CacheDependency extends System.Object implements class System.IDisposable" />
  <TypeSignature Language="DocId" Value="T:System.Web.Caching.CacheDependency" />
  <TypeSignature Language="VB.NET" Value="Public Class CacheDependency&#xA;Implements IDisposable" />
  <TypeSignature Language="C++ CLI" Value="public ref class CacheDependency : IDisposable" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.IDisposable</InterfaceName>
    </Interface>
  </Interfaces>
  <Docs>
    <summary>
      <span data-ttu-id="60114-101">在儲存於 ASP.NET 應用程式的 <see cref="T:System.Web.Caching.Cache" /> 物件中的項目以及檔案、快取索引鍵、這其中任一個的陣列或另一個 <see cref="T:System.Web.Caching.CacheDependency" /> 物件之間建立相依性關係。</span>
      <span class="sxs-lookup">
        <span data-stu-id="60114-101">Establishes a dependency relationship between an item stored in an ASP.NET application's <see cref="T:System.Web.Caching.Cache" /> object and a file, cache key, an array of either, or another <see cref="T:System.Web.Caching.CacheDependency" /> object.</span>
      </span>
      <span data-ttu-id="60114-102">
        <see cref="T:System.Web.Caching.CacheDependency" /> 類別會監視相依性關係，如此便能在其中任一個變更時，自動移除快取的項目。</span>
      <span class="sxs-lookup">
        <span data-stu-id="60114-102">The <see cref="T:System.Web.Caching.CacheDependency" /> class monitors the dependency relationships so that when any of them changes, the cached item will be automatically removed.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-103">如果您將項目加入至相依於另一個物件，例如檔案或檔案，陣列的快取會自動移除相依的項目從快取物件變更時。</span><span class="sxs-lookup"><span data-stu-id="60114-103">If you add an item to the cache that is dependent on another object, such as a file or array of files, the dependent item is automatically removed from the cache when the object changes.</span></span> <span data-ttu-id="60114-104">例如，假設您建立<xref:System.Data.DataSet>XML 檔案中的資料為基礎的物件。</span><span class="sxs-lookup"><span data-stu-id="60114-104">For example, suppose you create a <xref:System.Data.DataSet> object based on data in an XML file.</span></span> <span data-ttu-id="60114-105">您可以加入<xref:System.Data.DataSet>至快取<xref:System.Web.Caching.CacheDependency>物件，可讓<xref:System.Data.DataSet>相依於 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="60114-105">You can add the <xref:System.Data.DataSet> to the cache with a <xref:System.Web.Caching.CacheDependency> object that makes the <xref:System.Data.DataSet> dependent on the XML file.</span></span> <span data-ttu-id="60114-106">如果變更 XML 檔案，<xref:System.Data.DataSet>從快取中移除。</span><span class="sxs-lookup"><span data-stu-id="60114-106">If the XML file changes, the <xref:System.Data.DataSet> is removed from the cache.</span></span>  
  
 <span data-ttu-id="60114-107">您可以將相依的項目加入您的應用程式的快取<xref:System.Web.Caching.Cache.Add%2A>和<xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="60114-107">You can add items with dependencies to your application's cache with the <xref:System.Web.Caching.Cache.Add%2A> and <xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType> methods.</span></span> <span data-ttu-id="60114-108">您無法使用<xref:System.Web.Caching.Cache.Item%2A>將項目新增至快取相依性屬性。</span><span class="sxs-lookup"><span data-stu-id="60114-108">You cannot use the <xref:System.Web.Caching.Cache.Item%2A> property to add items to the cache with dependencies.</span></span>  
  
 <span data-ttu-id="60114-109">若要設定相依性，您建立的執行個體<xref:System.Web.Caching.CacheDependency>類別，指定檔案、 索引鍵或目錄項目是相依，，然後將傳遞至相依性<xref:System.Web.Caching.Cache.Add%2A>或<xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="60114-109">To set up a dependency, you create an instance of the <xref:System.Web.Caching.CacheDependency> class, specifying the files, keys, or directories on which the item is dependent, and then pass the dependency to the <xref:System.Web.Caching.Cache.Add%2A> or <xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="60114-110"><xref:System.Web.Caching.CacheDependency>執行個體可以代表單一檔案或目錄、 檔案或目錄的陣列或檔案或目錄，以及快取索引鍵陣列的陣列 (這些代表儲存在其他項目<xref:System.Web.Caching.Cache>物件)。</span><span class="sxs-lookup"><span data-stu-id="60114-110">The <xref:System.Web.Caching.CacheDependency> instance can represent a single file or directory, an array of files or directories, or an array of files or directories along with an array of cache keys (these represent other items stored in the <xref:System.Web.Caching.Cache> object).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-111">下列程式碼範例示範如何使用<xref:System.Web.Caching.CacheDependency.HasChanged%2A>屬性來判斷是否<xref:System.Web.Caching.CacheDependency>自前一個要求中的項目變更<xref:System.Web.Caching.Cache>。</span><span class="sxs-lookup"><span data-stu-id="60114-111">The following code example demonstrates using the <xref:System.Web.Caching.CacheDependency.HasChanged%2A> property to determine whether a <xref:System.Web.Caching.CacheDependency> changed since the previous request for an item in the <xref:System.Web.Caching.Cache>.</span></span> <span data-ttu-id="60114-112">`dt`傳入值`start`參數設定為<xref:System.DateTime.Now%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="60114-112">The `dt` value passed in the `start` parameter is set to <xref:System.DateTime.Now%2A?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[System.Web.Caching.CacheDependency_HasChanged#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Caching.CacheDependency_HasChanged/CS/t.cs.aspx#1)]
 [!code-vb[System.Web.Caching.CacheDependency_HasChanged#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Caching.CacheDependency_HasChanged/VB/t.vb.aspx#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Web.Caching.Cache" />
    <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="60114-113">初始化 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-113">Initializes a new instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class.</span>
          </span>
        </summary>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="protected CacheDependency ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.#ctor" />
      <MemberSignature Language="VB.NET" Value="Protected Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; CacheDependency();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="60114-114">初始化 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-114">Initializes a new instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-115">如果您想要衍生您自己從<xref:System.Web.Caching.CacheDependency>，可實作此版本<xref:System.Web.Caching.CacheDependency.%23ctor%2A>建構函式。</span><span class="sxs-lookup"><span data-stu-id="60114-115">If you want to derive your own class from <xref:System.Web.Caching.CacheDependency>, implement this version of the <xref:System.Web.Caching.CacheDependency.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-116">下列程式碼範例是一個類別，實作這個版本的<xref:System.Web.Caching.CacheDependency>建構函式做為所有的類別衍生自<xref:System.Web.Caching.CacheDependency>所需。</span><span class="sxs-lookup"><span data-stu-id="60114-116">The following code example is a class that implements this version of the <xref:System.Web.Caching.CacheDependency> constructor as all classes that derive from <xref:System.Web.Caching.CacheDependency> are required to.</span></span>  
  
 [!code-vb[CacheDependency_Whidbey_Example1#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/CacheDependency_Whidbey_Example1/VB/cachedependencysample.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public CacheDependency (string filename);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string filename) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (filename As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; CacheDependency(System::String ^ filename);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="filename" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="filename">
          <span data-ttu-id="60114-117">快取物件相依的檔案或目錄路徑。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-117">The path to a file or directory that the cached object is dependent upon.</span>
          </span>
          <span data-ttu-id="60114-118">當這項資源變更時，快取物件就會變成過時並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-118">When this resource changes, the cached object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-119">初始化 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的新執行個體，這執行個體可監視檔案或目錄的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-119">Initializes a new instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class that monitors a file or directory for changes.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-120">如果在指定的目錄或檔案`filename`參數中找不到檔案系統中，它會被視為遺漏。</span><span class="sxs-lookup"><span data-stu-id="60114-120">If the directory or file specified in the `filename` parameter is not found in the file system, it will be treated as missing.</span></span> <span data-ttu-id="60114-121">如果找不到目錄或檔案具有相依性物件加入至中時<xref:System.Web.Caching.Cache>，快取的物件會移除<xref:System.Web.Caching.Cache>建立目錄或檔案時。</span><span class="sxs-lookup"><span data-stu-id="60114-121">If the directory or file is missing when the object with the dependency is added to the <xref:System.Web.Caching.Cache>, the cached object will be removed from the <xref:System.Web.Caching.Cache> when the directory or file is created.</span></span>  
  
 <span data-ttu-id="60114-122">例如，假設您將物件加入<xref:System.Web.Caching.Cache>具有相依性的下列檔案路徑： c:\stocks\xyz.dat。</span><span class="sxs-lookup"><span data-stu-id="60114-122">For example, assume that you add an object to the <xref:System.Web.Caching.Cache> with a dependency on the following file path: c:\stocks\xyz.dat.</span></span> <span data-ttu-id="60114-123">如果該檔案找不到時<xref:System.Web.Caching.CacheDependency>，物件會建立，但稍後建立快取的物件會在 xyz.dat 檔案建立時移除。</span><span class="sxs-lookup"><span data-stu-id="60114-123">If that file is not found when the <xref:System.Web.Caching.CacheDependency> object is created, but is created later, the cached object is removed upon the creation of the xyz.dat file.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-124">下列程式碼範例建立的執行個體<xref:System.Web.Caching.CacheDependency>類別具有相依性的 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="60114-124">The following code example creates an instance of the <xref:System.Web.Caching.CacheDependency> class with a dependency on an XML file.</span></span> <span data-ttu-id="60114-125"><xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType>方法接著會將項目<xref:System.Web.Caching.Cache>這是相依於該檔案。</span><span class="sxs-lookup"><span data-stu-id="60114-125">The <xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType> method then adds an item to the <xref:System.Web.Caching.Cache> that is dependent upon that file.</span></span>  
  
 [!code-csharp[Classic CacheDependency.CacheDependency Example#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Classic CacheDependency.CacheDependency Example/CS/source.cs#1)]
 [!code-vb[Classic CacheDependency.CacheDependency Example#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Classic CacheDependency.CacheDependency Example/VB/source.vb#1)]  
  
 <span data-ttu-id="60114-126">您也可以使用下列技巧來將項目加入<xref:System.Web.Caching.Cache>具有相依性的檔案。</span><span class="sxs-lookup"><span data-stu-id="60114-126">You can also use the following technique to add an item to the <xref:System.Web.Caching.Cache> with a dependency on a file.</span></span>  
  
 [!code-csharp[Single File Dependency Cache entry#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Single File Dependency Cache entry/CS/DependencySingleFilecs.aspx#1)]
 [!code-vb[Single File Dependency Cache entry#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Single File Dependency Cache entry/VB/DependencySingleFilevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public CacheDependency (string[] filenames);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string[] filenames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.#ctor(System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (filenames As String())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; CacheDependency(cli::array &lt;System::String ^&gt; ^ filenames);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="filenames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="filenames">
          <span data-ttu-id="60114-127">快取物件所相依的檔案或目錄之路徑陣列。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-127">An array of paths (to files or directories) that the cached object is dependent upon.</span>
          </span>
          <span data-ttu-id="60114-128">當這些資源有任何項目變更時，快取物件就會變成過時，並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-128">When any of these resources changes, the cached object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-129">初始化 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的新執行個體，其可監視檔案或目錄之路徑陣列的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-129">Initializes a new instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class that monitors an array of paths (to files or directories) for changes.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-130">如果檔案或目錄陣列中的任何變更或從該陣列中移除快取的項目就會變成過時並移除從應用程式的<xref:System.Web.Caching.Cache>物件。</span><span class="sxs-lookup"><span data-stu-id="60114-130">If any of the files or directories in the array changes or is removed from the array, the cached item becomes obsolete and is removed from the application's <xref:System.Web.Caching.Cache> object.</span></span>  
  
 <span data-ttu-id="60114-131">此外，如果任何目錄或檔案中指定`filenames`參數中找不到檔案系統中，它會被視為遺漏。</span><span class="sxs-lookup"><span data-stu-id="60114-131">Also, if any of the directories or files specified in the `filenames` parameter is not found in the file system, it is treated as missing.</span></span> <span data-ttu-id="60114-132">如果找不到目錄或檔案具有相依性物件加入至中時<xref:System.Web.Caching.Cache>，快取的物件會移除<xref:System.Web.Caching.Cache>建立該目錄或檔案時。</span><span class="sxs-lookup"><span data-stu-id="60114-132">If a directory or file is missing when the object with the dependency is added to the <xref:System.Web.Caching.Cache>, the cached object will be removed from the <xref:System.Web.Caching.Cache> when that directory or file is created.</span></span>  
  
 <span data-ttu-id="60114-133">例如，假設您將物件加入<xref:System.Web.Caching.Cache>具有相依性的下列檔案路徑： c:\stocks\xyz.dat。</span><span class="sxs-lookup"><span data-stu-id="60114-133">For example, assume that you add an object to the <xref:System.Web.Caching.Cache> with a dependency on the following file path: c:\stocks\xyz.dat.</span></span> <span data-ttu-id="60114-134">如果該檔案找不到時<xref:System.Web.Caching.CacheDependency>，物件會建立，但稍後建立快取的物件會在 xyz.dat 檔案建立時移除。</span><span class="sxs-lookup"><span data-stu-id="60114-134">If that file is not found when the <xref:System.Web.Caching.CacheDependency> object is created, but is created later, the cached object is removed upon the creation of the xyz.dat file.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="60114-135">當您建立陣列，其中包含檔案相依性時，您必須定義的檔案數目您加入的項目<xref:System.Web.Caching.Cache>而定。</span><span class="sxs-lookup"><span data-stu-id="60114-135">When you create the array that contains the file dependencies, you must define the number of files that the item you are adding to the <xref:System.Web.Caching.Cache> is dependent on.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-136">下列程式碼範例示範如何使用<xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType>方法，以將項目加入<xref:System.Web.Caching.Cache>依存性的檔案陣列。</span><span class="sxs-lookup"><span data-stu-id="60114-136">The following code example demonstrates how to use the <xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType> method to add an item to the <xref:System.Web.Caching.Cache> with dependencies on an array of files.</span></span> <span data-ttu-id="60114-137">您也可以將項目相依於的目錄陣列。</span><span class="sxs-lookup"><span data-stu-id="60114-137">You can also make the item dependent on an array of directories.</span></span>  
  
 [!code-csharp[Multiple file based dependency#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Multiple file based dependency/CS/DependencyMultiFilecs.aspx#1)]
 [!code-vb[Multiple file based dependency#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Multiple file based dependency/VB/DependencyMultiFilevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public CacheDependency (string filename, DateTime start);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string filename, valuetype System.DateTime start) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.#ctor(System.String,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (filename As String, start As DateTime)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; CacheDependency(System::String ^ filename, DateTime start);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="filename" Type="System.String" />
        <Parameter Name="start" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="filename">
          <span data-ttu-id="60114-138">快取物件相依的檔案或目錄路徑。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-138">The path to a file or directory that the cached object is dependent upon.</span>
          </span>
          <span data-ttu-id="60114-139">當這項資源變更時，快取物件就會變成過時並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-139">When this resource changes, the cached object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <param name="start">
          <span data-ttu-id="60114-140">檢查目錄或檔案的上次修改日期所根據的時間。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-140">The time against which to check the last modified date of the directory or file.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-141">初始化 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的新執行個體，這執行個體可監視檔案或目錄的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-141">Initializes a new instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class that monitors a file or directory for changes.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-142">如果在指定的目錄或檔案`filename`參數中找不到檔案系統中，它會被視為遺漏。</span><span class="sxs-lookup"><span data-stu-id="60114-142">If the directory or file specified in the `filename` parameter is not found in the file system, it will be treated as missing.</span></span> <span data-ttu-id="60114-143">如果找不到目錄或檔案具有相依性物件加入至中時<xref:System.Web.Caching.Cache>，快取的物件會移除<xref:System.Web.Caching.Cache>建立目錄或檔案時。</span><span class="sxs-lookup"><span data-stu-id="60114-143">If the directory or file is missing when the object with the dependency is added to the <xref:System.Web.Caching.Cache>, the cached object will be removed from the <xref:System.Web.Caching.Cache> when the directory or file is created.</span></span>  
  
 <span data-ttu-id="60114-144">例如，假設您將物件加入<xref:System.Web.Caching.Cache>具有相依性的下列檔案路徑： c:\stocks\xyz.dat。</span><span class="sxs-lookup"><span data-stu-id="60114-144">For example, assume that you add an object to the <xref:System.Web.Caching.Cache> with a dependency on the following file path: c:\stocks\xyz.dat.</span></span> <span data-ttu-id="60114-145">如果該檔案找不到時<xref:System.Web.Caching.CacheDependency>，物件會建立，但稍後建立快取的物件會在 xyz.dat 檔案建立時移除。</span><span class="sxs-lookup"><span data-stu-id="60114-145">If that file is not found when the <xref:System.Web.Caching.CacheDependency> object is created, but is created later, the cached object is removed upon the creation of the xyz.dat file.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="60114-146">變更追蹤會立即開始並不直接根據`start`參數。</span><span class="sxs-lookup"><span data-stu-id="60114-146">Change tracking begins immediately and is not directly based on the `start` parameter.</span></span> <span data-ttu-id="60114-147">使用`start`要傳遞的日期和時間在過去，針對您想要檢查的上次修改日期的目錄或檔案的傳入參數`filename`參數。</span><span class="sxs-lookup"><span data-stu-id="60114-147">Use the `start` parameter to pass a date and time in the past against which you want to check the last modified date of the directory or file passed in the `filename` parameter.</span></span> <span data-ttu-id="60114-148">如果上次修改日期晚於日期和時間設定傳入`start`參數，快取的項目移除從<xref:System.Web.Caching.Cache>。</span><span class="sxs-lookup"><span data-stu-id="60114-148">If the last modified date is later than the date and time set passed in the `start` parameter, the cached item is removed from the <xref:System.Web.Caching.Cache>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-149">下列程式碼範例會使用這個建構函式來具現化<xref:System.Web.Caching.CacheDependency>物件，然後插入項目<xref:System.Web.Caching.Cache>與該相依性。</span><span class="sxs-lookup"><span data-stu-id="60114-149">The following code example uses this constructor to instantiate a <xref:System.Web.Caching.CacheDependency> object, then inserts an item into the <xref:System.Web.Caching.Cache> with that dependency.</span></span> <span data-ttu-id="60114-150">`dt`傳入值`start`參數設定為<xref:System.DateTime.Now%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="60114-150">The `dt` value passed in the `start` parameter is set to <xref:System.DateTime.Now%2A?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[System.Web.Caching.CacheDependency_HasChanged#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Caching.CacheDependency_HasChanged/CS/t.cs.aspx#1)]
 [!code-vb[System.Web.Caching.CacheDependency_HasChanged#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Caching.CacheDependency_HasChanged/VB/t.vb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public CacheDependency (string[] filenames, DateTime start);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string[] filenames, valuetype System.DateTime start) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.#ctor(System.String[],System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (filenames As String(), start As DateTime)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; CacheDependency(cli::array &lt;System::String ^&gt; ^ filenames, DateTime start);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="filenames" Type="System.String[]" />
        <Parameter Name="start" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="filenames">
          <span data-ttu-id="60114-151">快取物件所相依的檔案或目錄之路徑陣列。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-151">An array of paths (to files or directories) that the cached object is dependent upon.</span>
          </span>
          <span data-ttu-id="60114-152">當這些資源有任何項目變更時，快取物件就會變成過時，並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-152">When any of these resources changes, the cached object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <param name="start">
          <span data-ttu-id="60114-153">檢查陣列中物件的上次修改日期所根據的時間。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-153">The time against which to check the last modified date of the objects in the array.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-154">初始化 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的新執行個體，其可監視檔案或目錄的路徑陣列之變更，並指定變更監視開始的時間。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-154">Initializes a new instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class that monitors an array of paths (to files or directories) for changes and specifies a time when change monitoring begins.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-155">如果任何目錄或檔案中指定`filenames`參數中找不到檔案系統中，它會被視為遺漏。</span><span class="sxs-lookup"><span data-stu-id="60114-155">If any of the directories or files specified in the `filenames` parameter is not found in the file system, it is treated as missing.</span></span> <span data-ttu-id="60114-156">如果找不到目錄或檔案具有相依性物件加入至中時<xref:System.Web.Caching.Cache>，快取的物件會移除<xref:System.Web.Caching.Cache>建立該目錄或檔案時。</span><span class="sxs-lookup"><span data-stu-id="60114-156">If a directory or file is missing when the object with the dependency is added to the <xref:System.Web.Caching.Cache>, the cached object will be removed from the <xref:System.Web.Caching.Cache> when that directory or file is created.</span></span>  
  
 <span data-ttu-id="60114-157">例如，假設您將物件加入<xref:System.Web.Caching.Cache>具有相依性的下列檔案路徑： c:\stocks\xyz.dat。</span><span class="sxs-lookup"><span data-stu-id="60114-157">For example, assume that you add an object to the <xref:System.Web.Caching.Cache> with a dependency on the following file path: c:\stocks\xyz.dat.</span></span> <span data-ttu-id="60114-158">如果該檔案找不到時<xref:System.Web.Caching.CacheDependency>，物件會建立，但稍後建立快取的物件會在 xyz.dat 檔案建立時移除。</span><span class="sxs-lookup"><span data-stu-id="60114-158">If that file is not found when the <xref:System.Web.Caching.CacheDependency> object is created, but is created later, the cached object is removed upon the creation of the xyz.dat file.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="60114-159">變更追蹤會立即開始並不直接根據`start`參數。</span><span class="sxs-lookup"><span data-stu-id="60114-159">Change tracking begins immediately and is not directly based on the `start` parameter.</span></span> <span data-ttu-id="60114-160">使用`start`傳遞日期和時間，以針對您想要檢查陣列的上次修改的日期在過去的參數傳遞給`filenames`參數。</span><span class="sxs-lookup"><span data-stu-id="60114-160">Use the `start` parameter to pass a date and time in the past against which you want to check the last modified date of the array passed in the `filenames` parameter.</span></span> <span data-ttu-id="60114-161">如果上次修改陣列中的任何物件的日期不晚於日期和時間設定傳入`start`參數，快取的項目移除從<xref:System.Web.Caching.Cache>。</span><span class="sxs-lookup"><span data-stu-id="60114-161">If the last modified date of any object in the array is later than the date and time set passed in the `start` parameter, the cached item is removed from the <xref:System.Web.Caching.Cache>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-162">下列程式碼範例會建立<xref:System.Web.Caching.CacheDependency>會傳遞兩個 XML 檔案的物件和<xref:System.DateTime.Now%2A?displayProperty=nameWithType>值的物件是做為參數引數包含<xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType>方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="60114-162">The following code example creates a <xref:System.Web.Caching.CacheDependency> object that passes two XML files and a <xref:System.DateTime.Now%2A?displayProperty=nameWithType> value when the object is included as a parameter argument in an <xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType> method call.</span></span>  
  
 [!code-csharp[CacheDependency Constructor4#1](~/samples/snippets/csharp/VS_Snippets_WebNet/CacheDependency Constructor4/CS/depmultifilestimecs.aspx#1)]
 [!code-vb[CacheDependency Constructor4#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/CacheDependency Constructor4/VB/depmultifilestimevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public CacheDependency (string[] filenames, string[] cachekeys);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string[] filenames, string[] cachekeys) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.#ctor(System.String[],System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (filenames As String(), cachekeys As String())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; CacheDependency(cli::array &lt;System::String ^&gt; ^ filenames, cli::array &lt;System::String ^&gt; ^ cachekeys);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="filenames" Type="System.String[]" />
        <Parameter Name="cachekeys" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="filenames">
          <span data-ttu-id="60114-163">快取物件所相依的檔案或目錄之路徑陣列。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-163">An array of paths (to files or directories) that the cached object is dependent upon.</span>
          </span>
          <span data-ttu-id="60114-164">當這些資源有任何項目變更時，快取物件就會變成過時，並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-164">When any of these resources changes, the cached object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <param name="cachekeys">
          <span data-ttu-id="60114-165">快取索引鍵的陣列，新物件會監視它的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-165">An array of cache keys that the new object monitors for changes.</span>
          </span>
          <span data-ttu-id="60114-166">當有任何快取索引鍵變更時，與這個相依性物件關聯的快取物件會變成過時，並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-166">When any of these cache keys changes, the cached object associated with this dependency object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-167">初始化 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的新執行個體，其可監視檔案或目錄的路徑陣列、快取索引鍵的陣列或這兩者的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-167">Initializes a new instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class that monitors an array of paths (to files or directories), an array of cache keys, or both for changes.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-168">此外，如果任何目錄或檔案中指定`filenames`參數中找不到檔案系統中，它會被視為遺漏。</span><span class="sxs-lookup"><span data-stu-id="60114-168">Also, if any of the directories or files specified in the `filenames` parameter is not found in the file system, it is treated as missing.</span></span> <span data-ttu-id="60114-169">如果找不到目錄或檔案具有相依性物件加入至中時<xref:System.Web.Caching.Cache>，快取的物件會移除<xref:System.Web.Caching.Cache>建立該目錄或檔案時。</span><span class="sxs-lookup"><span data-stu-id="60114-169">If a directory or file is missing when the object with the dependency is added to the <xref:System.Web.Caching.Cache>, the cached object will be removed from the <xref:System.Web.Caching.Cache> when that directory or file is created.</span></span>  
  
 <span data-ttu-id="60114-170">例如，假設您將物件加入<xref:System.Web.Caching.Cache>具有相依性的下列檔案路徑： c:\stocks\xyz.dat。</span><span class="sxs-lookup"><span data-stu-id="60114-170">For example, assume that you add an object to the <xref:System.Web.Caching.Cache> with a dependency on the following file path: c:\stocks\xyz.dat.</span></span> <span data-ttu-id="60114-171">如果該檔案找不到時<xref:System.Web.Caching.CacheDependency>，物件會建立，但稍後建立快取的物件會在 xyz.dat 檔案建立時移除。</span><span class="sxs-lookup"><span data-stu-id="60114-171">If that file is not found when the <xref:System.Web.Caching.CacheDependency> object is created, but is created later, the cached object is removed upon the creation of the xyz.dat file.</span></span>  
  
 <span data-ttu-id="60114-172">不過，`cachekeys`相依性無法運作方式相同。</span><span class="sxs-lookup"><span data-stu-id="60114-172">However, the `cachekeys` dependency does not work the same way.</span></span> <span data-ttu-id="60114-173">如果中至少一個值`cachekeys`參數不存在於插入的時間，則插入會失敗。</span><span class="sxs-lookup"><span data-stu-id="60114-173">If at least one value in the `cachekeys` parameter does not exist at the time of an insert, the insert fails.</span></span> <span data-ttu-id="60114-174">請注意，這種情況下，會擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="60114-174">Note that there is no exception thrown for this scenario.</span></span>  
  
## Examples  
 <span data-ttu-id="60114-175">下列程式碼片段將示範如何將項目插入您的應用程式<xref:System.Web.Caching.Cache>具有相依性的索引鍵，另一個項目放在快取中。</span><span class="sxs-lookup"><span data-stu-id="60114-175">The following code fragment demonstrates how to insert an item into your application's <xref:System.Web.Caching.Cache> with a dependency on a key to another item placed in the cache.</span></span> <span data-ttu-id="60114-176">因為這個方法會使用陣列語法，您必須定義索引鍵數目的項目加入<xref:System.Web.Caching.Cache>相依。</span><span class="sxs-lookup"><span data-stu-id="60114-176">Since this method uses array syntax, you must define the number of keys on which the item you are adding to the <xref:System.Web.Caching.Cache> is dependent.</span></span>  
  
 [!code-csharp[Key based dependency#1](~/samples/snippets/csharp/VS_Snippets_WebNet/Key based dependency/CS/DependencyKeycs.aspx#1)]
 [!code-vb[Key based dependency#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/Key based dependency/VB/DependencyKeyvb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public CacheDependency (string[] filenames, string[] cachekeys, DateTime start);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string[] filenames, string[] cachekeys, valuetype System.DateTime start) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.#ctor(System.String[],System.String[],System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (filenames As String(), cachekeys As String(), start As DateTime)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; CacheDependency(cli::array &lt;System::String ^&gt; ^ filenames, cli::array &lt;System::String ^&gt; ^ cachekeys, DateTime start);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="filenames" Type="System.String[]" />
        <Parameter Name="cachekeys" Type="System.String[]" />
        <Parameter Name="start" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="filenames">
          <span data-ttu-id="60114-177">快取物件所相依的檔案或目錄之路徑陣列。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-177">An array of paths (to files or directories) that the cached object is dependent upon.</span>
          </span>
          <span data-ttu-id="60114-178">當這些資源有任何項目變更時，快取物件就會變成過時，並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-178">When any of these resources changes, the cached object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <param name="cachekeys">
          <span data-ttu-id="60114-179">快取索引鍵的陣列，新物件會監視它的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-179">An array of cache keys that the new object monitors for changes.</span>
          </span>
          <span data-ttu-id="60114-180">當有任何快取索引鍵變更時，與這個相依性物件關聯的快取物件會變成過時，並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-180">When any of these cache keys changes, the cached object associated with this dependency object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <param name="start">
          <span data-ttu-id="60114-181">檢查傳入 <c>filenames</c> 和 <c>cachekeys</c> 陣列的物件上次修改日期的日期時間依據。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-181">The date and time against which to check the last modified date of the objects passed in the <c>filenames</c> and <c>cachekeys</c> arrays.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-182">初始化 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的新執行個體，其可監視檔案或目錄的路徑陣列、快取索引鍵的陣列或這兩者的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-182">Initializes a new instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class that monitors an array of paths (to files or directories), an array of cache keys, or both for changes.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-183">此外，如果任何目錄或檔案中指定`filenames`參數中找不到檔案系統中，它會被視為遺漏。</span><span class="sxs-lookup"><span data-stu-id="60114-183">Also, if any of the directories or files specified in the `filenames` parameter is not found in the file system, it is treated as missing.</span></span> <span data-ttu-id="60114-184">如果找不到目錄或檔案具有相依性物件加入至中時<xref:System.Web.Caching.Cache>，快取的物件會移除<xref:System.Web.Caching.Cache>建立該目錄或檔案時。</span><span class="sxs-lookup"><span data-stu-id="60114-184">If a directory or file is missing when the object with the dependency is added to the <xref:System.Web.Caching.Cache>, the cached object will be removed from the <xref:System.Web.Caching.Cache> when that directory or file is created.</span></span>  
  
 <span data-ttu-id="60114-185">例如，假設您將物件加入<xref:System.Web.Caching.Cache>具有相依性的下列檔案路徑： c:\stocks\xyz.dat。</span><span class="sxs-lookup"><span data-stu-id="60114-185">For example, assume that you add an object to the <xref:System.Web.Caching.Cache> with a dependency on the following file path: c:\stocks\xyz.dat.</span></span> <span data-ttu-id="60114-186">如果該檔案找不到時<xref:System.Web.Caching.CacheDependency>，物件會建立，但稍後建立快取的物件會在 xyz.dat 檔案建立時移除。</span><span class="sxs-lookup"><span data-stu-id="60114-186">If that file is not found when the <xref:System.Web.Caching.CacheDependency> object is created, but is created later, the cached object is removed upon the creation of the xyz.dat file.</span></span>  
  
 <span data-ttu-id="60114-187">不過，`cachekeys`相依性無法運作方式相同。</span><span class="sxs-lookup"><span data-stu-id="60114-187">However, the `cachekeys` dependency does not work the same way.</span></span> <span data-ttu-id="60114-188">如果中至少一個值`cachekeys`參數不存在於插入的時間，則插入會失敗。</span><span class="sxs-lookup"><span data-stu-id="60114-188">If at least one value in the `cachekeys` parameter does not exist at the time of an insert, the insert fails.</span></span> <span data-ttu-id="60114-189">請注意，這種情況下，會擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="60114-189">Note that there is no exception thrown for this scenario.</span></span>

> [!NOTE]
>  <span data-ttu-id="60114-190">變更追蹤會立即開始並不直接根據`start`參數。</span><span class="sxs-lookup"><span data-stu-id="60114-190">Change tracking begins immediately and is not directly based on the `start` parameter.</span></span> <span data-ttu-id="60114-191">使用`start`傳遞日期和時間，以針對您想要檢查的任何物件的上次修改的日期在過去的參數傳遞給`filenames`或`cachekeys`參數。</span><span class="sxs-lookup"><span data-stu-id="60114-191">Use the `start` parameter to pass a date and time in the past against which you want to check the last modified date of any object passed in the `filenames` or `cachekeys` parameters.</span></span> <span data-ttu-id="60114-192">如果上次修改任何這些物件的日期不晚於日期和時間設定傳入`start`參數，快取的項目移除從<xref:System.Web.Caching.Cache>。</span><span class="sxs-lookup"><span data-stu-id="60114-192">If the last modified date of any of those objects is later than the date and time set passed in the `start` parameter, the cached item is removed from the <xref:System.Web.Caching.Cache>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-193">下列程式碼範例會建立`CreateDependency`方法。</span><span class="sxs-lookup"><span data-stu-id="60114-193">The following code example creates a `CreateDependency` method.</span></span> <span data-ttu-id="60114-194">當呼叫此方法時，它會建立<xref:System.DateTime>物件和<xref:System.Web.Caching.Cache.Item%2A?displayProperty=nameWithType>屬性用來將項目加入至快取`key`參數`key1`以及值`Value 1`。</span><span class="sxs-lookup"><span data-stu-id="60114-194">When this method is called, it creates a <xref:System.DateTime> object and the <xref:System.Web.Caching.Cache.Item%2A?displayProperty=nameWithType> property is used to add an item to the cache with a `key` parameter of `key1` and a value of `Value 1`.</span></span> <span data-ttu-id="60114-195">Strings 的陣列， `dependencyKey`，接著會建立其值為`key1`以及。</span><span class="sxs-lookup"><span data-stu-id="60114-195">An array of strings, `dependencyKey`, is then created with the value of `key1` as well.</span></span> <span data-ttu-id="60114-196">這<xref:System.Web.Caching.CacheDependency>建構函式接著會執行個體化<xref:System.Web.Caching.CacheDependency>傳遞物件的`dependencyKey`和<xref:System.DateTime>做為參數的引數的物件。</span><span class="sxs-lookup"><span data-stu-id="60114-196">This <xref:System.Web.Caching.CacheDependency> constructor then instantiates a <xref:System.Web.Caching.CacheDependency> object that passes `dependencyKey` and the <xref:System.DateTime> object as parameter arguments.</span></span> <span data-ttu-id="60114-197"><xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType>方法使用接下來，呼叫<xref:System.Web.Caching.CacheDependency>物件做為參數。</span><span class="sxs-lookup"><span data-stu-id="60114-197">The <xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType> method is called next, using the <xref:System.Web.Caching.CacheDependency> object as a parameter.</span></span> <span data-ttu-id="60114-198">這樣就可以加入至快取使用的物件<xref:System.Web.Caching.Cache.Insert%2A>方法取決於`key1`索引鍵。</span><span class="sxs-lookup"><span data-stu-id="60114-198">This makes the object added to the cache using the <xref:System.Web.Caching.Cache.Insert%2A> method dependent on the `key1` key.</span></span>  
  
 [!code-csharp[CacheDependency Constructor6#1](~/samples/snippets/csharp/VS_Snippets_WebNet/CacheDependency Constructor6/CS/depkeytimecs.aspx#1)]
 [!code-vb[CacheDependency Constructor6#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/CacheDependency Constructor6/VB/depkeytimevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public CacheDependency (string[] filenames, string[] cachekeys, System.Web.Caching.CacheDependency dependency);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string[] filenames, string[] cachekeys, class System.Web.Caching.CacheDependency dependency) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.#ctor(System.String[],System.String[],System.Web.Caching.CacheDependency)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (filenames As String(), cachekeys As String(), dependency As CacheDependency)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; CacheDependency(cli::array &lt;System::String ^&gt; ^ filenames, cli::array &lt;System::String ^&gt; ^ cachekeys, System::Web::Caching::CacheDependency ^ dependency);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="filenames" Type="System.String[]" />
        <Parameter Name="cachekeys" Type="System.String[]" />
        <Parameter Name="dependency" Type="System.Web.Caching.CacheDependency" />
      </Parameters>
      <Docs>
        <param name="filenames">
          <span data-ttu-id="60114-199">快取物件所相依的檔案或目錄之路徑陣列。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-199">An array of paths (to files or directories) that the cached object is dependent upon.</span>
          </span>
          <span data-ttu-id="60114-200">當這些資源有任何項目變更時，快取物件就會變成過時，並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-200">When any of these resources changes, the cached object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <param name="cachekeys">
          <span data-ttu-id="60114-201">快取索引鍵的陣列，新物件會監視它的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-201">An array of cache keys that the new object monitors for changes.</span>
          </span>
          <span data-ttu-id="60114-202">當有任何快取索引鍵變更時，與這個相依性物件關聯的快取物件會變成過時，並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-202">When any of these cache keys changes, the cached object associated with this dependency object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <param name="dependency">
          <span data-ttu-id="60114-203">這個執行個體相依之 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的另一個執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-203">Another instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class that this instance is dependent upon.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-204">初始化 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的新執行個體，其可監視檔案或目錄的路徑陣列、快取索引鍵的陣列或這兩者的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-204">Initializes a new instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class that monitors an array of paths (to files or directories), an array of cache keys, or both for changes.</span>
          </span>
          <span data-ttu-id="60114-205">它也會使本身相依於 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的個別執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-205">It also makes itself dependent upon a separate instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-206">此外，如果任何目錄或檔案中指定`filenames`參數中找不到檔案系統中，它會被視為遺漏。</span><span class="sxs-lookup"><span data-stu-id="60114-206">Also, if any of the directories or files specified in the `filenames` parameter is not found in the file system, it is treated as missing.</span></span> <span data-ttu-id="60114-207">如果找不到目錄或檔案具有相依性物件加入至中時<xref:System.Web.Caching.Cache>，快取的物件會移除<xref:System.Web.Caching.Cache>建立該目錄或檔案時。</span><span class="sxs-lookup"><span data-stu-id="60114-207">If a directory or file is missing when the object with the dependency is added to the <xref:System.Web.Caching.Cache>, the cached object will be removed from the <xref:System.Web.Caching.Cache> when that directory or file is created.</span></span>  
  
 <span data-ttu-id="60114-208">例如，假設您將物件加入<xref:System.Web.Caching.Cache>具有相依性的下列檔案路徑： c:\stocks\xyz.dat。</span><span class="sxs-lookup"><span data-stu-id="60114-208">For example, assume that you add an object to the <xref:System.Web.Caching.Cache> with a dependency on the following file path: c:\stocks\xyz.dat.</span></span> <span data-ttu-id="60114-209">如果該檔案找不到時<xref:System.Web.Caching.CacheDependency>，物件會建立，但稍後建立快取的物件會在 xyz.dat 檔案建立時移除。</span><span class="sxs-lookup"><span data-stu-id="60114-209">If that file is not found when the <xref:System.Web.Caching.CacheDependency> object is created, but is created later, the cached object is removed upon the creation of the xyz.dat file.</span></span>  
  
 <span data-ttu-id="60114-210">不過，`cachekeys`相依性無法運作方式相同。</span><span class="sxs-lookup"><span data-stu-id="60114-210">However, the `cachekeys` dependency does not work the same way.</span></span> <span data-ttu-id="60114-211">如果中至少一個值`cachekeys`參數不存在於插入的時間，則插入會失敗。</span><span class="sxs-lookup"><span data-stu-id="60114-211">If at least one value in the `cachekeys` parameter does not exist at the time of an insert, the insert fails.</span></span> <span data-ttu-id="60114-212">請注意，這種情況下，會擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="60114-212">Note that there is no exception thrown for this scenario.</span></span>
  
## Examples  
 <span data-ttu-id="60114-213">下列程式碼範例會建立`CreateDependency`方法。</span><span class="sxs-lookup"><span data-stu-id="60114-213">The following code example creates a `CreateDependency` method.</span></span> <span data-ttu-id="60114-214">當呼叫此方法時，它會使用<xref:System.Web.Caching.Cache.Item%2A?displayProperty=nameWithType>屬性新增至快取的項目`key`參數`key1`以及值`Value 1`。</span><span class="sxs-lookup"><span data-stu-id="60114-214">When this method is called, it uses the <xref:System.Web.Caching.Cache.Item%2A?displayProperty=nameWithType> property to add an item to the cache with a `key` parameter of `key1` and a value of `Value 1`.</span></span> <span data-ttu-id="60114-215">Strings 的陣列， `dependencyKey`，接著會建立其值為`key1`以及。</span><span class="sxs-lookup"><span data-stu-id="60114-215">An array of strings, `dependencyKey`, is then created with the value of `key1` as well.</span></span> <span data-ttu-id="60114-216"><xref:System.Web.Caching.CacheDependency.%23ctor%2A?displayProperty=nameWithType>建構函式用來建立<xref:System.Web.Caching.CacheDependency>物件`dep1`，哪個階段`dependencyKey`做為參數引數。</span><span class="sxs-lookup"><span data-stu-id="60114-216">The <xref:System.Web.Caching.CacheDependency.%23ctor%2A?displayProperty=nameWithType> constructor is used to create a <xref:System.Web.Caching.CacheDependency> object, `dep1`, which passes `dependencyKey` as a parameter argument.</span></span> <span data-ttu-id="60114-217">第二個<xref:System.Web.Caching.CacheDependency>物件`dep2`，會使用這個建構函式，以建立`dep1`傳遞做為第三個參數引數。</span><span class="sxs-lookup"><span data-stu-id="60114-217">A second <xref:System.Web.Caching.CacheDependency> object, `dep2`, is created using this constructor, with `dep1` passed as the third parameter argument.</span></span> <span data-ttu-id="60114-218">此第二個相依性會相依於第一個項目。</span><span class="sxs-lookup"><span data-stu-id="60114-218">This second dependency is dependent on the first.</span></span> <span data-ttu-id="60114-219"><xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType>方法使用第二個接下來，呼叫<xref:System.Web.Caching.CacheDependency>物件做為參數。</span><span class="sxs-lookup"><span data-stu-id="60114-219">The <xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType> method is called next, using the second <xref:System.Web.Caching.CacheDependency> object as a parameter.</span></span> <span data-ttu-id="60114-220">如果第一個相依性以任何方式變更，快取的項目將會失效。</span><span class="sxs-lookup"><span data-stu-id="60114-220">If the first dependency changes in any way, the cached item will be invalidated.</span></span>  
  
 [!code-csharp[CacheDependency Constructor7#1](~/samples/snippets/csharp/VS_Snippets_WebNet/CacheDependency Constructor7/CS/dependencycs.aspx#1)]
 [!code-vb[CacheDependency Constructor7#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/CacheDependency Constructor7/VB/dependencyvb.aspx#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public CacheDependency (string[] filenames, string[] cachekeys, System.Web.Caching.CacheDependency dependency, DateTime start);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string[] filenames, string[] cachekeys, class System.Web.Caching.CacheDependency dependency, valuetype System.DateTime start) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.#ctor(System.String[],System.String[],System.Web.Caching.CacheDependency,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (filenames As String(), cachekeys As String(), dependency As CacheDependency, start As DateTime)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; CacheDependency(cli::array &lt;System::String ^&gt; ^ filenames, cli::array &lt;System::String ^&gt; ^ cachekeys, System::Web::Caching::CacheDependency ^ dependency, DateTime start);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="filenames" Type="System.String[]" />
        <Parameter Name="cachekeys" Type="System.String[]" />
        <Parameter Name="dependency" Type="System.Web.Caching.CacheDependency" />
        <Parameter Name="start" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="filenames">
          <span data-ttu-id="60114-221">快取物件所相依的檔案或目錄之路徑陣列。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-221">An array of paths (to files or directories) that the cached object is dependent upon.</span>
          </span>
          <span data-ttu-id="60114-222">當這些資源有任何項目變更時，快取物件就會變成過時，並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-222">When any of these resources changes, the cached object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <param name="cachekeys">
          <span data-ttu-id="60114-223">快取索引鍵的陣列，新物件會監視它的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-223">An array of cache keys that the new object monitors for changes.</span>
          </span>
          <span data-ttu-id="60114-224">當有任何快取索引鍵變更時，與這個相依性物件關聯的快取物件會變成過時，並從快取中移除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-224">When any of these cache keys changes, the cached object associated with this dependency object becomes obsolete and is removed from the cache.</span>
          </span>
        </param>
        <param name="dependency">
          <span data-ttu-id="60114-225">這個執行個體相依之 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的另一個執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-225">Another instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class that this instance is dependent upon.</span>
          </span>
        </param>
        <param name="start">
          <span data-ttu-id="60114-226">檢查陣列中物件和 <see cref="T:System.Web.Caching.CacheDependency" /> 物件的上次修改日期所根據的時間。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-226">The time against which to check the last modified date of the objects in the arrays and the <see cref="T:System.Web.Caching.CacheDependency" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-227">初始化 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的新執行個體，其可監視檔案或目錄的路徑陣列、快取索引鍵的陣列或這兩者的變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-227">Initializes a new instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class that monitors an array of paths (to files or directories), an array of cache keys, or both for changes.</span>
          </span>
          <span data-ttu-id="60114-228">它也會使本身相依於 <see cref="T:System.Web.Caching.CacheDependency" /> 類別的另一個執行個體和開始監控變更的時間。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-228">It also makes itself dependent upon another instance of the <see cref="T:System.Web.Caching.CacheDependency" /> class and a time when the change monitoring begins.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-229">此外，如果任何目錄或檔案中指定`filenames`參數中找不到檔案系統中，它會被視為遺漏。</span><span class="sxs-lookup"><span data-stu-id="60114-229">Also, if any of the directories or files specified in the `filenames` parameter is not found in the file system, it is treated as missing.</span></span> <span data-ttu-id="60114-230">如果找不到目錄或檔案具有相依性物件加入至中時<xref:System.Web.Caching.Cache>，快取的物件會移除<xref:System.Web.Caching.Cache>建立該目錄或檔案時。</span><span class="sxs-lookup"><span data-stu-id="60114-230">If a directory or file is missing when the object with the dependency is added to the <xref:System.Web.Caching.Cache>, the cached object will be removed from the <xref:System.Web.Caching.Cache> when that directory or file is created.</span></span>  
  
 <span data-ttu-id="60114-231">例如，假設您將物件加入<xref:System.Web.Caching.Cache>具有相依性的下列檔案路徑： c:\stocks\xyz.dat。</span><span class="sxs-lookup"><span data-stu-id="60114-231">For example, assume that you add an object to the <xref:System.Web.Caching.Cache> with a dependency on the following file path: c:\stocks\xyz.dat.</span></span> <span data-ttu-id="60114-232">如果該檔案找不到時<xref:System.Web.Caching.CacheDependency>，物件會建立，但稍後建立快取的物件會在 xyz.dat 檔案建立時移除。</span><span class="sxs-lookup"><span data-stu-id="60114-232">If that file is not found when the <xref:System.Web.Caching.CacheDependency> object is created, but is created later, the cached object is removed upon the creation of the xyz.dat file.</span></span>  
 
 <span data-ttu-id="60114-233">不過，`cachekeys`相依性無法運作方式相同。</span><span class="sxs-lookup"><span data-stu-id="60114-233">However, the `cachekeys` dependency does not work the same way.</span></span> <span data-ttu-id="60114-234">如果中至少一個值`cachekeys`參數不存在於插入的時間，則插入會失敗。</span><span class="sxs-lookup"><span data-stu-id="60114-234">If at least one value in the `cachekeys` parameter does not exist at the time of an insert, the insert fails.</span></span> <span data-ttu-id="60114-235">請注意，這種情況下，會擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="60114-235">Note that there is no exception thrown for this scenario.</span></span>

> [!NOTE]
>  <span data-ttu-id="60114-236">變更追蹤會立即開始並不直接根據`start`參數。</span><span class="sxs-lookup"><span data-stu-id="60114-236">Change tracking begins immediately and is not directly based on the `start` parameter.</span></span> <span data-ttu-id="60114-237">使用`start`傳遞日期和時間，以針對您想要檢查的任何物件的上次修改的日期在過去的參數傳遞給`filenames`， `cachekeys`，或`dependency`參數。</span><span class="sxs-lookup"><span data-stu-id="60114-237">Use the `start` parameter to pass a date and time in the past against which you want to check the last modified date of any of the objects passed in the `filenames`, `cachekeys`, or `dependency` parameters.</span></span> <span data-ttu-id="60114-238">如果上次修改日期的任何這些物件是晚於日期和時間傳入`start`參數，快取的項目移除從<xref:System.Web.Caching.Cache>。</span><span class="sxs-lookup"><span data-stu-id="60114-238">If the last modified date for any of those objects is later than the date and time passed in the `start` parameter, the cached item is removed from the <xref:System.Web.Caching.Cache>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-239">下列程式碼範例示範`CreateDependency`方法。</span><span class="sxs-lookup"><span data-stu-id="60114-239">The following code example shows a `CreateDependency` method.</span></span> <span data-ttu-id="60114-240">當呼叫此方法時，它會建立<xref:System.DateTime>物件和<xref:System.Web.Caching.Cache.Item%2A?displayProperty=nameWithType>屬性用來將項目至快取的索引鍵參數`key1`以及值`Value 1`。</span><span class="sxs-lookup"><span data-stu-id="60114-240">When this method is called, it creates a <xref:System.DateTime> object and the <xref:System.Web.Caching.Cache.Item%2A?displayProperty=nameWithType> property is used to add an item to the cache with a key parameter of `key1` and a value of `Value 1`.</span></span> <span data-ttu-id="60114-241">Strings 的陣列， `dependencyKey`，接著會建立與設定的值為其第一個 （且唯一） 索引處的值`key1`以及。</span><span class="sxs-lookup"><span data-stu-id="60114-241">An array of strings, `dependencyKey`, is then created with the value at its first (and only) index set to the value of `key1` as well.</span></span> <span data-ttu-id="60114-242"><xref:System.Web.Caching.CacheDependency.%23ctor%2A?displayProperty=nameWithType>建構函式後用於建立<xref:System.Web.Caching.CacheDependency>物件`dep1`，哪個階段`dependencyKey`做為參數引數。</span><span class="sxs-lookup"><span data-stu-id="60114-242">The <xref:System.Web.Caching.CacheDependency.%23ctor%2A?displayProperty=nameWithType> constructor is then used to create a <xref:System.Web.Caching.CacheDependency> object, `dep1`, which passes `dependencyKey` as a parameter argument.</span></span> <span data-ttu-id="60114-243">第二個<xref:System.Web.Caching.CacheDependency>物件`dep2`，然後建立使用這個建構函式，`dep1`和<xref:System.DateTime>物件傳遞為參數的引數。</span><span class="sxs-lookup"><span data-stu-id="60114-243">A second <xref:System.Web.Caching.CacheDependency> object, `dep2`, is then created using this constructor, with `dep1` and the <xref:System.DateTime> object passed as parameter arguments.</span></span> <span data-ttu-id="60114-244">此第二個相依性，是根據第一和相依性監視會開始，10 秒後`CreateDependency`方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="60114-244">This second dependency is dependent on the first, and dependency monitoring will begin 10 seconds after the `CreateDependency` method is called.</span></span> <span data-ttu-id="60114-245"><xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType>方法使用第二個接下來，呼叫<xref:System.Web.Caching.CacheDependency>物件做為參數。</span><span class="sxs-lookup"><span data-stu-id="60114-245">The <xref:System.Web.Caching.Cache.Insert%2A?displayProperty=nameWithType> method is called next, using the second <xref:System.Web.Caching.CacheDependency> object as a parameter.</span></span> <span data-ttu-id="60114-246">如果第一個相依性以任何方式變更，快取的項目將會失效。</span><span class="sxs-lookup"><span data-stu-id="60114-246">If the first dependency changes in any way, the cached item will be invalidated.</span></span>  
  
 [!code-csharp[CacheDependency Constructor8#1](~/samples/snippets/csharp/VS_Snippets_WebNet/CacheDependency Constructor8/CS/dependencytimecs.aspx#1)]
 [!code-vb[CacheDependency Constructor8#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/CacheDependency Constructor8/VB/dependencytimevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </Member>
    <Member MemberName="DependencyDispose">
      <MemberSignature Language="C#" Value="protected virtual void DependencyDispose ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig newslot virtual instance void DependencyDispose() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.DependencyDispose" />
      <MemberSignature Language="VB.NET" Value="Protected Overridable Sub DependencyDispose ()" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; virtual void DependencyDispose();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="60114-247">釋放由 <see cref="T:System.Web.Caching.CacheDependency" /> 類別及任何衍生自 <see cref="T:System.Web.Caching.CacheDependency" /> 的類別所使用的資源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-247">Releases the resources used by the <see cref="T:System.Web.Caching.CacheDependency" /> class and any classes that derive from <see cref="T:System.Web.Caching.CacheDependency" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-248">任何衍生自的類別<xref:System.Web.Caching.CacheDependency>類別實作時需要這個方法，以清除的資源已在使用衍生的類別。</span><span class="sxs-lookup"><span data-stu-id="60114-248">Any class that derives from the <xref:System.Web.Caching.CacheDependency> class is required to implement this method to clean up resources the derived class has used.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-249">下列程式碼範例示範繼承自類別<xref:System.Web.Caching.CacheDependency>類別並覆寫<xref:System.Web.Caching.CacheDependency.DependencyDispose%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="60114-249">The following code example shows a class that inherits from the <xref:System.Web.Caching.CacheDependency> class and overrides the <xref:System.Web.Caching.CacheDependency.DependencyDispose%2A> method.</span></span> <span data-ttu-id="60114-250">呼叫這個方法時，它會設定自訂的布林值屬性，名為`Disposed`至`true`。</span><span class="sxs-lookup"><span data-stu-id="60114-250">When this method is called, it sets a custom Boolean property named `Disposed` to `true`.</span></span>  
  
 [!code-vb[CacheDependency_Whidbey_Example1#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/CacheDependency_Whidbey_Example1/VB/cachedependencysample.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="public void Dispose ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void Dispose() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.Dispose" />
      <MemberSignature Language="VB.NET" Value="Public Sub Dispose ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void Dispose();" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.IDisposable.Dispose</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="60114-251">釋放 <see cref="T:System.Web.Caching.CacheDependency" /> 物件所使用的資源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-251">Releases the resources used by the <see cref="T:System.Web.Caching.CacheDependency" /> object.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="FinishInit">
      <MemberSignature Language="C#" Value="protected internal void FinishInit ();" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblyhidebysig instance void FinishInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.FinishInit" />
      <MemberSignature Language="VB.NET" Value="Protected Friend Sub FinishInit ()" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; void FinishInit();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="60114-252">完成 <see cref="T:System.Web.Caching.CacheDependency" /> 物件的初始化。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-252">Completes initialization of the <see cref="T:System.Web.Caching.CacheDependency" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-253"><xref:System.Web.Caching.CacheDependency.FinishInit%2A>方法完成初始化<xref:System.Web.Caching.CacheDependency>物件。</span><span class="sxs-lookup"><span data-stu-id="60114-253">The <xref:System.Web.Caching.CacheDependency.FinishInit%2A> method completes the initialization of the <xref:System.Web.Caching.CacheDependency> object.</span></span> <span data-ttu-id="60114-254">這個方法會呼叫所有<xref:System.Web.Caching.CacheDependency>建構函式。</span><span class="sxs-lookup"><span data-stu-id="60114-254">This method is called by all <xref:System.Web.Caching.CacheDependency> constructors.</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides">
          <para>
            <span data-ttu-id="60114-255">
              <see cref="M:System.Web.Caching.CacheDependency.FinishInit" />方法必須完成的初始化衍生類別的建構函式結束時呼叫<see cref="T:System.Web.Caching.CacheDependency" />物件。</span>
            <span class="sxs-lookup">
              <span data-stu-id="60114-255">The <see cref="M:System.Web.Caching.CacheDependency.FinishInit" /> method must be called at the end of the constructor for derived classes to complete the initialization of the <see cref="T:System.Web.Caching.CacheDependency" /> object.</span>
            </span>
          </para>
        </block>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </Member>
    <Member MemberName="GetFileDependencies">
      <MemberSignature Language="C#" Value="public virtual string[] GetFileDependencies ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string[] GetFileDependencies() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.GetFileDependencies" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetFileDependencies () As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual cli::array &lt;System::String ^&gt; ^ GetFileDependencies();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="60114-256">取得檔案相依性。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-256">Gets the file dependencies.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="60114-257">檔案相依性。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-257">The file dependencies.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="GetUniqueID">
      <MemberSignature Language="C#" Value="public virtual string GetUniqueID ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string GetUniqueID() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.GetUniqueID" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetUniqueID () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::String ^ GetUniqueID();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="60114-258">擷取 <see cref="T:System.Web.Caching.CacheDependency" /> 物件的唯一識別項。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-258">Retrieves a unique identifier for a <see cref="T:System.Web.Caching.CacheDependency" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="60114-259">
            <see cref="T:System.Web.Caching.CacheDependency" /> 物件的唯一識別碼。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-259">The unique identifier for the <see cref="T:System.Web.Caching.CacheDependency" /> object.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-260">這個方法會特別有用的追蹤多個執行個體<xref:System.Web.Caching.CacheDependency>項目或應用程式相關聯的類別。</span><span class="sxs-lookup"><span data-stu-id="60114-260">This method can be particularly useful for tracking multiple instances of the <xref:System.Web.Caching.CacheDependency> class associated with an item or an application.</span></span>  
  
 <span data-ttu-id="60114-261">識別碼是 （適用於檔案相依性） 的檔案名稱或索引鍵的名稱 （適用於快取索引鍵的相依性） 和字串，這個方法會將指派給相依性的組合。</span><span class="sxs-lookup"><span data-stu-id="60114-261">The identifier is a combination of either the file name (for a file dependency) or the key name (for a cache-key dependency) and a string that this method assigns to the dependency.</span></span> <span data-ttu-id="60114-262">在衍生自的<xref:System.Web.Caching.CacheDependency>類別，您可以覆寫這個方法以自訂方式會產生的唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="60114-262">In classes that derive from the <xref:System.Web.Caching.CacheDependency> class, you can override this method to customize how it generates the unique identifier.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-263">下列程式碼範例會建立<xref:System.Web.Caching.AggregateCacheDependency>物件，名為`aggDep`，具有兩個<xref:System.Web.Caching.CacheDependency>其陣列中的物件。</span><span class="sxs-lookup"><span data-stu-id="60114-263">The following code example creates an <xref:System.Web.Caching.AggregateCacheDependency> object, named `aggDep`, with two <xref:System.Web.Caching.CacheDependency> objects in its array.</span></span> <span data-ttu-id="60114-264">一次`aggDep`具現化程式碼會呼叫<xref:System.Web.Caching.CacheDependency.GetUniqueID%2A>方法來產生兩個相依性的唯一識別碼，`aggDep`包含並顯示包含頁面的識別碼。</span><span class="sxs-lookup"><span data-stu-id="60114-264">Once `aggDep` is instantiated, the code calls the <xref:System.Web.Caching.CacheDependency.GetUniqueID%2A> method to generate a unique identifier for both dependencies that `aggDep` contains and displays the identifiers to the containing page.</span></span> <span data-ttu-id="60114-265">若要再加入項目<xref:System.Web.Caching.Cache>，並使用<xref:System.Web.Caching.Cache.Insert%2A>方法，與`aggDep`做為相依性。</span><span class="sxs-lookup"><span data-stu-id="60114-265">An item is then added to the <xref:System.Web.Caching.Cache>, using the <xref:System.Web.Caching.Cache.Insert%2A> method, with `aggDep` as a dependency.</span></span>  
  
 [!code-vb[CachingSamples_AggregateCacheDependency1#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/CachingSamples_AggregateCacheDependency1/VB/aggregatecachedependencysamplevb.aspx#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
      </Docs>
    </Member>
    <Member MemberName="HasChanged">
      <MemberSignature Language="C#" Value="public bool HasChanged { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool HasChanged" />
      <MemberSignature Language="DocId" Value="P:System.Web.Caching.CacheDependency.HasChanged" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property HasChanged As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool HasChanged { bool get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="60114-266">取得值，指出 <see cref="T:System.Web.Caching.CacheDependency" /> 是否已經變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-266">Gets a value indicating whether the <see cref="T:System.Web.Caching.CacheDependency" /> object has changed.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="60114-267">如果 <see cref="T:System.Web.Caching.CacheDependency" /> 物件已經變更，則為 <see langword="true" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-267">
              <see langword="true" /> if the <see cref="T:System.Web.Caching.CacheDependency" /> object has changed; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="60114-268">預設值為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-268">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-269">您可以將項目加入至 ASP.NET 應用程式的<xref:System.Web.Caching.Cache>與<xref:System.Web.Caching.CacheDependency>。</span><span class="sxs-lookup"><span data-stu-id="60114-269">You can add an item to an ASP.NET application's <xref:System.Web.Caching.Cache> with a <xref:System.Web.Caching.CacheDependency>.</span></span> <span data-ttu-id="60114-270">當<xref:System.Web.Caching.CacheDependency>變更時，若要加入的項目<xref:System.Web.Caching.Cache>失效，並從快取中移除。</span><span class="sxs-lookup"><span data-stu-id="60114-270">When the <xref:System.Web.Caching.CacheDependency> changes, the item added to the <xref:System.Web.Caching.Cache> is invalidated and removed from the cache.</span></span> <span data-ttu-id="60114-271">您可以使用這個屬性來判斷是否<xref:System.Web.Caching.CacheDependency>已變更，並重新建立中的項目<xref:System.Web.Caching.Cache>，已發生。</span><span class="sxs-lookup"><span data-stu-id="60114-271">You can use this property to determine whether a <xref:System.Web.Caching.CacheDependency> has changed, and recreate the item in the <xref:System.Web.Caching.Cache> if that has occurred.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-272">下列程式碼範例示範如何使用<xref:System.Web.Caching.CacheDependency.HasChanged%2A>屬性來判斷是否<xref:System.Web.Caching.CacheDependency>自前一個要求中的項目變更<xref:System.Web.Caching.Cache>。</span><span class="sxs-lookup"><span data-stu-id="60114-272">The following code example demonstrates using the <xref:System.Web.Caching.CacheDependency.HasChanged%2A> property to determine whether a <xref:System.Web.Caching.CacheDependency> changed since the previous request for an item in the <xref:System.Web.Caching.Cache>.</span></span> <span data-ttu-id="60114-273">`dt`傳入值`start`參數設定為<xref:System.DateTime.Now%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="60114-273">The `dt` value passed in the `start` parameter is set to <xref:System.DateTime.Now%2A?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[System.Web.Caching.CacheDependency_HasChanged#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Caching.CacheDependency_HasChanged/CS/t.cs.aspx#1)]
 [!code-vb[System.Web.Caching.CacheDependency_HasChanged#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Caching.CacheDependency_HasChanged/VB/t.vb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </Member>
    <Member MemberName="ItemRemoved">
      <MemberSignature Language="C#" Value="public void ItemRemoved ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ItemRemoved() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.ItemRemoved" />
      <MemberSignature Language="VB.NET" Value="Public Sub ItemRemoved ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ItemRemoved();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="60114-274">已在移除受監視的快取項目時呼叫。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-274">Called when a monitored cache entry is removed.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="KeepDependenciesAlive">
      <MemberSignature Language="C#" Value="public void KeepDependenciesAlive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void KeepDependenciesAlive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.KeepDependenciesAlive" />
      <MemberSignature Language="VB.NET" Value="Public Sub KeepDependenciesAlive ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void KeepDependenciesAlive();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="60114-275">針對相依於這個項目的每個快取項目，更新上次存取時間。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-275">Updates the last access time of every cache item that depends on this item.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="NotifyDependencyChanged">
      <MemberSignature Language="C#" Value="protected void NotifyDependencyChanged (object sender, EventArgs e);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig instance void NotifyDependencyChanged(object sender, class System.EventArgs e) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.NotifyDependencyChanged(System.Object,System.EventArgs)" />
      <MemberSignature Language="VB.NET" Value="Protected Sub NotifyDependencyChanged (sender As Object, e As EventArgs)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; void NotifyDependencyChanged(System::Object ^ sender, EventArgs ^ e);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sender" Type="System.Object" />
        <Parameter Name="e" Type="System.EventArgs" />
      </Parameters>
      <Docs>
        <param name="sender">
          <span data-ttu-id="60114-276">事件的來源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-276">The source of the event.</span>
          </span>
        </param>
        <param name="e">
          <span data-ttu-id="60114-277">包含事件資料的 <see cref="T:System.EventArgs" /> 物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-277">An <see cref="T:System.EventArgs" /> object that contains the event data.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-278">告知基底 <see cref="T:System.Web.Caching.CacheDependency" /> 物件，由衍生的 <see cref="T:System.Web.Caching.CacheDependency" /> 類別所表示的相依性已經變更。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-278">Notifies the base <see cref="T:System.Web.Caching.CacheDependency" /> object that the dependency represented by a derived <see cref="T:System.Web.Caching.CacheDependency" /> class has changed.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-279">任何衍生自的類別<xref:System.Web.Caching.CacheDependency>類別必須實作這個方法。</span><span class="sxs-lookup"><span data-stu-id="60114-279">Any class that derives from the <xref:System.Web.Caching.CacheDependency> class must implement this method.</span></span>  
  
 <span data-ttu-id="60114-280">當您衍生自<xref:System.Web.Caching.CacheDependency>類別，使用任何方法或屬性，您不覆寫的基底功能。</span><span class="sxs-lookup"><span data-stu-id="60114-280">When you derive from the <xref:System.Web.Caching.CacheDependency> class, you use the base functionality of any method or property that you have not overridden.</span></span> <span data-ttu-id="60114-281">當您建立衍生類別的執行個體時，它代表檔案、 快取索引鍵、 資料庫資料表或您想要使快取的項目相依於其他任意物件。</span><span class="sxs-lookup"><span data-stu-id="60114-281">When you create an instance of the derived class, it represents the files, cache keys, database tables, or other arbitrary objects that you want to make a cached item dependent upon.</span></span> <span data-ttu-id="60114-282">當相依性項目變更時，這個方法會通知的基本功能<xref:System.Web.Caching.CacheDependency>類別的項目已變更，讓值<xref:System.Web.Caching.CacheDependency.HasChanged%2A>和<xref:System.Web.Caching.CacheDependency.UtcLastModified%2A>屬性皆可更新。</span><span class="sxs-lookup"><span data-stu-id="60114-282">When a dependency item changes, this method notifies the base functionality of the <xref:System.Web.Caching.CacheDependency> class that the item has changed, so that the values of the <xref:System.Web.Caching.CacheDependency.HasChanged%2A> and <xref:System.Web.Caching.CacheDependency.UtcLastModified%2A> properties can be updated.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-283">下列程式碼範例示範繼承自類別<xref:System.Web.Caching.CacheDependency>類別。</span><span class="sxs-lookup"><span data-stu-id="60114-283">The following code example shows a class that inherits from the <xref:System.Web.Caching.CacheDependency> class.</span></span> <span data-ttu-id="60114-284">它會建立公用的方法`ResetDependency`，使用<xref:System.Web.Caching.CacheDependency.SetUtcLastModified%2A>方法，以變更所在的相依性修改的時間，然後呼叫<xref:System.Web.Caching.CacheDependency.NotifyDependencyChanged%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="60114-284">It creates a public method, `ResetDependency`, that uses the <xref:System.Web.Caching.CacheDependency.SetUtcLastModified%2A> method to change the time at which the dependency was modified, and then calls the <xref:System.Web.Caching.CacheDependency.NotifyDependencyChanged%2A> method.</span></span>  
  
 [!code-vb[CacheDependency_Whidbey_Example1#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/CacheDependency_Whidbey_Example1/VB/cachedependencysample.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </Member>
    <Member MemberName="SetCacheDependencyChanged">
      <MemberSignature Language="C#" Value="public void SetCacheDependencyChanged (Action&lt;object,EventArgs&gt; dependencyChangedAction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetCacheDependencyChanged(class System.Action`2&lt;object, class System.EventArgs&gt; dependencyChangedAction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.SetCacheDependencyChanged(System.Action{System.Object,System.EventArgs})" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetCacheDependencyChanged (dependencyChangedAction As Action(Of Object, EventArgs))" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetCacheDependencyChanged(Action&lt;System::Object ^, EventArgs ^&gt; ^ dependencyChangedAction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="dependencyChangedAction" Type="System.Action&lt;System.Object,System.EventArgs&gt;" />
      </Parameters>
      <Docs>
        <param name="dependencyChangedAction">
          <span data-ttu-id="60114-285">相依性已變更的動作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-285">The dependency changed action.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-286">加入 Action 方法來處理在變更此相依性時通知有興趣的對象。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-286">Adds an Action method to handle notifying interested party in changes to this dependency.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="SetUtcLastModified">
      <MemberSignature Language="C#" Value="protected void SetUtcLastModified (DateTime utcLastModified);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig instance void SetUtcLastModified(valuetype System.DateTime utcLastModified) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.SetUtcLastModified(System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Protected Sub SetUtcLastModified (utcLastModified As DateTime)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; void SetUtcLastModified(DateTime utcLastModified);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="utcLastModified" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="utcLastModified">
          <span data-ttu-id="60114-287">上次變更相依性的時間。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-287">The time when the dependency last changed.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="60114-288">標記上次變更相依性的時間。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-288">Marks the time when a dependency last changed.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="60114-289">下列程式碼範例示範繼承自類別<xref:System.Web.Caching.CacheDependency>類別。</span><span class="sxs-lookup"><span data-stu-id="60114-289">The following code example shows a class that inherits from the <xref:System.Web.Caching.CacheDependency> class.</span></span> <span data-ttu-id="60114-290">它會建立公用的方法`ResetDependency`，使用<xref:System.Web.Caching.CacheDependency.SetUtcLastModified%2A>方法，以變更所在的相依性修改的時間，然後呼叫<xref:System.Web.Caching.CacheDependency.NotifyDependencyChanged%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="60114-290">It creates a public method, `ResetDependency`, that uses the <xref:System.Web.Caching.CacheDependency.SetUtcLastModified%2A> method to change the time at which the dependency was modified, and then calls the <xref:System.Web.Caching.CacheDependency.NotifyDependencyChanged%2A> method.</span></span>  
  
 [!code-vb[CacheDependency_Whidbey_Example1#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/CacheDependency_Whidbey_Example1/VB/cachedependencysample.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </Member>
    <Member MemberName="TakeOwnership">
      <MemberSignature Language="C#" Value="public bool TakeOwnership ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool TakeOwnership() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Caching.CacheDependency.TakeOwnership" />
      <MemberSignature Language="VB.NET" Value="Public Function TakeOwnership () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool TakeOwnership();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="60114-291">允許第一位使用者宣告這個相依性的獨佔擁有權。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-291">Allows the first user to declare exclusive ownership of this dependency.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="60114-292">如果項目是第一個取得擁有權的項目，則為 <see langword="true" /><see langword="true" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-292">
              <see langword="true" />
              <see langword="true" /> if the item was the first to take ownership otherwise <see langword="false" />.</span>
          </span>
          <span data-ttu-id="60114-293">
            <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-293">
              <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-294">這個方法宣告使用的相依性。</span><span class="sxs-lookup"><span data-stu-id="60114-294">This method declares that the dependency is used.</span></span> <span data-ttu-id="60114-295">如果另一個項目之前呼叫這個方法，並擁有權，`false`傳回。</span><span class="sxs-lookup"><span data-stu-id="60114-295">If another item previously called this method and took ownership, `false` is returned.</span></span> <span data-ttu-id="60114-296">A<xref:System.Web.Caching.CacheDependency>僅能由一個快取項目。</span><span class="sxs-lookup"><span data-stu-id="60114-296">A  <xref:System.Web.Caching.CacheDependency> can only be used by one cache entry.</span></span> <span data-ttu-id="60114-297">當項目具有任何指定的快取相依性加入至快取時，快取應該採取這些相依性，以確定，它們都不會重複使用某處其他擁有的權。</span><span class="sxs-lookup"><span data-stu-id="60114-297">When an item is added to a cache with any cache dependencies specified, the cache should take ownership of those dependencies to make sure that they are not reused somewhere else.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="UtcLastModified">
      <MemberSignature Language="C#" Value="public DateTime UtcLastModified { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime UtcLastModified" />
      <MemberSignature Language="DocId" Value="P:System.Web.Caching.CacheDependency.UtcLastModified" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property UtcLastModified As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime UtcLastModified { DateTime get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="60114-298">取得上次變更相依性的時間。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-298">Gets the time when the dependency was last changed.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="60114-299">上次變更相依性的時間。</span>
          <span class="sxs-lookup">
            <span data-stu-id="60114-299">The time when the dependency was last changed.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="60114-300">這個屬性的測量以國際標準時間 (UTC) （也稱為格林威治標準時間）。</span><span class="sxs-lookup"><span data-stu-id="60114-300">This property is measured in Coordinated Universal Time (UTC) (also known as Greenwich Mean Time).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="60114-301">下列程式碼範例使用<xref:System.Web.Caching.AggregateCacheDependency>新增項目，具有兩個類別<xref:System.Web.Caching.CacheDependency>為物件的相依性， <xref:System.Web.Caching.Cache>。</span><span class="sxs-lookup"><span data-stu-id="60114-301">The following code example uses the <xref:System.Web.Caching.AggregateCacheDependency> class to add an item, with two <xref:System.Web.Caching.CacheDependency> object dependencies, to the <xref:System.Web.Caching.Cache>.</span></span> <span data-ttu-id="60114-302">當要求<xref:System.Web.Caching.Cache>項目，程式碼會檢查的項目是否在<xref:System.Web.Caching.Cache>。</span><span class="sxs-lookup"><span data-stu-id="60114-302">When a request for the <xref:System.Web.Caching.Cache> item is made, the code checks whether the item is in the <xref:System.Web.Caching.Cache>.</span></span> <span data-ttu-id="60114-303">如果是，<xref:System.Web.Caching.CacheDependency.UtcLastModified%2A>屬性轉換為字串，且頁面上顯示。</span><span class="sxs-lookup"><span data-stu-id="60114-303">If it is, the <xref:System.Web.Caching.CacheDependency.UtcLastModified%2A> property is converted to a string and displayed on the page.</span></span> <span data-ttu-id="60114-304">如果不是，項目和其兩個相依性會建立並新增到<xref:System.Web.Caching.Cache>。</span><span class="sxs-lookup"><span data-stu-id="60114-304">If it is not, the item and its two dependencies are created and added to the <xref:System.Web.Caching.Cache>.</span></span>  
  
 [!code-vb[CachingSamples_AggregateCacheDependency1#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/CachingSamples_AggregateCacheDependency1/VB/aggregatecachedependencysamplevb.aspx#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.Cache" />
        <altmember cref="M:System.Web.Caching.Cache.Insert(System.String,System.Object,System.Web.Caching.CacheDependency)" />
      </Docs>
    </Member>
  </Members>
</Type>