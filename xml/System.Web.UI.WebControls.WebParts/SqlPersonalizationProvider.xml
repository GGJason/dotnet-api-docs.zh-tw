<Type Name="SqlPersonalizationProvider" FullName="System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider">
  <Metadata><Meta Name="ms.openlocfilehash" Value="2c841e64fb454c6a2af6f300b5ca4559a694184c" /><Meta Name="ms.sourcegitcommit" Value="adc8598fd19d91438cacaa8fa7ce613e28c8218e" /><Meta Name="ms.translationtype" Value="HT" /><Meta Name="ms.contentlocale" Value="zh-TW" /><Meta Name="ms.lasthandoff" Value="12/11/2018" /><Meta Name="ms.locfileid" Value="53229424" /></Metadata><TypeSignature Language="C#" Value="public class SqlPersonalizationProvider : System.Web.UI.WebControls.WebParts.PersonalizationProvider" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit SqlPersonalizationProvider extends System.Web.UI.WebControls.WebParts.PersonalizationProvider" />
  <TypeSignature Language="DocId" Value="T:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider" />
  <TypeSignature Language="VB.NET" Value="Public Class SqlPersonalizationProvider&#xA;Inherits PersonalizationProvider" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlPersonalizationProvider : System::Web::UI::WebControls::WebParts::PersonalizationProvider" />
  <TypeSignature Language="F#" Value="type SqlPersonalizationProvider = class&#xA;    inherit PersonalizationProvider" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.UI.WebControls.WebParts.PersonalizationProvider</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>實作使用 Microsoft SQL Server 的個人化提供者。</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此類別會定義必要的功能，使用 Microsoft SQL Server 的個人化提供者。 個人化提供者載入和儲存個人化資料，代表<xref:System.Web.UI.WebControls.WebParts.WebPartPersonalization>執行個體。 這個類別會實作的邏輯讀取和寫入到執行 SQL Server 的電腦，也會實作所有抽象方法定義於<xref:System.Web.UI.WebControls.WebParts.PersonalizationProvider>。 如需有關個人化提供者的詳細資訊，請參閱<xref:System.Web.UI.WebControls.WebParts.PersonalizationProvider>。  
  
 使用 SQL Server 中的 Web 組件個人化的資料設計依賴兩個常見 SQL 資料庫資料表存在，其支援預存程序，共用大部分的 SQL 為基礎的功能實作。 這些資料表和檢視已安裝並使用下列指令碼解除安裝：  
  
-   installpagepersonalization.sql-安裝個人化資料表、 檢視和相關的預存程序。  
  
-   uninstallpagepersonalization.sql-解除安裝個人化資料表、 檢視和相關的預存程序。  
  
 請務必注意，如果您的 Web 應用程式無法在執行的預設信任層級無法個人化<xref:System.Web.AspNetHostingPermissionLevel.Medium>或更高版本 (您可以設定自訂的信任層級，在 Web.config 檔案中使用`<trust level="" />`項目)。 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration>並<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>信任層級檢查這兩個類別<xref:System.Web.AspNetHostingPermissionLevel.Low>初始化的時間。 如果您設定您的應用程式執行的信任層級<xref:System.Web.AspNetHostingPermissionLevel.Low>，以及您使用預設<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>來管理您的應用程式的個人化資料提供者會第一次應用程式嘗試存取個人化資料失敗，因為 ASP.NET 背景工作處理序中執行<xref:System.Web.AspNetHostingPermissionLevel.Low>信任並沒有必要呼叫中的各種類別的權限<xref:System.Data.SqlClient>命名空間。  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Web.UI.WebControls.WebParts.PersonalizationProvider" />
    <related type="Article" href="https://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">ASP.NET Web 組件頁面</related>
    <related type="Article" href="https://msdn.microsoft.com/library/7dc34f74-52aa-4082-b98d-2bcf9e07e320">Web 組件個人化概觀</related>
    <related type="Article" href="https://msdn.microsoft.com/library/a88d2bd5-4932-4ec1-b176-7d7da45f85d9">逐步解說：以使用者控制項的實作 Web 組件個人化</related>
    <related type="Article" href="https://msdn.microsoft.com/library/7885563f-7bbe-45a0-b5e2-c6bf1bc2deaa">Web 組件個人化</related>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlPersonalizationProvider ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlPersonalizationProvider();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters />
      <Docs>
        <summary>初始化 <see cref="T:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider" /> 類別的新執行個體。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.%23ctor%2A>建構函式由 ASP.NET 呼叫來建立的執行個體<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>類別做為應用程式組態中指定。 這個建構函式不是從您的程式碼使用。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public override string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>取得或設定應用程式的名稱，以儲存和擷取個人化資訊。</summary>
        <value>要儲存和擷取個人化資訊的應用程式的名稱。 預設為目前 <see cref="P:System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath" /> 的 <see cref="P:System.Web.HttpContext.Request" /> 屬性值。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>屬性由<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>群組的使用者資訊的類別。 限定名稱與應用程式名稱的使用者資訊，您可以在單一資料庫中儲存多個應用程式的資訊不會重複的使用者名稱之間發生衝突。 此外，多個 ASP.NET 應用程式時，可以藉由指定相同的值中使用相同的使用者資料庫<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>屬性。 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>屬性可以設定以程式設計的方式，或它的 Web 應用程式使用的組態檔中可以宣告方式設定`applicationName`屬性中`<providers>`一節。  
  
 如果未指定值`applicationName`Web 應用程式組態檔中的屬性則<xref:System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath%2A>使用應用程式所做的第一個要求的屬性值。  
  
> [!CAUTION]
>  因為所提供的所有要求都使用單一預設個人化提供者執行個體<xref:System.Web.HttpApplication>物件，您可以有多個要求同時執行，而且嘗試設定<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>屬性值。 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>屬性不是安全執行緒的多個寫入，以及變更<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>屬性值可能會導致非預期的行為，應用程式的多個使用者。 建議您避免程式碼，以讓使用者能夠設定<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>屬性才。 應用程式的範例設定<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>屬性可能需要管理多個應用程式的個人化資料的系統管理應用程式。 這類應用程式應該是單一使用者應用程式並不是 Web 應用程式。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException">已將屬性設為長度大於 256 個字元的字串。</exception>
      </Docs>
    </Member>
    <Member MemberName="FindState">
      <MemberSignature Language="C#" Value="public override System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, System.Web.UI.WebControls.WebParts.PersonalizationStateQuery query, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope, class System.Web.UI.WebControls.WebParts.PersonalizationStateQuery query, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.FindState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindState (scope As PersonalizationScope, query As PersonalizationStateQuery, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope, System::Web::UI::WebControls::WebParts::PersonalizationStateQuery ^ query, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindState : System.Web.UI.WebControls.WebParts.PersonalizationScope * System.Web.UI.WebControls.WebParts.PersonalizationStateQuery * int * int *  -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="sqlPersonalizationProvider.FindState (scope, query, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
        <Parameter Name="query" Type="System.Web.UI.WebControls.WebParts.PersonalizationStateQuery" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="scope"><see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" />，表示要查詢的個人化資訊。 這個值不能是 <see langword="null" />。</param>
        <param name="query"><see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery" />，含有查詢。 這個值可以是 <see langword="null" />。</param>
        <param name="pageIndex">查詢的起始位置。</param>
        <param name="pageSize">要傳回的資料錄數。</param>
        <param name="totalRecords">可用的資料錄總數。</param>
        <summary>根據指定的範圍和參數，傳回包含零或多個 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo" /> 衍生物件的集合。</summary>
        <returns><see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />，含有零或多個 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo" /> 衍生物件。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 傳回的項目組受到`pageSize`並`pageIndex`參數，其中`pageSize`控制要傳回的記錄數目和`pageIndex`控制傳回哪些記錄。 比方說，`pageIndex`為 0， `pageSize` 25 個會傳回前 25 個相符項目，雖然`pageIndex`為 1 和`pageSize`25 個會傳回出現 26 50。 如果您想要擷取所有可用的記錄，設定`pageIndex`為 0，並`pageSize`至<xref:System.Int32.MaxValue>。  
  
 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-衍生的物件會傳回依字母順序排序<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo.Path%2A>和<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.Username%2A>，兩者以遞增順序。  
  
 此方法會查詢萬用字元的字元傳遞至基礎資料存放區。 目前相依於每個提供者如何處理字元，例如星號 （*）、 百分比符號 （%） 或底線 (_) 萬用字元的支援。  
  
 一般來說，針對 SQL 相容的資料存放區，您可以執行萬用字元搜尋部分的路徑包含萬用字元，不會出現在開頭、 結尾或搜尋字串中的文字中間<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性。 例如，若要尋找開頭的所有路徑 」\~/approot"，則<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性會設定為"\~/approot%"。  
  
 同樣地，部分的使用者名稱的萬用字元搜尋可能會出現在任何時間點的文字字串中的萬用字元<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>屬性。 例如，若要尋找所有的使用者名稱開頭的"John"，<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>參數會看起來像"John %"。  
  
 適用於下列的查詢條件約束：  
  
-   如果只有`scope`提供，並`query`是`null`上的所有屬性或`query`傳回`null`或預設值，則比對所指定的所有記錄`scope`參數會傳回。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性不是`null`，傳回的記錄也會比對的篩選根據的路徑<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性值。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>屬性不是`null`，傳回的記錄也會篩選根據的使用者名稱符合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>屬性值。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性不等於<xref:System.DateTime.MaxValue>，則傳回的記錄也會篩選為傳回與非作用中使用者相關聯的記錄。 比較包含記錄所在<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>屬性小於或等於<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性。  
  
 請注意，這個方法不會驗證查詢參數的組合。 比方說，程式碼可以要求一組共用範圍中的特定使用者名稱相關聯的個人化狀態記錄。 因為使用者名稱不是共用的資訊與相關聯，則傳回的集合會是空白。  
  
 有可能會傳回空集合的參數組合包括：  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared> 結合的範圍<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>。  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User> 範圍中的任何或所有的值組合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>，和<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pageIndex" /> 小於零。  
  
\-或- 
 <paramref name="pageSize" /> 小於或等於零。  
  
\-或- 
<paramref name="pageIndex" /> 和 <paramref name="pageSize" /> 的組合產生大於 <see cref="F:System.Int32.MaxValue" /> 的值。  
  
\-或- 
 <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch" /> 是非 <see langword="null" /> 的，且於修剪後為空字串 ("")。  
  
\-或- 
值為非 <see langword="null" /> 時，<see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch" /> 的長度會大於 256 個字元。  
  
\-或- 
 <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch" /> 是非 <see langword="null" /> 的，且於修剪後為空字串。  
  
\-或- 
值為非 <see langword="null" /> 時，<see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch" /> 的長度會大於 256 個字元。</exception>
        <exception cref="T:System.ArgumentOutOfRangeException">指定的 <paramref name="scope" /> 不是 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> 列舉中的有效值。</exception>
      </Docs>
    </Member>
    <Member MemberName="GetCountOfState">
      <MemberSignature Language="C#" Value="public override int GetCountOfState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, System.Web.UI.WebControls.WebParts.PersonalizationStateQuery query);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 GetCountOfState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope, class System.Web.UI.WebControls.WebParts.PersonalizationStateQuery query) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.GetCountOfState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetCountOfState (scope As PersonalizationScope, query As PersonalizationStateQuery) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int GetCountOfState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope, System::Web::UI::WebControls::WebParts::PersonalizationStateQuery ^ query);" />
      <MemberSignature Language="F#" Value="override this.GetCountOfState : System.Web.UI.WebControls.WebParts.PersonalizationScope * System.Web.UI.WebControls.WebParts.PersonalizationStateQuery -&gt; int" Usage="sqlPersonalizationProvider.GetCountOfState (scope, query)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
        <Parameter Name="query" Type="System.Web.UI.WebControls.WebParts.PersonalizationStateQuery" />
      </Parameters>
      <Docs>
        <param name="scope"><see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" />，表示要查詢的個人化資訊。 這個值不能是 <see langword="null" />。</param>
        <param name="query"><see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery" />，含有查詢。 這個值可以是 <see langword="null" />。</param>
        <summary>傳回基礎資料存放區中針對特定 <paramref name="scope" /> 參數而存在的資料列數目。</summary>
        <returns>基礎資料存放區中針對特定 <paramref name="scope" /> 參數而存在的資料列數目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法會查詢萬用字元的字元傳遞至基礎資料存放區。 目前相依於每個提供者如何處理字元，例如星號 （*）、 百分比符號 （%） 或底線 (_) 萬用字元的支援。  
  
 一般來說，針對 SQL 相容的資料存放區，您可以執行萬用字元搜尋部分的路徑包含萬用字元，不會出現在開頭、 結尾或搜尋字串中的文字中間<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性。 例如，若要尋找開頭的所有路徑 」\~/approot"，則<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性會設定為"\~/approot%"。  
  
 同樣地，部分的使用者名稱的萬用字元搜尋可能會出現在任何時間點的文字字串中的萬用字元<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>屬性。 例如，若要尋找所有的使用者名稱開頭的"John"，<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>參數會看起來像"John %"。  
  
 適用於下列的查詢條件約束：  
  
-   如果只有`scope`提供，並`query`是`null`上的所有屬性或`query`傳回`null`或預設值，則比對所指定的所有記錄`scope`參數會傳回。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性不是`null`，傳回的記錄也會比對的篩選根據的路徑<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性值。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>不是`null`，傳回的記錄也會篩選根據的使用者名稱符合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>屬性值。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性不等於<xref:System.DateTime.MaxValue>，則傳回的記錄也會篩選為傳回與非作用中使用者相關聯的記錄。 比較包含記錄所在<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>屬性小於或等於<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性。  
  
 請注意，這個方法不會驗證查詢參數的組合。 比方說，程式碼可以要求在共用範圍中的非作用中使用者相關聯的狀態記錄的計數。 因為沒有任何概念的非作用中的自訂項目，傳回的計數會是零。  
  
 有可能會傳回空集合的參數組合包括：  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared> 結合的範圍<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>。  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User> 範圍中的任何或所有的值組合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>，和<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch" /> 是非 <see langword="null" /> 的，且於修剪後為空字串 ("")。  
  
\-或- 
值為非 <see langword="null" /> 時，<see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch" /> 的長度會大於 256 個字元。  
  
\-或- 
 <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch" /> 是非 <see langword="null" /> 的，且於修剪後為空字串。  
  
\-或- 
值為非 <see langword="null" /> 時，<see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch" /> 的長度會大於 256 個字元。</exception>
        <exception cref="T:System.ArgumentOutOfRangeException">指定的 <paramref name="scope" /> 不是 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> 列舉中的有效值。</exception>
      </Docs>
    </Member>
    <Member MemberName="Initialize">
      <MemberSignature Language="C#" Value="public override void Initialize (string name, System.Collections.Specialized.NameValueCollection configSettings);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Initialize(string name, class System.Collections.Specialized.NameValueCollection configSettings) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Initialize (name As String, configSettings As NameValueCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Initialize(System::String ^ name, System::Collections::Specialized::NameValueCollection ^ configSettings);" />
      <MemberSignature Language="F#" Value="override this.Initialize : string * System.Collections.Specialized.NameValueCollection -&gt; unit" Usage="sqlPersonalizationProvider.Initialize (name, configSettings)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="name" Type="System.String" />
        <Parameter Name="configSettings" Type="System.Collections.Specialized.NameValueCollection" />
      </Parameters>
      <Docs>
        <param name="name">組態檔中顯示的應用程式名稱。</param>
        <param name="configSettings">應用程式的組態設定。</param>
        <summary>實作 Microsoft SQL Server 個人化提供者所需的初始化程序。 這個方法不能從程式碼直接使用。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個方法提供的初始化程序使用 SQL database 中的個人化，並不是直接從您的程式碼使用。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException">沒有為提供者設定連接字串。  
  
\-或- 
找不到提供者的連接字串。  
  
\-或- 
除了組態設定中說明的屬性之外，提供者的 <see langword="&lt;add&gt;" /> 項目上還有其他屬性。  
  
\-或- 
應用程式名稱的長度大於 256 個字元。  
  
\-或- 
裝載應用程式的應用程式定義域正在以低於 <see cref="F:System.Web.AspNetHostingPermissionLevel.Medium" /> 信任的信任層級執行。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="configSettings" /> 為 <see langword="null" />。</exception>
      </Docs>
    </Member>
    <Member MemberName="LoadPersonalizationBlobs">
      <MemberSignature Language="C#" Value="protected override void LoadPersonalizationBlobs (System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName, ref byte[] sharedDataBlob, ref byte[] userDataBlob);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void LoadPersonalizationBlobs(class System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName, unsigned int8[]&amp; sharedDataBlob, unsigned int8[]&amp; userDataBlob) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.LoadPersonalizationBlobs(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[]@,System.Byte[]@)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void LoadPersonalizationBlobs(System::Web::UI::WebControls::WebParts::WebPartManager ^ webPartManager, System::String ^ path, System::String ^ userName, cli::array &lt;System::Byte&gt; ^ % sharedDataBlob, cli::array &lt;System::Byte&gt; ^ % userDataBlob);" />
      <MemberSignature Language="F#" Value="override this.LoadPersonalizationBlobs : System.Web.UI.WebControls.WebParts.WebPartManager * string * string *  *  -&gt; unit" Usage="sqlPersonalizationProvider.LoadPersonalizationBlobs (webPartManager, path, userName, sharedDataBlob, userDataBlob)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="webPartManager" Type="System.Web.UI.WebControls.WebParts.WebPartManager" />
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="sharedDataBlob" Type="System.Byte[]" RefType="ref" />
        <Parameter Name="userDataBlob" Type="System.Byte[]" RefType="ref" />
      </Parameters>
      <Docs>
        <param name="webPartManager"><see cref="T:System.Web.UI.WebControls.WebParts.WebPartManager" />，管理個人化資料。</param>
        <param name="path">個人化資訊的路徑，此個人化資訊在 <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared" /> 範圍中做為擷取金鑰之用。</param>
        <param name="userName">個人化資訊的使用者名稱，此個人化資訊在 <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.User" /> 範圍中做為擷取金鑰之用。</param>
        <param name="sharedDataBlob"><see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared" /> 範圍的傳回資料。</param>
        <param name="userDataBlob"><see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.User" /> 範圍的傳回資料。</param>
        <summary>根據指定的參數，載入基礎資料存放區中的個人化資料。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個方法會使用`webPartManager`， `path`，和`username`參數做為擷取索引鍵。 傳回的資料包含：  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared>中傳回資料`sharedDataBlob`參數。  
  
-   根據索引鍵值<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>中傳回資料`userDataBlob`參數。 為非`null`值`userName`參數會指示<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>也擷取資料。  
  
 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>物件會自動更新<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>中的資料行`aspnet_Users`從頁面要求的內容中的資料庫載入每個階段的特定使用者個人化資料的資料表。 此行為可讓其他的 ASP.NET 功能，來使用<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>屬性管理資料失效時記錄，以及決定站台上最近的使用者活動。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ResetPersonalizationBlob">
      <MemberSignature Language="C#" Value="protected override void ResetPersonalizationBlob (System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void ResetPersonalizationBlob(class System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetPersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void ResetPersonalizationBlob(System::Web::UI::WebControls::WebParts::WebPartManager ^ webPartManager, System::String ^ path, System::String ^ userName);" />
      <MemberSignature Language="F#" Value="override this.ResetPersonalizationBlob : System.Web.UI.WebControls.WebParts.WebPartManager * string * string -&gt; unit" Usage="sqlPersonalizationProvider.ResetPersonalizationBlob (webPartManager, path, userName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="webPartManager" Type="System.Web.UI.WebControls.WebParts.WebPartManager" />
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="webPartManager"><see cref="T:System.Web.UI.WebControls.WebParts.WebPartManager" />，管理個人化資料。</param>
        <param name="path">個人化資訊的路徑，此個人化資訊在 <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared" /> 範圍中做為擷取金鑰之用。</param>
        <param name="userName">個人化資訊的使用者名稱，此個人化資訊在 <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.User" /> 範圍中做為擷取金鑰之用。</param>
        <summary>刪除基礎資料存放區中的個人化資料。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.UI.WebControls.WebParts.WebPartPersonalization> 使用這個方法可從資料庫刪除網站使用者選擇重設頁面上的 Web 組件資料的個人化資料。 如果`username`是非`null`，使用的資料<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>領域資料已遭刪除; 否則資料<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared>領域刪除。  
  
 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>物件會自動更新<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>中的資料行`aspnet_Users`每次使用者專屬的個人化資料從頁面要求的內容中的資料庫中刪除的資料表。 此行為可讓其他的 ASP.NET 功能，來使用<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>時管理過時的資料記錄，以及決定站台上最近的使用者活動的值。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ResetState">
      <MemberSignature Language="C#" Value="public override int ResetState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, string[] paths, string[] usernames);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 ResetState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope, string[] paths, string[] usernames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.String[],System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ResetState (scope As PersonalizationScope, paths As String(), usernames As String()) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int ResetState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope, cli::array &lt;System::String ^&gt; ^ paths, cli::array &lt;System::String ^&gt; ^ usernames);" />
      <MemberSignature Language="F#" Value="override this.ResetState : System.Web.UI.WebControls.WebParts.PersonalizationScope * string[] * string[] -&gt; int" Usage="sqlPersonalizationProvider.ResetState (scope, paths, usernames)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
        <Parameter Name="paths" Type="System.String[]" />
        <Parameter Name="usernames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="scope"><see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" />，表示要查詢的個人化資訊。 這個值不能是 <see langword="null" />。</param>
        <param name="paths"><see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared" /> 範圍中要刪除之個人化資訊的路徑。</param>
        <param name="usernames"><see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.User" /> 範圍中要刪除之個人化資訊的使用者名稱。</param>
        <summary>根據指定的參數，刪除基礎資料存放區中的個人化狀態資訊。</summary>
        <returns>刪除的資料列數目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個方法所不支援任何萬用字元。  
  
 允許參數的下列組合：  
  
-   `scope`參數設定，而所有其他參數會設定為`null`。 這個組合會刪除所指定的個人化範圍相關聯的所有 Web 組件個人化資料`scope`。  
  
-   `scope`參數設定，而`paths`參數包含至少一個值。 這個組合會刪除指定的路徑或路徑所指定的個人化範圍中的所有 Web 組件個人化資料`scope`。  
  
-   `scope`參數設定為<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>，則`paths`參數設定，而且包含只有一個路徑，而`usernames`參數包含至少一個值。 這個組合會刪除所有的使用者個人化 Web 組件中所包含的使用者相關聯的指定路徑的資料`usernames`。  
  
-   `scope`參數設定為<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>，則`paths`參數`null`，和`usernames`參數包含至少一個值。 這個組合會刪除所有的每一使用者個人化 Web 組件的資料，在中所包含的使用者相關聯的所有路徑之間`usernames`。  
  
 任何其他的參數值組合無效，而且將會擲回<xref:System.ArgumentException>例外狀況。 比方說，不允許下列兩種組合：  
  
-   `usernames`不能提供參數時`scope`參數設為<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared>。  
  
-   `paths`參數不能包含多個項目時`usernames`參數不是`null`。  
  
 `paths`和`usernames`包含於各自陣列參數必須符合以下驗證規則。 如果任何驗證規則失敗時的參數陣列中，任何成員<xref:System.ArgumentException>擲回例外狀況。 驗證規則包括：  
  
-   `null` 不允許值。  
  
-   空字串 ("") 不允許字串已修剪。  
  
-   包含在沒有使用者名稱`usernames`參數可以包含逗號。  
  
-   中的任何路徑長度`paths`參數不能大於 256 個字元。  
  
-   中的任何使用者名稱的長度`usernames`參數不能大於 256 個字元。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="paths" /> 或 <paramref name="usernames" /> 參數是空白陣列。  
  
\-或- 
包含於各自陣列中的 <paramref name="paths" /> 和 <paramref name="usernames" /> 參數不符合驗證規則。</exception>
        <exception cref="T:System.ArgumentOutOfRangeException">指定的 <paramref name="scope" /> 不是 <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> 列舉的成員。</exception>
      </Docs>
    </Member>
    <Member MemberName="ResetUserState">
      <MemberSignature Language="C#" Value="public override int ResetUserState (string path, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 ResetUserState(string path, valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetUserState(System.String,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ResetUserState (path As String, userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int ResetUserState(System::String ^ path, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="override this.ResetUserState : string * DateTime -&gt; int" Usage="sqlPersonalizationProvider.ResetUserState (path, userInactiveSinceDate)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="path">要刪除之個人化資料的路徑。 這個值可以為 <see langword="null" />，但是不能為空字串 ("")。</param>
        <param name="userInactiveSinceDate">指示上一個活動的資料。</param>
        <summary>根據指定的參數，刪除基礎資料存放區中的使用者個人化資料。</summary>
        <returns>從基礎資料存放區刪除的資料列數目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個方法的參數具有下列限制：  
  
-   `path`參數不能包含萬用字元。  
  
-   如果`path`參數為非`null`，然後與相關聯的唯一的每一使用者個人化資料錄`path`將被刪除。  
  
-   只有每位使用者個人化資料錄會被視為非作用中指定的日期後的使用者相關聯`userInactiveSinceDate`參數會被刪除。 確切的比較會刪除記錄所在<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>屬性小於或等於`userInactiveSinceDate`參數。  
  
-   如果未提供這兩個參數，則會刪除符合這兩個條件約束的記錄。  
  
-   `path`參數可以是`null`。  
  
-   `path`參數無法於修剪後為空字串。  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 屬性不能是 `null`。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="path" /> 為空字串。  
  
\-或- 
路徑的長度大於 256 個字元。</exception>
      </Docs>
    </Member>
    <Member MemberName="SavePersonalizationBlob">
      <MemberSignature Language="C#" Value="protected override void SavePersonalizationBlob (System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName, byte[] dataBlob);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void SavePersonalizationBlob(class System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName, unsigned int8[] dataBlob) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SavePersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[])" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void SavePersonalizationBlob(System::Web::UI::WebControls::WebParts::WebPartManager ^ webPartManager, System::String ^ path, System::String ^ userName, cli::array &lt;System::Byte&gt; ^ dataBlob);" />
      <MemberSignature Language="F#" Value="override this.SavePersonalizationBlob : System.Web.UI.WebControls.WebParts.WebPartManager * string * string * byte[] -&gt; unit" Usage="sqlPersonalizationProvider.SavePersonalizationBlob (webPartManager, path, userName, dataBlob)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="webPartManager" Type="System.Web.UI.WebControls.WebParts.WebPartManager" />
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="dataBlob" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="webPartManager"><see cref="T:System.Web.UI.WebControls.WebParts.WebPartManager" />，管理個人化資料。</param>
        <param name="path"><see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" />，表示要儲存的個人化資訊。 這個值不能是 <see langword="null" />。</param>
        <param name="userName"><see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.User" /> 範圍中用做索引鍵之個人化資訊的使用者名稱。</param>
        <param name="dataBlob">要儲存的資料位元組陣列。</param>
        <summary>將未經處理的個人化資料儲存至基礎 Microsoft SQL Server 資料庫。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 如果非`null`提供使用者名稱，則`dataBlob`參數會包含個人化資料<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>範圍; 否則`dataBlob`會假設包含資料<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared>範圍。  
  
 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>物件會自動更新<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>中的資料行`aspnet_Users`每次使用者專屬的個人化資料會儲存到資料庫的頁面要求的內容中的資料表。 此行為可讓其他的 ASP.NET 功能，來使用<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>屬性管理資料失效時記錄，以及決定站台上最近的使用者活動。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>