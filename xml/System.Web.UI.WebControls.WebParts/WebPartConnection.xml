<Type Name="WebPartConnection" FullName="System.Web.UI.WebControls.WebParts.WebPartConnection">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="3b1dab9b7d3348dd81471c415d0c9ff230db233e" />
    <Meta Name="ms.sourcegitcommit" Value="0ec122ee5f3681159b8460ab15b409fd6e3d3ae0" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="10/04/2018" />
    <Meta Name="ms.locfileid" Value="48649443" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class WebPartConnection" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit WebPartConnection extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Web.UI.WebControls.WebParts.WebPartConnection" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class WebPartConnection" />
  <TypeSignature Language="C++ CLI" Value="public ref class WebPartConnection sealed" />
  <TypeSignature Language="F#" Value="type WebPartConnection = class" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
      <AttributeName>System.ComponentModel.TypeConverter(typeof(System.ComponentModel.ExpandableObjectConverter))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
      <AttributeName>System.Web.UI.ParseChildren(true, "Transformers")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="96ba3-101">提供讓兩個 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 控制項建立連接的物件。</span>
      <span class="sxs-lookup">
        <span data-stu-id="96ba3-101">Provides an object that enables two <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> controls to form a connection.</span>
      </span>
      <span data-ttu-id="96ba3-102">這個類別無法被繼承。</span>
      <span class="sxs-lookup">
        <span data-stu-id="96ba3-102">This class cannot be inherited.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-103">在 Web 組件控制項集合中，連線會是連結或兩個之間的關聯<xref:System.Web.UI.WebControls.WebParts.WebPart>（或其他伺服器或使用者） 可讓它們共用資料的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-103">In the Web Parts control set, a connection is a link or association between two <xref:System.Web.UI.WebControls.WebParts.WebPart> (or other server or user) controls that enables them to share data.</span></span> <span data-ttu-id="96ba3-104">共用資料的這項功能可讓連接的控制項，用於超過提供的隔離控制功能的方式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-104">This ability to share data allows connected controls to be used in ways that exceed the functionality offered by the isolated controls.</span></span> <span data-ttu-id="96ba3-105">比方說，如果其中一個控制項提供郵遞區號的資料，而另一個控制項可以讀取該資料，並提供的郵遞區號為根據本地天氣資訊，然後連接兩個控制項的功能提供更多價值給使用者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-105">For example, if one control provides postal code data, and another control can read that data and provide local weather information based on the postal code, then the connected capability of the two controls provides more value to users.</span></span> <span data-ttu-id="96ba3-106">若要擴充此範例中，其他控制項可以建立也會顯示根據郵遞區號，例如地方新聞的連結控制項的資訊，以及所有郵遞區號的資料可以使用這些控制項可以提供的單一控制項都共用資料郵遞區號。</span><span class="sxs-lookup"><span data-stu-id="96ba3-106">To extend this example, other controls could be created that also display information based on a postal code, such as a control with links to local news, and all these controls that can work with postal code data could share data with the single control that provides a postal code.</span></span> <span data-ttu-id="96ba3-107">Web 組件的應用程式的終端使用者可以建立和管理所有這類相容控制項直接從 Web 瀏覽器中，使用提供的標準連接使用者介面 (UI) 之間的連線<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控制項，或使用所提供的自訂 UI開發人員。</span><span class="sxs-lookup"><span data-stu-id="96ba3-107">End users of Web Parts applications can create and manage connections between all such compatible controls directly from a Web browser, using the standard connections user interface (UI) provided by the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control, or using a custom UI provided by a developer.</span></span>  
  
 <span data-ttu-id="96ba3-108">這<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>類別概觀是一般陳述式的基本詳細資料，建立連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-108">This <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> class overview is a general statement of the basic details for creating a connection.</span></span> <span data-ttu-id="96ba3-109">如需特定元件及建立連線時所涉及的需求詳細資訊，請參閱 < [Web 組件連接概觀](http://msdn.microsoft.com/library/d98cfd0f-ebd6-4871-89d5-abbd2cdef67b)，或請參閱參考類別和程式碼在以下討論中所述的範例。</span><span class="sxs-lookup"><span data-stu-id="96ba3-109">For more on specific components and requirements involved in creating connections, see [Web Parts Connections Overview](http://msdn.microsoft.com/library/d98cfd0f-ebd6-4871-89d5-abbd2cdef67b), or see the reference classes and code examples mentioned in the following discussion.</span></span> <span data-ttu-id="96ba3-110">有數個基本層面的 Web 組件連接：</span><span class="sxs-lookup"><span data-stu-id="96ba3-110">There are several fundamental aspects of a Web Parts connection:</span></span>  
  
-   <span data-ttu-id="96ba3-111">兩個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-111">Two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="96ba3-112">每個 Web 組件連接是由兩個控制項所組成。</span><span class="sxs-lookup"><span data-stu-id="96ba3-112">Every Web Parts connection consists of two controls.</span></span> <span data-ttu-id="96ba3-113">可以同時加入多個連接的控制項，但每個單一連接是由兩個控制項所組成。</span><span class="sxs-lookup"><span data-stu-id="96ba3-113">It is possible for a control to participate in more than one connection simultaneously, but every single connection consists of exactly two controls.</span></span> <span data-ttu-id="96ba3-114">控制項可以直接衍生自<xref:System.Web.UI.WebControls.WebParts.WebPart>基底類別，也可以是其他伺服器控制項，包括 ASP.NET 控制項、 自訂伺服器控制項和使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-114">The controls can derive directly from the <xref:System.Web.UI.WebControls.WebParts.WebPart> base class, or they can be other server controls, including ASP.NET controls, custom server controls, and user controls.</span></span> <span data-ttu-id="96ba3-115">控制項不是衍生自<xref:System.Web.UI.WebControls.WebParts.WebPart>類別，如果放在<xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase>區域，以自動包裝<xref:System.Web.UI.WebControls.WebParts.GenericWebPart>物件，在執行階段，並讓它們繼承自<xref:System.Web.UI.WebControls.WebParts.WebPart>類別和函式執行階段為<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-115">Controls that do not derive from the <xref:System.Web.UI.WebControls.WebParts.WebPart> class, if placed in a <xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase> zone, are automatically wrapped with a <xref:System.Web.UI.WebControls.WebParts.GenericWebPart> object at run time, which enables them to inherit from the <xref:System.Web.UI.WebControls.WebParts.WebPart> class and function as run-time <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span>  
  
-   <span data-ttu-id="96ba3-116">位於控制項<xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase>區域。</span><span class="sxs-lookup"><span data-stu-id="96ba3-116">Controls residing in <xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase> zones.</span></span> <span data-ttu-id="96ba3-117">兩者<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項和任何其他類型的伺服器控制項必須位於<xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase>能夠參與 Web 組件連接 （和其他大部分的 Web 組件功能） 的區域。</span><span class="sxs-lookup"><span data-stu-id="96ba3-117">Both <xref:System.Web.UI.WebControls.WebParts.WebPart> controls and any other type of server control must reside in a <xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase> zone to be able to participate in Web Parts connections (and most other Web Parts features).</span></span>  
  
-   <span data-ttu-id="96ba3-118">消費者和提供者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-118">Consumers and providers.</span></span> <span data-ttu-id="96ba3-119">在每個 Web 組件連接中，有兩個控制項： 資料和資料的取用者的提供者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-119">In every Web Parts connection there are two controls: a provider of data and a consumer of data.</span></span> <span data-ttu-id="96ba3-120">提供者會提供給取用者的資料，透過介面的形式傳回資料的指定的回呼方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-120">The provider furnishes data to the consumer through a specified callback method that returns data in the form of an interface.</span></span> <span data-ttu-id="96ba3-121">（如需如何建立和指定的回呼方法的範例，請參閱本主題的範例 > 一節）。此回呼方法就是所謂的提供者連接點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-121">(For an example of how to create and specify the callback method, see the Example section of this topic.) This callback method is known as a provider connection point.</span></span> <span data-ttu-id="96ba3-122">這個連接點 （「 易記 」 名稱、 識別碼和傳回的介面的型別） 的詳細資料包含在<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>與提供者控制項相關聯的物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-122">The details of this connection point (its "friendly" name, an ID, and the type of the returned interface) are contained in a <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object associated with the provider control.</span></span> <span data-ttu-id="96ba3-123">取用者接收的資料，透過可接受介面的執行個體的指定方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-123">The consumer receives the data through a specified method that can accept an instance of the interface.</span></span> <span data-ttu-id="96ba3-124">這個方法稱為消費者連接點，而且連接點 （名稱、 識別碼和介面的型別） 的詳細資料包含在<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>消費者控制項相關聯的物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-124">This method is known as a consumer connection point, and the details of the connection point (name, ID, and type of interface) are contained in a <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object associated with the consumer control.</span></span>  
  
-   <span data-ttu-id="96ba3-125">相容的控制項或有效的轉換程式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-125">Compatible controls or a valid transformer.</span></span> <span data-ttu-id="96ba3-126">工作的連接，提供者與取用者必須是相容 （表示指定的連接點方法，可以使用相同類型的介面） 或有必須是<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>物件能夠轉譯所提供的型別到了解取用者的型別提供者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-126">For a connection to work, the consumer and provider must either be compatible (meaning that their specified connection point methods can work with the same type of interface), or there must be a <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object capable of translating the type offered by the provider into a type understood by the consumer.</span></span>  
  
-   <span data-ttu-id="96ba3-127"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection> 物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-127">A <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object.</span></span> <span data-ttu-id="96ba3-128">連接存在，必須是執行個體<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>類別，其中包含提供者和消費者控制項，以及其連接點的詳細資料的參考。</span><span class="sxs-lookup"><span data-stu-id="96ba3-128">For a connection to exist, there must be an instance of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> class that contains references to the provider and consumer controls, along with the details of their connection points.</span></span> <span data-ttu-id="96ba3-129">如果提供者和取用者不相容，並改為使用<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>物件來連接，連接參考轉換程式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-129">If the provider and consumer are incompatible and instead use a <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object to connect, the connection references the transformer.</span></span>  
  
-   <span data-ttu-id="96ba3-130">建立連接的方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-130">A means of establishing the connection.</span></span> <span data-ttu-id="96ba3-131">已正確連線點方法在設計及放置在區域中，相容的消費者和提供者控制項之後，<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>物件是否使用、 最後一個必要的基本步驟來起始連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-131">After compatible consumer and provider controls have been properly designed with connection point methods and placed in a zone, and a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object is available, the last basic step necessary is to initiate the connection.</span></span> <span data-ttu-id="96ba3-132">這種情形的其中一個方法是建立透過使用者介面連線的使用者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-132">One way this can happen is for users to create the connection through the UI.</span></span> <span data-ttu-id="96ba3-133">如果您將`<asp:connectionszone>`項目] 頁面上，以及其他需要連接的元件會就地的情況下，在執行階段，使用者可以將網頁切換成連接顯示模式，按一下 [連接動詞命令功能表中的動詞提供者或取用者並連接 UI (根據<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控制項) 會出現。</span><span class="sxs-lookup"><span data-stu-id="96ba3-133">If you place an `<asp:connectionszone>` element on the page, and the other required components for a connection are in place, at run time a user can switch the page into connect display mode, click a connect verb on the verbs menu of either the provider or consumer, and a connection UI (based on the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control) will appear.</span></span> <span data-ttu-id="96ba3-134">透過此 UI 中，使用者可以起始連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-134">Through this UI, the user can initiate the connection.</span></span> <span data-ttu-id="96ba3-135">若要起始連線的另一個方法是以程式設計的方式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-135">Another way to initiate the connection is to do it programmatically.</span></span> <span data-ttu-id="96ba3-136">在任一情況下，是否透過 UI 或以程式設計的方式，基礎的方法，啟動連線都相同。</span><span class="sxs-lookup"><span data-stu-id="96ba3-136">In either case, whether through the UI or programmatically, the underlying method that initiates the connection is the same.</span></span> <span data-ttu-id="96ba3-137">應用程式會呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法 (或<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法，如果使用轉換程式) 上<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項，提供者、 消費者和其各自的連接點物件，傳遞給它，然後此方法會傳回<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-137">The application calls the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method (or the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method if using a transformer) on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control, passing to it the provider, the consumer, and their respective connection point objects, and the method returns a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object.</span></span>  
  
 <span data-ttu-id="96ba3-138"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection>類別會定義封裝之間的連線兩個必要的詳細資訊的物件<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-138">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> class defines an object that encapsulates the essential details of a connection between two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="96ba3-139">類別幾乎完全包含與特定連接的詳細資料相關的屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-139">The class consists almost entirely of properties related to the details of a particular connection.</span></span> <span data-ttu-id="96ba3-140">數個屬性是關於連接之中消費者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-140">Several properties concern the consumer control in a connection.</span></span> <span data-ttu-id="96ba3-141"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A>屬性會參考本身的消費者控制項和<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A>屬性參考取用者的識別碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-141">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A> property references the consumer control itself, and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A> property references the consumer's ID.</span></span> <span data-ttu-id="96ba3-142"><xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>取用者的參考物件，其中包含消費者連接點的詳細資料，<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-142">The <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object, which contains the details of the consumer's connection point, is referenced by the consumer's <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A> property.</span></span> <span data-ttu-id="96ba3-143"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>屬性參考 ID 的<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-143">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property references the ID of the <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object.</span></span> <span data-ttu-id="96ba3-144">所有這些取用者相關連接屬性必須有值，指派給它們，以建立連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-144">All these consumer-related connection properties must have a value assigned to them to create a connection.</span></span>  
  
 <span data-ttu-id="96ba3-145"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection>類別也有數個在連接中，提供者控制項相關的屬性，這些會對應至屬性的用戶。</span><span class="sxs-lookup"><span data-stu-id="96ba3-145">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> class also has several properties that relate to the provider control in a connection, and these correspond to the properties for a consumer.</span></span> <span data-ttu-id="96ba3-146"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A>屬性會參考提供者控制項本身，而<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A>屬性會參考其識別碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-146">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A> property references the provider control itself, while the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A> property references its ID.</span></span> <span data-ttu-id="96ba3-147"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A>屬性參考<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>物件，而<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>屬性所參照的提供者的連接點的 ID。</span><span class="sxs-lookup"><span data-stu-id="96ba3-147">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A> property references the <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object, and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property references the ID of the provider's connection point.</span></span>  
  
 <span data-ttu-id="96ba3-148">數個屬性是關於連線狀態。</span><span class="sxs-lookup"><span data-stu-id="96ba3-148">Several properties concern the state of the connection.</span></span> <span data-ttu-id="96ba3-149"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A>屬性會指出連接是否主動 （目前交換資料） 」 或 「 非作用中 （仍已連接但不是會積極地共用資料）。</span><span class="sxs-lookup"><span data-stu-id="96ba3-149">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A> property indicates whether the connection is active (currently exchanging data) or inactive (still connected but not actively sharing data).</span></span> <span data-ttu-id="96ba3-150"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>屬性會指出連接是否共用 （可在頁面上的所有使用者） 或使用者特定的連接，而<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>屬性會指出控制項是否靜態 （宣告在網頁標記中，因此永久） 或動態 （以程式設計方式建立，這表示它可以已刪除）。</span><span class="sxs-lookup"><span data-stu-id="96ba3-150">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property indicates whether the connection is a shared (available to all users of a page) or a user-specific connection, and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> property indicates whether the control is static (declared in the page markup and thus permanent) or dynamic (created programmatically, meaning that it can be deleted).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-151">下列程式碼範例示範如何建立兩個之間的簡單連接<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-151">The following code example demonstrates how to create a simple connection between two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="96ba3-152">此範例示範三種方式建立連接： 以宣告方式，是藉由將連接的標記放在網頁中; 標記以程式設計方式在程式碼中建立連線並透過 UI，藉由放置<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控制項在頁面上，可讓使用者建立的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-152">The example demonstrates three ways of forming a connection: declaratively, by placing tags for the connection in the markup of the Web page; programmatically, by creating the connection in code; and through the UI, by placing a <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control on the page, which enables users to establish a connection.</span></span>  
  
 <span data-ttu-id="96ba3-153">在程式碼範例包含四個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-153">The code example has four parts:</span></span>  
  
-   <span data-ttu-id="96ba3-154">使用者控制項，可讓您變更 Web 組件 頁面上顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-154">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="96ba3-155">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-155">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-156">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-156">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-157">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-157">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-158">此程式碼範例的第一個部分是可讓使用者變更顯示模式，在網頁上的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-158">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="96ba3-159">將以下的原始碼儲存到.ascx 檔，提供檔案名稱指派給`Src`屬性的`Register`這個使用者控制項指示詞，也就是裝載的 Web 網頁的頂端附近。</span><span class="sxs-lookup"><span data-stu-id="96ba3-159">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="96ba3-160">For 詳細資料會顯示在此控制項模式和原始碼的描述，請參閱[逐步解說： 變更 Web 組件頁面上顯示的模式](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-160">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_Overview#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_Overview#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="96ba3-161">在程式碼範例的第二個部分是介面和控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-161">The second part of the code example is the source code for the interface and controls.</span></span> <span data-ttu-id="96ba3-162">原始程式檔包含一個簡單的介面，名為`IZipCode`。</span><span class="sxs-lookup"><span data-stu-id="96ba3-162">The source file contains a simple interface named `IZipCode`.</span></span> <span data-ttu-id="96ba3-163">另外還有<xref:System.Web.UI.WebControls.WebParts.WebPart>名為類別`ZipCodeWebPart`，實作介面，並做為提供者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-163">There is also a <xref:System.Web.UI.WebControls.WebParts.WebPart> class named `ZipCodeWebPart` that implements the interface and acts as the provider control.</span></span> <span data-ttu-id="96ba3-164">其`ProvideIZipCode`方法是實作介面的唯一成員的回呼方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-164">Its `ProvideIZipCode` method is the callback method that implements the interface's only member.</span></span> <span data-ttu-id="96ba3-165">此方法只會傳回介面的執行個體。</span><span class="sxs-lookup"><span data-stu-id="96ba3-165">The method simply returns an instance of the interface.</span></span> <span data-ttu-id="96ba3-166">請注意，方法標示為`ConnectionProvider`其中繼資料中的屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-166">Note that the method is marked with a `ConnectionProvider` attribute in its metadata.</span></span> <span data-ttu-id="96ba3-167">這是將方法識別提供者的連接點的回呼方法的機制。</span><span class="sxs-lookup"><span data-stu-id="96ba3-167">This is the mechanism for identifying the method as the callback method for the provider's connection point.</span></span> <span data-ttu-id="96ba3-168">另<xref:System.Web.UI.WebControls.WebParts.WebPart>類別會命名為`WeatherWebPart`，並作為連線取用者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-168">The other <xref:System.Web.UI.WebControls.WebParts.WebPart> class is named `WeatherWebPart`, and it acts as the consumer for the connection.</span></span> <span data-ttu-id="96ba3-169">這個類別具有一個名為方法`GetZipCode`所取得的執行個體`IZipCode`從提供者控制項的介面。</span><span class="sxs-lookup"><span data-stu-id="96ba3-169">This class has a method named `GetZipCode` that gets an instance of the `IZipCode` interface from the provider control.</span></span> <span data-ttu-id="96ba3-170">請注意，這個方法會標示為取用者的連接點方法`ConnectionConsumer`其中繼資料中的屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-170">Note that this method is marked as the consumer's connection point method with a `ConnectionConsumer` attribute in its metadata.</span></span>  
  
 <span data-ttu-id="96ba3-171">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-171">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-172">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-172">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-173">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-173">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-174">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-174">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-175">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-175">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_Overview#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_Overview#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-176">在程式碼範例的第三個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-176">The third part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-177">頁面頂端附近`Register`使用者控制項和自訂指示詞<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-177">Near the top are the `Register` directives for the user control and the custom <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="96ba3-178">因為此範例假設動態編譯的控制項，控制項的原始程式碼應該在 App_Code 子資料夾中;`Register`頁面中的標記會參考只任意標記前置詞和控制項的命名空間。</span><span class="sxs-lookup"><span data-stu-id="96ba3-178">Because the example assumes dynamic compilation of the controls, the source code for the controls should be in an App_Code subfolder; the `Register` tag in the page references only an arbitrary tag prefix and the namespace of the controls.</span></span> <span data-ttu-id="96ba3-179">自訂<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項 （提供者和取用者） 網頁內宣告`<asp:webpartzone>`元素內，`<zonetemplate>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-179">The custom <xref:System.Web.UI.WebControls.WebParts.WebPart> controls (the provider and consumer) are declared within the Web page's `<asp:webpartzone>` element, inside a `<zonetemplate>` element.</span></span>  
  
 <span data-ttu-id="96ba3-180">頁面會提供三種方式可建立自訂控制項之間的連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-180">The page provides three ways to form a connection between the custom controls.</span></span> <span data-ttu-id="96ba3-181">第一種方法是宣告式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-181">The first method is declarative.</span></span> <span data-ttu-id="96ba3-182">在頁面中，標記中 <`StaticConnections>`項目宣告，而且在`<asp:WebPartConnections>`項目，各種不同的取用者和提供者詳細資料，來做為屬性指定的連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-182">In the markup for the page, a <`StaticConnections>` element is declared, and within that is an `<asp:WebPartConnections>` element, with the various consumer and provider details of the connection specified as attributes.</span></span> <span data-ttu-id="96ba3-183">這是一種方式建立連線，請藉由宣告直接在網頁上，特別是在`<asp:WebPartManager>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-183">This is one way to create a connection, by declaring it directly in the Web page, specifically within the `<asp:WebPartManager>` element.</span></span> <span data-ttu-id="96ba3-184">這個靜態的連線，因為建立立即第一次頁面載入兩個自訂控制項之間的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-184">Because of this static connection, a connection between the two custom controls is created immediately the first time the page loads.</span></span>  
  
 <span data-ttu-id="96ba3-185">建立控制項之間連接的第二個方法由提供`<asp:connectionszone>`頁面中的項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-185">A second method for forming a connection between the controls is provided by the `<asp:connectionszone>` element in the page.</span></span> <span data-ttu-id="96ba3-186">如果使用者切換成連接顯示模式的頁面，在執行階段，然後按一下其中一個自訂的控制項上的 connect 動詞命令`<asp:connectionszone>`項目自動呈現建立連線的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="96ba3-186">If a user switches a page into connect display mode at run time, and clicks a connect verb on one of the custom controls, the `<asp:connectionszone>` element automatically renders the UI for creating a connection.</span></span>  
  
 <span data-ttu-id="96ba3-187">此頁面也會示範建立連線，也就是以程式設計的方式的第三種方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-187">The page also demonstrates a third way of creating a connection, which is to do it programmatically.</span></span> <span data-ttu-id="96ba3-188">在 `Button1_Click`方法中，程式碼會建立<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>物件提供者控制項，並擷取其連接點的詳細說明藉由呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetProviderConnectionPoints%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-188">In the `Button1_Click` method, the code creates a <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object for the provider control, and retrieves its connection point details by calling the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetProviderConnectionPoints%2A> method.</span></span> <span data-ttu-id="96ba3-189">它會執行類似工作的消費者控制項中，呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetConsumerConnectionPoints%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-189">It carries out a similar task for the consumer control, calling the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetConsumerConnectionPoints%2A> method.</span></span> <span data-ttu-id="96ba3-190">最後，它會建立新<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>藉由呼叫物件<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-190">Finally, it creates the new <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object by calling the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_Overview#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_Overview#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-191">載入網頁瀏覽器中之後，第一個連接已經存在，是因為在宣告`<StaticConnections>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-191">After you load the Web page in a browser, the first connection already exists because it is declared within the `<StaticConnections>` element.</span></span> <span data-ttu-id="96ba3-192">輸入一些文字，在**ZIP 程式碼提供者**控制項，以及它將會顯示在消費者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-192">Enter some text in the **ZIP Code Provider** control, and it will be displayed in the consumer control.</span></span> <span data-ttu-id="96ba3-193">接下來，中斷連線的兩個控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-193">Next, disconnect the two controls.</span></span> <span data-ttu-id="96ba3-194">使用**顯示模式**下拉式清單控制項中，變更連接顯示模式的頁面。</span><span class="sxs-lookup"><span data-stu-id="96ba3-194">Using the **Display Mode** drop-down list control, change the page to connect display mode.</span></span> <span data-ttu-id="96ba3-195">按一下 （標題列中的向下箭號表示） 的動詞命令功能表的每個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，並請注意，每個有**Connect**選項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-195">Click the verbs menu (represented by a downward arrow in the title bar) for each of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and notice that each has a **Connect** option.</span></span> <span data-ttu-id="96ba3-196">這是連接動詞命令，就會出現在動詞命令功能表只有當頁面處於連接模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-196">This is a connect verb, which appears in the verbs menu only when the page is in connect mode.</span></span> <span data-ttu-id="96ba3-197">按一下 連接動詞命令，在其中一個控制項，並連接所提供的 UI<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控制項就會出現。</span><span class="sxs-lookup"><span data-stu-id="96ba3-197">Click the connect verb on one of the controls, and the connection UI provided by the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control appears.</span></span> <span data-ttu-id="96ba3-198">按一下 **中斷連線**結束靜態控制項之間連接的按鈕。</span><span class="sxs-lookup"><span data-stu-id="96ba3-198">Click the **Disconnect** button to end the static connection between the controls.</span></span> <span data-ttu-id="96ba3-199">使用**顯示模式**返回頁面，即可瀏覽模式的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-199">Use the **Display Mode** control to return the page to browse mode.</span></span> <span data-ttu-id="96ba3-200">再試一次，輸入提供者中的一些新的文字，並記下控制項已中斷連線，因為消費者控制項中要更新失敗的文字。</span><span class="sxs-lookup"><span data-stu-id="96ba3-200">Try to enter some new text in the provider again, and note that because the controls are disconnected, the text fails to update in the consumer control.</span></span>  
  
 <span data-ttu-id="96ba3-201">接下來，使用與上述相同的方法，將頁面切換成連接顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-201">Next, use the same method as above to switch the page into connect display mode again.</span></span> <span data-ttu-id="96ba3-202">按一下控制項的其中一個連接動詞命令。</span><span class="sxs-lookup"><span data-stu-id="96ba3-202">Click a connect verb on one of the controls.</span></span> <span data-ttu-id="96ba3-203">按一下 **建立的連線**連結，並使用所提供的 UI<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控制項來建立控制項之間的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-203">Click the **Create a Connection** link, and use the UI provided by the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control to create a connection between the controls.</span></span> <span data-ttu-id="96ba3-204">這是建立連接的第二個方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-204">This is the second method for creating a connection.</span></span> <span data-ttu-id="96ba3-205">請注意，形成連線時，最後一個字串您輸入提供者控制項 （也就無法出現，因為控制項已中斷連線） 中突然出現在取用者，因為已經重新建立連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-205">Note that as soon as the connection is formed, the last string you entered in the provider control (that failed to appear because the controls were disconnected) suddenly appears in the consumer, because the connection has been recreated.</span></span> <span data-ttu-id="96ba3-206">按一下 [**中斷連線**] 按鈕以結束目前您剛才建立的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-206">Click the **Disconnect** button to end the current connection that you just created.</span></span> <span data-ttu-id="96ba3-207">傳回至瀏覽模式的頁面。</span><span class="sxs-lookup"><span data-stu-id="96ba3-207">Return the page to browse mode.</span></span> <span data-ttu-id="96ba3-208">輸入一些新的文字，來示範，文字將不會更新，以及控制項一次中斷連接的提供者中。</span><span class="sxs-lookup"><span data-stu-id="96ba3-208">Enter some new text in the provider to demonstrate that the text is not updated, and that the controls are again disconnected.</span></span>  
  
 <span data-ttu-id="96ba3-209">傳回連接顯示模式的頁面。</span><span class="sxs-lookup"><span data-stu-id="96ba3-209">Return the page to connect display mode.</span></span> <span data-ttu-id="96ba3-210">而不是按一下連接動詞命令，請按一下**連接 WebPart 控制項**按鈕，以說明建立連接的第三個方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-210">Instead of clicking a connect verb, click the **Connect WebPart Controls** button, which illustrates the third method of forming a connection.</span></span> <span data-ttu-id="96ba3-211">這個方法會以程式設計方式在一個簡單的步驟中的控制項連線而不需要使用<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-211">This approach connects the controls programmatically in one simple step without having to use the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control.</span></span> <span data-ttu-id="96ba3-212">請注意，建立連接時，突然進入提供者的最後一個字串會出現在消費者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-212">Note that as the connection is created, the last string you entered in the provider suddenly appears in the consumer control.</span></span>  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Web.UI.WebControls.WebParts.ConnectionPoint" />
    <altmember cref="T:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" />
    <altmember cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" />
    <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartManager" />
    <altmember cref="T:System.Web.UI.WebControls.WebParts.ConnectionsZone" />
    <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" />
    <altmember cref="M:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts(System.Web.UI.WebControls.WebParts.WebPart,System.Web.UI.WebControls.WebParts.ProviderConnectionPoint,System.Web.UI.WebControls.WebParts.WebPart,System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint)" />
    <related type="Article" href="http://msdn.microsoft.com/library/d98cfd0f-ebd6-4871-89d5-abbd2cdef67b">
      <span data-ttu-id="96ba3-213">Web 組件連線概觀</span>
      <span class="sxs-lookup">
        <span data-stu-id="96ba3-213">Web Parts Connections Overview</span>
      </span>
    </related>
    <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
      <span data-ttu-id="96ba3-214">ASP.NET Web 組件頁面</span>
      <span class="sxs-lookup">
        <span data-stu-id="96ba3-214">ASP.NET Web Parts Pages</span>
      </span>
    </related>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public WebPartConnection ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.WebPartConnection.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; WebPartConnection();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-215">初始化 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-215">Initializes a new instance of the <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-216"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.%23ctor%2A>建構函式是公用的以便在網頁標記中宣告連接時，ASP.NET 剖析器可以建立執行個體，這個建構函式不是用於開發人員程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-216">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.%23ctor%2A> constructor is public so that the ASP.NET parser can create an instance when a connection is declared in the markup of a Web page; this constructor is not intended to be used in developer code.</span></span>  
  
 <span data-ttu-id="96ba3-217">當您想要建立<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>物件以程式設計的方式，您應該使用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A?displayProperty=nameWithType>或<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A?displayProperty=nameWithType>方法中提供<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-217">When you want to create a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object programmatically, you should use the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A?displayProperty=nameWithType> or the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A?displayProperty=nameWithType> method provided in the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control.</span></span> <span data-ttu-id="96ba3-218">這些方法會處理許多詳細資料，建立連接，然後傳回<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-218">These methods handle the many details of creating a connection, and return a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object.</span></span>  
  
 <span data-ttu-id="96ba3-219"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.%23ctor%2A>建構函式<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>類別設定的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>並<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>屬性，以`true`。</span><span class="sxs-lookup"><span data-stu-id="96ba3-219">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.%23ctor%2A> constructor for the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> class sets the values of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> and <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> properties to `true`.</span></span> <span data-ttu-id="96ba3-220">因此新的連接的預設狀態將是靜態 （亦即，它在包含網頁的標記中宣告），並且共用 （頁面的所有使用者看見）。</span><span class="sxs-lookup"><span data-stu-id="96ba3-220">Thus the default state of a new connection is to be static (meaning that it is declared in the markup of the containing Web page) and shared (visible to all users of the page).</span></span> <span data-ttu-id="96ba3-221">在典型的案例中，新增的連線所宣告的頁面標記中的連線時就會發生的情況`<asp:webpartconnection>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-221">This will be the case when you add a connection in the typical scenario, by declaring the connection in the markup of the page with an `<asp:webpartconnection>` element.</span></span> <span data-ttu-id="96ba3-222">不過，在其他情況下連線將會有不同的值，這些屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-222">However, in other circumstances a connection will have different values for these properties.</span></span> <span data-ttu-id="96ba3-223">例如，當您新增連線以程式設計方式建立連接物件中的程式碼，且使用者在檢視中的預設使用者個人化範圍的頁面，連線會建立為動態的每個-user(visible only to the specific user)連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-223">For example, when you add a connection programmatically by creating the connection object in code, and the user is viewing the page in the default user personalization scope, the connection is created as a dynamic, per-user(visible only to the specific user) connection.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="96ba3-224"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>並<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>屬性是唯讀的並判斷連線的本質，這些屬性在內部設定<xref:System.Web.UI.WebControls.WebParts.WebPartManager>根據連接的建立方式的控制項 (以宣告方式在頁面標記中，或以程式設計方式透過您的程式碼或使用者介面）。</span><span class="sxs-lookup"><span data-stu-id="96ba3-224">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> and <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> properties are read-only, and these properties that determine the nature of a connection are set internally by the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control depending on how a connection is created (declaratively in the page markup, or programmatically through your code or the user interface).</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts(System.Web.UI.WebControls.WebParts.WebPart,System.Web.UI.WebControls.WebParts.ProviderConnectionPoint,System.Web.UI.WebControls.WebParts.WebPart,System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint)" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-225">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-225">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="Consumer">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.WebPart Consumer { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.WebPart Consumer" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Consumer As WebPart" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::WebPart ^ Consumer { System::Web::UI::WebControls::WebParts::WebPart ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Consumer : System.Web.UI.WebControls.WebParts.WebPart" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.WebPart</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-226">取得做為連接之中消費者控制項的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-226">Gets a <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> object that is acting as the consumer control in a connection.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-227">
            <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" />，表示做為連接之中消費者的 Web 組件控制項。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-227">A <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> that represents the Web Parts control acting as the consumer in a connection.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-228">每個 Web 組件連接是由兩個共用資料的控制項所組成。</span><span class="sxs-lookup"><span data-stu-id="96ba3-228">Every Web Parts connection consists of two controls that share data.</span></span> <span data-ttu-id="96ba3-229">一個控制項做為資料提供者，而另一個控制項做為消費者接收和處理來自提供者的資料。</span><span class="sxs-lookup"><span data-stu-id="96ba3-229">One control acts as the provider of data, and the other control acts as a consumer, receiving and processing the data from the provider.</span></span> <span data-ttu-id="96ba3-230"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A>屬性取得的參考<xref:System.Web.UI.WebControls.WebParts.WebPart>控制做為連接的關聯性中的消費者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-230">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A> property gets a reference to the <xref:System.Web.UI.WebControls.WebParts.WebPart> control acting as a consumer in a connection relationship.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-231">下列程式碼範例示範如何以程式設計方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-231">The following code example demonstrates the programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-232">在程式碼範例包含四個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-232">The code example has four parts:</span></span>  
  
-   <span data-ttu-id="96ba3-233">使用者控制項，可讓您變更 Web 組件 頁面上顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-233">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="96ba3-234">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-234">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-235">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-235">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-236">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-236">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-237">此程式碼範例的第一個部分是可讓使用者變更顯示模式，在網頁上的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-237">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="96ba3-238">將以下的原始碼儲存到.ascx 檔，提供檔案名稱指派給`Src`屬性的`Register`這個使用者控制項指示詞，也就是裝載的 Web 網頁的頂端附近。</span><span class="sxs-lookup"><span data-stu-id="96ba3-238">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="96ba3-239">For 詳細資料會顯示在此控制項模式和原始碼的描述，請參閱[逐步解說： 變更 Web 組件頁面上顯示的模式](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-239">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_Consumer#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_Consumer#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="96ba3-240">在程式碼範例的第二個部分是原始碼的兩個<xref:System.Web.UI.WebControls.WebParts.WebPart>做為取用者，連接和連接點所用的介面的提供者的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-240">The second part of the code example is the source code for the two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls that serve as the consumer and the provider for the connection, and an interface used for the connection points.</span></span> <span data-ttu-id="96ba3-241">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-241">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-242">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-242">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-243">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-243">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-244">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-244">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-245">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-245">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_Consumer#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_Consumer#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-246">在程式碼範例的第三個部分是裝載控制項，並示範如何使用之 Web 網頁的程式碼<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-246">The third part of the code example is the code for the Web page that hosts the controls and demonstrates the use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A> property.</span></span> <span data-ttu-id="96ba3-247">頁面的頁面頂端附近`Register`使用者控制項和自訂控制項的指示詞。</span><span class="sxs-lookup"><span data-stu-id="96ba3-247">Near the top of the page are the `Register` directives for the user control and the custom controls.</span></span> <span data-ttu-id="96ba3-248">由於此範例使用動態編譯`Register`原始程式檔的指示詞不需要參考組件名稱，其中包括只有任意標記前置詞和控制項的命名空間。</span><span class="sxs-lookup"><span data-stu-id="96ba3-248">Because this example uses dynamic compilation, the `Register` directive for the source file does not need to reference an assembly name; it includes only an arbitrary tag prefix and the namespace of the controls.</span></span> <span data-ttu-id="96ba3-249">在 `Button2_Click`方法中，程式碼存取的連接物件，透過<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項，並取得的消費者控制項的參考。</span><span class="sxs-lookup"><span data-stu-id="96ba3-249">In the `Button2_Click` method, the code accesses the connection object through the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control, and gets a reference to the consumer control.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_Consumer#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_Consumer#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-250">在瀏覽器頁面載入之後，請使用**顯示模式**切換頁面以連線模式下的下拉式清單控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-250">After you load the page in a browser, use the **Display Mode** drop-down list control to switch the page to connect mode.</span></span> <span data-ttu-id="96ba3-251">按一下 動詞命令功能表 （以標題列中的向下箭號表示） 上的其中一個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，並按一下 connect 動詞命令。</span><span class="sxs-lookup"><span data-stu-id="96ba3-251">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="96ba3-252">使用**連接 WebPart 控制項** 按鈕或提供的連接使用者介面 (UI)，建立兩個控制項之間的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-252">Use the **Connect WebPart Controls** button, or the provided connection user interface (UI), to create a connection between the two controls.</span></span> <span data-ttu-id="96ba3-253">按一下 **顯示取用者資訊**按鈕，以執行程式碼，示範<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-253">Click the **Display Consumer Info** button to run the code that demonstrates the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="96ba3-254">
            <see cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID" /> 屬性的長度為零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-254">The length of the <see cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID" /> property is zero.</span>
          </span>
        </exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" />
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-255">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-255">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="ConsumerConnectionPoint">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint ConsumerConnectionPoint { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint ConsumerConnectionPoint" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ConsumerConnectionPoint As ConsumerConnectionPoint" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::ConsumerConnectionPoint ^ ConsumerConnectionPoint { System::Web::UI::WebControls::WebParts::ConsumerConnectionPoint ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.ConsumerConnectionPoint : System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-256">取得做為連接之中消費者控制項連接點的物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-256">Gets the object that serves as a connection point for a control that is acting as a consumer in a connection.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-257">與連接之中消費者控制項關聯的 <see cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-257">A <see cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" /> associated with the consumer control in a connection.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-258">其中一個所需的步驟建立兩個連線<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項是建立每個控制項連接點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-258">One of the required steps for creating a connection between two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls is to create connection points for each control.</span></span> <span data-ttu-id="96ba3-259">消費者連接點是物件，包含有關如何連接至做為消費者控制項的資訊。</span><span class="sxs-lookup"><span data-stu-id="96ba3-259">The consumer connection point is an object that contains the information about how to connect to the control acting as a consumer.</span></span> <span data-ttu-id="96ba3-260">取用者在原始程式碼中，其中一種方法必須用來識別`ConnectionConsumer`屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-260">In the consumer's source code, one of the methods must be identified with the `ConnectionConsumer` attribute.</span></span> <span data-ttu-id="96ba3-261"><xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>消費者控制項相關聯的物件包含方法和屬性，包括方法，在使用者介面 (UI) 中使用的顯示名稱的識別碼詳細資料，而哪種類型的介面的方法可以擷取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-261">The <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object that is associated with a consumer control contains details about the method and the attribute, including an ID for the method, a display name for use in the user interface (UI), and what type of interface the method can retrieve.</span></span> <span data-ttu-id="96ba3-262">這組取用者的相關資訊，其方法形成連線和它了解，介面的型別共同形成消費者連接點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-262">This set of information about the consumer, its method for forming connections, and the type of interface it understands, collectively forms a consumer connection point.</span></span>  
  
 <span data-ttu-id="96ba3-263">根據預設，<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>物件可以連接到只有一個<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>物件一次。</span><span class="sxs-lookup"><span data-stu-id="96ba3-263">By default, a <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object can connect to only one <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object at a time.</span></span> <span data-ttu-id="96ba3-264">取用者可能會有多個方法視為可能的消費者連接點，但是消費者只能參與一個是取用者以連線 （因此，只有一個取用者連接點可以是現用項目） 一次。</span><span class="sxs-lookup"><span data-stu-id="96ba3-264">A consumer could have multiple methods identified as possible consumer connection points, but a consumer can only participate in one connection as a consumer (hence, only one of its consumer connection points can be active) at a time.</span></span> <span data-ttu-id="96ba3-265">相反地，<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>可以連線到任何數目的<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-265">In contrast, a <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> can connect to any number of <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> objects.</span></span> <span data-ttu-id="96ba3-266">可以藉由覆寫變更此預設行為<xref:System.Web.UI.WebControls.WebParts.ConnectionConsumerAttribute.AllowsMultipleConnections%2A>屬性上的<xref:System.Web.UI.WebControls.WebParts.ConnectionConsumerAttribute>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-266">This default behavior can be changed by overriding the <xref:System.Web.UI.WebControls.WebParts.ConnectionConsumerAttribute.AllowsMultipleConnections%2A> property on the <xref:System.Web.UI.WebControls.WebParts.ConnectionConsumerAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-267">下列程式碼範例示範如何以程式設計方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-267">The following code example demonstrates the programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-268">此範例包含四個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-268">The example has four parts:</span></span>  
  
-   <span data-ttu-id="96ba3-269">使用者控制項，可讓您變更 Web 組件 頁面上顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-269">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="96ba3-270">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-270">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-271">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-271">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-272">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-272">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-273">此程式碼範例的第一個部分是可讓使用者變更顯示模式，在網頁上的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-273">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="96ba3-274">將以下的原始碼儲存到.ascx 檔，提供檔案名稱指派給`Src`屬性的`Register`這個使用者控制項指示詞，也就是裝載的 Web 網頁的頂端附近。</span><span class="sxs-lookup"><span data-stu-id="96ba3-274">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="96ba3-275">For 詳細資料會顯示在此控制項模式和原始碼的描述，請參閱[逐步解說： 變更 Web 組件頁面上顯示的模式](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-275">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerConnectionPoint#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerConnectionPoint#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="96ba3-276">在程式碼範例的第二個部分是原始碼的兩個<xref:System.Web.UI.WebControls.WebParts.WebPart>做為取用者，連接和連接點所用的介面的提供者的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-276">The second part of the code example is the source code for the two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls that serve as the consumer and the provider for the connection, and an interface used for the connection points.</span></span> <span data-ttu-id="96ba3-277">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-277">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-278">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-278">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-279">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-279">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-280">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-280">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-281">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-281">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ConsumerConnectionPoint#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ConsumerConnectionPoint#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-282">在程式碼範例的第三個部分是裝載控制項，並示範如何使用之 Web 網頁的程式碼<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-282">The third part of the code example is the code for the Web page that hosts the controls and demonstrates the use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A> property.</span></span> <span data-ttu-id="96ba3-283">在 `Button1_Click`方法，來建立連接所需的所有物件會都建立，包括<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-283">In the `Button1_Click` method, all the objects required to form a connection are created, including a <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object.</span></span> <span data-ttu-id="96ba3-284">這些物件會傳遞至<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法用來建立連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-284">These objects are all passed to the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method to create the connection.</span></span> <span data-ttu-id="96ba3-285">在 `Button2_Click`方法，將程式碼會存取<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A>屬性，並顯示某些的連接點的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="96ba3-285">In the `Button2_Click` method, the code accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A> property and displays some details of the connection point.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerConnectionPoint#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerConnectionPoint#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-286">在瀏覽器頁面載入之後，請使用**顯示模式**切換頁面以連線模式下的下拉式清單控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-286">After you load the page in a browser, use the **Display Mode** drop-down list control to switch the page to connect mode.</span></span> <span data-ttu-id="96ba3-287">按一下 動詞命令功能表 （以標題列中的向下箭號表示） 上的其中一個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，並按一下 connect 動詞命令。</span><span class="sxs-lookup"><span data-stu-id="96ba3-287">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="96ba3-288">使用**連接 WebPart 控制項** 按鈕或提供的連接使用者介面，建立兩個控制項之間的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-288">Use the **Connect WebPart Controls** button, or the provided connection UI, to create a connection between the two controls.</span></span> <span data-ttu-id="96ba3-289">按一下  **ConnectionPoint 詳細資料**按鈕，以執行程式碼，示範<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-289">Click the **ConnectionPoint Details** button to run the code that demonstrates the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ConnectionConsumerAttribute" />
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-290">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-290">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="ConsumerConnectionPointID">
      <MemberSignature Language="C#" Value="public string ConsumerConnectionPointID { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ConsumerConnectionPointID" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID" />
      <MemberSignature Language="VB.NET" Value="Public Property ConsumerConnectionPointID As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ConsumerConnectionPointID { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ConsumerConnectionPointID : string with get, set" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("default")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-291">取得或設定連接上的屬性值，這個屬性會參考做為此連接之消費者連接點的物件 ID。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-291">Gets or sets the property value on a connection that references the ID of the object serving as the consumer connection point for that connection.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-292">字串，包含消費者連接點的 ID。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-292">A string that contains the ID for the consumer connection point.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-293">對於 Web 網頁標記中宣告靜態的連線，開發人員可以指定哪些消費者連接點將用於連線的指派值給`ConsumerConnectionPointID`屬性上`<asp:webpartconnection>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-293">For a static connection declared in the markup of a Web page, developers can specify which consumer connection point will be used for the connection by assigning a value to the `ConsumerConnectionPointID` attribute on the `<asp:webpartconnection>` element.</span></span> <span data-ttu-id="96ba3-294">如果值不會指派給屬性，<xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID>使用屬性值。</span><span class="sxs-lookup"><span data-stu-id="96ba3-294">If a value is not assigned to the attribute, the <xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID> property value is used.</span></span>  
  
 <span data-ttu-id="96ba3-295">當您建立動態的 （以程式設計方式） 連線時，通常您不應將值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-295">When you create dynamic (programmatic) connections, normally you should not set the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property.</span></span> <span data-ttu-id="96ba3-296">您可以只呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制、 將傳遞給它的取用者和消費者連接點物件 （以及其他必要的參數），以及該方法會判斷正確的識別碼，以使用於取用者的連線點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-296">You can simply call the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control, passing to it the consumer and consumer connection point objects (along with the other required parameters), and that method determines the correct ID to use for the consumer's connection point.</span></span> <span data-ttu-id="96ba3-297">同樣地，當您中斷連線，您可以呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartManager.DisconnectWebParts%2A>方法，而不需要指定<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>屬性值。</span><span class="sxs-lookup"><span data-stu-id="96ba3-297">Similarly, when you disconnect, you can call the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.DisconnectWebParts%2A> method without needing to specify the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property value.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="96ba3-298">可判斷消費者連接點的識別碼，當您指定<xref:System.Web.UI.WebControls.WebParts.WebPart>或其他伺服器控制項，以取用者身分。</span><span class="sxs-lookup"><span data-stu-id="96ba3-298">The ID of a consumer's connection point can be determined when you designate a <xref:System.Web.UI.WebControls.WebParts.WebPart> or other server control as a consumer.</span></span> <span data-ttu-id="96ba3-299">您必須識別取用者所擷取的提供者控制項或轉換程式所提供的介面執行個體中的方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-299">You must identify a method in the consumer that retrieves an instance of an interface furnished by either a provider control or a transformer.</span></span> <span data-ttu-id="96ba3-300">若要識別的方法，將它與標示`ConnectionConsumer`code 屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-300">To identify the method, mark it with the `ConnectionConsumer` code attribute.</span></span> <span data-ttu-id="96ba3-301">當您新增這個屬性時，您可以新增選擇性的字串值參數做為識別碼的取用者的<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-301">When you add this attribute, you can add an optional string value parameter that serves as an ID for the consumer's <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object.</span></span> <span data-ttu-id="96ba3-302">如果您提供選擇性的 ID 參數的值，該值會變成值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>連接的屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-302">If you supply a value for the optional ID parameter, that value becomes the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property for the connection.</span></span> <span data-ttu-id="96ba3-303">如果您未提供識別碼值<xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID>使用屬性值。</span><span class="sxs-lookup"><span data-stu-id="96ba3-303">If you do not supply an ID value, the <xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID> property value is used.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-304">下列程式碼範例示範宣告式和以程式設計方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-304">The following code example shows the declarative and programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-305">此範例包含四個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-305">The example has four parts:</span></span>  
  
-   <span data-ttu-id="96ba3-306">使用者控制項，可讓您變更 Web 組件 頁面上顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-306">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="96ba3-307">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-307">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-308">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-308">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-309">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-309">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-310">此程式碼範例的第一個部分是可讓使用者變更顯示模式，在網頁上的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-310">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="96ba3-311">將以下的原始碼儲存到.ascx 檔，提供檔案名稱指派給`Src`屬性的`Register`這個使用者控制項指示詞，也就是裝載的 Web 網頁的頂端附近。</span><span class="sxs-lookup"><span data-stu-id="96ba3-311">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="96ba3-312">For 詳細資料會顯示在此控制項模式和原始碼的描述，請參閱[逐步解說： 變更 Web 組件頁面上顯示的模式](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-312">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerConnectionPointID#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerConnectionPointID#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="96ba3-313">在程式碼範例的第二個部分是介面與消費者和提供者控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-313">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="96ba3-314">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-314">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-315">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-315">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-316">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-316">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-317">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-317">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-318">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-318">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ConsumerConnectionPointID#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ConsumerConnectionPointID#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-319">在程式碼範例的第三個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-319">The third part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-320">請注意，連接宣告在頁面標記中，使用`<StaticConnections>`和`<asp:WebPartsConnection>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-320">Note that a connection is declared in the page markup, using the `<StaticConnections>` and `<asp:WebPartsConnection>` elements.</span></span> <span data-ttu-id="96ba3-321">連線宣告包含所需`ConsumerConnectionPointID`屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-321">The connection declaration includes the required `ConsumerConnectionPointID` attribute.</span></span> <span data-ttu-id="96ba3-322">建立連接的第二個方法會出現在`Button1_Click`方法，其中的程式碼會建立新的連接，並使用消費者控制項中所定義的連接點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-322">A second method for creating the connection appears in the `Button1_Click` method, where the code creates a new connection, using the connection point defined in the consumer control.</span></span> <span data-ttu-id="96ba3-323">然後，在`Button2_Click`方法，將程式碼會存取<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-323">Then, in the `Button2_Click` method, the code accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerConnectionPointID#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerConnectionPointID#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-324">在瀏覽器頁面載入之後，連線已存在靜態網頁中宣告的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-324">After you load the page in a browser, a connection already exists because of the static connection declared in the page.</span></span> <span data-ttu-id="96ba3-325">在提供者控制項中，輸入一些文字，並請注意，它會顯示因為連線取用者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-325">Enter some text in the provider control, and note that it is displayed in the consumer due to the connection.</span></span> <span data-ttu-id="96ba3-326">接下來，中斷連接的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-326">Next, disconnect the controls.</span></span> <span data-ttu-id="96ba3-327">使用**顯示模式**下拉式清單控制項中，切換頁面，即可連接模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-327">Using the **Display Mode** drop-down list control, switch the page to connect mode.</span></span> <span data-ttu-id="96ba3-328">按一下 動詞命令功能表 （以標題列中的向下箭號表示） 上的其中一個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，並按一下 connect 動詞命令。</span><span class="sxs-lookup"><span data-stu-id="96ba3-328">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="96ba3-329">按一下 [**中斷連線**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="96ba3-329">Click the **Disconnect** button.</span></span> <span data-ttu-id="96ba3-330">使用**連接 WebPart 控制項**按鈕以重新建立兩個控制項之間的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-330">Use the **Connect WebPart Controls** button to recreate a connection between the two controls.</span></span> <span data-ttu-id="96ba3-331">按一下  **ConnectionPoint 詳細資料**按鈕，以執行存取的程式碼<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>屬性值。</span><span class="sxs-lookup"><span data-stu-id="96ba3-331">Click the **ConnectionPoint Details** button to run the code that accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property value.</span></span> <span data-ttu-id="96ba3-332">在 [標籤] 控制項下方，值會寫出。</span><span class="sxs-lookup"><span data-stu-id="96ba3-332">The value is written out in a label below the controls.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" />
        <altmember cref="P:System.Web.UI.WebControls.WebParts.ConnectionPoint.ID" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-333">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-333">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="ConsumerID">
      <MemberSignature Language="C#" Value="public string ConsumerID { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ConsumerID" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID" />
      <MemberSignature Language="VB.NET" Value="Public Property ConsumerID As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ConsumerID { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ConsumerID : string with get, set" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-334">取得或設定連接上的屬性值，這個屬性會參考做為此連接之消費者 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 控制項的 ID。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-334">Gets or sets the property value on a connection that references the ID of the <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> control acting as a consumer for that connection.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-335">字串，包含做為連接之中消費者控制項的 ID。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-335">A string that contains the ID of the control acting as a consumer in a connection.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-336"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A>屬性值時，必須建立之間的連線<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-336">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A> property value is required when you create a connection between <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="96ba3-337">如果值不指派給屬性，會擲回例外狀況時<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項嘗試在啟動連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-337">If a value is not assigned to the property, an exception is thrown when the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control attempts to activate the connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-338">下列程式碼範例示範宣告式和以程式設計方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-338">The following code example shows the declarative and programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-339">此範例包含四個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-339">The example has four parts:</span></span>  
  
-   <span data-ttu-id="96ba3-340">使用者控制項，可讓您變更 Web 組件 頁面上顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-340">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="96ba3-341">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-341">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-342">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-342">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-343">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-343">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-344">此程式碼範例的第一個部分是可讓使用者變更顯示模式，在網頁上的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-344">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="96ba3-345">將以下的原始碼儲存到.ascx 檔，提供檔案名稱指派給`Src`屬性的`Register`這個使用者控制項指示詞，也就是裝載的 Web 網頁的頂端附近。</span><span class="sxs-lookup"><span data-stu-id="96ba3-345">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="96ba3-346">For 詳細資料會顯示在此控制項模式和原始碼的描述，請參閱[逐步解說： 變更 Web 組件頁面上顯示的模式](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-346">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerID#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerID#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="96ba3-347">在程式碼範例的第二個部分是介面與消費者和提供者控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-347">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="96ba3-348">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-348">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-349">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-349">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-350">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-350">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-351">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-351">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-352">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-352">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ConsumerID#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ConsumerID#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-353">在程式碼範例的第三個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-353">The third part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-354">請注意，連接宣告在頁面標記中，使用`<StaticConnections>`和`<asp:WebPartsConnection>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-354">Note that a connection is declared in the page markup, using the `<StaticConnections>` and `<asp:WebPartsConnection>` elements.</span></span> <span data-ttu-id="96ba3-355">連線宣告包含所需`ConsumerID`屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-355">The connection declaration includes the required `ConsumerID` attribute.</span></span> <span data-ttu-id="96ba3-356">建立連接的第二個方法會出現在`Button1_Click`方法，其中的程式碼會建立新的連接，並使用消費者控制項中所定義的連接點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-356">A second method for creating the connection appears in the `Button1_Click` method, where the code creates a new connection, using the connection point defined in the consumer control.</span></span> <span data-ttu-id="96ba3-357">然後，在`Button2_Click`方法，將程式碼會存取的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A>屬性並將它顯示在標籤中。</span><span class="sxs-lookup"><span data-stu-id="96ba3-357">Then, in the `Button2_Click` method, the code accesses the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A> property and displays it in a label.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerID#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerID#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-358">在瀏覽器頁面載入之後，連線已存在靜態網頁中宣告的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-358">After you load the page in a browser, a connection already exists because of the static connection declared in the page.</span></span> <span data-ttu-id="96ba3-359">在提供者控制項中，輸入一些文字，並請注意，它會顯示因為連線取用者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-359">Enter some text in the provider control, and note that it is displayed in the consumer due to the connection.</span></span> <span data-ttu-id="96ba3-360">接下來，中斷連接的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-360">Next, disconnect the controls.</span></span> <span data-ttu-id="96ba3-361">使用**顯示模式**下拉式清單控制項中，切換頁面，即可連接模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-361">Using the **Display Mode** drop-down list control, switch the page to connect mode.</span></span> <span data-ttu-id="96ba3-362">按一下 動詞命令功能表 （以標題列中的向下箭號表示） 上的其中一個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，並按一下 connect 動詞命令。</span><span class="sxs-lookup"><span data-stu-id="96ba3-362">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="96ba3-363">按一下 [**中斷連線**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="96ba3-363">Click the **Disconnect** button.</span></span> <span data-ttu-id="96ba3-364">使用**連接 WebPart 控制項**按鈕以重新建立兩個控制項之間的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-364">Use the **Connect WebPart Controls** button to recreate a connection between the two controls.</span></span> <span data-ttu-id="96ba3-365">按一下 **取用者詳細資料**按鈕，以執行存取的程式碼<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A>屬性值。</span><span class="sxs-lookup"><span data-stu-id="96ba3-365">Click the **Consumer Details** button to run the code that accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A> property value.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-366">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-366">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="ID">
      <MemberSignature Language="C#" Value="public string ID { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ID" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ID" />
      <MemberSignature Language="VB.NET" Value="Public Property ID As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ID { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ID : string with get, set" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ID" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-367">取得或設定 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 物件的 ID。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-367">Gets or sets the ID of a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> object.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-368">字串，包含 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 的 ID。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-368">A string that contains the ID of a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-369">每隔<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>物件具有唯一的值指派給其<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-369">Every <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object has a unique value assigned to its <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A> property.</span></span> <span data-ttu-id="96ba3-370">這是為了確保沒有區分多個連線的方式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-370">This is to ensure that there is a way to distinguish between multiple connections.</span></span>  
  
 <span data-ttu-id="96ba3-371">如果您建立宣告的靜態連接`<asp:webpartconnection>`元素在網頁上，而且您不會指派值給`ID`屬性進行連接，例外狀況時擲回<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項嘗試在啟動連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-371">If you create a static connection by declaring an `<asp:webpartconnection>` element in a Web page, and you do not assign a value to the `ID` attribute for the connection, an exception is thrown when the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control attempts to activate the connection.</span></span>  
  
 <span data-ttu-id="96ba3-372">當<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項建立新的動態連接，它會呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartManager.CreateDynamicConnectionID%2A>方法來產生連線的唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-372">When the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control creates a new dynamic connection, it calls the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.CreateDynamicConnectionID%2A> method to generate a unique ID for the connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-373">下列程式碼範例示範宣告式和以程式設計方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-373">The following code example shows the declarative and programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-374">此範例包含四個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-374">The example has four parts:</span></span>  
  
-   <span data-ttu-id="96ba3-375">使用者控制項，可讓您變更 Web 組件 頁面上顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-375">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="96ba3-376">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-376">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-377">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-377">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-378">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-378">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-379">此程式碼範例的第一個部分是可讓使用者變更顯示模式，在網頁上的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-379">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="96ba3-380">將以下的原始碼儲存到.ascx 檔，提供檔案名稱指派給`Src`屬性的`Register`這個使用者控制項指示詞，也就是裝載的 Web 網頁的頂端附近。</span><span class="sxs-lookup"><span data-stu-id="96ba3-380">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="96ba3-381">For 詳細資料會顯示在此控制項模式和原始碼的描述，請參閱[逐步解說： 變更 Web 組件頁面上顯示的模式](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-381">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ID#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ID#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="96ba3-382">在程式碼範例的第二個部分是介面與消費者和提供者控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-382">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="96ba3-383">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-383">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-384">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-384">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-385">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-385">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-386">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-386">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-387">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-387">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ID#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ID#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-388">在程式碼範例的第三個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-388">The third part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-389">請注意，連接宣告在頁面標記中，使用`<StaticConnections>`和`<asp:WebPartsConnection>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-389">Note that a connection is declared in the page markup, using the `<StaticConnections>` and `<asp:WebPartsConnection>` elements.</span></span> <span data-ttu-id="96ba3-390">連線宣告包含所需`ID`屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-390">The connection declaration includes the required `ID` attribute.</span></span> <span data-ttu-id="96ba3-391">建立連接的第二個方法會出現在`Button1_Click`方法，其中的程式碼會建立新的連接，並使用消費者控制項中所定義的連接點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-391">A second method for creating the connection appears in the `Button1_Click` method, where the code creates a new connection, using the connection point defined in the consumer control.</span></span> <span data-ttu-id="96ba3-392">在這裡，ID 屬性不是必要的因為連接是動態的而<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項連接至指派的識別碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-392">Here, the ID property is not required, because the connection is dynamic, and the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control assigns an ID to the connection.</span></span> <span data-ttu-id="96ba3-393">在 `Button2_Click`方法，將程式碼會存取的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A>屬性並將它顯示在標籤中。</span><span class="sxs-lookup"><span data-stu-id="96ba3-393">In the `Button2_Click` method, the code accesses the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A> property and displays it in a label.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ID#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ID#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-394">在瀏覽器頁面載入之後，連線已存在靜態網頁中宣告的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-394">After you load the page in a browser, a connection already exists because of the static connection declared in the page.</span></span> <span data-ttu-id="96ba3-395">在提供者控制項中，輸入一些文字，並請注意，它會顯示因為連線取用者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-395">Enter some text in the provider control, and note that it is displayed in the consumer due to the connection.</span></span> <span data-ttu-id="96ba3-396">接下來，中斷連接的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-396">Next, disconnect the controls.</span></span> <span data-ttu-id="96ba3-397">使用**顯示模式**下拉式清單控制項中，切換頁面，即可連接模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-397">Using the **Display Mode** drop-down list control, switch the page to connect mode.</span></span> <span data-ttu-id="96ba3-398">按一下 動詞命令功能表 （以標題列中的向下箭號表示） 上的其中一個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，並按一下 connect 動詞命令。</span><span class="sxs-lookup"><span data-stu-id="96ba3-398">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="96ba3-399">按一下 [**中斷連線**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="96ba3-399">Click the **Disconnect** button.</span></span> <span data-ttu-id="96ba3-400">使用**連接 WebPart 控制項**按鈕以重新建立兩個控制項之間的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-400">Use the **Connect WebPart Controls** button to recreate a connection between the two controls.</span></span> <span data-ttu-id="96ba3-401">按一下 **連線詳細資料**按鈕，以執行存取的程式碼<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A>屬性值。</span><span class="sxs-lookup"><span data-stu-id="96ba3-401">Click the **Connection Details** button to run the code that accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A> property value.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-402">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-402">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="IsActive">
      <MemberSignature Language="C#" Value="public bool IsActive { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool IsActive" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property IsActive As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool IsActive { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.IsActive : bool" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-403">取得指出目前是否已建立 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 物件，並且其提供者和消費者控制項之間是否可以交換資料的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-403">Gets a value that indicates whether a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> object is currently established and able to exchange data between its provider and consumer controls.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-404">如果連接在作用中，則為 <see langword="true" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-404">
              <see langword="true" /> if the connection is active; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-405"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A>屬性會指出狀態<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-405">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A> property indicates a state of a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object.</span></span> <span data-ttu-id="96ba3-406">當連線處於此狀態時，提供者和消費者控制項連接中的也會通訊，而且能夠透過通用介面交換資料或<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-406">When the connection is in this state, the provider and consumer controls in the connection are communicating and able to exchange data through a common interface or a <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object.</span></span>  
  
 <span data-ttu-id="96ba3-407">當使用者檢視呈現的網頁，其中包含一般的瀏覽模式的已建立的連線時，連線通常是作用中 （除非它無法載入頁面時，因為某些衝突或其他問題啟用）。</span><span class="sxs-lookup"><span data-stu-id="96ba3-407">When a user views a rendered page that includes an established connection in normal browse mode, the connection is typically active (unless it failed to be activated due to some conflict or other issue when the page loaded).</span></span> <span data-ttu-id="96ba3-408">在頁面和控制項的生命週期的早期階段，屬性值是`false`。</span><span class="sxs-lookup"><span data-stu-id="96ba3-408">In the early stages of the page and control life cycle, the property value is `false`.</span></span> <span data-ttu-id="96ba3-409">連接啟動之後<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivated>上的事件<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項，就會引發。</span><span class="sxs-lookup"><span data-stu-id="96ba3-409">The connection is activated just after the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivated> event on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control is raised.</span></span> <span data-ttu-id="96ba3-410">具體而言，連接後，會啟用取用者已從提供者擷取的指定介面的執行個體或<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-410">Specifically, the connection is activated after the consumer has retrieved an instance of the specified interface from the provider or a <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object.</span></span>  
  
 <span data-ttu-id="96ba3-411">您最好知道連線是否作用中的情況下，可能會有衝突或同步處理的問題，因為多個頁面上的連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-411">It is useful to know whether a connection is active in situations where there might be conflicts or synchronization issues due to multiple connections on a page.</span></span> <span data-ttu-id="96ba3-412">例如，如果沒有某種類型的兩個連線，衝突<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項有不啟動其中一個連線的選項，以避免衝突。</span><span class="sxs-lookup"><span data-stu-id="96ba3-412">For example, if there is some kind of conflict between two connections, the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control has the option of not activating one of the connections to avoid the conflict.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-413">下列程式碼範例示範使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-413">The following code example demonstrates use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-414">此範例包含三個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-414">The example has three parts:</span></span>  
  
-   <span data-ttu-id="96ba3-415">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-415">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-416">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-416">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-417">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-417">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-418">在程式碼範例的第一個部分是在介面中，與消費者和提供者控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-418">The first part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="96ba3-419">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-419">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-420">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-420">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-421">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-421">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-422">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-422">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-423">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-423">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_IsActive#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsActive/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_IsActive#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsActive/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-424">在程式碼範例的第二個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-424">The second part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-425">頂端附近`Register`指示詞參考兩個動態編譯的原始程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-425">Near the top is a `Register` directive that refers to the source code for the two dynamically compiled <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="96ba3-426">在宣告靜態連接`<StaticConnections>`頁面上的項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-426">The static connection is declared within the `<StaticConnections>` element on the page.</span></span> <span data-ttu-id="96ba3-427">內`<script>`項目是四個事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-427">Within the `<script>` element are four event handlers.</span></span> <span data-ttu-id="96ba3-428">每個事件處理常式會檢查的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A>屬性為靜態的連線，並將訊息寫入至<xref:System.Web.UI.WebControls.Label>指出連線在網頁和控制項的生命週期的狀態是否為作用中或非使用中的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-428">Each event handler checks the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A> property on the static connection, and writes a message to the <xref:System.Web.UI.WebControls.Label> control indicating whether the connection is active or inactive at that state of the page and control life cycle.</span></span> <span data-ttu-id="96ba3-429">此範例示範在哪個時間點的連線變成使用中，它仍然使用中頁面之後會呈現。</span><span class="sxs-lookup"><span data-stu-id="96ba3-429">This demonstrates at what point the connection becomes active, and that it remains active after the page is rendered.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_IsActive#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsActive/CS/wpConnectIsActiveCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_IsActive#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsActive/VB/wpConnectIsActiveVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-430">將網頁瀏覽器中的載入。</span><span class="sxs-lookup"><span data-stu-id="96ba3-430">Load the page in a browser.</span></span> <span data-ttu-id="96ba3-431">已建立靜態的連線，並已經寫入訊息標籤，顯示是否連線為作用中的各個點上頁面和控制項的生命週期中。</span><span class="sxs-lookup"><span data-stu-id="96ba3-431">The static connection is already created, and messages have already been written to the labels showing whether the connection was active at various points in the page and control life cycle.</span></span> <span data-ttu-id="96ba3-432">按一下 **連線詳細資料**按鈕，並請注意，連線不在使用中，但連線就會重新啟動後每次<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivated>事件，且其為仍在作用中 （且會維持不變） 之後<xref:System.Web.UI.Control.PreRender>頁面的事件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-432">Click the **Connection Details** button, and note that the connection is not active at that point, but that the connection is reactivated each time after the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivated> event, and that it is still active (and will remain so) after the <xref:System.Web.UI.Control.PreRender> event of the page.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPart.IsStatic" />
        <altmember cref="M:System.Web.UI.WebControls.WebParts.WebPartManager.ActivateConnections" />
        <altmember cref="E:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivated" />
        <altmember cref="E:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivating" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-433">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-433">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="IsShared">
      <MemberSignature Language="C#" Value="public bool IsShared { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool IsShared" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property IsShared As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool IsShared { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.IsShared : bool" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-434">取得值，指出 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 物件對所有使用者或只對目前使用者為可見。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-434">Gets a value that indicates whether a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> object is visible to all users or only to the current user.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-435">如果連接是共用的，則為 <see langword="true" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-435">
              <see langword="true" /> if the connection is shared; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-436">就像個人<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>物件可以是共用或每位使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="96ba3-436">As with individual <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object can be a shared or a per-user instance.</span></span> <span data-ttu-id="96ba3-437">共用的執行個體表示連線的網頁的所有使用者顯示，且每位使用者執行個體表示連接是只有特定使用者才能看見。</span><span class="sxs-lookup"><span data-stu-id="96ba3-437">A shared instance means that the connection is visible to all users of a Web page, and a per-user instance means the connection is visible only to a specific user.</span></span>  
  
 <span data-ttu-id="96ba3-438">一般情況下，連接加入至頁面的方式會決定是否為共用連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-438">In general, the way a connection is added to a page determines whether the connection is shared.</span></span> <span data-ttu-id="96ba3-439">如果連接在網頁標記中宣告，則連線會共用並<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>屬性值是`true`。</span><span class="sxs-lookup"><span data-stu-id="96ba3-439">If the connection is declared in the markup of a Web page, then the connection is shared and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property value is `true`.</span></span> <span data-ttu-id="96ba3-440">此外，如果網頁在共用的個人化範圍內時加入連接，也被共用的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-440">In addition, if the Web page is in shared personalization scope when a connection is added, the connection is also shared.</span></span> <span data-ttu-id="96ba3-441">一般而言，當使用者使用`<asp:connectionszone>`新增連接時，頁面的使用者介面 (UI) 是使用者個人化範圍，因此不會共用連接並<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>屬性值是`false`。</span><span class="sxs-lookup"><span data-stu-id="96ba3-441">Typically, when a user uses the `<asp:connectionszone>` user interface (UI) to add a connection, the page is in user personalization scope, so the connection is not shared and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property value is `false`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-442">下列程式碼範例示範如何以程式設計方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-442">The following code example demonstrates programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-443">在程式碼範例包含五個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-443">The code example has five parts:</span></span>  
  
-   <span data-ttu-id="96ba3-444">使用者控制項，可讓您變更 Web 組件 頁面上顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-444">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="96ba3-445">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-445">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-446">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-446">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-447">在 Web.config 檔案，才能執行此範例中的項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-447">An entry in the Web.config file that is required to run the example.</span></span>  
  
-   <span data-ttu-id="96ba3-448">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-448">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-449">此程式碼範例的第一個部分是可讓使用者變更顯示模式，在網頁上的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-449">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="96ba3-450">將以下的原始碼儲存到.ascx 檔，提供檔案名稱指派給`Src`屬性的`Register`這個使用者控制項指示詞，也就是裝載的 Web 網頁的頂端附近。</span><span class="sxs-lookup"><span data-stu-id="96ba3-450">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="96ba3-451">For 詳細資料會顯示在此控制項模式和原始碼的描述，請參閱[逐步解說： 變更 Web 組件頁面上顯示的模式](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-451">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_IsShared#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_IsShared#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="96ba3-452">在程式碼範例的第二個部分是介面與消費者和提供者控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-452">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="96ba3-453">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-453">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-454">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-454">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-455">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-455">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-456">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-456">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-457">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-457">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_IsShared#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_IsShared#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-458">在程式碼範例的第三個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-458">The third part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-459">在 `Button2_Click`方法，它會檢查<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>現有的連接屬性，並顯示結果頁面上。</span><span class="sxs-lookup"><span data-stu-id="96ba3-459">In the `Button2_Click` method, it checks the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property of the existing connection and displays the result on the page.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_IsShared#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_IsShared#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-460">在程式碼範例的第四個部分是所需的使用者帳戶，將會執行能夠編輯共用個人化範圍中的網頁範例 Web.config 檔案中的項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-460">The fourth part of the code example is an entry in the Web.config file that is required for the user account that will be running the example to be able to edit the page in shared personalization scope.</span></span> <span data-ttu-id="96ba3-461">若要這麼做，您必須有一個項目內的 Web.config 檔案中`<system.web>`區段，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="96ba3-461">To enable this, you must have an entry in the Web.config file within the `<system.web>` section that looks like the following example.</span></span>  
  
```  
<webParts>  
  <personalization>  
    <authorization>  
      <allow users="UserAccount"  
             roles="admin"  
             verbs="enterSharedScope"/>  
    </authorization>            
  </personalization>  
</webParts>  
```  
  
 <span data-ttu-id="96ba3-462">在瀏覽器頁面載入之後，請使用**顯示模式**，將頁面連線顯示模式切換的下拉式清單控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-462">After you load the page in a browser, use the **Display Mode** drop-down list control to switch the page to connect display mode.</span></span> <span data-ttu-id="96ba3-463">按一下 **連接 WebPart 控制項**按鈕以建立連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-463">Click the **Connect WebPart Controls** button to form a connection.</span></span> <span data-ttu-id="96ba3-464">接下來，按一下**連線詳細資料** 按鈕以顯示連接是否為共用。</span><span class="sxs-lookup"><span data-stu-id="96ba3-464">Next, click the **Connection Details** button to display whether the connection is shared.</span></span> <span data-ttu-id="96ba3-465">如果您在預設使用者個人化範圍內，頁面建立連線<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>屬性值應為`false`連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-465">If you created the connection with the page in the default user personalization scope, the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property value should be `false` for the connection.</span></span>  
  
 <span data-ttu-id="96ba3-466">其中一個的動詞命令功能表上<xref:System.Web.UI.WebControls.WebParts.WebPart>（標題列中向下箭頭所指示） 的控制項，按一下 connect 動詞命令。</span><span class="sxs-lookup"><span data-stu-id="96ba3-466">On the verbs menu of one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls (indicated by the downward arrow in the title bar), click the connect verb.</span></span> <span data-ttu-id="96ba3-467">連接 UI 出現時，按一下**中斷連線** 按鈕以結束連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-467">When the connection UI appears, click the **Disconnect** button to end the connection.</span></span> <span data-ttu-id="96ba3-468">使用**顯示模式**返回頁面，即可瀏覽模式的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-468">Use the **Display Mode** control to return the page to browse mode.</span></span>  
  
 <span data-ttu-id="96ba3-469">在 [**顯示模式**控制項中，選取**共用**] 選項，切換至頁面共用個人化範圍。</span><span class="sxs-lookup"><span data-stu-id="96ba3-469">In the **Display Mode** control, select the **Shared** option to switch the page into shared personalization scope.</span></span> <span data-ttu-id="96ba3-470">請遵循相同的步驟，以建立連線，再次按一下上述**連線詳細資料** 按鈕以顯示連接是否為共用。</span><span class="sxs-lookup"><span data-stu-id="96ba3-470">Follow the same steps as those above to create a connection, and again click the **Connection Details** button to display whether the connection is shared.</span></span> <span data-ttu-id="96ba3-471">在此案例中的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>屬性應該是`true`。</span><span class="sxs-lookup"><span data-stu-id="96ba3-471">In this case, the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property should be `true`.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPart.IsShared" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-472">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-472">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="IsStatic">
      <MemberSignature Language="C#" Value="public bool IsStatic { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool IsStatic" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property IsStatic As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool IsStatic { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.IsStatic : bool" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-473">取得值，指出 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 物件是在網頁標記中宣告，還是以程式設計方式建立的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-473">Gets a value that indicates whether a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> object is declared in the markup of a Web page, or created programmatically.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-474">如果連接是靜態的，則為 <see langword="true" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-474">
              <see langword="true" /> if the connection is static; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-475">Web 組件控制項之間的連線可以是靜態或動態。</span><span class="sxs-lookup"><span data-stu-id="96ba3-475">Connections between Web Parts controls can be either static or dynamic.</span></span> <span data-ttu-id="96ba3-476">在網頁標記中宣告靜態連接使用`<asp:WebPartConnection>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-476">A static connection is declared in the markup of a Web page, using an `<asp:WebPartConnection>` element.</span></span> <span data-ttu-id="96ba3-477">以程式設計方式建立動態的連接，或當使用者建立透過使用者介面 (UI) 所定義的連接<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-477">Dynamic connections are created programmatically or when a user creates a connection through the user interface (UI) defined by the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control.</span></span>  
  
 <span data-ttu-id="96ba3-478">靜態連接是共用的物件，表示它們為供所有使用者的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-478">Static connections are shared objects, meaning they are available to all users of the Web page.</span></span> <span data-ttu-id="96ba3-479">此外，它們是永久基本上是因為，例如靜態<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，無法永久刪除它們。</span><span class="sxs-lookup"><span data-stu-id="96ba3-479">Also, they are essentially permanent because, like a static <xref:System.Web.UI.WebControls.WebParts.WebPart> control, they cannot be permanently deleted.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="96ba3-480">無法永久刪除靜態連接物件，它可以是永久中斷連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-480">While a static connection object cannot be permanently deleted, it can be permanently disconnected.</span></span> <span data-ttu-id="96ba3-481">在此案例中，中斷連接的物件會存在於伺服器上，但使用者永遠不會察覺在網頁中的物件存在。</span><span class="sxs-lookup"><span data-stu-id="96ba3-481">In this case, the disconnected object would exist on the server, but an end user would never be aware of the object's existence in a page.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-482">下列程式碼範例示範如何以程式設計方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-482">The following code example demonstrates the programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-483">在程式碼範例有三個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-483">The code example has three parts:</span></span>  
  
-   <span data-ttu-id="96ba3-484">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-484">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-485">若要裝載控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-485">A Web page to host the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-486">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-486">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-487">在程式碼範例的第一個部分是在介面中，與消費者和提供者控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-487">The first part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="96ba3-488">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-488">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-489">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-489">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-490">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-490">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-491">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-491">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-492">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-492">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_IsStatic#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsStatic/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_IsStatic#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsStatic/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-493">在程式碼範例的第二個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-493">The second part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-494">頂端附近`Register`指示詞參考兩個動態編譯的原始程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-494">Near the top is a `Register` directive that refers to the source code for the two dynamically compiled <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="96ba3-495">在宣告靜態連接`<StaticConnections>`頁面上的項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-495">The static connection is declared within the `<StaticConnections>` element on the page.</span></span> <span data-ttu-id="96ba3-496">`Button1_Click`方法存取<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>来檢查連線是否為靜態屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-496">The `Button1_Click` method accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> property to check whether the connection is static.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_IsStatic#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsStatic/CS/wpConnectIsStaticCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_IsStatic#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsStatic/VB/wpConnectIsStaticVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-497">將網頁瀏覽器中的載入。</span><span class="sxs-lookup"><span data-stu-id="96ba3-497">Load the page in a browser.</span></span> <span data-ttu-id="96ba3-498">已建立靜態連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-498">The static connection is already created.</span></span> <span data-ttu-id="96ba3-499">在提供者控制項中，輸入一些文字，並記下 消費者控制項中，會顯示文字。</span><span class="sxs-lookup"><span data-stu-id="96ba3-499">Enter some text in the provider control, and note that the text is displayed in the consumer control.</span></span> <span data-ttu-id="96ba3-500">按一下 [**連線詳細資料**] 按鈕以顯示的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-500">Click the **Connection Details** button to display the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartManager.StaticConnections" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-501">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-501">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="Provider">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.WebPart Provider { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.WebPart Provider" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Provider As WebPart" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::WebPart ^ Provider { System::Web::UI::WebControls::WebParts::WebPart ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Provider : System.Web.UI.WebControls.WebParts.WebPart" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.Provider" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.WebPart</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-502">取得做為 Web 組件連接之中提供者的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 控制項。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-502">Gets a <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> control that acts as the provider in a Web Parts connection.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-503">
            <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" />，做為資料提供者。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-503">A <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> that acts as the provider of data.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-504">每個 Web 組件連接包含兩個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項-取用者和提供者--和<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A>屬性會傳回在連接中的提供者控制項的參考。</span><span class="sxs-lookup"><span data-stu-id="96ba3-504">Every Web Parts connection consists of two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls--a consumer and a provider--and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A> property returns a reference to the provider control in a connection.</span></span>  
  
 <span data-ttu-id="96ba3-505">連接 （消費者控制項） 中其對應項目，例如提供者控制項，才能建立連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-505">Like its counterpart in a connection (the consumer control), the provider control is required to establish a connection.</span></span> <span data-ttu-id="96ba3-506">不論您是以程式設計的方式，或藉由宣告以頁面保存格式建立連接，您必須指定做為連線提供者的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-506">Whether you create the connection programmatically, or by declaring it in page persistence format, you must specify a control to act as the provider for a connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-507">下列程式碼範例示範使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-507">The following code example demonstrates use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-508">在程式碼範例有三個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-508">The code example has three parts:</span></span>  
  
-   <span data-ttu-id="96ba3-509">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-509">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-510">若要裝載控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-510">A Web page to host the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-511">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-511">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-512">在程式碼範例的第一個部分是在介面中，與消費者和提供者控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-512">The first part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="96ba3-513">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-513">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-514">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-514">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-515">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-515">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-516">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-516">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-517">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-517">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_Provider#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Provider/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_Provider#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Provider/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-518">在程式碼範例的第二個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-518">The second part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-519">頂端附近`Register`指示詞參考兩個動態編譯的原始程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-519">Near the top is a `Register` directive that refers to the source code for the two dynamically compiled <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="96ba3-520">在宣告靜態連接`<StaticConnections>`頁面上的項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-520">The static connection is declared within the `<StaticConnections>` element on the page.</span></span> <span data-ttu-id="96ba3-521">請注意，在`<asp:webpartconnection>`項目，`ProviderID`屬性已指派給它的提供者控制項的 ID。</span><span class="sxs-lookup"><span data-stu-id="96ba3-521">Notice that in the `<asp:webpartconnection>` element, the `ProviderID` attribute has the ID of the provider control assigned to it.</span></span> <span data-ttu-id="96ba3-522">這是識別所需的靜態連接的提供者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-522">This is required to identify the provider for the static connection.</span></span> <span data-ttu-id="96ba3-523">`Button1_Click`方法存取<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A>屬性並將其詳細資料的一些寫入的標籤。</span><span class="sxs-lookup"><span data-stu-id="96ba3-523">The `Button1_Click` method accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A> property and writes some of its details to a label.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_Provider#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Provider/CS/wpConnectProviderCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_Provider#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Provider/VB/wpConnectProviderVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-524">將網頁瀏覽器中的載入。</span><span class="sxs-lookup"><span data-stu-id="96ba3-524">Load the page in a browser.</span></span> <span data-ttu-id="96ba3-525">已建立靜態連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-525">The static connection is already created.</span></span> <span data-ttu-id="96ba3-526">在提供者控制項中，輸入一些文字，並記下 消費者控制項中，會顯示文字。</span><span class="sxs-lookup"><span data-stu-id="96ba3-526">Enter some text in the provider control, and note that the text is displayed in the consumer control.</span></span> <span data-ttu-id="96ba3-527">按一下 **提供者詳細資料**按鈕以顯示透過存取的屬性值的部分<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-527">Click the **Provider Details** button to display some of the property values accessed through the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="96ba3-528">
            <see cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID" /> 屬性值的長度為零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-528">The length of the <see cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID" /> property value is zero.</span>
          </span>
        </exception>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer" />
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-529">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-529">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="ProviderConnectionPoint">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.ProviderConnectionPoint ProviderConnectionPoint { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.ProviderConnectionPoint ProviderConnectionPoint" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ProviderConnectionPoint As ProviderConnectionPoint" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::ProviderConnectionPoint ^ ProviderConnectionPoint { System::Web::UI::WebControls::WebParts::ProviderConnectionPoint ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.ProviderConnectionPoint : System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.ProviderConnectionPoint</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-530">取得做為連接之提供者 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 控制項連接點的物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-530">Gets the object that serves as a connection point for a <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> control acting as a provider for a connection.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-531">與連接之中提供者控制項關聯的 <see cref="T:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-531">A <see cref="T:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" /> associated with the provider control in a connection.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-532">其中一個所需的步驟建立兩個連線<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項是建立每個控制項連接點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-532">One of the required steps for creating a connection between two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls is to create connection points for each control.</span></span> <span data-ttu-id="96ba3-533">提供者連接點是物件，包含如何連接至做為提供者的控制項的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="96ba3-533">The provider connection point is an object that contains the information about how to connect to the control acting as a provider.</span></span> <span data-ttu-id="96ba3-534">在 提供者的原始程式碼，其中一種方法必須用來識別`ConnectionProvider`屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-534">In the provider's source code, one of the methods must be identified with the `ConnectionProvider` attribute.</span></span> <span data-ttu-id="96ba3-535"><xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>也就是相關聯的提供者控制項包含方法和屬性，包括方法，在使用者介面 (UI) 中使用的顯示名稱識別碼的詳細和哪種類型的介面執行個體方法可以傳回給取用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-535">The <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> that is associated with a provider control contains details about the method and the attribute, including an ID for the method, a display name for use in the user interface (UI), and what type of interface instance the method can return to a consumer control.</span></span> <span data-ttu-id="96ba3-536">這組提供者的相關資訊，其方法形成連線，並提供的介面的型別共同構成提供者連接點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-536">This set of information about the provider, its method for forming connections, and the type of interface it provides, collectively forms a provider connection point.</span></span>  
  
 <span data-ttu-id="96ba3-537">根據預設，<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>可以連線到只有一個<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>物件一次。</span><span class="sxs-lookup"><span data-stu-id="96ba3-537">By default, a <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> can connect to only one <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object at a time.</span></span> <span data-ttu-id="96ba3-538">取用者可能會有多個方法視為可能的消費者連接點，但是消費者只能參與一個是取用者以連線 （因此，只有一個取用者連接點可以是現用項目） 一次。</span><span class="sxs-lookup"><span data-stu-id="96ba3-538">A consumer could have multiple methods identified as possible consumer connection points, but a consumer can only participate in one connection as a consumer (hence, only one of its consumer connection points can be active) at a time.</span></span> <span data-ttu-id="96ba3-539">相反地，<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>可以連線到任何數目的<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>預設的物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-539">In contrast, a <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> can connect to any number of <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> objects by default.</span></span> <span data-ttu-id="96ba3-540">比方說，提供郵遞區號的提供者控制項無法連線到多個使用郵遞區號，來建立各種類型的資料是根據郵遞區號，例如天氣資料、 新聞和等等的消費者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-540">For example, a provider control that provides a postal code could be connected to multiple consumer controls that use a postal code to create various kinds of data based on a postal code, such as weather data, news, and so on.</span></span> <span data-ttu-id="96ba3-541">可以藉由覆寫變更此預設行為<xref:System.Web.UI.WebControls.WebParts.ConnectionProviderAttribute.AllowsMultipleConnections%2A>屬性上的<xref:System.Web.UI.WebControls.WebParts.ConnectionProviderAttribute>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-541">This default behavior can be changed by overriding the <xref:System.Web.UI.WebControls.WebParts.ConnectionProviderAttribute.AllowsMultipleConnections%2A> property on the <xref:System.Web.UI.WebControls.WebParts.ConnectionProviderAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-542">下列程式碼範例示範如何以程式設計方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-542">The following code example demonstrates the programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-543">此範例包含四個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-543">The example has four parts:</span></span>  
  
-   <span data-ttu-id="96ba3-544">使用者控制項，可讓您變更 Web 組件 頁面上顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-544">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="96ba3-545">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-545">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-546">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-546">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-547">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-547">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-548">此程式碼範例的第一個部分是可讓使用者變更顯示模式，在網頁上的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-548">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="96ba3-549">將以下的原始碼儲存到.ascx 檔，提供檔案名稱指派給`Src`屬性的`Register`這個使用者控制項指示詞，也就是裝載的 Web 網頁的頂端附近。</span><span class="sxs-lookup"><span data-stu-id="96ba3-549">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="96ba3-550">For 詳細資料會顯示在此控制項模式和原始碼的描述，請參閱[逐步解說： 變更 Web 組件頁面上顯示的模式](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-550">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderConnectionPoint#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderConnectionPoint#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="96ba3-551">在程式碼範例的第二個部分是原始碼的兩個<xref:System.Web.UI.WebControls.WebParts.WebPart>做為取用者，連接和連接點所用的介面的提供者的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-551">The second part of the code example is the source code for the two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls that serve as the consumer and the provider for the connection, and an interface used for the connection points.</span></span> <span data-ttu-id="96ba3-552">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-552">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-553">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-553">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-554">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-554">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-555">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-555">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-556">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-556">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ProviderConnectionPoint#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ProviderConnectionPoint#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-557">在程式碼範例的第三個部分是裝載控制項，並示範如何使用之 Web 網頁的程式碼<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-557">The third part of the code example is the code for the Web page that hosts the controls and demonstrates the use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A> property.</span></span> <span data-ttu-id="96ba3-558">在 `Button1_Click`方法，來建立連接所需的所有物件會都建立，包括<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-558">In the `Button1_Click` method, all the objects required to form a connection are created, including a <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object.</span></span> <span data-ttu-id="96ba3-559">請注意在呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetProviderConnectionPoints%2A>方法<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-559">Note the call to the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetProviderConnectionPoints%2A> method on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control.</span></span> <span data-ttu-id="96ba3-560">各種建立的物件會傳遞至<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法用來建立連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-560">The various created objects are all passed to the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method to create the connection.</span></span> <span data-ttu-id="96ba3-561">在 `Button2_Click`方法，將程式碼會存取<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A>屬性，並顯示某些的連接點的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="96ba3-561">In the `Button2_Click` method, the code accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A> property and displays some details of the connection point.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderConnectionPoint#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderConnectionPoint#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-562">在瀏覽器頁面載入之後，請使用**顯示模式**切換頁面以連線模式下的下拉式清單控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-562">After you load the page in a browser, use the **Display Mode** drop-down list control to switch the page to connect mode.</span></span> <span data-ttu-id="96ba3-563">按一下 動詞命令功能表 （以標題列中的向下箭號表示） 上的其中一個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，並按一下 connect 動詞命令。</span><span class="sxs-lookup"><span data-stu-id="96ba3-563">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="96ba3-564">使用**連接 WebPart 控制項** 按鈕或提供的連接使用者介面，建立兩個控制項之間的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-564">Use the **Connect WebPart Controls** button, or the provided connection UI, to create a connection between the two controls.</span></span> <span data-ttu-id="96ba3-565">按一下  **ConnectionPoint 詳細資料**按鈕，以執行程式碼，示範<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-565">Click the **ConnectionPoint Details** button to run the code that demonstrates the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ConnectionProviderAttribute" />
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" />
        <altmember cref="M:System.Web.UI.WebControls.WebParts.WebPartManager.GetProviderConnectionPoints(System.Web.UI.WebControls.WebParts.WebPart)" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-566">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-566">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="ProviderConnectionPointID">
      <MemberSignature Language="C#" Value="public string ProviderConnectionPointID { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ProviderConnectionPointID" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID" />
      <MemberSignature Language="VB.NET" Value="Public Property ProviderConnectionPointID As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ProviderConnectionPointID { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ProviderConnectionPointID : string with get, set" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("default")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-567">取得或設定連接上的屬性值，這個屬性會參考做為此連接之提供者連接點的物件 ID。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-567">Gets or sets the property value on a connection that references the ID of the object serving as the provider connection point for that connection.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-568">字串，包含提供者連接點物件的 ID。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-568">A string that contains the ID for a provider connection point object.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-569">對於 Web 網頁標記中宣告靜態的連線，開發人員可以指定哪些提供者連接點將用於連線的指派值給`ProviderConnectionPointID`屬性上`<asp:webpartconnection>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-569">For a static connection declared in the markup of a Web page, developers can specify which provider connection point will be used for the connection by assigning a value to the `ProviderConnectionPointID` attribute on the `<asp:webpartconnection>` element.</span></span> <span data-ttu-id="96ba3-570">如果值不會指派給屬性，<xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID>使用屬性值。</span><span class="sxs-lookup"><span data-stu-id="96ba3-570">If a value is not assigned to the attribute, the <xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID> property value is used.</span></span>  
  
 <span data-ttu-id="96ba3-571">當您建立動態的 （以程式設計方式） 連線時，通常您不應將值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-571">When you create dynamic (programmatic) connections, normally you should not set the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property.</span></span> <span data-ttu-id="96ba3-572">您可以只呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制、 將傳遞給它的提供者和提供者連接點物件 （以及其他必要的參數），以及該方法會判斷正確的識別碼，用於提供者的連線點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-572">You can simply call the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control, passing to it the provider and provider connection point objects (along with the other required parameters), and that method determines the correct ID to use for the provider's connection point.</span></span> <span data-ttu-id="96ba3-573">同樣地，當您中斷連線，您可以呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartManager.DisconnectWebParts%2A>方法，而不需要指定<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>屬性值。</span><span class="sxs-lookup"><span data-stu-id="96ba3-573">Similarly, when you disconnect, you can call the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.DisconnectWebParts%2A> method without needing to specify the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property value.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="96ba3-574">您可以判斷提供者連接點的識別碼，當您指定<xref:System.Web.UI.WebControls.WebParts.WebPart>或其他伺服器控制項，做為提供者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-574">The ID of a provider's connection point can be determined when you designate a <xref:System.Web.UI.WebControls.WebParts.WebPart> or other server control as a provider.</span></span> <span data-ttu-id="96ba3-575">您必須識別提供者，可包含資料的取用者介面的執行個體中的回呼方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-575">You must identify a callback method in the provider that serves an instance of an interface containing data to a consumer.</span></span> <span data-ttu-id="96ba3-576">若要識別的方法，將它與標示`ConnectionProvider`code 屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-576">To identify the method, mark it with the `ConnectionProvider` code attribute.</span></span> <span data-ttu-id="96ba3-577">當您新增這個屬性時，您可以新增選擇性的字串值參數可提供的 識別碼提供者的<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-577">When you add this attribute, you can add an optional string value parameter that serves as an ID for the provider's <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object.</span></span> <span data-ttu-id="96ba3-578">如果您提供選擇性的 ID 參數的值，該值會變成值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>連接的屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-578">If you supply a value for the optional ID parameter, that value becomes the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property for the connection.</span></span> <span data-ttu-id="96ba3-579">如果您未提供識別碼值<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制在建立物件時，會將指派預設識別碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-579">If you do not supply an ID value, the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control assigns a default ID when the object is created.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-580">下列程式碼範例示範宣告式和以程式設計方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-580">The following code example shows the declarative and programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-581">此範例包含四個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-581">The example has four parts:</span></span>  
  
-   <span data-ttu-id="96ba3-582">使用者控制項，可讓您變更 Web 組件 頁面上顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-582">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="96ba3-583">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-583">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-584">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-584">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-585">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-585">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-586">此程式碼範例的第一個部分是可讓使用者變更顯示模式，在網頁上的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-586">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="96ba3-587">將以下的原始碼儲存到.ascx 檔，提供檔案名稱指派給`Src`屬性的`Register`這個使用者控制項指示詞，也就是裝載的 Web 網頁的頂端附近。</span><span class="sxs-lookup"><span data-stu-id="96ba3-587">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="96ba3-588">For 詳細資料會顯示在此控制項模式和原始碼的描述，請參閱[逐步解說： 變更 Web 組件頁面上顯示的模式](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-588">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderConnectionPointID#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderConnectionPointID#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="96ba3-589">在程式碼範例的第二個部分是介面與消費者和提供者控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-589">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="96ba3-590">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-590">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-591">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-591">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-592">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-592">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-593">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-593">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-594">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-594">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ProviderConnectionPointID#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ProviderConnectionPointID#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-595">在程式碼範例的第三個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-595">The third part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-596">請注意，連接宣告在頁面標記中，使用`<StaticConnections>`和`<asp:WebPartsConnection>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-596">Note that a connection is declared in the page markup, using the `<StaticConnections>` and `<asp:WebPartsConnection>` elements.</span></span> <span data-ttu-id="96ba3-597">連線宣告包含所需`ProviderConnectionPointID`屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-597">The connection declaration includes the required `ProviderConnectionPointID` attribute.</span></span> <span data-ttu-id="96ba3-598">建立連接的第二個方法會出現在`Button1_Click`方法，在其中的程式碼會建立新的連接，透過的連接點 （和識別碼） 提供者控制項中定義。</span><span class="sxs-lookup"><span data-stu-id="96ba3-598">A second method for creating the connection appears in the `Button1_Click` method, where the code creates a new connection, using the connection point (and the ID) defined in the provider control.</span></span> <span data-ttu-id="96ba3-599">然後，在`Button2_Click`方法，將程式碼會存取<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-599">Then, in the `Button2_Click` method, the code accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderConnectionPointID#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderConnectionPointID#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-600">在瀏覽器頁面載入之後，連線已存在靜態網頁中宣告的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-600">After you load the page in a browser, a connection already exists because of the static connection declared in the page.</span></span> <span data-ttu-id="96ba3-601">在提供者控制項中，輸入一些文字，並請注意，它會顯示因為連線取用者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-601">Enter some text in the provider control, and note that it is displayed in the consumer due to the connection.</span></span> <span data-ttu-id="96ba3-602">接下來，中斷連接的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-602">Next, disconnect the controls.</span></span> <span data-ttu-id="96ba3-603">使用**顯示模式**下拉式清單控制項中，切換頁面，即可連接模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-603">Using the **Display Mode** drop-down list control, switch the page to connect mode.</span></span> <span data-ttu-id="96ba3-604">按一下 動詞命令功能表 （以標題列中的向下箭號表示） 上的其中一個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，並按一下 connect 動詞命令。</span><span class="sxs-lookup"><span data-stu-id="96ba3-604">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="96ba3-605">按一下 [**中斷連線**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="96ba3-605">Click the **Disconnect** button.</span></span> <span data-ttu-id="96ba3-606">使用**連接 WebPart 控制項**按鈕以重新建立兩個控制項之間的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-606">Use the **Connect WebPart Controls** button to recreate a connection between the two controls.</span></span> <span data-ttu-id="96ba3-607">按一下  **ConnectionPoint 詳細資料**按鈕，以執行存取的程式碼<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>屬性值。</span><span class="sxs-lookup"><span data-stu-id="96ba3-607">Click the **ConnectionPoint Details** button to run the code that accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property value.</span></span> <span data-ttu-id="96ba3-608">在 [標籤] 控制項下方，值會寫出。</span><span class="sxs-lookup"><span data-stu-id="96ba3-608">The value is written out in a label below the controls.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" />
        <altmember cref="P:System.Web.UI.WebControls.WebParts.ConnectionPoint.ID" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-609">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-609">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="ProviderID">
      <MemberSignature Language="C#" Value="public string ProviderID { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ProviderID" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID" />
      <MemberSignature Language="VB.NET" Value="Public Property ProviderID As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ProviderID { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ProviderID : string with get, set" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-610">取得或設定連接上的屬性值，這個屬性會參考做為此連接之提供者 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 控制項的 ID。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-610">Gets or sets the property value on a connection that references the ID of the <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> control acting as a provider for that connection.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-611">包含提供者控制項 ID 的字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-611">A string that contains the ID of the provider control.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-612"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A>屬性值時，必須建立兩個連接<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-612">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A> property value is required when you create a connection between two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="96ba3-613">如果值不指派給屬性，會擲回例外狀況時<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控制項嘗試在啟動連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-613">If a value is not assigned to the property, an exception is thrown when the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control attempts to activate the connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-614">下列程式碼範例示範宣告式和以程式設計方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-614">The following code example shows the declarative and programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-615">此範例包含四個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-615">The example has four parts:</span></span>  
  
-   <span data-ttu-id="96ba3-616">使用者控制項，可讓您變更 Web 組件 頁面上顯示模式。</span><span class="sxs-lookup"><span data-stu-id="96ba3-616">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="96ba3-617">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-617">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-618">裝載的所有控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-618">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-619">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-619">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-620">此程式碼範例的第一個部分是可讓使用者變更顯示模式，在網頁上的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-620">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="96ba3-621">將以下的原始碼儲存到.ascx 檔，提供檔案名稱指派給`Src`屬性的`Register`這個使用者控制項指示詞，也就是裝載的 Web 網頁的頂端附近。</span><span class="sxs-lookup"><span data-stu-id="96ba3-621">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="96ba3-622">For 詳細資料會顯示在此控制項模式和原始碼的描述，請參閱[逐步解說： 變更 Web 組件頁面上顯示的模式](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-622">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](http://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderID#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderID#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="96ba3-623">在程式碼範例的第二個部分是介面與消費者和提供者控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-623">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="96ba3-624">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-624">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-625">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-625">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-626">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-626">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-627">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-627">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-628">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-628">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ProviderID#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ProviderID#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-629">在程式碼範例的第三個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-629">The third part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-630">請注意，連接宣告在頁面標記中，使用`<StaticConnections>`和`<asp:WebPartsConnection>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-630">Note that a connection is declared in the page markup, using the `<StaticConnections>` and `<asp:WebPartsConnection>` elements.</span></span> <span data-ttu-id="96ba3-631">連線宣告包含所需`ProviderID`屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-631">The connection declaration includes the required `ProviderID` attribute.</span></span> <span data-ttu-id="96ba3-632">建立連接的第二個方法會出現在`Button1_Click`方法，其中的程式碼會建立新的連接，並使用消費者控制項中所定義的連接點。</span><span class="sxs-lookup"><span data-stu-id="96ba3-632">A second method for creating the connection appears in the `Button1_Click` method, where the code creates a new connection, using the connection point defined in the consumer control.</span></span> <span data-ttu-id="96ba3-633">然後，在`Button2_Click`方法，將程式碼會存取的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A>屬性並將它顯示在標籤中。</span><span class="sxs-lookup"><span data-stu-id="96ba3-633">Then, in the `Button2_Click` method, the code accesses the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A> property and displays it in a label.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderID#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderID#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-634">在瀏覽器頁面載入之後，連線已存在靜態網頁中宣告的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-634">After you load the page in a browser, a connection already exists because of the static connection declared in the page.</span></span> <span data-ttu-id="96ba3-635">在提供者控制項中，輸入一些文字，並請注意，它會顯示因為連線取用者。</span><span class="sxs-lookup"><span data-stu-id="96ba3-635">Enter some text in the provider control, and note that it is displayed in the consumer due to the connection.</span></span> <span data-ttu-id="96ba3-636">接下來，中斷連接的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-636">Next, disconnect the controls.</span></span> <span data-ttu-id="96ba3-637">若要這樣做，請使用**顯示模式**切換頁面以連線模式下的下拉式清單控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-637">To do that, use the **Display Mode** drop-down list control to switch the page to connect mode.</span></span> <span data-ttu-id="96ba3-638">按一下 動詞命令功能表 （以標題列中的向下箭號表示） 上的其中一個<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項，並按一下 connect 動詞命令。</span><span class="sxs-lookup"><span data-stu-id="96ba3-638">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="96ba3-639">按一下 **中斷連線**按鈕和控制項都已中斷連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-639">Click the **Disconnect** button, and the controls are disconnected.</span></span> <span data-ttu-id="96ba3-640">接下來，使用**連接 WebPart 控制項**按鈕以重新建立兩個控制項之間的連線。</span><span class="sxs-lookup"><span data-stu-id="96ba3-640">Next, use the **Connect WebPart Controls** button to recreate a connection between the two controls.</span></span> <span data-ttu-id="96ba3-641">按一下 **取用者詳細資料**按鈕，以執行存取的程式碼<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A>屬性值。</span><span class="sxs-lookup"><span data-stu-id="96ba3-641">Click the **Consumer Details** button to run the code that accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A> property value.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-642">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-642">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="ToString">
      <MemberSignature Language="C#" Value="public override string ToString ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string ToString() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ToString () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ ToString();" />
      <MemberSignature Language="F#" Value="override this.ToString : unit -&gt; string" Usage="webPartConnection.ToString " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-643">覆寫繼承的 <see cref="M:System.Object.ToString" /> 方法，並傳回連接物件的簡短型別名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-643">Overrides the inherited <see cref="M:System.Object.ToString" /> method and returns a short type name for the connection object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="96ba3-644">字串，包含 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 的簡短 (不完整) 型別名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-644">A string that contains the short (unqualified) type name of a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-645">這個方法會使用控制項設計工具主要是為了方便起見。</span><span class="sxs-lookup"><span data-stu-id="96ba3-645">This method is used mostly for convenience by control designers.</span></span> <span data-ttu-id="96ba3-646">它可以改善連線物件如何出現在 [設計] 檢視中使用較短的型別名稱，而不是完整限定的類型名稱。</span><span class="sxs-lookup"><span data-stu-id="96ba3-646">It improves how connection objects appear in Design view by using the shorter type name, as opposed to a fully qualified type name.</span></span> <span data-ttu-id="96ba3-647">不過，可以呼叫方法在任何時間點在程式碼中您要知道的連接物件的型別名稱。</span><span class="sxs-lookup"><span data-stu-id="96ba3-647">However, the method can be called at any point in your code where you want to know the type name of a connection object.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="96ba3-648">下列程式碼範例示範如何呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A>方法傳回的簡短的型別名稱<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-648">The following code example demonstrates how to call the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A> method to return the short type name of a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object.</span></span>  
  
 <span data-ttu-id="96ba3-649">在程式碼範例有三個部分：</span><span class="sxs-lookup"><span data-stu-id="96ba3-649">The code example has three parts:</span></span>  
  
-   <span data-ttu-id="96ba3-650">來源介面和兩個程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項做為提供者和取用者連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-650">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="96ba3-651">若要裝載控制項，並執行程式碼範例的網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-651">A Web page to host the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="96ba3-652">如何執行範例頁面的說明。</span><span class="sxs-lookup"><span data-stu-id="96ba3-652">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="96ba3-653">在程式碼範例的第一個部分是在介面中，與消費者和提供者控制項的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-653">The first part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="96ba3-654">若要執行程式碼範例，您必須編譯這個原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="96ba3-654">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="96ba3-655">您可以明確編譯它，然後將產生的組件放在您的網站的 Bin 資料夾或全域組件快取。</span><span class="sxs-lookup"><span data-stu-id="96ba3-655">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="96ba3-656">或者，您可以將原始程式碼放在您網站的 App_Code 資料夾中，這樣就會在執行階段進行動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-656">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="96ba3-657">此程式碼範例會使用動態編譯。</span><span class="sxs-lookup"><span data-stu-id="96ba3-657">This code example uses dynamic compilation.</span></span> <span data-ttu-id="96ba3-658">如需示範如何編譯的逐步解說，請參閱 <<c0> [ 逐步解說： 開發和使用自訂 Web 伺服器控制項](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="96ba3-658">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](http://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ToString#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ToString/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ToString#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ToString/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="96ba3-659">在程式碼範例的第二個部分是網頁。</span><span class="sxs-lookup"><span data-stu-id="96ba3-659">The second part of the code example is the Web page.</span></span> <span data-ttu-id="96ba3-660">頂端附近`Register`指示詞參考兩個動態編譯的原始程式碼<xref:System.Web.UI.WebControls.WebParts.WebPart>控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-660">Near the top is a `Register` directive that refers to the source code for the two dynamically compiled <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="96ba3-661">在宣告靜態連接`<StaticConnections>`頁面上的項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-661">The static connection is declared within the `<StaticConnections>` element on the page.</span></span> <span data-ttu-id="96ba3-662">`Button1_Click`方法呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A>方法，將連接的型別名稱寫入的標籤。</span><span class="sxs-lookup"><span data-stu-id="96ba3-662">The `Button1_Click` method calls the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A> method to write the type name of the connection to a label.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ToString#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ToString/CS/wpConnectToStringCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ToString#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ToString/VB/wpConnectToStringVB.aspx#1)]  
  
 <span data-ttu-id="96ba3-663">將網頁瀏覽器中的載入。</span><span class="sxs-lookup"><span data-stu-id="96ba3-663">Load the page in a browser.</span></span> <span data-ttu-id="96ba3-664">已建立靜態連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-664">The static connection is already created.</span></span> <span data-ttu-id="96ba3-665">在提供者控制項中，輸入一些文字，並記下 消費者控制項中，會顯示文字。</span><span class="sxs-lookup"><span data-stu-id="96ba3-665">Enter some text in the provider control, and note that the text is displayed in the consumer control.</span></span> <span data-ttu-id="96ba3-666">按一下 **連線詳細資料**按鈕以執行<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="96ba3-666">Click the **Connection Details** button to execute the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Object.ToString" />
      </Docs>
    </Member>
    <Member MemberName="Transformer">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.WebPartTransformer Transformer { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.WebPartTransformer Transformer" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Transformer As WebPartTransformer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::WebPartTransformer ^ Transformer { System::Web::UI::WebControls::WebParts::WebPartTransformer ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Transformer : System.Web.UI.WebControls.WebParts.WebPartTransformer" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.WebPartTransformer</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-667">取得 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" /> 物件，這個物件是用來轉換 Web 組件連接之中兩個不相容連接點的資料。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-667">Gets a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" /> object that is used to transform data between two otherwise incompatible connection points in a Web Parts connection.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-668">
            <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-668">A <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" />.</span>
          </span>
          <span data-ttu-id="96ba3-669">預設值是 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-669">The default value is <see langword="null" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-670">在 Web 組件連接中，有兩種方式中的連線提供者和消費者控制項可以連接。</span><span class="sxs-lookup"><span data-stu-id="96ba3-670">In a Web Parts connection, there are two ways in which the provider and consumer controls in the connection can connect.</span></span> <span data-ttu-id="96ba3-671">直接連接到其各自<xref:System.Web.UI.WebControls.WebParts.ConnectionPoint>物件和了解這兩個控制項的介面類型。</span><span class="sxs-lookup"><span data-stu-id="96ba3-671">They can connect directly, through their respective <xref:System.Web.UI.WebControls.WebParts.ConnectionPoint> objects and an interface type that is understood by both controls.</span></span> <span data-ttu-id="96ba3-672">或者，如果它們不相容時，他們可以連線，間接使用<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>從提供者的介面執行個體轉換為取用者所了解類型的物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-672">Or, if they are incompatible, they can connect indirectly, using a <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object that transforms an interface instance from a provider into a type understood by a consumer.</span></span>  
  
 <span data-ttu-id="96ba3-673">轉換程式需要連接的一部分時<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer%2A>屬性提供參考<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>物件。</span><span class="sxs-lookup"><span data-stu-id="96ba3-673">When a transformer is needed as part of a connection, the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer%2A> property provides a reference to the <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object.</span></span> <span data-ttu-id="96ba3-674">您可以藉由新增自訂轉換器 （或其中一個 Web 組件控制集所提供的轉換） 的標記加入轉換程式的網頁，以宣告方式在標記中連接內`<asp:WebPartConnection>`項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-674">You can add a transformer for a connection declaratively in the markup of a Web page, by adding a tag for a custom transformer (or one of the transformers provided with the Web Parts control set) within the `<asp:WebPartConnection>` element.</span></span> <span data-ttu-id="96ba3-675">您也可以加入轉換程式以程式設計的方式，在您的程式碼中建立它的執行個體，然後呼叫<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%28System.Web.UI.WebControls.WebParts.WebPart%2CSystem.Web.UI.WebControls.WebParts.ProviderConnectionPoint%2CSystem.Web.UI.WebControls.WebParts.WebPart%2CSystem.Web.UI.WebControls.WebParts.ConsumerConnectionPoint%2CSystem.Web.UI.WebControls.WebParts.WebPartTransformer%29>方法<xref:System.Web.UI.WebControls.WebParts.WebPartManager>來建立連線，將轉換程式物件，以及其他必要的參數傳遞給它的控制項。</span><span class="sxs-lookup"><span data-stu-id="96ba3-675">You can also add a transformer programmatically, creating an instance of it in your code, and calling the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%28System.Web.UI.WebControls.WebParts.WebPart%2CSystem.Web.UI.WebControls.WebParts.ProviderConnectionPoint%2CSystem.Web.UI.WebControls.WebParts.WebPart%2CSystem.Web.UI.WebControls.WebParts.ConsumerConnectionPoint%2CSystem.Web.UI.WebControls.WebParts.WebPartTransformer%29> method on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control to create the connection, passing to it the transformer object along with the other required parameters.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-676">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-676">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
    <Member MemberName="Transformers">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.WebPartTransformerCollection Transformers { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.WebPartTransformerCollection Transformers" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Transformers As WebPartTransformerCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::WebPartTransformerCollection ^ Transformers { System::Web::UI::WebControls::WebParts::WebPartTransformerCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Transformers : System.Web.UI.WebControls.WebParts.WebPartTransformerCollection" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.EditorBrowsable</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Web.UI.PersistenceMode(System.Web.UI.PersistenceMode.InnerDefaultProperty)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.EditorBrowsable(System.ComponentModel.EditorBrowsableState.Never)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.WebPartTransformerCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="96ba3-677">取得 Web 組件控制集內部使用的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" /> 物件集合。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-677">Gets a collection of <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" /> objects used internally by the Web Parts control set.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="96ba3-678">包含 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformerCollection" /> 物件的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-678">A <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformerCollection" /> containing <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" /> objects.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="96ba3-679"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers%2A>屬性永遠不會是用於開發人員。</span><span class="sxs-lookup"><span data-stu-id="96ba3-679">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers%2A> property is never intended for use by developers.</span></span> <span data-ttu-id="96ba3-680">若要存取與連接相關聯的轉換程式，開發人員應該一律使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="96ba3-680">To access the transformer associated with a connection, developers should always use the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer%2A> property.</span></span>  
  
 <span data-ttu-id="96ba3-681"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers%2A>屬性供內部設定為讓網頁開發人員，來宣告轉換程式項目內的 Web 組件控制項`<asp:webpartconnection>`Web 網頁標記中的項目。</span><span class="sxs-lookup"><span data-stu-id="96ba3-681">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers%2A> property is used internally by the Web Parts control set to enable page developers to declare transformer elements within the `<asp:webpartconnection>` element in the markup of a Web page.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformerCollection" />
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer" />
        <related type="Article" href="http://msdn.microsoft.com/library/ab78a66e-9feb-4391-b3c3-8c07555e2308">
          <span data-ttu-id="96ba3-682">ASP.NET Web 組件頁面</span>
          <span class="sxs-lookup">
            <span data-stu-id="96ba3-682">ASP.NET Web Parts Pages</span>
          </span>
        </related>
      </Docs>
    </Member>
  </Members>
</Type>