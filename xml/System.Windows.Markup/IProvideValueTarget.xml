<Type Name="IProvideValueTarget" FullName="System.Windows.Markup.IProvideValueTarget">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="fe449848bcdce05ca59b27ae4a3b23e50137f9b6" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
    <Meta Name="ms.locfileid" Value="30657972" />
  </Metadata>
  <TypeSignature Language="C#" Value="public interface IProvideValueTarget" />
  <TypeSignature Language="ILAsm" Value=".class public interface auto ansi abstract IProvideValueTarget" />
  <TypeSignature Language="DocId" Value="T:System.Windows.Markup.IProvideValueTarget" />
  <TypeSignature Language="VB.NET" Value="Public Interface IProvideValueTarget" />
  <TypeSignature Language="C++ CLI" Value="public interface class IProvideValueTarget" />
  <AssemblyInfo>
    <AssemblyName>System.Xaml</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.Runtime.CompilerServices.TypeForwardedFrom("PresentationFramework, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>表示會報告標記延伸評估的環境物件屬性關聯性的服務。</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Windows.Markup.IProvideValueTarget> 表示會報告有關物件屬性結構，周圍會在叫用的值轉換器的服務。  
  
 類型轉換器和標記延伸可以查詢<xref:System.Windows.Markup.IProvideValueTarget>XAML 物件寫入器叫用的值轉換行為時，會將 XAML 物件寫入器所提供的服務內容上以服務。 如需詳細資訊，請參閱[類型轉換器和 XAML 的標記延伸](~/docs/framework/xaml-services/type-converters-and-markup-extensions-for-xaml.md)和[適用於類型轉換器和標記延伸](~/docs/framework/xaml-services/service-contexts-available-to-type-converters-and-markup-extensions.md)。  
  
 標記延伸的具體而言，案例其中<xref:System.Windows.Markup.IProvideValueTarget>適合用來判斷標記延伸的情境使用方式的有效性是。 例如，標記延伸可以實作值延遲機制，但該機制可能只適合使用是否能夠使用延遲機制的其他元件在執行階段的目標物件。 您可以檢查做為傳回之物件的型別系統特性<xref:System.Windows.Markup.IProvideValueTarget.TargetObject%2A>，並確定該物件支援延遲技術。 如果是這樣，標記延伸傳回值，且如果不是，標記延伸擲回例外狀況，將會收取當做內部例外狀況的 XAML 物件寫入器。 類似的狀況特定的屬性，藉由檢查型別系統特性的支援功能，以確保<xref:System.Windows.Markup.IProvideValueTarget.TargetProperty%2A>。  
  
 雖然 API 名稱<xref:System.Windows.Markup.IProvideValueTarget>可能暗示關聯<xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A?displayProperty=nameWithType>，回報資訊<xref:System.Windows.Markup.IProvideValueTarget>也很有用<xref:System.ComponentModel.TypeConverter>或<xref:System.Windows.Markup.ValueSerializer>。 A<xref:System.ComponentModel.TypeConverter>或<xref:System.Windows.Markup.ValueSerializer>專為特定目標型別或目標屬性，因為通常有多個內容的標記延伸，因此那樣的有效型別系統中，通常可預測。 不過，存在其他案例。 以下是可能會由型別轉換子或標記延伸實作某些案例的清單：  
  
-   取得<xref:System.Windows.Markup.IProvideValueTarget.TargetObject%2A>讀取該物件上的其他屬性的執行個體值。 請注意，您的處理可能需要將要很穩固未設定值，因為 XAML 成員的目標物件上的處理順序不具決定性。  
  
-   取得<xref:System.Windows.Markup.IProvideValueTarget.TargetObject%2A>讀取類型層級中繼資料，或是確認所需的介面由型別。  
  
-   取得<xref:System.Windows.Markup.IProvideValueTarget.TargetProperty%2A>讀取屬性中繼資料。  
  
 其中一個案例是使用<xref:System.Windows.Markup.IProvideValueTarget>限制允許哪些物件或屬性來標記延伸設定的資訊。  
  
 使用服務，請先確定服務本身不是`null`傳回相關的服務提供者參數時您使用的內容。  
  
> [!IMPORTANT]
>  使用服務時，它是特別重要，不能修改所參考的物件<xref:System.Windows.Markup.IProvideValueTarget.TargetObject%2A>屬性或該物件所參考的其他物件。 Wpf 具體來說，這些變更可能會導致非預期的變更會破壞 WPF 屬性系統。  
  
> [!NOTE]
>  不使用的型別<xref:System.Windows.Markup.IProvideValueTarget.TargetProperty%2A>應該傳回以判斷精確哪種類型的標記延伸或類型轉換器。 這不是最佳作法。 傳回型別應該與設定其屬性一致 (<xref:System.Windows.Markup.MarkupExtensionReturnTypeAttribute>標記延伸) 或模式 （型別轉換子的類別名稱）。  
  
 在舊版的.NET Framework 中，這個介面會存在於 WindowsBase WPF 專屬組件中。 在[!INCLUDE[net_v40_long](~/includes/net-v40-long-md.md)]，<xref:System.Windows.Markup.IProvideValueTarget>位於 System.Xaml 組件中。 如需詳細資訊，請參閱[從 WPF 移轉至 System.Xaml 的類型](~/docs/framework/xaml-services/types-migrated-from-wpf-to-system-xaml.md)。  
  
## <a name="wpf-usage-notes"></a>WPF 使用注意事項  
 此服務支援 framework 功能，例如繫結相依性屬性。  
  
 在 WPF 中，服務由<xref:System.Windows.Markup.IProvideValueTarget>可以傳回物件和屬性的情況下，要從標記延伸或類型轉換器所傳回的值取決於內容。  
  
 <xref:System.Windows.Markup.IProvideValueTarget> 在內部實作中的大量可用<xref:System.Windows.Data.BindingBase>，實作相依性屬性的繫結機制，在 WPF 中的類別。  
  
 WPF 實作的預設內部服務提供者<xref:System.Windows.Markup.IProvideValueTarget>由自訂標記延伸或類型轉換器的使用方式。 物件和屬性所報告<xref:System.Windows.Markup.IProvideValueTarget>只能由內部 WPF 服務設定。 除了這個定義的方式之外<xref:System.Windows.Markup.IProvideValueTarget>運作需要定義至少在實作您自己服務提供者的標記延伸和類型轉換器的使用方式<xref:System.Windows.Markup.IProvideValueTarget>和<xref:System.Windows.Markup.IXamlTypeResolver>服務和也就是進階此處未描述的案例。  
  
 Null 值<xref:System.Windows.Markup.IProvideValueTarget.TargetProperty%2A>或<xref:System.Windows.Markup.IProvideValueTarget.TargetObject%2A>不一定表示，並不是標記延伸或類型轉換器，雖然會視您的實作。 範例情況中的值<xref:System.Windows.Markup.IProvideValueTarget>null 即使該服務是如果標記延伸會巢狀另一個標記延伸，例如<xref:System.Windows.Data.Binding>。 實作依賴<xref:System.Windows.Markup.IProvideValueTarget>，請務必檢查針對 null 值，如果只擲回特定例外狀況，如果是您預定的設計。  
  
 ]]></format>
    </remarks>
    <altmember cref="M:System.Windows.Markup.MarkupExtension.ProvideValue(System.IServiceProvider)" />
    <altmember cref="T:System.Windows.Markup.MarkupExtension" />
    <altmember cref="T:System.IServiceProvider" />
  </Docs>
  <Members>
    <Member MemberName="TargetObject">
      <MemberSignature Language="C#" Value="public object TargetObject { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance object TargetObject" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Markup.IProvideValueTarget.TargetObject" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property TargetObject As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Object ^ TargetObject { System::Object ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Xaml</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>取得正在報告的目標物件。</summary>
        <value>正在報告的目標物件。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 所傳回的值<xref:System.Windows.Markup.IProvideValueTarget.TargetObject%2A>是實際的參考、 不是型別系統識別項或其他識別碼。 這個值也可以是`null`; 請參閱<xref:System.Windows.Markup.IProvideValueTarget>。  
  
> [!IMPORTANT]
>  使用服務時，它是特別重要，不能修改所參考的物件<xref:System.Windows.Markup.IProvideValueTarget.TargetObject%2A>屬性或不明確的值轉換屬性情況下，您為該物件參考其他物件所處理。 Wpf 具體來說，變更目標物件可能會導致非預期的變更會破壞 WPF 屬性系統。  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Markup.MarkupExtension.ProvideValue(System.IServiceProvider)" />
      </Docs>
    </Member>
    <Member MemberName="TargetProperty">
      <MemberSignature Language="C#" Value="public object TargetProperty { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance object TargetProperty" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Markup.IProvideValueTarget.TargetProperty" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property TargetProperty As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Object ^ TargetProperty { System::Object ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Xaml</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>取得所要報告之目標屬性的識別項。</summary>
        <value>所要報告之目標屬性的識別項。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個值也可以是`null`; 請參閱<xref:System.Windows.Markup.IProvideValueTarget>。  
  
## <a name="wpf-usage-notes"></a>WPF 使用注意事項  
 相依性屬性的預設 WPF 服務可能會傳回<xref:System.Windows.DependencyProperty>，例如標記延伸或類型轉換器可以使用中繼資料。 否則，傳回的物件可以是<xref:System.Reflection.PropertyInfo>CLR 屬性。  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Markup.MarkupExtension.ProvideValue(System.IServiceProvider)" />
      </Docs>
    </Member>
  </Members>
</Type>