<Namespace Name="System.Xml">
  <Metadata><Meta Name="ms.openlocfilehash" Value="be8c1cc1f4e4adca284d060272a91de64feb8fad" /><Meta Name="ms.sourcegitcommit" Value="adc8598fd19d91438cacaa8fa7ce613e28c8218e" /><Meta Name="ms.translationtype" Value="HT" /><Meta Name="ms.contentlocale" Value="zh-TW" /><Meta Name="ms.lasthandoff" Value="12/11/2018" /><Meta Name="ms.locfileid" Value="53225745" /></Metadata><Docs>
    <summary><span data-ttu-id="1da5c-101"><see cref="N:System.Xml" /> 命名空間提供處理 XML 的標準架構支援。</span><span class="sxs-lookup"><span data-stu-id="1da5c-101">The <see cref="N:System.Xml" /> namespace provides standards-based support for processing XML.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
<a name="std"></a>   
## <a name="supported-standards"></a><span data-ttu-id="1da5c-102">支援的標準</span><span class="sxs-lookup"><span data-stu-id="1da5c-102">Supported standards</span></span>  
 <span data-ttu-id="1da5c-103"><xref:System.Xml>命名空間支援這些標準：</span><span class="sxs-lookup"><span data-stu-id="1da5c-103">The <xref:System.Xml> namespace supports these standards:</span></span>  
  
-   <span data-ttu-id="1da5c-104">XML 1.0，其中包括 DTD 支援： [http://www.w3.org/TR/2006/REC-xml-20060816/](http://www.w3.org/TR/2006/REC-xml-20060816/)</span><span class="sxs-lookup"><span data-stu-id="1da5c-104">XML 1.0, including DTD support: [http://www.w3.org/TR/2006/REC-xml-20060816/](http://www.w3.org/TR/2006/REC-xml-20060816/)</span></span>  
  
-   <span data-ttu-id="1da5c-105">XML 命名空間，同時資料流層級和 DOM: [http://www.w3.org/TR/REC-xml-names/](http://www.w3.org/TR/REC-xml-names/)</span><span class="sxs-lookup"><span data-stu-id="1da5c-105">XML namespaces, both stream-level and DOM: [http://www.w3.org/TR/REC-xml-names/](http://www.w3.org/TR/REC-xml-names/)</span></span>  
  
-   <span data-ttu-id="1da5c-106">XML 結構描述： [http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)</span><span class="sxs-lookup"><span data-stu-id="1da5c-106">XML schemas: [http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)</span></span>  
  
-   <span data-ttu-id="1da5c-107">XPath 運算式： [http://www.w3.org/TR/xpath](http://www.w3.org/TR/xpath)</span><span class="sxs-lookup"><span data-stu-id="1da5c-107">XPath expressions: [http://www.w3.org/TR/xpath](http://www.w3.org/TR/xpath)</span></span>  
  
-   <span data-ttu-id="1da5c-108">XSLT 轉換： [http://www.w3.org/TR/xslt](http://www.w3.org/TR/xslt)</span><span class="sxs-lookup"><span data-stu-id="1da5c-108">XSLT transformations: [http://www.w3.org/TR/xslt](http://www.w3.org/TR/xslt)</span></span>  
  
-   <span data-ttu-id="1da5c-109">DOM 層級 1 核心： [http://www.w3.org/TR/REC-DOM-Level-1/](http://www.w3.org/TR/REC-DOM-Level-1/)</span><span class="sxs-lookup"><span data-stu-id="1da5c-109">DOM Level 1 Core: [http://www.w3.org/TR/REC-DOM-Level-1/](http://www.w3.org/TR/REC-DOM-Level-1/)</span></span>  
  
-   <span data-ttu-id="1da5c-110">DOM 層級 2 核心： [http://www.w3.org/TR/DOM-Level-2/](http://www.w3.org/TR/DOM-Level-2/)</span><span class="sxs-lookup"><span data-stu-id="1da5c-110">DOM Level 2 Core: [http://www.w3.org/TR/DOM-Level-2/](http://www.w3.org/TR/DOM-Level-2/)</span></span>  
  
 <span data-ttu-id="1da5c-111">請參閱章節[與 W3C 規格之間的差異](#diff)所在的 XML 類別與不同的 W3C 建議的兩個案例。</span><span class="sxs-lookup"><span data-stu-id="1da5c-111">See the section [Differences from the W3C specs](#diff) for two cases in which the XML classes differ from the W3C recommendations.</span></span>  
  
<a name="related"></a>   
## <a name="related-namespaces"></a><span data-ttu-id="1da5c-112">相關的命名空間</span><span class="sxs-lookup"><span data-stu-id="1da5c-112">Related namespaces</span></span>  
 <span data-ttu-id="1da5c-113">.NET Framework 也提供其他命名空間與 XML 相關的作業。</span><span class="sxs-lookup"><span data-stu-id="1da5c-113">The .NET Framework also provides other namespaces for XML-related operations.</span></span> <span data-ttu-id="1da5c-114">如需清單、 描述和連結，請參閱[System.Xml 命名空間](https://msdn.microsoft.com/library/gg145036.aspx)網頁。</span><span class="sxs-lookup"><span data-stu-id="1da5c-114">For a list, descriptions, and links, see the [System.Xml Namespaces](https://msdn.microsoft.com/library/gg145036.aspx) webpage.</span></span>  
  
<a name="async"></a>   
## <a name="processing-xml-asynchronously"></a><span data-ttu-id="1da5c-115">以非同步方式處理 XML</span><span class="sxs-lookup"><span data-stu-id="1da5c-115">Processing XML asynchronously</span></span>  
 <span data-ttu-id="1da5c-116"><xref:System.Xml.XmlReader?displayProperty=nameWithType>和<xref:System.Xml.XmlWriter?displayProperty=nameWithType>類別包括數目為基礎的非同步方法。</span><span class="sxs-lookup"><span data-stu-id="1da5c-116">The <xref:System.Xml.XmlReader?displayProperty=nameWithType> and <xref:System.Xml.XmlWriter?displayProperty=nameWithType> classes include a number of asynchronous methods that are based on the .</span></span> <span data-ttu-id="1da5c-117">這些方法可以識別由字串"Async"結尾的名稱。</span><span class="sxs-lookup"><span data-stu-id="1da5c-117">These methods can be identified by the string "Async" at the end of their names.</span></span> <span data-ttu-id="1da5c-118">使用這些方法，您可以撰寫非同步程式碼類似於同步的程式碼，而且您可以輕鬆地將您現有的同步程式碼移轉至非同步程式碼。</span><span class="sxs-lookup"><span data-stu-id="1da5c-118">With these methods, you can write asynchronous code that's similar to your synchronous code, and you can migrate your existing synchronous code to asynchronous code easily.</span></span>  
  
-   <span data-ttu-id="1da5c-119">在 應用程式中使用非同步方法沒有明顯的網路資料流的延遲。</span><span class="sxs-lookup"><span data-stu-id="1da5c-119">Use the asynchronous methods in apps where there is significant network stream latency.</span></span> <span data-ttu-id="1da5c-120">避免使用的記憶體資料流或本機檔案資料流讀取/寫入作業的非同步 Api。</span><span class="sxs-lookup"><span data-stu-id="1da5c-120">Avoid using the asynchronous APIs for memory stream or local file stream read/write operations.</span></span> <span data-ttu-id="1da5c-121">輸入資料流中， <xref:System.Xml.XmlTextReader>，和<xref:System.Xml.XmlTextWriter>應支援非同步的作業。</span><span class="sxs-lookup"><span data-stu-id="1da5c-121">The input stream, <xref:System.Xml.XmlTextReader>, and <xref:System.Xml.XmlTextWriter> should support asynchronous operations as well.</span></span> <span data-ttu-id="1da5c-122">否則，執行緒仍然會被 I/O 作業所封鎖。</span><span class="sxs-lookup"><span data-stu-id="1da5c-122">Otherwise, threads will still be blocked by I/O operations.</span></span>  
  
-   <span data-ttu-id="1da5c-123">我們不建議混合同步和非同步函式呼叫，因為您可能忘了使用`await`關鍵字或使用其中一個非同步是必要的同步 API。</span><span class="sxs-lookup"><span data-stu-id="1da5c-123">We don't recommend mixing synchronous and asynchronous function calls, because you might forget to use the `await` keyword or use a synchronous API where an asynchronous one is necessary.</span></span>  
  
-   <span data-ttu-id="1da5c-124">未設定<xref:System.Xml.XmlReaderSettings.Async%2A?displayProperty=nameWithType>或是<xref:System.Xml.XmlWriterSettings.Async%2A?displayProperty=nameWithType>旗標設為`true`如果您不想要使用非同步方法。</span><span class="sxs-lookup"><span data-stu-id="1da5c-124">Do not set the <xref:System.Xml.XmlReaderSettings.Async%2A?displayProperty=nameWithType> or <xref:System.Xml.XmlWriterSettings.Async%2A?displayProperty=nameWithType> flag to `true` if you don't intend to use an asynchronous method.</span></span>  
  
-   <span data-ttu-id="1da5c-125">如果您忘記指定`await`關鍵字呼叫非同步方法時，結果會不具決定性：您可能會收到您所預期的結果或例外狀況。</span><span class="sxs-lookup"><span data-stu-id="1da5c-125">If you forget to specify the `await` keyword when you call an asynchronous method, the results are non-deterministic: You might receive the result you expected or an exception.</span></span>  
  
-   <span data-ttu-id="1da5c-126">當<xref:System.Xml.XmlReader>物件讀取大型文字節點，它可能會快取只有部分的文字值，並傳回文字節點，因此擷取<xref:System.Xml.XmlReader.Value%2A?displayProperty=nameWithType>屬性可能會封鎖 I/O 作業。</span><span class="sxs-lookup"><span data-stu-id="1da5c-126">When an <xref:System.Xml.XmlReader> object is reading a large text node, it might cache only a partial text value and return the text node, so retrieving the <xref:System.Xml.XmlReader.Value%2A?displayProperty=nameWithType> property might be blocked by an I/O operation.</span></span> <span data-ttu-id="1da5c-127">使用 <xref:System.Xml.XmlReader.GetValueAsync%2A?displayProperty=nameWithType>方法來取得文字值，在非同步模式中，或使用<xref:System.Xml.XmlReader.ReadValueChunkAsync%2A?displayProperty=nameWithType>區塊 （chunk） 中的方法，以讀取大型文字區塊。</span><span class="sxs-lookup"><span data-stu-id="1da5c-127">Use the <xref:System.Xml.XmlReader.GetValueAsync%2A?displayProperty=nameWithType> method to get the text value in asynchronous mode, or use the <xref:System.Xml.XmlReader.ReadValueChunkAsync%2A?displayProperty=nameWithType> method to read a large text block in chunks.</span></span>  
  
-   <span data-ttu-id="1da5c-128">當您使用<xref:System.Xml.XmlWriter>物件，請呼叫<xref:System.Xml.XmlWriter.FlushAsync%2A?displayProperty=nameWithType>方法之前呼叫<xref:System.Xml.XmlWriter.Close%2A?displayProperty=nameWithType>以避免封鎖 I/O 作業。</span><span class="sxs-lookup"><span data-stu-id="1da5c-128">When you use an <xref:System.Xml.XmlWriter> object, call the <xref:System.Xml.XmlWriter.FlushAsync%2A?displayProperty=nameWithType> method before calling <xref:System.Xml.XmlWriter.Close%2A?displayProperty=nameWithType> to avoid blocking an I/O operation.</span></span>  
  
<a name="diff"></a>   
## <a name="differences-from-the-w3c-specs"></a><span data-ttu-id="1da5c-129">與 W3C 規格之間的差異</span><span class="sxs-lookup"><span data-stu-id="1da5c-129">Differences from the W3C specs</span></span>  
 <span data-ttu-id="1da5c-130">在兩種情況會牽涉到模型群組結構描述元件條件約束<xref:System.Xml>命名空間與 W3C 建議事項。</span><span class="sxs-lookup"><span data-stu-id="1da5c-130">In two cases that involve constraints on model group schema components, the <xref:System.Xml> namespace differs from the W3C recommendations.</span></span>  
  
 <span data-ttu-id="1da5c-131">**項目宣告中的一致性：**</span><span class="sxs-lookup"><span data-stu-id="1da5c-131">**Consistency in element declarations:**</span></span>  
  
 <span data-ttu-id="1da5c-132">在某些情況下，當使用替代群組時，<xref:System.Xml>實作不符合 「 結構描述元件條件約束：元素宣告一致 」、 「 中所述[模型群組結構描述元件條件約束](https://go.microsoft.com/fwlink/?LinkId=137029)在 W3C 規格的章節。</span><span class="sxs-lookup"><span data-stu-id="1da5c-132">In some cases, when substitution groups are used, the <xref:System.Xml> implementation does not satisfy the "Schema Component Constraint: Element Declarations Consistent," which is described in the [Constraints on Model Group Schema Components](https://go.microsoft.com/fwlink/?LinkId=137029) section of the W3C spec.</span></span>  
  
 <span data-ttu-id="1da5c-133">例如，下列結構描述包含具有相同名稱的項目，但會使用相同的內容模型和替代群組中的不同類型。</span><span class="sxs-lookup"><span data-stu-id="1da5c-133">For example, the following schema includes elements that have the same name but different types in the same content model, and substitution groups are used.</span></span> <span data-ttu-id="1da5c-134">這應該會造成錯誤，但是 <xref:System.Xml> 會編譯和驗證該結構描述，而不會有錯誤。</span><span class="sxs-lookup"><span data-stu-id="1da5c-134">This should cause an error, but <xref:System.Xml> compiles and validates the schema without errors.</span></span>  
  
```xml  
<?xml version="1.0" encoding="utf-8" ?>   
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified">  
  
   <xs:element name="e1" type="t1"/>  
   <xs:complexType name="t1"/>  
  
   <xs:element name="e2" type="t2" substitutionGroup="e1"/>  
      <xs:complexType name="t2">  
         <xs:complexContent>  
            <xs:extension base="t1">  
         </xs:extension>  
      </xs:complexContent>  
   </xs:complexType>  
  
   <xs:complexType name="t3">  
      <xs:sequence>  
         <xs:element ref="e1"/>  
         <xs:element name="e2" type="xs:int"/>  
      </xs:sequence>  
   </xs:complexType>  
</xs:schema>  
```  
  
 <span data-ttu-id="1da5c-135">在此結構描述中，型別 `t3` 包含項目順序。</span><span class="sxs-lookup"><span data-stu-id="1da5c-135">In this schema, type `t3` contains a sequence of elements.</span></span> <span data-ttu-id="1da5c-136">因為替代之故，對序列中 `e1` 項目的參考可能會產生 `e1` 型別的 `t1` 項目或是 `e2` 型別的 `t2` 項目。</span><span class="sxs-lookup"><span data-stu-id="1da5c-136">Because of the substitution, the reference to element `e1` from the sequence can result either in element `e1` of type `t1` or in element `e2` of type `t2`.</span></span> <span data-ttu-id="1da5c-137">後者的情況下可能會導致兩個序列`e2`項目，其中有一個是類型`t2`，另一個是型別的`xs:int`。</span><span class="sxs-lookup"><span data-stu-id="1da5c-137">The latter case would result in a sequence of two `e2` elements, where one is of type `t2` and the other is of type `xs:int`.</span></span>  
  
 <span data-ttu-id="1da5c-138">**唯一物件屬性：**</span><span class="sxs-lookup"><span data-stu-id="1da5c-138">**Unique particle attribution:**</span></span>  
  
 <span data-ttu-id="1da5c-139">在下列情況中，<xref:System.Xml>實作不符合 「 結構描述元件條件約束：唯一物件屬性，」 中所述[模型群組結構描述元件條件約束](https://go.microsoft.com/fwlink/?LinkId=137029)在 W3C 規格的章節。</span><span class="sxs-lookup"><span data-stu-id="1da5c-139">Under the following conditions, the <xref:System.Xml> implementation does not satisfy the "Schema Component Constraint: Unique Particle Attribution," which is described in the [Constraints on Model Group Schema Components](https://go.microsoft.com/fwlink/?LinkId=137029) section of the W3C spec.</span></span>  
  
-   <span data-ttu-id="1da5c-140">群組中的其中一個項目參考其他項目。</span><span class="sxs-lookup"><span data-stu-id="1da5c-140">One of the elements in the group references another element.</span></span>  
  
-   <span data-ttu-id="1da5c-141">參考的項目是替代群組的標頭項目。</span><span class="sxs-lookup"><span data-stu-id="1da5c-141">The referenced element is a head element of a substitution group.</span></span>  
  
-   <span data-ttu-id="1da5c-142">替代群組會包含具有相同名稱做為其中一個項目群組中的項目。</span><span class="sxs-lookup"><span data-stu-id="1da5c-142">The substitution group contains an element that has the same name as one of the elements in the group.</span></span>  
  
-   <span data-ttu-id="1da5c-143">參考替代群組標頭項目和具有相同名稱的項目，因為不固定的替代群組項目之項目的基數 (minOccurs < maxOccurs)。</span><span class="sxs-lookup"><span data-stu-id="1da5c-143">The cardinality of the element that references the substitution group head element and the element with the same name as a substitution group element is not fixed (minOccurs < maxOccurs).</span></span>  
  
-   <span data-ttu-id="1da5c-144">參考替代群組的項目定義在之前替代群組項目同名的項目的定義。</span><span class="sxs-lookup"><span data-stu-id="1da5c-144">The definition of the element that references the substitution group precedes the definition of the element with the same name as a substitution group element.</span></span>  
  
 <span data-ttu-id="1da5c-145">例如，在內容模型下方的結構描述是模稜兩可的，而且應該會造成編譯錯誤，但是 <xref:System.Xml> 會編譯該結構描述，而不會有錯誤。</span><span class="sxs-lookup"><span data-stu-id="1da5c-145">For example, in the schema below the content model is ambiguous and should cause a compilation error, but <xref:System.Xml> compiles the schema without errors.</span></span>  
  
```xml  
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified">  
  
  <xs:element name="e1" type="xs:int"/>  
  <xs:element name="e2" type="xs:int" substitutionGroup="e1"/>  
  
  <xs:complexType name="t3">  
    <xs:sequence>  
      <xs:element ref="e1" minOccurs="0" maxOccurs="1"/>  
      <xs:element name="e2" type="xs:int" minOccurs="0" maxOccurs="1"/>  
    </xs:sequence>  
  </xs:complexType>  
  
  <xs:element name="e3" type="t3"/>  
</xs:schema>  
```  
  
 <span data-ttu-id="1da5c-146">如果您嘗試驗證下列 XML 程式碼針對上述的結構描述，驗證將會失敗並出現下列訊息：「 項目 'e3' 有無效的子項目 'e2' 」。 和<xref:System.Xml.Schema.XmlSchemaValidationException>會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="1da5c-146">If you try to validate the following XML against the schema above, the validation will fail with the following message: "The element 'e3' has invalid child element 'e2'." and an <xref:System.Xml.Schema.XmlSchemaValidationException> exception will be thrown.</span></span>  
  
```xml  
<e3>  
  <e2>1</e2>  
  <e2>2</e2>  
</e3>  
```  
  
 <span data-ttu-id="1da5c-147">若要解決此問題，您可以交換 XSD 文件中的項目宣告。</span><span class="sxs-lookup"><span data-stu-id="1da5c-147">To work around this problem, you can swap element declarations in the XSD document.</span></span> <span data-ttu-id="1da5c-148">例如：</span><span class="sxs-lookup"><span data-stu-id="1da5c-148">For example:</span></span>  
  
```xml  
<xs:sequence>  
  <xs:element ref="e1" minOccurs="0" maxOccurs="1"/>  
  <xs:element name="e2" type="xs:int" minOccurs="0" maxOccurs="1"/>  
</xs:sequence>  
```  
  
 <span data-ttu-id="1da5c-149">變成：</span><span class="sxs-lookup"><span data-stu-id="1da5c-149">becomes this:</span></span>  
  
```xml  
<xs:sequence>  
  <xs:element name="e2" type="xs:int" minOccurs="0" maxOccurs="1"/>  
  <xs:element ref="e1" minOccurs="0" maxOccurs="1"/>  
</xs:sequence>  
```  
  
 <span data-ttu-id="1da5c-150">以下是問題的另一個範例相同:</span><span class="sxs-lookup"><span data-stu-id="1da5c-150">Here's another example of the same issue:</span></span>  
  
```xml  
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified">  
   <xs:element name="e1" type="xs:string"/>  
   <xs:element name="e2" type="xs:string" substitutionGroup="e1"/>  
  
   <xs:complexType name="t3">  
      <xs:sequence>  
         <xs:element ref="e1" minOccurs="0" maxOccurs="1"/>  
         <xs:element name="e2" type="xs:int" minOccurs="0" maxOccurs="1"/>  
      </xs:sequence>  
   </xs:complexType>  
   <xs:element name="e3" type="t3"/>  
</xs:schema>  
```  
  
 <span data-ttu-id="1da5c-151">如果您嘗試驗證下列 XML 程式碼針對上述的結構描述，驗證將會失敗，發生下列例外狀況：「 未處理例外狀況：System.Xml.Schema.XmlSchemaValidationException:'E2' el 項目無效-根據其資料類型的值 'abc' 無效 'http://www.w3.org/2001/XMLSchema:int'-字串 'abc' 不是有效的 Int32 值。 」</span><span class="sxs-lookup"><span data-stu-id="1da5c-151">If you try to validate the following XML against the schema above, the validation will fail with the following exception: "Unhandled Exception: System.Xml.Schema.XmlSchemaValidationException: The 'e2' el element is invalid - The value 'abc' is invalid according to its datatype 'http://www.w3.org/2001/XMLSchema:int' - The string 'abc' is not a valid Int32 value."</span></span>
  
```xml  
<e3><e2>abc</e2></e3>  
```  
  
<a name="security"></a>   
## <a name="security-considerations"></a><span data-ttu-id="1da5c-152">安全性考量</span><span class="sxs-lookup"><span data-stu-id="1da5c-152">Security considerations</span></span>  
 <span data-ttu-id="1da5c-153">型別和成員<xref:System.Xml>命名空間依賴[.NET 安全性系統](~/docs/standard/security/index.md)。</span><span class="sxs-lookup"><span data-stu-id="1da5c-153">The types and members in the <xref:System.Xml> namespace rely on the [.NET security system](~/docs/standard/security/index.md).</span></span> <span data-ttu-id="1da5c-154">下列各節討論專屬於 XML 技術的安全性問題。</span><span class="sxs-lookup"><span data-stu-id="1da5c-154">The following sections discuss security issues that are specific to XML technologies.</span></span>
  
 <span data-ttu-id="1da5c-155">也請注意，當您使用<xref:System.Xml>類型和成員，如果 XML 包含有潛在的隱私權影響的資料，您需要以尊重使用者隱私權的方式實作您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1da5c-155">Also note that when you use the <xref:System.Xml> types and members, if the XML contains data that has potential privacy implications, you need to implement your app in a way that respects your end users' privacy.</span></span>
  
 <span data-ttu-id="1da5c-156">**外部存取**</span><span class="sxs-lookup"><span data-stu-id="1da5c-156">**External access**</span></span>  
  
 <span data-ttu-id="1da5c-157">有幾個 XML 技術能夠在處理期間擷取其他文件。</span><span class="sxs-lookup"><span data-stu-id="1da5c-157">Several XML technologies have the ability to retrieve other documents during processing.</span></span> <span data-ttu-id="1da5c-158">例如，文件類型定義 (DTD) 可位於要剖析的文件中。</span><span class="sxs-lookup"><span data-stu-id="1da5c-158">For example, a document type definition (DTD) can reside in the document being parsed.</span></span> <span data-ttu-id="1da5c-159">DTD 還可以存在於要剖析之文件所參考的外部文件中。</span><span class="sxs-lookup"><span data-stu-id="1da5c-159">The DTD can also live in an external document that is referenced by the document being parsed.</span></span> <span data-ttu-id="1da5c-160">XML 結構描述定義語言 (XSD) 及 XSLT 技術還能夠包含其他檔案的資訊。</span><span class="sxs-lookup"><span data-stu-id="1da5c-160">The XML Schema definition language (XSD) and XSLT technologies also have the ability to include information from other files.</span></span> <span data-ttu-id="1da5c-161">這些外部資源會帶來一些安全性考量。</span><span class="sxs-lookup"><span data-stu-id="1da5c-161">These external resources can present some security concerns.</span></span> <span data-ttu-id="1da5c-162">比方說，您會想要確保只從受信任的網站，您的應用程式會擷取的檔案，並將它擷取檔案不包含惡意資料。</span><span class="sxs-lookup"><span data-stu-id="1da5c-162">For example, you'll want to ensure that your app retrieves files only from trusted sites, and that the file it retrieves doesn't contain malicious data.</span></span>  
  
 <span data-ttu-id="1da5c-163"><xref:System.Xml.XmlUrlResolver>類別用來載入 XML 文件以及解析外部資源，例如實體、 Dtd 或結構描述，以及匯入或 include 指示詞。</span><span class="sxs-lookup"><span data-stu-id="1da5c-163">The <xref:System.Xml.XmlUrlResolver> class is used to load XML documents and to resolve external resources such as entities, DTDs, or schemas, and import or include directives.</span></span>  
  
 <span data-ttu-id="1da5c-164">您可以覆寫這個類別，並指定<xref:System.Xml.XmlResolver>若要使用的物件。</span><span class="sxs-lookup"><span data-stu-id="1da5c-164">You can override this class and specify the <xref:System.Xml.XmlResolver> object to use.</span></span> <span data-ttu-id="1da5c-165">如果您需要開啟不是由您控制或不受信任的資源，請使用 <xref:System.Xml.XmlSecureResolver> 類別。</span><span class="sxs-lookup"><span data-stu-id="1da5c-165">Use the <xref:System.Xml.XmlSecureResolver> class if you need to open a resource that you do not control, or that is untrusted.</span></span> <span data-ttu-id="1da5c-166"><xref:System.Xml.XmlSecureResolver> 可包裝 <xref:System.Xml.XmlResolver>，並可讓您限制基礎 <xref:System.Xml.XmlResolver> 可存取的資源。</span><span class="sxs-lookup"><span data-stu-id="1da5c-166">The <xref:System.Xml.XmlSecureResolver> wraps an <xref:System.Xml.XmlResolver> and allows you to restrict the resources that the underlying <xref:System.Xml.XmlResolver> has access to.</span></span>  
  
 <span data-ttu-id="1da5c-167">**阻斷服務**</span><span class="sxs-lookup"><span data-stu-id="1da5c-167">**Denial of service**</span></span>  
  
 <span data-ttu-id="1da5c-168">下列案例較不易受阻斷服務的攻擊，因為 <xref:System.Xml> 類別會提供保護免受此類攻擊的方法。</span><span class="sxs-lookup"><span data-stu-id="1da5c-168">The following scenarios are considered to be less vulnerable to denial of service attacks because the <xref:System.Xml> classes provide a means of protection from such attacks.</span></span>  
  
-   <span data-ttu-id="1da5c-169">剖析文字 XML 資料。</span><span class="sxs-lookup"><span data-stu-id="1da5c-169">Parsing text XML data.</span></span>  
  
-   <span data-ttu-id="1da5c-170">如果 Microsoft SQL Server 所產生的二進位的 XML 資料，請剖析二進位 XML 資料。</span><span class="sxs-lookup"><span data-stu-id="1da5c-170">Parsing binary XML data if the binary XML data was generated by Microsoft SQL Server.</span></span>  
  
-   <span data-ttu-id="1da5c-171">將 XML 文件及片段從資料來源寫入檔案系統、資料流、<xref:System.IO.TextWriter> 或 <xref:System.Text.StringBuilder>。</span><span class="sxs-lookup"><span data-stu-id="1da5c-171">Writing XML documents and fragments from data sources to the file system, streams, a <xref:System.IO.TextWriter>, or a <xref:System.Text.StringBuilder>.</span></span>  
  
-   <span data-ttu-id="1da5c-172">如果您正使用 <xref:System.Xml.XmlReader> 物件，請將文件載入文件物件模型 (DOM) 物件，並將 <xref:System.Xml.XmlReaderSettings.DtdProcessing%2A?displayProperty=nameWithType> 設為 <xref:System.Xml.DtdProcessing.Prohibit?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="1da5c-172">Loading documents into the Document Object Model (DOM) object if you are using an <xref:System.Xml.XmlReader> object and <xref:System.Xml.XmlReaderSettings.DtdProcessing%2A?displayProperty=nameWithType> set to <xref:System.Xml.DtdProcessing.Prohibit?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="1da5c-173">巡覽 DOM 物件。</span><span class="sxs-lookup"><span data-stu-id="1da5c-173">Navigating the DOM object.</span></span>  
  
 <span data-ttu-id="1da5c-174">如果您擔心遭受阻斷服務攻擊，或正在不受信任的環境下工作，不建議您使用下列案例。</span><span class="sxs-lookup"><span data-stu-id="1da5c-174">The following scenarios are not recommended if you are concerned about denial of service attacks, or if you are working in an untrusted environment.</span></span>  
  
-   <span data-ttu-id="1da5c-175">DTD 處理。</span><span class="sxs-lookup"><span data-stu-id="1da5c-175">DTD processing.</span></span>  
  
-   <span data-ttu-id="1da5c-176">結構描述處理。</span><span class="sxs-lookup"><span data-stu-id="1da5c-176">Schema processing.</span></span> <span data-ttu-id="1da5c-177">這包括將不受信任的結構描述加入至結構描述集合、編譯不受信任的結構描述，以及使用不受信任的結構描述進行驗證。</span><span class="sxs-lookup"><span data-stu-id="1da5c-177">This includes adding an untrusted schema to the schema collection, compiling an untrusted schema, and validating by using an untrusted schema.</span></span>  
  
-   <span data-ttu-id="1da5c-178">XSLT 處理。</span><span class="sxs-lookup"><span data-stu-id="1da5c-178">XSLT processing.</span></span>  
  
-   <span data-ttu-id="1da5c-179">剖析使用者提供之二進位 XML 資料的任意資料流。</span><span class="sxs-lookup"><span data-stu-id="1da5c-179">Parsing any arbitrary stream of user supplied binary XML data.</span></span>  
  
-   <span data-ttu-id="1da5c-180">DOM 作業，如查詢、編輯、在文件之間移動子樹狀目錄，以及儲存 DOM 物件。</span><span class="sxs-lookup"><span data-stu-id="1da5c-180">DOM operations such as querying, editing, moving sub-trees between documents, and saving DOM objects.</span></span>  
  
 <span data-ttu-id="1da5c-181">如果您顧慮阻絕服務問題，或您正在處理不受信任的來源，請勿啟用 DTD 處理。</span><span class="sxs-lookup"><span data-stu-id="1da5c-181">If you are concerned about denial of service issues or if you are dealing with untrusted sources, do not enable DTD processing.</span></span> <span data-ttu-id="1da5c-182">這預設會停用上<xref:System.Xml.XmlReader>物件的<xref:System.Xml.XmlReader.Create%2A?displayProperty=nameWithType>方法會建立。</span><span class="sxs-lookup"><span data-stu-id="1da5c-182">This is disabled by default on <xref:System.Xml.XmlReader> objects that the <xref:System.Xml.XmlReader.Create%2A?displayProperty=nameWithType> method creates.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1da5c-183">根據預設，<xref:System.Xml.XmlTextReader> 允許 DTD 處理。</span><span class="sxs-lookup"><span data-stu-id="1da5c-183">The <xref:System.Xml.XmlTextReader> allows DTD processing by default.</span></span> <span data-ttu-id="1da5c-184">請使用 <xref:System.Xml.XmlTextReader.DtdProcessing%2A?displayProperty=nameWithType> 屬性停用此功能。</span><span class="sxs-lookup"><span data-stu-id="1da5c-184">Use the <xref:System.Xml.XmlTextReader.DtdProcessing%2A?displayProperty=nameWithType> property to disable this feature.</span></span>  
  
 <span data-ttu-id="1da5c-185">如果您已啟用 DTD 處理，您可以使用<xref:System.Xml.XmlSecureResolver>類別，以限制的資源，<xref:System.Xml.XmlReader>可以存取。</span><span class="sxs-lookup"><span data-stu-id="1da5c-185">If you have DTD processing enabled, you can use the <xref:System.Xml.XmlSecureResolver> class to restrict the resources that the <xref:System.Xml.XmlReader> can access.</span></span> <span data-ttu-id="1da5c-186">您也可以設計您的應用程式，讓 XML 處理具有記憶體和時間限制。</span><span class="sxs-lookup"><span data-stu-id="1da5c-186">You can also design your app so that the XML processing is memory and time constrained.</span></span> <span data-ttu-id="1da5c-187">比方說，您可以設定逾時限制在您的 ASP.NET 應用程式。</span><span class="sxs-lookup"><span data-stu-id="1da5c-187">For example, you can configure timeout limits in your ASP.NET app.</span></span>  
  
 <span data-ttu-id="1da5c-188">**處理考量**</span><span class="sxs-lookup"><span data-stu-id="1da5c-188">**Processing considerations**</span></span>  
  
 <span data-ttu-id="1da5c-189">因為 XML 文件可以包含其他檔案的參考，所以很難判定需要多大的處理能力來剖析 XML 文件。</span><span class="sxs-lookup"><span data-stu-id="1da5c-189">Because XML documents can include references to other files, it is difficult to determine how much processing power is required to parse an XML document.</span></span> <span data-ttu-id="1da5c-190">例如，XML 文件可以包含 DTD。</span><span class="sxs-lookup"><span data-stu-id="1da5c-190">For example, XML documents can include a DTD.</span></span> <span data-ttu-id="1da5c-191">如果 DTD 包含巢狀實體或複雜的內容模型，則剖析文件會花費大量的時間。</span><span class="sxs-lookup"><span data-stu-id="1da5c-191">If the DTD contains nested entities or complex content models, it could take an excessive amount of time to parse the document.</span></span>  
  
 <span data-ttu-id="1da5c-192">當使用 <xref:System.Xml.XmlReader> 時，您可以限制文件的大小，該文件可藉由設定 <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> 屬性來加以剖析。</span><span class="sxs-lookup"><span data-stu-id="1da5c-192">When using <xref:System.Xml.XmlReader>, you can limit the size of the document that can be parsed by setting the <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="1da5c-193">您可以藉由設定 <xref:System.Xml.XmlReaderSettings.MaxCharactersFromEntities%2A?displayProperty=nameWithType> 屬性來限制從擴充實體所產生的字元數目。</span><span class="sxs-lookup"><span data-stu-id="1da5c-193">You can limit the number of characters that result from expanding entities by setting the <xref:System.Xml.XmlReaderSettings.MaxCharactersFromEntities%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="1da5c-194">如需設定這些屬性的範例，請參閱適當的參考主題。</span><span class="sxs-lookup"><span data-stu-id="1da5c-194">See the appropriate reference topics for examples of setting these properties.</span></span>  
  
 <span data-ttu-id="1da5c-195">XSD 及 XSLT 技術具有可影響處理效能的其他功能。</span><span class="sxs-lookup"><span data-stu-id="1da5c-195">The XSD and XSLT technologies have additional capabilities that can affect processing performance.</span></span> <span data-ttu-id="1da5c-196">例如，評估很小的文件時，可能會建構需要大量時間進行處理的 XML 結構描述。</span><span class="sxs-lookup"><span data-stu-id="1da5c-196">For example, it is possible to construct an XML schema that requires a substantial amount of time to process when evaluated over a relatively small document.</span></span> <span data-ttu-id="1da5c-197">還可能將指令碼區塊嵌入 XSLT 樣式表中。</span><span class="sxs-lookup"><span data-stu-id="1da5c-197">It is also possible to embed script blocks within an XSLT style sheet.</span></span> <span data-ttu-id="1da5c-198">這兩種情況會造成潛在的安全性威脅，您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1da5c-198">Both cases pose a potential security threat to your app.</span></span>  
  
 <span data-ttu-id="1da5c-199">當建立應用程式使用<xref:System.Xml.Xsl.XslCompiledTransform>類別，您應該留意下列項目及其含意：</span><span class="sxs-lookup"><span data-stu-id="1da5c-199">When creating an app that uses the <xref:System.Xml.Xsl.XslCompiledTransform> class, you should be aware of the following items and their implications:</span></span>  
  
-   <span data-ttu-id="1da5c-200">依預設會停用 XSLT 指令碼。</span><span class="sxs-lookup"><span data-stu-id="1da5c-200">XSLT scripting is disabled by default.</span></span> <span data-ttu-id="1da5c-201">僅當需要指令碼支援且在完全受信任的環境中運作時，才應啟用 XSLT 指令碼。</span><span class="sxs-lookup"><span data-stu-id="1da5c-201">XSLT scripting should be enabled only if you require script support and you are working in a fully trusted environment.</span></span>  
  
-   <span data-ttu-id="1da5c-202">依預設會停用 XSLT `document()` 函式。</span><span class="sxs-lookup"><span data-stu-id="1da5c-202">The XSLT `document()` function is disabled by default.</span></span> <span data-ttu-id="1da5c-203">如果您啟用 `document()` 函式，則藉由傳遞 <xref:System.Xml.XmlSecureResolver> 物件至 <xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A?displayProperty=nameWithType> 方法，限制可存取的資源。</span><span class="sxs-lookup"><span data-stu-id="1da5c-203">If you enable the `document()` function, restrict the resources that can be accessed by passing an <xref:System.Xml.XmlSecureResolver> object to the <xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A?displayProperty=nameWithType> method.</span></span>  
  
-   <span data-ttu-id="1da5c-204">依預設會啟用擴充物件。</span><span class="sxs-lookup"><span data-stu-id="1da5c-204">Extension objects are enabled by default.</span></span> <span data-ttu-id="1da5c-205">如果將包含擴充物件的 <xref:System.Xml.Xsl.XsltArgumentList> 物件傳遞給 <xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A?displayProperty=nameWithType> 方法，則會使用這些擴充物件。</span><span class="sxs-lookup"><span data-stu-id="1da5c-205">If an <xref:System.Xml.Xsl.XsltArgumentList> object that contains extension objects is passed to the <xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A?displayProperty=nameWithType> method, the extension objects are used.</span></span>  
  
-   <span data-ttu-id="1da5c-206">XSLT 樣式表可以包含其他檔案及內嵌指令碼區塊的參考。</span><span class="sxs-lookup"><span data-stu-id="1da5c-206">XSLT style sheets can include references to other files and embedded script blocks.</span></span> <span data-ttu-id="1da5c-207">居心不良的使用者會利用這一點，藉由提供您資料或樣式表，使您因執行他們而導致系統持續處理，直到電腦資源不足，來進行攻擊。</span><span class="sxs-lookup"><span data-stu-id="1da5c-207">A malicious user can exploit this by supplying you with data or style sheets that, when executed, can cause your system to process until the computer runs low on resources.</span></span>  
  
-   <span data-ttu-id="1da5c-208">在混合的信任環境中執行的 XSLT 應用程式可能會導致詐騙的樣式表。</span><span class="sxs-lookup"><span data-stu-id="1da5c-208">XSLT apps that run in a mixed trust environment can result in style sheet spoofing.</span></span> <span data-ttu-id="1da5c-209">例如，居心不良的使用者可載入含有害樣式表的物件，然後將其傳遞給另一使用者，該使用者隨後會呼叫 <xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A?displayProperty=nameWithType> 方法並執行轉換。</span><span class="sxs-lookup"><span data-stu-id="1da5c-209">For example, a malicious user can load an object with a harmful style sheet and hand it off to another user who subsequently calls the <xref:System.Xml.Xsl.XslCompiledTransform.Transform%2A?displayProperty=nameWithType> method and executes the transformation.</span></span>  
  
 <span data-ttu-id="1da5c-210">不啟用指令碼或 `document()` 函式 (除非樣式表來自信任的來源)，不接受來自不受信任來源的 <xref:System.Xml.Xsl.XslCompiledTransform> 物件、XSLT 樣式表或 XML 來源資料，可減輕這些安全性問題。</span><span class="sxs-lookup"><span data-stu-id="1da5c-210">These security issues can be mitigated by not enabling scripting or the `document()` function unless the style sheet comes from a trusted source, and by not accepting <xref:System.Xml.Xsl.XslCompiledTransform> objects, XSLT style sheets, or XML source data from an untrusted source.</span></span>  
  
 <span data-ttu-id="1da5c-211">**例外狀況處理**</span><span class="sxs-lookup"><span data-stu-id="1da5c-211">**Exception handling**</span></span>  
  
 <span data-ttu-id="1da5c-212">較低的層級元件所擲回例外狀況可能會洩露路徑資訊，您不想公開給應用程式。</span><span class="sxs-lookup"><span data-stu-id="1da5c-212">Exceptions thrown by lower level components can disclose path information that you do not want exposed to the app.</span></span> <span data-ttu-id="1da5c-213">您的應用程式必須攔截例外狀況，並適當地處理它們。</span><span class="sxs-lookup"><span data-stu-id="1da5c-213">Your apps must catch exceptions and process them appropriately.</span></span>  
  
 ]]></format>
    </remarks>
    <altmember cref="N:System.Xml.Xsl" />
    <altmember cref="N:System.Xml.Schema" />
    <altmember cref="N:System.Xml.Linq" />
    <related type="Article" href="~/docs/standard/data/xml/index.md"><span data-ttu-id="1da5c-214">XML 文件和資料</span><span class="sxs-lookup"><span data-stu-id="1da5c-214">XML Documents and Data</span></span></related>
  </Docs>
</Namespace>