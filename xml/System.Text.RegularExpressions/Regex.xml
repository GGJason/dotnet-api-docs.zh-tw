<Type Name="Regex" FullName="System.Text.RegularExpressions.Regex">
  <TypeSignature Language="C#" Value="public class Regex : System.Runtime.Serialization.ISerializable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi serializable beforefieldinit Regex extends System.Object implements class System.Runtime.Serialization.ISerializable" />
  <TypeSignature Language="DocId" Value="T:System.Text.RegularExpressions.Regex" />
  <TypeSignature Language="VB.NET" Value="Public Class Regex&#xA;Implements ISerializable" />
  <TypeSignature Language="C++ CLI" Value="public ref class Regex : System::Runtime::Serialization::ISerializable" />
  <AssemblyInfo>
    <AssemblyName>System.Text.RegularExpressions</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.10.0</AssemblyVersion>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.1.1.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.1.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.Runtime.Serialization.ISerializable</InterfaceName>
    </Interface>
  </Interfaces>
  <Docs>
    <summary><span data-ttu-id="a2b9d-101">表示不變的規則運算式 (Regular Expression)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-101">Represents an immutable regular expression.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-102"><xref:System.Text.RegularExpressions.Regex>類別代表.NET Framework 規則運算式引擎。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-102">The <xref:System.Text.RegularExpressions.Regex> class represents the .NET Framework's regular expression engine.</span></span> <span data-ttu-id="a2b9d-103">可用於快速剖析大量文字，尋找特定的字元模式;擷取、 編輯、 取代或刪除文字子字串;並將擷取的字串新增至集合，以產生報表。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-103">It can be used to quickly parse large amounts of text to find specific character patterns; to extract, edit, replace, or delete text substrings; and to add the extracted strings to a collection to generate a report.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a2b9d-104">如果您主要的優點是要判斷它是否符合特定模式來驗證字串，您可以使用<xref:System.Configuration.RegexStringValidator?displayProperty=nameWithType>類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-104">If your primary interest is to validate a string by determining whether it conforms to a particular pattern, you can use the <xref:System.Configuration.RegexStringValidator?displayProperty=nameWithType> class.</span></span>  
  
 <span data-ttu-id="a2b9d-105">若要使用規則運算式，您會定義您想要使用中所述的語法來識別文字資料流中的模式[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-105">To use regular expressions, you define the pattern that you want to identify in a text stream by using the syntax documented in [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span> <span data-ttu-id="a2b9d-106">接下來，您可以選擇性地具現化<xref:System.Text.RegularExpressions.Regex>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-106">Next, you can optionally instantiate a <xref:System.Text.RegularExpressions.Regex> object.</span></span> <span data-ttu-id="a2b9d-107">最後，您可以呼叫執行某些作業，例如取代符合規則運算式模式的文字，或識別模式比對的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-107">Finally, you call a method that performs some operation, such as replacing text that matches the regular expression pattern, or identifying a pattern match.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a2b9d-108">某些常見的規則運算式模式，請參閱[規則運算式範例](~/docs/standard/base-types/regular-expression-examples.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-108">For some common regular expression patterns, see [Regular Expression Examples](~/docs/standard/base-types/regular-expression-examples.md).</span></span> <span data-ttu-id="a2b9d-109">另外還有數的規則運算式模式，例如在線上文件庫[一般 Expressions.info](https://www.regular-expressions.info/examples.html)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-109">There are also a number of online libraries of regular expression patterns, such as the one at [Regular-Expressions.info](https://www.regular-expressions.info/examples.html).</span></span>  
  
<a name="remarks"></a> <span data-ttu-id="a2b9d-110">如需有關使用<xref:System.Text.RegularExpressions.Regex>類別，請參閱本主題中的下列各節：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-110">For more information about using the <xref:System.Text.RegularExpressions.Regex> class, see the following sections in this topic:</span></span>  
  
-   [<span data-ttu-id="a2b9d-111">Regex vs。字串方法</span><span class="sxs-lookup"><span data-stu-id="a2b9d-111">Regex vs. String Methods</span></span>](#regex_vs_string)  
  
-   [<span data-ttu-id="a2b9d-112">靜態與執行個體方法</span><span class="sxs-lookup"><span data-stu-id="a2b9d-112">Static vs. Instance Methods</span></span>](#static_vs_instance)  
  
-   [<span data-ttu-id="a2b9d-113">執行規則運算式作業</span><span class="sxs-lookup"><span data-stu-id="a2b9d-113">Performing Regular Expression Operations</span></span>](#regex_ops)  
  
-   [<span data-ttu-id="a2b9d-114">定義逾時值</span><span class="sxs-lookup"><span data-stu-id="a2b9d-114">Defining a Time-Out Value</span></span>](#define_timeout)  
  
 <span data-ttu-id="a2b9d-115">如需規則運算式語言的詳細資訊，請參閱[規則運算式語言 - 快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)，或下載並列印下列其中一本小手冊：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-115">For more information about the regular expression language, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md) or download and print one of these brochures:</span></span>  
  
 [<span data-ttu-id="a2b9d-116">Word (.docx) 格式的快速參考</span><span class="sxs-lookup"><span data-stu-id="a2b9d-116">Quick Reference in Word (.docx) format</span></span>](https://download.microsoft.com/download/D/2/4/D240EBF6-A9BA-4E4F-A63F-AEB6DA0B921C/Regular%20expressions%20quick%20reference.docx)  
 [<span data-ttu-id="a2b9d-117">PDF (.pdf) 格式的快速參考</span><span class="sxs-lookup"><span data-stu-id="a2b9d-117">Quick Reference in PDF (.pdf) format</span></span>](https://download.microsoft.com/download/D/2/4/D240EBF6-A9BA-4E4F-A63F-AEB6DA0B921C/Regular%20expressions%20quick%20reference.pdf)  
  
<a name="regex_vs_string"></a>   
## <a name="regex-vs-string-methods"></a><span data-ttu-id="a2b9d-118">Regex vs。字串方法</span><span class="sxs-lookup"><span data-stu-id="a2b9d-118">Regex vs. String Methods</span></span>  
 <span data-ttu-id="a2b9d-119"><xref:System.String?displayProperty=nameWithType>類別包含您可以使用執行模式比對文字的數個搜尋和比較方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-119">The <xref:System.String?displayProperty=nameWithType> class includes several search and comparison methods that you can use to perform pattern matching with text.</span></span> <span data-ttu-id="a2b9d-120">例如， <xref:System.String.Contains%2A?displayProperty=nameWithType>， <xref:System.String.EndsWith%2A?displayProperty=nameWithType>，和<xref:System.String.StartsWith%2A?displayProperty=nameWithType>方法，判斷字串執行個體是否包含指定的子字串; 而<xref:System.String.IndexOf%2A?displayProperty=nameWithType>， <xref:System.String.IndexOfAny%2A?displayProperty=nameWithType>， <xref:System.String.LastIndexOf%2A?displayProperty=nameWithType>，和<xref:System.String.LastIndexOfAny%2A?displayProperty=nameWithType>方法會傳回字串中指定的子字串的開始位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-120">For example, the <xref:System.String.Contains%2A?displayProperty=nameWithType>, <xref:System.String.EndsWith%2A?displayProperty=nameWithType>, and <xref:System.String.StartsWith%2A?displayProperty=nameWithType> methods determine whether a string instance contains a specified substring; and the <xref:System.String.IndexOf%2A?displayProperty=nameWithType>, <xref:System.String.IndexOfAny%2A?displayProperty=nameWithType>, <xref:System.String.LastIndexOf%2A?displayProperty=nameWithType>, and <xref:System.String.LastIndexOfAny%2A?displayProperty=nameWithType> methods return the starting position of a specified substring in a string.</span></span> <span data-ttu-id="a2b9d-121">使用的方法<xref:System.String?displayProperty=nameWithType>類別時，您要搜尋特定字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-121">Use the methods of the <xref:System.String?displayProperty=nameWithType> class when you are searching for a specific string.</span></span> <span data-ttu-id="a2b9d-122">使用<xref:System.Text.RegularExpressions.Regex>類別時，您要搜尋特定的模式字串中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-122">Use the <xref:System.Text.RegularExpressions.Regex> class when you are searching for a specific pattern in a string.</span></span> <span data-ttu-id="a2b9d-123">如需詳細資訊和範例，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-123">For more information and examples, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md).</span></span>  
  
 [<span data-ttu-id="a2b9d-124">回註解</span><span class="sxs-lookup"><span data-stu-id="a2b9d-124">Back to Remarks</span></span>](#remarks)  
  
<a name="static_vs_instance"></a>   
## <a name="static-vs-instance-methods"></a><span data-ttu-id="a2b9d-125">靜態與執行個體方法</span><span class="sxs-lookup"><span data-stu-id="a2b9d-125">Static vs. Instance Methods</span></span>  
 <span data-ttu-id="a2b9d-126">定義規則運算式模式之後，您可以提供給規則運算式引擎在任一種方式：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-126">After you define a regular expression pattern, you can provide it to the regular expression engine in either of two ways:</span></span>  
  
-   <span data-ttu-id="a2b9d-127">藉由執行個體化<xref:System.Text.RegularExpressions.Regex>表示規則運算式物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-127">By instantiating a <xref:System.Text.RegularExpressions.Regex> object that represents the regular expression.</span></span> <span data-ttu-id="a2b9d-128">若要這樣做，您將傳遞至規則運算式模式<xref:System.Text.RegularExpressions.Regex.%23ctor%2A>建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-128">To do this, you pass the regular expression pattern to a <xref:System.Text.RegularExpressions.Regex.%23ctor%2A> constructor.</span></span> <span data-ttu-id="a2b9d-129">A<xref:System.Text.RegularExpressions.Regex>物件是不可變的; 當您具現化<xref:System.Text.RegularExpressions.Regex>規則運算式物件，無法變更物件的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-129">A <xref:System.Text.RegularExpressions.Regex> object is immutable; when you instantiate a <xref:System.Text.RegularExpressions.Regex> object with a regular expression, that object's regular expression cannot be changed.</span></span>  
  
-   <span data-ttu-id="a2b9d-130">藉由提供規則運算式和要搜尋的文字`static`(`Shared`在 Visual Basic 中)<xref:System.Text.RegularExpressions.Regex>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-130">By supplying both the regular expression and the text to search to a `static` (`Shared` in Visual Basic) <xref:System.Text.RegularExpressions.Regex> method.</span></span> <span data-ttu-id="a2b9d-131">這可讓您使用規則運算式，而不需要明確建立<xref:System.Text.RegularExpressions.Regex>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-131">This enables you to use a regular expression without explicitly creating a <xref:System.Text.RegularExpressions.Regex> object.</span></span>  
  
 <span data-ttu-id="a2b9d-132">所有<xref:System.Text.RegularExpressions.Regex>模式識別方法包含靜態和執行個體的多載。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-132">All <xref:System.Text.RegularExpressions.Regex> pattern identification methods include both static and instance overloads.</span></span>  
  
 <span data-ttu-id="a2b9d-133">規則運算式引擎必須編譯特定模式，才能使用此模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-133">The regular expression engine must compile a particular pattern before the pattern can be used.</span></span> <span data-ttu-id="a2b9d-134">因為<xref:System.Text.RegularExpressions.Regex>物件是不變，這是一次性程序，就會發生時<xref:System.Text.RegularExpressions.Regex>呼叫類別建構函式或靜態方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-134">Because <xref:System.Text.RegularExpressions.Regex> objects are immutable, this is a one-time procedure that occurs when a <xref:System.Text.RegularExpressions.Regex> class constructor or a static method is called.</span></span> <span data-ttu-id="a2b9d-135">若要消除重複編譯單一規則運算式的需要，規則運算式引擎會快取靜態方法呼叫中所編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-135">To eliminate the need to repeatedly compile a single regular expression, the regular expression engine caches the compiled regular expressions used in static method calls.</span></span> <span data-ttu-id="a2b9d-136">如此一來，規則運算式模式比對方法提供相當的效能，針對靜態和執行個體方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-136">As a result, regular expression pattern-matching methods offer comparable performance for static and instance methods.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="a2b9d-137">在.NET Framework 1.0 和 1.1 版，全都編譯規則運算式，是否使用這些認證執行個體或靜態方法中呼叫，快取。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-137">In the .NET Framework versions 1.0 and 1.1, all compiled regular expressions, whether they were used in instance or static method calls, were cached.</span></span> <span data-ttu-id="a2b9d-138">從.NET Framework 2.0 開始，只有在靜態方法呼叫中使用的規則運算式會快取。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-138">Starting with the .NET Framework 2.0, only regular expressions used in static method calls are cached.</span></span>  
  
 <span data-ttu-id="a2b9d-139">不過，快取效能造成不良影響下列兩個案例中：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-139">However, caching can adversely affect performance in the following two cases:</span></span>  
  
-   <span data-ttu-id="a2b9d-140">當您使用靜態方法呼叫，且含有大量規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-140">When you use static method calls with a large number of regular expressions.</span></span> <span data-ttu-id="a2b9d-141">根據預設，規則運算式引擎會快取 15 個最近使用靜態規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-141">By default, the regular expression engine caches the 15 most recently used static regular expressions.</span></span> <span data-ttu-id="a2b9d-142">如果您的應用程式會使用超過 15 個靜態規則運算式中，某些規則運算式就必須重新編譯。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-142">If your application uses more than 15 static regular expressions, some regular expressions must be recompiled.</span></span> <span data-ttu-id="a2b9d-143">若要避免此重新編譯，您可以增加<xref:System.Text.RegularExpressions.Regex.CacheSize%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-143">To prevent this recompilation, you can increase the <xref:System.Text.RegularExpressions.Regex.CacheSize%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="a2b9d-144">當您具現化新<xref:System.Text.RegularExpressions.Regex>使用先前已編譯的規則運算式物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-144">When you instantiate new <xref:System.Text.RegularExpressions.Regex> objects with regular expressions that have previously been compiled.</span></span> <span data-ttu-id="a2b9d-145">例如，下列程式碼定義規則運算式，在文字資料流中找到重複的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-145">For example, the following code defines a regular expression to locate duplicated words in a text stream.</span></span> <span data-ttu-id="a2b9d-146">雖然此範例會使用單一規則運算式，它會具現化新<xref:System.Text.RegularExpressions.Regex>物件以處理每一行文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-146">Although the example uses a single regular expression, it instantiates a new <xref:System.Text.RegularExpressions.Regex> object to process each line of text.</span></span> <span data-ttu-id="a2b9d-147">這會導致重新編譯的規則運算式與迴圈的每個反覆項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-147">This results in the recompilation of the regular expression with each iteration of the loop.</span></span>  
  
     [!code-csharp[System.Text.RegularExpressions.Class.Caching#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.class.caching/cs/caching1.cs#1)]
     [!code-vb[System.Text.RegularExpressions.Class.Caching#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.class.caching/vb/caching1.vb#1)]  
  
     <span data-ttu-id="a2b9d-148">若要避免重新編譯，您應該具現化單一<xref:System.Text.RegularExpressions.Regex>均可存取所有的程式碼時需要它，改寫下列範例所示的物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-148">To prevent recompilation, you should instantiate a single <xref:System.Text.RegularExpressions.Regex> object that is accessible to all code that requires it, as shown in the following rewritten example.</span></span>  
  
     [!code-csharp[System.Text.RegularExpressions.Class.Caching#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.class.caching/cs/caching1.cs#2)]
     [!code-vb[System.Text.RegularExpressions.Class.Caching#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.class.caching/vb/caching1.vb#2)]  
  
 [<span data-ttu-id="a2b9d-149">回註解</span><span class="sxs-lookup"><span data-stu-id="a2b9d-149">Back to Remarks</span></span>](#remarks)  
  
<a name="regex_ops"></a>   
## <a name="performing-regular-expression-operations"></a><span data-ttu-id="a2b9d-150">執行規則運算式作業</span><span class="sxs-lookup"><span data-stu-id="a2b9d-150">Performing Regular Expression Operations</span></span>  
 <span data-ttu-id="a2b9d-151">您是否決定具現化<xref:System.Text.RegularExpressions.Regex>物件，並呼叫其方法或呼叫靜態方法，<xref:System.Text.RegularExpressions.Regex>類別提供了下列的模式比對功能：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-151">Whether you decide to instantiate a <xref:System.Text.RegularExpressions.Regex> object and call its methods or call static methods, the <xref:System.Text.RegularExpressions.Regex> class offers the following pattern-matching functionality:</span></span>  
  
-   <span data-ttu-id="a2b9d-152">驗證的相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-152">Validation of a match.</span></span> <span data-ttu-id="a2b9d-153">您呼叫<xref:System.Text.RegularExpressions.Regex.IsMatch%2A>方法，以判斷是否有相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-153">You call the <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method to determine whether a match is present.</span></span>  
  
-   <span data-ttu-id="a2b9d-154">擷取單一相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-154">Retrieval of a single match.</span></span> <span data-ttu-id="a2b9d-155">您呼叫<xref:System.Text.RegularExpressions.Regex.Match%2A>方法來擷取<xref:System.Text.RegularExpressions.Match>物件，表示字串或部分字串的第一個相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-155">You call the <xref:System.Text.RegularExpressions.Regex.Match%2A> method to retrieve a <xref:System.Text.RegularExpressions.Match> object that represents the first match in a string or in part of a string.</span></span> <span data-ttu-id="a2b9d-156">可以藉由呼叫擷取後續相符項目的<xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-156">Subsequent matches can be retrieved by calling the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method.</span></span>  
  
-   <span data-ttu-id="a2b9d-157">擷取所有相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-157">Retrieval of all matches.</span></span> <span data-ttu-id="a2b9d-158">您呼叫<xref:System.Text.RegularExpressions.Regex.Matches%2A>方法來擷取<xref:System.Text.RegularExpressions.MatchCollection?displayProperty=nameWithType>物件，代表找到的字串或字串的部分的所有相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-158">You call the <xref:System.Text.RegularExpressions.Regex.Matches%2A> method to retrieve a <xref:System.Text.RegularExpressions.MatchCollection?displayProperty=nameWithType> object that represents all the matches found in a string or in part of a string.</span></span>  
  
-   <span data-ttu-id="a2b9d-159">取代相符的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-159">Replacement of matched text.</span></span> <span data-ttu-id="a2b9d-160">您呼叫<xref:System.Text.RegularExpressions.Regex.Replace%2A>方法，以取代相符的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-160">You call the <xref:System.Text.RegularExpressions.Regex.Replace%2A> method to replace matched text.</span></span> <span data-ttu-id="a2b9d-161">取代文字，也可以定義規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-161">The replacement text can also be defined by a regular expression.</span></span> <span data-ttu-id="a2b9d-162">此外，某些<xref:System.Text.RegularExpressions.Regex.Replace%2A>方法包括<xref:System.Text.RegularExpressions.MatchEvaluator>參數，可讓您以程式設計方式定義取代文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-162">In addition, some of the <xref:System.Text.RegularExpressions.Regex.Replace%2A> methods include a <xref:System.Text.RegularExpressions.MatchEvaluator> parameter that enables you to programmatically define the replacement text.</span></span>  
  
-   <span data-ttu-id="a2b9d-163">建立從輸入字串的組件的正確的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-163">Creation of a string array that is formed from parts of an input string.</span></span> <span data-ttu-id="a2b9d-164">您呼叫<xref:System.Text.RegularExpressions.Regex.Split%2A>方法來分割輸入的字串，在規則運算式所定義的位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-164">You call the <xref:System.Text.RegularExpressions.Regex.Split%2A> method to split an input string at positions that are defined by the regular expression.</span></span>  
  
 <span data-ttu-id="a2b9d-165">其模式比對的方法，除了<xref:System.Text.RegularExpressions.Regex>類別包含數種特殊用途的方法：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-165">In addition to its pattern-matching methods, the <xref:System.Text.RegularExpressions.Regex> class includes several special-purpose methods:</span></span>  
  
-   <span data-ttu-id="a2b9d-166"><xref:System.Text.RegularExpressions.Regex.Escape%2A>方法會逸出任何可能會解譯為規則運算式或輸入的字串中的規則運算式運算子的字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-166">The <xref:System.Text.RegularExpressions.Regex.Escape%2A> method escapes any characters that may be interpreted as regular expression operators in a regular expression or input string.</span></span>  
  
-   <span data-ttu-id="a2b9d-167"><xref:System.Text.RegularExpressions.Regex.Unescape%2A>方法會移除這些逸出字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-167">The <xref:System.Text.RegularExpressions.Regex.Unescape%2A> method removes these escape characters.</span></span>  
  
-   <span data-ttu-id="a2b9d-168"><xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A>方法會建立包含預先定義的規則運算式的組件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-168">The <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A> method creates an assembly that contains predefined regular expressions.</span></span> <span data-ttu-id="a2b9d-169">.NET Framework 中包含這些特殊用途的組件中的範例<xref:System.Web.RegularExpressions?displayProperty=nameWithType>命名空間。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-169">The .NET Framework contains examples of these special-purpose assemblies in the <xref:System.Web.RegularExpressions?displayProperty=nameWithType> namespace.</span></span>  
  
 [<span data-ttu-id="a2b9d-170">回註解</span><span class="sxs-lookup"><span data-stu-id="a2b9d-170">Back to Remarks</span></span>](#remarks)  
  
<a name="define_timeout"></a>   
## <a name="defining-a-time-out-value"></a><span data-ttu-id="a2b9d-171">定義逾時值</span><span class="sxs-lookup"><span data-stu-id="a2b9d-171">Defining a Time-Out Value</span></span>  
 <span data-ttu-id="a2b9d-172">.NET Framework 支援的功能完整的規則運算式語言提供大幅的功能及彈性在模式比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-172">The .NET Framework supports a full-featured regular expression language that provides substantial power and flexibility in pattern matching.</span></span> <span data-ttu-id="a2b9d-173">不過，功能與彈性有其代價： 效能不佳的風險。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-173">However, the power and flexibility come at a cost: the risk of poor performance.</span></span> <span data-ttu-id="a2b9d-174">執行效能很差的規則運算式是很容易建立。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-174">Regular expressions that perform poorly are surprisingly easy to create.</span></span> <span data-ttu-id="a2b9d-175">在某些情況下，可能會依賴大量回溯規則運算式作業停止回應時，它們會處理幾乎符合規則運算式模式的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-175">In some cases, regular expression operations that rely on excessive backtracking can appear to stop responding when they process text that nearly matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-176">如需.NET Framework 規則運算式引擎的詳細資訊，請參閱[規則運算式行為的詳細資料](~/docs/standard/base-types/details-of-regular-expression-behavior.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-176">For more information about the .NET Framework regular expression engine, see [Details of Regular Expression Behavior](~/docs/standard/base-types/details-of-regular-expression-behavior.md).</span></span> <span data-ttu-id="a2b9d-177">如需大量回溯的詳細資訊，請參閱[回溯](~/docs/standard/base-types/backtracking-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-177">For more information about excessive backtracking, see [Backtracking](~/docs/standard/base-types/backtracking-in-regular-expressions.md).</span></span>  
  
 <span data-ttu-id="a2b9d-178">從開始[!INCLUDE[net_v45](~/includes/net-v45-md.md)]，您可以定義逾時間隔，規則運算式相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-178">Starting with the [!INCLUDE[net_v45](~/includes/net-v45-md.md)], you can define a time-out interval for regular expression matches.</span></span> <span data-ttu-id="a2b9d-179">如果規則運算式引擎無法識別符合此時間間隔內，比對作業會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-179">If the regular expression engine cannot identify a match within this time interval, the matching operation throws a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-180">在大部分情況下，如此可防止規則運算式引擎嘗試比對幾乎符合規則運算式模式的文字所浪費的處理能力。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-180">In most cases, this prevents the regular expression engine from wasting processing power by trying to match text that nearly matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-181">它也可能表示，不過的逾時間隔已設定太低，或是目前機器工作負載的效能，導致整體的降低。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-181">It also could indicate, however, that the timeout interval has been set too low, or that the current machine load has caused an overall degradation in performance.</span></span>  
  
 <span data-ttu-id="a2b9d-182">處理例外狀況的方式取決於例外狀況的原因。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-182">How you handle the exception depends on the cause of the exception.</span></span> <span data-ttu-id="a2b9d-183">如果因為逾時間隔設定太低，就會發生例外狀況或因為過多的機器工作負載，您可以增加逾時間隔並重試比對作業。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-183">If the exception occurs because the time-out interval is set too low or because of excessive machine load, you can increase the time-out interval and retry the matching operation.</span></span> <span data-ttu-id="a2b9d-184">因為規則運算式會依賴大量回溯，就會發生例外狀況，您可以假設相符項目不存在，以及 （選擇性） 您可以記錄資訊可協助您修改規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-184">If the exception occurs because the regular expression relies on excessive backtracking, you can assume that a match does not exist, and, optionally, you can log information that will help you modify the regular expression pattern.</span></span>  
  
 <span data-ttu-id="a2b9d-185">您可以藉由呼叫設定逾時間隔<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>建構函式，當您具現化規則運算式物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-185">You can set a time-out interval by calling the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> constructor when you instantiate a regular expression object.</span></span> <span data-ttu-id="a2b9d-186">靜態方法，您可以設定逾時間隔，藉由呼叫的比對方法的多載`matchTimeout`參數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-186">For static methods, you can set a time-out interval by calling an overload of a matching method that has a `matchTimeout` parameter.</span></span> <span data-ttu-id="a2b9d-187">如果您未明確設定的逾時值，預設的逾時值是取決於下列條件：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-187">If you do not set a time-out value explicitly, the default time-out value  is determined as follows:</span></span>  
  
-   <span data-ttu-id="a2b9d-188">使用全應用程式逾時的值，如果有一個存在。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-188">By using the application-wide time-out value, if one exists.</span></span> <span data-ttu-id="a2b9d-189">這可以是應用程式定義域，適用於任何逾時值<xref:System.Text.RegularExpressions.Regex>物件具現化，或呼叫靜態方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-189">This can be any time-out value that applies to the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is instantiated or the static method call is made.</span></span> <span data-ttu-id="a2b9d-190">您可以設定整個應用程式的逾時值，藉由呼叫<xref:System.AppDomain.SetData%2A?displayProperty=nameWithType>方法，以指定的字串表示<xref:System.TimeSpan>"REGEX_DEFAULT_MATCH_TIMEOUT"屬性的值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-190">You can set the application-wide time-out value by calling the <xref:System.AppDomain.SetData%2A?displayProperty=nameWithType> method to assign the string representation of a <xref:System.TimeSpan> value to the "REGEX_DEFAULT_MATCH_TIMEOUT" property.</span></span>  
  
-   <span data-ttu-id="a2b9d-191">使用的值來<xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout>，如果已設定沒有整個應用程式的逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-191">By using the value <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout>, if no application-wide time-out value has been set.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="a2b9d-192">我們建議您在所有的規則運算式模式比對作業設定的逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-192">We recommend that you set a time-out value in all regular expression pattern-matching operations.</span></span> <span data-ttu-id="a2b9d-193">如需詳細資訊，請參閱[規則運算式的最佳作法](~/docs/standard/base-types/best-practices.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-193">For more information, see [Best Practices for Regular Expressions](~/docs/standard/base-types/best-practices.md).</span></span>  
  
 [<span data-ttu-id="a2b9d-194">回註解</span><span class="sxs-lookup"><span data-stu-id="a2b9d-194">Back to Remarks</span></span>](#remarks)  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-195">下列範例會使用規則運算式，檢查有重複出現的文字字串中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-195">The following example uses a regular expression to check for repeated occurrences of words in a string.</span></span> <span data-ttu-id="a2b9d-196">規則運算式`\b(?<word>\w+)\s+(\k<word>)\b`可以解譯為下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-196">The regular expression `\b(?<word>\w+)\s+(\k<word>)\b` can be interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-197">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-197">Pattern</span></span>|<span data-ttu-id="a2b9d-198">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-198">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="a2b9d-199">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-199">Start the match at a word boundary.</span></span>|  
|`(?<word>\w+)`|<span data-ttu-id="a2b9d-200">比對一個或多個文字字元，最多字邊界。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-200">Match one or more word characters up to a word boundary.</span></span> <span data-ttu-id="a2b9d-201">將此擷取的群組命名`word`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-201">Name this captured group `word`.</span></span>|  
|`\s+`|<span data-ttu-id="a2b9d-202">比對一個或多個空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-202">Match one or more white-space characters.</span></span>|  
|`(\k<word>)`|<span data-ttu-id="a2b9d-203">比對擷取的群組命名`word`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-203">Match the captured group that is named `word`.</span></span>|  
|`\b`|<span data-ttu-id="a2b9d-204">比對字邊界。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-204">Match a word boundary.</span></span>|  
  
 [!code-cpp[Regex_Words#0](~/samples/snippets/cpp/VS_Snippets_CLR/Regex_Words/CPP/words.cpp#0)]
 [!code-csharp[Regex_Words#0](~/samples/snippets/csharp/VS_Snippets_CLR/Regex_Words/CS/words.cs#0)]
 [!code-vb[Regex_Words#0](~/samples/snippets/visualbasic/VS_Snippets_CLR/Regex_Words/VB/words.vb#0)]  
  
 <span data-ttu-id="a2b9d-205">下列範例說明如何使用規則運算式以檢查是否為字串表示貨幣值，或者具有正確格式來表示貨幣值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-205">The following example illustrates the use of a regular expression to check whether a string either represents a currency value or has the correct format to represent a currency value.</span></span> <span data-ttu-id="a2b9d-206">在此情況下，規則運算式，會動態建立從<xref:System.Globalization.NumberFormatInfo.CurrencyDecimalSeparator%2A?displayProperty=nameWithType>， <xref:System.Globalization.NumberFormatInfo.CurrencyDecimalDigits%2A>， <xref:System.Globalization.NumberFormatInfo.CurrencySymbol%2A?displayProperty=nameWithType>， <xref:System.Globalization.NumberFormatInfo.NegativeSign%2A?displayProperty=nameWithType>，和<xref:System.Globalization.NumberFormatInfo.PositiveSign%2A?displayProperty=nameWithType>使用者的目前文化特性的屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-206">In this case, the regular expression is built dynamically from the <xref:System.Globalization.NumberFormatInfo.CurrencyDecimalSeparator%2A?displayProperty=nameWithType>, <xref:System.Globalization.NumberFormatInfo.CurrencyDecimalDigits%2A>, <xref:System.Globalization.NumberFormatInfo.CurrencySymbol%2A?displayProperty=nameWithType>, <xref:System.Globalization.NumberFormatInfo.NegativeSign%2A?displayProperty=nameWithType>, and <xref:System.Globalization.NumberFormatInfo.PositiveSign%2A?displayProperty=nameWithType> properties for the user's current culture.</span></span> <span data-ttu-id="a2b9d-207">如果系統的目前文化特性是 EN-US，產生的規則運算式是`^\s*[\+-]?\s?\$?\s?(\d*\.?\d{2}?){1}$`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-207">If the system's current culture is en-US, the resulting regular expression is `^\s*[\+-]?\s?\$?\s?(\d*\.?\d{2}?){1}$`.</span></span> <span data-ttu-id="a2b9d-208">下表所示，可以解譯這個規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-208">This regular expression can be interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-209">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-209">Pattern</span></span>|<span data-ttu-id="a2b9d-210">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-210">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="a2b9d-211">在字串開頭開始。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-211">Start at the beginning of the string.</span></span>|  
|`\s*`|<span data-ttu-id="a2b9d-212">比對零個以上的空白字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-212">Match zero or more white-space characters.</span></span>|  
|`[\+-]?`|<span data-ttu-id="a2b9d-213">比對零個或一個正號或負號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-213">Match zero or one occurrence of either the positive sign or the negative sign.</span></span>|  
|`\s?`|<span data-ttu-id="a2b9d-214">比對零個或一個空白字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-214">Match zero or one white-space character.</span></span>|  
|`\$?`|<span data-ttu-id="a2b9d-215">比對零個或一個貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-215">Match zero or one occurrence of the dollar sign.</span></span>|  
|`\s?`|<span data-ttu-id="a2b9d-216">比對零個或一個空白字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-216">Match zero or one white-space character.</span></span>|  
|`\d*`|<span data-ttu-id="a2b9d-217">比對零個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-217">Match zero or more decimal digits.</span></span>|  
|`\.?`|<span data-ttu-id="a2b9d-218">比對零個或一個小數點符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-218">Match zero or one decimal point symbol.</span></span>|  
|`\d{2}?`|<span data-ttu-id="a2b9d-219">比對兩個十進位數字零或一次。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-219">Match two decimal digits zero or one time.</span></span>|  
|`(\d*\.?\d{2}?){1}`|<span data-ttu-id="a2b9d-220">比對整數和小數的位數，小數點符號分隔至少一次的模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-220">Match the pattern of integral and fractional digits separated by a decimal point symbol at least one time.</span></span>|  
|`$`|<span data-ttu-id="a2b9d-221">比對字串的結尾。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-221">Match the end of the string.</span></span>|  
  
 <span data-ttu-id="a2b9d-222">在此情況下，規則運算式假設有效貨幣字串不包含群組分隔符號符號，而且它有沒有小數的數字或目前的文化特性所定義的小數位數<xref:System.Globalization.NumberFormatInfo.CurrencyDecimalDigits%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-222">In this case, the regular expression assumes that a valid currency string does not contain group separator symbols, and that it has either no fractional digits or the number of fractional digits defined by the current culture's <xref:System.Globalization.NumberFormatInfo.CurrencyDecimalDigits%2A> property.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Class#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.class/cs/regex_example1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Class#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.class/vb/regex_example1.vb#1)]  
  
 <span data-ttu-id="a2b9d-223">在此範例中的規則運算式，會動態建立，因為我們不知道在設計階段是否目前文化特性的貨幣符號、 小數符號或正的和負號可能會被錯誤解譯規則運算式引擎為規則運算式語言運算子。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-223">Because the regular expression in this example is built dynamically, we do not know at design time whether the current culture's currency symbol, decimal sign, or positive and negative signs might be misinterpreted by the regular expression engine as regular expression language operators.</span></span> <span data-ttu-id="a2b9d-224">若要防止任何的錯譯，範例會傳遞至每個動態產生的字串<xref:System.Text.RegularExpressions.Regex.Escape%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-224">To prevent any misinterpretation, the example passes each dynamically generated string to the <xref:System.Text.RegularExpressions.Regex.Escape%2A> method.</span></span>  
  
 ]]></format>
    </remarks>
    <threadsafe><span data-ttu-id="a2b9d-225"><see cref="T:System.Text.RegularExpressions.Regex" />類別是不變 （唯讀） 和安全執行緒。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-225">The <see cref="T:System.Text.RegularExpressions.Regex" /> class is immutable (read-only) and thread safe.</span></span> <span data-ttu-id="a2b9d-226"><see cref="T:System.Text.RegularExpressions.Regex" /> 可以在任何執行緒上建立和執行緒之間共用物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-226"><see cref="T:System.Text.RegularExpressions.Regex" /> objects can be created on any thread and shared between threads.</span></span> <span data-ttu-id="a2b9d-227">如需詳細資訊，請參閱[的執行緒安全](~/docs/standard/base-types/thread-safety-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-227">For more information, see [Thread Safety](~/docs/standard/base-types/thread-safety-in-regular-expressions.md).</span></span></threadsafe>
    <altmember cref="T:System.Configuration.RegexStringValidator" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="a2b9d-228">初始化 <see cref="T:System.Text.RegularExpressions.Regex" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-228">Initializes a new instance of the <see cref="T:System.Text.RegularExpressions.Regex" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="protected Regex ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.#ctor" />
      <MemberSignature Language="VB.NET" Value="Protected Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; Regex();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="a2b9d-229">初始化 <see cref="T:System.Text.RegularExpressions.Regex" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-229">Initializes a new instance of the <see cref="T:System.Text.RegularExpressions.Regex" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-230">請注意，這個建構函式會保護;只可以呼叫的類別衍生自<xref:System.Text.RegularExpressions.Regex>類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-230">Note that this constructor is protected; it can only be called by classes derived from the <xref:System.Text.RegularExpressions.Regex> class.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public Regex (string pattern);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string pattern) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (pattern As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; Regex(System::String ^ pattern);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="pattern" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="pattern"><span data-ttu-id="a2b9d-231">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-231">The regular expression pattern to match.</span></span></param>
        <summary><span data-ttu-id="a2b9d-232">為指定的規則運算式初始化 <see cref="T:System.Text.RegularExpressions.Regex" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-232">Initializes a new instance of the <see cref="T:System.Text.RegularExpressions.Regex" /> class for the specified regular expression.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-233">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-233">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-234">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)主題。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-234">For more information about regular expressions, see the [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md) topics.</span></span>  
  
 <span data-ttu-id="a2b9d-235">呼叫<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%29>建構函式相當於呼叫<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%29>建構函式，其值為<xref:System.Text.RegularExpressions.RegexOptions.None>如`options`引數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-235">Calling the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%29> constructor is equivalent to calling the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%29> constructor with a value of <xref:System.Text.RegularExpressions.RegexOptions.None> for the `options` argument.</span></span>  
  
 <span data-ttu-id="a2b9d-236">A<xref:System.Text.RegularExpressions.Regex>物件是不可變的這表示它可以用僅適用於您定義您所建立的比對模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-236">A <xref:System.Text.RegularExpressions.Regex> object is immutable, which means that it can be used only for the match pattern you define when you create it.</span></span> <span data-ttu-id="a2b9d-237">不過，它可以單獨使用任意數目的時間而沒有重新編譯。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-237">However, it can be used any number of times without being recompiled.</span></span>  
  
 <span data-ttu-id="a2b9d-238">這個建構函式會嘗試定義中的任何字母字元的區分大小寫比對規則運算式物件具現化`pattern`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-238">This constructor instantiates a regular expression object that attempts a case-sensitive match of any alphabetical characters defined in `pattern`.</span></span> <span data-ttu-id="a2b9d-239">不區分大小寫的比對中，使用<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType>建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-239">For a case-insensitive match, use the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-240">下列範例說明如何使用這個建構函式來具現化規則運算式比對任何以字母開頭的單字，"a"或"t"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-240">The following example illustrates how to use this constructor to instantiate a regular expression that matches any word that begins with the letters "a" or "t".</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Constructors#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Constructors/cs/constructors1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Constructors#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Constructors/vb/constructors1.vb#1)]  
  
 <span data-ttu-id="a2b9d-241">請注意，規則運算式模式，無法比對的字"The"開頭的文字，因為比較會區分大小寫預設值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-241">Note that the regular expression pattern cannot match the word "The" at the beginning of the text, because comparisons are case-sensitive by default.</span></span> <span data-ttu-id="a2b9d-242">例如不區分大小寫的比較中，請參閱<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%29>建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-242">For an example of case-insensitive comparison, see the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%29> constructor.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-243">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-243">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-244"><paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-244"><paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-245">這個建構函式會建立<see cref="T:System.Text.RegularExpressions.Regex" />會使用預設的逾時值，在其中建立的應用程式定義域的物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-245">This constructor creates a <see cref="T:System.Text.RegularExpressions.Regex" /> object that uses the default time-out value of the application domain in which it is created.</span></span> <span data-ttu-id="a2b9d-246">如果尚未應用程式定義域定義逾時值<see cref="T:System.Text.RegularExpressions.Regex" />物件會使用值<see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，這樣就不會逾時的作業。建立建議建構函式<see cref="T:System.Text.RegularExpressions.Regex" />物件是<see cref="M:System.Text.RegularExpressions.Regex.#ctor(System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-246">If a time-out value has not been defined for the application domain,  the <see cref="T:System.Text.RegularExpressions.Regex" /> object uses the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the operation from timing out. The recommended constructor for creating a <see cref="T:System.Text.RegularExpressions.Regex" /> object is <see cref="M:System.Text.RegularExpressions.Regex.#ctor(System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you set the time-out interval.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="protected Regex (System.Runtime.Serialization.SerializationInfo info, System.Runtime.Serialization.StreamingContext context);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig specialname rtspecialname instance void .ctor(class System.Runtime.Serialization.SerializationInfo info, valuetype System.Runtime.Serialization.StreamingContext context) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.#ctor(System.Runtime.Serialization.SerializationInfo,System.Runtime.Serialization.StreamingContext)" />
      <MemberSignature Language="VB.NET" Value="Protected Sub New (info As SerializationInfo, context As StreamingContext)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; Regex(System::Runtime::Serialization::SerializationInfo ^ info, System::Runtime::Serialization::StreamingContext context);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="info" Type="System.Runtime.Serialization.SerializationInfo" />
        <Parameter Name="context" Type="System.Runtime.Serialization.StreamingContext" />
      </Parameters>
      <Docs>
        <param name="info"><span data-ttu-id="a2b9d-247">包含序列化模式和 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 資訊的物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-247">The object that contains a serialized pattern and <see cref="T:System.Text.RegularExpressions.RegexOptions" /> information.</span></span></param>
        <param name="context"><span data-ttu-id="a2b9d-248">這個序列化的目的端。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-248">The destination for this serialization.</span></span> <span data-ttu-id="a2b9d-249">(不使用這個參數；請指定 <see langword="null" />)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-249">(This parameter is not used; specify <see langword="null" />.)</span></span></param>
        <summary><span data-ttu-id="a2b9d-250">使用序列化的資料，初始化 <see cref="T:System.Text.RegularExpressions.Regex" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-250">Initializes a new instance of the <see cref="T:System.Text.RegularExpressions.Regex" /> class by using serialized data.</span></span></summary>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-251">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-251">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="a2b9d-252"><paramref name="info" /> 包含的模式為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-252">The pattern that <paramref name="info" /> contains is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-253"><paramref name="info" /> 包含無效的 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 旗標。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-253"><paramref name="info" /> contains an invalid <see cref="T:System.Text.RegularExpressions.RegexOptions" /> flag.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public Regex (string pattern, System.Text.RegularExpressions.RegexOptions options);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string pattern, valuetype System.Text.RegularExpressions.RegexOptions options) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.#ctor(System.String,System.Text.RegularExpressions.RegexOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (pattern As String, options As RegexOptions)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; Regex(System::String ^ pattern, System::Text::RegularExpressions::RegexOptions options);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
      </Parameters>
      <Docs>
        <param name="pattern"><span data-ttu-id="a2b9d-254">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-254">The regular expression pattern to match.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-255">列舉值的位元組合，這些值會修改規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-255">A bitwise combination of the enumeration values that modify the regular expression.</span></span></param>
        <summary><span data-ttu-id="a2b9d-256">使用會修改模式的選項，為指定的規則運算式初始化 <see cref="T:System.Text.RegularExpressions.Regex" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-256">Initializes a new instance of the <see cref="T:System.Text.RegularExpressions.Regex" /> class for the specified regular expression, with options that modify the pattern.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-257">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-257">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-258">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)主題。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-258">For more information about regular expressions, see the [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md) topics.</span></span>  
  
 <span data-ttu-id="a2b9d-259">A<xref:System.Text.RegularExpressions.Regex>物件是不可變的這表示它可以用僅適用於您定義您所建立的比對參數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-259">A <xref:System.Text.RegularExpressions.Regex> object is immutable, which means that it can be used only for the match parameters you define when you create it.</span></span> <span data-ttu-id="a2b9d-260">不過，它可以單獨使用任意數目的時間而沒有重新編譯。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-260">However, it can be used any number of times without being recompiled.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-261">下列範例說明如何使用這個建構函式來具現化規則運算式比對任何以字母開頭的單字，"a"或"t"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-261">The following example illustrates how to use this constructor to instantiate a regular expression that matches any word that begins with the letters "a" or "t".</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Constructors#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Constructors/cs/Constructors2.cs#2)]
 [!code-vb[System.Text.RegularExpressions.Regex.Constructors#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Constructors/vb/Constructors2.vb#2)]  
  
 <span data-ttu-id="a2b9d-262">請注意比對集合包含文字"The"開頭的文字，因為`options`已定義參數不區分大小寫的比較。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-262">Note that the match collection includes the word "The" that begins the text because the `options` parameter has defined case-insensitive comparisons.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-263">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-263">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-264"><paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-264"><paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-265"><paramref name="options" /> 包含無效的旗標。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-265"><paramref name="options" /> contains an invalid flag.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-266">這個建構函式會建立<see cref="T:System.Text.RegularExpressions.Regex" />會使用預設的逾時值，在其中建立的應用程式定義域的物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-266">This constructor creates a <see cref="T:System.Text.RegularExpressions.Regex" /> object that uses the default time-out value of the application domain in which it is created.</span></span> <span data-ttu-id="a2b9d-267">如果尚未應用程式定義域定義逾時值<see cref="T:System.Text.RegularExpressions.Regex" />物件會使用值<see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，這樣就不會逾時的作業。建立建議建構函式<see cref="T:System.Text.RegularExpressions.Regex" />物件是<see cref="M:System.Text.RegularExpressions.Regex.#ctor(System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-267">If a time-out value has not been defined for the application domain, the <see cref="T:System.Text.RegularExpressions.Regex" /> object uses the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the operation from timing out. The recommended constructor for creating a <see cref="T:System.Text.RegularExpressions.Regex" /> object is <see cref="M:System.Text.RegularExpressions.Regex.#ctor(System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you set the time-out interval.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public Regex (string pattern, System.Text.RegularExpressions.RegexOptions options, TimeSpan matchTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string pattern, valuetype System.Text.RegularExpressions.RegexOptions options, valuetype System.TimeSpan matchTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.#ctor(System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (pattern As String, options As RegexOptions, matchTimeout As TimeSpan)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; Regex(System::String ^ pattern, System::Text::RegularExpressions::RegexOptions options, TimeSpan matchTimeout);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
        <Parameter Name="matchTimeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="pattern"><span data-ttu-id="a2b9d-268">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-268">The regular expression pattern to match.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-269">列舉值的位元組合，這些值會修改規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-269">A bitwise combination of the enumeration values that modify the regular expression.</span></span></param>
        <param name="matchTimeout"><span data-ttu-id="a2b9d-270">間隔，若要表示此方法不會逾時則為 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-270">A time-out interval, or <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" /> to indicate that the method should not time out.</span></span></param>
        <summary><span data-ttu-id="a2b9d-271">針對指定的規則運算式，使用修改模式的選項，以及指定在逾時前模式比對方法應該嘗試比對的時間長度的值，初始化 <see cref="T:System.Text.RegularExpressions.Regex" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-271">Initializes a new instance of the <see cref="T:System.Text.RegularExpressions.Regex" /> class for the specified regular expression, with options that modify the pattern and a value that specifies how long a pattern matching method should attempt a match before it times out.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-272">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-272">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-273">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)主題。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-273">For more information about regular expressions, see the [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md) topics.</span></span>  
  
 <span data-ttu-id="a2b9d-274">A<xref:System.Text.RegularExpressions.Regex>物件是不可變的這表示它可以用僅適用於您定義當您建立比對模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-274">A <xref:System.Text.RegularExpressions.Regex> object is immutable, which means that it can be used only for the match pattern that you define when you create it.</span></span> <span data-ttu-id="a2b9d-275">不過，它可以單獨使用任意數目的時間而沒有重新編譯。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-275">However, it can be used any number of times without being recompiled.</span></span>  
  
 <span data-ttu-id="a2b9d-276">`matchTimeout`參數指定時間長度的模式比對方法應嘗試尋找相符項目，即會逾時。如果沒有找到符合該時間間隔中，會擲回的模式比對方法<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-276">The `matchTimeout` parameter specifies how long a pattern-matching method should try to find a match before it times out. If no match is found in that time interval, the pattern-matching method throws a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-277">`matchTimeout` 覆寫任何預設逾時值為應用程式定義域，定義<xref:System.Text.RegularExpressions.Regex>建立物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-277">`matchTimeout` overrides any default time-out value defined for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-278">執行個體模式比對方法觀察`matchTimeout`逾時間隔包括下列：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-278">The instance pattern-matching methods that observe the `matchTimeout` time-out interval include the following:</span></span>  
  
-   <xref:System.Text.RegularExpressions.Regex.IsMatch%2A>  
  
-   <xref:System.Text.RegularExpressions.Regex.Match%2A>  
  
-   <xref:System.Text.RegularExpressions.Regex.Matches%2A>  
  
-   <xref:System.Text.RegularExpressions.Regex.Replace%2A>  
  
-   <xref:System.Text.RegularExpressions.Regex.Split%2A>  
  
-   <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="a2b9d-279">設定逾時間隔可避免依賴大量回溯出現停止回應時，它們會處理輸入的規則運算式，其中包含相符項目附近。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-279">Setting a time-out interval prevents regular expressions that rely on excessive backtracking from appearing to stop responding when they process input that contains near matches.</span></span> <span data-ttu-id="a2b9d-280">如需詳細資訊，請參閱[規則運算式的最佳作法](~/docs/standard/base-types/best-practices.md)和[回溯](~/docs/standard/base-types/backtracking-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-280">For more information, see [Best Practices for Regular Expressions](~/docs/standard/base-types/best-practices.md) and [Backtracking](~/docs/standard/base-types/backtracking-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-281">若要設定的合理的逾時間隔，請考慮下列因素：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-281">To set a reasonable time-out interval, consider the following factors:</span></span>  
  
-   <span data-ttu-id="a2b9d-282">長度與複雜度的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-282">The length and complexity of the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-283">長、 更複雜的規則運算式會需要更多的時間比短且更簡單。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-283">Longer and more complex regular expressions require more time than shorter and simpler ones.</span></span>  
  
-   <span data-ttu-id="a2b9d-284">預期的機器工作負載。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-284">The expected machine load.</span></span> <span data-ttu-id="a2b9d-285">在 CPU 和記憶體使用率過高的系統上處理花費的時間。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-285">Processing takes more time on systems that have high CPU and memory utilization.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-286">下列範例會呼叫<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>建構函式來具現化<xref:System.Text.RegularExpressions.Regex>逾時值為一秒的物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-286">The following example calls the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> constructor to instantiate a <xref:System.Text.RegularExpressions.Regex> object with a time-out value of one second.</span></span> <span data-ttu-id="a2b9d-287">規則運算式模式 `(a+)+$`會在行尾比對一個或多個 "a" 字元的一個或多個序列，並且受限於大量回溯。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-287">The regular expression pattern `(a+)+$`, which matches one or more sequences of one or more "a" characters at the end of a line, is subject to excessive backtracking.</span></span> <span data-ttu-id="a2b9d-288">如果<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>會擲回，則範例會增加逾時值，最多三秒的最大值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-288">If a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> is thrown, the example increases the time-out value up to the maximum value of three seconds.</span></span> <span data-ttu-id="a2b9d-289">否則，它會放棄嘗試比對模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-289">Otherwise, it abandons the attempt to match the pattern.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.ctor#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ctor/cs/ctor1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.ctor#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ctor/vb/ctor1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-290">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-290">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-291"><paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-291"><paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-292"><paramref name="options" /> 不是有效的 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-292"><paramref name="options" /> is not a valid <see cref="T:System.Text.RegularExpressions.RegexOptions" /> value.</span></span>  
  
 <span data-ttu-id="a2b9d-293">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-293">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-294"><paramref name="matchTimeout" /> 為負數、零或大約大於 24 天。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-294"><paramref name="matchTimeout" /> is negative, zero, or greater than approximately 24 days.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-295">我們建議您將<paramref name="matchTimeout" />參數，以適當的值，例如兩秒。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-295">We recommend that you set the <paramref name="matchTimeout" /> parameter to an appropriate value, such as two seconds.</span></span> <span data-ttu-id="a2b9d-296">如果您停用逾時指定<see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，規則運算式引擎會提供稍微較佳的效能。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-296">If you disable time-outs by specifying <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, the regular expression engine offers slightly better performance.</span></span> <span data-ttu-id="a2b9d-297">不過，您應該停用逾時，只有在下列情況下：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-297">However, you should disable time-outs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="a2b9d-298">當規則運算式所處理的輸入衍生自已知且受信任的來源，或包含靜態文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-298">When the input processed by a regular expression is derived from a known and trusted source or consists of static text.</span></span> <span data-ttu-id="a2b9d-299">這不包括已動態使用者所輸入的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-299">This excludes text that has been dynamically input by users.</span></span>  
  
-   <span data-ttu-id="a2b9d-300">當規則運算式模式已徹底測試以確保它有效率地處理符合，不符合，不久符合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-300">When the regular expression pattern has been thoroughly tested to ensure that it efficiently handles matches, non-matches, and near matches.</span></span>  
  
-   <span data-ttu-id="a2b9d-301">當規則運算式模式包含已知會造成大量回溯處理接近的相符項目時沒有語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-301">When the regular expression pattern contains no language elements that are known to cause excessive backtracking when processing a near match.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="CacheSize">
      <MemberSignature Language="C#" Value="public static int CacheSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property int32 CacheSize" />
      <MemberSignature Language="DocId" Value="P:System.Text.RegularExpressions.Regex.CacheSize" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property CacheSize As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property int CacheSize { int get(); void set(int value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-302">取得或設定在已編譯規則運算式目前靜態快取中項目的最大數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-302">Gets or sets the maximum number of entries in the current static cache of compiled regular expressions.</span></span></summary>
        <value><span data-ttu-id="a2b9d-303">靜態快取中項目的最大數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-303">The maximum number of entries in the static cache.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-304"><xref:System.Text.RegularExpressions.Regex>類別會維護內部快取已編譯的規則運算式的靜態方法呼叫中使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-304">The <xref:System.Text.RegularExpressions.Regex> class maintains an internal cache of compiled regular expressions used in static method calls.</span></span> <span data-ttu-id="a2b9d-305">如果在設定作業中指定的值小於目前的快取大小，快取項目都會被捨棄，直到快取大小是否等於指定的值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-305">If the value specified in a set operation is less than the current cache size, cache entries are discarded until the cache size is equal to the specified value.</span></span>  
  
 <span data-ttu-id="a2b9d-306">根據預設，快取保存 15 編譯靜態規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-306">By default, the cache holds 15 compiled static regular expressions.</span></span> <span data-ttu-id="a2b9d-307">您的應用程式通常不會修改快取的大小。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-307">Your application typically will not have to modify the size of the cache.</span></span> <span data-ttu-id="a2b9d-308">使用<xref:System.Text.RegularExpressions.Regex.CacheSize%2A>屬性只有當您想要關閉 快取，或當您有非常大的快取。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-308">Use the <xref:System.Text.RegularExpressions.Regex.CacheSize%2A> property only when you want to turn off caching or when you have an unusually large cache.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="a2b9d-309">設定作業中的值小於零。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-309">The value in a set operation is less than zero.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-310">在.NET Framework 之前[!INCLUDE[net_v20SP1_short](~/includes/net-v20sp1-short-md.md)]、 使用中這兩個靜態規則運算式和快取執行個體方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-310">In the .NET Framework prior to the [!INCLUDE[net_v20SP1_short](~/includes/net-v20sp1-short-md.md)], regular expressions used in both static and instance method calls were cached.</span></span> <span data-ttu-id="a2b9d-311">開頭為[!INCLUDE[net_v20SP1_short](~/includes/net-v20sp1-short-md.md)]、 規則只會快取靜態方法呼叫中使用的運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-311">Beginning with the [!INCLUDE[net_v20SP1_short](~/includes/net-v20sp1-short-md.md)], only regular expressions used in static method calls are cached.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="capnames">
      <MemberSignature Language="C#" Value="protected internal System.Collections.Hashtable capnames;" />
      <MemberSignature Language="ILAsm" Value=".field familyorassembly class System.Collections.Hashtable capnames" />
      <MemberSignature Language="DocId" Value="F:System.Text.RegularExpressions.Regex.capnames" />
      <MemberSignature Language="VB.NET" Value="Protected Friend capnames As Hashtable " />
      <MemberSignature Language="C++ CLI" Value="protected public: System::Collections::Hashtable ^ capnames;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.Hashtable</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-312">由 <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> 方法所產生的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-312">Used by a <see cref="T:System.Text.RegularExpressions.Regex" /> object generated by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="CapNames">
      <MemberSignature Language="C#" Value="protected System.Collections.IDictionary CapNames { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Collections.IDictionary CapNames" />
      <MemberSignature Language="DocId" Value="P:System.Text.RegularExpressions.Regex.CapNames" />
      <MemberSignature Language="VB.NET" Value="Protected Property CapNames As IDictionary" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; property System::Collections::IDictionary ^ CapNames { System::Collections::IDictionary ^ get(); void set(System::Collections::IDictionary ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.CLSCompliant(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.IDictionary</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-313">取得或設定字典，對應具名擷取群組及其索引值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-313">Gets or sets a dictionary that maps named capturing groups to their index values.</span></span></summary>
        <value><span data-ttu-id="a2b9d-314">對應具名擷取群組及其索引值的字典。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-314">A dictionary that maps named capturing groups to their index values.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-315">請注意，這個屬性受到保護。它只能從衍生自的類別存取<xref:System.Text.RegularExpressions.Regex>類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-315">Note that this property is protected; it can only be accessed from a class derived from the <xref:System.Text.RegularExpressions.Regex> class.</span></span>  
  
 <span data-ttu-id="a2b9d-316">設定作業會嘗試將指派給屬性的值<xref:System.Collections.Hashtable>物件; 如果這個轉換會失敗，則會呼叫<xref:System.Collections.Hashtable.%23ctor%28System.Collections.IDictionary%29?displayProperty=nameWithType>建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-316">A set operation attempts to convert the value assigned to the property to a <xref:System.Collections.Hashtable> object; if this conversion fails, it calls the <xref:System.Collections.Hashtable.%23ctor%28System.Collections.IDictionary%29?displayProperty=nameWithType> constructor.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="a2b9d-317">在設定作業中指派給 <see cref="P:System.Text.RegularExpressions.Regex.CapNames" /> 的屬性值是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-317">The value assigned to the <see cref="P:System.Text.RegularExpressions.Regex.CapNames" /> property in a set operation is <see langword="null" />.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="caps">
      <MemberSignature Language="C#" Value="protected internal System.Collections.Hashtable caps;" />
      <MemberSignature Language="ILAsm" Value=".field familyorassembly class System.Collections.Hashtable caps" />
      <MemberSignature Language="DocId" Value="F:System.Text.RegularExpressions.Regex.caps" />
      <MemberSignature Language="VB.NET" Value="Protected Friend caps As Hashtable " />
      <MemberSignature Language="C++ CLI" Value="protected public: System::Collections::Hashtable ^ caps;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.Hashtable</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-318">由 <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> 方法所產生的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-318">Used by a <see cref="T:System.Text.RegularExpressions.Regex" /> object generated by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="Caps">
      <MemberSignature Language="C#" Value="protected System.Collections.IDictionary Caps { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Collections.IDictionary Caps" />
      <MemberSignature Language="DocId" Value="P:System.Text.RegularExpressions.Regex.Caps" />
      <MemberSignature Language="VB.NET" Value="Protected Property Caps As IDictionary" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; property System::Collections::IDictionary ^ Caps { System::Collections::IDictionary ^ get(); void set(System::Collections::IDictionary ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.CLSCompliant(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.IDictionary</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-319">取得或設定字典，對應編號的擷取群組及其索引值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-319">Gets or sets a dictionary that maps numbered capturing groups to their index values.</span></span></summary>
        <value><span data-ttu-id="a2b9d-320">對應編號的擷取群組及其索引值的字典。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-320">A dictionary that maps numbered capturing groups to their index values.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-321">請注意，這個屬性受到保護。它只能從衍生自的類別存取<xref:System.Text.RegularExpressions.Regex>類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-321">Note that this property is protected; it can only be accessed from a class derived from the <xref:System.Text.RegularExpressions.Regex> class.</span></span>  
  
 <span data-ttu-id="a2b9d-322">設定作業會嘗試將指派給屬性的值<xref:System.Collections.Hashtable>物件; 如果這個轉換會失敗，則會呼叫<xref:System.Collections.Hashtable.%23ctor%28System.Collections.IDictionary%29?displayProperty=nameWithType>建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-322">A set operation attempts to convert the value assigned to the property to a <xref:System.Collections.Hashtable> object; if this conversion fails, it calls the <xref:System.Collections.Hashtable.%23ctor%28System.Collections.IDictionary%29?displayProperty=nameWithType> constructor.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="a2b9d-323">在設定作業中指派給 <see cref="P:System.Text.RegularExpressions.Regex.Caps" /> 的屬性值是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-323">The value assigned to the <see cref="P:System.Text.RegularExpressions.Regex.Caps" /> property in a set operation is <see langword="null" />.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="capsize">
      <MemberSignature Language="C#" Value="protected internal int capsize;" />
      <MemberSignature Language="ILAsm" Value=".field familyorassembly int32 capsize" />
      <MemberSignature Language="DocId" Value="F:System.Text.RegularExpressions.Regex.capsize" />
      <MemberSignature Language="VB.NET" Value="Protected Friend capsize As Integer " />
      <MemberSignature Language="C++ CLI" Value="protected public: int capsize;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-324">由 <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> 方法所產生的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-324">Used by a <see cref="T:System.Text.RegularExpressions.Regex" /> object generated by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="capslist">
      <MemberSignature Language="C#" Value="protected internal string[] capslist;" />
      <MemberSignature Language="ILAsm" Value=".field familyorassembly string[] capslist" />
      <MemberSignature Language="DocId" Value="F:System.Text.RegularExpressions.Regex.capslist" />
      <MemberSignature Language="VB.NET" Value="Protected Friend capslist As String() " />
      <MemberSignature Language="C++ CLI" Value="protected public: cli::array &lt;System::String ^&gt; ^ capslist;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-325">由 <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> 方法所產生的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-325">Used by a <see cref="T:System.Text.RegularExpressions.Regex" /> object generated by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="CompileToAssembly">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="a2b9d-326">編譯規則運算式並將它們以單一組件 (Assembly) 儲存至磁碟。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-326">Compiles regular expressions and saves them to disk in a single assembly.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CompileToAssembly">
      <MemberSignature Language="C#" Value="public static void CompileToAssembly (System.Text.RegularExpressions.RegexCompilationInfo[] regexinfos, System.Reflection.AssemblyName assemblyname);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CompileToAssembly(class System.Text.RegularExpressions.RegexCompilationInfo[] regexinfos, class System.Reflection.AssemblyName assemblyname) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CompileToAssembly(cli::array &lt;System::Text::RegularExpressions::RegexCompilationInfo ^&gt; ^ regexinfos, System::Reflection::AssemblyName ^ assemblyname);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="regexinfos" Type="System.Text.RegularExpressions.RegexCompilationInfo[]" />
        <Parameter Name="assemblyname" Type="System.Reflection.AssemblyName" />
      </Parameters>
      <Docs>
        <param name="regexinfos"><span data-ttu-id="a2b9d-327">陣列，描述要編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-327">An array that describes the regular expressions to compile.</span></span></param>
        <param name="assemblyname"><span data-ttu-id="a2b9d-328">組件的檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-328">The file name of the assembly.</span></span></param>
        <summary><span data-ttu-id="a2b9d-329">將一個或多個指定的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件編譯為具名組件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-329">Compiles one or more specified <see cref="T:System.Text.RegularExpressions.Regex" /> objects to a named assembly.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-330"><xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%29>方法產生.NET Framework 組件中定義的每個規則運算式中`regexinfos`陣列由類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-330">The <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%29> method generates a .NET Framework assembly in which each regular expression defined in the `regexinfos` array is represented by a class.</span></span> <span data-ttu-id="a2b9d-331">一般而言，<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%29>方法從個別的應用程式會產生編譯的規則運算式的組件呼叫。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-331">Typically, the <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%29> method is called from a separate application that generates an assembly of compiled regular expressions.</span></span> <span data-ttu-id="a2b9d-332">每個規則運算式包含在組件具有下列特性：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-332">Each regular expression included in the assembly has the following characteristics:</span></span>  
  
-   <span data-ttu-id="a2b9d-333">它衍生自<xref:System.Text.RegularExpressions.Regex>類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-333">It is derived from the <xref:System.Text.RegularExpressions.Regex> class.</span></span>  
  
-   <span data-ttu-id="a2b9d-334">它指派由所定義的完整限定的名稱`fullnamespace`和`name`參數對應<xref:System.Text.RegularExpressions.RegexCompilationInfo>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-334">It is assigned the fully qualified name that is defined by the `fullnamespace` and `name` parameters of its corresponding <xref:System.Text.RegularExpressions.RegexCompilationInfo> object.</span></span>  
  
-   <span data-ttu-id="a2b9d-335">它有預設值 （或無參數） 建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-335">It has a default (or parameterless) constructor.</span></span>  
  
 <span data-ttu-id="a2b9d-336">一般情況下，組件或應用程式分開建立組件的程式碼中找到的程式碼會具現化，並使用已編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-336">Ordinarily, the code that instantiates and uses the compiled regular expression is found in an assembly or application that is separate from the code that creates the assembly.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-337">下列範例會建立名為 RegexLib.dll 組件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-337">The following example creates an assembly named RegexLib.dll.</span></span> <span data-ttu-id="a2b9d-338">組件包含兩個已編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-338">The assembly includes two compiled regular expressions.</span></span> <span data-ttu-id="a2b9d-339">首先， `Utilities.RegularExpressions.DuplicatedString`，比對兩個相同的連續文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-339">The first, `Utilities.RegularExpressions.DuplicatedString`, matches two identical contiguous words.</span></span> <span data-ttu-id="a2b9d-340">第二個， `Utilities.RegularExpressions.EmailAddress`，會檢查字串是否具有正確的格式為電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-340">The second, `Utilities.RegularExpressions.EmailAddress`, checks whether a string has the correct format to be an email address.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.CompileToAssembly#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.CompileToAssembly/cs/Compile1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.CompileToAssembly#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.CompileToAssembly/vb/Compile1.vb#1)]  
  
 <span data-ttu-id="a2b9d-341">然後具現化並使用下列範例會檢查重複的文字字串的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-341">The regular expression that checks a string for duplicate words is then instantiated and used by the following example.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.CompileToAssembly#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.CompileToAssembly/cs/Compile2.cs#2)]
 [!code-vb[System.Text.RegularExpressions.Regex.CompileToAssembly#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.CompileToAssembly/vb/Compile2.vb#2)]  
  
 <span data-ttu-id="a2b9d-342">成功編譯此第二個範例需要的 RegexLib.dll （第一個範例所建立組件） 的參考加入至專案。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-342">Successful compilation of this second example requires a reference to RegexLib.dll (the assembly created by the first example) to be added to the project.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-343"><paramref name="assemblyname" /> 參數的 <see cref="P:System.Reflection.AssemblyName.Name" /> 屬性值為空字串或 null 字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-343">The value of the <paramref name="assemblyname" /> parameter's <see cref="P:System.Reflection.AssemblyName.Name" /> property is an empty or null string.</span></span>  
  
 <span data-ttu-id="a2b9d-344">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-344">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-345"><paramref name="regexinfos" /> 中一個或多個物件的規則運算式模式包含無效的語法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-345">The regular expression pattern of one or more objects in <paramref name="regexinfos" /> contains invalid syntax.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-346"><paramref name="assemblyname" /> 或 <paramref name="regexinfos" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-346"><paramref name="assemblyname" /> or <paramref name="regexinfos" /> is <see langword="null" />.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-347">如果您正在開發具有的系統上[!INCLUDE[net_v45](~/includes/net-v45-md.md)]或其點發行版本安裝目標[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]，而且您使用<see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" />方法來建立包含的組件編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-347">If you are developing on a system that has [!INCLUDE[net_v45](~/includes/net-v45-md.md)] or its point releases installed, you target [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)], and you use the <see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" /> method to create an assembly that contains compiled regular expressions.</span></span> <span data-ttu-id="a2b9d-348">嘗試使用其中一種規則運算式，因為在系統上的組件具有[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-348">Trying to use one of the regular expressions in that assembly on a system that has [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] throws an exception.</span></span> <span data-ttu-id="a2b9d-349">若要解決這個問題，您可以執行下列任何一項操作：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-349">To work around this problem, you can do either of the following:</span></span>  
  
-   <span data-ttu-id="a2b9d-350">建置組件，其中包含已在系統上編譯的規則運算式[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]而不是安裝的更新版本。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-350">Build the assembly that contains the compiled regular expressions on a system that has [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] instead of later versions installed.</span></span>  
  
-   <span data-ttu-id="a2b9d-351">而不是呼叫<see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" />，擷取已編譯的規則運算式的組件時，使用靜態或執行個體<see cref="T:System.Text.RegularExpressions.Regex" />方法<see cref="F:System.Text.RegularExpressions.RegexOptions.Compiled" />選項，當您具現化<see cref="T:System.Text.RegularExpressions.Regex" />物件或呼叫規則運算式模式比對方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-351">Instead of calling <see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" /> and retrieving the compiled regular expression from an assembly, use either static or instance <see cref="T:System.Text.RegularExpressions.Regex" /> methods with the <see cref="F:System.Text.RegularExpressions.RegexOptions.Compiled" /> option when you instantiate a <see cref="T:System.Text.RegularExpressions.Regex" /> object or call a regular expression pattern matching method.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="CompileToAssembly">
      <MemberSignature Language="C#" Value="public static void CompileToAssembly (System.Text.RegularExpressions.RegexCompilationInfo[] regexinfos, System.Reflection.AssemblyName assemblyname, System.Reflection.Emit.CustomAttributeBuilder[] attributes);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CompileToAssembly(class System.Text.RegularExpressions.RegexCompilationInfo[] regexinfos, class System.Reflection.AssemblyName assemblyname, class System.Reflection.Emit.CustomAttributeBuilder[] attributes) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName,System.Reflection.Emit.CustomAttributeBuilder[])" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CompileToAssembly(cli::array &lt;System::Text::RegularExpressions::RegexCompilationInfo ^&gt; ^ regexinfos, System::Reflection::AssemblyName ^ assemblyname, cli::array &lt;System::Reflection::Emit::CustomAttributeBuilder ^&gt; ^ attributes);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="regexinfos" Type="System.Text.RegularExpressions.RegexCompilationInfo[]" />
        <Parameter Name="assemblyname" Type="System.Reflection.AssemblyName" />
        <Parameter Name="attributes" Type="System.Reflection.Emit.CustomAttributeBuilder[]" />
      </Parameters>
      <Docs>
        <param name="regexinfos"><span data-ttu-id="a2b9d-352">陣列，描述要編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-352">An array that describes the regular expressions to compile.</span></span></param>
        <param name="assemblyname"><span data-ttu-id="a2b9d-353">組件的檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-353">The file name of the assembly.</span></span></param>
        <param name="attributes"><span data-ttu-id="a2b9d-354">陣列，定義要套用至組件的屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-354">An array that defines the attributes to apply to the assembly.</span></span></param>
        <summary><span data-ttu-id="a2b9d-355">將一個或多個指定的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件編譯為具有指定之屬性的具名組件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-355">Compiles one or more specified <see cref="T:System.Text.RegularExpressions.Regex" /> objects to a named assembly with the specified attributes.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-356"><xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%29>方法產生.NET Framework 組件中定義的每個規則運算式中`regexinfos`陣列由類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-356">The <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%29> method generates a .NET Framework assembly in which each regular expression defined in the `regexinfos` array is represented by a class.</span></span> <span data-ttu-id="a2b9d-357">一般而言，<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%29>方法從個別的應用程式會產生編譯的規則運算式的組件呼叫。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-357">Typically, the <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%29> method is called from a separate application that generates an assembly of compiled regular expressions.</span></span> <span data-ttu-id="a2b9d-358">每個規則運算式包含在組件具有下列特性：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-358">Each regular expression included in the assembly has the following characteristics:</span></span>  
  
-   <span data-ttu-id="a2b9d-359">它衍生自<xref:System.Text.RegularExpressions.Regex>類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-359">It is derived from the <xref:System.Text.RegularExpressions.Regex> class.</span></span>  
  
-   <span data-ttu-id="a2b9d-360">它指派由所定義的完整限定的名稱`fullnamespace`和`name`參數對應<xref:System.Text.RegularExpressions.RegexCompilationInfo>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-360">It is assigned the fully qualified name that is defined by the `fullnamespace` and `name` parameters of its corresponding <xref:System.Text.RegularExpressions.RegexCompilationInfo> object.</span></span>  
  
-   <span data-ttu-id="a2b9d-361">它有預設值 （或無參數） 建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-361">It has a default (or parameterless) constructor.</span></span>  
  
 <span data-ttu-id="a2b9d-362">一般情況下，組件或應用程式分開建立組件的程式碼中找到的程式碼會具現化，並使用已編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-362">Ordinarily, the code that instantiates and uses the compiled regular expression is found in an assembly or application that is separate from the code that creates the assembly.</span></span>  
  
 <span data-ttu-id="a2b9d-363">因為<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A>方法會產生在方法呼叫，而不是使用特定語言的類別定義關鍵字的.NET Framework 組件 (例如`class`在 C# 或`Class`...`End Class`</span><span class="sxs-lookup"><span data-stu-id="a2b9d-363">Because the <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A> method generates a .NET Framework assembly from a method call instead of using a particular language's class definition keyword (such as `class` in C# or `Class`…`End Class`</span></span> <span data-ttu-id="a2b9d-364">在 Visual Basic 中)，所以不允許使用的開發語言的標準屬性語法來指派給組件的.NET Framework 屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-364">in Visual Basic), it does not allow .NET Framework attributes to be assigned to the assembly by using the development language's standard attribute syntax.</span></span> <span data-ttu-id="a2b9d-365">`attributes`參數提供的替代方法，用於定義套用至組件的屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-365">The `attributes` parameter provides an alternative method for defining the attributes that apply to the assembly.</span></span> <span data-ttu-id="a2b9d-366">針對每個您想要套用至組件的屬性，執行下列作業：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-366">For each attribute that you want to apply to the assembly, do the following:</span></span>  
  
1.  <span data-ttu-id="a2b9d-367">建立陣列<xref:System.Type>代表您想要呼叫的屬性建構函式的參數類型的物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-367">Create an array of <xref:System.Type> objects representing the parameter types of the attribute constructor that you want to call.</span></span>  
  
2.  <span data-ttu-id="a2b9d-368">擷取<xref:System.Type>物件，代表您想要套用至新的組件的屬性類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-368">Retrieve a <xref:System.Type> object representing the attribute class that you want to apply to the new assembly.</span></span>  
  
3.  <span data-ttu-id="a2b9d-369">呼叫<xref:System.Type.GetConstructor%2A>方法屬性的<xref:System.Type>物件，以擷取<xref:System.Reflection.ConstructorInfo>物件，代表您想要呼叫的屬性建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-369">Call the <xref:System.Type.GetConstructor%2A> method of the attribute <xref:System.Type> object to retrieve a <xref:System.Reflection.ConstructorInfo> object representing the attribute constructor that you want to call.</span></span> <span data-ttu-id="a2b9d-370">傳遞<xref:System.Type.GetConstructor%2A>方法陣列的<xref:System.Type>代表建構函式的參數類型的物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-370">Pass the <xref:System.Type.GetConstructor%2A> method the array of <xref:System.Type> objects that represents the constructor's parameter types.</span></span>  
  
4.  <span data-ttu-id="a2b9d-371">建立<xref:System.Object>陣列，定義要傳遞給該屬性的建構函式的參數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-371">Create a <xref:System.Object> array that defines the parameters to pass to the attribute's constructor.</span></span>  
  
5.  <span data-ttu-id="a2b9d-372">具現化<xref:System.Reflection.Emit.CustomAttributeBuilder>物件，並傳遞其建構函式<xref:System.Reflection.ConstructorInfo>步驟 3 中所擷取的物件和<xref:System.Object>在步驟 4 建立的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-372">Instantiate a <xref:System.Reflection.Emit.CustomAttributeBuilder> object by passing its constructor the <xref:System.Reflection.ConstructorInfo> object retrieved in step 3 and the <xref:System.Object> array created in step 4.</span></span>  
  
 <span data-ttu-id="a2b9d-373">接著，您可以將這些陣列<xref:System.Reflection.Emit.CustomAttributeBuilder>物件而不是`attributes`參數<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-373">You can then pass an array of these <xref:System.Reflection.Emit.CustomAttributeBuilder> objects instead of the `attributes` parameter to the <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%29?displayProperty=nameWithType> method.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-374">下列範例會建立名為 RegexLib.dll 組件，並套用<xref:System.Reflection.AssemblyTitleAttribute>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-374">The following example creates an assembly named RegexLib.dll and applies the <xref:System.Reflection.AssemblyTitleAttribute> attribute to it.</span></span> <span data-ttu-id="a2b9d-375">組件包含兩個已編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-375">The assembly includes two compiled regular expressions.</span></span> <span data-ttu-id="a2b9d-376">首先， `Utilities.RegularExpressions.DuplicatedString`，比對兩個相同的連續文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-376">The first, `Utilities.RegularExpressions.DuplicatedString`, matches two identical contiguous words.</span></span> <span data-ttu-id="a2b9d-377">第二個， `Utilities.RegularExpressions.EmailAddress`，會檢查字串是否具有正確的格式為電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-377">The second, `Utilities.RegularExpressions.EmailAddress`, checks whether a string has the correct format to be an email address.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.CompileToAssembly#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.CompileToAssembly/cs/Compile3.cs#3)]
 [!code-vb[System.Text.RegularExpressions.Regex.CompileToAssembly#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.CompileToAssembly/vb/Compile3.vb#3)]  
  
 <span data-ttu-id="a2b9d-378">您可以確認<xref:System.Reflection.AssemblyTitleAttribute>藉由檢查它的資訊清單，以反映公用程式，例如 ILDasm 屬性套用至組件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-378">You can verify that the <xref:System.Reflection.AssemblyTitleAttribute> attribute has been applied to the assembly by examining its manifest with a reflection utility such as ILDasm.</span></span>  
  
 <span data-ttu-id="a2b9d-379">然後具現化並使用下列範例會檢查重複的文字字串的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-379">The regular expression that checks a string for duplicate words is then instantiated and used by the following example.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.CompileToAssembly#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.CompileToAssembly/cs/Compile2.cs#2)]
 [!code-vb[System.Text.RegularExpressions.Regex.CompileToAssembly#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.CompileToAssembly/vb/Compile2.vb#2)]  
  
 <span data-ttu-id="a2b9d-380">成功編譯此第二個範例需要的 RegexLib.dll （第一個範例所建立組件） 的參考加入至專案。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-380">Successful compilation of this second example requires a reference to RegexLib.dll (the assembly created by the first example) to be added to the project.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-381"><paramref name="assemblyname" /> 參數的 <see cref="P:System.Reflection.AssemblyName.Name" /> 屬性值為空字串或 null 字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-381">The value of the <paramref name="assemblyname" /> parameter's <see cref="P:System.Reflection.AssemblyName.Name" /> property is an empty or null string.</span></span>  
  
 <span data-ttu-id="a2b9d-382">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-382">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-383"><paramref name="regexinfos" /> 中一個或多個物件的規則運算式模式包含無效的語法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-383">The regular expression pattern of one or more objects in <paramref name="regexinfos" /> contains invalid syntax.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-384"><paramref name="assemblyname" /> 或 <paramref name="regexinfos" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-384"><paramref name="assemblyname" /> or <paramref name="regexinfos" /> is <see langword="null" />.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-385">如果您正在開發具有的系統上[!INCLUDE[net_v45](~/includes/net-v45-md.md)]或其點發行版本安裝目標[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]，而且您使用<see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" />方法來建立包含的組件編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-385">If you are developing on a system that has [!INCLUDE[net_v45](~/includes/net-v45-md.md)] or its point releases installed, you target [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)], and you use the <see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" /> method to create an assembly that contains compiled regular expressions.</span></span> <span data-ttu-id="a2b9d-386">嘗試使用其中一種規則運算式，因為在系統上的組件具有[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-386">Trying to use one of the regular expressions in that assembly on a system that has [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] throws an exception.</span></span> <span data-ttu-id="a2b9d-387">若要解決這個問題，您可以執行下列任何一項操作：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-387">To work around this problem, you can do either of the following:</span></span>  
  
-   <span data-ttu-id="a2b9d-388">建置組件，其中包含已在系統上編譯的規則運算式[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]而不是安裝的更新版本。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-388">Build the assembly that contains the compiled regular expressions on a system that has [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] instead of later versions installed.</span></span>  
  
-   <span data-ttu-id="a2b9d-389">而不是呼叫<see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" />，擷取已編譯的規則運算式的組件時，使用靜態或執行個體<see cref="T:System.Text.RegularExpressions.Regex" />方法<see cref="F:System.Text.RegularExpressions.RegexOptions.Compiled" />選項，當您具現化<see cref="T:System.Text.RegularExpressions.Regex" />物件或呼叫規則運算式模式比對方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-389">Instead of calling <see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" /> and retrieving the compiled regular expression from an assembly, use either static or instance <see cref="T:System.Text.RegularExpressions.Regex" /> methods with the <see cref="F:System.Text.RegularExpressions.RegexOptions.Compiled" /> option when you instantiate a <see cref="T:System.Text.RegularExpressions.Regex" /> object or call a regular expression pattern matching method.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="CompileToAssembly">
      <MemberSignature Language="C#" Value="public static void CompileToAssembly (System.Text.RegularExpressions.RegexCompilationInfo[] regexinfos, System.Reflection.AssemblyName assemblyname, System.Reflection.Emit.CustomAttributeBuilder[] attributes, string resourceFile);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CompileToAssembly(class System.Text.RegularExpressions.RegexCompilationInfo[] regexinfos, class System.Reflection.AssemblyName assemblyname, class System.Reflection.Emit.CustomAttributeBuilder[] attributes, string resourceFile) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName,System.Reflection.Emit.CustomAttributeBuilder[],System.String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CompileToAssembly(cli::array &lt;System::Text::RegularExpressions::RegexCompilationInfo ^&gt; ^ regexinfos, System::Reflection::AssemblyName ^ assemblyname, cli::array &lt;System::Reflection::Emit::CustomAttributeBuilder ^&gt; ^ attributes, System::String ^ resourceFile);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="regexinfos" Type="System.Text.RegularExpressions.RegexCompilationInfo[]" />
        <Parameter Name="assemblyname" Type="System.Reflection.AssemblyName" />
        <Parameter Name="attributes" Type="System.Reflection.Emit.CustomAttributeBuilder[]" />
        <Parameter Name="resourceFile" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="regexinfos"><span data-ttu-id="a2b9d-390">陣列，描述要編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-390">An array that describes the regular expressions to compile.</span></span></param>
        <param name="assemblyname"><span data-ttu-id="a2b9d-391">組件的檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-391">The file name of the assembly.</span></span></param>
        <param name="attributes"><span data-ttu-id="a2b9d-392">陣列，定義要套用至組件的屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-392">An array that defines the attributes to apply to the assembly.</span></span></param>
        <param name="resourceFile"><span data-ttu-id="a2b9d-393">要包括在組件中的 Win32 資源檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-393">The name of the Win32 resource file to include in the assembly.</span></span></param>
        <summary><span data-ttu-id="a2b9d-394">將一個或多個指定的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件和指定的資源檔編譯為具有指定之屬性的具名組件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-394">Compiles one or more specified <see cref="T:System.Text.RegularExpressions.Regex" /> objects and a specified resource file to a named assembly with the specified attributes.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-395">[\]，AssemblyName、 CustomAttributeBuilder\<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%2CSystem.String%29 > 方法會產生.NET Framework 組件中定義的每個規則運算式中`regexinfos`陣列由類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-395">The [\], AssemblyName, CustomAttributeBuilder\<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%2CSystem.String%29> method generates a .NET Framework assembly in which each regular expression defined in the `regexinfos` array is represented by a class.</span></span> <span data-ttu-id="a2b9d-396">一般而言，[\]，AssemblyName、 CustomAttributeBuilder\<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%2CSystem.String%29 > 方法呼叫從個別的應用程式會產生編譯的規則運算式的組件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-396">Typically, the [\], AssemblyName, CustomAttributeBuilder\<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%2CSystem.String%29> method is called from a separate application that generates an assembly of compiled regular expressions.</span></span> <span data-ttu-id="a2b9d-397">每個規則運算式包含在組件具有下列特性：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-397">Each regular expression included in the assembly has the following characteristics:</span></span>  
  
-   <span data-ttu-id="a2b9d-398">它衍生自<xref:System.Text.RegularExpressions.Regex>類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-398">It is derived from the <xref:System.Text.RegularExpressions.Regex> class.</span></span>  
  
-   <span data-ttu-id="a2b9d-399">它指派由所定義的完整限定的名稱`fullnamespace`和`name`參數對應<xref:System.Text.RegularExpressions.RegexCompilationInfo>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-399">It is assigned the fully qualified name that is defined by the `fullnamespace` and `name` parameters of its corresponding <xref:System.Text.RegularExpressions.RegexCompilationInfo> object.</span></span>  
  
-   <span data-ttu-id="a2b9d-400">它有預設值 （或無參數） 建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-400">It has a default (or parameterless) constructor.</span></span>  
  
 <span data-ttu-id="a2b9d-401">一般情況下，組件或應用程式分開建立組件的程式碼中找到的程式碼會具現化，並使用已編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-401">Ordinarily, the code that instantiates and uses the compiled regular expression is found in an assembly or application that is separate from the code that creates the assembly.</span></span>  
  
 <span data-ttu-id="a2b9d-402">因為<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A>方法會產生在方法呼叫，而不是使用特定語言的類別定義關鍵字的.NET Framework 組件 (例如`class`在 C# 或`Class`...`End Class`</span><span class="sxs-lookup"><span data-stu-id="a2b9d-402">Because the <xref:System.Text.RegularExpressions.Regex.CompileToAssembly%2A> method generates a .NET Framework assembly from a method call instead of using a particular language's class definition keyword (such as `class` in C# or `Class`…`End Class`</span></span> <span data-ttu-id="a2b9d-403">在 Visual Basic 中)，所以不允許使用的開發語言的標準屬性語法來指派給組件的.NET Framework 屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-403">in Visual Basic), it does not allow .NET Framework attributes to be assigned to the assembly by using the development language's standard attribute syntax.</span></span> <span data-ttu-id="a2b9d-404">`attributes`參數提供的替代方法，用於定義套用至組件的屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-404">The `attributes` parameter provides an alternative method for defining the attributes that apply to the assembly.</span></span> <span data-ttu-id="a2b9d-405">針對每個您想要套用至組件的屬性，執行下列作業：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-405">For each attribute that you want to apply to the assembly, do the following:</span></span>  
  
1.  <span data-ttu-id="a2b9d-406">建立陣列<xref:System.Type>代表您想要呼叫的屬性建構函式的參數類型的物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-406">Create an array of <xref:System.Type> objects representing the parameter types of the attribute constructor that you want to call.</span></span>  
  
2.  <span data-ttu-id="a2b9d-407">擷取<xref:System.Type>物件，代表您想要套用至新的組件的屬性類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-407">Retrieve a <xref:System.Type> object representing the attribute class that you want to apply to the new assembly.</span></span>  
  
3.  <span data-ttu-id="a2b9d-408">呼叫<xref:System.Type.GetConstructor%2A>方法屬性的<xref:System.Type>物件，以擷取<xref:System.Reflection.ConstructorInfo>物件，代表您想要呼叫的屬性建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-408">Call the <xref:System.Type.GetConstructor%2A> method of the attribute <xref:System.Type> object to retrieve a <xref:System.Reflection.ConstructorInfo> object representing the attribute constructor that you want to call.</span></span> <span data-ttu-id="a2b9d-409">傳遞<xref:System.Type.GetConstructor%2A>方法陣列的<xref:System.Type>物件代表建構函式的參數類型</span><span class="sxs-lookup"><span data-stu-id="a2b9d-409">Pass the <xref:System.Type.GetConstructor%2A> method the array of <xref:System.Type> objects that represents the constructor's parameter types</span></span>  
  
4.  <span data-ttu-id="a2b9d-410">建立<xref:System.Object>陣列，定義要傳遞給該屬性的建構函式的參數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-410">Create a <xref:System.Object> array that defines the parameters to pass to the attribute's constructor.</span></span>  
  
5.  <span data-ttu-id="a2b9d-411">具現化<xref:System.Reflection.Emit.CustomAttributeBuilder>物件，並傳遞其建構函式<xref:System.Reflection.ConstructorInfo>步驟 3 中所擷取的物件和<xref:System.Object>在步驟 4 建立的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-411">Instantiate a <xref:System.Reflection.Emit.CustomAttributeBuilder> object by passing its constructor the <xref:System.Reflection.ConstructorInfo> object retrieved in step 3 and the <xref:System.Object> array created in step 4.</span></span>  
  
 <span data-ttu-id="a2b9d-412">接著，您可以將這些陣列<xref:System.Reflection.Emit.CustomAttributeBuilder>物件而不是`attributes`參數 [\]，AssemblyName、 CustomAttributeBuilder\<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%2CSystem.String%29 > 方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-412">You can then pass an array of these <xref:System.Reflection.Emit.CustomAttributeBuilder> objects instead of the `attributes` parameter to the [\], AssemblyName, CustomAttributeBuilder\<xref:System.Text.RegularExpressions.Regex.CompileToAssembly%28System.Text.RegularExpressions.RegexCompilationInfo%5B%5D%2CSystem.Reflection.AssemblyName%2CSystem.Reflection.Emit.CustomAttributeBuilder%5B%5D%2CSystem.String%29> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-413"><paramref name="assemblyname" /> 參數的 <see cref="P:System.Reflection.AssemblyName.Name" /> 屬性值為空字串或 null 字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-413">The value of the <paramref name="assemblyname" /> parameter's <see cref="P:System.Reflection.AssemblyName.Name" /> property is an empty or null string.</span></span>  
  
 <span data-ttu-id="a2b9d-414">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-414">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-415"><paramref name="regexinfos" /> 中一個或多個物件的規則運算式模式包含無效的語法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-415">The regular expression pattern of one or more objects in <paramref name="regexinfos" /> contains invalid syntax.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-416"><paramref name="assemblyname" /> 或 <paramref name="regexinfos" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-416"><paramref name="assemblyname" /> or <paramref name="regexinfos" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.COMException"><span data-ttu-id="a2b9d-417"><paramref name="resourceFile" /> 參數指定不正確的 Win32 資源檔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-417">The <paramref name="resourceFile" /> parameter designates an invalid Win32 resource file.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="a2b9d-418">找不到 <paramref name="resourceFile" /> 參數所指定的檔案。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-418">The file designated by the <paramref name="resourceFile" /> parameter cannot be found.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-419">如果您正在開發具有的系統上[!INCLUDE[net_v45](~/includes/net-v45-md.md)]或其點發行版本安裝目標[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]，而且您使用<see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" />方法來建立包含的組件編譯的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-419">If you are developing on a system that has [!INCLUDE[net_v45](~/includes/net-v45-md.md)] or its point releases installed, you target [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)], and you use the <see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" /> method to create an assembly that contains compiled regular expressions.</span></span> <span data-ttu-id="a2b9d-420">嘗試使用其中一種規則運算式，因為在系統上的組件具有[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-420">Trying to use one of the regular expressions in that assembly on a system that has [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] throws an exception.</span></span> <span data-ttu-id="a2b9d-421">若要解決這個問題，您可以執行下列任何一項操作：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-421">To work around this problem, you can do either of the following:</span></span>  
  
-   <span data-ttu-id="a2b9d-422">建置組件，其中包含已在系統上編譯的規則運算式[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]而不是安裝的更新版本。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-422">Build the assembly that contains the compiled regular expressions on a system that has [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] instead of later versions installed.</span></span>  
  
-   <span data-ttu-id="a2b9d-423">而不是呼叫<see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" />，擷取已編譯的規則運算式的組件時，使用靜態或執行個體<see cref="T:System.Text.RegularExpressions.Regex" />方法<see cref="F:System.Text.RegularExpressions.RegexOptions.Compiled" />選項，當您具現化<see cref="T:System.Text.RegularExpressions.Regex" />物件或呼叫規則運算式模式比對方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-423">Instead of calling <see cref="M:System.Text.RegularExpressions.Regex.CompileToAssembly(System.Text.RegularExpressions.RegexCompilationInfo[],System.Reflection.AssemblyName)" /> and retrieving the compiled regular expression from an assembly, use either static or instance <see cref="T:System.Text.RegularExpressions.Regex" /> methods with the <see cref="F:System.Text.RegularExpressions.RegexOptions.Compiled" /> option when you instantiate a <see cref="T:System.Text.RegularExpressions.Regex" /> object or call a regular expression pattern matching method.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="Escape">
      <MemberSignature Language="C#" Value="public static string Escape (string str);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string Escape(string str) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Escape(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Escape (str As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Escape(System::String ^ str);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="str" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="str"><span data-ttu-id="a2b9d-424">輸入字串，包含要轉換的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-424">The input string that contains the text to convert.</span></span></param>
        <summary><span data-ttu-id="a2b9d-425">以逸出程式碼取代字元 (\\、\*、+、?、|、{、[、(、)、^、$、.、# 和空白字元) 的最小集合，以便逸出這些字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-425">Escapes a minimal set of characters (\\, \*, +, ?, |, {, [, (,), ^, $,., #, and white space) by replacing them with their escape codes.</span></span> <span data-ttu-id="a2b9d-426">這樣會指示規則運算式引擎將這些字元解譯為常值，而非解譯為中繼字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-426">This instructs the regular expression engine to interpret these characters literally rather than as metacharacters.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-427">字元字串，其中中繼字元已轉換為逸出格式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-427">A string of characters with metacharacters converted to their escaped form.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-428"><xref:System.Text.RegularExpressions.Regex.Escape%2A> 將字串轉換，讓規則運算式引擎會解譯為字元常值，它可以包含任何中繼字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-428"><xref:System.Text.RegularExpressions.Regex.Escape%2A> converts a string so that the regular expression engine will interpret any metacharacters that it may contain as character literals.</span></span> <span data-ttu-id="a2b9d-429">例如，請考慮為了擷取由直線左右方括號 （[和]） 從文字分隔的註解的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-429">For example, consider a regular expression that is designed to extract comments that are delimited by straight opening and closing brackets ([ and ]) from text.</span></span> <span data-ttu-id="a2b9d-430">在下列範例中，規則運算式 「 [(.\*?)]"會解譯為字元類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-430">In the following example, the regular expression "[(.\*?)]" is interpreted as a character class.</span></span> <span data-ttu-id="a2b9d-431">而不是比對輸入的文字中內嵌的註解，規則運算式比對每個左或右括號、 句號、 星號或問號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-431">Rather than matching comments embedded in the input text, the regular expression matches each opening or closing parenthesis, period, asterisk, or question mark.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Escape#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Escape/cs/Escape1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Escape#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Escape/vb/Escape1.vb#1)]  
  
 <span data-ttu-id="a2b9d-432">不過，如果左括號會傳遞至逸出<xref:System.Text.RegularExpressions.Regex.Escape%2A>方法時，規則運算式成功比對輸入字串中內嵌的註解。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-432">However, if the opening bracket is escaped by passing it to the <xref:System.Text.RegularExpressions.Regex.Escape%2A> method, the regular expression succeeds in matching comments that are embedded in the input string.</span></span> <span data-ttu-id="a2b9d-433">下列範例將說明這點。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-433">The following example illustrates this.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Escape#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Escape/cs/Escape1.cs#2)]
 [!code-vb[System.Text.RegularExpressions.Regex.Escape#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Escape/vb/Escape1.vb#2)]  
  
 <span data-ttu-id="a2b9d-434">在使用靜態文字定義規則運算式中，要解譯為字面意義，而不是為中繼字元的字元可以逸出前加上反斜線符號 (\\) 以及透過呼叫<xref:System.Text.RegularExpressions.Regex.Escape%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-434">In a regular expression that is defined by using static text, characters that are to be interpreted literally rather than as metacharacters can be escaped by preceding them with a backslash symbol (\\) as well as by calling the <xref:System.Text.RegularExpressions.Regex.Escape%2A> method.</span></span> <span data-ttu-id="a2b9d-435">使用在設計階段未知的字元，以動態方式定義的規則運算式中呼叫<xref:System.Text.RegularExpressions.Regex.Escape%2A>方法是特別重要，以確保，規則運算式引擎會解譯個別字元當做常值而不是比為中繼字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-435">In a regular expression that is defined dynamically using characters that are not known at design time, calling the <xref:System.Text.RegularExpressions.Regex.Escape%2A> method is particularly important to ensure that the regular expression engine interprets individual characters as literals rather than as metacharacters.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a2b9d-436">如果規則運算式模式包含數字符號 （#） 或常值空白字元，則必須逸出如果輸入的文字會剖析具有<xref:System.Text.RegularExpressions.RegexOptions.IgnorePatternWhitespace?displayProperty=nameWithType>啟用選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-436">If a regular expression pattern includes either the number sign (#) or literal white-space characters, they must be escaped if input text is parsed with the <xref:System.Text.RegularExpressions.RegexOptions.IgnorePatternWhitespace?displayProperty=nameWithType> option enabled.</span></span>  
  
 <span data-ttu-id="a2b9d-437">雖然<xref:System.Text.RegularExpressions.Regex.Escape%2A>方法會逸出直線開啟括號 ([)，並開啟括號 （{） 字元，它不會逸出其對應的結尾字元 (] 和})。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-437">While the <xref:System.Text.RegularExpressions.Regex.Escape%2A> method escapes the straight opening bracket ([) and opening brace ({) characters, it does not escape their corresponding closing characters (] and }).</span></span> <span data-ttu-id="a2b9d-438">在大部分情況下，逸出這些不需要。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-438">In most cases, escaping these is not necessary.</span></span> <span data-ttu-id="a2b9d-439">如果右括號或大括號前面沒有其相對應的開頭字元，規則運算式引擎會將它解譯常值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-439">If a closing bracket or brace is not preceded by its corresponding opening character, the regular expression engine interprets it literally.</span></span> <span data-ttu-id="a2b9d-440">如果開啟 braket 或大括號會解譯為中繼字元中，規則運算式引擎會解譯第一個對應的結尾字元做為中繼字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-440">If an opening braket or brace is interpreted as a metacharacter, the regular expression engine interprets the first corresponding closing character as a metacharacter.</span></span> <span data-ttu-id="a2b9d-441">如果不想要的行為，右括號或大括號應該逸出的明確前面加上反斜線 (\\) 字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-441">If this is not the desired behavior, the closing bracket or brace should be escaped by explicitly prepending the backslash (\\) character.</span></span> <span data-ttu-id="a2b9d-442">如需圖例，請參閱 < 範例 > 一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-442">For an illustration, see the Example section.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-443">下列範例會從文字擷取註解。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-443">The following example extracts comments from text.</span></span> <span data-ttu-id="a2b9d-444">它會假設註解以開始註解符號和使用者會選取結束註解符號分隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-444">It assumes that the comments are delimited by a begin comment symbol and an end comment symbol that is selected by the user.</span></span> <span data-ttu-id="a2b9d-445">註解符號要解譯為常值，因為它們會傳遞至<xref:System.Text.RegularExpressions.Regex.Escape%2A>方法，以確保，它們不能被錯誤解譯為中繼字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-445">Because the comment symbols are to be interpreted literally, they are passed to the <xref:System.Text.RegularExpressions.Regex.Escape%2A> method to ensure that they cannot be misinterpreted as metacharacters.</span></span> <span data-ttu-id="a2b9d-446">此外，範例明確檢查使用者輸入的註解結束符號是否為右括號 (]) 或大括號 （}）。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-446">In addition, the example explicitly checks whether the end comment symbol entered by the user is a closing bracket (]) or brace (}).</span></span> <span data-ttu-id="a2b9d-447">如果是，反斜線字元 (\\) 前面加上括號或大括號，所以它解譯為常值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-447">If it is, a backslash character (\\) is prepended to the bracket or brace so that it is interpreted literally.</span></span> <span data-ttu-id="a2b9d-448">請注意，此範例也會使用<xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType>顯示註解，而不是其開頭和結尾的註解符號以及註解的集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-448">Note that the example also uses the <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> collection to display the comment only, rather than the comment together with its opening and closing comment symbols.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Escape#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Escape/cs/Escape3.cs#3)]
 [!code-vb[System.Text.RegularExpressions.Regex.Escape#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Escape/vb/Escape3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-449"><paramref name="str" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-449"><paramref name="str" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="M:System.Text.RegularExpressions.Regex.Unescape(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="factory">
      <MemberSignature Language="C#" Value="protected internal System.Text.RegularExpressions.RegexRunnerFactory factory;" />
      <MemberSignature Language="ILAsm" Value=".field familyorassembly class System.Text.RegularExpressions.RegexRunnerFactory factory" />
      <MemberSignature Language="DocId" Value="F:System.Text.RegularExpressions.Regex.factory" />
      <MemberSignature Language="VB.NET" Value="Protected Friend factory As RegexRunnerFactory " />
      <MemberSignature Language="C++ CLI" Value="protected public: System::Text::RegularExpressions::RegexRunnerFactory ^ factory;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.RegexRunnerFactory</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-450">由 <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> 方法所產生的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-450">Used by a <see cref="T:System.Text.RegularExpressions.Regex" /> object generated by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="GetGroupNames">
      <MemberSignature Language="C#" Value="public string[] GetGroupNames ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string[] GetGroupNames() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.GetGroupNames" />
      <MemberSignature Language="VB.NET" Value="Public Function GetGroupNames () As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::String ^&gt; ^ GetGroupNames();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="a2b9d-451">傳回規則運算式的擷取群組名稱的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-451">Returns an array of capturing group names for the regular expression.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-452">群組名稱的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-452">A string array of group names.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-453">群組名稱的集合包含用來在運算式中的擷取群組命名的字串集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-453">The collection of group names contains the set of strings used to name capturing groups in the expression.</span></span> <span data-ttu-id="a2b9d-454">即使沒有明確命名的擷取群組，它們會自動指派數值的名稱 （"0"、"1"、"2"、"3"，等等）。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-454">Even if capturing groups are not explicitly named, they are automatically assigned numerical names ("0", "1", "2", "3", and so on).</span></span> <span data-ttu-id="a2b9d-455">"0"具名群組代表規則運算式模式比對所有文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-455">The "0" named group represents all text matched by the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-456">編號的群組之前明確命名的群組集合中，而且具名的群組會出現在規則運算式模式中定義的順序。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-456">Numbered groups precede explicitly named groups in the collection, and named groups appear in the order in which they are defined in the regular expression pattern.</span></span>  
  
 <span data-ttu-id="a2b9d-457">您可以使用<xref:System.Array.Length%2A>屬性上傳回此方法，以判斷在規則運算式中的群組數目的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-457">You can use the <xref:System.Array.Length%2A> property on the array returned by this method to determine the number of groups in a regular expression.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-458">下列範例會定義一般用途`ShowMatches`顯示群組的名稱的規則運算式，其相符的文字的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-458">The following example defines a general-purpose `ShowMatches` method that displays the names of regular expression groups and their matched text.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.GetGroupNames#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.getgroupnames/cs/getgroupnames1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.GetGroupNames#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.getgroupnames/vb/getgroupnames1.vb#1)]  
  
 <span data-ttu-id="a2b9d-459">在此情況下，規則運算式模式`\b(?<FirstWord>\w+)\s?((\w+)\s)*(?<LastWord>\w+)?(?<Punctuation>\p{Po})`旨在剖析簡單的句子，並識別其第一個單字、 最後一個字，以及結束的標點符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-459">In this case, the regular expression pattern `\b(?<FirstWord>\w+)\s?((\w+)\s)*(?<LastWord>\w+)?(?<Punctuation>\p{Po})` is intended to parse a simple sentence, and to identify its first word, last word, and ending punctuation mark.</span></span> <span data-ttu-id="a2b9d-460">下表顯示規則運算式模式的解譯方式：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-460">The following table shows how the regular expression pattern is interpreted:</span></span>  
  
|<span data-ttu-id="a2b9d-461">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-461">Pattern</span></span>|<span data-ttu-id="a2b9d-462">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-462">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="a2b9d-463">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-463">Begin the match at a word boundary.</span></span>|  
|`(?<FirstWord>\w+)`|<span data-ttu-id="a2b9d-464">比對一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-464">Match one or more word characters.</span></span> <span data-ttu-id="a2b9d-465">這是`FirstWord`具名群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-465">This is the `FirstWord` named group.</span></span>|  
|<span data-ttu-id="a2b9d-466">\s 嗎？</span><span class="sxs-lookup"><span data-stu-id="a2b9d-466">\s?</span></span>|<span data-ttu-id="a2b9d-467">比對零個或一個空白字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-467">Match zero or one white-space characters.</span></span>|  
|<span data-ttu-id="a2b9d-468">(\w+)</span><span class="sxs-lookup"><span data-stu-id="a2b9d-468">(\w+)</span></span>|<span data-ttu-id="a2b9d-469">比對一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-469">Match one or more word characters.</span></span> <span data-ttu-id="a2b9d-470">這是第二個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-470">This is the second capturing group.</span></span>|  
|<span data-ttu-id="a2b9d-471">\s</span><span class="sxs-lookup"><span data-stu-id="a2b9d-471">\s</span></span>|<span data-ttu-id="a2b9d-472">比對空白字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-472">Match a white-space character.</span></span>|  
|<span data-ttu-id="a2b9d-473">((\w+)\s)\*</span><span class="sxs-lookup"><span data-stu-id="a2b9d-473">((\w+)\s)\*</span></span>|<span data-ttu-id="a2b9d-474">比對一個或多個文字字元後面接著空白字元的零或多個相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-474">Match zero or more occurrences of one or more word characters followed by a white space.</span></span> <span data-ttu-id="a2b9d-475">這是第一個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-475">This is the first capturing group.</span></span>|  
|<span data-ttu-id="a2b9d-476">(?\<LastWord > \w+)？</span><span class="sxs-lookup"><span data-stu-id="a2b9d-476">(?\<LastWord>\w+)?</span></span>|<span data-ttu-id="a2b9d-477">比對零個或一個的一或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-477">Match zero or one occurrence of one or more word characters.</span></span> <span data-ttu-id="a2b9d-478">這是`LastWord`具名群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-478">This is the `LastWord` named group.</span></span>|  
|<span data-ttu-id="a2b9d-479">(?\<標點符號 > \p{Po})</span><span class="sxs-lookup"><span data-stu-id="a2b9d-479">(?\<Punctuation>\p{Po})</span></span>|<span data-ttu-id="a2b9d-480">比對的字元的 Unicode 分類為標點符號，其他。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-480">Match a character whose Unicode category is Punctuation, Other.</span></span> <span data-ttu-id="a2b9d-481">這是`Punctuation`具名群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-481">This is the `Punctuation` named group.</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Text.RegularExpressions.GroupCollection" />
      </Docs>
    </Member>
    <Member MemberName="GetGroupNumbers">
      <MemberSignature Language="C#" Value="public int[] GetGroupNumbers ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32[] GetGroupNumbers() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.GetGroupNumbers" />
      <MemberSignature Language="VB.NET" Value="Public Function GetGroupNumbers () As Integer()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;int&gt; ^ GetGroupNumbers();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="a2b9d-482">傳回對應陣列中群組名稱的擷取群組編號的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-482">Returns an array of capturing group numbers that correspond to group names in an array.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-483">群組編號的整數陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-483">An integer array of group numbers.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-484">未具名和具名擷取群組可以存取數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-484">Both unnamed and named capturing groups can be accessed by number.</span></span> <span data-ttu-id="a2b9d-485">未命名的群組會從左到右從 1 開始編號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-485">Unnamed groups are numbered from left to right starting with 1.</span></span> <span data-ttu-id="a2b9d-486">（索引 0 （零） 中的擷取群組會代表比對整個）。具名的群組然後從使用的數字大一開始由左至右編號數目未具名擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-486">(The capturing group in index 0 (zero) represents the match as a whole.)  Named groups are then numbered from left to right starting with a number that is one greater than the number of unnamed capturing groups.</span></span>  
  
 <span data-ttu-id="a2b9d-487">依字串名稱參考 group by 而不是其數目可以提供更快的存取。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-487">Referencing a group by its number instead of by string name can provide faster access.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-488">下列範例會定義規則運算式， `\b((?<word>\w+)\s*)+(?<end>[.?!])`，符合句子。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-488">The following example defines a regular expression, `\b((?<word>\w+)\s*)+(?<end>[.?!])`, that matches a sentence.</span></span> <span data-ttu-id="a2b9d-489">規則運算式包含三個擷取群組： 未命名的群組，這會擷取個別的字，空格字元，它可能會遵照; 以及名為群組`word`可擷取句子; 中的個別字與群組命名為`end`可擷取結束句子的標點符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-489">The regular expression includes three capturing groups: an unnamed group that captures an individual word along with a space character that may follow it; a group named `word` that captures the individual words in the sentence; and a group named `end` that captures the punctuation that ends the sentence.</span></span> <span data-ttu-id="a2b9d-490">範例會呼叫<xref:System.Text.RegularExpressions.Regex.GetGroupNumbers%2A>方法來取得所有擷取的數字群組，然後顯示 擷取的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-490">The example calls the <xref:System.Text.RegularExpressions.Regex.GetGroupNumbers%2A> method to get the numbers of all capturing groups, and then displays their captured string.</span></span> <span data-ttu-id="a2b9d-491">此外，<xref:System.Text.RegularExpressions.Regex.GroupNameFromNumber%2A>方法用來表示特定編號的群組是否對應至具名的群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-491">In addition, the <xref:System.Text.RegularExpressions.Regex.GroupNameFromNumber%2A> method is used to indicate whether a particular numbered group corresponds to a named group.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.GetGroupNumbers#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.getgroupnumbers/cs/getgroupnumbers1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.GetGroupNumbers#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.getgroupnumbers/vb/getgroupnumbers1.vb#1)]  
  
 <span data-ttu-id="a2b9d-492">規則運算式模式的解譯方式如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-492">The regular expression pattern is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-493">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-493">Pattern</span></span>|<span data-ttu-id="a2b9d-494">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-494">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="a2b9d-495">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-495">Begin the match at a word boundary.</span></span>|  
|`(?<word>\w+)`|<span data-ttu-id="a2b9d-496">比對一個或多個文字字元，並將相符的字串指派給群組，名為`word`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-496">Match one or more word characters and assign the matched strings to a group named `word`.</span></span>|  
|`\s*`|<span data-ttu-id="a2b9d-497">比對零個以上的空白字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-497">Match zero or more white-space characters.</span></span>|  
|`((?<word>\w+)\s*)`|<span data-ttu-id="a2b9d-498">指派`word`後面接著任何擷取的群組所擷取的第一個擷取群組的空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-498">Assign the `word` captured group followed by any captured white-space characters to the first captured group.</span></span>|  
|`((?<word>\w+)\s*)+`|<span data-ttu-id="a2b9d-499">比對後面接著空白字元的任何字元一或多次的一個或多個文字字元的模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-499">Match the pattern of one or more word characters followed by any white-space characters one or more times.</span></span>|  
|`(?<end>[.?!])`|<span data-ttu-id="a2b9d-500">比對句號、問號或驚嘆號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-500">Match a period, question mark, or exclamation point.</span></span> <span data-ttu-id="a2b9d-501">指定要比對的字元`end`擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-501">Assign the matched character to the `end` capturing group.</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Text.RegularExpressions.GroupCollection" />
      </Docs>
    </Member>
    <Member MemberName="GroupNameFromNumber">
      <MemberSignature Language="C#" Value="public string GroupNameFromNumber (int i);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string GroupNameFromNumber(int32 i) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.GroupNameFromNumber(System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function GroupNameFromNumber (i As Integer) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ GroupNameFromNumber(int i);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="i" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="i"><span data-ttu-id="a2b9d-502">要轉換至對應群組名稱的群組編號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-502">The group number to convert to the corresponding group name.</span></span></param>
        <summary><span data-ttu-id="a2b9d-503">取得對應指定群組編號的群組名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-503">Gets the group name that corresponds to the specified group number.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-504">字串，含有與指定群組編號相關聯的群組名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-504">A string that contains the group name associated with the specified group number.</span></span> <span data-ttu-id="a2b9d-505">如果沒有對應 <paramref name="i" /> 的群組名稱，方法會傳回 <see cref="F:System.String.Empty" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-505">If there is no group name that corresponds to <paramref name="i" />, the method returns <see cref="F:System.String.Empty" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-506">規則運算式模式可能會包含具名或編號擷取群組，其中描述在模式比對的子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-506">A regular expression pattern may contain either named or numbered capturing groups, which delineate subexpressions within a pattern match.</span></span> <span data-ttu-id="a2b9d-507">編號的群組會分隔語法 (*subexpression*)，系統會指派數字，根據規則運算式的順序。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-507">Numbered groups are delimited by the syntax (*subexpression*) and are assigned numbers based on their order in the regular expression.</span></span> <span data-ttu-id="a2b9d-508">具名的群組會分隔語法 (？`<`*名稱*`>`*subexpression*) 或 (？ '*名稱*'*subexpression*)，其中*名稱*是子運算式會識別的名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-508">Named groups are delimited by the syntax (?`<`*name*`>`*subexpression*) or (?'*name*'*subexpression*), where *name* is the name by which the subexpression will be identified.</span></span> <span data-ttu-id="a2b9d-509">(如需詳細資訊，請參閱[群組建構](~/docs/standard/base-types/grouping-constructs-in-regular-expressions.md)。)<xref:System.Text.RegularExpressions.Regex.GroupNameFromNumber%2A>方法識別命名的群組和編號的群組，依據它們在規則運算式中的序數位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-509">(For more information, see [Grouping Constructs](~/docs/standard/base-types/grouping-constructs-in-regular-expressions.md).) The <xref:System.Text.RegularExpressions.Regex.GroupNameFromNumber%2A> method identifies both named groups and numbered groups by their ordinal positions in the regular expression.</span></span> <span data-ttu-id="a2b9d-510">序數位置 0 一律代表整個規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-510">Ordinal position zero always represents the entire regular expression.</span></span> <span data-ttu-id="a2b9d-511">所有編號群組則會計算前具名群組，不論它們在規則運算式模式中的實際位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-511">All numbered groups are then counted before named groups, regardless of their actual position in the regular expression pattern.</span></span>  
  
 <span data-ttu-id="a2b9d-512">如果`i`是數字的具名群組，方法會傳回群組的名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-512">If `i` is the number of a named group, the method returns the name of the group.</span></span> <span data-ttu-id="a2b9d-513">如果`i`是數字的未命名的群組，方法會傳回數字的字串表示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-513">If `i` is the number of an unnamed group, the method returns the string representation of the number.</span></span> <span data-ttu-id="a2b9d-514">例如，如果`i`為 1，則方法會傳回"1"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-514">For example, if `i` is 1, the method returns "1".</span></span> <span data-ttu-id="a2b9d-515">如果`i`不是數的擷取群組，則方法會傳回<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-515">If `i` is not the number of a capturing group, the method returns <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="a2b9d-516">如果找到模式比對，這個方法所傳回的值再用來擷取<xref:System.Text.RegularExpressions.Group>物件，代表擷取的群組從<xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-516">If a pattern match is found, the value returned by this method can then be used to retrieve the <xref:System.Text.RegularExpressions.Group> object that represents the captured group from the <xref:System.Text.RegularExpressions.GroupCollection.Item%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="a2b9d-517"><xref:System.Text.RegularExpressions.GroupCollection>物件由<xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-517">The <xref:System.Text.RegularExpressions.GroupCollection> object is returned by the <xref:System.Text.RegularExpressions.Match.Groups%2A?displayProperty=nameWithType> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-518">下列範例會定義符合包含美國縣 （市） 名稱、 狀態名稱和郵遞區號地址的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-518">The following example defines a regular expression pattern that matches an address line containing a U.S. city name, state name, and zip code.</span></span> <span data-ttu-id="a2b9d-519">此範例會使用<xref:System.Text.RegularExpressions.Regex.GroupNameFromNumber%2A>方法來擷取的擷取群組的名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-519">The example uses the <xref:System.Text.RegularExpressions.Regex.GroupNameFromNumber%2A> method to retrieve the names of capturing groups.</span></span> <span data-ttu-id="a2b9d-520">然後，它會使用這些名稱來擷取對應的擷取的群組相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-520">It then uses these names to retrieve the corresponding captured groups for matches.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.GroupNameFromNumber#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.groupnamefromnumber/cs/groupnamefromnumberex.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.GroupNameFromNumber#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.groupnamefromnumber/vb/groupnamefromnumberex.vb#1)]  
  
 <span data-ttu-id="a2b9d-521">下列的運算式所定義的規則運算式模式：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-521">The regular expression pattern is defined by the following expression:</span></span>  
  
 `(?<city>[A-Za-z\s]+), (?<state>[A-Za-z]{2}) (?<zip>\d{5}(-\d{4})?)`  
  
 <span data-ttu-id="a2b9d-522">下表顯示規則運算式模式的解譯方式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-522">The following table shows how the regular expression pattern is interpreted.</span></span>  
  
|<span data-ttu-id="a2b9d-523">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-523">Pattern</span></span>|<span data-ttu-id="a2b9d-524">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-524">Description</span></span>|  
|-------------|-----------------|  
|`(?<city>[A-Za-z\s]+)`|<span data-ttu-id="a2b9d-525">比對一個或多個字母或空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-525">Match one or more alphabetic or white-space character.</span></span> <span data-ttu-id="a2b9d-526">將此擷取的群組名稱的指派`city`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-526">Assign this captured group the name `city`.</span></span>|  
|`,`|<span data-ttu-id="a2b9d-527">比對後面接著空白字元的逗號 （，）。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-527">Match a comma (,) followed by a white-space character.</span></span>|  
|`(?<state>[A-Za-z]{2})`|<span data-ttu-id="a2b9d-528">比對兩個字母的字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-528">Match two alphabetic characters.</span></span> <span data-ttu-id="a2b9d-529">將此擷取的群組名稱的指派`state`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-529">Assign this captured group the name `state`.</span></span> <span data-ttu-id="a2b9d-530">此群組後面必須接著空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-530">This group should be followed by a white-space character.</span></span>|  
|`(?<zip>\d{5}(-\d{4})?)`|<span data-ttu-id="a2b9d-531">比對後面接著零個或一個出現的連字號後面接著四個的數字的五個數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-531">Match five numeric digits followed by either zero or one occurrence of a hyphen followed by four digits.</span></span> <span data-ttu-id="a2b9d-532">將此擷取的群組名稱的指派`zip`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-532">Assign this captured group the name `zip`.</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Text.RegularExpressions.GroupCollection" />
        <altmember cref="M:System.Text.RegularExpressions.Regex.GetGroupNumbers" />
      </Docs>
    </Member>
    <Member MemberName="GroupNumberFromName">
      <MemberSignature Language="C#" Value="public int GroupNumberFromName (string name);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32 GroupNumberFromName(string name) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.GroupNumberFromName(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GroupNumberFromName (name As String) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; int GroupNumberFromName(System::String ^ name);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="name" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="name"><span data-ttu-id="a2b9d-533">群組名稱，要轉換至對應群組編號的。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-533">The group name to convert to the corresponding group number.</span></span></param>
        <summary><span data-ttu-id="a2b9d-534">傳回對應指定群組名稱的群組編號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-534">Returns the group number that corresponds to the specified group name.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-535">對應指定群組名稱的群組編號；如果 <paramref name="name" /> 不是有效的群組名稱，則為 -1。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-535">The group number that corresponds to the specified group name, or -1 if <paramref name="name" /> is not a valid group name.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-536">規則運算式模式可能會包含具名或編號擷取群組，其中描述在模式比對的子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-536">A regular expression pattern may contain either named or numbered capturing groups, which delineate subexpressions within a pattern match.</span></span> <span data-ttu-id="a2b9d-537">編號的群組會分隔語法 (*subexpression*)，系統會指派數字，根據規則運算式的順序。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-537">Numbered groups are delimited by the syntax (*subexpression*) and are assigned numbers based on their order in the regular expression.</span></span> <span data-ttu-id="a2b9d-538">具名的群組會分隔語法 (？`<`*名稱*`>`*subexpression*) 或 (？ '*名稱*'*subexpression*)，其中*名稱*是子運算式會識別的名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-538">Named groups are delimited by the syntax (?`<`*name*`>`*subexpression*) or (?'*name*'*subexpression*), where *name* is the name by which the subexpression will be identified.</span></span> <span data-ttu-id="a2b9d-539">(如需詳細資訊，請參閱[群組建構](~/docs/standard/base-types/grouping-constructs-in-regular-expressions.md)。)<xref:System.Text.RegularExpressions.Regex.GroupNumberFromName%2A>方法識別命名的群組和編號的群組，依據它們在規則運算式中的序數位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-539">(For more information, see [Grouping Constructs](~/docs/standard/base-types/grouping-constructs-in-regular-expressions.md).) The <xref:System.Text.RegularExpressions.Regex.GroupNumberFromName%2A> method identifies both named groups and numbered groups by their ordinal positions in the regular expression.</span></span> <span data-ttu-id="a2b9d-540">序數位置 0 一律代表整個規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-540">Ordinal position zero always represents the entire regular expression.</span></span> <span data-ttu-id="a2b9d-541">所有編號群組則會計算前具名群組，不論它們在規則運算式模式中的實際位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-541">All numbered groups are then counted before named groups, regardless of their actual position in the regular expression pattern.</span></span>  
  
 <span data-ttu-id="a2b9d-542">如果`name`是出現在規則運算式模式中，則方法會傳回數字的群組數字的字串表示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-542">If `name` is the string representation of a group number that is present in the regular expression pattern, the method returns that number.</span></span> <span data-ttu-id="a2b9d-543">如果`name`對應至具名擷取群組會出現在規則運算式模式，方法會傳回其對應的數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-543">If `name` corresponds to a named capturing group that is present in the regular expression pattern, the method returns its corresponding number.</span></span> <span data-ttu-id="a2b9d-544">比較的`name`與群組名稱會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-544">The comparison of `name` with the group name is case-sensitive.</span></span> <span data-ttu-id="a2b9d-545">如果`name`未對應至擷取群組的名稱，或擷取群組，該方法的數字的字串表示會傳回-1。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-545">If `name` does not correspond to the name of a capturing group or to the string representation of the number of a capturing group, the method returns -1.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-546"><paramref name="name" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-546"><paramref name="name" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="T:System.Text.RegularExpressions.GroupCollection" />
        <altmember cref="M:System.Text.RegularExpressions.Regex.GetGroupNames" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteMatchTimeout">
      <MemberSignature Language="C#" Value="public static readonly TimeSpan InfiniteMatchTimeout;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly valuetype System.TimeSpan InfiniteMatchTimeout" />
      <MemberSignature Language="DocId" Value="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteMatchTimeout As TimeSpan " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly TimeSpan InfiniteMatchTimeout;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.TimeSpan</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-547">指定模式比對作業不應逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-547">Specifies that a pattern-matching operation should not time out.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-548"><xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>類別建構函式和靜態比對的方法使用一些<xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout>常數表示嘗試尋找模式比對應該逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-548">The <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> class constructor and a number of static matching methods use the <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout> constant to indicate that the attempt to find a pattern match should not time out.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="a2b9d-549">將規則運算式引擎的逾時值設定為<xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout>可能會造成依賴大量回溯，看起來像處理幾乎符合規則運算式模式的文字時停止回應的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-549">Setting the regular expression engine's time-out value to <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout> can cause regular expressions that rely on excessive backtracking to appear to stop responding when processing text that nearly matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-550">如果您停用逾時，您應該確定，您的規則運算式不會依賴大量回溯，和它處理幾乎符合規則運算式模式的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-550">If you disable time-outs, you should ensure that your regular expression does not rely on excessive backtracking and that it handles text that nearly matches the regular expression pattern.</span></span>  
>   
>  <span data-ttu-id="a2b9d-551">如需處理回溯的詳細資訊，請參閱[回溯](~/docs/standard/base-types/backtracking-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-551">For more information about handling backtracking, see [Backtracking](~/docs/standard/base-types/backtracking-in-regular-expressions.md).</span></span>  
  
 <span data-ttu-id="a2b9d-552"><xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout>常數可以提供的值為`matchTimeout`下列成員的引數：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-552">The <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout> constant can be supplied as the value of the `matchTimeout` argument of the following members:</span></span>  
  
-   <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>  
  
-   <xref:System.Text.RegularExpressions.RegexCompilationInfo.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.String%2CSystem.String%2CSystem.Boolean%2CSystem.TimeSpan%29?displayProperty=nameWithType>  
  
-   <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>  
  
-   <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>  
  
-   <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>  
  
-   <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>  
  
-   <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>  
  
-   <xref:System.Text.RegularExpressions.Regex.Split%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Text.RegularExpressions.Regex.MatchTimeout" />
      </Docs>
    </Member>
    <Member MemberName="InitializeReferences">
      <MemberSignature Language="C#" Value="protected void InitializeReferences ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig instance void InitializeReferences() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.InitializeReferences" />
      <MemberSignature Language="VB.NET" Value="Protected Sub InitializeReferences ()" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; void InitializeReferences();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="a2b9d-553">由 <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> 方法所產生的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-553">Used by a <see cref="T:System.Text.RegularExpressions.Regex" /> object generated by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span></summary>
        <remarks>To be added.</remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="a2b9d-554">參考已初始化。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-554">References have already been initialized.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="internalMatchTimeout">
      <MemberSignature Language="C#" Value="protected internal TimeSpan internalMatchTimeout;" />
      <MemberSignature Language="ILAsm" Value=".field familyorassembly valuetype System.TimeSpan internalMatchTimeout" />
      <MemberSignature Language="DocId" Value="F:System.Text.RegularExpressions.Regex.internalMatchTimeout" />
      <MemberSignature Language="VB.NET" Value="Protected Friend internalMatchTimeout As TimeSpan " />
      <MemberSignature Language="C++ CLI" Value="protected public: TimeSpan internalMatchTimeout;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Runtime.Serialization.OptionalField(VersionAdded=2)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.TimeSpan</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-555">在作業逾時之前可在模式比對作業中流逝的最長時間。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-555">The maximum amount of time that can elapse in a pattern-matching operation before the operation times out.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="IsMatch">
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="a2b9d-556">指示規則運算式是否在輸入字串中尋找比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-556">Indicates whether the regular expression finds a match in the input string.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="IsMatch">
      <MemberSignature Language="C#" Value="public bool IsMatch (string input);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool IsMatch(string input) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.IsMatch(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function IsMatch (input As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool IsMatch(System::String ^ input);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-557">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-557">The string to search for a match.</span></span></param>
        <summary><span data-ttu-id="a2b9d-558">表示 <see cref="T:System.Text.RegularExpressions.Regex" /> 建構函式中指定的規則運算式是否要在指定的輸入字串中尋找相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-558">Indicates whether the regular expression specified in the <see cref="T:System.Text.RegularExpressions.Regex" /> constructor finds a match in a specified input string.</span></span></summary>
        <returns>
          <span data-ttu-id="a2b9d-559">如果規則運算式尋找到符合項目，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-559"><see langword="true" /> if the regular expression finds a match; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-560"><xref:System.Text.RegularExpressions.Regex.IsMatch%2A>方法通常用來驗證該字串，或確保字串符合特定模式而不擷取做後續操作該字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-560">The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method is typically used to validate a string or to ensure that a string conforms to a particular pattern without retrieving that string for subsequent manipulation.</span></span> <span data-ttu-id="a2b9d-561">如果要判斷是否有一個或多個字串符合規則運算式模式，然後再擷取做後續操作，請呼叫 <xref:System.Text.RegularExpressions.Regex.Match%2A> 或 <xref:System.Text.RegularExpressions.Regex.Matches%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-561">If you want to determine whether one or more strings match a regular expression pattern and then retrieve them for subsequent manipulation, call the <xref:System.Text.RegularExpressions.Regex.Match%2A> or <xref:System.Text.RegularExpressions.Regex.Matches%2A> method.</span></span>  
  
 <span data-ttu-id="a2b9d-562">如果比對作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-562">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the matching operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-563">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-563">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-564">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-564">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-565">下列範例說明使用<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%29>方法來判斷字串是否為有效的組件數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-565">The following example illustrates the use of the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%29> method to determine whether a string is a valid part number.</span></span> <span data-ttu-id="a2b9d-566">規則運算式會假設零件編號有三種以連字號分隔的字元組所組成的特定格式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-566">The regular expression assumes that the part number has a specific format that consists of three sets of characters separated by hyphens.</span></span> <span data-ttu-id="a2b9d-567">第一個集合，其中包含四個字元，必須包含後面兩個數值的字元，後面接著英數字元的英數字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-567">The first set, which contains four characters, must consist of an alphanumeric character followed by two numeric characters followed by an alphanumeric character.</span></span> <span data-ttu-id="a2b9d-568">第二個集合，其中包含三個字元，必須是數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-568">The second set, which consists of three characters, must be numeric.</span></span> <span data-ttu-id="a2b9d-569">第三個集合，其中包含四個字元，必須有三個數字字元，後面接著英數字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-569">The third set, which consists of four characters, must have three numeric characters followed by an alphanumeric character.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.IsMatch#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ismatch/cs/ismatch2.cs#2)]
 [!code-vb[System.Text.RegularExpressions.Regex.IsMatch#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ismatch/vb/ismatch2.vb#2)]  
  
 <span data-ttu-id="a2b9d-570">規則運算式模式為：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-570">The regular expression pattern is:</span></span>  
  
```  
^[a-zA-Z0-9]\d{2}[a-zA-Z0-9](-\d{3}){2}[A-Za-z0-9]$  
```  
  
 <span data-ttu-id="a2b9d-571">下表顯示規則運算式模式的解譯方式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-571">The following table shows how the regular expression pattern is interpreted.</span></span>  
  
|<span data-ttu-id="a2b9d-572">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-572">Pattern</span></span>|<span data-ttu-id="a2b9d-573">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-573">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="a2b9d-574">開始一行的開頭比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-574">Begin the match at the beginning of the line.</span></span>|  
|`[a-zA-Z0-9]`|<span data-ttu-id="a2b9d-575">比對單一字母字元 (`a`透過`z`或`A`透過`Z`) 或數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-575">Match a single alphabetic character (`a` through `z` or `A` through `Z`) or numeric character.</span></span>|  
|`\d{2}`|<span data-ttu-id="a2b9d-576">比對兩個數值字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-576">Match two numeric characters.</span></span>|  
|`[a-zA-Z0-9]`|<span data-ttu-id="a2b9d-577">比對單一字母字元 (`a`透過`z`或`A`透過`Z`) 或數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-577">Match a single alphabetic character (`a` through `z` or `A` through `Z`) or numeric character.</span></span>|  
|`-`|<span data-ttu-id="a2b9d-578">比對連字號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-578">Match a hyphen.</span></span>|  
|`\d{3}`|<span data-ttu-id="a2b9d-579">比對三個數值字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-579">Match exactly three numeric characters.</span></span>|  
|`(-\d{3}){2}`|<span data-ttu-id="a2b9d-580">找出連字號後面接著三個數字字元，並符合此模式的兩個項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-580">Find a hyphen followed by three numeric characters, and match two occurrences of this pattern.</span></span>|  
|`[a-zA-Z0-9]`|<span data-ttu-id="a2b9d-581">比對單一字母字元 (`a`透過`z`或`A`透過`Z`) 或數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-581">Match a single alphabetic character (`a` through `z` or `A` through `Z`) or numeric character.</span></span>|  
|`$`|<span data-ttu-id="a2b9d-582">結束在行尾比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-582">End the match at the end of the line.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-583"><paramref name="input" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-583"><paramref name="input" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-584">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-584">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-585">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-585">For more information about time-outs, see the Remarks section.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="IsMatch">
      <MemberSignature Language="C#" Value="public bool IsMatch (string input, int startat);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance bool IsMatch(string input, int32 startat) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.IsMatch(System.String,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function IsMatch (input As String, startat As Integer) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool IsMatch(System::String ^ input, int startat);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="startat" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-586">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-586">The string to search for a match.</span></span></param>
        <param name="startat"><span data-ttu-id="a2b9d-587">要開始搜尋的字元位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-587">The character position at which to start the search.</span></span></param>
        <summary><span data-ttu-id="a2b9d-588">表示 <see cref="T:System.Text.RegularExpressions.Regex" /> 建構函式中所指定的規則運算式，是否要從字串中指定的起始位置開始，在指定的輸入字串中尋找相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-588">Indicates whether the regular expression specified in the <see cref="T:System.Text.RegularExpressions.Regex" /> constructor finds a match in the specified input string, beginning at the specified starting position in the string.</span></span></summary>
        <returns>
          <span data-ttu-id="a2b9d-589">如果規則運算式尋找到符合項目，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-589"><see langword="true" /> if the regular expression finds a match; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-590"><xref:System.Text.RegularExpressions.Regex.IsMatch%2A>方法通常用來驗證該字串，或確保字串符合特定模式而不擷取做後續操作該字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-590">The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method is typically used to validate a string or to ensure that a string conforms to a particular pattern without retrieving that string for subsequent manipulation.</span></span> <span data-ttu-id="a2b9d-591">如果要判斷是否有一個或多個字串符合規則運算式模式，然後再擷取做後續操作，請呼叫 <xref:System.Text.RegularExpressions.Regex.Match%2A> 或 <xref:System.Text.RegularExpressions.Regex.Matches%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-591">If you want to determine whether one or more strings match a regular expression pattern and then retrieve them for subsequent manipulation, call the <xref:System.Text.RegularExpressions.Regex.Match%2A> or <xref:System.Text.RegularExpressions.Regex.Matches%2A> method.</span></span>  
  
 <span data-ttu-id="a2b9d-592">如果比對作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-592">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the matching operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-593">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-593">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-594">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-594">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-595">下列範例說明使用<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.Int32%29>方法來判斷字串是否為有效的組件數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-595">The following example illustrates the use of the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.Int32%29> method to determine whether a string is a valid part number.</span></span> <span data-ttu-id="a2b9d-596">它會搜尋字串中的冒號 （:） 字元後面接著的零件編號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-596">It searches for a part number that follows a colon (:) character in a string.</span></span> <span data-ttu-id="a2b9d-597"><xref:System.String.IndexOf%28System.Char%29>方法用來決定位置的冒號字元，然後傳遞至<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.Int32%29>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-597">The <xref:System.String.IndexOf%28System.Char%29> method is used to determine the position of the colon character, which is then passed to the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.Int32%29> method.</span></span> <span data-ttu-id="a2b9d-598">規則運算式會假設零件編號有三種以連字號分隔的字元組所組成的特定格式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-598">The regular expression assumes that the part number has a specific format that consists of three sets of characters separated by hyphens.</span></span> <span data-ttu-id="a2b9d-599">第一個集合，其中包含四個字元，必須包含後面兩個數值的字元，後面接著英數字元的英數字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-599">The first set, which contains four characters, must consist of an alphanumeric character followed by two numeric characters followed by an alphanumeric character.</span></span> <span data-ttu-id="a2b9d-600">第二個集合，其中包含三個字元，必須是數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-600">The second set, which consists of three characters, must be numeric.</span></span> <span data-ttu-id="a2b9d-601">第三個集合，其中包含四個字元，必須有三個數字字元，後面接著英數字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-601">The third set, which consists of four characters, must have three numeric characters followed by an alphanumeric character.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.IsMatch#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ismatch/cs/ismatch3.cs#3)]
 [!code-vb[System.Text.RegularExpressions.Regex.IsMatch#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ismatch/vb/ismatch3.vb#3)]  
  
 <span data-ttu-id="a2b9d-602">規則運算式模式為：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-602">The regular expression pattern is:</span></span>  
  
```  
[a-zA-Z0-9]\d{2}[a-zA-Z0-9](-\d{3}){2}[A-Za-z0-9]$  
```  
  
 <span data-ttu-id="a2b9d-603">下表顯示規則運算式模式的解譯方式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-603">The following table shows how the regular expression pattern is interpreted.</span></span>  
  
|<span data-ttu-id="a2b9d-604">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-604">Pattern</span></span>|<span data-ttu-id="a2b9d-605">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-605">Description</span></span>|  
|-------------|-----------------|  
|`[a-zA-Z0-9]`|<span data-ttu-id="a2b9d-606">比對單一字母字元 (`a`透過`z`或`A`透過`Z`) 或數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-606">Match a single alphabetic character (`a` through `z` or `A` through `Z`) or numeric character.</span></span>|  
|`\d{2}`|<span data-ttu-id="a2b9d-607">比對兩個數值字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-607">Match two numeric characters.</span></span>|  
|`[a-zA-Z0-9]`|<span data-ttu-id="a2b9d-608">比對單一字母字元 (`a`透過`z`或`A`透過`Z`) 或數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-608">Match a single alphabetic character (`a` through `z` or `A` through `Z`) or numeric character.</span></span>|  
|`-`|<span data-ttu-id="a2b9d-609">比對連字號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-609">Match a hyphen.</span></span>|  
|`\d{3}`|<span data-ttu-id="a2b9d-610">比對三個數值字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-610">Match exactly three numeric characters.</span></span>|  
|`(-\d{3}){2}`|<span data-ttu-id="a2b9d-611">找出連字號後面接著三個數字字元，並符合此模式的兩個項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-611">Find a hyphen followed by three numeric characters, and match two occurrences of this pattern.</span></span>|  
|`[a-zA-Z0-9]`|<span data-ttu-id="a2b9d-612">比對單一字母字元 (`a`透過`z`或`A`透過`Z`) 或數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-612">Match a single alphabetic character (`a` through `z` or `A` through `Z`) or numeric character.</span></span>|  
|`$`|<span data-ttu-id="a2b9d-613">結束在行尾比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-613">End the match at the end of the line.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-614"><paramref name="input" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-614"><paramref name="input" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-615"><paramref name="startat" /> 小於零或大於 <paramref name="input" /> 的長度。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-615"><paramref name="startat" /> is less than zero or greater than the length of <paramref name="input" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-616">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-616">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-617">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-617">For more information about time-outs, see the Remarks section.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="IsMatch">
      <MemberSignature Language="C#" Value="public static bool IsMatch (string input, string pattern);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool IsMatch(string input, string pattern) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.IsMatch(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function IsMatch (input As String, pattern As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool IsMatch(System::String ^ input, System::String ^ pattern);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-618">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-618">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-619">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-619">The regular expression pattern to match.</span></span></param>
        <summary><span data-ttu-id="a2b9d-620">表示指定的規則運算式是否在指定的輸入字串中尋找相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-620">Indicates whether the specified regular expression finds a match in the specified input string.</span></span></summary>
        <returns>
          <span data-ttu-id="a2b9d-621">如果規則運算式尋找到符合項目，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-621"><see langword="true" /> if the regular expression finds a match; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-622"><xref:System.Text.RegularExpressions.Regex.IsMatch%2A>方法通常用來驗證該字串，或確保字串符合特定模式而不擷取做後續操作該字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-622">The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method is typically used to validate a string or to ensure that a string conforms to a particular pattern without retrieving that string for subsequent manipulation.</span></span> <span data-ttu-id="a2b9d-623">如果要判斷是否有一個或多個字串符合規則運算式模式，然後再擷取做後續操作，請呼叫 <xref:System.Text.RegularExpressions.Regex.Match%2A> 或 <xref:System.Text.RegularExpressions.Regex.Matches%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-623">If you want to determine whether one or more strings match a regular expression pattern and then retrieve them for subsequent manipulation, call the <xref:System.Text.RegularExpressions.Regex.Match%2A> or <xref:System.Text.RegularExpressions.Regex.Matches%2A> method.</span></span>  
  
 <span data-ttu-id="a2b9d-624">靜態<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29>方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件與所指定的規則運算式模式`pattern`，然後呼叫<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%29>執行個體方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-624">The static <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29> method is equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the regular expression pattern specified by `pattern` and calling the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%29> instance method.</span></span> <span data-ttu-id="a2b9d-625">這個規則運算式模式的規則運算式引擎會快取供快速擷取。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-625">This regular expression pattern is cached for rapid retrieval by the regular expression engine.</span></span>  
  
 <span data-ttu-id="a2b9d-626">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-626">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-627">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-627">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-628">如果比對作業的執行時間超出為呼叫方法的應用程式定義域指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-628">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the matching operation exceeds the time-out interval specified for the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-629">如果在應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-629">If no time-out is defined in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-630">下列範例說明使用<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29>方法來判斷字串是否為有效的組件數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-630">The following example illustrates the use of the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29> method to determine whether a string is a valid part number.</span></span> <span data-ttu-id="a2b9d-631">規則運算式會假設零件編號有三種以連字號分隔的字元組所組成的特定格式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-631">The regular expression assumes that the part number has a specific format that consists of three sets of characters separated by hyphens.</span></span> <span data-ttu-id="a2b9d-632">第一個集合，其中包含四個字元，必須包含後面兩個數值的字元，後面接著英數字元的英數字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-632">The first set, which contains four characters, must consist of an alphanumeric character followed by two numeric characters followed by an alphanumeric character.</span></span> <span data-ttu-id="a2b9d-633">第二個集合，其中包含三個字元，必須是數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-633">The second set, which consists of three characters, must be numeric.</span></span> <span data-ttu-id="a2b9d-634">第三個集合，其中包含四個字元，必須有三個數字字元，後面接著英數字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-634">The third set, which consists of four characters, must have three numeric characters followed by an alphanumeric character.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.IsMatch#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ismatch/cs/ismatch1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.IsMatch#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ismatch/vb/ismatch1.vb#1)]  
  
 <span data-ttu-id="a2b9d-635">規則運算式模式為：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-635">The regular expression pattern is:</span></span>  
  
```  
^[a-zA-Z0-9]\d{2}[a-zA-Z0-9](-\d{3}){2}[A-Za-z0-9]$  
```  
  
 <span data-ttu-id="a2b9d-636">下表顯示規則運算式模式的解譯方式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-636">The following table shows how the regular expression pattern is interpreted.</span></span>  
  
|<span data-ttu-id="a2b9d-637">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-637">Pattern</span></span>|<span data-ttu-id="a2b9d-638">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-638">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="a2b9d-639">開始一行的開頭比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-639">Begin the match at the beginning of the line.</span></span>|  
|`[a-zA-Z0-9]`|<span data-ttu-id="a2b9d-640">比對單一字母字元 (`a`透過`z`或`A`透過`Z`) 或數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-640">Match a single alphabetic character (`a` through `z` or `A` through `Z`) or numeric character.</span></span>|  
|`\d{2}`|<span data-ttu-id="a2b9d-641">比對兩個數值字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-641">Match two numeric characters.</span></span>|  
|`[a-zA-Z0-9]`|<span data-ttu-id="a2b9d-642">比對單一字母字元 (`a`透過`z`或`A`透過`Z`) 或數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-642">Match a single alphabetic character (`a` through `z` or `A` through `Z`) or numeric character.</span></span>|  
|`-`|<span data-ttu-id="a2b9d-643">比對連字號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-643">Match a hyphen.</span></span>|  
|`\d{3}`|<span data-ttu-id="a2b9d-644">比對三個數值字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-644">Match exactly three numeric characters.</span></span>|  
|`(-\d{3}){2}`|<span data-ttu-id="a2b9d-645">找出連字號後面接著三個數字字元，並符合此模式的兩個項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-645">Find a hyphen followed by three numeric characters, and match two occurrences of this pattern.</span></span>|  
|`[a-zA-Z0-9]`|<span data-ttu-id="a2b9d-646">比對單一字母字元 (`a`透過`z`或`A`透過`Z`) 或數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-646">Match a single alphabetic character (`a` through `z` or `A` through `Z`) or numeric character.</span></span>|  
|`$`|<span data-ttu-id="a2b9d-647">結束在行尾比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-647">End the match at the end of the line.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-648">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-648">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-649"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-649"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-650">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-650">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-651">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-651">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-652">此方法等於呼叫該方法的應用程式定義域的預設逾時值一段時間後逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-652">This method times out after an interval that is equal to the default time-out value of the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-653">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-653">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-654">建議的靜態方法，以驗證模式比對是<see cref="M:System.Text.RegularExpressions.Regex.IsMatch(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-654">The recommended static method for verifying a pattern match is <see cref="M:System.Text.RegularExpressions.Regex.IsMatch(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you set the time-out interval.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="IsMatch">
      <MemberSignature Language="C#" Value="public static bool IsMatch (string input, string pattern, System.Text.RegularExpressions.RegexOptions options);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool IsMatch(string input, string pattern, valuetype System.Text.RegularExpressions.RegexOptions options) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.IsMatch(System.String,System.String,System.Text.RegularExpressions.RegexOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function IsMatch (input As String, pattern As String, options As RegexOptions) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool IsMatch(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::RegexOptions options);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-655">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-655">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-656">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-656">The regular expression pattern to match.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-657">列舉值的位元組合，提供用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-657">A bitwise combination of the enumeration values that provide options for matching.</span></span></param>
        <summary><span data-ttu-id="a2b9d-658">表示指定的規則運算式是否使用指定的比對選項，在指定的輸入字串中尋找相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-658">Indicates whether the specified regular expression finds a match in the specified input string, using the specified matching options.</span></span></summary>
        <returns>
          <span data-ttu-id="a2b9d-659">如果規則運算式尋找到符合項目，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-659"><see langword="true" /> if the regular expression finds a match; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-660"><xref:System.Text.RegularExpressions.Regex.IsMatch%2A>方法通常用來驗證該字串，或確保字串符合特定模式而不擷取做後續操作該字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-660">The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method is typically used to validate a string or to ensure that a string conforms to a particular pattern without retrieving that string for subsequent manipulation.</span></span> <span data-ttu-id="a2b9d-661">如果要判斷是否有一個或多個字串符合規則運算式模式，然後再擷取做後續操作，請呼叫 <xref:System.Text.RegularExpressions.Regex.Match%2A> 或 <xref:System.Text.RegularExpressions.Regex.Matches%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-661">If you want to determine whether one or more strings match a regular expression pattern and then retrieve them for subsequent manipulation, call the <xref:System.Text.RegularExpressions.Regex.Match%2A> or <xref:System.Text.RegularExpressions.Regex.Matches%2A> method.</span></span>  
  
 <span data-ttu-id="a2b9d-662">靜態<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29>方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件與所指定的規則運算式模式`pattern`和所指定的規則運算式選項`options`，然後呼叫<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%29>執行個體方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-662">The static <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29> method is equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the regular expression pattern specified by `pattern` and the regular expression options specified by `options` and calling the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%29> instance method.</span></span> <span data-ttu-id="a2b9d-663">這個規則運算式模式的規則運算式引擎會快取供快速擷取。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-663">This regular expression pattern is cached for rapid retrieval by the regular expression engine.</span></span>  
  
 <span data-ttu-id="a2b9d-664">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-664">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-665">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-665">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-666">如果比對作業的執行時間超出為呼叫方法的應用程式定義域指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-666">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the matching operation exceeds the time-out interval specified for the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-667">如果在應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-667">If no time-out is defined in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-668">下列範例說明使用<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29>方法來判斷字串是否為有效的組件數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-668">The following example illustrates the use of the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29> method to determine whether a string is a valid part number.</span></span> <span data-ttu-id="a2b9d-669">規則運算式會假設零件編號有三種以連字號分隔的字元組所組成的特定格式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-669">The regular expression assumes that the part number has a specific format that consists of three sets of characters separated by hyphens.</span></span> <span data-ttu-id="a2b9d-670">第一個集合，其中包含四個字元，必須包含後面兩個數值的字元，後面接著英數字元的英數字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-670">The first set, which contains four characters, must consist of an alphanumeric character followed by two numeric characters followed by an alphanumeric character.</span></span> <span data-ttu-id="a2b9d-671">第二個集合，其中包含三個字元，必須是數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-671">The second set, which consists of three characters, must be numeric.</span></span> <span data-ttu-id="a2b9d-672">第三個集合，其中包含四個字元，必須有三個數字字元，後面接著英數字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-672">The third set, which consists of four characters, must have three numeric characters followed by an alphanumeric character.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.IsMatch#4](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ismatch/cs/ismatch4.cs#4)]
 [!code-vb[System.Text.RegularExpressions.Regex.IsMatch#4](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ismatch/vb/ismatch4.vb#4)]  
  
 <span data-ttu-id="a2b9d-673">規則運算式模式為：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-673">The regular expression pattern is:</span></span>  
  
```  
^[A-Z0-9]\d{2}[A-Z0-9](-\d{3}){2}[A-Z0-9]$  
```  
  
 <span data-ttu-id="a2b9d-674">下表顯示規則運算式模式的解譯方式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-674">The following table shows how the regular expression pattern is interpreted.</span></span>  
  
|<span data-ttu-id="a2b9d-675">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-675">Pattern</span></span>|<span data-ttu-id="a2b9d-676">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-676">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="a2b9d-677">從字串的開頭開始比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-677">Begin the match at the beginning of the string.</span></span>|  
|`[A-Z0-9]`|<span data-ttu-id="a2b9d-678">比對任何單一字母字元，從`A`透過`Z`，或任何數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-678">Match any single alphabetic character from `A` through `Z`, or any numeric character.</span></span>|  
|`\d{2}`|<span data-ttu-id="a2b9d-679">比對兩個數值字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-679">Match two numeric characters.</span></span>|  
|`[A-Z0-9]`|<span data-ttu-id="a2b9d-680">比對任何單一字母字元，從`A`透過`Z`，或任何數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-680">Match any single alphabetic character from `A` through `Z`, or any numeric character.</span></span>|  
|`-`|<span data-ttu-id="a2b9d-681">比對連字號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-681">Match a hyphen.</span></span>|  
|`\d{3}`|<span data-ttu-id="a2b9d-682">比對三個數值字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-682">Match exactly three numeric characters.</span></span>|  
|`(-\d{3}){2}`|<span data-ttu-id="a2b9d-683">找出連字號後面接著三個數字字元，並符合此模式的兩個項目...</span><span class="sxs-lookup"><span data-stu-id="a2b9d-683">Find a hyphen followed by three numeric characters, and match two occurrences of this pattern..</span></span>|  
|`[A-Z0-9]`|<span data-ttu-id="a2b9d-684">比對任何單一字母字元，從`A`透過`Z`，或任何數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-684">Match any single alphabetic character from `A` through `Z`, or any numeric character.</span></span>|  
|`$`|<span data-ttu-id="a2b9d-685">在字串的結尾結束比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-685">End the match at the end of the string.</span></span>|  
  
 <span data-ttu-id="a2b9d-686">呼叫<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29>方法`options`參數設定為<xref:System.Text.RegularExpressions.RegexOptions.IgnoreCase?displayProperty=nameWithType>相當於定義下列規則運算式：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-686">Calling the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29> method with the `options` parameter set to <xref:System.Text.RegularExpressions.RegexOptions.IgnoreCase?displayProperty=nameWithType> is equivalent to defining the following regular expression:</span></span>  
  
```  
[a-zA-Z0-9]\d{2}[a-zA-Z0-9](-\d{3}){2}[A-Za-z0-9]  
```  
  
 <span data-ttu-id="a2b9d-687">進行比較，請參閱範例<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-687">For comparison, see the example for the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-688">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-688">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-689"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-689"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-690"><paramref name="options" /> 不是有效的 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-690"><paramref name="options" /> is not a valid <see cref="T:System.Text.RegularExpressions.RegexOptions" /> value.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-691">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-691">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-692">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-692">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-693">這個方法的逾時間隔等於呼叫這個方法的應用程式定義域的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-693">This method times out after an interval that is equal to the default time-out value of the application domain in which it is called.</span></span> <span data-ttu-id="a2b9d-694">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-694">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-695">建議的靜態方法，以驗證模式比對是<see cref="M:System.Text.RegularExpressions.Regex.IsMatch(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-695">The recommended static method for verifying a pattern match is <see cref="M:System.Text.RegularExpressions.Regex.IsMatch(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you set the time-out interval.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="IsMatch">
      <MemberSignature Language="C#" Value="public static bool IsMatch (string input, string pattern, System.Text.RegularExpressions.RegexOptions options, TimeSpan matchTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool IsMatch(string input, string pattern, valuetype System.Text.RegularExpressions.RegexOptions options, valuetype System.TimeSpan matchTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.IsMatch(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function IsMatch (input As String, pattern As String, options As RegexOptions, matchTimeout As TimeSpan) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool IsMatch(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::RegexOptions options, TimeSpan matchTimeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
        <Parameter Name="matchTimeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-696">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-696">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-697">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-697">The regular expression pattern to match.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-698">列舉值的位元組合，提供用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-698">A bitwise combination of the enumeration values that provide options for matching.</span></span></param>
        <param name="matchTimeout"><span data-ttu-id="a2b9d-699">間隔，若要表示此方法不會逾時則為 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-699">A time-out interval, or <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" /> to indicate that the method should not time out.</span></span></param>
        <summary><span data-ttu-id="a2b9d-700">指出指定的規則運算式是否使用指定的比對選項和逾時間隔，在指定的輸入字串中尋找相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-700">Indicates whether the specified regular expression finds a match in the specified input string, using the specified matching options and time-out interval.</span></span></summary>
        <returns>
          <span data-ttu-id="a2b9d-701">如果規則運算式尋找到符合項目，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-701"><see langword="true" /> if the regular expression finds a match; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-702"><xref:System.Text.RegularExpressions.Regex.IsMatch%2A>方法通常用來驗證該字串，或確保字串符合特定模式而不擷取做後續操作該字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-702">The <xref:System.Text.RegularExpressions.Regex.IsMatch%2A> method is typically used to validate a string or to ensure that a string conforms to a particular pattern without retrieving that string for subsequent manipulation.</span></span> <span data-ttu-id="a2b9d-703">如果要判斷是否有一個或多個字串符合規則運算式模式，然後再擷取做後續操作，請呼叫 <xref:System.Text.RegularExpressions.Regex.Match%2A> 或 <xref:System.Text.RegularExpressions.Regex.Matches%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-703">If you want to determine whether one or more strings match a regular expression pattern and then retrieve them for subsequent manipulation, call the <xref:System.Text.RegularExpressions.Regex.Match%2A> or <xref:System.Text.RegularExpressions.Regex.Matches%2A> method.</span></span>  
  
 <span data-ttu-id="a2b9d-704">靜態<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件與所指定的規則運算式模式`pattern`和所指定的規則運算式選項`options`，然後呼叫<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%29>執行個體方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-704">The static <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> method is equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the regular expression pattern specified by `pattern` and the regular expression options specified by `options` and calling the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%29> instance method.</span></span> <span data-ttu-id="a2b9d-705">這個規則運算式模式的規則運算式引擎會快取供快速擷取。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-705">This regular expression pattern is cached for rapid retrieval by the regular expression engine.</span></span>  
  
 <span data-ttu-id="a2b9d-706">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-706">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-707">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-707">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-708">`matchTimeout`參數會指定如何長模式比對方法應嘗試尋找相符項目，即會逾時。設定逾時間隔可避免依賴大量回溯出現停止回應時，它們會處理輸入的規則運算式，其中包含相符項目附近。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-708">The `matchTimeout` parameter specifies how long a pattern matching method should try to find a match before it times out. Setting a time-out interval prevents regular expressions that rely on excessive backtracking from appearing to stop responding when they process input that contains near matches.</span></span> <span data-ttu-id="a2b9d-709">如需詳細資訊，請參閱[規則運算式的最佳作法](~/docs/standard/base-types/best-practices.md)和[回溯](~/docs/standard/base-types/backtracking-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-709">For more information, see [Best Practices for Regular Expressions](~/docs/standard/base-types/best-practices.md) and [Backtracking](~/docs/standard/base-types/backtracking-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-710">如果該時間間隔中找到相符項目，方法會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-710">If no match is found in that time interval, the method throws a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-711">`matchTimeout` 覆寫任何方法執行於其中的應用程式定義域定義的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-711">`matchTimeout` overrides any default time-out value defined for the application domain in which the method executes.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-712">下列範例說明使用<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>方法來判斷字串是否為有效的組件數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-712">The following example illustrates the use of the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> method to determine whether a string is a valid part number.</span></span> <span data-ttu-id="a2b9d-713">規則運算式會假設零件編號有三種以連字號分隔的字元組所組成的特定格式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-713">The regular expression assumes that the part number has a specific format that consists of three sets of characters separated by hyphens.</span></span> <span data-ttu-id="a2b9d-714">第一個集合，其中包含四個字元，必須包含後面兩個數值的字元，後面接著英數字元的英數字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-714">The first set, which contains four characters, must consist of an alphanumeric character followed by two numeric characters followed by an alphanumeric character.</span></span> <span data-ttu-id="a2b9d-715">第二個集合，其中包含三個字元，必須是數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-715">The second set, which consists of three characters, must be numeric.</span></span> <span data-ttu-id="a2b9d-716">第三個集合，其中包含四個字元，必須有三個數字字元，後面接著英數字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-716">The third set, which consists of four characters, must have three numeric characters followed by an alphanumeric character.</span></span> <span data-ttu-id="a2b9d-717">比對規則運算式模式，應該包含最少搜尋整個輸入字串中，所以方法設定的 500 毫秒的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-717">Matching the regular expression pattern should involve minimal searching through the input string, so the method sets a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.IsMatch#5](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ismatch/cs/ismatch5.cs#5)]
 [!code-vb[System.Text.RegularExpressions.Regex.IsMatch#5](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.ismatch/vb/ismatch5.vb#5)]  
  
 <span data-ttu-id="a2b9d-718">規則運算式模式為：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-718">The regular expression pattern is:</span></span>  
  
```  
^[A-Z0-9]\d{2}[A-Z0-9](-\d{3}){2}[A-Z0-9]$  
```  
  
 <span data-ttu-id="a2b9d-719">下表顯示規則運算式模式的解譯方式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-719">The following table shows how the regular expression pattern is interpreted.</span></span>  
  
|<span data-ttu-id="a2b9d-720">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-720">Pattern</span></span>|<span data-ttu-id="a2b9d-721">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-721">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="a2b9d-722">從字串的開頭開始比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-722">Begin the match at the beginning of the string.</span></span>|  
|`[A-Z0-9]`|<span data-ttu-id="a2b9d-723">比對任何單一字母字元，從`A`透過`Z`，或任何數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-723">Match any single alphabetic character from `A` through `Z`, or any numeric character.</span></span>|  
|`\d{2}`|<span data-ttu-id="a2b9d-724">比對兩個數值字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-724">Match two numeric characters.</span></span>|  
|`[A-Z0-9]`|<span data-ttu-id="a2b9d-725">比對任何單一字母字元，從`A`透過`Z`，或任何數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-725">Match any single alphabetic character from `A` through `Z`, or any numeric character.</span></span>|  
|`-`|<span data-ttu-id="a2b9d-726">比對連字號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-726">Match a hyphen.</span></span>|  
|`\d{3}`|<span data-ttu-id="a2b9d-727">比對三個數值字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-727">Match exactly three numeric characters.</span></span>|  
|`(-\d{3}){2}`|<span data-ttu-id="a2b9d-728">找出連字號後面接著三個數字字元，並符合此模式的兩個項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-728">Find a hyphen followed by three numeric characters, and match two occurrences of this pattern.</span></span>|  
|`[A-Z0-9]`|<span data-ttu-id="a2b9d-729">比對任何單一字母字元，從`A`透過`Z`，或任何數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-729">Match any single alphabetic character from `A` through `Z`, or any numeric character.</span></span>|  
|`$`|<span data-ttu-id="a2b9d-730">在字串的結尾結束比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-730">End the match at the end of the string.</span></span>|  
  
 <span data-ttu-id="a2b9d-731">呼叫<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>方法`options`參數設定為<xref:System.Text.RegularExpressions.RegexOptions.IgnoreCase?displayProperty=nameWithType>相當於定義下列規則運算式：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-731">Calling the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> method with the `options` parameter set to <xref:System.Text.RegularExpressions.RegexOptions.IgnoreCase?displayProperty=nameWithType> is equivalent to defining the following regular expression:</span></span>  
  
```  
[a-zA-Z0-9]\d{2}[a-zA-Z0-9](-\d{3}){2}[A-Za-z0-9]  
```  
  
 <span data-ttu-id="a2b9d-732">進行比較，請參閱範例<xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-732">For comparison, see the example for the <xref:System.Text.RegularExpressions.Regex.IsMatch%28System.String%2CSystem.String%29> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-733">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-733">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-734"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-734"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-735"><paramref name="options" /> 不是有效的 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-735"><paramref name="options" /> is not a valid <see cref="T:System.Text.RegularExpressions.RegexOptions" /> value.</span></span>  
  
 <span data-ttu-id="a2b9d-736">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-736">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-737"><paramref name="matchTimeout" /> 為負數、零或大約大於 24 天。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-737"><paramref name="matchTimeout" /> is negative, zero, or greater than approximately 24 days.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-738">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-738">A time-out occurred.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-739">我們建議您將<paramref name="matchTimeout" />參數，以適當的值，例如兩秒。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-739">We recommend that you set the <paramref name="matchTimeout" /> parameter to an appropriate value, such as two seconds.</span></span> <span data-ttu-id="a2b9d-740">如果您停用逾時指定<see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，規則運算式引擎會提供稍微較佳的效能。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-740">If you disable time-outs by specifying <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, the regular expression engine offers slightly better performance.</span></span> <span data-ttu-id="a2b9d-741">不過，您應該停用逾時，只有在下列情況下：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-741">However, you should disable time-outs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="a2b9d-742">當規則運算式所處理的輸入衍生自已知且受信任的來源，或包含靜態文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-742">When the input processed by a regular expression is derived from a known and trusted source or consists of static text.</span></span> <span data-ttu-id="a2b9d-743">這不包括已動態使用者所輸入的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-743">This excludes text that has been dynamically input by users.</span></span>  
  
-   <span data-ttu-id="a2b9d-744">當規則運算式模式已徹底測試以確保它有效率地處理符合，不符合，不久符合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-744">When the regular expression pattern has been thoroughly tested to ensure that it efficiently handles matches, non-matches, and near matches.</span></span>  
  
-   <span data-ttu-id="a2b9d-745">當規則運算式模式包含已知會造成大量回溯處理接近的相符項目時沒有語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-745">When the regular expression pattern contains no language elements that are known to cause excessive backtracking when processing a near match.</span></span></para>
        </block>
      </Docs>
    </Member>
    <MemberGroup MemberName="Match">
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="a2b9d-746">在輸入字串搜尋規則運算式的項目，並傳回正確結果為單一 <see cref="T:System.Text.RegularExpressions.Match" /> 物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-746">Searches an input string for a substring that matches a regular expression pattern and returns the first occurrence as a single <see cref="T:System.Text.RegularExpressions.Match" /> object.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Match">
      <MemberSignature Language="C#" Value="public System.Text.RegularExpressions.Match Match (string input);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Text.RegularExpressions.Match Match(string input) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Match(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function Match (input As String) As Match" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Text::RegularExpressions::Match ^ Match(System::String ^ input);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.Match</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-747">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-747">The string to search for a match.</span></span></param>
        <summary><span data-ttu-id="a2b9d-748">在指定的輸入字串中，搜尋符合 <see cref="T:System.Text.RegularExpressions.Regex" /> 建構函式中所指定規則運算式的第一個項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-748">Searches the specified input string for the first occurrence of the regular expression specified in the <see cref="T:System.Text.RegularExpressions.Regex" /> constructor.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-749">物件，包含符合之項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-749">An object that contains information about the match.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-750"><xref:System.Text.RegularExpressions.Regex.Match%28System.String%29>方法會傳回符合指定之規則運算式模式，在輸入字串的第一個子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-750">The <xref:System.Text.RegularExpressions.Regex.Match%28System.String%29> method returns the first substring that matches a regular expression pattern in an input string.</span></span> <span data-ttu-id="a2b9d-751">如需用來建立規則運算式模式之語言項目的資訊，請參閱[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-751">For information about the language elements used to build a regular expression pattern, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-752">您可以判斷是否規則運算式模式發現輸入字串中檢查傳回的值<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Group.Success%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-752">You can determine whether the regular expression pattern has been found in the input string by checking the value of the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Group.Success%2A> property.</span></span> <span data-ttu-id="a2b9d-753">如果找到符合的項目，則所傳回 <xref:System.Text.RegularExpressions.Match> 物件的 <xref:System.Text.RegularExpressions.Capture.Value%2A> 屬性會包含符合規則運算式模式之 `input` 的子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-753">If a match is found, the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Capture.Value%2A> property contains the substring from `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-754">如果找到相符項目，其值是<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-754">If no match is found, its value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="a2b9d-755">這個方法會傳回第一個子字串，在`input`符合規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-755">This method returns the first substring in `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-756">您可以擷取後續相符項目的重複呼叫傳回<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-756">You can retrieve subsequent matches by repeatedly calling the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="a2b9d-757">您也可以藉由呼叫來擷取單一方法呼叫中的所有相符項目<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-757">You can also retrieve all matches in a single method call by calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="a2b9d-758">如果比對作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-758">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the matching operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-759">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-759">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-760">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-760">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-761">下列範例會尋找規則運算式模式比對在字串中，然後列出相符群組、 擷取和擷取位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-761">The following example finds regular expression pattern matches in a string, then lists the matched groups, captures, and capture positions.</span></span>  
  
 [!code-cpp[Regex Match, NextMatch, Groups, Captures#8](~/samples/snippets/cpp/VS_Snippets_CLR/regex match, nextmatch, groups, captures/cpp/snippet8.cpp#8)]
 [!code-csharp[Regex Match, NextMatch, Groups, Captures#8](~/samples/snippets/csharp/VS_Snippets_CLR/regex match, nextmatch, groups, captures/cs/snippet8.cs#8)]
 [!code-vb[Regex Match, NextMatch, Groups, Captures#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/regex match, nextmatch, groups, captures/vb/snippet8.vb#8)]  
  
 <span data-ttu-id="a2b9d-762">規則運算式模式`(\w+)\s+(car)`比對的以及它前面的文字，"car"這個字的項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-762">The regular expression pattern `(\w+)\s+(car)` matches occurrences of the word "car" along with the word that precedes it.</span></span> <span data-ttu-id="a2b9d-763">它被解譯為下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-763">It is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-764">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-764">Pattern</span></span>|<span data-ttu-id="a2b9d-765">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-765">Description</span></span>|  
|-------------|-----------------|  
|`(\w+)`|<span data-ttu-id="a2b9d-766">比對一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-766">Match one or more word characters.</span></span> <span data-ttu-id="a2b9d-767">這是第一個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-767">This is the first capturing group.</span></span>|  
|`\s+`|<span data-ttu-id="a2b9d-768">比對一個或多個空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-768">Match one or more white-space characters.</span></span>|  
|<span data-ttu-id="a2b9d-769">(car)</span><span class="sxs-lookup"><span data-stu-id="a2b9d-769">(car)</span></span>|<span data-ttu-id="a2b9d-770">比對常值字串"car"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-770">Match the literal string "car".</span></span> <span data-ttu-id="a2b9d-771">這是第二個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-771">This is the second capturing group.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-772"><paramref name="input" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-772"><paramref name="input" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-773">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-773">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-774">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-774">For more information about time-outs, see the Remarks section.</span></span></exception>
        <altmember cref="M:System.Text.RegularExpressions.Match.NextMatch" />
      </Docs>
    </Member>
    <Member MemberName="Match">
      <MemberSignature Language="C#" Value="public System.Text.RegularExpressions.Match Match (string input, int startat);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Text.RegularExpressions.Match Match(string input, int32 startat) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Match(System.String,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Match (input As String, startat As Integer) As Match" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Text::RegularExpressions::Match ^ Match(System::String ^ input, int startat);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.Match</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="startat" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-775">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-775">The string to search for a match.</span></span></param>
        <param name="startat"><span data-ttu-id="a2b9d-776">要開始搜尋之以零為起始的字元位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-776">The zero-based character position at which to start the search.</span></span></param>
        <summary><span data-ttu-id="a2b9d-777">從字串中指定的開始位置開始，在輸入字串中搜尋規則運算式的第一個相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-777">Searches the input string for the first occurrence of a regular expression, beginning at the specified starting position in the string.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-778">物件，包含符合之項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-778">An object that contains information about the match.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-779"><xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%29>方法會傳回符合規則運算式模式，從上或之後的第一個子字串`startat`字元在輸入字串的位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-779">The <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%29> method returns the first substring that matches a regular expression pattern, starting at or after the `startat` character position, in an input string.</span></span> <span data-ttu-id="a2b9d-780">如需用來建立規則運算式模式之語言項目的資訊，請參閱[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-780">For information about the language elements used to build a regular expression pattern, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-781">規則運算式模式的<xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%29>方法會搜尋由呼叫其中一種定義<xref:System.Text.RegularExpressions.Regex>類別建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-781">The regular expression pattern for which the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%29> method searches is defined by the call to one of the <xref:System.Text.RegularExpressions.Regex> class constructors.</span></span> <span data-ttu-id="a2b9d-782">如需可用以構成規則運算式模式的項目，請參閱[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-782">For more information about the elements that can form a regular expression pattern, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-783">您可以使用，以選擇性地指定字串中的開始位置`startat`參數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-783">You can optionally specify a starting position in the string by using the `startat` parameter.</span></span> <span data-ttu-id="a2b9d-784">當規則運算式引擎會剖析從左到右 （預設值） 時，比對和掃描移動 rightward，開始在指定的字元`startat`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-784">When the regular expression engine parses from left to right (the default), the match and the scan move rightward, starting at the character specified in `startat`.</span></span> <span data-ttu-id="a2b9d-785">當規則運算式引擎會剖析由右至左 (當規則運算式模式，建構<xref:System.Text.RegularExpressions.RegexOptions.RightToLeft?displayProperty=nameWithType>選項)，比對和掃描相反的方向移動，開頭處的字元`startat`-1。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-785">When the regular expression engine parses from right to left (when the regular expression pattern is constructed with the <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft?displayProperty=nameWithType> option), the match and scan move in the opposite direction and begin with the character at `startat` -1.</span></span> <span data-ttu-id="a2b9d-786">如果您未指定的開始位置，則會搜尋為預設值`startat`位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-786">If you do not specify a starting position, the search begins at the default `startat` position.</span></span> <span data-ttu-id="a2b9d-787">如果規則運算式搜尋從左到右，從預設`startat`位置位於左側`input`; 如果它會搜尋由右至左、 預設`startat`位置位於右邊`input`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-787">If the regular expression searches from left to right, the default `startat` position is at the left end of `input`; if it searches from right to left, the default `startat` position is at the right end of `input`.</span></span>  
  
 <span data-ttu-id="a2b9d-788">如果您想要限制相符項目，讓它在字串中特定的字元位置開始，並比對規則運算式引擎不會掃描字串的其餘部分，錨定的規則運算式與`\G`（左邊的左到右模式中，或由右至左模式右邊)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-788">If you want to restrict a match so that it begins at a particular character position in the string and the regular expression engine does not scan the remainder of the string for a match, anchor the regular expression with a `\G` (at the left for a left-to-right pattern, or at the right for a right-to-left pattern).</span></span> <span data-ttu-id="a2b9d-789">這會限制比對，因此它必須剛好在啟動`startat`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-789">This restricts the match so it must start exactly at `startat`.</span></span>  
  
 <span data-ttu-id="a2b9d-790">您可以判斷是否規則運算式模式發現輸入字串中檢查傳回的值<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Group.Success%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-790">You can determine whether the regular expression pattern has been found in the input string by checking the value of the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Group.Success%2A> property.</span></span> <span data-ttu-id="a2b9d-791">如果找到符合的項目，則所傳回 <xref:System.Text.RegularExpressions.Match> 物件的 <xref:System.Text.RegularExpressions.Capture.Value%2A> 屬性會包含符合規則運算式模式之 `input` 的子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-791">If a match is found, the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Capture.Value%2A> property contains the substring from `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-792">如果找到相符項目，其值是<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-792">If no match is found, its value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="a2b9d-793">這個方法會傳回找到在或之後的第一個子字串`startat`字元位置`input`符合規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-793">This method returns the first substring found at or after the `startat` character position in `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-794">您可以擷取後續相符項目的重複呼叫傳回<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-794">You can retrieve subsequent matches by repeatedly calling the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="a2b9d-795">您也可以藉由呼叫來擷取單一方法呼叫中的所有相符項目<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-795">You can also retrieve all matches in a single method call by calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="a2b9d-796">如果比對作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-796">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the matching operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-797">如果當您呼叫建構函式時未設定逾時間隔，若作業 exeeds 所在的應用程式定義域建立任何逾時值，會擲回例外狀況<xref:System.Text.RegularExpressions.Regex>建立物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-797">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exeeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-798">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-798">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-799"><paramref name="input" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-799"><paramref name="input" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-800"><paramref name="startat" /> 小於零或大於 <paramref name="input" /> 的長度。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-800"><paramref name="startat" /> is less than zero or greater than the length of <paramref name="input" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-801">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-801">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-802">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-802">For more information about time-outs, see the Remarks section.</span></span></exception>
        <altmember cref="M:System.Text.RegularExpressions.Match.NextMatch" />
      </Docs>
    </Member>
    <Member MemberName="Match">
      <MemberSignature Language="C#" Value="public static System.Text.RegularExpressions.Match Match (string input, string pattern);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Text.RegularExpressions.Match Match(string input, string pattern) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Match(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Match (input As String, pattern As String) As Match" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Text::RegularExpressions::Match ^ Match(System::String ^ input, System::String ^ pattern);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.Match</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-803">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-803">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-804">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-804">The regular expression pattern to match.</span></span></param>
        <summary><span data-ttu-id="a2b9d-805">在指定的輸入字串中搜尋所指定規則運算式的第一個相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-805">Searches the specified input string for the first occurrence of the specified regular expression.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-806">物件，包含符合之項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-806">An object that contains information about the match.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-807"><xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29>方法會傳回符合指定之規則運算式模式，在輸入字串的第一個子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-807">The <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29> method returns the first substring that matches a regular expression pattern in an input string.</span></span> <span data-ttu-id="a2b9d-808">如需用來建立規則運算式模式之語言項目的資訊，請參閱[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-808">For information about the language elements used to build a regular expression pattern, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-809">靜態<xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29>方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件與指定的規則運算式模式，並呼叫執行個體<xref:System.Text.RegularExpressions.Regex.Match%28System.String%29>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-809">The static <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29> method is equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the specified regular expression pattern and calling the instance <xref:System.Text.RegularExpressions.Regex.Match%28System.String%29> method.</span></span> <span data-ttu-id="a2b9d-810">在此情況下，規則運算式引擎會快取的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-810">In this case, the regular expression engine caches the regular expression pattern.</span></span>  
  
 <span data-ttu-id="a2b9d-811">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-811">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-812">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-812">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-813">您可以判斷是否規則運算式模式發現輸入字串中檢查傳回的值<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Group.Success%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-813">You can determine whether the regular expression pattern has been found in the input string by checking the value of the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Group.Success%2A> property.</span></span> <span data-ttu-id="a2b9d-814">如果找到符合的項目，則所傳回 <xref:System.Text.RegularExpressions.Match> 物件的 <xref:System.Text.RegularExpressions.Capture.Value%2A> 屬性會包含符合規則運算式模式之 `input` 的子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-814">If a match is found, the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Capture.Value%2A> property contains the substring from `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-815">如果找到相符項目，其值是<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-815">If no match is found, its value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="a2b9d-816">這個方法會傳回第一個子字串，在`input`符合規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-816">This method returns the first substring in `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-817">您可以擷取後續相符項目的重複呼叫傳回<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-817">You can retrieve subsequent matches by repeatedly calling the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="a2b9d-818">您也可以藉由呼叫來擷取單一方法呼叫中的所有相符項目<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-818">You can also retrieve all matches in a single method call by calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="a2b9d-819">如果比對作業的執行時間超出為呼叫方法的應用程式定義域指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-819">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the matching operation exceeds the time-out interval specified for the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-820">如果在應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-820">If no time-out is defined in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-821">下列範例會呼叫<xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29>方法來尋找第一個單字，其中包含至少一個`z`字元，然後呼叫<xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>方法來尋找任何其他相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-821">The following example calls the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29> method to find the first word that contains at least one `z` character, and then calls the <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method to find any additional matches.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Match#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.match/cs/match1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Match#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.match/vb/match1.vb#1)]  
  
 <span data-ttu-id="a2b9d-822">規則運算式模式 `\b\w*z+\w*\b` 的解譯方式如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-822">The regular expression pattern `\b\w*z+\w*\b` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-823">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-823">Pattern</span></span>|<span data-ttu-id="a2b9d-824">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-824">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="a2b9d-825">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-825">Begin the match at a word boundary.</span></span>|  
|`\w*`|<span data-ttu-id="a2b9d-826">比對零個、 一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-826">Match zero, one, or more word characters.</span></span>|  
|`z+`|<span data-ttu-id="a2b9d-827">比對一個或多個`z`字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-827">Match one or more occurrences of the `z` character.</span></span>|  
|`\w*`|<span data-ttu-id="a2b9d-828">比對零個、 一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-828">Match zero, one, or more word characters.</span></span>|  
|`\b`|<span data-ttu-id="a2b9d-829">結束字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-829">End the match at a word boundary.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-830">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-830">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-831"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-831"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-832">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-832">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-833">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-833">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-834">這個方法的逾時間隔等於呼叫這個方法的應用程式定義域的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-834">This method times out after an interval that is equal to the default time-out value of the application domain in which it is called.</span></span> <span data-ttu-id="a2b9d-835">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-835">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-836">建議的靜態方法來擷取模式比對是<see cref="M:System.Text.RegularExpressions.Regex.Match(System.String,System.String)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-836">The recommended static method for retrieving a pattern match is <see cref="M:System.Text.RegularExpressions.Regex.Match(System.String,System.String)" />, which lets you set the time-out interval.</span></span></para>
        </block>
        <altmember cref="M:System.Text.RegularExpressions.Match.NextMatch" />
      </Docs>
    </Member>
    <Member MemberName="Match">
      <MemberSignature Language="C#" Value="public System.Text.RegularExpressions.Match Match (string input, int beginning, int length);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Text.RegularExpressions.Match Match(string input, int32 beginning, int32 length) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Match(System.String,System.Int32,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Match (input As String, beginning As Integer, length As Integer) As Match" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Text::RegularExpressions::Match ^ Match(System::String ^ input, int beginning, int length);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.Match</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="beginning" Type="System.Int32" />
        <Parameter Name="length" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-837">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-837">The string to search for a match.</span></span></param>
        <param name="beginning"><span data-ttu-id="a2b9d-838">定義要搜尋的最左邊位置的輸入字串中以零為起始的字元位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-838">The zero-based character position in the input string that defines the leftmost position to be searched.</span></span></param>
        <param name="length"><span data-ttu-id="a2b9d-839">子字串中要包含在搜尋中的字元數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-839">The number of characters in the substring to include in the search.</span></span></param>
        <summary><span data-ttu-id="a2b9d-840">從指定的開始位置開始並且僅搜尋指定數目的字元，在輸入字串中搜尋規則運算式的第一個相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-840">Searches the input string for the first occurrence of a regular expression, beginning at the specified starting position and searching only the specified number of characters.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-841">物件，包含符合之項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-841">An object that contains information about the match.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-842"><xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%2CSystem.Int32%29>方法會傳回第一個子字串符合規則運算式模式中輸入字串的一部分。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-842">The <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%2CSystem.Int32%29> method returns the first substring that matches a regular expression pattern in a portion of an input string.</span></span> <span data-ttu-id="a2b9d-843">如需用來建立規則運算式模式之語言項目的資訊，請參閱[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-843">For information about the language elements used to build a regular expression pattern, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-844">規則運算式模式的<xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%2CSystem.Int32%29>方法會搜尋由呼叫其中一種定義<xref:System.Text.RegularExpressions.Regex>類別建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-844">The regular expression pattern for which the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%2CSystem.Int32%29> method searches is defined by the call to one of the <xref:System.Text.RegularExpressions.Regex> class constructors.</span></span> <span data-ttu-id="a2b9d-845">如需可用以構成規則運算式模式的項目，請參閱[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-845">For more information about the elements that can form a regular expression pattern, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-846"><xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%2CSystem.Int32%29>方法搜尋的部份`input`所定義`beginning`和`length`規則運算式模式的參數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-846">The <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%2CSystem.Int32%29> method searches the portion of `input` defined by the `beginning` and `length` parameters for the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-847">`beginning` 永遠會定義要包含在搜尋中，最左邊字元的索引和`length`定義要搜尋的字元數目上限。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-847">`beginning` always defines the index of the leftmost character to include in the search, and `length` defines the maximum number of characters to search.</span></span> <span data-ttu-id="a2b9d-848">同時，會定義搜尋的範圍。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-848">Together, they define the range of the search.</span></span> <span data-ttu-id="a2b9d-849">如果搜尋會繼續從左到右 （預設值），規則運算式引擎會搜尋索引處的字元從`beginning`索引處的字元`beginning`  +  `length` – 1。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-849">If the search proceeds from left to right (the default), the regular expression engine searches from the character at index `beginning` to the character at index `beginning` + `length` – 1.</span></span> <span data-ttu-id="a2b9d-850">如果使用的規則運算式引擎未具現化<xref:System.Text.RegularExpressions.RegexOptions.RightToLeft?displayProperty=nameWithType>選項，讓搜尋繼續由右至左，請從索引處的字元，規則運算式引擎搜尋`beginning`  +  `length` – 1 到字元索引處`beginning`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-850">If the regular expression engine was instantiated by using the <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft?displayProperty=nameWithType> option so that the search proceeds from right to left, the regular expression engine searches from the character at index `beginning` + `length` – 1 to the character at index `beginning`.</span></span> <span data-ttu-id="a2b9d-851">這個方法會傳回此範圍內找到的第一個相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-851">This method returns the first match that it finds within this range.</span></span> <span data-ttu-id="a2b9d-852">您可以擷取後續相符項目的重複呼叫傳回<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-852">You can retrieve subsequent matches by repeatedly calling the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Match.NextMatch%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="a2b9d-853">您可以判斷是否規則運算式模式發現輸入字串中檢查傳回的值<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Group.Success%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-853">You can determine whether the regular expression pattern has been found in the input string by checking the value of the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Group.Success%2A> property.</span></span> <span data-ttu-id="a2b9d-854">如果找到符合的項目，則所傳回 <xref:System.Text.RegularExpressions.Match> 物件的 <xref:System.Text.RegularExpressions.Capture.Value%2A> 屬性會包含符合規則運算式模式之 `input` 的子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-854">If a match is found, the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Capture.Value%2A> property contains the substring from `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-855">如果找到相符項目，其值是<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-855">If no match is found, its value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="a2b9d-856">如果比對作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-856">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the matching operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-857">如果您未設定逾時值，當您呼叫建構函式時，如果作業超過任何逾時值的應用程式定義域中，會擲回例外狀況<xref:System.Text.RegularExpressions.Regex>建立物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-857">If you do not set a time-out value when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-858">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-858">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-859"><paramref name="input" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-859"><paramref name="input" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-860"><paramref name="beginning" /> 小於零或大於 <paramref name="input" /> 的長度。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-860"><paramref name="beginning" /> is less than zero or greater than the length of <paramref name="input" />.</span></span>  
  
 <span data-ttu-id="a2b9d-861">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-861">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-862"><paramref name="length" /> 小於零或大於 <paramref name="input" /> 的長度。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-862"><paramref name="length" /> is less than zero or greater than the length of <paramref name="input" />.</span></span>  
  
 <span data-ttu-id="a2b9d-863">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-863">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-864"><paramref name="beginning" /><see langword="+" /><paramref name="length" /><see langword="–1" /> 識別 <paramref name="input" /> 範圍之外的位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-864"><paramref name="beginning" /><see langword="+" /><paramref name="length" /><see langword="–1" /> identifies a position that is outside the range of <paramref name="input" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-865">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-865">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-866">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-866">For more information about time-outs, see the Remarks section.</span></span></exception>
        <altmember cref="M:System.Text.RegularExpressions.Match.NextMatch" />
      </Docs>
    </Member>
    <Member MemberName="Match">
      <MemberSignature Language="C#" Value="public static System.Text.RegularExpressions.Match Match (string input, string pattern, System.Text.RegularExpressions.RegexOptions options);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Text.RegularExpressions.Match Match(string input, string pattern, valuetype System.Text.RegularExpressions.RegexOptions options) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Match(System.String,System.String,System.Text.RegularExpressions.RegexOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Match (input As String, pattern As String, options As RegexOptions) As Match" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Text::RegularExpressions::Match ^ Match(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::RegexOptions options);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.Match</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-867">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-867">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-868">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-868">The regular expression pattern to match.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-869">列舉值的位元組合，提供用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-869">A bitwise combination of the enumeration values that provide options for matching.</span></span></param>
        <summary><span data-ttu-id="a2b9d-870">使用指定的比對選項，在輸入字串中搜尋所指定規則運算式的第一個相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-870">Searches the input string for the first occurrence of the specified regular expression, using the specified matching options.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-871">物件，包含符合之項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-871">An object that contains information about the match.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-872"><xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29>方法會傳回符合指定之規則運算式模式，在輸入字串的第一個子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-872">The <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29> method returns the first substring that matches a regular expression pattern in an input string.</span></span> <span data-ttu-id="a2b9d-873">如需用來建立規則運算式模式之語言項目的資訊，請參閱[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-873">For information about the language elements used to build a regular expression pattern, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-874">靜態<xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29>方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%29>建構函式和呼叫執行個體<xref:System.Text.RegularExpressions.Regex.Match%28System.String%29>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-874">The static <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29> method is equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%29> constructor and calling the instance <xref:System.Text.RegularExpressions.Regex.Match%28System.String%29> method.</span></span>  
  
 <span data-ttu-id="a2b9d-875">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-875">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-876">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-876">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-877">您可以判斷是否規則運算式模式發現輸入字串中檢查傳回的值<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Group.Success%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-877">You can determine whether the regular expression pattern has been found in the input string by checking the value of the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Group.Success%2A> property.</span></span> <span data-ttu-id="a2b9d-878">如果找到符合的項目，則所傳回 <xref:System.Text.RegularExpressions.Match> 物件的 <xref:System.Text.RegularExpressions.Capture.Value%2A> 屬性會包含符合規則運算式模式之 `input` 的子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-878">If a match is found, the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Capture.Value%2A> property contains the substring from `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-879">如果找到相符項目，其值是<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-879">If no match is found, its value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="a2b9d-880">這個方法會傳回第一個子字串中找到`input`符合規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-880">This method returns the first substring found in `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-881">您可以擷取後續相符項目的重複呼叫傳回<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Match.NextMatch%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-881">You can retrieve subsequent matches by repeatedly calling the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Match.NextMatch%2A> method.</span></span> <span data-ttu-id="a2b9d-882">您也可以藉由呼叫來擷取單一方法呼叫中的所有相符項目<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-882">You can also retrieve all matches in a single method call by calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="a2b9d-883">如果比對作業的執行時間超出為呼叫方法的應用程式定義域指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-883">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the matching operation exceeds the time-out interval specified for the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-884">如果在應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-884">If no time-out is defined in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-885">下列範例會定義規則運算式比對以字母開頭的文字，"a"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-885">The following example defines a regular expression that matches words beginning with the letter "a".</span></span> <span data-ttu-id="a2b9d-886">它會使用<xref:System.Text.RegularExpressions.RegexOptions.IgnoreCase?displayProperty=nameWithType>選項，以確保規則運算式會找出文字開頭為兩個以大寫"a"和小寫"a"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-886">It uses the <xref:System.Text.RegularExpressions.RegexOptions.IgnoreCase?displayProperty=nameWithType> option to ensure that the regular expression locates words beginning with both an uppercase "a" and a lowercase "a".</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Match#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.match/cs/match2.cs#2)]
 [!code-vb[System.Text.RegularExpressions.Regex.Match#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.match/vb/match2.vb#2)]  
  
 <span data-ttu-id="a2b9d-887">規則運算式模式 `\ba\w*\b` 的解譯方式如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-887">The regular expression pattern `\ba\w*\b` is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-888">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-888">Pattern</span></span>|<span data-ttu-id="a2b9d-889">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-889">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="a2b9d-890">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-890">Begin the match at a word boundary.</span></span>|  
|`a`|<span data-ttu-id="a2b9d-891">比對字元"a"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-891">Match the character "a".</span></span>|  
|`\w*`|<span data-ttu-id="a2b9d-892">比對零個、 一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-892">Match zero, one, or more word characters.</span></span>|  
|`\b`|<span data-ttu-id="a2b9d-893">結束字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-893">End the match at a word boundary.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-894">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-894">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-895"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-895"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-896"><paramref name="options" /> 不是 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值的有效位元組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-896"><paramref name="options" /> is not a valid bitwise combination of <see cref="T:System.Text.RegularExpressions.RegexOptions" /> values.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-897">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-897">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-898">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-898">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-899">這個方法的逾時間隔等於呼叫這個方法的應用程式定義域的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-899">This method times out after an interval that is equal to the default time-out value of the application domain in which it is called.</span></span> <span data-ttu-id="a2b9d-900">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-900">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-901">建議的靜態方法來擷取模式比對是<see cref="M:System.Text.RegularExpressions.Regex.Match(System.String,System.String)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-901">The recommended static method for retrieving a pattern match is <see cref="M:System.Text.RegularExpressions.Regex.Match(System.String,System.String)" />, which lets you set the time-out interval.</span></span></para>
        </block>
        <altmember cref="M:System.Text.RegularExpressions.Match.NextMatch" />
      </Docs>
    </Member>
    <Member MemberName="Match">
      <MemberSignature Language="C#" Value="public static System.Text.RegularExpressions.Match Match (string input, string pattern, System.Text.RegularExpressions.RegexOptions options, TimeSpan matchTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Text.RegularExpressions.Match Match(string input, string pattern, valuetype System.Text.RegularExpressions.RegexOptions options, valuetype System.TimeSpan matchTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Match(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Match (input As String, pattern As String, options As RegexOptions, matchTimeout As TimeSpan) As Match" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Text::RegularExpressions::Match ^ Match(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::RegexOptions options, TimeSpan matchTimeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.Match</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
        <Parameter Name="matchTimeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-902">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-902">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-903">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-903">The regular expression pattern to match.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-904">列舉值的位元組合，提供用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-904">A bitwise combination of the enumeration values that provide options for matching.</span></span></param>
        <param name="matchTimeout"><span data-ttu-id="a2b9d-905">間隔，若要表示此方法不會逾時則為 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-905">A time-out interval, or <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" /> to indicate that the method should not time out.</span></span></param>
        <summary><span data-ttu-id="a2b9d-906">使用指定的比對選項和逾時間隔，在輸入字串中搜尋所指定規則運算式的第一個相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-906">Searches the input string for the first occurrence of the specified regular expression, using the specified matching options and time-out interval.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-907">物件，包含符合之項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-907">An object that contains information about the match.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-908"><xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>方法會傳回符合指定之規則運算式模式，在輸入字串的第一個子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-908">The <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> method returns the first substring that matches a regular expression pattern in an input string.</span></span> <span data-ttu-id="a2b9d-909">如需用來建立規則運算式模式之語言項目的資訊，請參閱[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-909">For information about the language elements used to build a regular expression pattern, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-910">靜態<xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>建構函式和呼叫執行個體<xref:System.Text.RegularExpressions.Regex.Match%28System.String%29>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-910">The static <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> method is equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> constructor and calling the instance <xref:System.Text.RegularExpressions.Regex.Match%28System.String%29> method.</span></span>  
  
 <span data-ttu-id="a2b9d-911">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-911">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-912">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-912">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-913">您可以判斷是否規則運算式模式發現輸入字串中檢查傳回的值<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Group.Success%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-913">You can determine whether the regular expression pattern has been found in the input string by checking the value of the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Group.Success%2A> property.</span></span> <span data-ttu-id="a2b9d-914">如果找到符合的項目，則所傳回 <xref:System.Text.RegularExpressions.Match> 物件的 <xref:System.Text.RegularExpressions.Capture.Value%2A> 屬性會包含符合規則運算式模式之 `input` 的子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-914">If a match is found, the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Capture.Value%2A> property contains the substring from `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-915">如果找到相符項目，其值是<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-915">If no match is found, its value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="a2b9d-916">這個方法會傳回第一個子字串中找到`input`符合規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-916">This method returns the first substring found in `input` that matches the regular expression pattern.</span></span> <span data-ttu-id="a2b9d-917">您可以擷取後續相符項目的重複呼叫傳回<xref:System.Text.RegularExpressions.Match>物件的<xref:System.Text.RegularExpressions.Match.NextMatch%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-917">You can retrieve subsequent matches by repeatedly calling the returned <xref:System.Text.RegularExpressions.Match> object's <xref:System.Text.RegularExpressions.Match.NextMatch%2A> method.</span></span> <span data-ttu-id="a2b9d-918">您也可以藉由呼叫來擷取單一方法呼叫中的所有相符項目<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-918">You can also retrieve all matches in a single method call by calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="a2b9d-919">`matchTimeout`參數會指定如何長模式比對方法應嘗試尋找相符項目，即會逾時。設定逾時間隔可避免依賴大量回溯出現停止回應時，它們會處理輸入的規則運算式，其中包含相符項目附近。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-919">The `matchTimeout` parameter specifies how long a pattern matching method should try to find a match before it times out. Setting a time-out interval prevents regular expressions that rely on excessive backtracking from appearing to stop responding when they process input that contains near matches.</span></span> <span data-ttu-id="a2b9d-920">如需詳細資訊，請參閱[規則運算式的最佳作法](~/docs/standard/base-types/best-practices.md)和[回溯](~/docs/standard/base-types/backtracking-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-920">For more information, see [Best Practices for Regular Expressions](~/docs/standard/base-types/best-practices.md) and [Backtracking](~/docs/standard/base-types/backtracking-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-921">如果該時間間隔中找到相符項目，方法會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-921">If no match is found in that time interval, the method throws a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-922">`matchTimeout` 覆寫任何方法執行於其中的應用程式定義域定義的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-922">`matchTimeout` overrides any default time-out value defined for the application domain in which the method executes.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-923">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-923">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-924"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-924"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-925"><paramref name="options" /> 不是 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值的有效位元組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-925"><paramref name="options" /> is not a valid bitwise combination of <see cref="T:System.Text.RegularExpressions.RegexOptions" /> values.</span></span>  
  
 <span data-ttu-id="a2b9d-926">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-926">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-927"><paramref name="matchTimeout" /> 為負數、零或大約大於 24 天。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-927"><paramref name="matchTimeout" /> is negative, zero, or greater than approximately 24 days.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-928">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-928">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-929">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-929">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-930">我們建議您將<paramref name="matchTimeout" />參數，以適當的值，例如兩秒。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-930">We recommend that you set the <paramref name="matchTimeout" /> parameter to an appropriate value, such as two seconds.</span></span> <span data-ttu-id="a2b9d-931">如果您停用逾時指定<see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，規則運算式引擎會提供稍微較佳的效能。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-931">If you disable time-outs by specifying <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, the regular expression engine offers slightly better performance.</span></span> <span data-ttu-id="a2b9d-932">不過，您應該停用逾時，只有在下列情況下：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-932">However, you should disable time-outs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="a2b9d-933">當規則運算式所處理的輸入衍生自已知且受信任的來源，或包含靜態文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-933">When the input processed by a regular expression is derived from a known and trusted source or consists of static text.</span></span> <span data-ttu-id="a2b9d-934">這不包括已動態使用者所輸入的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-934">This excludes text that has been dynamically input by users.</span></span>  
  
-   <span data-ttu-id="a2b9d-935">當規則運算式模式已徹底測試以確保它有效率地處理符合，不符合，不久符合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-935">When the regular expression pattern has been thoroughly tested to ensure that it efficiently handles matches, non-matches, and near matches.</span></span>  
  
-   <span data-ttu-id="a2b9d-936">當規則運算式模式包含已知會造成大量回溯處理接近的相符項目時沒有語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-936">When the regular expression pattern contains no language elements that are known to cause excessive backtracking when processing a near match.</span></span></para>
        </block>
      </Docs>
    </Member>
    <MemberGroup MemberName="Matches">
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="a2b9d-937">在輸入字串中搜尋規則運算式的所有項目，並傳回所有符合項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-937">Searches an input string for all occurrences of a regular expression and returns all the matches.</span></span></summary>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-938">在比對嘗試藉由呼叫的重複當<see cref="Overload:System.Text.RegularExpressions.Regex.Matches" />方法，規則運算式引擎提供空白比對特殊處理。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-938">When a match attempt is repeated by calling the <see cref="Overload:System.Text.RegularExpressions.Regex.Matches" /> method, the regular expression engine gives empty matches special treatment.</span></span> <span data-ttu-id="a2b9d-939">通常，規則運算式引擎開始搜尋下一個相符項目剛好一個比對離開的地方。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-939">Usually, the regular expression engine begins the search for the next match exactly where the previous match left off.</span></span> <span data-ttu-id="a2b9d-940">不過之後空白的比對，, 規則運算式引擎前進一個字元之前嘗試下一個相符項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-940">However, after an empty match, the regular expression engine advances by one character before trying the next match.</span></span> <span data-ttu-id="a2b9d-941">此行為可確保規則運算式引擎會透過字串進度。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-941">This behavior guarantees that the regular expression engine will progress through the string.</span></span> <span data-ttu-id="a2b9d-942">否則，因為空的相符項目不會導致任何向前移動下, 一個相符項目會啟動在先前比對，完全相同的位置，它將會重複比對相同的空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-942">Otherwise, because an empty match does not result in any forward movement, the next match would start in exactly the same place as the previous match, and it would match the same empty string repeatedly.</span></span>  
  
 <span data-ttu-id="a2b9d-943">在下列範例中，規則運算式模式<c>\*</c>搜尋零或多個出現字母"a"，"abaabb"的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-943">In the following example, the regular expression pattern <c>a\*</c> searches for zero or more occurrences of the letter "a" in the string "abaabb".</span></span> <span data-ttu-id="a2b9d-944">此範例將示範，產生的輸出<see cref="T:System.Text.RegularExpressions.MatchCollection" />物件包含六個<see cref="T:System.Text.RegularExpressions.Match" />物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-944">As the output from the example shows, the resulting <see cref="T:System.Text.RegularExpressions.MatchCollection" /> object contains six <see cref="T:System.Text.RegularExpressions.Match" /> objects.</span></span> <span data-ttu-id="a2b9d-945">第一個比對嘗試尋找第一個"a"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-945">The first match attempt finds the first "a".</span></span> <span data-ttu-id="a2b9d-946">在完全第一個符合的第一個 b; 之前就會結束，其中的第二個相符項目啟動它會尋找"a"的零個項目，並傳回空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-946">The second match starts exactly where the first match ends, before the first b; it finds zero occurrences of "a" and returns an empty string.</span></span> <span data-ttu-id="a2b9d-947">第三個相符項目不是完全第二個比對結束的地方，因為第二個相符項目會傳回空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-947">The third match does not begin exactly where the second match ended, because the second match returned an empty string.</span></span> <span data-ttu-id="a2b9d-948">相反地，就會開始一個字元後第一個"b"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-948">Instead, it begins one character later, after the first "b".</span></span> <span data-ttu-id="a2b9d-949">第三個相符項目尋找兩個"a"，並傳回"aa"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-949">The third match finds two occurrences of "a" and returns "aa".</span></span> <span data-ttu-id="a2b9d-950">第四個比對嘗試開始，第三個相符項目之前已結束，第二個"b"，並傳回空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-950">The fourth match attempt begins where the third match ended, before the second "b", and returns an empty string.</span></span> <span data-ttu-id="a2b9d-951">第五個比對嘗試一次前進一個字元，因此第三個"b"之前開始，並傳回空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-951">The fifth match attempt again advances one character so that it begins before the third "b" and returns an empty string.</span></span> <span data-ttu-id="a2b9d-952">第六個相符項目開始之後最後一個"b"，並再次傳回空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-952">The sixth match begins after the last "b" and returns an empty string again.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#9](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/emptymatches1.cs#9)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#9](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/emptymatches1.vb#9)]</para>
        </block>
      </Docs>
    </MemberGroup>
    <Member MemberName="Matches">
      <MemberSignature Language="C#" Value="public System.Text.RegularExpressions.MatchCollection Matches (string input);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Text.RegularExpressions.MatchCollection Matches(string input) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Matches(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function Matches (input As String) As MatchCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Text::RegularExpressions::MatchCollection ^ Matches(System::String ^ input);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.MatchCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-953">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-953">The string to search for a match.</span></span></param>
        <summary><span data-ttu-id="a2b9d-954">在指定的輸入字串搜尋規則運算式的所有項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-954">Searches the specified input string for all occurrences of a regular expression.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-955">搜尋之後找到的 <see cref="T:System.Text.RegularExpressions.Match" /> 物件集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-955">A collection of the <see cref="T:System.Text.RegularExpressions.Match" /> objects found by the search.</span></span> <span data-ttu-id="a2b9d-956">如果找不到相符的項目，此方法會傳回空集合物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-956">If no matches are found, the method returns an empty collection object.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-957"><xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29>方法很類似<xref:System.Text.RegularExpressions.Regex.Match%28System.String%29>，而不是單一比對輸入字串中找到的方法，但是它會傳回所有相符項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-957">The <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29> method is similar to the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%29> method, except that it returns information about all the matches found in the input string, instead of a single match.</span></span> <span data-ttu-id="a2b9d-958">相當於下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-958">It is equivalent to the following code:</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#5](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/matchespattern.cs#5)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#5](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/matchespattern.vb#5)]  
  
 <span data-ttu-id="a2b9d-959">集合包含只有相符項目且結束於第一個不相符。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-959">The collection includes only matches and terminates at the first non-match.</span></span>  
  
 <span data-ttu-id="a2b9d-960">規則運算式模式的<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29>方法會搜尋由呼叫其中一種定義<xref:System.Text.RegularExpressions.Regex>類別建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-960">The regular expression pattern for which the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29> method searches is defined by the call to one of the <xref:System.Text.RegularExpressions.Regex> class constructors.</span></span> <span data-ttu-id="a2b9d-961">如需可用以構成規則運算式模式的項目，請參閱[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-961">For more information about the elements that can form a regular expression pattern, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-962"><xref:System.Text.RegularExpressions.Regex.Matches%2A>方法會使用延遲評估來填入傳回<xref:System.Text.RegularExpressions.MatchCollection>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-962">The <xref:System.Text.RegularExpressions.Regex.Matches%2A> method uses lazy evaluation to populate the returned <xref:System.Text.RegularExpressions.MatchCollection> object.</span></span> <span data-ttu-id="a2b9d-963">存取這個集合的成員 (例如 <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> 和 <xref:System.Text.RegularExpressions.MatchCollection.CopyTo%2A?displayProperty=nameWithType>) 會導致立即填入集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-963">Accessing members of this collection such as <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.MatchCollection.CopyTo%2A?displayProperty=nameWithType> causes the collection to be populated immediately.</span></span> <span data-ttu-id="a2b9d-964">若要利用延遲評估，您應該逐一查看集合所使用的建構，例如`foreach`在 C# 和`For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="a2b9d-964">To take advantage of lazy evaluation, you should iterate the collection by using a construct such as `foreach` in C# and `For Each`…`Next`</span></span> <span data-ttu-id="a2b9d-965">在 Visual Basic 中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-965">in Visual Basic.</span></span>  
  
 <span data-ttu-id="a2b9d-966">其延遲的評估，因為呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29>方法不會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-966">Because of its lazy evaluation, calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29> method does not throw a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-967">不過，擲回例外狀況上執行作業時<xref:System.Text.RegularExpressions.MatchCollection>傳回使用這個方法，如果物件<xref:System.Text.RegularExpressions.Regex.MatchTimeout%2A>屬性不是<xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>和比對作業超過逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-967">However, the exception is thrown when an operation is performed on the <xref:System.Text.RegularExpressions.MatchCollection> object returned by this method, if the <xref:System.Text.RegularExpressions.Regex.MatchTimeout%2A> property is not <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType> and a matching operation exceeds the time-out interval.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-968">下列範例會使用<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29>方法，以識別任何句子中的單字以"es"結尾。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-968">The following example uses the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29> method to identify any words in a sentence that end in "es".</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/matches1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/matches1.vb#1)]  
  
 <span data-ttu-id="a2b9d-969">規則運算式模式 `\b\w+es\b` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-969">The regular expression pattern `\b\w+es\b` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-970">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-970">Pattern</span></span>|<span data-ttu-id="a2b9d-971">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-971">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="a2b9d-972">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-972">Begin the match at a word boundary.</span></span>|  
|`\w+`|<span data-ttu-id="a2b9d-973">比對一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-973">Match one or more word characters.</span></span>|  
|`es`|<span data-ttu-id="a2b9d-974">比對常值字串"es"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-974">Match the literal string "es".</span></span>|  
|`\b`|<span data-ttu-id="a2b9d-975">結束字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-975">End the match at a word boundary.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-976"><paramref name="input" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-976"><paramref name="input" /> is <see langword="null" />.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Matches">
      <MemberSignature Language="C#" Value="public System.Text.RegularExpressions.MatchCollection Matches (string input, int startat);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Text.RegularExpressions.MatchCollection Matches(string input, int32 startat) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Matches(System.String,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Matches (input As String, startat As Integer) As MatchCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Text::RegularExpressions::MatchCollection ^ Matches(System::String ^ input, int startat);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.MatchCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="startat" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-977">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-977">The string to search for a match.</span></span></param>
        <param name="startat"><span data-ttu-id="a2b9d-978">在輸入字串中開始搜尋的字元位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-978">The character position in the input string at which to start the search.</span></span></param>
        <summary><span data-ttu-id="a2b9d-979">自字串中指定的開始位置開始，在指定的輸入字串搜尋規則運算式的所有項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-979">Searches the specified input string for all occurrences of a regular expression, beginning at the specified starting position in the string.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-980">搜尋之後找到的 <see cref="T:System.Text.RegularExpressions.Match" /> 物件集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-980">A collection of the <see cref="T:System.Text.RegularExpressions.Match" /> objects found by the search.</span></span> <span data-ttu-id="a2b9d-981">如果找不到相符的項目，此方法會傳回空集合物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-981">If no matches are found, the method returns an empty collection object.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-982"><xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29>方法很類似<xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%29>，而不是單一比對輸入字串中找到的方法，但是它會傳回所有相符項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-982">The  <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29> method is similar to the  <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.Int32%29> method, except that it returns information about all the matches found in the input string, instead of a single match.</span></span> <span data-ttu-id="a2b9d-983">相當於下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-983">It is equivalent to the following code:</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#6](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/matchespattern.cs#6)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#6](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/matchespattern.vb#6)]  
  
 <span data-ttu-id="a2b9d-984">規則運算式模式的<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29>方法會搜尋由呼叫其中一種定義<xref:System.Text.RegularExpressions.Regex>類別建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-984">The regular expression pattern for which the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29> method searches is defined by the call to one of the <xref:System.Text.RegularExpressions.Regex> class constructors.</span></span> <span data-ttu-id="a2b9d-985">如需可用以構成規則運算式模式的項目，請參閱[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-985">For more information about the elements that can form a regular expression pattern, see [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-986"><xref:System.Text.RegularExpressions.Regex.Matches%2A>方法會使用延遲評估來填入傳回<xref:System.Text.RegularExpressions.MatchCollection>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-986">The <xref:System.Text.RegularExpressions.Regex.Matches%2A> method uses lazy evaluation to populate the returned <xref:System.Text.RegularExpressions.MatchCollection> object.</span></span> <span data-ttu-id="a2b9d-987">存取這個集合的成員 (例如 <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> 和 <xref:System.Text.RegularExpressions.MatchCollection.CopyTo%2A?displayProperty=nameWithType>) 會導致立即填入集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-987">Accessing members of this collection such as <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.MatchCollection.CopyTo%2A?displayProperty=nameWithType> causes the collection to be populated immediately.</span></span> <span data-ttu-id="a2b9d-988">若要利用延遲評估，您應該逐一查看集合所使用的建構，例如`foreach`在 C# 和`For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="a2b9d-988">To take advantage of lazy evaluation, you should iterate the collection by using a construct such as `foreach` in C# and `For Each`…`Next`</span></span> <span data-ttu-id="a2b9d-989">在 Visual Basic 中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-989">in Visual Basic.</span></span>  
  
 <span data-ttu-id="a2b9d-990">其延遲的評估，因為呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29>方法不會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-990">Because of its lazy evaluation, calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29> method does not throw a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-991">不過，擲回例外狀況上執行作業時<xref:System.Text.RegularExpressions.MatchCollection>傳回使用這個方法，如果物件<xref:System.Text.RegularExpressions.Regex.MatchTimeout%2A>屬性不是<xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>和比對作業超過逾時間隔...</span><span class="sxs-lookup"><span data-stu-id="a2b9d-991">However, the exception is thrown when an operation is performed on the <xref:System.Text.RegularExpressions.MatchCollection> object returned by this method, if the <xref:System.Text.RegularExpressions.Regex.MatchTimeout%2A> property is not <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType> and a matching operation exceeds the time-out interval..</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-992">下列範例會使用<xref:System.Text.RegularExpressions.Regex.Match%28System.String%29>方法來尋找句子的結尾"es"，然後呼叫中的第一個單字<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29>方法，以找出以"es"結尾的任何其他文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-992">The following example uses the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%29> method to find the first word in a sentence that ends in "es", and then calls the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29> method to identify any additional words that end in "es".</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/matches3.cs#3)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/matches3.vb#3)]  
  
 <span data-ttu-id="a2b9d-993">規則運算式模式 `\b\w+es\b` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-993">The regular expression pattern `\b\w+es\b` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-994">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-994">Pattern</span></span>|<span data-ttu-id="a2b9d-995">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-995">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="a2b9d-996">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-996">Begin the match at a word boundary.</span></span>|  
|`\w+`|<span data-ttu-id="a2b9d-997">比對一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-997">Match one or more word characters.</span></span>|  
|`es`|<span data-ttu-id="a2b9d-998">比對常值字串"es"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-998">Match the literal string "es".</span></span>|  
|`\b`|<span data-ttu-id="a2b9d-999">結束字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-999">End the match at a word boundary.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1000"><paramref name="input" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1000"><paramref name="input" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1001"><paramref name="startat" /> 小於零或大於 <paramref name="input" /> 的長度。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1001"><paramref name="startat" /> is less than zero or greater than the length of <paramref name="input" />.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Matches">
      <MemberSignature Language="C#" Value="public static System.Text.RegularExpressions.MatchCollection Matches (string input, string pattern);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Text.RegularExpressions.MatchCollection Matches(string input, string pattern) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Matches(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Matches (input As String, pattern As String) As MatchCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Text::RegularExpressions::MatchCollection ^ Matches(System::String ^ input, System::String ^ pattern);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.MatchCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1002">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1002">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1003">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1003">The regular expression pattern to match.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1004">在指定的輸入字串搜尋所指定規則運算式的所有相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1004">Searches the specified input string for all occurrences of a specified regular expression.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1005">搜尋之後找到的 <see cref="T:System.Text.RegularExpressions.Match" /> 物件集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1005">A collection of the <see cref="T:System.Text.RegularExpressions.Match" /> objects found by the search.</span></span> <span data-ttu-id="a2b9d-1006">如果找不到相符的項目，此方法會傳回空集合物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1006">If no matches are found, the method returns an empty collection object.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1007"><xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29>方法很類似<xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29>，而不是單一比對輸入字串中找到的方法，但是它會傳回所有相符項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1007">The <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29> method is similar to the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%29> method, except that it returns information about all the matches found in the input string, instead of a single match.</span></span> <span data-ttu-id="a2b9d-1008">相當於下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1008">It is equivalent to the following code:</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#7](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/matchespattern.cs#7)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#7](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/matchespattern.vb#7)]  
  
 <span data-ttu-id="a2b9d-1009">靜態`Matches`方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件與指定的規則運算式模式，並呼叫的執行個體方法`Matches`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1009">The static `Matches` methods are equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the specified regular expression pattern and calling the instance method `Matches`.</span></span>  
  
 <span data-ttu-id="a2b9d-1010">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1010">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1011">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1011">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-1012"><xref:System.Text.RegularExpressions.Regex.Matches%2A>方法會使用延遲評估來填入傳回<xref:System.Text.RegularExpressions.MatchCollection>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1012">The <xref:System.Text.RegularExpressions.Regex.Matches%2A> method uses lazy evaluation to populate the returned <xref:System.Text.RegularExpressions.MatchCollection> object.</span></span> <span data-ttu-id="a2b9d-1013">存取這個集合的成員 (例如 <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> 和 <xref:System.Text.RegularExpressions.MatchCollection.CopyTo%2A?displayProperty=nameWithType>) 會導致立即填入集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1013">Accessing members of this collection such as <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.MatchCollection.CopyTo%2A?displayProperty=nameWithType> causes the collection to be populated immediately.</span></span> <span data-ttu-id="a2b9d-1014">若要利用延遲評估，您應該逐一查看集合所使用的建構，例如`foreach`在 C# 和`For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1014">To take advantage of lazy evaluation, you should iterate the collection by using a construct such as `foreach` in C# and `For Each`…`Next`</span></span> <span data-ttu-id="a2b9d-1015">在 Visual Basic 中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1015">in Visual Basic.</span></span>  
  
 <span data-ttu-id="a2b9d-1016">其延遲的評估，因為呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29>方法不會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1016">Because of its lazy evaluation, calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29> method does not throw a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-1017">不過，擲回例外狀況上執行作業時<xref:System.Text.RegularExpressions.MatchCollection>由這個方法傳回，如果逾時間隔由目前應用程式定義域和比對作業的 「 REGEX_DEFAULT_MATCH_TIMEOUT"屬性所定義的物件超過這個逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1017">However, the exception is thrown when an operation is performed on the <xref:System.Text.RegularExpressions.MatchCollection> object returned by this method, if a time-out interval is defined by the "REGEX_DEFAULT_MATCH_TIMEOUT" property of the current application domain and a matching operation exceeds this time-out interval.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1018">下列範例會使用<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29>方法，以找出"es"結尾的句子中的任何字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1018">The following example uses the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29> method to identify any word in a sentence that ends in "es".</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/matches2.cs#2)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/matches2.vb#2)]  
  
 <span data-ttu-id="a2b9d-1019">規則運算式模式 `\b\w+es\b` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1019">The regular expression pattern `\b\w+es\b` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-1020">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1020">Pattern</span></span>|<span data-ttu-id="a2b9d-1021">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1021">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="a2b9d-1022">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1022">Begin the match at a word boundary.</span></span>|  
|`\w+`|<span data-ttu-id="a2b9d-1023">比對一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1023">Match one or more word characters.</span></span>|  
|`es`|<span data-ttu-id="a2b9d-1024">比對常值字串"es"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1024">Match the literal string "es".</span></span>|  
|`\b`|<span data-ttu-id="a2b9d-1025">結束字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1025">End the match at a word boundary.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1026">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1026">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1027"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1027"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1028">這個方法的逾時間隔等於呼叫這個方法的應用程式定義域的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1028">This method times out after an interval that is equal to the default time-out value of the application domain in which it is called.</span></span> <span data-ttu-id="a2b9d-1029">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1029">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-1030">建議的靜態方法，針對擷取多個模式比對是<see cref="M:System.Text.RegularExpressions.Regex.Matches(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，這可讓您指定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1030">The recommended static method for retrieving multiple pattern matches is <see cref="M:System.Text.RegularExpressions.Regex.Matches(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you specify the time-out interval.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="Matches">
      <MemberSignature Language="C#" Value="public static System.Text.RegularExpressions.MatchCollection Matches (string input, string pattern, System.Text.RegularExpressions.RegexOptions options);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Text.RegularExpressions.MatchCollection Matches(string input, string pattern, valuetype System.Text.RegularExpressions.RegexOptions options) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Matches(System.String,System.String,System.Text.RegularExpressions.RegexOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Matches (input As String, pattern As String, options As RegexOptions) As MatchCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Text::RegularExpressions::MatchCollection ^ Matches(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::RegexOptions options);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.MatchCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1031">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1031">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1032">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1032">The regular expression pattern to match.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-1033">列舉值的位元組合，這些值會指定用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1033">A bitwise combination of the enumeration values that specify options for matching.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1034">使用指定的比對選項在指定的輸入字串中，搜尋所指定規則運算式的所有相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1034">Searches the specified input string for all occurrences of a specified regular expression, using the specified matching options.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1035">搜尋之後找到的 <see cref="T:System.Text.RegularExpressions.Match" /> 物件集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1035">A collection of the <see cref="T:System.Text.RegularExpressions.Match" /> objects found by the search.</span></span> <span data-ttu-id="a2b9d-1036">如果找不到相符的項目，此方法會傳回空集合物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1036">If no matches are found, the method returns an empty collection object.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1037"><xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29>方法很類似<xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29>，而不是單一比對輸入字串中找到的方法，但是它會傳回所有相符項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1037">The <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29> method is similar to the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29> method, except that it returns information about all the matches found in the input string, instead of a single match.</span></span> <span data-ttu-id="a2b9d-1038">相當於下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1038">It is equivalent to the following code:</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#8](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/matchespattern.cs#8)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#8](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/matchespattern.vb#8)]  
  
 <span data-ttu-id="a2b9d-1039">靜態`Matches`方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件與指定的規則運算式模式，並呼叫的執行個體方法`Matches`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1039">The static `Matches` methods are equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the specified regular expression pattern and calling the instance method `Matches`.</span></span>  
  
 <span data-ttu-id="a2b9d-1040">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1040">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1041">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1041">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-1042"><xref:System.Text.RegularExpressions.Regex.Matches%2A>方法會使用延遲評估來填入傳回<xref:System.Text.RegularExpressions.MatchCollection>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1042">The <xref:System.Text.RegularExpressions.Regex.Matches%2A> method uses lazy evaluation to populate the returned <xref:System.Text.RegularExpressions.MatchCollection> object.</span></span> <span data-ttu-id="a2b9d-1043">存取這個集合的成員 (例如 <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> 和 <xref:System.Text.RegularExpressions.MatchCollection.CopyTo%2A?displayProperty=nameWithType>) 會導致立即填入集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1043">Accessing members of this collection such as <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.MatchCollection.CopyTo%2A?displayProperty=nameWithType> causes the collection to be populated immediately.</span></span> <span data-ttu-id="a2b9d-1044">若要利用延遲評估，您應該逐一查看集合所使用的建構，例如`foreach`在 C# 和`For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1044">To take advantage of lazy evaluation, you should iterate the collection by using a construct such as `foreach` in C# and `For Each`…`Next`</span></span> <span data-ttu-id="a2b9d-1045">在 Visual Basic 中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1045">in Visual Basic.</span></span>  
  
 <span data-ttu-id="a2b9d-1046">其延遲的評估，因為呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29>方法不會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1046">Because of its lazy evaluation, calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29> method does not throw a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-1047">不過，擲回例外狀況上執行作業時<xref:System.Text.RegularExpressions.MatchCollection>由這個方法傳回，如果逾時間隔由目前應用程式定義域和比對作業的 「 REGEX_DEFAULT_MATCH_TIMEOUT"屬性所定義的物件超過這個逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1047">However, the exception is thrown when an operation is performed on the <xref:System.Text.RegularExpressions.MatchCollection> object returned by this method, if a time-out interval is defined by the "REGEX_DEFAULT_MATCH_TIMEOUT" property of the current application domain and a matching operation exceeds this time-out interval.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1048">下列範例會呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29>方法，以找出以"es"，然後呼叫的句子中的任何字<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29>執行不區分大小寫的模式與輸入字串比較方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1048">The following example calls the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29> method to identify any word in a sentence that ends in "es", and then calls the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29> method to perform a case-insensitive comparison of the pattern with the input string.</span></span> <span data-ttu-id="a2b9d-1049">如輸出所示，兩個方法會傳回不同的結果。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1049">As the output shows, the two methods return different results.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#4](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/matches4.cs#4)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#4](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/matches4.vb#4)]  
  
 <span data-ttu-id="a2b9d-1050">規則運算式模式 `\b\w+es\b` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1050">The regular expression pattern `\b\w+es\b` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-1051">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1051">Pattern</span></span>|<span data-ttu-id="a2b9d-1052">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1052">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="a2b9d-1053">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1053">Begin the match at a word boundary.</span></span>|  
|`\w+`|<span data-ttu-id="a2b9d-1054">比對一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1054">Match one or more word characters.</span></span>|  
|`es`|<span data-ttu-id="a2b9d-1055">比對常值字串"es"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1055">Match the literal string "es".</span></span>|  
|`\b`|<span data-ttu-id="a2b9d-1056">結束字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1056">End the match at a word boundary.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1057">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1057">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1058"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1058"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1059"><paramref name="options" /> 不是 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值的有效位元組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1059"><paramref name="options" /> is not a valid bitwise combination of <see cref="T:System.Text.RegularExpressions.RegexOptions" /> values.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1060">這個方法的逾時間隔等於呼叫這個方法的應用程式定義域的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1060">This method times out after an interval that is equal to the default time-out value of the application domain in which it is called.</span></span> <span data-ttu-id="a2b9d-1061">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1061">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-1062">建議的靜態方法，針對擷取多個模式比對是<see cref="M:System.Text.RegularExpressions.Regex.Matches(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1062">The recommended static method for retrieving multiple pattern matches is <see cref="M:System.Text.RegularExpressions.Regex.Matches(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you set the time-out interval.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="Matches">
      <MemberSignature Language="C#" Value="public static System.Text.RegularExpressions.MatchCollection Matches (string input, string pattern, System.Text.RegularExpressions.RegexOptions options, TimeSpan matchTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Text.RegularExpressions.MatchCollection Matches(string input, string pattern, valuetype System.Text.RegularExpressions.RegexOptions options, valuetype System.TimeSpan matchTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Matches(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Matches (input As String, pattern As String, options As RegexOptions, matchTimeout As TimeSpan) As MatchCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Text::RegularExpressions::MatchCollection ^ Matches(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::RegexOptions options, TimeSpan matchTimeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.MatchCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
        <Parameter Name="matchTimeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1063">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1063">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1064">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1064">The regular expression pattern to match.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-1065">列舉值的位元組合，這些值會指定用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1065">A bitwise combination of the enumeration values that specify options for matching.</span></span></param>
        <param name="matchTimeout"><span data-ttu-id="a2b9d-1066">間隔，若要表示此方法不會逾時則為 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1066">A time-out interval, or <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" /> to indicate that the method should not time out.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1067">使用指定的比對選項和逾時間隔，在指定的輸入字串中搜尋所指定規則運算式的所有相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1067">Searches the specified input string for all occurrences of a specified regular expression, using the specified matching options and time-out interval.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1068">搜尋之後找到的 <see cref="T:System.Text.RegularExpressions.Match" /> 物件集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1068">A collection of the <see cref="T:System.Text.RegularExpressions.Match" /> objects found by the search.</span></span> <span data-ttu-id="a2b9d-1069">如果找不到相符的項目，此方法會傳回空集合物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1069">If no matches are found, the method returns an empty collection object.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1070"><xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>方法很類似<xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>，而不是單一比對輸入字串中找到的方法，但是它會傳回所有相符項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1070">The <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> method is similar to the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> method, except that it returns information about all the matches found in the input string, instead of a single match.</span></span> <span data-ttu-id="a2b9d-1071">相當於下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1071">It is equivalent to the following code:</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#10](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/matchespattern.cs#10)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#10](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/matchespattern.vb#10)]  
  
 <span data-ttu-id="a2b9d-1072">靜態`Matches`方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件與指定的規則運算式模式，並呼叫的執行個體方法`Matches`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1072">The static `Matches` methods are equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the specified regular expression pattern and calling the instance method `Matches`.</span></span>  
  
 <span data-ttu-id="a2b9d-1073">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1073">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1074">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1074">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-1075"><xref:System.Text.RegularExpressions.Regex.Matches%2A>方法會使用延遲評估來填入傳回<xref:System.Text.RegularExpressions.MatchCollection>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1075">The <xref:System.Text.RegularExpressions.Regex.Matches%2A> method uses lazy evaluation to populate the returned <xref:System.Text.RegularExpressions.MatchCollection> object.</span></span> <span data-ttu-id="a2b9d-1076">存取這個集合的成員 (例如 <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> 和 <xref:System.Text.RegularExpressions.MatchCollection.CopyTo%2A?displayProperty=nameWithType>) 會導致立即填入集合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1076">Accessing members of this collection such as <xref:System.Text.RegularExpressions.MatchCollection.Count%2A?displayProperty=nameWithType> and <xref:System.Text.RegularExpressions.MatchCollection.CopyTo%2A?displayProperty=nameWithType> causes the collection to be populated immediately.</span></span> <span data-ttu-id="a2b9d-1077">若要利用延遲評估，您應該逐一查看集合所使用的建構，例如`foreach`在 C# 和`For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1077">To take advantage of lazy evaluation, you should iterate the collection by using a construct such as `foreach` in C# and `For Each`…`Next`</span></span> <span data-ttu-id="a2b9d-1078">在 Visual Basic 中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1078">in Visual Basic.</span></span>  
  
 <span data-ttu-id="a2b9d-1079">其延遲的評估，因為呼叫<xref:System.Text.RegularExpressions.Regex.Matches%2A>方法不會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1079">Because of its lazy evaluation, calling the <xref:System.Text.RegularExpressions.Regex.Matches%2A> method does not throw a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-1080">不過，擲回例外狀況上執行作業時<xref:System.Text.RegularExpressions.MatchCollection>如果比對作業超過此所指定的逾時間隔，這個方法中，所傳回的物件`matchTimeout`參數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1080">However, an exception is thrown when an operation is performed on the <xref:System.Text.RegularExpressions.MatchCollection> object returned by this method, if a matching operation exceeds this time-out interval specified by the`matchTimeout` parameter.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1081">下列範例會呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>方法以執行比對"es"結尾的句子中的任何字區分大小寫比較。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1081">The following example calls the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> method to perform a case-sensitive comparison that matches any word in a sentence that ends in "es".</span></span> <span data-ttu-id="a2b9d-1082">然後它會呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>執行不區分大小寫的模式與輸入字串比較方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1082">It then calls the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> method to perform a case-insensitive comparison of the pattern with the input string.</span></span> <span data-ttu-id="a2b9d-1083">在這兩種情況下，逾時間隔設定為一秒。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1083">In both cases, the time-out interval is set to one second.</span></span> <span data-ttu-id="a2b9d-1084">如輸出所示，兩個方法會傳回不同的結果。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1084">As the output shows, the two methods return different results.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Matches#11](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/cs/matches5.cs#11)]
 [!code-vb[System.Text.RegularExpressions.Regex.Matches#11](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matches/vb/matches5.vb#11)]  
  
 <span data-ttu-id="a2b9d-1085">規則運算式模式 `\b\w+es\b` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1085">The regular expression pattern `\b\w+es\b` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-1086">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1086">Pattern</span></span>|<span data-ttu-id="a2b9d-1087">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1087">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="a2b9d-1088">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1088">Begin the match at a word boundary.</span></span>|  
|`\w+`|<span data-ttu-id="a2b9d-1089">比對一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1089">Match one or more word characters.</span></span>|  
|`es`|<span data-ttu-id="a2b9d-1090">比對常值字串"es"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1090">Match the literal string "es".</span></span>|  
|`\b`|<span data-ttu-id="a2b9d-1091">結束字緣比對。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1091">End the match at a word boundary.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1092">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1092">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1093"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1093"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1094"><paramref name="options" /> 不是 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值的有效位元組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1094"><paramref name="options" /> is not a valid bitwise combination of <see cref="T:System.Text.RegularExpressions.RegexOptions" /> values.</span></span>  
  
 <span data-ttu-id="a2b9d-1095">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1095">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-1096"><paramref name="matchTimeout" /> 為負數、零或大約大於 24 天。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1096"><paramref name="matchTimeout" /> is negative, zero, or greater than approximately 24 days.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1097">我們建議您將<paramref name="matchTimeout" />參數，以適當的值，例如兩秒。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1097">We recommend that you set the <paramref name="matchTimeout" /> parameter to an appropriate value, such as two seconds.</span></span> <span data-ttu-id="a2b9d-1098">如果您停用逾時指定<see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，規則運算式引擎會提供稍微較佳的效能。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1098">If you disable time-outs by specifying <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, the regular expression engine offers slightly better performance.</span></span> <span data-ttu-id="a2b9d-1099">不過，您應該停用逾時，只有在下列情況下：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1099">However, you should disable time-outs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="a2b9d-1100">當規則運算式所處理的輸入衍生自已知且受信任的來源，或包含靜態文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1100">When the input processed by a regular expression is derived from a known and trusted source or consists of static text.</span></span> <span data-ttu-id="a2b9d-1101">這不包括已動態使用者所輸入的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1101">This excludes text that has been dynamically input by users.</span></span>  
  
-   <span data-ttu-id="a2b9d-1102">當規則運算式模式已徹底測試以確保它有效率地處理符合，不符合，不久符合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1102">When the regular expression pattern has been thoroughly tested to ensure that it efficiently handles matches, non-matches, and near matches.</span></span>  
  
-   <span data-ttu-id="a2b9d-1103">當規則運算式模式包含已知會造成大量回溯處理接近的相符項目時沒有語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1103">When the regular expression pattern contains no language elements that are known to cause excessive backtracking when processing a near match.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="MatchTimeout">
      <MemberSignature Language="C#" Value="public TimeSpan MatchTimeout { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.TimeSpan MatchTimeout" />
      <MemberSignature Language="DocId" Value="P:System.Text.RegularExpressions.Regex.MatchTimeout" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property MatchTimeout As TimeSpan" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property TimeSpan MatchTimeout { TimeSpan get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.TimeSpan</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-1104">取得目前執行個體的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1104">Gets the time-out interval of the current instance.</span></span></summary>
        <value><span data-ttu-id="a2b9d-1105">在<see cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException" />擲回之前，可在模式比對作業中流逝的最大時間間隔，或者為<see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />（如果停用逾時）。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1105">The maximum time interval that can elapse in a pattern-matching operation before a <see cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException" /> is thrown, or <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" /> if time-outs are disabled.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1106"><xref:System.Text.RegularExpressions.Regex.MatchTimeout%2A>屬性會定義大約的最大時間間隔<xref:System.Text.RegularExpressions.Regex>作業逾時之前執行單一比對作業的執行個體。規則運算式引擎會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>期間經過逾時間隔後其下一個計時檢查例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1106">The <xref:System.Text.RegularExpressions.Regex.MatchTimeout%2A> property defines the approximate maximum time interval for a <xref:System.Text.RegularExpressions.Regex> instance to execute a single matching operation before the operation times out. The regular expression engine throws a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception during its next timing check after the time-out interval has elapsed.</span></span> <span data-ttu-id="a2b9d-1107">這可防止規則運算式引擎處理輸入的字串需要進行大量回溯。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1107">This prevents the regular expression engine from processing input strings that require excessive backtracking.</span></span> <span data-ttu-id="a2b9d-1108">如需詳細資訊，請參閱[回溯](~/docs/standard/base-types/backtracking-in-regular-expressions.md)和[規則運算式的最佳作法](~/docs/standard/base-types/best-practices.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1108">For more information, see [Backtracking](~/docs/standard/base-types/backtracking-in-regular-expressions.md) and [Best Practices for Regular Expressions](~/docs/standard/base-types/best-practices.md).</span></span>  
  
 <span data-ttu-id="a2b9d-1109">這個屬性是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1109">This property is read-only.</span></span> <span data-ttu-id="a2b9d-1110">您可以明確設定該值的各個<xref:System.Text.RegularExpressions.Regex>藉由呼叫物件<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType>建構函式，而且您可以將其值設定為所有<xref:System.Text.RegularExpressions.Regex>比對應用程式定義域中的作業，藉由呼叫<xref:System.AppDomain.SetData%2A?displayProperty=nameWithType>方法並提供<xref:System.TimeSpan> "REGEX_DEFAULT_MATCH_TIMEOUT"的屬性值，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1110">You can set its value explicitly for an individual <xref:System.Text.RegularExpressions.Regex> object by calling the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor; and you can set its value for all <xref:System.Text.RegularExpressions.Regex> matching operations in an application domain by calling the <xref:System.AppDomain.SetData%2A?displayProperty=nameWithType> method and providing a <xref:System.TimeSpan> value for the "REGEX_DEFAULT_MATCH_TIMEOUT" property, as the following example illustrates.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.MatchTimeout#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matchtimeout/cs/regexmatchtimeout1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.MatchTimeout#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.matchtimeout/vb/regexmatchtimeout1.vb#1)]  
  
 <span data-ttu-id="a2b9d-1111">如果您未明確設定的逾時間隔時，預設值<xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>是使用與比對作業執行逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1111">If you do not explicitly set a time-out interval, the default value <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType> is used, and matching operations do not time out.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Options">
      <MemberSignature Language="C#" Value="public System.Text.RegularExpressions.RegexOptions Options { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Text.RegularExpressions.RegexOptions Options" />
      <MemberSignature Language="DocId" Value="P:System.Text.RegularExpressions.Regex.Options" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Options As RegexOptions" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Text::RegularExpressions::RegexOptions Options { System::Text::RegularExpressions::RegexOptions get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.RegexOptions</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-1112">取得傳入 <see cref="T:System.Text.RegularExpressions.Regex" /> 建構函式的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1112">Gets the options that were passed into the <see cref="T:System.Text.RegularExpressions.Regex" /> constructor.</span></span></summary>
        <value><span data-ttu-id="a2b9d-1113"><see cref="T:System.Text.RegularExpressions.RegexOptions" /> 列舉的一個或多個成員，代表傳遞至 <see cref="T:System.Text.RegularExpressions.Regex" /> 建構函式的選項</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1113">One or more members of the <see cref="T:System.Text.RegularExpressions.RegexOptions" /> enumeration that represent options that were passed to the <see cref="T:System.Text.RegularExpressions.Regex" /> constructor</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1114">值<xref:System.Text.RegularExpressions.Regex.Options%2A>屬性都包含一個或多個成員<xref:System.Text.RegularExpressions.RegexOptions>列舉型別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1114">The value of the <xref:System.Text.RegularExpressions.Regex.Options%2A> property consists of one or more members of the <xref:System.Text.RegularExpressions.RegexOptions> enumeration.</span></span> <span data-ttu-id="a2b9d-1115">如果沒有選項中所定義<xref:System.Text.RegularExpressions.Regex>類別建構函式，其值是<xref:System.Text.RegularExpressions.RegexOptions.None?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1115">If no options were defined in the <xref:System.Text.RegularExpressions.Regex> class constructor, its value is <xref:System.Text.RegularExpressions.RegexOptions.None?displayProperty=nameWithType>.</span></span> <span data-ttu-id="a2b9d-1116">可用的選項會在中詳細討論[規則運算式選項](~/docs/standard/base-types/regular-expression-options.md)主題。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1116">The available options are discussed in detail in the [Regular Expression Options](~/docs/standard/base-types/regular-expression-options.md) topic.</span></span>  
  
 <span data-ttu-id="a2b9d-1117">請注意，<xref:System.Text.RegularExpressions.Regex.Options%2A>屬性並不會反映內嵌選項定義在規則運算式模式本身。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1117">Note that the <xref:System.Text.RegularExpressions.Regex.Options%2A> property does not reflect inline options defined in the regular expression pattern itself.</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides">
          <para>
            <span data-ttu-id="a2b9d-1118"><see cref="T:System.Text.RegularExpressions.Regex" /> 基底類別所建立的規則運算式的<see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" />方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1118"><see cref="T:System.Text.RegularExpressions.Regex" /> is the base class of regular expressions created by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span> <span data-ttu-id="a2b9d-1119">這些編譯的規則運算式中使用的基底類別實作<see cref="P:System.Text.RegularExpressions.Regex.Options" />屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1119">These compiled regular expressions use the base class implementation of the <see cref="P:System.Text.RegularExpressions.Regex.Options" /> property.</span></span> <span data-ttu-id="a2b9d-1120">如果已從衍生類別呼叫<see cref="P:System.Text.RegularExpressions.Regex.Options" />屬性會傳回傳遞給選項<paramref name="options" />參數<see cref="T:System.Text.RegularExpressions.RegexCompilationInfo" />類別建構函式是用來定義規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1120">If called from a derived class, the <see cref="P:System.Text.RegularExpressions.Regex.Options" /> property returns the options that were passed to the <paramref name="options" /> parameter of the <see cref="T:System.Text.RegularExpressions.RegexCompilationInfo" /> class constructor that was used to define the regular expression.</span></span></para>
        </block>
        <altmember cref="T:System.Text.RegularExpressions.RegexOptions" />
      </Docs>
    </Member>
    <Member MemberName="pattern">
      <MemberSignature Language="C#" Value="protected internal string pattern;" />
      <MemberSignature Language="ILAsm" Value=".field familyorassembly string pattern" />
      <MemberSignature Language="DocId" Value="F:System.Text.RegularExpressions.Regex.pattern" />
      <MemberSignature Language="VB.NET" Value="Protected Friend pattern As String " />
      <MemberSignature Language="C++ CLI" Value="protected public: System::String ^ pattern;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-1121">由 <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> 方法所產生的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1121">Used by a <see cref="T:System.Text.RegularExpressions.Regex" /> object generated by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="Replace">
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="a2b9d-1122">在指定的輸入字串中，使用指定的取代字串來取代符合規則運算式模式的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1122">In a specified input string, replaces strings that match a regular expression pattern with a specified replacement string.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public string Replace (string input, string replacement);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string Replace(string input, string replacement) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function Replace (input As String, replacement As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ Replace(System::String ^ input, System::String ^ replacement);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="replacement" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1123">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1123">The string to search for a match.</span></span></param>
        <param name="replacement"><span data-ttu-id="a2b9d-1124">取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1124">The replacement string.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1125">在指定的輸入字串中，使用指定的取代字串來取代符合規則運算式模式的所有字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1125">In a specified input string, replaces all strings that match a regular expression pattern with a specified replacement string.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1126">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1126">A new string that is identical to the input string, except that the replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1127">如果規則運算式模式在目前執行個體中沒有符合項目，方法會傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1127">If the regular expression pattern is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1128">搜尋符合項目會從開頭的`input`字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1128">The search for matches starts at the beginning of the `input` string.</span></span> <span data-ttu-id="a2b9d-1129">規則運算式是目前的建構函式所定義的模式<xref:System.Text.RegularExpressions.Regex>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1129">The regular expression is the pattern defined by the constructor for the current <xref:System.Text.RegularExpressions.Regex> object.</span></span>  
  
 <span data-ttu-id="a2b9d-1130">`replacement`參數指定的字串來取代中的每個相符項目`input`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1130">The `replacement` parameter specifies the string that is to replace each match in `input`.</span></span> <span data-ttu-id="a2b9d-1131">`replacement` 可以包含常值文字的任何組合和[替代](~/docs/standard/base-types/substitutions-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1131">`replacement` can consist of any combination of literal text and [substitutions](~/docs/standard/base-types/substitutions-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-1132">例如，取代模式`a*${test}b`插入的字串"*"後面接著所比對的子字串`test`擷取群組，如果有的話，後面接著字串"b"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1132">For example, the replacement pattern `a*${test}b` inserts the string "a*" followed by the substring that is matched by the `test` capturing group, if any, followed by the string "b".</span></span> <span data-ttu-id="a2b9d-1133">\* 字元無法辨識為中繼字元取代模式內。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1133">The \* character is not recognized as a metacharacter within a replacement pattern.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a2b9d-1134">替代是在取代模式中才能辨識的只是規則運算式語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1134">Substitutions are the only regular expression language elements that are recognized in a replacement pattern.</span></span> <span data-ttu-id="a2b9d-1135">所有其他規則運算式語言項目，包括[字元逸出](~/docs/standard/base-types/character-escapes-in-regular-expressions.md)、 可只在規則運算式模式中，而且無法辨識取代模式中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1135">All other regular expression language elements, including [character escapes](~/docs/standard/base-types/character-escapes-in-regular-expressions.md), are allowed in regular expression patterns only and are not recognized in replacement patterns.</span></span>  
  
 <span data-ttu-id="a2b9d-1136">如果取代作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1136">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the replacement operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-1137">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1137">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-1138">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1138">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown</span></span>  
  
 <span data-ttu-id="a2b9d-1139">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1139">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1140">下列範例會定義規則運算式， `\s+`，符合一或多個空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1140">The following example defines a regular expression, `\s+`, that matches one or more white-space characters.</span></span> <span data-ttu-id="a2b9d-1141">取代字串中，""，將它們取代為單一空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1141">The replacement string, " ", replaces them with a single space character.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#5](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replaceexample5.cs#5)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#5](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replaceexample5.vb#5)]  
  
 <span data-ttu-id="a2b9d-1142">下列範例會定義規則運算式， `(\p{Sc}\s?)?(\d+\.?((?<=\.)\d+)?)(?(1)|\s?\p{Sc})?`，以及取代模式中， `$2`，移除前置或尾端的貨幣符號的數字的值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1142">The following example defines a regular expression, `(\p{Sc}\s?)?(\d+\.?((?<=\.)\d+)?)(?(1)|\s?\p{Sc})?`, and a replacement pattern, `$2`, that removes either a leading or a trailing currency symbol from a numeric value.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#7](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replaceexample7.cs#7)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#7](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replaceexample7.vb#7)]  
  
 <span data-ttu-id="a2b9d-1143">規則運算式的解譯方式如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1143">The regular expression is interpreted as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-1144">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1144">Pattern</span></span>|<span data-ttu-id="a2b9d-1145">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1145">Description</span></span>|  
|-------------|-----------------|  
|`\p{Sc}`|<span data-ttu-id="a2b9d-1146">比對的貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1146">Match a currency symbol.</span></span> <span data-ttu-id="a2b9d-1147">`{Sc}` 代表任何字元，其 [Unicode Symbol，Currency] 分類的成員。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1147">`{Sc}` denotes any character that is a member of the Unicode Symbol, Currency category.</span></span>|  
|`\s?`|<span data-ttu-id="a2b9d-1148">比對零個或一個空白字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1148">Match zero or one white-space character.</span></span>|  
|`(\p{Sc}\s?)?`|<span data-ttu-id="a2b9d-1149">比對零個或一個貨幣符號，後面接著零個或一個空格字元的組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1149">Match zero or one occurrence of the combination of a currency symbol followed by zero or one white-space character.</span></span> <span data-ttu-id="a2b9d-1150">這是第一個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1150">This is the first capturing group.</span></span>|  
|`\d+`|<span data-ttu-id="a2b9d-1151">比對一個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1151">Match one or more decimal digits.</span></span>|  
|`\.?`|<span data-ttu-id="a2b9d-1152">比對零個或一個句號 （用做為小數分隔符號字元）。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1152">Match zero or one occurrence of a period (used as a decimal separator character).</span></span>|  
|`((?<=\.)\d+)?`|<span data-ttu-id="a2b9d-1153">如果句號前一個字元，比對一個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1153">If a period is the previous character, match one or more decimal digits.</span></span> <span data-ttu-id="a2b9d-1154">此模式可以比對零或一次。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1154">This pattern can be matched either zero or one time.</span></span>|  
|`(\d+\.?((?<=\.)\d+)?)`|<span data-ttu-id="a2b9d-1155">比對一個或多個十進位數字，後面選擇性句號和其他十進位數字的模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1155">Match the pattern of one or more decimal digits followed by an optional period and additional decimal digits.</span></span> <span data-ttu-id="a2b9d-1156">這是第二個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1156">This is the second capturing group.</span></span> <span data-ttu-id="a2b9d-1157">若要呼叫<xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%29>方法會將整個相符項目取代此擷取群組的值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1157">The call to the <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%29> method replaces the entire match with the value of this captured group.</span></span>|  
|`(?(1)&#124;\s?\p{Sc})?`|<span data-ttu-id="a2b9d-1158">如果第一個擷取的群組存在，則比對空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1158">If the first captured group exists, match an empty string.</span></span> <span data-ttu-id="a2b9d-1159">否則比對零個或一個空格字元，後面接著貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1159">Otherwise, match zero or one white-space character followed by a currency symbol.</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1160"><paramref name="input" /> 或 <paramref name="replacement" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1160"><paramref name="input" /> or <paramref name="replacement" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1161">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1161">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1162">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1162">For more information about time-outs, see the Remarks section.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public string Replace (string input, System.Text.RegularExpressions.MatchEvaluator evaluator);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string Replace(string input, class System.Text.RegularExpressions.MatchEvaluator evaluator) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.Text.RegularExpressions.MatchEvaluator)" />
      <MemberSignature Language="VB.NET" Value="Public Function Replace (input As String, evaluator As MatchEvaluator) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ Replace(System::String ^ input, System::Text::RegularExpressions::MatchEvaluator ^ evaluator);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="evaluator" Type="System.Text.RegularExpressions.MatchEvaluator" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1163">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1163">The string to search for a match.</span></span></param>
        <param name="evaluator"><span data-ttu-id="a2b9d-1164">檢查每個符合項目並傳回原始符合字串或取代字串的自訂方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1164">A custom method that examines each match and returns either the original matched string or a replacement string.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1165">在指定的輸入字串中，使用 <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> 委派所傳回的字串來取代所有符合指定之規則運算式的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1165">In a specified input string, replaces all strings that match a specified regular expression with a string returned by a <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> delegate.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1166">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1166">A new string that is identical to the input string, except that a replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1167">如果規則運算式模式在目前執行個體中沒有符合項目，方法會傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1167">If the regular expression pattern is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1168"><xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.Text.RegularExpressions.MatchEvaluator%29?displayProperty=nameWithType>方法適合用來取代規則運算式相符項目，如果下列任何一個狀況成立：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1168">The <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.Text.RegularExpressions.MatchEvaluator%29?displayProperty=nameWithType> method is useful for replacing a regular expression match if any of the following conditions is true:</span></span>  
  
-   <span data-ttu-id="a2b9d-1169">規則運算式取代模式中無法隨時可以指定取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1169">The replacement string cannot readily be specified by a regular expression replacement pattern.</span></span>  
  
-   <span data-ttu-id="a2b9d-1170">取代字串會因某些處理對相符的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1170">The replacement string results from some processing done on the matched string.</span></span>  
  
-   <span data-ttu-id="a2b9d-1171">條件式處理取代字串結果。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1171">The replacement string results from conditional processing.</span></span>  
  
 <span data-ttu-id="a2b9d-1172">此方法相當於呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType>方法並傳遞每個<xref:System.Text.RegularExpressions.Match>在傳回的物件<xref:System.Text.RegularExpressions.MatchCollection>集合`evaluator`委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1172">The method is equivalent to calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType> method and passing each <xref:System.Text.RegularExpressions.Match> object in the returned <xref:System.Text.RegularExpressions.MatchCollection> collection to the `evaluator` delegate.</span></span>  
  
 <span data-ttu-id="a2b9d-1173">規則運算式是目前的建構函式所定義的模式<xref:System.Text.RegularExpressions.Regex>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1173">The regular expression is the pattern defined by the constructor for the current <xref:System.Text.RegularExpressions.Regex> object.</span></span>  
  
 <span data-ttu-id="a2b9d-1174">`evaluator`參數是您定義的自訂方法的委派，會檢查每個符合項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1174">The `evaluator` parameter is the delegate for a custom method that you define and that examines each match.</span></span> <span data-ttu-id="a2b9d-1175">自訂的方法必須具有下列簽章，以符合<xref:System.Text.RegularExpressions.MatchEvaluator>委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1175">The custom method must have the following signature to match the <xref:System.Text.RegularExpressions.MatchEvaluator> delegate.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/syntax1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/syntax1.vb#1)]  
  
 <span data-ttu-id="a2b9d-1176">您的自訂方法會傳回字串，以取代相符的輸入。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1176">Your custom method returns a string that replaces the matched input.</span></span>  
  
 <span data-ttu-id="a2b9d-1177">如果取代作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1177">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the replacement operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-1178">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1178">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-1179">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1179">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown</span></span>  
  
 <span data-ttu-id="a2b9d-1180">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1180">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1181">下列程式碼範例會顯示原始的字串、 符合原始字串中的每個字，將已轉換的字串轉換為大寫，然後顯示每個相符的第一個字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1181">The following code example displays an original string, matches each word in the original string, converts the first character of each match to uppercase, then displays the converted string.</span></span>  
  
 [!code-csharp[Regex.Replace-Instance#1](~/samples/snippets/csharp/VS_Snippets_CLR/Regex.Replace-Instance/cs/sample.cs#1)]
 [!code-vb[Regex.Replace-Instance#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Regex.Replace-Instance/vb/sample.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1182"><paramref name="input" /> 或 <paramref name="evaluator" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1182"><paramref name="input" /> or <paramref name="evaluator" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1183">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1183">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1184">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1184">For more information about time-outs, see the Remarks section.</span></span></exception>
        <altmember cref="T:System.Text.RegularExpressions.MatchEvaluator" />
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public string Replace (string input, string replacement, int count);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string Replace(string input, string replacement, int32 count) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Replace (input As String, replacement As String, count As Integer) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ Replace(System::String ^ input, System::String ^ replacement, int count);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="replacement" Type="System.String" />
        <Parameter Name="count" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1185">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1185">The string to search for a match.</span></span></param>
        <param name="replacement"><span data-ttu-id="a2b9d-1186">取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1186">The replacement string.</span></span></param>
        <param name="count"><span data-ttu-id="a2b9d-1187">取代作業可以發生的最多次數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1187">The maximum number of times the replacement can occur.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1188">在指定的輸入字串中，使用指定的取代字串來取代符合規則運算式模式的指定最大字串數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1188">In a specified input string, replaces a specified maximum number of strings that match a regular expression pattern with a specified replacement string.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1189">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1189">A new string that is identical to the input string, except that the replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1190">如果規則運算式模式在目前執行個體中沒有符合項目，方法會傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1190">If the regular expression pattern is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1191">搜尋符合項目會從開頭的`input`字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1191">The search for matches starts at the beginning of the `input` string.</span></span> <span data-ttu-id="a2b9d-1192">規則運算式是由目前的建構函式定義的模式<xref:System.Text.RegularExpressions.Regex>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1192">The regular expression is the pattern that is defined by the constructor for the current <xref:System.Text.RegularExpressions.Regex> object.</span></span> <span data-ttu-id="a2b9d-1193">如果`count`是負數，字串的結尾繼續取代項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1193">If `count` is negative, replacements continue to the end of the string.</span></span> <span data-ttu-id="a2b9d-1194">如果`count`超過的相符項目數，取代所有相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1194">If `count` exceeds the number of matches, all matches are replaced.</span></span>  
  
 <span data-ttu-id="a2b9d-1195">`replacement`參數指定的字串來取代第一個`count`中符合`input`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1195">The `replacement` parameter specifies the string that is to replace the first `count` matches in `input`.</span></span> <span data-ttu-id="a2b9d-1196">`replacement` 可以包含常值文字的任何組合和[替代](~/docs/standard/base-types/substitutions-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1196">`replacement` can consist of any combination of literal text and [substitutions](~/docs/standard/base-types/substitutions-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-1197">例如，取代模式`a*${test}b`插入的字串"*"後面接著所比對的子字串`test`擷取群組，如果有的話，後面接著字串"b"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1197">For example, the replacement pattern `a*${test}b` inserts the string "a*" followed by the substring that is matched by the `test` capturing group, if any, followed by the string "b".</span></span> <span data-ttu-id="a2b9d-1198">\* 字元無法辨識為中繼字元取代模式內。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1198">The \* character is not recognized as a metacharacter within a replacement pattern.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a2b9d-1199">替代是在取代模式中才能辨識的只是規則運算式語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1199">Substitutions are the only regular expression language elements that are recognized in a replacement pattern.</span></span> <span data-ttu-id="a2b9d-1200">所有其他規則運算式語言項目，包括[字元逸出](~/docs/standard/base-types/character-escapes-in-regular-expressions.md)、 可只在規則運算式模式中，而且無法辨識取代模式中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1200">All other regular expression language elements, including [character escapes](~/docs/standard/base-types/character-escapes-in-regular-expressions.md), are allowed in regular expression patterns only and are not recognized in replacement patterns.</span></span>  
  
 <span data-ttu-id="a2b9d-1201">如果取代作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1201">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the replacement operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-1202">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1202">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-1203">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1203">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown</span></span>  
  
 <span data-ttu-id="a2b9d-1204">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1204">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1205">下列範例會將前五個出現重複的字元取代單一字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1205">The following example replaces the first five occurrences of duplicated characters with a single character.</span></span> <span data-ttu-id="a2b9d-1206">規則運算式模式`(\w)\1`比對的單一字元的連續項目，並將第一個出現項目指派給第一個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1206">The regular expression pattern `(\w)\1` matches consecutive occurrences of a single character and assigns the first occurrence to the first capturing group.</span></span> <span data-ttu-id="a2b9d-1207">取代模式`$1`整個相符項目取代為第一個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1207">The replacement pattern `$1` replaces the entire match with the first captured group.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#8](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replaceexample8.cs#8)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#8](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replaceexample8.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1208"><paramref name="input" /> 或 <paramref name="replacement" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1208"><paramref name="input" /> or <paramref name="replacement" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1209">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1209">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1210">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1210">For more information about time-outs, see the Remarks section.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public static string Replace (string input, string pattern, string replacement);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string Replace(string input, string pattern, string replacement) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Replace (input As String, pattern As String, replacement As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Replace(System::String ^ input, System::String ^ pattern, System::String ^ replacement);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="replacement" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1211">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1211">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1212">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1212">The regular expression pattern to match.</span></span></param>
        <param name="replacement"><span data-ttu-id="a2b9d-1213">取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1213">The replacement string.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1214">在指定的輸入字串中，使用指定的取代字串來取代符合指定之規則運算式的所有字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1214">In a specified input string, replaces all strings that match a specified regular expression with a specified replacement string.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1215">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1215">A new string that is identical to the input string, except that the replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1216">如果在目前的執行個體中沒有符合 <paramref name="pattern" /> 的項目，則方法傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1216">If <paramref name="pattern" /> is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1217">靜態`Replace`方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件與指定的規則運算式模式，並呼叫的執行個體方法`Replace`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1217">The static `Replace` methods are equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the specified regular expression pattern and calling the instance method `Replace`.</span></span>  
  
 <span data-ttu-id="a2b9d-1218">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1218">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1219">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1219">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span> <span data-ttu-id="a2b9d-1220">搜尋符合項目會從開頭的`input`字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1220">The search for matches starts at the beginning of the `input` string.</span></span>  
  
 <span data-ttu-id="a2b9d-1221">`replacement`參數指定的字串來取代中的每個相符項目`input`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1221">The `replacement` parameter specifies the string that is to replace each match in `input`.</span></span> <span data-ttu-id="a2b9d-1222">`replacement` 可以包含常值文字的任何組合和[替代](~/docs/standard/base-types/substitutions-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1222">`replacement` can consist of any combination of literal text and [substitutions](~/docs/standard/base-types/substitutions-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-1223">例如，取代模式`a*${test}b`插入的字串"*"後面接著所比對的子字串`test`擷取群組，如果有的話，後面接著字串"b"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1223">For example, the replacement pattern `a*${test}b` inserts the string "a*" followed by the substring that is matched by the `test` capturing group, if any, followed by the string "b".</span></span> <span data-ttu-id="a2b9d-1224">\* 字元無法辨識為中繼字元取代模式內。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1224">The \* character is not recognized as a metacharacter within a replacement pattern.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a2b9d-1225">替代是在取代模式中才能辨識的只是規則運算式語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1225">Substitutions are the only regular expression language elements that are recognized in a replacement pattern.</span></span> <span data-ttu-id="a2b9d-1226">所有其他規則運算式語言項目，包括[字元逸出](~/docs/standard/base-types/character-escapes-in-regular-expressions.md)、 可只在規則運算式模式中，而且無法辨識取代模式中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1226">All other regular expression language elements, including [character escapes](~/docs/standard/base-types/character-escapes-in-regular-expressions.md), are allowed in regular expression patterns only and are not recognized in replacement patterns.</span></span>  
  
 <span data-ttu-id="a2b9d-1227">如果取代作業的執行時間超出為呼叫方法的應用程式定義域指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1227">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the replacement operation exceeds the time-out interval specified for the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-1228">如果在應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1228">If no time-out is defined in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
 <span data-ttu-id="a2b9d-1229">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1229">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1230">下列範例會定義規則運算式， `\s+`，符合一或多個空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1230">The following example defines a regular expression, `\s+`, that matches one or more white-space characters.</span></span> <span data-ttu-id="a2b9d-1231">取代字串中，""，將它們取代為單一空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1231">The replacement string, " ", replaces them with a single space character.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#6](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replaceexample6.cs#6)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#6](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replaceexample6.vb#6)]  
  
 <span data-ttu-id="a2b9d-1232">下列範例會使用<xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%29>方法以取代本機檔案路徑的 UNC 路徑中的本機電腦和磁碟機名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1232">The following example uses the <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%29> method to replace the local machine and drive names in a UNC path with a local file path.</span></span> <span data-ttu-id="a2b9d-1233">規則運算式會使用<xref:System.Environment.MachineName%2A?displayProperty=nameWithType>屬性，以包括在本機電腦的名稱和<xref:System.Environment.GetLogicalDrives%2A?displayProperty=nameWithType>方法，將包含邏輯磁碟的名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1233">The regular expression uses the <xref:System.Environment.MachineName%2A?displayProperty=nameWithType> property to include the name of the local computer, and the <xref:System.Environment.GetLogicalDrives%2A?displayProperty=nameWithType> method to include the names of the logical drives.</span></span> <span data-ttu-id="a2b9d-1234">若要成功執行此範例，您應該以您本機電腦的名稱取代常值字串"MyMachine"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1234">To run the example successfully, you should replace the literal string "MyMachine" with your local machine name.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replace3.cs#3)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replace3.vb#3)]  
  
 <span data-ttu-id="a2b9d-1235">下列的運算式所定義的規則運算式模式：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1235">The regular expression pattern is defined by the following expression:</span></span>  
  
 `"\\\\(?i:" + Environment.MachineName + ")(?:\.\w+)*\\((?i:[" + driveNames + "]))\$"`  
  
 <span data-ttu-id="a2b9d-1236">下表顯示規則運算式模式的解譯方式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1236">The following table shows how the regular expression pattern is interpreted.</span></span>  
  
|<span data-ttu-id="a2b9d-1237">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1237">Pattern</span></span>|<span data-ttu-id="a2b9d-1238">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1238">Description</span></span>|  
|-------------|-----------------|  
|`\\\\`|<span data-ttu-id="a2b9d-1239">比對兩個連續反斜線 (`\`) 字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1239">Match two consecutive backslash (`\`) characters.</span></span> <span data-ttu-id="a2b9d-1240">反斜線字元解譯為逸出字元，因此每個反斜線必須逸出與另一個反斜線。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1240">Because the backslash character is interpreted as the escape character, each backslash must be escaped with another backslash.</span></span>|  
|`(?i:" + Environment.MachineName + ")`|<span data-ttu-id="a2b9d-1241">執行不區分大小寫的比對字串所傳回的<xref:System.Environment.MachineName%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1241">Perform a case-insensitive match of the string that is returned by the <xref:System.Environment.MachineName%2A?displayProperty=nameWithType> property.</span></span>|  
|`(?:\.\w+)*`|<span data-ttu-id="a2b9d-1242">比對句號 (`.`) 字元後面接著一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1242">Match the period (`.`) character followed by one or more word characters.</span></span> <span data-ttu-id="a2b9d-1243">此比對可以發生零次以上。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1243">This match can occur zero or more times.</span></span> <span data-ttu-id="a2b9d-1244">不會擷取相符子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1244">The matched subexpression is not captured.</span></span>|  
|`\\`|<span data-ttu-id="a2b9d-1245">符合反斜線 (`\`) 字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1245">Match a backslash (`\`) character.</span></span>|  
|`((?i:[" + driveNames + "]))`|<span data-ttu-id="a2b9d-1246">執行不區分大小寫比對的個別磁碟機字母所組成的字元類別。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1246">Perform a case-insensitive match of the character class that consists of the individual drive lettters.</span></span> <span data-ttu-id="a2b9d-1247">此項比對是第一個擷取子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1247">This match is the first captured subexpression.</span></span>|  
|`\$`|<span data-ttu-id="a2b9d-1248">比對常值的貨幣符號 (`$`) 字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1248">Match the literal dollar sign (`$`) character.</span></span>|  
  
 <span data-ttu-id="a2b9d-1249">取代模式`$1`整個相符項目取代為第一個擷取子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1249">The replacement pattern `$1` replaces the entire match with the first captured subexpression.</span></span> <span data-ttu-id="a2b9d-1250">也就是說，它會取代 UNC 電腦和磁碟機名稱的磁碟機代號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1250">That is, it replaces the UNC machine and drive name with the drive letter.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1251">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1251">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1252"><paramref name="input" /><paramref name="pattern" /> 或 <paramref name="replacement" /> 是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1252"><paramref name="input" />, <paramref name="pattern" />, or <paramref name="replacement" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1253">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1253">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1254">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1254">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1255">這個方法的逾時間隔等於呼叫這個方法的應用程式定義域的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1255">This method times out after an interval that is equal to the default time-out value of the application domain in which it is called.</span></span> <span data-ttu-id="a2b9d-1256">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1256">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-1257">建議的靜態方法，取代模式比對是<see cref="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1257">The recommended static method for replacing a pattern match is <see cref="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you set the time-out interval.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public static string Replace (string input, string pattern, System.Text.RegularExpressions.MatchEvaluator evaluator);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string Replace(string input, string pattern, class System.Text.RegularExpressions.MatchEvaluator evaluator) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.Text.RegularExpressions.MatchEvaluator)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Replace (input As String, pattern As String, evaluator As MatchEvaluator) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Replace(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::MatchEvaluator ^ evaluator);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="evaluator" Type="System.Text.RegularExpressions.MatchEvaluator" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1258">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1258">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1259">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1259">The regular expression pattern to match.</span></span></param>
        <param name="evaluator"><span data-ttu-id="a2b9d-1260">檢查每個符合項目並傳回原始符合字串或取代字串的自訂方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1260">A custom method that examines each match and returns either the original matched string or a replacement string.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1261">在指定的輸入字串中，使用 <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> 委派所傳回的字串來取代所有符合指定之規則運算式的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1261">In a specified input string, replaces all strings that match a specified regular expression with a string returned by a <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> delegate.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1262">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1262">A new string that is identical to the input string, except that a replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1263">如果在目前的執行個體中沒有符合 <paramref name="pattern" /> 的項目，則方法傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1263">If <paramref name="pattern" /> is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1264"><xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%29?displayProperty=nameWithType>方法適合用來取代規則運算式相符項目，如果下列任何一個狀況成立：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1264">The <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%29?displayProperty=nameWithType> method is useful for replacing a regular expression match if any of the following conditions is true:</span></span>  
  
-   <span data-ttu-id="a2b9d-1265">規則運算式取代模式中無法隨時可以指定取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1265">The replacement string cannot readily be specified by a regular expression replacement pattern.</span></span>  
  
-   <span data-ttu-id="a2b9d-1266">取代字串會因某些處理對相符的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1266">The replacement string results from some processing done on the matched string.</span></span>  
  
-   <span data-ttu-id="a2b9d-1267">條件式處理取代字串結果。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1267">The replacement string results from conditional processing.</span></span>  
  
 <span data-ttu-id="a2b9d-1268">此方法相當於呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29?displayProperty=nameWithType>方法並傳遞每個<xref:System.Text.RegularExpressions.Match>在傳回的物件<xref:System.Text.RegularExpressions.MatchCollection>集合`evaluator`委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1268">The method is equivalent to calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%29?displayProperty=nameWithType> method and passing each <xref:System.Text.RegularExpressions.Match> object in the returned <xref:System.Text.RegularExpressions.MatchCollection> collection to the `evaluator` delegate.</span></span>  
  
 <span data-ttu-id="a2b9d-1269">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1269">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1270">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1270">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-1271">`evaluator`參數是您定義的自訂方法的委派，會檢查每個符合項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1271">The `evaluator` parameter is the delegate for a custom method that you define and that examines each match.</span></span> <span data-ttu-id="a2b9d-1272">自訂的方法必須具有下列簽章，以符合<xref:System.Text.RegularExpressions.MatchEvaluator>委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1272">The custom method must have the following signature to match the <xref:System.Text.RegularExpressions.MatchEvaluator> delegate.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/syntax1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/syntax1.vb#1)]  
  
 <span data-ttu-id="a2b9d-1273">您的自訂方法會傳回字串，以取代相符的輸入。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1273">Your custom method returns a string that replaces the matched input.</span></span>  
  
 <span data-ttu-id="a2b9d-1274">如果取代作業的執行時間超出為呼叫方法的應用程式定義域指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1274">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the replacement operation exceeds the time-out interval specified for the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-1275">如果在應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1275">If no time-out is defined in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
 <span data-ttu-id="a2b9d-1276">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1276">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1277">下列範例會使用規則運算式從字串擷取個別文字，然後再使用<xref:System.Text.RegularExpressions.MatchEvaluator>委派以呼叫方法，名為`WordScramble`，將金鑰加密在 word 中個別的字母。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1277">The following example uses a regular expression to extract the individual words from a string, and then uses a <xref:System.Text.RegularExpressions.MatchEvaluator> delegate to call a method named `WordScramble` that scrambles the individual letters in the word.</span></span> <span data-ttu-id="a2b9d-1278">若要這樣做，`WordScramble`方法會建立陣列，其中包含在比對的字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1278">To do this, the `WordScramble` method creates an array that contains the characters in the match.</span></span> <span data-ttu-id="a2b9d-1279">它也會建立使用隨機浮點數值的它所擴展的平行陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1279">It also creates a parallel array that it populates with random floating-point numbers.</span></span> <span data-ttu-id="a2b9d-1280">陣列會依照呼叫<xref:System.Array.Sort%60%602%28%60%600%5B%5D%2C%60%601%5B%5D%2CSystem.Collections.Generic.IComparer%7B%60%600%7D%29?displayProperty=nameWithType>方法和已排序的陣列提供做為引數<xref:System.String>類別建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1280">The arrays are sorted by calling the <xref:System.Array.Sort%60%602%28%60%600%5B%5D%2C%60%601%5B%5D%2CSystem.Collections.Generic.IComparer%7B%60%600%7D%29?displayProperty=nameWithType> method, and the sorted array is provided as an argument to a <xref:System.String> class constructor.</span></span> <span data-ttu-id="a2b9d-1281">然後傳回此新建立的字串`WordScramble`方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1281">This newly created string is then returned by the `WordScramble` method.</span></span> <span data-ttu-id="a2b9d-1282">規則運算式模式`\w+`比對一個或多個文字字元，規則運算式引擎會繼續將字元加入至比對，直到遇到非文字字元，例如空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1282">The regular expression pattern `\w+` matches one or more word characters; the regular expression engine will continue to add characters to the match until it encounters a non-word character, such as a white-space character.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replace5.cs#2)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replace5.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1283">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1283">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1284"><paramref name="input" /><paramref name="pattern" /> 或 <paramref name="evaluator" /> 是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1284"><paramref name="input" />, <paramref name="pattern" />, or <paramref name="evaluator" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1285">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1285">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1286">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1286">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1287">這個方法的逾時間隔等於呼叫這個方法的應用程式定義域的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1287">This method times out after an interval that is equal to the default time-out value of the application domain in which it is called.</span></span> <span data-ttu-id="a2b9d-1288">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1288">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-1289">建議的靜態方法，用於評估和取代模式比對是<see cref="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.Text.RegularExpressions.MatchEvaluator,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1289">The recommended static method for evaluating and replacing a pattern match is <see cref="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.Text.RegularExpressions.MatchEvaluator,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you set the time-out interval.</span></span></para>
        </block>
        <altmember cref="T:System.Text.RegularExpressions.MatchEvaluator" />
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public string Replace (string input, System.Text.RegularExpressions.MatchEvaluator evaluator, int count);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string Replace(string input, class System.Text.RegularExpressions.MatchEvaluator evaluator, int32 count) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.Text.RegularExpressions.MatchEvaluator,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Replace (input As String, evaluator As MatchEvaluator, count As Integer) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ Replace(System::String ^ input, System::Text::RegularExpressions::MatchEvaluator ^ evaluator, int count);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="evaluator" Type="System.Text.RegularExpressions.MatchEvaluator" />
        <Parameter Name="count" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1290">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1290">The string to search for a match.</span></span></param>
        <param name="evaluator"><span data-ttu-id="a2b9d-1291">檢查每個符合項目並傳回原始符合字串或取代字串的自訂方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1291">A custom method that examines each match and returns either the original matched string or a replacement string.</span></span></param>
        <param name="count"><span data-ttu-id="a2b9d-1292">取代將發生的最多次數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1292">The maximum number of times the replacement will occur.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1293">在指定的輸入字串中，使用 <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> 委派所傳回的字串來取代符合規則運算式模式的指定最大字串數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1293">In a specified input string, replaces a specified maximum number of strings that match a regular expression pattern with a string returned by a <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> delegate.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1294">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1294">A new string that is identical to the input string, except that a replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1295">如果規則運算式模式在目前執行個體中沒有符合項目，方法會傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1295">If the regular expression pattern is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1296"><xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Int32%29?displayProperty=nameWithType>方法適合用來取代規則運算式相符項目，如果下列任何一個狀況成立：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1296">The <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Int32%29?displayProperty=nameWithType> method is useful for replacing a regular expression match if any of the following conditions is true:</span></span>  
  
-   <span data-ttu-id="a2b9d-1297">規則運算式取代模式中無法隨時可以指定取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1297">The replacement string cannot readily be specified by a regular expression replacement pattern.</span></span>  
  
-   <span data-ttu-id="a2b9d-1298">取代字串會因某些處理對相符的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1298">The replacement string results from some processing done on the matched string.</span></span>  
  
-   <span data-ttu-id="a2b9d-1299">條件式處理取代字串結果。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1299">The replacement string results from conditional processing.</span></span>  
  
 <span data-ttu-id="a2b9d-1300">此方法相當於呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType>方法並傳遞第一個`count`<xref:System.Text.RegularExpressions.Match>中傳回的物件<xref:System.Text.RegularExpressions.MatchCollection>集合`evaluator`委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1300">The method is equivalent to calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%29?displayProperty=nameWithType> method and passing the first `count`<xref:System.Text.RegularExpressions.Match> objects in the returned <xref:System.Text.RegularExpressions.MatchCollection> collection to the `evaluator` delegate.</span></span>  
  
 <span data-ttu-id="a2b9d-1301">規則運算式是目前的建構函式所定義的模式<xref:System.Text.RegularExpressions.Regex>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1301">The regular expression is the pattern defined by the constructor for the current <xref:System.Text.RegularExpressions.Regex> object.</span></span>  
  
 <span data-ttu-id="a2b9d-1302">`evaluator`參數是您定義的自訂方法的委派，會檢查每個符合項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1302">The `evaluator` parameter is the delegate for a custom method that you define and that examines each match.</span></span> <span data-ttu-id="a2b9d-1303">自訂的方法必須具有下列簽章，以符合<xref:System.Text.RegularExpressions.MatchEvaluator>委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1303">The custom method must have the following signature to match the <xref:System.Text.RegularExpressions.MatchEvaluator> delegate.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/syntax1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/syntax1.vb#1)]  
  
 <span data-ttu-id="a2b9d-1304">您的自訂方法會傳回字串，以取代相符的輸入。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1304">Your custom method returns a string that replaces the matched input.</span></span>  
  
 <span data-ttu-id="a2b9d-1305">如果取代作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1305">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the replacement operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-1306">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1306">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-1307">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1307">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown</span></span>  
  
 <span data-ttu-id="a2b9d-1308">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1308">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1309">下列範例會使用規則運算式，刻意拼錯一半的清單中的字詞。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1309">The following example uses a regular expression to deliberately misspell half of the words in a list.</span></span> <span data-ttu-id="a2b9d-1310">它會使用規則運算式`\w*(ie|ei)\w*`以比對包含"ei"或"ie"字元的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1310">It uses the regular expression `\w*(ie|ei)\w*` to match words that include the characters "ie" or "ei".</span></span> <span data-ttu-id="a2b9d-1311">它會傳遞第一個要比對文字的下半部`ReverseLetter`方法，這個方法會接著使用<xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29>反向"i"和"e"相符的字串中的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1311">It passes the first half of the matching words to the `ReverseLetter` method, which, in turn, uses the <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29> method to reverse "i" and "e" in the matched string.</span></span> <span data-ttu-id="a2b9d-1312">其他字維持不變。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1312">The remaining words remain unchanged.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#11](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replace7.cs#11)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#11](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replace7.vb#11)]  
  
 <span data-ttu-id="a2b9d-1313">規則運算式 `\w*(ie|ei)\w*` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1313">The regular expression `\w*(ie|ei)\w*` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-1314">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1314">Pattern</span></span>|<span data-ttu-id="a2b9d-1315">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1315">Description</span></span>|  
|-------------|-----------------|  
|`\w*`|<span data-ttu-id="a2b9d-1316">比對零個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1316">Match zero or more word characters.</span></span>|  
|`(ie&#124;ei)`|<span data-ttu-id="a2b9d-1317">比對"ie"或"ei"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1317">Match either "ie" or "ei".</span></span>|  
|`\w*`|<span data-ttu-id="a2b9d-1318">比對零個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1318">Match zero or more word characters.</span></span>|  
  
 <span data-ttu-id="a2b9d-1319">規則運算式模式`([ie])([ie])`中`ReverseLetter`方法符合 diphthong"ei"或"ie 」 中的第一個"i"或"e"，並將代號指派給第一個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1319">The regular expression pattern `([ie])([ie])` in the `ReverseLetter` method matches the first "i" or "e" in the diphthong "ie" or "ei" and assigns the letter to the first capturing group.</span></span> <span data-ttu-id="a2b9d-1320">它會比對的第二個"i"或"e"，並將代號指派給第二個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1320">It matches the second "i" or "e" and assigns the letter to the second capturing group.</span></span> <span data-ttu-id="a2b9d-1321">兩個字元反過來藉由呼叫<xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%29>方法取代模式`$2$1`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1321">The two characters are then reversed by calling the <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%29> method with the replacement pattern `$2$1`.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1322"><paramref name="input" /> 或 <paramref name="evaluator" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1322"><paramref name="input" /> or <paramref name="evaluator" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1323">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1323">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1324">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1324">For more information about time-outs, see the Remarks section.</span></span></exception>
        <altmember cref="T:System.Text.RegularExpressions.MatchEvaluator" />
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public string Replace (string input, string replacement, int count, int startat);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string Replace(string input, string replacement, int32 count, int32 startat) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.Int32,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Replace (input As String, replacement As String, count As Integer, startat As Integer) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ Replace(System::String ^ input, System::String ^ replacement, int count, int startat);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="replacement" Type="System.String" />
        <Parameter Name="count" Type="System.Int32" />
        <Parameter Name="startat" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1325">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1325">The string to search for a match.</span></span></param>
        <param name="replacement"><span data-ttu-id="a2b9d-1326">取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1326">The replacement string.</span></span></param>
        <param name="count"><span data-ttu-id="a2b9d-1327">取代可以發生的最多次數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1327">Maximum number of times the replacement can occur.</span></span></param>
        <param name="startat"><span data-ttu-id="a2b9d-1328">在輸入字串中開始搜尋的字元位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1328">The character position in the input string where the search begins.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1329">在指定的輸入子字串中，使用指定的取代字串來取代符合規則運算式模式的指定最大字串數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1329">In a specified input substring, replaces a specified maximum number of strings that match a regular expression pattern with a specified replacement string.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1330">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1330">A new string that is identical to the input string, except that the replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1331">如果規則運算式模式在目前執行個體中沒有符合項目，方法會傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1331">If the regular expression pattern is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1332">搜尋符合項目中啟動`input`字串所指定的位置`startat`參數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1332">The search for matches starts in the `input` string at the position specified by the `startat` parameter.</span></span> <span data-ttu-id="a2b9d-1333">規則運算式是目前的建構函式所定義的模式<xref:System.Text.RegularExpressions.Regex>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1333">The regular expression is the pattern defined by the constructor for the current <xref:System.Text.RegularExpressions.Regex> object.</span></span> <span data-ttu-id="a2b9d-1334">如果`count`是負數，字串的結尾繼續取代項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1334">If `count` is negative, replacements continue to the end of the string.</span></span> <span data-ttu-id="a2b9d-1335">如果`count`超過的相符項目數，取代所有相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1335">If `count` exceeds the number of matches, all matches are replaced.</span></span>  
  
 <span data-ttu-id="a2b9d-1336">`replacement`參數指定的字串來取代中的每個相符項目`input`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1336">The `replacement` parameter specifies the string that is to replace each match in `input`.</span></span> <span data-ttu-id="a2b9d-1337">`replacement` 可以包含常值文字的任何組合和[替代](~/docs/standard/base-types/substitutions-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1337">`replacement` can consist of any combination of literal text and [substitutions](~/docs/standard/base-types/substitutions-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-1338">例如，取代模式`a*${test}b`插入的字串"*"後面接著所比對的子字串`test`擷取群組，如果有的話，後面接著字串"b"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1338">For example, the replacement pattern `a*${test}b` inserts the string "a*" followed by the substring that is matched by the `test` capturing group, if any, followed by the string "b".</span></span> <span data-ttu-id="a2b9d-1339">\* 字元無法辨識為中繼字元取代模式內。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1339">The \* character is not recognized as a metacharacter within a replacement pattern.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a2b9d-1340">替代是在取代模式中才能辨識的只是規則運算式語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1340">Substitutions are the only regular expression language elements that are recognized in a replacement pattern.</span></span> <span data-ttu-id="a2b9d-1341">所有其他規則運算式語言項目，包括[字元逸出](~/docs/standard/base-types/character-escapes-in-regular-expressions.md)、 可只在規則運算式模式中，而且無法辨識取代模式中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1341">All other regular expression language elements, including [character escapes](~/docs/standard/base-types/character-escapes-in-regular-expressions.md), are allowed in regular expression patterns only and are not recognized in replacement patterns.</span></span>  
  
 <span data-ttu-id="a2b9d-1342">如果取代作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1342">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the replacement operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-1343">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1343">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-1344">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1344">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown</span></span>  
  
 <span data-ttu-id="a2b9d-1345">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1345">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1346">下列範例 double-spaces 字串的第一行以外的所有節點。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1346">The following example double-spaces all but the first line of a string.</span></span> <span data-ttu-id="a2b9d-1347">它會定義規則運算式模式， `^.*$`，符合一行文字，呼叫<xref:System.Text.RegularExpressions.Regex.Match%28System.String%29>方法來比對的字串，並使用的第一行`Match.Index`和`Match.Count`屬性，以判斷第二個的開始位置行。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1347">It defines a regular expression pattern, `^.*$`, that matches a line of text, calls the <xref:System.Text.RegularExpressions.Regex.Match%28System.String%29> method to match the first line of the string, and uses the `Match.Index` and `Match.Count` properties to determine the starting position of the second line.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#9](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replaceexample9.cs#9)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#9](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replaceexample9.vb#9)]  
  
 <span data-ttu-id="a2b9d-1348">規則運算式模式 `^.*$` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1348">The regular expression pattern `^.*$` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="a2b9d-1349">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1349">Pattern</span></span>|<span data-ttu-id="a2b9d-1350">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1350">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="a2b9d-1351">比對行首。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1351">Match the start of a line.</span></span> <span data-ttu-id="a2b9d-1352">(請注意，<xref:System.Text.RegularExpressions.Regex>物件具現化使用<xref:System.Text.RegularExpressions.RegexOptions.Multiline?displayProperty=nameWithType>選項; 否則這個字元類別會只比對輸入字串的開頭。)</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1352">(Note that the <xref:System.Text.RegularExpressions.Regex> object was instantiated by using the <xref:System.Text.RegularExpressions.RegexOptions.Multiline?displayProperty=nameWithType> option; otherwise, this character class would only match the beginning of the input string.)</span></span>|  
|`.*`|<span data-ttu-id="a2b9d-1353">比對任何字元零次以上。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1353">Match any character zero or more times.</span></span>|  
|`$`|<span data-ttu-id="a2b9d-1354">比對行尾。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1354">Match the end of a line.</span></span> <span data-ttu-id="a2b9d-1355">(請注意，<xref:System.Text.RegularExpressions.Regex>物件具現化使用<xref:System.Text.RegularExpressions.RegexOptions.Multiline?displayProperty=nameWithType>選項; 否則這個字元類別會只比對輸入字串的開頭。)</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1355">(Note that the <xref:System.Text.RegularExpressions.Regex> object was instantiated by using the <xref:System.Text.RegularExpressions.RegexOptions.Multiline?displayProperty=nameWithType> option; otherwise, this character class would only match the beginning of the input string.)</span></span>|  
  
 <span data-ttu-id="a2b9d-1356">取代字串 (`vbCrLf + "$&"`在 Visual Basic 中`"\n$&"`C# 中) 會將新行之前比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1356">The replacement string (`vbCrLf + "$&"` in Visual Basic, `"\n$&"` in C#) adds a new line before the matched string.</span></span> <span data-ttu-id="a2b9d-1357">請注意，`\n`在 C# 範例會解譯為新行字元的 C# 編譯器; 它不代表規則運算式字元逸出。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1357">Note that `\n` in the C# example is interpreted as the newline character by the C# compiler; it does not represent a regular expression character escape.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1358"><paramref name="input" /> 或 <paramref name="replacement" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1358"><paramref name="input" /> or <paramref name="replacement" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1359"><paramref name="startat" /> 小於零或大於 <paramref name="input" /> 的長度。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1359"><paramref name="startat" /> is less than zero or greater than the length of <paramref name="input" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1360">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1360">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1361">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1361">For more information about time-outs, see the Remarks section.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public static string Replace (string input, string pattern, string replacement, System.Text.RegularExpressions.RegexOptions options);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string Replace(string input, string pattern, string replacement, valuetype System.Text.RegularExpressions.RegexOptions options) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.String,System.Text.RegularExpressions.RegexOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Replace (input As String, pattern As String, replacement As String, options As RegexOptions) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Replace(System::String ^ input, System::String ^ pattern, System::String ^ replacement, System::Text::RegularExpressions::RegexOptions options);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="replacement" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1362">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1362">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1363">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1363">The regular expression pattern to match.</span></span></param>
        <param name="replacement"><span data-ttu-id="a2b9d-1364">取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1364">The replacement string.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-1365">列舉值的位元組合，提供用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1365">A bitwise combination of the enumeration values that provide options for matching.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1366">在指定的輸入字串中，使用指定的取代字串來取代符合指定之規則運算式的所有字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1366">In a specified input string, replaces all strings that match a specified regular expression with a specified replacement string.</span></span> <span data-ttu-id="a2b9d-1367">指定的選項會修改符合的作業。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1367">Specified options modify the matching operation.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1368">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1368">A new string that is identical to the input string, except that the replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1369">如果在目前的執行個體中沒有符合 <paramref name="pattern" /> 的項目，則方法傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1369">If <paramref name="pattern" /> is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1370">靜態`Replace`方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件與指定的規則運算式模式，並呼叫的執行個體方法`Replace`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1370">The static `Replace` methods are equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the specified regular expression pattern and calling the instance method `Replace`.</span></span>  
  
 <span data-ttu-id="a2b9d-1371">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1371">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1372">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1372">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span> <span data-ttu-id="a2b9d-1373">如果為 <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft> 參數指定 `options`，搜尋符合項目會從輸入字串結尾開始向左移動，否則，搜尋會從輸入字串開頭開始向右移動。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1373">If you specify <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft> for the `options` parameter, the search for matches begins at the end of the input string and moves left; otherwise, the search begins at the start of the input string and moves right.</span></span>  
  
 <span data-ttu-id="a2b9d-1374">`replacement`參數指定的字串來取代中的每個相符項目`input`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1374">The `replacement` parameter specifies the string that is to replace each match in `input`.</span></span> <span data-ttu-id="a2b9d-1375">`replacement` 可以包含常值文字的任何組合和[替代](~/docs/standard/base-types/substitutions-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1375">`replacement` can consist of any combination of literal text and [substitutions](~/docs/standard/base-types/substitutions-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-1376">例如，取代模式`a*${test}b`插入的字串"*"後面接著所比對的子字串`test`擷取群組，如果有的話，後面接著字串"b"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1376">For example, the replacement pattern `a*${test}b` inserts the string "a*" followed by the substring that is matched by the `test` capturing group, if any, followed by the string "b".</span></span> <span data-ttu-id="a2b9d-1377">\* 字元無法辨識為中繼字元取代模式內。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1377">The \* character is not recognized as a metacharacter within a replacement pattern.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a2b9d-1378">替代是在取代模式中才能辨識的只是規則運算式語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1378">Substitutions are the only regular expression language elements that are recognized in a replacement pattern.</span></span> <span data-ttu-id="a2b9d-1379">所有其他規則運算式語言項目，包括[字元逸出](~/docs/standard/base-types/character-escapes-in-regular-expressions.md)、 可只在規則運算式模式中，而且無法辨識取代模式中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1379">All other regular expression language elements, including [character escapes](~/docs/standard/base-types/character-escapes-in-regular-expressions.md), are allowed in regular expression patterns only and are not recognized in replacement patterns.</span></span>  
  
 <span data-ttu-id="a2b9d-1380">如果取代作業的執行時間超出為呼叫方法的應用程式定義域指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1380">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the replacement operation exceeds the time-out interval specified for the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-1381">如果在應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1381">If no time-out is defined in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
 <span data-ttu-id="a2b9d-1382">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1382">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1383">下列範例會使用<xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29>方法以取代本機檔案路徑的 UNC 路徑中的本機電腦和磁碟機名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1383">The following example uses the <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29> method to replace the local machine and drive names in a UNC path with a local file path.</span></span> <span data-ttu-id="a2b9d-1384">規則運算式會使用<xref:System.Environment.MachineName%2A?displayProperty=nameWithType>屬性，以包括在本機電腦的名稱和<xref:System.Environment.GetLogicalDrives%2A?displayProperty=nameWithType>方法，將包含邏輯磁碟的名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1384">The regular expression uses the <xref:System.Environment.MachineName%2A?displayProperty=nameWithType> property to include the name of the local computer, and the <xref:System.Environment.GetLogicalDrives%2A?displayProperty=nameWithType> method to include the names of the logical drives.</span></span> <span data-ttu-id="a2b9d-1385">所有的規則運算式的字串比較不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1385">All regular expression string comparisons are case-insensitive.</span></span> <span data-ttu-id="a2b9d-1386">若要成功執行此範例，您應該以您本機電腦的名稱取代常值字串"MyMachine"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1386">To run the example successfully, you should replace the literal string "MyMachine" with your local machine name.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#4](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replace4.cs#4)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#4](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replace4.vb#4)]  
  
 <span data-ttu-id="a2b9d-1387">下列的運算式所定義的規則運算式模式：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1387">The regular expression pattern is defined by the following expression:</span></span>  
  
 `"\\\\" + Environment.MachineName + "(?:\.\w+)*\\([" + driveNames + "])\$"`  
  
 <span data-ttu-id="a2b9d-1388">下表顯示規則運算式模式的解譯方式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1388">The following table shows how the regular expression pattern is interpreted.</span></span>  
  
|<span data-ttu-id="a2b9d-1389">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1389">Pattern</span></span>|<span data-ttu-id="a2b9d-1390">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1390">Description</span></span>|  
|-------------|-----------------|  
|`\\\\`|<span data-ttu-id="a2b9d-1391">比對兩個連續反斜線 (`\`) 字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1391">Match two consecutive backslash (`\`) characters.</span></span> <span data-ttu-id="a2b9d-1392">反斜線字元解譯為逸出字元，因此每個反斜線必須逸出與另一個反斜線。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1392">Because the backslash character is interpreted as the escape character, each backslash must be escaped with another backslash.</span></span>|  
|`+ Environment.MachineName +`|<span data-ttu-id="a2b9d-1393">所傳回的字串相符<xref:System.Environment.MachineName%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1393">Match the string that is returned by the <xref:System.Environment.MachineName%2A?displayProperty=nameWithType> property.</span></span>|  
|`(?:\.\w+)*`|<span data-ttu-id="a2b9d-1394">比對句號 (`.`) 字元後面接著一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1394">Match the period (`.`) character followed by one or more word characters.</span></span> <span data-ttu-id="a2b9d-1395">此比對可以發生零次以上。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1395">This match can occur zero or more times.</span></span> <span data-ttu-id="a2b9d-1396">不會擷取相符子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1396">The matched subexpression is not captured.</span></span>|  
|`\\`|<span data-ttu-id="a2b9d-1397">符合反斜線 (`\`) 字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1397">Match a backslash (`\`) character.</span></span>|  
|`([" + driveNames + "])`|<span data-ttu-id="a2b9d-1398">比對的字元類別包含的個別磁碟機代號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1398">Match the character class that consists of the individual drive letters.</span></span> <span data-ttu-id="a2b9d-1399">此項比對是第一個擷取子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1399">This match is the first captured subexpression.</span></span>|  
|`\$`|<span data-ttu-id="a2b9d-1400">比對常值的貨幣符號 (`$`) 字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1400">Match the literal dollar sign (`$`) character.</span></span>|  
  
 <span data-ttu-id="a2b9d-1401">取代模式`$1`整個相符項目取代為第一個擷取子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1401">The replacement pattern `$1` replaces the entire match with the first captured subexpression.</span></span> <span data-ttu-id="a2b9d-1402">也就是說，它會取代 UNC 電腦和磁碟機名稱的磁碟機代號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1402">That is, it replaces the UNC machine and drive name with the drive letter.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1403">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1403">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1404"><paramref name="input" /><paramref name="pattern" /> 或 <paramref name="replacement" /> 是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1404"><paramref name="input" />, <paramref name="pattern" />, or <paramref name="replacement" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1405"><paramref name="options" /> 不是 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值的有效位元組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1405"><paramref name="options" /> is not a valid bitwise combination of <see cref="T:System.Text.RegularExpressions.RegexOptions" /> values.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1406">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1406">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1407">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1407">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1408">這個方法的逾時間隔等於呼叫這個方法的應用程式定義域的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1408">This method times out after an interval that is equal to the default time-out value of the application domain in which it is called.</span></span> <span data-ttu-id="a2b9d-1409">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1409">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-1410">建議的靜態方法，取代模式比對是<see cref="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1410">The recommended static method for replacing a pattern match is <see cref="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you set the time-out interval.</span></span></para>
        </block>
        <altmember cref="T:System.Text.RegularExpressions.RegexOptions" />
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public static string Replace (string input, string pattern, System.Text.RegularExpressions.MatchEvaluator evaluator, System.Text.RegularExpressions.RegexOptions options);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string Replace(string input, string pattern, class System.Text.RegularExpressions.MatchEvaluator evaluator, valuetype System.Text.RegularExpressions.RegexOptions options) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.Text.RegularExpressions.MatchEvaluator,System.Text.RegularExpressions.RegexOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Replace (input As String, pattern As String, evaluator As MatchEvaluator, options As RegexOptions) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Replace(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::MatchEvaluator ^ evaluator, System::Text::RegularExpressions::RegexOptions options);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="evaluator" Type="System.Text.RegularExpressions.MatchEvaluator" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1411">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1411">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1412">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1412">The regular expression pattern to match.</span></span></param>
        <param name="evaluator"><span data-ttu-id="a2b9d-1413">檢查每個符合項目並傳回原始符合字串或取代字串的自訂方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1413">A custom method that examines each match and returns either the original matched string or a replacement string.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-1414">列舉值的位元組合，提供用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1414">A bitwise combination of the enumeration values that provide options for matching.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1415">在指定的輸入字串中，使用 <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> 委派所傳回的字串來取代所有符合指定之規則運算式的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1415">In a specified input string, replaces all strings that match a specified regular expression with a string returned by a <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> delegate.</span></span> <span data-ttu-id="a2b9d-1416">指定的選項會修改符合的作業。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1416">Specified options modify the matching operation.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1417">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1417">A new string that is identical to the input string, except that a replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1418">如果在目前的執行個體中沒有符合 <paramref name="pattern" /> 的項目，則方法傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1418">If <paramref name="pattern" /> is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1419"><xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType>方法適合用來取代規則運算式相符項目中的，如果下列任何一個狀況成立：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1419">The <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType> method is useful for replacing a regular expression match in if any of the following conditions is true:</span></span>  
  
-   <span data-ttu-id="a2b9d-1420">規則運算式取代模式中無法隨時可以指定取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1420">The replacement string cannot readily be specified by a regular expression replacement pattern.</span></span>  
  
-   <span data-ttu-id="a2b9d-1421">取代字串會因某些處理對相符的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1421">The replacement string results from some processing done on the matched string.</span></span>  
  
-   <span data-ttu-id="a2b9d-1422">條件式處理取代字串結果。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1422">The replacement string results from conditional processing.</span></span>  
  
 <span data-ttu-id="a2b9d-1423">此方法相當於呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType>方法並傳遞每個<xref:System.Text.RegularExpressions.Match>在傳回的物件<xref:System.Text.RegularExpressions.MatchCollection>集合`evaluator`委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1423">The method is equivalent to calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType> method and passing each <xref:System.Text.RegularExpressions.Match> object in the returned <xref:System.Text.RegularExpressions.MatchCollection> collection to the `evaluator` delegate.</span></span>  
  
 <span data-ttu-id="a2b9d-1424">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1424">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1425">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1425">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-1426">`evaluator`參數是您定義的自訂方法的委派，會檢查每個符合項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1426">The `evaluator` parameter is the delegate for a custom method that you define and that examines each match.</span></span> <span data-ttu-id="a2b9d-1427">自訂的方法必須具有下列簽章，以符合<xref:System.Text.RegularExpressions.MatchEvaluator>委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1427">The custom method must have the following signature to match the <xref:System.Text.RegularExpressions.MatchEvaluator> delegate.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/syntax1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/syntax1.vb#1)]  
  
 <span data-ttu-id="a2b9d-1428">您的自訂方法會傳回字串，以取代相符的輸入。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1428">Your custom method returns a string that replaces the matched input.</span></span>  
  
 <span data-ttu-id="a2b9d-1429">如果為 <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft> 參數指定 `options`，搜尋符合項目會從輸入字串結尾開始向左移動，否則，搜尋會從輸入字串開頭開始向右移動。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1429">If you specify <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft> for the `options` parameter, the search for matches begins at the end of the input string and moves left; otherwise, the search begins at the start of the input string and moves right.</span></span>  
  
 <span data-ttu-id="a2b9d-1430">如果取代作業的執行時間超出為呼叫方法的應用程式定義域指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1430">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the replacement operation exceeds the time-out interval specified for the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-1431">如果在應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1431">If no time-out is defined in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
 <span data-ttu-id="a2b9d-1432">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1432">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1433">下列範例會使用規則運算式從字串擷取個別文字，然後再使用<xref:System.Text.RegularExpressions.MatchEvaluator>委派以呼叫方法，名為`WordScramble`，將金鑰加密在 word 中個別的字母。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1433">The following example uses a regular expression to extract the individual words from a string, and then uses a <xref:System.Text.RegularExpressions.MatchEvaluator> delegate to call a method named `WordScramble` that scrambles the individual letters in the word.</span></span> <span data-ttu-id="a2b9d-1434">若要這樣做，`WordScramble`方法會建立陣列，其中包含在比對的字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1434">To do this, the `WordScramble` method creates an array that contains the characters in the match.</span></span> <span data-ttu-id="a2b9d-1435">它也會建立使用隨機浮點數值的它所擴展的平行陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1435">It also creates a parallel array that it populates with random floating-point numbers.</span></span> <span data-ttu-id="a2b9d-1436">陣列會依照呼叫<xref:System.Array.Sort%60%602%28%60%600%5B%5D%2C%60%601%5B%5D%2CSystem.Collections.Generic.IComparer%7B%60%600%7D%29?displayProperty=nameWithType>方法和已排序的陣列提供做為引數<xref:System.String>類別建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1436">The arrays are sorted by calling the <xref:System.Array.Sort%60%602%28%60%600%5B%5D%2C%60%601%5B%5D%2CSystem.Collections.Generic.IComparer%7B%60%600%7D%29?displayProperty=nameWithType> method, and the sorted array is provided as an argument to a <xref:System.String> class constructor.</span></span> <span data-ttu-id="a2b9d-1437">然後傳回此新建立的字串`WordScramble`方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1437">This newly created string is then returned by the `WordScramble` method.</span></span> <span data-ttu-id="a2b9d-1438">規則運算式模式`\w+`比對一個或多個文字字元，規則運算式引擎會繼續將字元加入至比對，直到遇到非文字字元，例如空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1438">The regular expression pattern `\w+` matches one or more word characters; the regular expression engine will continue to add characters to the match until it encounters a non-word character, such as a white-space character.</span></span> <span data-ttu-id="a2b9d-1439">呼叫<xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Text.RegularExpressions.RegexOptions%29>方法包含<xref:System.Text.RegularExpressions.RegexOptions.IgnorePatternWhitespace?displayProperty=nameWithType>選項，讓規則運算式模式中的註解`\w+  # Matches all the characters in a word.`會忽略規則運算式引擎。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1439">The call to the <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Text.RegularExpressions.RegexOptions%29> method includes the <xref:System.Text.RegularExpressions.RegexOptions.IgnorePatternWhitespace?displayProperty=nameWithType> option so that the comment in the regular expression pattern `\w+  # Matches all the characters in a word.` is ignored by the regular expression engine.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#10](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replace6.cs#10)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#10](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replace6.vb#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1440">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1440">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1441"><paramref name="input" /><paramref name="pattern" /> 或 <paramref name="evaluator" /> 是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1441"><paramref name="input" />, <paramref name="pattern" />, or <paramref name="evaluator" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1442"><paramref name="options" /> 不是 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值的有效位元組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1442"><paramref name="options" /> is not a valid bitwise combination of <see cref="T:System.Text.RegularExpressions.RegexOptions" /> values.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1443">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1443">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1444">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1444">For more information about time-outs, see the Remarks section.</span></span></exception>
        <altmember cref="T:System.Text.RegularExpressions.MatchEvaluator" />
        <altmember cref="T:System.Text.RegularExpressions.RegexOptions" />
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public string Replace (string input, System.Text.RegularExpressions.MatchEvaluator evaluator, int count, int startat);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string Replace(string input, class System.Text.RegularExpressions.MatchEvaluator evaluator, int32 count, int32 startat) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.Text.RegularExpressions.MatchEvaluator,System.Int32,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Replace (input As String, evaluator As MatchEvaluator, count As Integer, startat As Integer) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ Replace(System::String ^ input, System::Text::RegularExpressions::MatchEvaluator ^ evaluator, int count, int startat);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="evaluator" Type="System.Text.RegularExpressions.MatchEvaluator" />
        <Parameter Name="count" Type="System.Int32" />
        <Parameter Name="startat" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1445">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1445">The string to search for a match.</span></span></param>
        <param name="evaluator"><span data-ttu-id="a2b9d-1446">檢查每個符合項目並傳回原始符合字串或取代字串的自訂方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1446">A custom method that examines each match and returns either the original matched string or a replacement string.</span></span></param>
        <param name="count"><span data-ttu-id="a2b9d-1447">取代將發生的最多次數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1447">The maximum number of times the replacement will occur.</span></span></param>
        <param name="startat"><span data-ttu-id="a2b9d-1448">在輸入字串中開始搜尋的字元位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1448">The character position in the input string where the search begins.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1449">在指定的輸入子字串中，使用 <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> 委派所傳回的字串來取代符合規則運算式模式的指定最大字串數目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1449">In a specified input substring, replaces a specified maximum number of strings that match a regular expression pattern with a string returned by a <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> delegate.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1450">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1450">A new string that is identical to the input string, except that a replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1451">如果規則運算式模式在目前執行個體中沒有符合項目，方法會傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1451">If the regular expression pattern is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1452"><xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Int32%2CSystem.Int32%29?displayProperty=nameWithType>方法適合用來取代規則運算式相符項目，如果下列任何一個狀況成立：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1452">The <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Int32%2CSystem.Int32%29?displayProperty=nameWithType> method is useful for replacing a regular expression match if any of the following conditions is true:</span></span>  
  
-   <span data-ttu-id="a2b9d-1453">規則運算式取代模式中無法隨時可以指定取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1453">The replacement string cannot readily be specified by a regular expression replacement pattern.</span></span>  
  
-   <span data-ttu-id="a2b9d-1454">取代字串會因某些處理對相符的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1454">The replacement string results from some processing done on the matched string.</span></span>  
  
-   <span data-ttu-id="a2b9d-1455">條件式處理取代字串結果。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1455">The replacement string results from conditional processing.</span></span>  
  
 <span data-ttu-id="a2b9d-1456">此方法相當於呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29?displayProperty=nameWithType>方法並傳遞第一個`count`<xref:System.Text.RegularExpressions.Match>中傳回的物件<xref:System.Text.RegularExpressions.MatchCollection>集合`evaluator`委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1456">The method is equivalent to calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.Int32%29?displayProperty=nameWithType> method and passing the first `count`<xref:System.Text.RegularExpressions.Match> objects in the returned <xref:System.Text.RegularExpressions.MatchCollection> collection to the `evaluator` delegate.</span></span>  
  
 <span data-ttu-id="a2b9d-1457">規則運算式是目前的建構函式所定義的模式<xref:System.Text.RegularExpressions.Regex>物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1457">The regular expression is the pattern defined by the constructor for the current <xref:System.Text.RegularExpressions.Regex> object.</span></span>  
  
 <span data-ttu-id="a2b9d-1458">`evaluator`參數是您定義的自訂方法的委派，會檢查每個符合項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1458">The `evaluator` parameter is the delegate for a custom method that you define and that examines each match.</span></span> <span data-ttu-id="a2b9d-1459">自訂的方法必須具有下列簽章，以符合<xref:System.Text.RegularExpressions.MatchEvaluator>委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1459">The custom method must have the following signature to match the <xref:System.Text.RegularExpressions.MatchEvaluator> delegate.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/syntax1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/syntax1.vb#1)]  
  
 <span data-ttu-id="a2b9d-1460">您的自訂方法會傳回字串，以取代相符的輸入。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1460">Your custom method returns a string that replaces the matched input.</span></span>  
  
 <span data-ttu-id="a2b9d-1461">如果取代作業的執行時間超出 <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> 建構函式所指定的逾時間隔，就會擲回 <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1461">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the replacement operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-1462">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1462">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-1463">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1463">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown</span></span>  
  
 <span data-ttu-id="a2b9d-1464">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1464">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1465"><paramref name="input" /> 或 <paramref name="evaluator" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1465"><paramref name="input" /> or <paramref name="evaluator" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1466"><paramref name="startat" /> 小於零或大於 <paramref name="input" /> 的長度。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1466"><paramref name="startat" /> is less than zero or greater than the length of <paramref name="input" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1467">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1467">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1468">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1468">For more information about time-outs, see the Remarks section.</span></span></exception>
        <altmember cref="T:System.Text.RegularExpressions.MatchEvaluator" />
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public static string Replace (string input, string pattern, string replacement, System.Text.RegularExpressions.RegexOptions options, TimeSpan matchTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string Replace(string input, string pattern, string replacement, valuetype System.Text.RegularExpressions.RegexOptions options, valuetype System.TimeSpan matchTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Replace (input As String, pattern As String, replacement As String, options As RegexOptions, matchTimeout As TimeSpan) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Replace(System::String ^ input, System::String ^ pattern, System::String ^ replacement, System::Text::RegularExpressions::RegexOptions options, TimeSpan matchTimeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="replacement" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
        <Parameter Name="matchTimeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1469">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1469">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1470">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1470">The regular expression pattern to match.</span></span></param>
        <param name="replacement"><span data-ttu-id="a2b9d-1471">取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1471">The replacement string.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-1472">列舉值的位元組合，提供用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1472">A bitwise combination of the enumeration values that provide options for matching.</span></span></param>
        <param name="matchTimeout"><span data-ttu-id="a2b9d-1473">間隔，若要表示此方法不會逾時則為 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1473">A time-out interval, or <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" /> to indicate that the method should not time out.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1474">在指定的輸入字串中，使用指定的取代字串來取代符合指定之規則運算式的所有字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1474">In a specified input string, replaces all strings that match a specified regular expression with a specified replacement string.</span></span> <span data-ttu-id="a2b9d-1475">如果沒有找到相符項目，其他參數會指定修改比對作業的選項和逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1475">Additional parameters specify options that modify the matching operation and a time-out interval if no match is found.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1476">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1476">A new string that is identical to the input string, except that the replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1477">如果在目前的執行個體中沒有符合 <paramref name="pattern" /> 的項目，則方法傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1477">If <paramref name="pattern" /> is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1478">靜態`Replace`方法相當於建構<xref:System.Text.RegularExpressions.Regex>物件與指定的規則運算式模式，並呼叫的執行個體方法`Replace`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1478">The static `Replace` methods are equivalent to constructing a <xref:System.Text.RegularExpressions.Regex> object with the specified regular expression pattern and calling the instance method `Replace`.</span></span>  
  
 <span data-ttu-id="a2b9d-1479">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1479">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1480">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1480">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span> <span data-ttu-id="a2b9d-1481">如果為 <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft> 參數指定 `options`，搜尋符合項目會從輸入字串結尾開始向左移動，否則，搜尋會從輸入字串開頭開始向右移動。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1481">If you specify <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft> for the `options` parameter, the search for matches begins at the end of the input string and moves left; otherwise, the search begins at the start of the input string and moves right.</span></span>  
  
 <span data-ttu-id="a2b9d-1482">`replacement`參數指定的字串來取代中的每個相符項目`input`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1482">The `replacement` parameter specifies the string that is to replace each match in `input`.</span></span> <span data-ttu-id="a2b9d-1483">`replacement` 可以包含常值文字的任何組合和[替代](~/docs/standard/base-types/substitutions-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1483">`replacement` can consist of any combination of literal text and [substitutions](~/docs/standard/base-types/substitutions-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-1484">例如，取代模式`a*${test}b`插入的字串"*"後面接著所比對的子字串`test`擷取群組，如果有的話，後面接著字串"b"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1484">For example, the replacement pattern `a*${test}b` inserts the string "a*" followed by the substring that is matched by the `test` capturing group, if any, followed by the string "b".</span></span> <span data-ttu-id="a2b9d-1485">\* 字元無法辨識為中繼字元取代模式內。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1485">The \* character is not recognized as a metacharacter within a replacement pattern.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a2b9d-1486">替代是在取代模式中才能辨識的只是規則運算式語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1486">Substitutions are the only regular expression language elements that are recognized in a replacement pattern.</span></span> <span data-ttu-id="a2b9d-1487">所有其他規則運算式語言項目，包括[字元逸出](~/docs/standard/base-types/character-escapes-in-regular-expressions.md)、 可只在規則運算式模式中，而且無法辨識取代模式中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1487">All other regular expression language elements, including [character escapes](~/docs/standard/base-types/character-escapes-in-regular-expressions.md), are allowed in regular expression patterns only and are not recognized in replacement patterns.</span></span>  
  
 <span data-ttu-id="a2b9d-1488">`matchTimeout`參數會指定如何長模式比對方法應嘗試尋找相符項目，即會逾時。設定逾時間隔可避免依賴大量回溯出現停止回應時，它們會處理輸入的規則運算式，其中包含相符項目附近。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1488">The `matchTimeout` parameter specifies how long a pattern matching method should try to find a match before it times out. Setting a time-out interval prevents regular expressions that rely on excessive backtracking from appearing to stop responding when they process input that contains near matches.</span></span> <span data-ttu-id="a2b9d-1489">如需詳細資訊，請參閱[規則運算式的最佳作法](~/docs/standard/base-types/best-practices.md)和[回溯](~/docs/standard/base-types/backtracking-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1489">For more information, see [Best Practices for Regular Expressions](~/docs/standard/base-types/best-practices.md) and [Backtracking](~/docs/standard/base-types/backtracking-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-1490">如果該時間間隔中找到相符項目，方法會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1490">If no match is found in that time interval, the method throws a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-1491">`matchTimeout` 覆寫任何方法執行於其中的應用程式定義域定義的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1491">`matchTimeout` overrides any default time-out value defined for the application domain in which the method executes.</span></span>  
  
 <span data-ttu-id="a2b9d-1492">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1492">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1493">下列範例會使用<xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29>方法以取代本機檔案路徑的 UNC 路徑中的本機電腦和磁碟機名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1493">The following example uses the <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29> method to replace the local machine and drive names in a UNC path with a local file path.</span></span> <span data-ttu-id="a2b9d-1494">規則運算式會使用<xref:System.Environment.MachineName%2A?displayProperty=nameWithType>屬性，以包括本機電腦的名稱和<xref:System.Environment.GetLogicalDrives%2A?displayProperty=nameWithType>方法，將包含邏輯磁碟的名稱。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1494">The regular expression uses the <xref:System.Environment.MachineName%2A?displayProperty=nameWithType> property to include the name of the local computer and the <xref:System.Environment.GetLogicalDrives%2A?displayProperty=nameWithType> method to include the names of the logical drives.</span></span> <span data-ttu-id="a2b9d-1495">所有的規則運算式的字串比較會區分大小寫，和任何單一的取代作業逾時，如果 0.5 秒內找不到相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1495">All regular expression string comparisons are case-insensitive, and any single replacement operation times out if a match cannot be found in 0.5 second.</span></span> <span data-ttu-id="a2b9d-1496">若要成功執行此範例，您應該以您本機電腦的名稱取代常值字串"MyMachine"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1496">To run the example successfully, you should replace the literal string "MyMachine" with your local machine name.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#12](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replace12.cs#12)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#12](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replace12.vb#12)]  
  
 <span data-ttu-id="a2b9d-1497">下列的運算式所定義的規則運算式模式：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1497">The regular expression pattern is defined by the following expression:</span></span>  
  
 `"\\\\" + Environment.MachineName + "(?:\.\w+)*\\([" + driveNames + "])\$"`  
  
 <span data-ttu-id="a2b9d-1498">下表顯示規則運算式模式的解譯方式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1498">The following table shows how the regular expression pattern is interpreted.</span></span>  
  
|<span data-ttu-id="a2b9d-1499">模式</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1499">Pattern</span></span>|<span data-ttu-id="a2b9d-1500">描述</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1500">Description</span></span>|  
|-------------|-----------------|  
|`\\\\`|<span data-ttu-id="a2b9d-1501">比對兩個連續反斜線 (`\`) 字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1501">Match two consecutive backslash (`\`) characters.</span></span> <span data-ttu-id="a2b9d-1502">反斜線字元解譯為逸出字元，因此每個反斜線必須逸出與另一個反斜線。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1502">Because the backslash character is interpreted as the escape character, each backslash must be escaped with another backslash.</span></span>|  
|`+ Environment.MachineName +`|<span data-ttu-id="a2b9d-1503">所傳回的字串相符<xref:System.Environment.MachineName%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1503">Match the string that is returned by the <xref:System.Environment.MachineName%2A?displayProperty=nameWithType> property.</span></span>|  
|`(?:\.\w+)*`|<span data-ttu-id="a2b9d-1504">比對句號 (`.`) 字元後面接著一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1504">Match the period (`.`) character followed by one or more word characters.</span></span> <span data-ttu-id="a2b9d-1505">此比對可以發生零次以上。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1505">This match can occur zero or more times.</span></span> <span data-ttu-id="a2b9d-1506">不會擷取相符子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1506">The matched subexpression is not captured.</span></span>|  
|`\\`|<span data-ttu-id="a2b9d-1507">符合反斜線 (`\`) 字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1507">Match a backslash (`\`) character.</span></span>|  
|`([" + driveNames + "])`|<span data-ttu-id="a2b9d-1508">比對的字元類別包含的個別磁碟機代號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1508">Match the character class that consists of the individual drive letters.</span></span> <span data-ttu-id="a2b9d-1509">此項比對是第一個擷取子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1509">This match is the first captured subexpression.</span></span>|  
|`\$`|<span data-ttu-id="a2b9d-1510">比對常值的貨幣符號 (`$`) 字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1510">Match the literal dollar sign (`$`) character.</span></span>|  
  
 <span data-ttu-id="a2b9d-1511">取代模式`$1`整個相符項目取代為第一個擷取子運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1511">The replacement pattern `$1` replaces the entire match with the first captured subexpression.</span></span> <span data-ttu-id="a2b9d-1512">也就是說，它會取代 UNC 電腦和磁碟機名稱的磁碟機代號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1512">That is, it replaces the UNC machine and drive name with the drive letter.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1513">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1513">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1514"><paramref name="input" /><paramref name="pattern" /> 或 <paramref name="replacement" /> 是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1514"><paramref name="input" />, <paramref name="pattern" />, or <paramref name="replacement" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1515"><paramref name="options" /> 不是 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值的有效位元組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1515"><paramref name="options" /> is not a valid bitwise combination of <see cref="T:System.Text.RegularExpressions.RegexOptions" /> values.</span></span>  
  
 <span data-ttu-id="a2b9d-1516">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1516">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-1517"><paramref name="matchTimeout" /> 為負數、零或大約大於 24 天。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1517"><paramref name="matchTimeout" /> is negative, zero, or greater than approximately 24 days.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1518">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1518">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1519">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1519">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1520">我們建議您將<paramref name="matchTimeout" />參數，以適當的值，例如兩秒。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1520">We recommend that you set the <paramref name="matchTimeout" /> parameter to an appropriate value, such as two seconds.</span></span> <span data-ttu-id="a2b9d-1521">如果您停用逾時指定<see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，規則運算式引擎會提供稍微較佳的效能。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1521">If you disable time-outs by specifying <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, the regular expression engine offers slightly better performance.</span></span> <span data-ttu-id="a2b9d-1522">不過，您應該停用逾時，只有在下列情況下：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1522">However, you should disable time-outs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="a2b9d-1523">當規則運算式所處理的輸入衍生自已知且受信任的來源，或包含靜態文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1523">When the input processed by a regular expression is derived from a known and trusted source or consists of static text.</span></span> <span data-ttu-id="a2b9d-1524">這不包括已動態使用者所輸入的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1524">This excludes text that has been dynamically input by users.</span></span>  
  
-   <span data-ttu-id="a2b9d-1525">當規則運算式模式已徹底測試以確保它有效率地處理符合，不符合，不久符合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1525">When the regular expression pattern has been thoroughly tested to ensure that it efficiently handles matches, non-matches, and near matches.</span></span>  
  
-   <span data-ttu-id="a2b9d-1526">當規則運算式模式包含已知會造成大量回溯處理接近的相符項目時沒有語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1526">When the regular expression pattern contains no language elements that are known to cause excessive backtracking when processing a near match.</span></span></para>
        </block>
        <altmember cref="T:System.Text.RegularExpressions.RegexOptions" />
      </Docs>
    </Member>
    <Member MemberName="Replace">
      <MemberSignature Language="C#" Value="public static string Replace (string input, string pattern, System.Text.RegularExpressions.MatchEvaluator evaluator, System.Text.RegularExpressions.RegexOptions options, TimeSpan matchTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string Replace(string input, string pattern, class System.Text.RegularExpressions.MatchEvaluator evaluator, valuetype System.Text.RegularExpressions.RegexOptions options, valuetype System.TimeSpan matchTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Replace(System.String,System.String,System.Text.RegularExpressions.MatchEvaluator,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Replace (input As String, pattern As String, evaluator As MatchEvaluator, options As RegexOptions, matchTimeout As TimeSpan) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Replace(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::MatchEvaluator ^ evaluator, System::Text::RegularExpressions::RegexOptions options, TimeSpan matchTimeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="evaluator" Type="System.Text.RegularExpressions.MatchEvaluator" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
        <Parameter Name="matchTimeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1527">用來搜尋比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1527">The string to search for a match.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1528">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1528">The regular expression pattern to match.</span></span></param>
        <param name="evaluator"><span data-ttu-id="a2b9d-1529">檢查每個符合項目並傳回原始符合字串或取代字串的自訂方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1529">A custom method that examines each match and returns either the original matched string or a replacement string.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-1530">列舉值的位元組合，提供用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1530">A bitwise combination of enumeration values that provide options for matching.</span></span></param>
        <param name="matchTimeout"><span data-ttu-id="a2b9d-1531">間隔，若要表示此方法不會逾時則為 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1531">A time-out interval, or <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" /> to indicate that the method should not time out.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1532">在指定的輸入字串中，使用 <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> 委派所傳回的字串來取代所有符合指定之規則運算式的子字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1532">In a specified input string, replaces all substrings that match a specified regular expression with a string returned by a <see cref="T:System.Text.RegularExpressions.MatchEvaluator" /> delegate.</span></span> <span data-ttu-id="a2b9d-1533">如果沒有找到相符項目，其他參數會指定修改比對作業的選項和逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1533">Additional parameters specify options that modify the matching operation and a time-out interval if no match is found.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1534">與輸入字串相同的新字串 (不同之處是取代字串會取代每一個相符的字串)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1534">A new string that is identical to the input string, except that the replacement string takes the place of each matched string.</span></span> <span data-ttu-id="a2b9d-1535">如果在目前的執行個體中沒有符合 <paramref name="pattern" /> 的項目，則方法傳回未變更的目前執行個體。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1535">If <paramref name="pattern" /> is not matched in the current instance, the method returns the current instance unchanged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1536"><xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType>方法適合用來取代規則運算式相符項目，如果下列任何一個狀況成立：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1536">The <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType> method is useful for replacing a regular expression match if any of the following conditions is true:</span></span>  
  
-   <span data-ttu-id="a2b9d-1537">規則運算式取代模式中無法輕易地加以指定取代字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1537">If the replacement string cannot readily be specified by a regular expression replacement pattern.</span></span>  
  
-   <span data-ttu-id="a2b9d-1538">如果是取代字串得到的某些處理執行比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1538">If the replacement string results from some processing performed on the matched string.</span></span>  
  
-   <span data-ttu-id="a2b9d-1539">如果是取代字串而產生的條件式處理。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1539">If the replacement string results from conditional processing.</span></span>  
  
 <span data-ttu-id="a2b9d-1540">此方法相當於呼叫<xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType>方法並傳遞每個<xref:System.Text.RegularExpressions.Match>在傳回的物件<xref:System.Text.RegularExpressions.MatchCollection>集合`evaluator`委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1540">The method is equivalent to calling the <xref:System.Text.RegularExpressions.Regex.Matches%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.RegexOptions%29?displayProperty=nameWithType> method and passing each <xref:System.Text.RegularExpressions.Match> object in the returned <xref:System.Text.RegularExpressions.MatchCollection> collection to the `evaluator` delegate.</span></span>  
  
 <span data-ttu-id="a2b9d-1541">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1541">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1542">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1542">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 <span data-ttu-id="a2b9d-1543">`evaluator`參數是您定義的自訂方法的委派，會檢查每個符合項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1543">The `evaluator` parameter is the delegate for a custom method that you define and that examines each match.</span></span> <span data-ttu-id="a2b9d-1544">自訂的方法必須具有下列簽章，以符合<xref:System.Text.RegularExpressions.MatchEvaluator>委派。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1544">The custom method must have the following signature to match the <xref:System.Text.RegularExpressions.MatchEvaluator> delegate.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/syntax1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/syntax1.vb#1)]  
  
 <span data-ttu-id="a2b9d-1545">您的自訂方法會傳回字串，以取代相符的輸入。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1545">Your custom method returns a string that replaces the matched input.</span></span>  
  
 <span data-ttu-id="a2b9d-1546">如果為 <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft> 參數指定 `options`，搜尋符合項目會從輸入字串結尾開始向左移動，否則，搜尋會從輸入字串開頭開始向右移動。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1546">If you specify <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft> for the `options` parameter, the search for matches begins at the end of the input string and moves left; otherwise, the search begins at the start of the input string and moves right.</span></span>  
  
 <span data-ttu-id="a2b9d-1547">`matchTimeout`參數會指定如何長模式比對方法應嘗試尋找相符項目，即會逾時。設定逾時間隔可避免依賴大量回溯，從顯示的規則運算式 」 停止回應時，它們會處理輸入，其中包含相符項目附近。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1547">The `matchTimeout` parameter specifies how long a pattern matching method should try to find a match before it times out. Setting a time-out interval prevents regular expressions that rely on excessive backtracking from appearing to "stop responding when they process input that contains near matches.</span></span> <span data-ttu-id="a2b9d-1548">如需詳細資訊，請參閱[規則運算式的最佳作法](~/docs/standard/base-types/best-practices.md)和[回溯](~/docs/standard/base-types/backtracking-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1548">For more information, see [Best Practices for Regular Expressions](~/docs/standard/base-types/best-practices.md) and [Backtracking](~/docs/standard/base-types/backtracking-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-1549">如果該時間間隔中找到相符項目，方法會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1549">If no match is found in that time interval, the method throws a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-1550">`matchTimeout` 覆寫任何方法執行於其中的應用程式定義域定義的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1550">`matchTimeout` overrides any default time-out value defined for the application domain in which the method executes.</span></span>  
  
 <span data-ttu-id="a2b9d-1551">因為此方法會傳回`input`保持不變，如果沒有相符項目，您可以使用<xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType>來決定方法是否有任何取代項目與輸入字串的方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1551">Because the method returns `input` unchanged if there is no match, you can use the <xref:System.Object.ReferenceEquals%2A?displayProperty=nameWithType> method to determine whether the method has made any replacements to the input string.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a2b9d-1552">下列範例會使用規則運算式從字串擷取個別文字，然後再使用<xref:System.Text.RegularExpressions.MatchEvaluator>委派以呼叫方法，名為`WordScramble`，將金鑰加密在 word 中個別的字母。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1552">The following example uses a regular expression to extract the individual words from a string, and then uses a <xref:System.Text.RegularExpressions.MatchEvaluator> delegate to call a method named `WordScramble` that scrambles the individual letters in the word.</span></span> <span data-ttu-id="a2b9d-1553">若要這樣做，`WordScramble`方法會建立陣列，其中包含在比對的字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1553">To do this, the `WordScramble` method creates an array that contains the characters in the match.</span></span> <span data-ttu-id="a2b9d-1554">它也會建立使用隨機浮點數值的它所擴展的平行陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1554">It also creates a parallel array that it populates with random floating-point numbers.</span></span> <span data-ttu-id="a2b9d-1555">陣列會依照呼叫<xref:System.Array.Sort%60%602%28%60%600%5B%5D%2C%60%601%5B%5D%2CSystem.Collections.Generic.IComparer%7B%60%600%7D%29?displayProperty=nameWithType>方法和已排序的陣列提供做為引數<xref:System.String>類別建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1555">The arrays are sorted by calling the <xref:System.Array.Sort%60%602%28%60%600%5B%5D%2C%60%601%5B%5D%2CSystem.Collections.Generic.IComparer%7B%60%600%7D%29?displayProperty=nameWithType> method, and the sorted array is provided as an argument to a <xref:System.String> class constructor.</span></span> <span data-ttu-id="a2b9d-1556">然後傳回此新建立的字串`WordScramble`方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1556">This newly created string is then returned by the `WordScramble` method.</span></span> <span data-ttu-id="a2b9d-1557">規則運算式模式`\w+`比對一個或多個文字字元，規則運算式引擎會繼續將字元加入至比對，直到遇到非文字字元，例如空格字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1557">The regular expression pattern `\w+` matches one or more word characters; the regular expression engine will continue to add characters to the match until it encounters a non-word character, such as a white-space character.</span></span> <span data-ttu-id="a2b9d-1558">呼叫<xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Text.RegularExpressions.RegexOptions%29>方法包含<xref:System.Text.RegularExpressions.RegexOptions.IgnorePatternWhitespace?displayProperty=nameWithType>選項，讓規則運算式模式中的註解`\w+  # Matches all the characters in a word.`會忽略規則運算式引擎。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1558">The call to the <xref:System.Text.RegularExpressions.Regex.Replace%28System.String%2CSystem.String%2CSystem.Text.RegularExpressions.MatchEvaluator%2CSystem.Text.RegularExpressions.RegexOptions%29> method includes the <xref:System.Text.RegularExpressions.RegexOptions.IgnorePatternWhitespace?displayProperty=nameWithType> option so that the comment in the regular expression pattern `\w+  # Matches all the characters in a word.` is ignored by the regular expression engine.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Replace#13](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/cs/replace13.cs#13)]
 [!code-vb[System.Text.RegularExpressions.Regex.Replace#13](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.text.regularexpressions.regex.replace/vb/replace13.vb#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1559">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1559">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1560"><paramref name="input" /><paramref name="pattern" /> 或 <paramref name="evaluator" /> 是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1560"><paramref name="input" />, <paramref name="pattern" />, or <paramref name="evaluator" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1561"><paramref name="options" /> 不是 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值的有效位元組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1561"><paramref name="options" /> is not a valid bitwise combination of <see cref="T:System.Text.RegularExpressions.RegexOptions" /> values.</span></span>  
  
 <span data-ttu-id="a2b9d-1562">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1562">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-1563"><paramref name="matchTimeout" /> 為負數、零或大約大於 24 天。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1563"><paramref name="matchTimeout" /> is negative, zero, or greater than approximately 24 days.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1564">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1564">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1565">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1565">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1566">我們建議您將<paramref name="matchTimeout" />參數，以適當的值，例如兩秒。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1566">We recommend that you set the <paramref name="matchTimeout" /> parameter to an appropriate value, such as two seconds.</span></span> <span data-ttu-id="a2b9d-1567">如果您停用逾時指定<see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，規則運算式引擎會提供稍微較佳的效能。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1567">If you disable time-outs by specifying <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, the regular expression engine offers slightly better performance.</span></span> <span data-ttu-id="a2b9d-1568">不過，您應該停用逾時，只有在下列情況下：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1568">However, you should disable time-outs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="a2b9d-1569">當規則運算式所處理的輸入衍生自已知且受信任的來源，或包含靜態文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1569">When the input processed by a regular expression is derived from a known and trusted source or consists of static text.</span></span> <span data-ttu-id="a2b9d-1570">這不包括已動態使用者所輸入的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1570">This excludes text that has been dynamically input by users.</span></span>  
  
-   <span data-ttu-id="a2b9d-1571">當規則運算式模式已徹底測試以確保它有效率地處理符合，不符合，不久符合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1571">When the regular expression pattern has been thoroughly tested to ensure that it efficiently handles matches, non-matches, and near matches.</span></span>  
  
-   <span data-ttu-id="a2b9d-1572">當規則運算式模式包含已知會造成大量回溯處理接近的相符項目時沒有語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1572">When the regular expression pattern contains no language elements that are known to cause excessive backtracking when processing a near match.</span></span></para>
        </block>
        <altmember cref="T:System.Text.RegularExpressions.RegexOptions" />
      </Docs>
    </Member>
    <Member MemberName="RightToLeft">
      <MemberSignature Language="C#" Value="public bool RightToLeft { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RightToLeft" />
      <MemberSignature Language="DocId" Value="P:System.Text.RegularExpressions.Regex.RightToLeft" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property RightToLeft As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool RightToLeft { bool get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-1573">取得值，指出規則運算式是否由右至左搜尋。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1573">Gets a value that indicates whether the regular expression searches from right to left.</span></span></summary>
        <value>
          <span data-ttu-id="a2b9d-1574">如果規則運算式由右至左搜尋，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1574"><see langword="true" /> if the regular expression searches from right to left; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1575"><xref:System.Text.RegularExpressions.Regex.RightToLeft%2A> 是`true`如果<xref:System.Text.RegularExpressions.Regex>建立執行個體與<xref:System.Text.RegularExpressions.RegexOptions.RightToLeft>選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1575"><xref:System.Text.RegularExpressions.Regex.RightToLeft%2A> is `true` if the <xref:System.Text.RegularExpressions.Regex> instance was created with the <xref:System.Text.RegularExpressions.RegexOptions.RightToLeft> option.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="roptions">
      <MemberSignature Language="C#" Value="protected internal System.Text.RegularExpressions.RegexOptions roptions;" />
      <MemberSignature Language="ILAsm" Value=".field familyorassembly valuetype System.Text.RegularExpressions.RegexOptions roptions" />
      <MemberSignature Language="DocId" Value="F:System.Text.RegularExpressions.Regex.roptions" />
      <MemberSignature Language="VB.NET" Value="Protected Friend roptions As RegexOptions " />
      <MemberSignature Language="C++ CLI" Value="protected public: System::Text::RegularExpressions::RegexOptions roptions;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Text.RegularExpressions.RegexOptions</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a2b9d-1576">由 <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> 方法所產生的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1576">Used by a <see cref="T:System.Text.RegularExpressions.Regex" /> object generated by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="Split">
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="a2b9d-1577">在規則運算式比對所定義的位置，將輸入字串分割成子字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1577">Splits an input string into an array of substrings at the positions defined by a regular expression match.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Split">
      <MemberSignature Language="C#" Value="public string[] Split (string input);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string[] Split(string input) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Split(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function Split (input As String) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::String ^&gt; ^ Split(System::String ^ input);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1578">要分隔的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1578">The string to split.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1579">在 <see cref="T:System.Text.RegularExpressions.Regex" /> 建構函式中指定之規則運算式模式所定義的位置，將輸入字串分隔成子字串的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1579">Splits an input string into an array of substrings at the positions defined by a regular expression pattern specified in the <see cref="T:System.Text.RegularExpressions.Regex" /> constructor.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1580">字串的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1580">An array of strings.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1581"><xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>方法都是類似於<xref:System.String.Split%28System.Char%5B%5D%29?displayProperty=nameWithType>方法，不同處在於<xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>分割在規則運算式，而不是一組字元所決定的分隔符號字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1581">The <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> methods are similar to the <xref:System.String.Split%28System.Char%5B%5D%29?displayProperty=nameWithType> method, except that <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> splits the string at a delimiter determined by a regular expression instead of a set of characters.</span></span> <span data-ttu-id="a2b9d-1582">將字串分割為許多次。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1582">The string is split as many times as possible.</span></span> <span data-ttu-id="a2b9d-1583">如果不找到任何分隔符號，則傳回的值會包含一個項目，其值為原始的輸入的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1583">If no delimiter is found, the return value contains one element whose value is the original input string.</span></span>  
  
 <span data-ttu-id="a2b9d-1584">如果多個相符項目彼此相鄰的、 空字串會插入至陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1584">If multiple matches are adjacent to one another, an empty string is inserted into the array.</span></span> <span data-ttu-id="a2b9d-1585">例如，分割上的單一連字號的字串會造成傳回的陣列，其中兩個相鄰的連字號找不到，下列程式碼所示的位置包含空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1585">For example, splitting a string on a single hyphen causes the returned array to include an empty string in the position where two adjacent hyphens are found, as the following code shows.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split1.cs#1)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split1.vb#1)]  
  
 <span data-ttu-id="a2b9d-1586">如果找到符合的開頭或輸入字串的結尾，空字串就會包含開頭或結尾傳回的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1586">If a match is found at the beginning or the end of the input string, an empty string is included at the beginning or the end of the returned array.</span></span> <span data-ttu-id="a2b9d-1587">下列範例會使用規則運算式模式`\d+`分割輸入的字串的數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1587">The following example uses the regular expression pattern `\d+` to split an input string on numeric characters.</span></span> <span data-ttu-id="a2b9d-1588">因為字串開始和結尾相符的字元數值，傳回的陣列的第一個和最後一個項目的值是<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1588">Because the string begins and ends with matching numeric characters, the value of the first and last element of the returned array is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#21](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split21.cs#21)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#21](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split21.vb#21)]  
  
 <span data-ttu-id="a2b9d-1589">如果擷取括號中使用<xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>運算式中，任何擷取的文字是否包含在產生的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1589">If capturing parentheses are used in a <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> expression, any captured text is included in the resulting string array.</span></span> <span data-ttu-id="a2b9d-1590">比方說，如果您分割字串"梅紅-西洋梨 」 上連字號放在擷取括號時，傳回的陣列會包含字串項目，其中包含連字號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1590">For example, if you split the string "plum-pear" on a hyphen placed within capturing parentheses, the returned array includes a string element that contains the hyphen.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split2.cs#2)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split2.vb#2)]  
  
 <span data-ttu-id="a2b9d-1591">不過，當規則運算式模式包含多組擷取括號時，此方法的行為取決於.NET Framework 版本。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1591">However, when the regular expression pattern includes multiple sets of capturing parentheses, the behavior of this method depends on the version of the .NET Framework.</span></span> <span data-ttu-id="a2b9d-1592">在.NET Framework 1.0 和 1.1 中，如果第一組擷取括號內找不到相符項目包含擷取的文字其他擷取括號不是傳回陣列中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1592">In the .NET Framework 1.0 and 1.1, if a match is not found within the first set of capturing parentheses, captured text from additional capturing parentheses is not included in the returned array.</span></span> <span data-ttu-id="a2b9d-1593">從.NET Framework 2.0 開始，所有擷取的文字也會加入至傳回的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1593">Starting with the .NET Framework 2.0, all captured text is also added to the returned array.</span></span> <span data-ttu-id="a2b9d-1594">例如，下列程式碼會使用兩組擷取括號來擷取日期，包括日期分隔符號，從日期字串的項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1594">For example, the following code uses two sets of capturing parentheses to extract the elements of a date, including the date delimiters, from a date string.</span></span> <span data-ttu-id="a2b9d-1595">第一個集合擷取括號會擷取連字號，和第二個集合擷取正斜線。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1595">The first set of capturing parentheses captures the hyphen, and the second set captures the forward slash.</span></span> <span data-ttu-id="a2b9d-1596">如果編譯範例程式碼，並在.NET Framework 1.0 或 1.1 之下執行，它會排除斜線字元。如果它是編譯，而且.NET Framework 2.0 或更新版本底下執行，它會包含它們。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1596">If the example code is compiled and run under the .NET Framework 1.0 or 1.1, it excludes the slash characters; if it is compiled and run under the .NET Framework 2.0 or later versions, it includes them.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split3.cs#3)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split3.vb#3)]  
  
 <span data-ttu-id="a2b9d-1597">如果規則運算式可以比對空字串，<xref:System.Text.RegularExpressions.Regex.Split%28System.String%29>會將字串分割成單一字元字串陣列，因為在每個位置找不到空字串分隔符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1597">If the regular expression can match the empty string, <xref:System.Text.RegularExpressions.Regex.Split%28System.String%29> will split the string into an array of single-character strings because the empty string delimiter can be found at every location.</span></span> <span data-ttu-id="a2b9d-1598">例如: </span><span class="sxs-lookup"><span data-stu-id="a2b9d-1598">For example:</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#11](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split11.cs#11)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#11](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split11.vb#11)]  
  
 <span data-ttu-id="a2b9d-1599">請注意，傳回的陣列也會包含空字串開頭和結尾的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1599">Note that the returned array also includes an empty string at the beginning and end of the array.</span></span>  
  
 <span data-ttu-id="a2b9d-1600"><xref:System.Text.RegularExpressions.RegexMatchTimeoutException>如果 split 作業的執行時間超過指定的逾時間隔，會擲回例外狀況<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType>建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1600">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the split operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-1601">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1601">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-1602">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1602">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1603"><paramref name="input" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1603"><paramref name="input" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1604">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1604">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1605">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1605">For more information about time-outs, see the Remarks section.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Split">
      <MemberSignature Language="C#" Value="public string[] Split (string input, int count);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string[] Split(string input, int32 count) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Split(System.String,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Split (input As String, count As Integer) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::String ^&gt; ^ Split(System::String ^ input, int count);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="count" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1606">要分隔的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1606">The string to be split.</span></span></param>
        <param name="count"><span data-ttu-id="a2b9d-1607">分隔作業可以發生的最多次數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1607">The maximum number of times the split can occur.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1608">在 <see cref="T:System.Text.RegularExpressions.Regex" /> 建構函式中指定的規則運算式所定義的位置，以指定的最大次數來將輸入字串分隔成子字串的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1608">Splits an input string a specified maximum number of times into an array of substrings, at the positions defined by a regular expression specified in the <see cref="T:System.Text.RegularExpressions.Regex" /> constructor.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1609">字串的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1609">An array of strings.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1610"><xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>方法都是類似於<xref:System.String.Split%2A?displayProperty=nameWithType>方法，不同處在於<xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>分割在規則運算式，而不是一組字元所決定的分隔符號字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1610">The <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> methods are similar to the <xref:System.String.Split%2A?displayProperty=nameWithType> method, except that <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> splits the string at a delimiter determined by a regular expression instead of a set of characters.</span></span> <span data-ttu-id="a2b9d-1611">`count`參數會指定到其中的子字串的最大數目`input`可以分割成字串; 最後一個字串包含 unsplit 的字串的其餘部分。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1611">The `count` parameter specifies the maximum number of substrings into which the `input` string can be split; the last string contains the unsplit remainder of the string.</span></span> <span data-ttu-id="a2b9d-1612">A`count`為零的值會提供分割成許多次越好的預設行為。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1612">A `count` value of zero provides the default behavior of splitting as many times as possible.</span></span>  
  
 <span data-ttu-id="a2b9d-1613">如果多個相符項目彼此相鄰或開頭或結尾找到相符`input`，而且找到符合項目數目至少兩個小於`count`，空字串插入到陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1613">If multiple matches are adjacent to one another or if a match is found at the beginning or end of `input`, and the number of matches found is at least two less than `count`, an empty string is inserted into the array.</span></span> <span data-ttu-id="a2b9d-1614">也就是說，從相鄰的相符項目或開頭或結尾的輸入字串的相符項目會造成的空字串會算入判斷是否數目比對的子字串等於`count`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1614">That is, empty strings that result from adjacent matches or from matches at the beginning or end of the input string are counted in determining whether the number of matched substrings equals `count`.</span></span> <span data-ttu-id="a2b9d-1615">在下列範例中，規則運算式`/d+`用來分割輸入的字串成最多三個子字串包含一個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1615">In the following example, the regular expression `/d+` is used to split an input string that includes one or more decimal digits into a maximum of three substrings.</span></span> <span data-ttu-id="a2b9d-1616">輸入字串的開頭比對規則運算式模式，因為第一個陣列元素包含<xref:System.String.Empty?displayProperty=nameWithType>、 第二個包含字母字元，輸入字串中第一個集合，而第三個包含字串的其餘部分一節的第三個相符項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1616">Because the beginning of the input string matches the regular expression pattern, the first array element contains <xref:System.String.Empty?displayProperty=nameWithType>, the second contains the first set of alphabetic characters in the input string, and the third contains the remainder of the string that follows the third match.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#25](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split25.cs#25)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#25](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split25.vb#25)]  
  
 <span data-ttu-id="a2b9d-1617">如果規則運算式中使用擷取括號，就會分隔字串的陣列中包含任何擷取的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1617">If capturing parentheses are used in a regular expression, any captured text is included in the array of split strings.</span></span> <span data-ttu-id="a2b9d-1618">不過，任何陣列元素包含擷取的文字不會包含在判斷是否相符項目數目已達到`count`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1618">However, any array elements that contain captured text are not counted in determining whether the number of matches has reached `count`.</span></span> <span data-ttu-id="a2b9d-1619">例如，顯示分割成最多四個的子字串結果七個元素陣列，如以下程式碼中的"apple-apricot-梅紅-西洋梨-香蕉"字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1619">For example, splitting the string "apple-apricot-plum-pear-banana" into a maximum of four substrings results in a seven-element array, as the following code shows.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#4](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split4.cs#4)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#4](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split4.vb#4)]  
  
 <span data-ttu-id="a2b9d-1620">不過，當規則運算式模式包含多組擷取括號時，此方法的行為取決於.NET Framework 版本。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1620">However, when the regular expression pattern includes multiple sets of capturing parentheses, the behavior of this method depends on the version of the .NET Framework.</span></span> <span data-ttu-id="a2b9d-1621">在.NET Framework 1.0 和 1.1 版中，只擷取的文字第一個集合擷取括號會包含傳回陣列中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1621">In the .NET Framework 1.0 and 1.1, only captured text from the first set of capturing parentheses is included in the returned array.</span></span> <span data-ttu-id="a2b9d-1622">從.NET Framework 2.0 開始，所有擷取的文字加入至傳回的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1622">Starting with the .NET Framework 2.0, all captured text is added to the returned array.</span></span> <span data-ttu-id="a2b9d-1623">不過，在傳回陣列中包含擷取的文字的項目不會計算在決定是否數目比對的子字串等於`count`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1623">However, elements in the returned array that contain captured text are not counted in determining whether the number of matched substrings equals `count`.</span></span> <span data-ttu-id="a2b9d-1624">例如，下列程式碼，規則運算式會使用日期的項目擷取的日期字串兩組擷取括號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1624">For example, in the following code, a regular expression uses two sets of capturing parentheses to extract the elements of a date from a date string.</span></span> <span data-ttu-id="a2b9d-1625">第一個集合擷取括號會擷取連字號，和第二個集合擷取正斜線。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1625">The first set of capturing parentheses captures the hyphen, and the second set captures the forward slash.</span></span> <span data-ttu-id="a2b9d-1626">若要呼叫<xref:System.Text.RegularExpressions.Regex.Split%28System.String%2CSystem.Int32%29>方法然後傳回陣列中指定最多兩個項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1626">The call to the <xref:System.Text.RegularExpressions.Regex.Split%28System.String%2CSystem.Int32%29> method then specifies a maximum of two elements in the returned array.</span></span> <span data-ttu-id="a2b9d-1627">如果編譯範例程式碼，並在.NET Framework 1.0 或 1.1 之下執行，則方法會傳回兩個元素的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1627">If the example code is compiled and run under the .NET Framework 1.0 or 1.1, the method returns a two-element string array.</span></span> <span data-ttu-id="a2b9d-1628">如果它是編譯，而且.NET Framework 2.0 或更新版本底下執行，方法會傳回三個元素的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1628">If it is compiled and run under the .NET Framework 2.0 or later versions, the method returns a three-element string array.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#5](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split5.cs#5)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#5](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split5.vb#5)]  
  
 <span data-ttu-id="a2b9d-1629">如果規則運算式可以比對空字串，<xref:System.Text.RegularExpressions.Regex.Split%28System.String%2CSystem.Int32%29>會將字串分割成單一字元字串陣列，因為在每個位置找不到空字串分隔符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1629">If the regular expression can match the empty string, <xref:System.Text.RegularExpressions.Regex.Split%28System.String%2CSystem.Int32%29> will split the string into an array of single-character strings because the empty string delimiter can be found at every location.</span></span> <span data-ttu-id="a2b9d-1630">下列範例分割成字串 「 字元 」，因為輸入字串中有許多項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1630">The following example splits the string "characters" into as many elements as there are in the input string.</span></span> <span data-ttu-id="a2b9d-1631">由於 null 字串比對輸入字串的開頭，則傳回的陣列的開頭插入的 null 字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1631">Because the null string matches the beginning of the input string, a null string is inserted at the beginning of the returned array.</span></span> <span data-ttu-id="a2b9d-1632">這會造成要在輸入字串結尾處的兩個字元所組成的第十個項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1632">This causes the tenth element to consist of the two characters at the end of the input string.</span></span>  
  
 [!code-vb[System.Text.RegularExpressions.Regex.Split#12](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split12.vb#12)]  
  
 <span data-ttu-id="a2b9d-1633"><xref:System.Text.RegularExpressions.RegexMatchTimeoutException>如果 split 作業的執行時間超過指定的逾時間隔，會擲回例外狀況<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType>建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1633">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the split operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-1634">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1634">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-1635">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1635">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1636"><paramref name="input" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1636"><paramref name="input" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1637">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1637">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1638">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1638">For more information about time-outs, see the Remarks section.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Split">
      <MemberSignature Language="C#" Value="public static string[] Split (string input, string pattern);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string[] Split(string input, string pattern) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Split(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Split (input As String, pattern As String) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::String ^&gt; ^ Split(System::String ^ input, System::String ^ pattern);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1639">要分隔的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1639">The string to split.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1640">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1640">The regular expression pattern to match.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1641">在規則運算式模式所定義的位置，將輸入字串分割成子字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1641">Splits an input string into an array of substrings at the positions defined by a regular expression pattern.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1642">字串的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1642">An array of strings.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1643"><xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>方法都是類似於<xref:System.String.Split%2A?displayProperty=nameWithType>方法，不同處在於<xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>分割在規則運算式，而不是一組字元所決定的分隔符號字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1643">The <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> methods are similar to the <xref:System.String.Split%2A?displayProperty=nameWithType> method, except that <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> splits the string at a delimiter determined by a regular expression instead of a set of characters.</span></span> <span data-ttu-id="a2b9d-1644">`input`字串分割成許多次越好。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1644">The `input` string is split as many times as possible.</span></span> <span data-ttu-id="a2b9d-1645">如果`pattern`中找不到`input`字串，傳回的值包含一個項目，其值是原始`input`字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1645">If `pattern` is not found in the `input` string, the return value contains one element whose value is the original `input` string.</span></span>  
  
 <span data-ttu-id="a2b9d-1646">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1646">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1647">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1647">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="a2b9d-1648">編譯為靜態的呼叫中使用的規則運算式<xref:System.Text.RegularExpressions.Regex.Split%2A>方法會自動快取。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1648">Compiled regular expressions used in calls to static <xref:System.Text.RegularExpressions.Regex.Split%2A> methods are automatically cached.</span></span> <span data-ttu-id="a2b9d-1649">若要自行管理編譯的規則運算式的存留期，使用 執行個體<xref:System.Text.RegularExpressions.Regex.Split%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1649">To manage the lifetime of compiled regular expressions yourself, use the instance <xref:System.Text.RegularExpressions.Regex.Split%2A> methods.</span></span>  
  
 <span data-ttu-id="a2b9d-1650">如果多個相符項目彼此相鄰的、 空字串會插入至陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1650">If multiple matches are adjacent to one another, an empty string is inserted into the array.</span></span> <span data-ttu-id="a2b9d-1651">例如，分割上的單一連字號的字串會造成傳回的陣列，其中兩個相鄰的連字號找不到，下列程式碼所示的位置包含空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1651">For example, splitting a string on a single hyphen causes the returned array to include an empty string in the position where two adjacent hyphens are found, as the following code shows.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#8](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split8.cs#8)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#8](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split8.vb#8)]  
  
 <span data-ttu-id="a2b9d-1652">如果找到符合的開頭或輸入字串的結尾，空字串就會包含開頭或結尾傳回的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1652">If a match is found at the beginning or the end of the input string, an empty string is included at the beginning or the end of the returned array.</span></span> <span data-ttu-id="a2b9d-1653">下列範例會使用規則運算式模式`\d+`分割輸入的字串的數字字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1653">The following example uses the regular expression pattern `\d+` to split an input string on numeric characters.</span></span> <span data-ttu-id="a2b9d-1654">因為字串開始和結尾相符的字元數值，傳回的陣列的第一個和最後一個項目的值是<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1654">Because the string begins and ends with matching numeric characters, the value of the first and last element of the returned array is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#22](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split22.cs#22)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#22](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split22.vb#22)]  
  
 <span data-ttu-id="a2b9d-1655">如果擷取括號中使用<xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>運算式中，任何擷取的文字是否包含在產生的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1655">If capturing parentheses are used in a <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> expression, any captured text is included in the resulting string array.</span></span> <span data-ttu-id="a2b9d-1656">比方說，如果您分割字串"梅紅-西洋梨 」 上連字號放在擷取括號時，傳回的陣列會包含字串項目，其中包含連字號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1656">For example, if you split the string "plum-pear" on a hyphen placed within capturing parentheses, the returned array includes a string element that contains the hyphen.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#9](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split9.cs#9)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#9](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split9.vb#9)]  
  
 <span data-ttu-id="a2b9d-1657">不過，當規則運算式模式包含多組擷取括號時，此方法的行為取決於.NET Framework 版本。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1657">However, when the regular expression pattern includes multiple sets of capturing parentheses, the behavior of this method depends on the version of the .NET Framework.</span></span> <span data-ttu-id="a2b9d-1658">在.NET Framework 1.0 和 1.1 中，如果第一組擷取括號內找不到相符項目包含擷取的文字其他擷取括號不是傳回陣列中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1658">In the .NET Framework 1.0 and 1.1, if a match is not found within the first set of capturing parentheses, captured text from additional capturing parentheses is not included in the returned array.</span></span> <span data-ttu-id="a2b9d-1659">從.NET Framework 2.0 開始，所有擷取的文字也會加入至傳回的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1659">Starting with the .NET Framework 2.0, all captured text is also added to the returned array.</span></span> <span data-ttu-id="a2b9d-1660">例如，下列程式碼會使用兩組擷取括號來擷取日期，包括日期分隔符號，從日期字串的項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1660">For example, the following code uses two sets of capturing parentheses to extract the elements of a date, including the date delimiters, from a date string.</span></span> <span data-ttu-id="a2b9d-1661">第一個集合擷取括號會擷取連字號，和第二個集合擷取正斜線。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1661">The first set of capturing parentheses captures the hyphen, and the second set captures the forward slash.</span></span> <span data-ttu-id="a2b9d-1662">如果編譯範例程式碼，並在.NET Framework 1.0 或 1.1 之下執行，它會排除斜線字元。如果它是編譯，而且.NET Framework 2.0 或更新版本底下執行，它會包含它們。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1662">If the example code is compiled and run under the .NET Framework 1.0 or 1.1, it excludes the slash characters; if it is compiled and run under the .NET Framework 2.0 or later versions, it includes them.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#10](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split10.cs#10)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#10](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split10.vb#10)]  
  
 <span data-ttu-id="a2b9d-1663">如果規則運算式可以比對空字串，<xref:System.Text.RegularExpressions.Regex.Split%2A>會將字串分割成單一字元字串陣列，因為在每個位置找不到空字串分隔符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1663">If the regular expression can match the empty string, <xref:System.Text.RegularExpressions.Regex.Split%2A> will split the string into an array of single-character strings because the empty string delimiter can be found at every location.</span></span> <span data-ttu-id="a2b9d-1664">例如: </span><span class="sxs-lookup"><span data-stu-id="a2b9d-1664">For example:</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#13](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split13.cs#13)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#13](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split13.vb#13)]  
  
 <span data-ttu-id="a2b9d-1665">請注意，傳回的陣列也會包含空字串開頭和結尾的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1665">Note that the returned array also includes an empty string at the beginning and end of the array.</span></span>  
  
 <span data-ttu-id="a2b9d-1666"><xref:System.Text.RegularExpressions.RegexMatchTimeoutException>如果 split 作業的執行時間超過逾時間隔，此方法會呼叫的應用程式定義域指定，會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1666">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the split operation exceeds the time-out interval specified for the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-1667">如果在應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1667">If no time-out is defined in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1668">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1668">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1669"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1669"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1670">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1670">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1671">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1671">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1672">此方法等於呼叫該方法的應用程式定義域的預設逾時值一段時間後逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1672">This method times out after an interval that is equal to the default time-out value of the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-1673">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1673">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-1674">建議的靜態方法，來分割文字模式比對是<see cref="M:System.Text.RegularExpressions.Regex.Split(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1674">The recommended static method for splitting text on a pattern match is <see cref="M:System.Text.RegularExpressions.Regex.Split(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you set the time-out interval.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="Split">
      <MemberSignature Language="C#" Value="public string[] Split (string input, int count, int startat);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance string[] Split(string input, int32 count, int32 startat) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Split(System.String,System.Int32,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Split (input As String, count As Integer, startat As Integer) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::String ^&gt; ^ Split(System::String ^ input, int count, int startat);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="count" Type="System.Int32" />
        <Parameter Name="startat" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1675">要分隔的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1675">The string to be split.</span></span></param>
        <param name="count"><span data-ttu-id="a2b9d-1676">分隔作業可以發生的最多次數。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1676">The maximum number of times the split can occur.</span></span></param>
        <param name="startat"><span data-ttu-id="a2b9d-1677">在輸入字串中要開始搜尋的字元位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1677">The character position in the input string where the search will begin.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1678">在 <see cref="T:System.Text.RegularExpressions.Regex" /> 建構函式中指定的規則運算式所定義的位置，以指定的最大次數來將輸入字串分隔成子字串的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1678">Splits an input string a specified maximum number of times into an array of substrings, at the positions defined by a regular expression specified in the <see cref="T:System.Text.RegularExpressions.Regex" /> constructor.</span></span> <span data-ttu-id="a2b9d-1679">規則運算式模式從輸入字串中指定的字元位置開始搜尋。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1679">The search for the regular expression pattern starts at a specified character position in the input string.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1680">字串的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1680">An array of strings.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1681"><xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>方法都是類似於<xref:System.String.Split%2A?displayProperty=nameWithType>方法，不同處在於<xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>分割在規則運算式，而不是一組字元所決定的分隔符號字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1681">The <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> methods are similar to the <xref:System.String.Split%2A?displayProperty=nameWithType> method, except that <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> splits the string at a delimiter determined by a regular expression instead of a set of characters.</span></span> <span data-ttu-id="a2b9d-1682">`count`參數會指定到其中的子字串的最大數目`input`字串分割; 最後一個字串包含 unsplit 的字串的其餘部分。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1682">The `count` parameter specifies the maximum number of substrings into which the `input` string is split; the last string contains the unsplit remainder of the string.</span></span> <span data-ttu-id="a2b9d-1683">A`count`為零的值會提供分割成許多次越好的預設行為。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1683">A `count` value of zero provides the default behavior of splitting as many times as possible.</span></span> <span data-ttu-id="a2b9d-1684">`startat`參數定義的第一個分隔符號搜尋開始的點 （這可以用來略過前置空白字元）。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1684">The `startat` parameter defines the point at which the search for the first delimiter begins (this can be used for skipping leading white space).</span></span>  
  
 <span data-ttu-id="a2b9d-1685">如果沒有符合的項目從`count`+ 1 定位在字串中，方法會傳回一個項目陣列，包含`input`字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1685">If no matches are found from the `count`+1 position in the string, the method returns a one-element array that contains the `input` string.</span></span> <span data-ttu-id="a2b9d-1686">如果找不到一或多個相符項目，傳回的陣列的第一個元素包含從第一個字元，最多前比對一個字元字串的第一個部分。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1686">If one or more matches are found, the first element of the returned array contains the first portion of the string from the first character up to one character before the match.</span></span>  
  
 <span data-ttu-id="a2b9d-1687">如果多個相符項目彼此相鄰，而且找到符合項目數目是至少兩個小於`count`，空字串插入到陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1687">If multiple matches are adjacent to one another and the number of matches found is at least two less than `count`, an empty string is inserted into the array.</span></span> <span data-ttu-id="a2b9d-1688">同樣地，如果在找到相符項目`startat`，是在字串中的第一個字元，傳回之陣列的第一個項目為空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1688">Similarly, if a match is found at `startat`, which is the first character in the string, the first element of the returned array is an empty string.</span></span> <span data-ttu-id="a2b9d-1689">也就是空的字串所產生的相鄰的相符項目會計算在決定是否數目比對的子字串等於`count`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1689">That is, empty strings that result from adjacent matches are counted in determining whether the number of matched substrings equals `count`.</span></span> <span data-ttu-id="a2b9d-1690">在下列範例中，規則運算式`\d+`用來尋找數字字元的第一個子字串的開始位置在字串中，然後再將字串分割最多三次起始該位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1690">In the following example, the regular expression `\d+` is used to find the starting position of the first substring of numeric characters in a string, and then to split the string a maximum of three times starting at that position.</span></span> <span data-ttu-id="a2b9d-1691">由於規則運算式模式比對輸入字串的開頭，傳回的字串陣列包含空字串、 五個字元的英數字字串，以及字串的其餘部分</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1691">Because the regular expression pattern matches the beginning of the input string, the returned string array consists of an empty string, a five-character alphabetic string, and the remainder of the string,</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#26](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split26.cs#26)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#26](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split26.vb#26)]  
  
 <span data-ttu-id="a2b9d-1692">如果規則運算式中使用擷取括號，就會分隔字串的陣列中包含任何擷取的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1692">If capturing parentheses are used in a regular expression, any captured text is included in the array of split strings.</span></span> <span data-ttu-id="a2b9d-1693">不過，任何陣列元素包含擷取的文字不會包含在判斷是否相符項目數目已達到`count`。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1693">However, any array elements that contain captured text are not counted in determining whether the number of matches has reached `count`.</span></span> <span data-ttu-id="a2b9d-1694">例如，分割字串 '"apple-apricot-plum-pear-pomegranate-pineapple-peach 」 成四個最多的子字串開始於 15 字元字串中的結果七個元素的陣列，如下列程式碼所示。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1694">For example, splitting the string '"apple-apricot-plum-pear-pomegranate-pineapple-peach" into a maximum of four substrings beginning at character 15 in the string results in a seven-element array, as the following code shows.</span></span>  
  
 [!code-vb[System.Text.RegularExpressions.Regex.Split#6](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split6.vb#6)]  
  
 <span data-ttu-id="a2b9d-1695">不過，當規則運算式模式包含多組擷取括號時，此方法的行為取決於.NET Framework 版本。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1695">However, when the regular expression pattern includes multiple sets of capturing parentheses, the behavior of this method depends on the version of the .NET Framework.</span></span> <span data-ttu-id="a2b9d-1696">在.NET Framework 1.0 和 1.1 中，如果第一組擷取括號內找不到相符項目包含擷取的文字其他擷取括號不是傳回陣列中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1696">In .NET Framework 1.0 and 1.1, if a match is not found within the first set of capturing parentheses, captured text from additional capturing parentheses is not included in the returned array.</span></span> <span data-ttu-id="a2b9d-1697">從.NET Framework 2.0 開始，所有擷取的文字也會加入至傳回的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1697">Starting with the .NET Framework 2.0, all captured text is also added to the returned array.</span></span> <span data-ttu-id="a2b9d-1698">例如，下列程式碼會使用兩組擷取括號來擷取個別的文字字串中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1698">For example, the following code uses two sets of capturing parentheses to extract the individual words in a string.</span></span> <span data-ttu-id="a2b9d-1699">第一組擷取括號會擷取連字號，和第二個集合擷取的垂直列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1699">The first set of capturing parentheses captures the hyphen, and the second set captures the vertical bar.</span></span> <span data-ttu-id="a2b9d-1700">如果編譯範例程式碼，並在.NET Framework 1.0 或 1.1 之下執行，它會排除垂直列字元;如果它是編譯，而且.NET Framework 2.0 或更新版本底下執行，它會包含它們。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1700">If the example code is compiled and run under the .NET Framework 1.0 or 1.1, it excludes the vertical bar characters; if it is compiled and run under the .NET Framework 2.0 or later versions, it includes them.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#7](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split7.cs#7)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#7](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split7.vb#7)]  
  
 <span data-ttu-id="a2b9d-1701">如果規則運算式可以比對空字串，<xref:System.Text.RegularExpressions.Regex.Split%2A>會將字串分割成單一字元字串陣列，因為在每個位置找不到空字串分隔符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1701">If the regular expression can match the empty string, <xref:System.Text.RegularExpressions.Regex.Split%2A> will split the string into an array of single-character strings because the empty string delimiter can be found at every location.</span></span> <span data-ttu-id="a2b9d-1702">下列範例會分割成多的項目字串 「 字元 」 包含輸入的字串，以字元當做開頭為"a"。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1702">The following example splits the string "characters" into as many elements as the input string contains, starting with the character "a".</span></span> <span data-ttu-id="a2b9d-1703">因為 null 字串比對輸入字串的結尾，傳回的陣列結尾處插入的 null 字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1703">Because the null string matches the end of the input string, a null string is inserted at the end of the returned array.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#14](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split14.cs#14)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#14](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split14.vb#14)]  
  
 <span data-ttu-id="a2b9d-1704"><xref:System.Text.RegularExpressions.RegexMatchTimeoutException>如果 split 作業的執行時間超過指定的逾時間隔，會擲回例外狀況<xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType>建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1704">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the split operation exceeds the time-out interval specified by the <xref:System.Text.RegularExpressions.Regex.%23ctor%28System.String%2CSystem.Text.RegularExpressions.RegexOptions%2CSystem.TimeSpan%29?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="a2b9d-1705">呼叫建構函式時若未設定逾時間隔，則如果作業超過為建立 <xref:System.Text.RegularExpressions.Regex> 物件的應用程式定義域設定的任何逾時值，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1705">If you do not set a time-out interval when you call the constructor, the exception is thrown if the operation exceeds any time-out value established for the application domain in which the <xref:System.Text.RegularExpressions.Regex> object is created.</span></span> <span data-ttu-id="a2b9d-1706">如果在 <xref:System.Text.RegularExpressions.Regex> 建構函式呼叫或應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1706">If no time-out is defined in the <xref:System.Text.RegularExpressions.Regex> constructor call or in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1707"><paramref name="input" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1707"><paramref name="input" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1708"><paramref name="startat" /> 小於零或大於 <paramref name="input" /> 的長度。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1708"><paramref name="startat" /> is less than zero or greater than the length of <paramref name="input" />.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1709">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1709">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1710">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1710">For more information about time-outs, see the Remarks section.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Split">
      <MemberSignature Language="C#" Value="public static string[] Split (string input, string pattern, System.Text.RegularExpressions.RegexOptions options);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string[] Split(string input, string pattern, valuetype System.Text.RegularExpressions.RegexOptions options) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Split(System.String,System.String,System.Text.RegularExpressions.RegexOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Split (input As String, pattern As String, options As RegexOptions) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::String ^&gt; ^ Split(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::RegexOptions options);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1711">要分隔的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1711">The string to split.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1712">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1712">The regular expression pattern to match.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-1713">列舉值的位元組合，提供用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1713">A bitwise combination of the enumeration values that provide options for matching.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1714">在指定的規則運算式模式所定義的位置，將輸入字串分割成子字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1714">Splits an input string into an array of substrings at the positions defined by a specified regular expression pattern.</span></span> <span data-ttu-id="a2b9d-1715">指定的選項會修改符合的作業。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1715">Specified options modify the matching operation.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1716">字串的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1716">An array of strings.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1717"><xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>方法都是類似於<xref:System.String.Split%28System.Char%5B%5D%29?displayProperty=nameWithType>方法，不同處在於<xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>分割在規則運算式，而不是一組字元所決定的分隔符號字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1717">The <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> methods are similar to the <xref:System.String.Split%28System.Char%5B%5D%29?displayProperty=nameWithType> method, except that <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> splits the string at a delimiter determined by a regular expression instead of a set of characters.</span></span> <span data-ttu-id="a2b9d-1718">將字串分割為許多次。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1718">The string is split as many times as possible.</span></span> <span data-ttu-id="a2b9d-1719">如果不找到任何分隔符號，則傳回值包含一個項目，其值是原始`input`字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1719">If no delimiter is found, the return value contains one element whose value is the original `input` string.</span></span>  
  
 <span data-ttu-id="a2b9d-1720">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1720">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1721">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1721">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="a2b9d-1722">編譯為靜態的呼叫中使用的規則運算式<xref:System.Text.RegularExpressions.Regex.Split%2A>方法會自動快取。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1722">Compiled regular expressions used in calls to static <xref:System.Text.RegularExpressions.Regex.Split%2A> methods are automatically cached.</span></span> <span data-ttu-id="a2b9d-1723">若要自行管理編譯的規則運算式的存留期，使用 執行個體<xref:System.Text.RegularExpressions.Regex.Split%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1723">To manage the lifetime of compiled regular expressions yourself, use the instance <xref:System.Text.RegularExpressions.Regex.Split%2A> methods.</span></span>  
  
 <span data-ttu-id="a2b9d-1724">如果多個相符項目彼此相鄰的、 空字串會插入至陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1724">If multiple matches are adjacent to one another, an empty string is inserted into the array.</span></span> <span data-ttu-id="a2b9d-1725">例如，分割上的單一連字號的字串會造成傳回的陣列中找到兩個相鄰的連字號的位置包含空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1725">For example, splitting a string on a single hyphen causes the returned array to include an empty string in the position where two adjacent hyphens are found.</span></span>  
  
 <span data-ttu-id="a2b9d-1726">如果找到符合的開頭或輸入字串的結尾，空字串就會包含開頭或結尾傳回的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1726">If a match is found at the beginning or the end of the input string, an empty string is included at the beginning or the end of the returned array.</span></span> <span data-ttu-id="a2b9d-1727">下列範例會使用規則運算式模式`[a-z]+`分割輸入的字串的大寫或小寫字母的字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1727">The following example uses the regular expression pattern `[a-z]+` to split an input string on any uppercase or lowercase alphabetic character.</span></span> <span data-ttu-id="a2b9d-1728">因為字串開始和結尾相符的字母字元，則傳回的陣列的第一個和最後一個項目的值是<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1728">Because the string begins and ends with matching alphabetic characters, the value of the first and last element of the returned array is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#24](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split24.cs#24)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#24](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split24.vb#24)]  
  
 <span data-ttu-id="a2b9d-1729">如果擷取括號中使用<xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>運算式中，任何擷取的文字是否包含在產生的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1729">If capturing parentheses are used in a <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> expression, any captured text is included in the resulting string array.</span></span> <span data-ttu-id="a2b9d-1730">比方說，如果您分割字串"梅紅-西洋梨 」 上連字號放在擷取括號時，傳回的陣列會包含字串項目，其中包含連字號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1730">For example, if you split the string "plum-pear" on a hyphen placed within capturing parentheses, the returned array includes a string element that contains the hyphen.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#9](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split9.cs#9)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#9](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split9.vb#9)]  
  
 <span data-ttu-id="a2b9d-1731">不過，當規則運算式模式包含多組擷取括號時，此方法的行為取決於.NET Framework 版本。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1731">However, when the regular expression pattern includes multiple sets of capturing parentheses, the behavior of this method depends on the version of the .NET Framework.</span></span> <span data-ttu-id="a2b9d-1732">在.NET Framework 1.0 和 1.1 中，如果第一組擷取括號內找不到相符項目包含擷取的文字其他擷取括號不是傳回陣列中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1732">In the .NET Framework 1.0 and 1.1, if a match is not found within the first set of capturing parentheses, captured text from additional capturing parentheses is not included in the returned array.</span></span> <span data-ttu-id="a2b9d-1733">從.NET Framework 2.0 開始，所有擷取的文字也會加入至傳回的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1733">Starting with the .NET Framework 2.0, all captured text is also added to the returned array.</span></span> <span data-ttu-id="a2b9d-1734">例如，下列程式碼會使用兩組擷取括號來擷取日期，包括日期分隔符號，從日期字串的項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1734">For example, the following code uses two sets of capturing parentheses to extract the elements of a date, including the date delimiters, from a date string.</span></span> <span data-ttu-id="a2b9d-1735">第一個集合擷取括號會擷取連字號，和第二個集合擷取正斜線。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1735">The first set of capturing parentheses captures the hyphen, and the second set captures the forward slash.</span></span> <span data-ttu-id="a2b9d-1736">如果編譯範例程式碼，並在.NET Framework 1.0 或 1.1 之下執行，它會排除斜線字元。如果它是編譯，而且.NET Framework 2.0 或更新版本底下執行，它會包含它們。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1736">If the example code is compiled and run under the .NET Framework 1.0 or 1.1, it excludes the slash characters; if it is compiled and run under the .NET Framework 2.0 or later versions, it includes them.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#10](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split10.cs#10)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#10](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split10.vb#10)]  
  
 <span data-ttu-id="a2b9d-1737">如果規則運算式可以比對空字串，<xref:System.Text.RegularExpressions.Regex.Split%2A>會將字串分割成單一字元字串陣列，因為在每個位置找不到空字串分隔符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1737">If the regular expression can match the empty string, <xref:System.Text.RegularExpressions.Regex.Split%2A> will split the string into an array of single-character strings because the empty string delimiter can be found at every location.</span></span>  
  
 <span data-ttu-id="a2b9d-1738"><xref:System.Text.RegularExpressions.RegexMatchTimeoutException>如果 split 作業的執行時間超過逾時間隔，此方法會呼叫的應用程式定義域指定，會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1738">The <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception is thrown if the execution time of the split operation exceeds the time-out interval specified for the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-1739">如果在應用程式定義域的屬性中未定義任何逾時，或逾時值是 <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>，則不擲回任何例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1739">If no time-out is defined in the application domain's properties, or if the time-out value is <xref:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout?displayProperty=nameWithType>, no exception is thrown.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1740">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1740">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1741"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1741"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1742"><paramref name="options" /> 不是 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值的有效位元組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1742"><paramref name="options" /> is not a valid bitwise combination of <see cref="T:System.Text.RegularExpressions.RegexOptions" /> values.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1743">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1743">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1744">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1744">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1745">此方法等於呼叫該方法的應用程式定義域的預設逾時值一段時間後逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1745">This method times out after an interval that is equal to the default time-out value of the application domain in which the method is called.</span></span> <span data-ttu-id="a2b9d-1746">如果未針對應用程式定義域定義逾時值，則使用值 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，使方法不會逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1746">If a time-out value has not been defined for the application domain, the value <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, which prevents the method from timing out, is used.</span></span> <span data-ttu-id="a2b9d-1747">建議的靜態方法，來分割文字模式比對是<see cref="M:System.Text.RegularExpressions.Regex.Split(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />，可讓您設定的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1747">The recommended static method for splitting text on a pattern match is <see cref="M:System.Text.RegularExpressions.Regex.Split(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />, which lets you set the time-out interval.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="Split">
      <MemberSignature Language="C#" Value="public static string[] Split (string input, string pattern, System.Text.RegularExpressions.RegexOptions options, TimeSpan matchTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string[] Split(string input, string pattern, valuetype System.Text.RegularExpressions.RegexOptions options, valuetype System.TimeSpan matchTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Split(System.String,System.String,System.Text.RegularExpressions.RegexOptions,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Split (input As String, pattern As String, options As RegexOptions, matchTimeout As TimeSpan) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::String ^&gt; ^ Split(System::String ^ input, System::String ^ pattern, System::Text::RegularExpressions::RegexOptions options, TimeSpan matchTimeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="input" Type="System.String" />
        <Parameter Name="pattern" Type="System.String" />
        <Parameter Name="options" Type="System.Text.RegularExpressions.RegexOptions" />
        <Parameter Name="matchTimeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="input"><span data-ttu-id="a2b9d-1748">要分隔的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1748">The string to split.</span></span></param>
        <param name="pattern"><span data-ttu-id="a2b9d-1749">要比對的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1749">The regular expression pattern to match.</span></span></param>
        <param name="options"><span data-ttu-id="a2b9d-1750">列舉值的位元組合，提供用於比對的選項。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1750">A bitwise combination of the enumeration values that provide options for matching.</span></span></param>
        <param name="matchTimeout"><span data-ttu-id="a2b9d-1751">間隔，若要表示此方法不會逾時則為 <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1751">A time-out interval, or <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" /> to indicate that the method should not time out.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1752">在指定的規則運算式模式所定義的位置，將輸入字串分割成子字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1752">Splits an input string into an array of substrings at the positions defined by a specified regular expression pattern.</span></span> <span data-ttu-id="a2b9d-1753">如果沒有找到相符項目，其他參數會指定修改比對作業的選項和逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1753">Additional parameters specify options that modify the matching operation and a time-out interval if no match is found.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1754">字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1754">A string array.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1755"><xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>方法都是類似於<xref:System.String.Split%28System.Char%5B%5D%29?displayProperty=nameWithType>方法，不同處在於<xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>分割在規則運算式，而不是一組字元所決定的分隔符號字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1755">The <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> methods are similar to the <xref:System.String.Split%28System.Char%5B%5D%29?displayProperty=nameWithType> method, except that <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> splits the string at a delimiter determined by a regular expression instead of a set of characters.</span></span> <span data-ttu-id="a2b9d-1756">將字串分割為許多次。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1756">The string is split as many times as possible.</span></span> <span data-ttu-id="a2b9d-1757">如果不找到任何分隔符號，則傳回值包含一個項目，其值是原始`input`字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1757">If no delimiter is found, the return value contains one element whose value is the original `input` string.</span></span>  
  
 <span data-ttu-id="a2b9d-1758">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1758">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1759">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1759">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="a2b9d-1760">編譯為靜態的呼叫中使用的規則運算式<xref:System.Text.RegularExpressions.Regex.Split%2A>方法會自動快取。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1760">Compiled regular expressions used in calls to static <xref:System.Text.RegularExpressions.Regex.Split%2A> methods are automatically cached.</span></span> <span data-ttu-id="a2b9d-1761">若要自行管理編譯的規則運算式的存留期，使用 執行個體<xref:System.Text.RegularExpressions.Regex.Split%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1761">To manage the lifetime of compiled regular expressions yourself, use the instance <xref:System.Text.RegularExpressions.Regex.Split%2A> methods.</span></span>  
  
 <span data-ttu-id="a2b9d-1762">如果多個相符項目彼此相鄰的、 空字串會插入至陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1762">If multiple matches are adjacent to one another, an empty string is inserted into the array.</span></span> <span data-ttu-id="a2b9d-1763">例如，分割上的單一連字號的字串會造成傳回的陣列中找到兩個相鄰的連字號的位置包含空字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1763">For example, splitting a string on a single hyphen causes the returned array to include an empty string in the position where two adjacent hyphens are found.</span></span>  
  
 <span data-ttu-id="a2b9d-1764">如果找到符合的開頭或輸入字串的結尾，空字串就會包含開頭或結尾傳回的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1764">If a match is found at the beginning or the end of the input string, an empty string is included at the beginning or the end of the returned array.</span></span> <span data-ttu-id="a2b9d-1765">下列範例會使用規則運算式模式`[a-z]+`分割輸入的字串的大寫或小寫字母的字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1765">The following example uses the regular expression pattern `[a-z]+` to split an input string on any uppercase or lowercase alphabetic character.</span></span> <span data-ttu-id="a2b9d-1766">因為字串開始和結尾相符的字母字元，則傳回的陣列的第一個和最後一個項目的值是<xref:System.String.Empty?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1766">Because the string begins and ends with matching alphabetic characters, the value of the first and last element of the returned array is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#23](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split23.cs#23)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#23](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split23.vb#23)]  
  
 <span data-ttu-id="a2b9d-1767">如果擷取括號中使用<xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType>運算式中，任何擷取的文字是否包含在產生的字串陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1767">If capturing parentheses are used in a <xref:System.Text.RegularExpressions.Regex.Split%2A?displayProperty=nameWithType> expression, any captured text is included in the resulting string array.</span></span> <span data-ttu-id="a2b9d-1768">比方說，如果您分割字串"梅紅-西洋梨 」 上連字號放在擷取括號時，傳回的陣列會包含字串項目，其中包含連字號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1768">For example, if you split the string "plum-pear" on a hyphen placed within capturing parentheses, the returned array includes a string element that contains the hyphen.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#9](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split9.cs#9)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#9](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split9.vb#9)]  
  
 <span data-ttu-id="a2b9d-1769">不過，當規則運算式模式包含多組擷取括號時，此方法的行為取決於.NET Framework 版本。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1769">However, when the regular expression pattern includes multiple sets of capturing parentheses, the behavior of this method depends on the version of the .NET Framework.</span></span> <span data-ttu-id="a2b9d-1770">在.NET Framework 1.0 和 1.1 中，如果第一組擷取括號內找不到相符項目包含擷取的文字其他擷取括號不是傳回陣列中。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1770">In the .NET Framework 1.0 and 1.1, if a match is not found within the first set of capturing parentheses, captured text from additional capturing parentheses is not included in the returned array.</span></span> <span data-ttu-id="a2b9d-1771">從.NET Framework 2.0 開始，所有擷取的文字也會加入至傳回的陣列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1771">Starting with the .NET Framework 2.0, all captured text is also added to the returned array.</span></span> <span data-ttu-id="a2b9d-1772">例如，下列程式碼會使用兩組擷取括號來擷取日期，包括日期分隔符號，從日期字串的項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1772">For example, the following code uses two sets of capturing parentheses to extract the elements of a date, including the date delimiters, from a date string.</span></span> <span data-ttu-id="a2b9d-1773">第一個集合擷取括號會擷取連字號，和第二個集合擷取正斜線。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1773">The first set of capturing parentheses captures the hyphen, and the second set captures the forward slash.</span></span> <span data-ttu-id="a2b9d-1774">如果編譯範例程式碼，並在.NET Framework 1.0 或 1.1 之下執行，它會排除斜線字元。如果它是編譯，而且.NET Framework 2.0 或更新版本底下執行，它會包含它們。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1774">If the example code is compiled and run under the .NET Framework 1.0 or 1.1, it excludes the slash characters; if it is compiled and run under the .NET Framework 2.0 or later versions, it includes them.</span></span>  
  
 [!code-csharp[System.Text.RegularExpressions.Regex.Split#10](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/cs/split10.cs#10)]
 [!code-vb[System.Text.RegularExpressions.Regex.Split#10](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.Text.RegularExpressions.Regex.Split/vb/split10.vb#10)]  
  
 <span data-ttu-id="a2b9d-1775">如果規則運算式可以比對空字串，<xref:System.Text.RegularExpressions.Regex.Split%2A>會將字串分割成單一字元字串陣列，因為在每個位置找不到空字串分隔符號。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1775">If the regular expression can match the empty string, <xref:System.Text.RegularExpressions.Regex.Split%2A> will split the string into an array of single-character strings because the empty string delimiter can be found at every location.</span></span>  
  
 <span data-ttu-id="a2b9d-1776">`matchTimeout`參數會指定如何長模式比對方法應嘗試尋找相符項目，即會逾時。設定逾時間隔可避免依賴大量回溯出現停止回應時，它們會處理輸入的規則運算式，其中包含相符項目附近。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1776">The `matchTimeout` parameter specifies how long a pattern matching method should try to find a match before it times out. Setting a time-out interval prevents regular expressions that rely on excessive backtracking from appearing to stop responding when they process input that contains near matches.</span></span> <span data-ttu-id="a2b9d-1777">如需詳細資訊，請參閱[規則運算式的最佳作法](~/docs/standard/base-types/best-practices.md)和[回溯](~/docs/standard/base-types/backtracking-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1777">For more information, see [Best Practices for Regular Expressions](~/docs/standard/base-types/best-practices.md) and [Backtracking](~/docs/standard/base-types/backtracking-in-regular-expressions.md).</span></span> <span data-ttu-id="a2b9d-1778">如果該時間間隔中找到相符項目，方法會擲回<xref:System.Text.RegularExpressions.RegexMatchTimeoutException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1778">If no match is found in that time interval, the method throws a <xref:System.Text.RegularExpressions.RegexMatchTimeoutException> exception.</span></span> <span data-ttu-id="a2b9d-1779">`matchTimeout` 覆寫任何方法執行於其中的應用程式定義域定義的預設逾時值。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1779">`matchTimeout` overrides any default time-out value defined for the application domain in which the method executes.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="a2b9d-1780">發生規則運算式剖析錯誤。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1780">A regular expression parsing error occurred.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1781"><paramref name="input" /> 或 <paramref name="pattern" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1781"><paramref name="input" /> or <paramref name="pattern" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="a2b9d-1782"><paramref name="options" /> 不是 <see cref="T:System.Text.RegularExpressions.RegexOptions" /> 值的有效位元組合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1782"><paramref name="options" /> is not a valid bitwise combination of <see cref="T:System.Text.RegularExpressions.RegexOptions" /> values.</span></span>  
  
 <span data-ttu-id="a2b9d-1783">-或-</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1783">-or-</span></span>  
  
 <span data-ttu-id="a2b9d-1784"><paramref name="matchTimeout" /> 為負數、零或大約大於 24 天。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1784"><paramref name="matchTimeout" /> is negative, zero, or greater than approximately 24 days.</span></span></exception>
        <exception cref="T:System.Text.RegularExpressions.RegexMatchTimeoutException"><span data-ttu-id="a2b9d-1785">發生逾時。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1785">A time-out occurred.</span></span> <span data-ttu-id="a2b9d-1786">如需逾時的詳細資訊，請參閱＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1786">For more information about time-outs, see the Remarks section.</span></span></exception>
        <block subset="none" type="usage">
          <para><span data-ttu-id="a2b9d-1787">我們建議您將<paramref name="matchTimeout" />參數，以適當的值，例如兩秒。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1787">We recommend that you set the <paramref name="matchTimeout" /> parameter to an appropriate value, such as two seconds.</span></span> <span data-ttu-id="a2b9d-1788">如果您停用逾時指定<see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />，規則運算式引擎會提供稍微較佳的效能。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1788">If you disable time-outs by specifying <see cref="F:System.Text.RegularExpressions.Regex.InfiniteMatchTimeout" />, the regular expression engine offers slightly better performance.</span></span> <span data-ttu-id="a2b9d-1789">不過，您應該停用逾時，只有在下列情況下：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1789">However, you should disable time-outs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="a2b9d-1790">當規則運算式所處理的輸入衍生自已知且受信任的來源，或包含靜態文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1790">When the input processed by a regular expression is derived from a known and trusted source or consists of static text.</span></span> <span data-ttu-id="a2b9d-1791">這不包括已動態使用者所輸入的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1791">This excludes text that has been dynamically input by users.</span></span>  
  
-   <span data-ttu-id="a2b9d-1792">當規則運算式模式已徹底測試以確保它有效率地處理符合，不符合，不久符合。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1792">When the regular expression pattern has been thoroughly tested to ensure that it efficiently handles matches, non-matches, and near matches.</span></span>  
  
-   <span data-ttu-id="a2b9d-1793">當規則運算式模式包含已知會造成大量回溯處理接近的相符項目時沒有語言項目。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1793">When the regular expression pattern contains no language elements that are known to cause excessive backtracking when processing a near match.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="System.Runtime.Serialization.ISerializable.GetObjectData">
      <MemberSignature Language="C#" Value="void ISerializable.GetObjectData (System.Runtime.Serialization.SerializationInfo si, System.Runtime.Serialization.StreamingContext context);" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.Runtime.Serialization.ISerializable.GetObjectData(class System.Runtime.Serialization.SerializationInfo si, valuetype System.Runtime.Serialization.StreamingContext context) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.System#Runtime#Serialization#ISerializable#GetObjectData(System.Runtime.Serialization.SerializationInfo,System.Runtime.Serialization.StreamingContext)" />
      <MemberSignature Language="VB.NET" Value="Sub GetObjectData (si As SerializationInfo, context As StreamingContext) Implements ISerializable.GetObjectData" />
      <MemberSignature Language="C++ CLI" Value=" virtual void System.Runtime.Serialization.ISerializable.GetObjectData(System::Runtime::Serialization::SerializationInfo ^ si, System::Runtime::Serialization::StreamingContext context) = System::Runtime::Serialization::ISerializable::GetObjectData;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Runtime.Serialization.ISerializable.GetObjectData(System.Runtime.Serialization.SerializationInfo,System.Runtime.Serialization.StreamingContext)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="si" Type="System.Runtime.Serialization.SerializationInfo" />
        <Parameter Name="context" Type="System.Runtime.Serialization.StreamingContext" />
      </Parameters>
      <Docs>
        <param name="si"><span data-ttu-id="a2b9d-1794">要使用序列化資訊來填入的物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1794">The object to populate with serialization information.</span></span></param>
        <param name="context"><span data-ttu-id="a2b9d-1795">要儲存並擷取序列化資料的位置。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1795">The place to store and retrieve serialized data.</span></span> <span data-ttu-id="a2b9d-1796">這個參數保留給未來的版本使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1796">This parameter is reserved for future use.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1797">將還原序列化目前 <see cref="T:System.Runtime.Serialization.SerializationInfo" /> 物件所需的資料填入 (Populate) <see cref="T:System.Text.RegularExpressions.Regex" /> 物件。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1797">Populates a <see cref="T:System.Runtime.Serialization.SerializationInfo" /> object with the data necessary to deserialize the current <see cref="T:System.Text.RegularExpressions.Regex" /> object.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="ToString">
      <MemberSignature Language="C#" Value="public override string ToString ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string ToString() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.ToString" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ToString () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ ToString();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="a2b9d-1798">傳回傳遞至 <see langword="Regex" /> 建構函式中的規則運算式模式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1798">Returns the regular expression pattern that was passed into the <see langword="Regex" /> constructor.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1799"><paramref name="pattern" /> 參數，傳遞至 <see langword="Regex" /> 建構函式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1799">The <paramref name="pattern" /> parameter that was passed into the <see langword="Regex" /> constructor.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1800">`pattern` 參數包含規則運算式語言項目，以透過符號描述要比對的字串。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1800">The `pattern` parameter consists of regular expression language elements that symbolically describe the string to match.</span></span> <span data-ttu-id="a2b9d-1801">如需有關規則運算式的詳細資訊，請參閱[.NET Framework 規則運算式](~/docs/standard/base-types/regular-expressions.md)和[規則運算式語言-快速參考](~/docs/standard/base-types/regular-expression-language-quick-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1801">For more information about regular expressions, see [.NET Framework Regular Expressions](~/docs/standard/base-types/regular-expressions.md) and [Regular Expression Language - Quick Reference](~/docs/standard/base-types/regular-expression-language-quick-reference.md).</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides">
          <para>
            <span data-ttu-id="a2b9d-1802"><see cref="T:System.Text.RegularExpressions.Regex" /> 基底類別所建立的規則運算式的<see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" />方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1802"><see cref="T:System.Text.RegularExpressions.Regex" /> is the base class of regular expressions created by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span> <span data-ttu-id="a2b9d-1803">這些編譯規則運算式使用<see cref="M:System.Text.RegularExpressions.Regex.ToString" />基底類別的實作。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1803">These compiled regular expressions use the <see cref="M:System.Text.RegularExpressions.Regex.ToString" /> implementation of the base class.</span></span> <span data-ttu-id="a2b9d-1804">如果已從衍生類別呼叫<see cref="M:System.Text.RegularExpressions.Regex.ToString" />方法會傳回字串傳遞給<paramref name="pattern" />參數<see cref="T:System.Text.RegularExpressions.RegexCompilationInfo" />類別建構函式是用來定義規則運算式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1804">If called from a derived class, the <see cref="M:System.Text.RegularExpressions.Regex.ToString" /> method returns the string that was passed to the <paramref name="pattern" /> parameter of the <see cref="T:System.Text.RegularExpressions.RegexCompilationInfo" /> class constructor that was used to define the regular expression.</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="Unescape">
      <MemberSignature Language="C#" Value="public static string Unescape (string str);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string Unescape(string str) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.Unescape(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Unescape (str As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Unescape(System::String ^ str);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="str" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="str"><span data-ttu-id="a2b9d-1805">輸入字串，包含要轉換的文字。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1805">The input string containing the text to convert.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1806">轉換輸入字串中任何逸出的字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1806">Converts any escaped characters in the input string.</span></span></summary>
        <returns><span data-ttu-id="a2b9d-1807">字元字串，其中任何逸出字元轉換成其未逸出格式。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1807">A string of characters with any escaped characters converted to their unescaped form.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a2b9d-1808"><xref:System.Text.RegularExpressions.Regex.Unescape%2A>方法會執行下列兩個轉換的其中一個：</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1808">The <xref:System.Text.RegularExpressions.Regex.Unescape%2A> method performs one of the following two transformations:</span></span>  
  
-   <span data-ttu-id="a2b9d-1809">它會反轉所執行的轉換<xref:System.Text.RegularExpressions.Regex.Escape%2A>方法藉由移除逸出字元 ("\\」) 從逸出方法的每個字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1809">It reverses the transformation performed by the <xref:System.Text.RegularExpressions.Regex.Escape%2A> method by removing the escape character ("\\") from each character escaped by the method.</span></span> <span data-ttu-id="a2b9d-1810">這些包括\\，\*，+，？， &#124;，{，[，（、）、 ^、 $、。，# 和空白字元。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1810">These include the \\, \*, +, ?, &#124;, {, [, (,), ^, $,., #, and white space characters.</span></span> <span data-ttu-id="a2b9d-1811">此外，<xref:System.Text.RegularExpressions.Regex.Unescape%2A>右括號 (]) 和關閉括號 （}） 字元不逸出方法。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1811">In addition, the <xref:System.Text.RegularExpressions.Regex.Unescape%2A> method unescapes the closing bracket (]) and closing brace (}) characters.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a2b9d-1812"><xref:System.Text.RegularExpressions.Regex.Unescape%2A> 無法回復的逸出的字串完全無法推算精確哪些字元不逸出因為</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1812"><xref:System.Text.RegularExpressions.Regex.Unescape%2A> cannot reverse an escaped string perfectly because it cannot deduce precisely which characters were escaped,</span></span>  
  
-   <span data-ttu-id="a2b9d-1813">它會將不可列印字元的表示法取代字元本身。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1813">It replaces the representation of unprintable characters with the characters themselves.</span></span> <span data-ttu-id="a2b9d-1814">例如，它會取代 \a \x07。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1814">For example, it replaces \a with \x07.</span></span> <span data-ttu-id="a2b9d-1815">它會取代的字元表示為 \a、 \b、 \e、 \n、 \r、 \f、 \t 和 \v。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1815">The character representations it replaces are \a, \b, \e, \n, \r, \f, \t, and \v.</span></span>  
  
 <span data-ttu-id="a2b9d-1816">如果<xref:System.Text.RegularExpressions.Regex.Unescape%2A>方法遇到其他逸出序列，它無法轉換，例如 \w 或 \s，就會擲回<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1816">If the <xref:System.Text.RegularExpressions.Regex.Unescape%2A> method encounters other escape sequences that it cannot convert, such as \w or \s, it throws an <xref:System.ArgumentException>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="a2b9d-1817"><paramref name="str" /> 包含無法辨認的逸出序列。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1817"><paramref name="str" /> includes an unrecognized escape sequence.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="a2b9d-1818"><paramref name="str" /> 為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1818"><paramref name="str" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="M:System.Text.RegularExpressions.Regex.Escape(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="UseOptionC">
      <MemberSignature Language="C#" Value="protected bool UseOptionC ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig instance bool UseOptionC() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.UseOptionC" />
      <MemberSignature Language="VB.NET" Value="Protected Function UseOptionC () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; bool UseOptionC();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="a2b9d-1819">由 <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> 方法所產生的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1819">Used by a <see cref="T:System.Text.RegularExpressions.Regex" /> object generated by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span></summary>
        <returns>
          <span data-ttu-id="a2b9d-1820">如果 <see cref="P:System.Text.RegularExpressions.Regex.Options" /> 屬性包含 <see cref="F:System.Text.RegularExpressions.RegexOptions.Compiled" /> 選項，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1820"><see langword="true" /> if the <see cref="P:System.Text.RegularExpressions.Regex.Options" /> property contains the <see cref="F:System.Text.RegularExpressions.RegexOptions.Compiled" /> option; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="UseOptionR">
      <MemberSignature Language="C#" Value="protected bool UseOptionR ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig instance bool UseOptionR() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.UseOptionR" />
      <MemberSignature Language="VB.NET" Value="Protected Function UseOptionR () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; bool UseOptionR();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="a2b9d-1821">由 <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> 方法所產生的 <see cref="T:System.Text.RegularExpressions.Regex" /> 物件使用。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1821">Used by a <see cref="T:System.Text.RegularExpressions.Regex" /> object generated by the <see cref="Overload:System.Text.RegularExpressions.Regex.CompileToAssembly" /> method.</span></span></summary>
        <returns>
          <span data-ttu-id="a2b9d-1822">如果 <see cref="P:System.Text.RegularExpressions.Regex.Options" /> 屬性包含 <see cref="F:System.Text.RegularExpressions.RegexOptions.RightToLeft" /> 選項，則為 <see langword="true" />，否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1822"><see langword="true" /> if the <see cref="P:System.Text.RegularExpressions.Regex.Options" /> property contains the <see cref="F:System.Text.RegularExpressions.RegexOptions.RightToLeft" /> option; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="ValidateMatchTimeout">
      <MemberSignature Language="C#" Value="protected internal static void ValidateMatchTimeout (TimeSpan matchTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblystatic hidebysig void ValidateMatchTimeout(valuetype System.TimeSpan matchTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Text.RegularExpressions.Regex.ValidateMatchTimeout(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Protected Friend Shared Sub ValidateMatchTimeout (matchTimeout As TimeSpan)" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; static void ValidateMatchTimeout(TimeSpan matchTimeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Text.RegularExpressions</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="matchTimeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="matchTimeout"><span data-ttu-id="a2b9d-1823">要檢查的逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1823">The time-out interval to check.</span></span></param>
        <summary><span data-ttu-id="a2b9d-1824">檢查逾時間隔是否在可接受的範圍內。</span><span class="sxs-lookup"><span data-stu-id="a2b9d-1824">Checks whether a time-out interval is within an acceptable range.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
  </Members>
</Type>