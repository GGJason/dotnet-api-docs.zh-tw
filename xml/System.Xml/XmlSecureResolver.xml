<Type Name="XmlSecureResolver" FullName="System.Xml.XmlSecureResolver">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="2c04793a28d1db5b342b4108181cd0e46777358a" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class XmlSecureResolver : System.Xml.XmlResolver" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit XmlSecureResolver extends System.Xml.XmlResolver" />
  <TypeSignature Language="DocId" Value="T:System.Xml.XmlSecureResolver" />
  <TypeSignature Language="VB.NET" Value="Public Class XmlSecureResolver&#xA;Inherits XmlResolver" />
  <TypeSignature Language="C++ CLI" Value="public ref class XmlSecureResolver : System::Xml::XmlResolver" />
  <AssemblyInfo>
    <AssemblyName>System.Xml</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Xml.ReaderWriter</AssemblyName>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.1.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Xml.XmlResolver</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="2ba8d-101">以包裝 <see cref="T:System.Xml.XmlResolver" /> 物件，並限制基礎 <see cref="T:System.Xml.XmlResolver" /> 所能存取的資源，來協助保護其他 <see cref="T:System.Xml.XmlResolver" /> 實作的安全性。</span>
      <span class="sxs-lookup">
        <span data-stu-id="2ba8d-101">Helps to secure another implementation of <see cref="T:System.Xml.XmlResolver" /> by wrapping the <see cref="T:System.Xml.XmlResolver" /> object and restricting the resources that the underlying <see cref="T:System.Xml.XmlResolver" /> has access to.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2ba8d-102"><xref:System.Xml.XmlUrlResolver> 類別是 <xref:System.Xml> 命名空間中所有類別的預設解析程式。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-102">The <xref:System.Xml.XmlUrlResolver> class is the default resolver for all classes in the <xref:System.Xml> namespace.</span></span> <span data-ttu-id="2ba8d-103">它用來載入 XML 文件和解析外部資源，例如實體、 Dtd 或結構描述，以及匯入或 include 指示詞。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-103">It is used to load XML documents and to resolve external resources such as entities, DTDs or schemas, and import or include directives.</span></span>  
  
 <span data-ttu-id="2ba8d-104">您可以藉由指定覆寫此預設<xref:System.Xml.XmlResolver>来使用的物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-104">You can override this default by specifying the <xref:System.Xml.XmlResolver> object to use.</span></span> <span data-ttu-id="2ba8d-105">例如，如果您想要限制的資源，基礎<xref:System.Xml.XmlResolver>都可以存取，您可以使用<xref:System.Xml.XmlSecureResolver>物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-105">For example, if you want to restrict the resources that the underlying <xref:System.Xml.XmlResolver> can access, you can use an <xref:System.Xml.XmlSecureResolver> object.</span></span>  
  
 <span data-ttu-id="2ba8d-106"><xref:System.Xml.XmlSecureResolver> 換行的具體實作<xref:System.Xml.XmlResolver>，並限制資源的基礎<xref:System.Xml.XmlResolver>具有存取權。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-106"><xref:System.Xml.XmlSecureResolver> wraps around a concrete implementation of <xref:System.Xml.XmlResolver> and restricts the resources that the underlying <xref:System.Xml.XmlResolver> has access to.</span></span> <span data-ttu-id="2ba8d-107">例如，<xref:System.Xml.XmlSecureResolver>能夠禁止跨網域重新導向，請從內嵌的統一資源識別元 (URI) 參考，就會發生。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-107">For example, <xref:System.Xml.XmlSecureResolver> has the ability to prohibit cross-domain redirection, which occurs from an embedded Uniform Resource Identifier (URI) reference.</span></span>  
  
 <span data-ttu-id="2ba8d-108">當您建構<xref:System.Xml.XmlSecureResolver>物件，您提供有效<xref:System.Xml.XmlResolver>以及 URL 辨識項物件或權限集的執行個體所使用的實作<xref:System.Xml.XmlSecureResolver>來判斷安全性。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-108">When you construct an <xref:System.Xml.XmlSecureResolver> object, you provide a valid <xref:System.Xml.XmlResolver> implementation along with a URL, an instance of an evidence object, or a permission set, which is used by the <xref:System.Xml.XmlSecureResolver> to determine security.</span></span> <span data-ttu-id="2ba8d-109">任一<xref:System.Security.PermissionSet?displayProperty=nameWithType>產生或使用現有和<xref:System.Security.PermissionSet.PermitOnly%2A?displayProperty=nameWithType>呼叫它來協助保護基礎<xref:System.Xml.XmlResolver>。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-109">Either a <xref:System.Security.PermissionSet?displayProperty=nameWithType> is generated or the existing one is used and <xref:System.Security.PermissionSet.PermitOnly%2A?displayProperty=nameWithType> is called on it to help secure the underlying <xref:System.Xml.XmlResolver>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="2ba8d-110"><xref:System.Xml.XmlSecureResolver> 物件可以包含機密資訊 (如使用者認證)。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-110"><xref:System.Xml.XmlSecureResolver> objects can contain sensitive information such as user credentials.</span></span> <span data-ttu-id="2ba8d-111">您應該要特別小心快取時<xref:System.Xml.XmlSecureResolver>物件，並不應將傳遞<xref:System.Xml.XmlSecureResolver>物件不受信任的元件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-111">You should be careful when caching <xref:System.Xml.XmlSecureResolver> objects and should not pass the <xref:System.Xml.XmlSecureResolver> object to an untrusted component.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="2ba8d-112">有一些安全性基礎結構在.NET Framework common language runtime (CLR) 上執行的程式碼和整合至 Microsoft SQL Server 2005 在 CLR 上執行的程式碼中的差異。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-112">There are differences in the security infrastructure for code running on the .NET Framework common language runtime (CLR) and for code running on the CLR that is integrated within Microsoft SQL Server 2005.</span></span> <span data-ttu-id="2ba8d-113">這可能會導致整合開發的.NET Framework CLR 的操作方式與在 SQL Server 上使用的程式碼 CLR 的情況下。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-113">This can lead to cases where code developed for the .NET Framework CLR operates differently when used on the SQL Server integrated CLR.</span></span> <span data-ttu-id="2ba8d-114">下列其中一種差異會影響<xref:System.Xml.XmlSecureResolver>類別時，您必須為基礎的 URL 辨識項 (也就是當您使用<xref:System.Xml.XmlSecureResolver.CreateEvidenceForUrl%28System.String%29>方法或<xref:System.Xml.XmlSecureResolver.%23ctor%2A>建構函式)。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-114">One of these differences affects the <xref:System.Xml.XmlSecureResolver> class when you have evidence that is based on a URL (that is, when you use the <xref:System.Xml.XmlSecureResolver.CreateEvidenceForUrl%28System.String%29> method or the <xref:System.Xml.XmlSecureResolver.%23ctor%2A> constructor).</span></span> <span data-ttu-id="2ba8d-115">原則解析的 SQL Server 的機制整合 CLR 不會使用<xref:System.Security.Policy.Url>或<xref:System.Security.Policy.Zone>資訊。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-115">The policy resolution mechanism of the SQL Server integrated CLR does not use the <xref:System.Security.Policy.Url> or <xref:System.Security.Policy.Zone> information.</span></span> <span data-ttu-id="2ba8d-116">相反地，它會授與組件載入時，伺服器會將新增 GUID 為基礎的權限。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-116">Instead, it grants permissions based on the GUID that the server adds when assemblies are loaded.</span></span> <span data-ttu-id="2ba8d-117">當您使用<xref:System.Xml.XmlSecureResolver>中 SQL Server 整合的 CLR，請提供直接透過使用指定的任何必要的辨識項<xref:System.Security.PermissionSet>。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-117">When you use the <xref:System.Xml.XmlSecureResolver> in the SQL Server integrated CLR, provide any required evidence directly by using a specified <xref:System.Security.PermissionSet>.</span></span>  
  
## <a name="to-use-a-secure-resolver"></a><span data-ttu-id="2ba8d-118">若要使用安全的解析程式</span><span class="sxs-lookup"><span data-stu-id="2ba8d-118">To use a secure resolver</span></span>  
  
1.  <span data-ttu-id="2ba8d-119">建立具有正確使用權限集合的 <xref:System.Xml.XmlSecureResolver> 物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-119">Create an <xref:System.Xml.XmlSecureResolver> with the correct permission set.</span></span>  
  
2.  <span data-ttu-id="2ba8d-120">建立使用 <xref:System.Xml.XmlReaderSettings> 物件的 <xref:System.Xml.XmlSecureResolver> 物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-120">Create an <xref:System.Xml.XmlReaderSettings> object that uses the <xref:System.Xml.XmlSecureResolver> object.</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#5a](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#5a)]
     [!code-vb[XmlSecureResolver_Samples#5a](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#5a)]  
  
3.  <span data-ttu-id="2ba8d-121">傳遞<xref:System.Xml.XmlReaderSettings>物件<xref:System.Xml.XmlReader.Create%2A>方法，當您在建立時<xref:System.Xml.XmlReader>物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-121">Pass  the <xref:System.Xml.XmlReaderSettings> object to the <xref:System.Xml.XmlReader.Create%2A> method when you're creating the <xref:System.Xml.XmlReader> object.</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#5b](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#5b)]
     [!code-vb[XmlSecureResolver_Samples#5b](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#5b)]  
  
## <a name="to-restrict-access-by-using-a-url"></a><span data-ttu-id="2ba8d-122">若要使用的 URL 限制存取</span><span class="sxs-lookup"><span data-stu-id="2ba8d-122">To restrict access by using a URL</span></span>  
 <span data-ttu-id="2ba8d-123">使用<xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.String%29>建構函式建立<xref:System.Xml.XmlSecureResolver>存取近端內部網路網站只允許的物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-123">Use the <xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.String%29> constructor to create an <xref:System.Xml.XmlSecureResolver> object that is allowed to access your local intranet site only.</span></span>  
  
 [!code-csharp[XmlSecureResolver_Samples#3](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#3)]
 [!code-vb[XmlSecureResolver_Samples#3](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#3)]  
  
## <a name="to-restrict-access-by-using-a-permission-set"></a><span data-ttu-id="2ba8d-124">若要使用的權限集合限制存取</span><span class="sxs-lookup"><span data-stu-id="2ba8d-124">To restrict access by using a permission set</span></span>  
  
1.  <span data-ttu-id="2ba8d-125">建立 <xref:System.Net.WebPermission> 物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-125">Create a <xref:System.Net.WebPermission> object.</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#4a](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#4a)]
     [!code-vb[XmlSecureResolver_Samples#4a](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#4a)]  
  
2.  <span data-ttu-id="2ba8d-126">指定您想要允許存取的 Url。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-126">Specify the URLs that you want to allow access to.</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#4b](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#4b)]
     [!code-vb[XmlSecureResolver_Samples#4b](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#4b)]  
  
3.  <span data-ttu-id="2ba8d-127">將 Web 使用權限加入至 <xref:System.Security.PermissionSet> 物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-127">Add the web permissions to the <xref:System.Security.PermissionSet> object.</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#4c](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#4c)]
     [!code-vb[XmlSecureResolver_Samples#4c](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#4c)]  
  
4.  <span data-ttu-id="2ba8d-128">使用<xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.Security.PermissionSet%29>建構函式建立<xref:System.Xml.XmlSecureResolver>使用權限集合的物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-128">Use the <xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.Security.PermissionSet%29> constructor to create an <xref:System.Xml.XmlSecureResolver> object by using the permission set.</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#4d](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#4d)]
     [!code-vb[XmlSecureResolver_Samples#4d](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#4d)]  
  
     <span data-ttu-id="2ba8d-129">請參閱<xref:System.Xml.XmlSecureResolver.%23ctor%2A>參考頁面的另一個範例。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-129">See the <xref:System.Xml.XmlSecureResolver.%23ctor%2A> reference page for another example.</span></span>  
  
## <a name="to-restrict-access-by-using-evidence"></a><span data-ttu-id="2ba8d-130">使用辨識項來限制存取</span><span class="sxs-lookup"><span data-stu-id="2ba8d-130">To restrict access by using evidence</span></span>  
 <span data-ttu-id="2ba8d-131">您可以使用來限制存取<xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.Security.Policy.Evidence%29>建構函式，並指定<xref:System.Security.Policy.Evidence>。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-131">You can restrict access by using the <xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.Security.Policy.Evidence%29> constructor and specifying <xref:System.Security.Policy.Evidence>.</span></span> <span data-ttu-id="2ba8d-132"><xref:System.Security.Policy.Evidence> 可用於建立 <xref:System.Security.PermissionSet>，其會套用至基礎 <xref:System.Xml.XmlResolver>。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-132">The <xref:System.Security.Policy.Evidence> is used to create the <xref:System.Security.PermissionSet> that is applied to the underlying <xref:System.Xml.XmlResolver>.</span></span> <span data-ttu-id="2ba8d-133">在開啟任何資源之前，<xref:System.Xml.XmlSecureResolver> 都會呼叫已建立之 <xref:System.Security.PermissionSet.PermitOnly%2A> 上的 <xref:System.Security.PermissionSet>。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-133">The <xref:System.Xml.XmlSecureResolver> calls <xref:System.Security.PermissionSet.PermitOnly%2A> on the created <xref:System.Security.PermissionSet> before opening any resources.</span></span>  
  
 <span data-ttu-id="2ba8d-134">以下是一些常見案例，以及每個提供的辨識項型別：</span><span class="sxs-lookup"><span data-stu-id="2ba8d-134">Here are some common scenarios and the type of evidence to provide for each:</span></span>  
  
-   <span data-ttu-id="2ba8d-135">如果您使用完全信任的環境中，使用您的組件來建立辨識項：</span><span class="sxs-lookup"><span data-stu-id="2ba8d-135">If you are working in a fully trusted environment, use your assembly to create the evidence:</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#1](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#1)]
     [!code-vb[XmlSecureResolver_Samples#1](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#1)]  
  
-   <span data-ttu-id="2ba8d-136">如果您使用非完全信任環境中，您的程式碼或來自外部來源，且您知道外部來源的源頭和可驗證的 URI，請使用 URI 建立辨識項：</span><span class="sxs-lookup"><span data-stu-id="2ba8d-136">If you are working in a semi-trusted environment, you have code or data coming from an outside source, and you know the origin of the outside source and have a verifiable URI, use the URI to create the evidence:</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#2](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#2)]
     [!code-vb[XmlSecureResolver_Samples#2](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#2)]  
  
-   <span data-ttu-id="2ba8d-137">如果您使用非完全信任的環境，而且您的程式碼或來自外部來源，但您不知道來源的外部來源，請：</span><span class="sxs-lookup"><span data-stu-id="2ba8d-137">If you are working in a semi-trusted environment and you have code or data coming from an outside source, but you don't know the origin of the outside source, either:</span></span>  
  
     <span data-ttu-id="2ba8d-138">將 `evidence` 參數設定為 `null`。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-138">Set the `evidence` parameter to `null`.</span></span> <span data-ttu-id="2ba8d-139">這可以拒絕對資源的任何存取。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-139">This allows no access to resources.</span></span>  
  
     <span data-ttu-id="2ba8d-140">-或-</span><span class="sxs-lookup"><span data-stu-id="2ba8d-140">-or-</span></span>  
  
     <span data-ttu-id="2ba8d-141">如果應用程式需要資源的某些存取權，請要求呼叫端的辨識項。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-141">If your application requires some access to resources, request evidence from the caller.</span></span>  
  
## <a name="to-use-the-secure-resolver-to-load-an-xslt-style-sheet"></a><span data-ttu-id="2ba8d-142">要用來載入 XSLT 樣式表的安全的解析程式</span><span class="sxs-lookup"><span data-stu-id="2ba8d-142">To use the secure resolver to load an XSLT style sheet</span></span>  
  
1.  <span data-ttu-id="2ba8d-143">建立具有正確使用權限集合的 <xref:System.Xml.XmlSecureResolver> 物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-143">Create an <xref:System.Xml.XmlSecureResolver> with the correct permission set.</span></span>  
  
2.  <span data-ttu-id="2ba8d-144">將 <xref:System.Xml.XmlSecureResolver> 傳遞至 <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-144">Pass the <xref:System.Xml.XmlSecureResolver> to the <xref:System.Xml.Xsl.XslCompiledTransform.Load%2A> method.</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#6](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#6)]
     [!code-vb[XmlSecureResolver_Samples#6](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#6)]  
  
 ]]></format>
    </remarks>
    <block subset="none" type="overrides">
      <para>
        <span data-ttu-id="2ba8d-145">這個類別具有繼承要求。</span>
        <span class="sxs-lookup">
          <span data-stu-id="2ba8d-145">This class has an inheritance demand.</span>
        </span>
        <span data-ttu-id="2ba8d-146">完全信任才能繼承自<see cref="T:System.Xml.XmlSecureResolver" />類別。</span>
        <span class="sxs-lookup">
          <span data-stu-id="2ba8d-146">Full trust is required to inherit from the <see cref="T:System.Xml.XmlSecureResolver" /> class.</span>
        </span>
      </para>
    </block>
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Xml</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="2ba8d-147">初始化 <see cref="T:System.Xml.XmlSecureResolver" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-147">Initializes a new instance of the <see cref="T:System.Xml.XmlSecureResolver" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2ba8d-148">三個建構函式提供三種類型的存取限制：</span><span class="sxs-lookup"><span data-stu-id="2ba8d-148">The three constructors provide three types of access restrictions:</span></span>  
  
-   <span data-ttu-id="2ba8d-149"><xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.String%29>建構函式會使用 URL 來限制存取。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-149">The <xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.String%29> constructor restricts access by using a URL.</span></span>  
  
-   <span data-ttu-id="2ba8d-150"><xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.Security.PermissionSet%29>建構函式會使用的權限集合來限制存取。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-150">The <xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.Security.PermissionSet%29> constructor restricts access by using a permission set.</span></span>  
  
-   <span data-ttu-id="2ba8d-151"><xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.Security.Policy.Evidence%29>建構函式會限制存取使用的辨識項。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-151">The <xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.Security.Policy.Evidence%29> constructor restricts access by using evidence.</span></span>  
  
 <span data-ttu-id="2ba8d-152">請參閱建構函式參考主題，如需範例，這些類型的限制。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-152">See the constructor reference topics for examples of these types of restrictions.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public XmlSecureResolver (System.Xml.XmlResolver resolver, System.Security.PermissionSet permissionSet);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Xml.XmlResolver resolver, class System.Security.PermissionSet permissionSet) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Xml.XmlSecureResolver.#ctor(System.Xml.XmlResolver,System.Security.PermissionSet)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; XmlSecureResolver(System::Xml::XmlResolver ^ resolver, System::Security::PermissionSet ^ permissionSet);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Xml</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="resolver" Type="System.Xml.XmlResolver" />
        <Parameter Name="permissionSet" Type="System.Security.PermissionSet" />
      </Parameters>
      <Docs>
        <param name="resolver">
          <span data-ttu-id="2ba8d-153">
            <see cref="T:System.Xml.XmlSecureResolver" /> 所包裝的 XML 解析程式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-153">The XML resolver that is wrapped by the <see cref="T:System.Xml.XmlSecureResolver" />.</span>
          </span>
        </param>
        <param name="permissionSet">
          <span data-ttu-id="2ba8d-154">要套用至基礎 <see cref="T:System.Xml.XmlResolver" /> 的權限集。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-154">The permission set to apply to the underlying <see cref="T:System.Xml.XmlResolver" />.</span>
          </span>
          <span data-ttu-id="2ba8d-155">
            <see cref="T:System.Xml.XmlSecureResolver" /> 先呼叫權限集上的 <see cref="M:System.Security.PermissionSet.PermitOnly" /> 方法，然後才呼叫基礎 XML 解析程式上的 <see cref="M:System.Xml.XmlSecureResolver.GetEntity(System.Uri,System.String,System.Type)" /> 方法。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-155">The <see cref="T:System.Xml.XmlSecureResolver" /> calls the <see cref="M:System.Security.PermissionSet.PermitOnly" /> method on the permission set before calling the <see cref="M:System.Xml.XmlSecureResolver.GetEntity(System.Uri,System.String,System.Type)" /> method on the underlying XML resolver.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="2ba8d-156">指定 <see cref="T:System.Xml.XmlResolver" /> 和 <see cref="T:System.Security.PermissionSet" /> 來初始化 <see cref="T:System.Xml.XmlSecureResolver" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-156">Initializes a new instance of the <see cref="T:System.Xml.XmlSecureResolver" /> class with the <see cref="T:System.Xml.XmlResolver" /> and <see cref="T:System.Security.PermissionSet" /> specified.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="2ba8d-157">下列範例會建構<xref:System.Xml.XmlSecureResolver>物件使用的自訂權限集合。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-157">The following example constructs an <xref:System.Xml.XmlSecureResolver> object by using a customized permission set.</span></span>  
  
 [!code-cpp[XmlSecureResolver.cctor#1](~/samples/snippets/cpp/VS_Snippets_Data/XmlSecureResolver.cctor/CPP/secresolver.cpp#1)]
 [!code-csharp[XmlSecureResolver.cctor#1](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver.cctor/CS/secresolver.cs#1)]
 [!code-vb[XmlSecureResolver.cctor#1](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver.cctor/VB/secresolver.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Xml.XmlSecureResolver.CreateEvidenceForUrl(System.String)" />
        <altmember cref="T:System.Security.Policy.Evidence" />
        <altmember cref="T:System.Net.WebPermission" />
        <altmember cref="T:System.Security.SecurityManager" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public XmlSecureResolver (System.Xml.XmlResolver resolver, System.Security.Policy.Evidence evidence);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Xml.XmlResolver resolver, class System.Security.Policy.Evidence evidence) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Xml.XmlSecureResolver.#ctor(System.Xml.XmlResolver,System.Security.Policy.Evidence)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; XmlSecureResolver(System::Xml::XmlResolver ^ resolver, System::Security::Policy::Evidence ^ evidence);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Xml</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="resolver" Type="System.Xml.XmlResolver" />
        <Parameter Name="evidence" Type="System.Security.Policy.Evidence" />
      </Parameters>
      <Docs>
        <param name="resolver">
          <span data-ttu-id="2ba8d-158">
            <see cref="T:System.Xml.XmlSecureResolver" /> 所包裝的 XML 解析程式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-158">The XML resolver that is wrapped by the <see cref="T:System.Xml.XmlSecureResolver" />.</span>
          </span>
        </param>
        <param name="evidence">
          <span data-ttu-id="2ba8d-159">用來建立 <see cref="T:System.Security.PermissionSet" /> 且將套用至基礎 <see cref="T:System.Xml.XmlResolver" /> 的辨識項。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-159">The evidence used to create the <see cref="T:System.Security.PermissionSet" /> that will be applied to the underlying <see cref="T:System.Xml.XmlResolver" />.</span>
          </span>
          <span data-ttu-id="2ba8d-160">
            <see cref="T:System.Xml.XmlSecureResolver" /> 會先呼叫已建立之 <see cref="T:System.Security.PermissionSet" /> 上的 <see cref="M:System.Security.PermissionSet.PermitOnly" /> 方法，然後才呼叫基礎 <see cref="T:System.Xml.XmlResolver" /> 上的 <see cref="M:System.Xml.XmlSecureResolver.GetEntity(System.Uri,System.String,System.Type)" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-160">The <see cref="T:System.Xml.XmlSecureResolver" /> calls the <see cref="M:System.Security.PermissionSet.PermitOnly" /> method on the created <see cref="T:System.Security.PermissionSet" /> before calling <see cref="M:System.Xml.XmlSecureResolver.GetEntity(System.Uri,System.String,System.Type)" /> on the underlying <see cref="T:System.Xml.XmlResolver" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="2ba8d-161">指定 <see cref="T:System.Xml.XmlResolver" /> 和 <see cref="T:System.Security.Policy.Evidence" /> 來初始化 <see cref="T:System.Xml.XmlSecureResolver" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-161">Initializes a new instance of the <see cref="T:System.Xml.XmlSecureResolver" /> class with the <see cref="T:System.Xml.XmlResolver" /> and <see cref="T:System.Security.Policy.Evidence" /> specified.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2ba8d-162">以下是一些可能的案例，以及每個案例所提供的辨識項型別：</span><span class="sxs-lookup"><span data-stu-id="2ba8d-162">Here are some possible scenarios and the type of evidence to provide for each scenario:</span></span>  
  
-   <span data-ttu-id="2ba8d-163">如果您使用完全信任的環境中，使用您的組件來建立辨識項：</span><span class="sxs-lookup"><span data-stu-id="2ba8d-163">If you are working in a fully trusted environment, use your assembly to create the evidence:</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#1](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#1)]
     [!code-vb[XmlSecureResolver_Samples#1](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#1)]  
  
-   <span data-ttu-id="2ba8d-164">如果您使用非完全信任環境中，您的程式碼或來自外部來源，且您知道外部來源的源頭和可驗證的 URI，請使用 URI 建立辨識項：</span><span class="sxs-lookup"><span data-stu-id="2ba8d-164">If you are working in a semi-trusted environment, you have code or data coming from an outside source, and you know the origin of the outside source and have a verifiable URI, use the URI to create the evidence:</span></span>  
  
     [!code-csharp[XmlSecureResolver_Samples#2](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#2)]
     [!code-vb[XmlSecureResolver_Samples#2](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#2)]  
  
-   <span data-ttu-id="2ba8d-165">如果您使用非完全信任的環境，而且您的程式碼或來自外部來源，但您不知道來源的外部來源，請：</span><span class="sxs-lookup"><span data-stu-id="2ba8d-165">If you are working in a semi-trusted environment and you have code or data coming from an outside source, but you don't know the origin of the outside source, either:</span></span>  
  
     <span data-ttu-id="2ba8d-166">將 `evidence` 參數設定為 `null`。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-166">Set the `evidence` parameter to `null`.</span></span> <span data-ttu-id="2ba8d-167">這可以拒絕對資源的任何存取。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-167">This allows no access to resources.</span></span>  
  
     <span data-ttu-id="2ba8d-168">-或-</span><span class="sxs-lookup"><span data-stu-id="2ba8d-168">-or-</span></span>  
  
     <span data-ttu-id="2ba8d-169">如果應用程式需要資源的某些存取權，請要求呼叫端的辨識項。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-169">If your application requires some access to resources, request evidence from the caller.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public XmlSecureResolver (System.Xml.XmlResolver resolver, string securityUrl);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Xml.XmlResolver resolver, string securityUrl) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Xml.XmlSecureResolver.#ctor(System.Xml.XmlResolver,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (resolver As XmlResolver, securityUrl As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; XmlSecureResolver(System::Xml::XmlResolver ^ resolver, System::String ^ securityUrl);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Xml</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Xml.ReaderWriter</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="resolver" Type="System.Xml.XmlResolver" />
        <Parameter Name="securityUrl" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="resolver">
          <span data-ttu-id="2ba8d-170">
            <see cref="T:System.Xml.XmlSecureResolver" /> 所包裝的 XML 解析程式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-170">The XML resolver that is wrapped by the <see cref="T:System.Xml.XmlSecureResolver" />.</span>
          </span>
        </param>
        <param name="securityUrl">
          <span data-ttu-id="2ba8d-171">用來建立將套用至基礎 <see cref="T:System.Xml.XmlResolver" /> 的 <see cref="T:System.Security.PermissionSet" /> 之 URL。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-171">The URL used to create the <see cref="T:System.Security.PermissionSet" /> that will be applied to the underlying <see cref="T:System.Xml.XmlResolver" />.</span>
          </span>
          <span data-ttu-id="2ba8d-172">
            <see cref="T:System.Xml.XmlSecureResolver" /> 會先呼叫已建立之 <see cref="T:System.Security.PermissionSet" /> 上的 <see cref="M:System.Security.PermissionSet.PermitOnly" />，然後才呼叫基礎 <see cref="T:System.Xml.XmlResolver" /> 上的 <see cref="M:System.Xml.XmlSecureResolver.GetEntity(System.Uri,System.String,System.Type)" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-172">The <see cref="T:System.Xml.XmlSecureResolver" /> calls <see cref="M:System.Security.PermissionSet.PermitOnly" /> on the created <see cref="T:System.Security.PermissionSet" /> before calling <see cref="M:System.Xml.XmlSecureResolver.GetEntity(System.Uri,System.String,System.Type)" /> on the underlying <see cref="T:System.Xml.XmlResolver" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="2ba8d-173">使用提供的 <see cref="T:System.Xml.XmlResolver" /> 和 URL，初始化 <see cref="T:System.Xml.XmlSecureResolver" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-173">Initializes a new instance of the <see cref="T:System.Xml.XmlSecureResolver" /> class with the <see cref="T:System.Xml.XmlResolver" /> and URL provided.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!IMPORTANT]
>  <span data-ttu-id="2ba8d-174">有一些安全性基礎結構在.NET Framework common language runtime (CLR) 上執行的程式碼和整合至 Microsoft SQL Server 2005 在 CLR 上執行的程式碼中的差異。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-174">There are differences in the security infrastructure for code running on the .NET Framework common language runtime (CLR) and for code running on the CLR that is integrated within Microsoft SQL Server 2005.</span></span> <span data-ttu-id="2ba8d-175">這可能會導致整合開發的.NET Framework CLR 的操作方式與在 SQL Server 上使用的程式碼 CLR 的情況下。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-175">This can lead to cases where code developed for the .NET Framework CLR operates differently when used on the SQL Server integrated CLR.</span></span> <span data-ttu-id="2ba8d-176">下列其中一種差異會影響<xref:System.Xml.XmlSecureResolver>類別時，您必須為基礎的 URL 辨識項 (也就是當您使用<xref:System.Xml.XmlSecureResolver.CreateEvidenceForUrl%2A>方法或<xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.String%29>建構函式)。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-176">One of these differences affects the <xref:System.Xml.XmlSecureResolver> class when you have evidence that is based on a URL (that is, when you use the <xref:System.Xml.XmlSecureResolver.CreateEvidenceForUrl%2A> method or the <xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.String%29> constructor).</span></span> <span data-ttu-id="2ba8d-177">原則解析的 SQL Server 的機制整合 CLR 不會使用<xref:System.Security.Policy.Url>或<xref:System.Security.Policy.Zone>資訊。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-177">The policy resolution mechanism of the SQL Server integrated CLR does not use the <xref:System.Security.Policy.Url> or <xref:System.Security.Policy.Zone> information.</span></span> <span data-ttu-id="2ba8d-178">相反地，它會授與組件載入時，伺服器會將新增 GUID 為基礎的權限。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-178">Instead, it grants permissions based on the GUID that the server adds when assemblies are loaded.</span></span> <span data-ttu-id="2ba8d-179">當您使用<xref:System.Xml.XmlSecureResolver>中 SQL Server 整合的 CLR，請提供直接透過使用指定的任何必要的辨識項<xref:System.Security.PermissionSet>。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-179">When you use the <xref:System.Xml.XmlSecureResolver> in the SQL Server integrated CLR, provide any required evidence directly by using a specified <xref:System.Security.PermissionSet>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2ba8d-180">這個範例會使用<xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.String%29>建構函式建立<xref:System.Xml.XmlSecureResolver>存取近端內部網路網站只允許的物件。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-180">This example uses the <xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.String%29> constructor to create an <xref:System.Xml.XmlSecureResolver> object that is allowed to access your local intranet site only.</span></span>  
  
 [!code-csharp[XmlSecureResolver_Samples#3](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver_Samples/CS/XmlSecureResolver_ex.cs#3)]
 [!code-vb[XmlSecureResolver_Samples#3](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver_Samples/VB/XmlSecureResolver_ex.vb#3)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CreateEvidenceForUrl">
      <MemberSignature Language="C#" Value="public static System.Security.Policy.Evidence CreateEvidenceForUrl (string securityUrl);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Security.Policy.Evidence CreateEvidenceForUrl(string securityUrl) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Xml.XmlSecureResolver.CreateEvidenceForUrl(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function CreateEvidenceForUrl (securityUrl As String) As Evidence" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Security::Policy::Evidence ^ CreateEvidenceForUrl(System::String ^ securityUrl);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Xml</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Security.Policy.Evidence</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="securityUrl" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="securityUrl">
          <span data-ttu-id="2ba8d-181">用來建立辨識項的 URL。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-181">The URL used to create the evidence.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="2ba8d-182">使用提供的 URL 建立辨識項。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-182">Creates evidence using the supplied URL.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="2ba8d-183">由提供的 URL 產生之辨識項，此 URL 由預設原則定義。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-183">The evidence generated from the supplied URL as defined by the default policy.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!IMPORTANT]
>  <span data-ttu-id="2ba8d-184">有一些安全性基礎結構在.NET Framework common language runtime (CLR) 上執行的程式碼和整合至 Microsoft SQL Server 2005 在 CLR 上執行的程式碼中的差異。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-184">There are differences in the security infrastructure for code running on the .NET Framework common language runtime (CLR) and for code running on the CLR that is integrated within Microsoft SQL Server 2005.</span></span> <span data-ttu-id="2ba8d-185">這可能會導致整合開發的.NET Framework CLR 的操作方式與在 SQL Server 上使用的程式碼 CLR 的情況下。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-185">This can lead to cases where code developed for the .NET Framework CLR operates differently when used on the SQL Server integrated CLR.</span></span> <span data-ttu-id="2ba8d-186">下列其中一種差異會影響<xref:System.Xml.XmlSecureResolver>類別時，您必須為基礎的 URL 辨識項 (也就是當您使用<xref:System.Xml.XmlSecureResolver.CreateEvidenceForUrl%2A>方法或<xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.String%29>建構函式)。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-186">One of these differences affects the <xref:System.Xml.XmlSecureResolver> class when you have evidence that is based on a URL (that is, when you use the <xref:System.Xml.XmlSecureResolver.CreateEvidenceForUrl%2A> method or the <xref:System.Xml.XmlSecureResolver.%23ctor%28System.Xml.XmlResolver%2CSystem.String%29> constructor).</span></span> <span data-ttu-id="2ba8d-187">原則不會使用解決機制的 SQL Server 整合的 CLR<xref:System.Security.Policy.Url>或<xref:System.Security.Policy.Zone>資訊。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-187">The policy resolution mechanism of the SQL Server integrated CLR doesn't use the <xref:System.Security.Policy.Url> or <xref:System.Security.Policy.Zone> information.</span></span> <span data-ttu-id="2ba8d-188">相反地，它會授與組件載入時，伺服器會將新增 GUID 為基礎的權限。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-188">Instead, it grants permissions based on the GUID that the server adds when assemblies are loaded.</span></span> <span data-ttu-id="2ba8d-189">當您使用<xref:System.Xml.XmlSecureResolver>中 SQL Server 整合的 CLR，請提供直接透過使用指定的任何必要的辨識項<xref:System.Security.PermissionSet>。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-189">When you use the <xref:System.Xml.XmlSecureResolver> in the SQL Server integrated CLR, provide any required evidence directly by using a specified <xref:System.Security.PermissionSet>.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Credentials">
      <MemberSignature Language="C#" Value="public override System.Net.ICredentials Credentials { set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Net.ICredentials Credentials" />
      <MemberSignature Language="DocId" Value="P:System.Xml.XmlSecureResolver.Credentials" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property Credentials As ICredentials" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::Net::ICredentials ^ Credentials {  void set(System::Net::ICredentials ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Xml</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Xml.ReaderWriter</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Net.ICredentials</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="2ba8d-190">設定用以驗證 Web 要求的認證資訊。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-190">Sets credentials used to authenticate web requests.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="2ba8d-191">用以驗證 Web 要求的認證。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-191">The credentials to be used to authenticate web requests.</span>
          </span>
          <span data-ttu-id="2ba8d-192">
            <see cref="T:System.Xml.XmlSecureResolver" /> 會在基礎 <see cref="T:System.Xml.XmlResolver" /> 上設定指定的認證。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-192">The <see cref="T:System.Xml.XmlSecureResolver" /> sets the given credentials on the underlying <see cref="T:System.Xml.XmlResolver" />.</span>
          </span>
          <span data-ttu-id="2ba8d-193">如果未設定這個屬性，其值會預設為 <see langword="null" />；也就是說，<see cref="T:System.Xml.XmlSecureResolver" /> 沒有使用者認證。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-193">If this property is not set, the value defaults to <see langword="null" />; that is, the <see cref="T:System.Xml.XmlSecureResolver" /> has no user credentials.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="2ba8d-194">下列範例會使用<xref:System.Xml.XmlSecureResolver>並解決，然後開啟所需的網路資源的預設認證<xref:System.Xml.XmlTextReader>。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-194">The following example uses an <xref:System.Xml.XmlSecureResolver> with default credentials to resolve and open network resources needed by the <xref:System.Xml.XmlTextReader>.</span></span>  
  
 [!code-cpp[XmlSecureResolver.Credentials#1](~/samples/snippets/cpp/VS_Snippets_Data/XmlSecureResolver.Credentials/CPP/secresolver2.cpp#1)]
 [!code-csharp[XmlSecureResolver.Credentials#1](~/samples/snippets/csharp/VS_Snippets_Data/XmlSecureResolver.Credentials/CS/secresolver2.cs#1)]
 [!code-vb[XmlSecureResolver.Credentials#1](~/samples/snippets/visualbasic/VS_Snippets_Data/XmlSecureResolver.Credentials/VB/secresolver2.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Net.NetworkCredential" />
        <altmember cref="T:System.Net.CredentialCache" />
        <altmember cref="P:System.Net.CredentialCache.DefaultCredentials" />
      </Docs>
    </Member>
    <Member MemberName="GetEntity">
      <MemberSignature Language="C#" Value="public override object GetEntity (Uri absoluteUri, string role, Type ofObjectToReturn);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance object GetEntity(class System.Uri absoluteUri, string role, class System.Type ofObjectToReturn) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Xml.XmlSecureResolver.GetEntity(System.Uri,System.String,System.Type)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetEntity (absoluteUri As Uri, role As String, ofObjectToReturn As Type) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Object ^ GetEntity(Uri ^ absoluteUri, System::String ^ role, Type ^ ofObjectToReturn);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Xml</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Xml.ReaderWriter</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="absoluteUri" Type="System.Uri" />
        <Parameter Name="role" Type="System.String" />
        <Parameter Name="ofObjectToReturn" Type="System.Type" />
      </Parameters>
      <Docs>
        <param name="absoluteUri">
          <span data-ttu-id="2ba8d-195">自 <see cref="M:System.Xml.XmlSecureResolver.ResolveUri(System.Uri,System.String)" /> 傳回的 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-195">The URI that is returned from <see cref="M:System.Xml.XmlSecureResolver.ResolveUri(System.Uri,System.String)" />.</span>
          </span>
        </param>
        <param name="role">
          <span data-ttu-id="2ba8d-196">目前未使用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-196">Currently not used.</span>
          </span>
        </param>
        <param name="ofObjectToReturn">
          <span data-ttu-id="2ba8d-197">要傳回的物件類型。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-197">The type of object to return.</span>
          </span>
          <span data-ttu-id="2ba8d-198">目前的版本只傳回 <see cref="T:System.IO.Stream" /> 物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-198">The current version only returns <see cref="T:System.IO.Stream" /> objects.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="2ba8d-199">對應 URI 至包含實際資源的物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-199">Maps a URI to an object that contains the actual resource.</span>
          </span>
          <span data-ttu-id="2ba8d-200">這個方法會呼叫基礎 <see cref="M:System.Security.PermissionSet.PermitOnly" /> 來暫時設定建立在建構函式上的 <see cref="T:System.Security.PermissionSet" />，然後才呼叫基礎 <see cref="T:System.Xml.XmlResolver" />上的 <see langword="GetEntity" /> 以開啟資源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-200">This method temporarily sets the <see cref="T:System.Security.PermissionSet" /> created in the constructor by calling <see cref="M:System.Security.PermissionSet.PermitOnly" /> before calling <see langword="GetEntity" /> on the underlying <see cref="T:System.Xml.XmlResolver" /> to open the resource.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="2ba8d-201">藉由呼叫基礎 <see cref="T:System.Xml.XmlResolver" /> 上的 <see langword="GetEntity" />，傳回資料流。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-201">The stream returned by calling <see langword="GetEntity" /> on the underlying <see cref="T:System.Xml.XmlResolver" />.</span>
          </span>
          <span data-ttu-id="2ba8d-202">若指定了非 <see cref="T:System.IO.Stream" /> 的類型，則方法會傳回 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-202">If a type other than <see cref="T:System.IO.Stream" /> is specified, the method returns <see langword="null" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!IMPORTANT]
>  <span data-ttu-id="2ba8d-203">您的應用程式可以降低記憶體阻斷服務威脅<xref:System.Xml.XmlSecureResolver.GetEntity%2A>方法藉由實作<xref:System.Runtime.InteropServices.ComTypes.IStream>，它會限制讀取的位元組數目。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-203">Your application can mitigate memory denial of service threats to the <xref:System.Xml.XmlSecureResolver.GetEntity%2A> method by implementing an <xref:System.Runtime.InteropServices.ComTypes.IStream> that limits the number of bytes read.</span></span> <span data-ttu-id="2ba8d-204">這有助於防範惡意程式碼嘗試傳遞無限的資料流的位元組的情況下<xref:System.Xml.XmlSecureResolver.GetEntity%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2ba8d-204">This helps guard against situations where malicious code attempts to pass an infinite stream of bytes to the <xref:System.Xml.XmlSecureResolver.GetEntity%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Xml.XmlException">
          <span data-ttu-id="2ba8d-205">
            <paramref name="ofObjectToReturn" /> 既不是 <see langword="null" /> 也不是 <see cref="T:System.IO.Stream" /> 型別。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-205">
              <paramref name="ofObjectToReturn" /> is neither <see langword="null" /> nor a <see cref="T:System.IO.Stream" /> type.</span>
          </span>
        </exception>
        <exception cref="T:System.UriFormatException">
          <span data-ttu-id="2ba8d-206">指定的 URI 並非絕對 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-206">The specified URI is not an absolute URI.</span>
          </span>
        </exception>
        <exception cref="T:System.NullReferenceException">
          <span data-ttu-id="2ba8d-207">
            <paramref name="absoluteUri" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-207">
              <paramref name="absoluteUri" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Exception">
          <span data-ttu-id="2ba8d-208">發生執行階段錯誤 (例如中斷的伺服器連線)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-208">There is a runtime error (for example, an interrupted server connection).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="GetEntityAsync">
      <MemberSignature Language="C#" Value="public override System.Threading.Tasks.Task&lt;object&gt; GetEntityAsync (Uri absoluteUri, string role, Type ofObjectToReturn);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Threading.Tasks.Task`1&lt;object&gt; GetEntityAsync(class System.Uri absoluteUri, string role, class System.Type ofObjectToReturn) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Xml.XmlSecureResolver.GetEntityAsync(System.Uri,System.String,System.Type)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetEntityAsync (absoluteUri As Uri, role As String, ofObjectToReturn As Type) As Task(Of Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Threading::Tasks::Task&lt;System::Object ^&gt; ^ GetEntityAsync(Uri ^ absoluteUri, System::String ^ role, Type ^ ofObjectToReturn);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Xml</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Xml.ReaderWriter</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task&lt;System.Object&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="absoluteUri" Type="System.Uri" />
        <Parameter Name="role" Type="System.String" />
        <Parameter Name="ofObjectToReturn" Type="System.Type" />
      </Parameters>
      <Docs>
        <param name="absoluteUri">
          <span data-ttu-id="2ba8d-209">自 <see cref="M:System.Xml.XmlSecureResolver.ResolveUri(System.Uri,System.String)" /> 傳回的 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-209">The URI returned from <see cref="M:System.Xml.XmlSecureResolver.ResolveUri(System.Uri,System.String)" />.</span>
          </span>
        </param>
        <param name="role">
          <span data-ttu-id="2ba8d-210">目前未使用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-210">Currently not used.</span>
          </span>
        </param>
        <param name="ofObjectToReturn">
          <span data-ttu-id="2ba8d-211">要傳回的物件類型。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-211">The type of object to return.</span>
          </span>
          <span data-ttu-id="2ba8d-212">目前的版本只傳回 <see cref="T:System.IO.Stream" /> 物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-212">The current version only returns <see cref="T:System.IO.Stream" /> objects.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="2ba8d-213">以非同步的方式對應 URI 至包含實際資源的物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-213">Asynchronously maps a URI to an object that contains the actual resource.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="2ba8d-214">藉由呼叫基礎 <see cref="T:System.Xml.XmlResolver" /> 上的 <see langword="GetEntity" />，傳回資料流。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-214">The stream returned by calling <see langword="GetEntity" /> on the underlying <see cref="T:System.Xml.XmlResolver" />.</span>
          </span>
          <span data-ttu-id="2ba8d-215">若指定了非 <see cref="T:System.IO.Stream" /> 的類型，則方法會傳回 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-215">If a type other than <see cref="T:System.IO.Stream" /> is specified, the method returns <see langword="null" />.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="ResolveUri">
      <MemberSignature Language="C#" Value="public override Uri ResolveUri (Uri baseUri, string relativeUri);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Uri ResolveUri(class System.Uri baseUri, string relativeUri) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Xml.XmlSecureResolver.ResolveUri(System.Uri,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ResolveUri (baseUri As Uri, relativeUri As String) As Uri" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override Uri ^ ResolveUri(Uri ^ baseUri, System::String ^ relativeUri);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Xml</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Xml.ReaderWriter</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Uri</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="baseUri" Type="System.Uri" />
        <Parameter Name="relativeUri" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="baseUri">
          <span data-ttu-id="2ba8d-216">用來解析相對 URI 的基底 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-216">The base URI used to resolve the relative URI.</span>
          </span>
        </param>
        <param name="relativeUri">
          <span data-ttu-id="2ba8d-217">要解析的 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-217">The URI to resolve.</span>
          </span>
          <span data-ttu-id="2ba8d-218">這個 URI 可為絕對或相對的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-218">The URI can be absolute or relative.</span>
          </span>
          <span data-ttu-id="2ba8d-219">若是絕對的，這個值實際上會取代 <c>baseUri</c> 值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-219">If absolute, this value effectively replaces the <c>baseUri</c> value.</span>
          </span>
          <span data-ttu-id="2ba8d-220">若是相對的，它會結合 <c>baseUri</c> 而成為絕對 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-220">If relative, it combines with the <c>baseUri</c> to make an absolute URI.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="2ba8d-221">藉由呼叫基礎 <see cref="T:System.Xml.XmlResolver" /> 上的 <see langword="ResolveUri" />，從基底和相對 URI 中解析絕對 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-221">Resolves the absolute URI from the base and relative URIs by calling <see langword="ResolveUri" /> on the underlying <see cref="T:System.Xml.XmlResolver" />.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="2ba8d-222">如果不能解析相對 URI (由呼叫基礎 <see cref="T:System.Xml.XmlResolver" /> 上的 <see langword="ResolveUri" /> 傳回)，則為絕對 URI 或 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-222">The absolute URI or <see langword="null" /> if the relative URI cannot be resolved (returned by calling <see langword="ResolveUri" /> on the underlying <see cref="T:System.Xml.XmlResolver" />).</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="2ba8d-223">
            <paramref name="relativeUri" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2ba8d-223">
              <paramref name="relativeUri" /> is <see langword="null" />.</span>
          </span>
        </exception>
      </Docs>
    </Member>
  </Members>
</Type>