<Type Name="Registry" FullName="Microsoft.Win32.Registry">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="a836e62065e5bc9b962cd825c6b31473d3442696" />
    <Meta Name="ms.sourcegitcommit" Value="0d6aa6694f157a08fe52cd25b4d9d3dcf913e812" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="10/12/2018" />
    <Meta Name="ms.locfileid" Value="49149174" />
  </Metadata>
  <TypeSignature Language="C#" Value="public static class Registry" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi abstract sealed beforefieldinit Registry extends System.Object" />
  <TypeSignature Language="DocId" Value="T:Microsoft.Win32.Registry" />
  <TypeSignature Language="VB.NET" Value="Public Class Registry" />
  <TypeSignature Language="C++ CLI" Value="public ref class Registry abstract sealed" />
  <TypeSignature Language="F#" Value="type Registry = class" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.1.1.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.Runtime.InteropServices.ComVisible(true)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="1f937-101">提供用於表示 Windows 登錄中根目錄機碼的 <see cref="T:Microsoft.Win32.RegistryKey" /> 物件，以及用於存取機碼/值組的 <see langword="static" /> 方法。</span>
      <span class="sxs-lookup">
        <span data-stu-id="1f937-101">Provides <see cref="T:Microsoft.Win32.RegistryKey" /> objects that represent the root keys in the Windows registry, and <see langword="static" /> methods to access key/value pairs.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-102">這個類別會提供標準的根目錄機碼在執行 Windows 的電腦上登錄中找到的集合。</span><span class="sxs-lookup"><span data-stu-id="1f937-102">This class provides the set of standard root keys found in the registry on machines running Windows.</span></span> <span data-ttu-id="1f937-103">登錄是儲存體設備，如需有關應用程式、 使用者和預設系統設定資訊。</span><span class="sxs-lookup"><span data-stu-id="1f937-103">The registry is a storage facility for information about applications, users, and default system settings.</span></span> <span data-ttu-id="1f937-104">比方說，應用程式可以使用登錄來儲存後關閉應用程式時，要保留所需的資訊，並重新載入應用程式時，存取相同的資訊。</span><span class="sxs-lookup"><span data-stu-id="1f937-104">For example, applications can use the registry for storing information that needs to be preserved after the application is closed, and access that same information when the application is reloaded.</span></span> <span data-ttu-id="1f937-105">比方說，您可以儲存色彩喜好設定、 螢幕位置或視窗的大小。</span><span class="sxs-lookup"><span data-stu-id="1f937-105">For instance, you can store color preferences, screen locations, or the size of the window.</span></span> <span data-ttu-id="1f937-106">您可以將資訊儲存在登錄中的不同位置，來控制每一位使用者的這項資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-106">You can control this data for each user by storing the information in a different location in the registry.</span></span>  
  
 <span data-ttu-id="1f937-107">基底或根<xref:Microsoft.Win32.RegistryKey>所公開的執行個體`Registry`類別描述子機碼和登錄中的值的基本儲存體機制。</span><span class="sxs-lookup"><span data-stu-id="1f937-107">The base, or root <xref:Microsoft.Win32.RegistryKey> instances that are exposed by the `Registry` class delineate the basic storage mechanism for subkeys and values in the registry.</span></span> <span data-ttu-id="1f937-108">所有索引鍵是唯讀的因為登錄取決於它們的存在。</span><span class="sxs-lookup"><span data-stu-id="1f937-108">All keys are read-only because the registry depends on their existence.</span></span> <span data-ttu-id="1f937-109">所公開的索引鍵`Registry`是：</span><span class="sxs-lookup"><span data-stu-id="1f937-109">The keys exposed by `Registry` are:</span></span>  
  
 <xref:Microsoft.Win32.Registry.CurrentUser>  
 <span data-ttu-id="1f937-110">儲存使用者喜好設定相關資訊。</span><span class="sxs-lookup"><span data-stu-id="1f937-110">Stores information about user preferences.</span></span>  
  
 <xref:Microsoft.Win32.Registry.LocalMachine>  
 <span data-ttu-id="1f937-111">會儲存在本機電腦的組態資訊。</span><span class="sxs-lookup"><span data-stu-id="1f937-111">Stores configuration information for the local machine.</span></span>  
  
 <xref:Microsoft.Win32.Registry.ClassesRoot>  
 <span data-ttu-id="1f937-112">儲存類型 （和類別） 的相關資訊和其屬性。</span><span class="sxs-lookup"><span data-stu-id="1f937-112">Stores information about types (and classes) and their properties.</span></span>  
  
 <xref:Microsoft.Win32.Registry.Users>  
 <span data-ttu-id="1f937-113">儲存預設使用者設定的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="1f937-113">Stores information about the default user configuration.</span></span>  
  
 <xref:Microsoft.Win32.Registry.PerformanceData>  
 <span data-ttu-id="1f937-114">儲存軟體元件的效能資訊。</span><span class="sxs-lookup"><span data-stu-id="1f937-114">Stores performance information for software components.</span></span>  
  
 <xref:Microsoft.Win32.Registry.CurrentConfig>  
 <span data-ttu-id="1f937-115">儲存非使用者特定的硬體資訊。</span><span class="sxs-lookup"><span data-stu-id="1f937-115">Stores non-user-specific hardware information.</span></span>  
  
 <xref:Microsoft.Win32.Registry.DynData>  
 <span data-ttu-id="1f937-116">儲存動態資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-116">Stores dynamic data.</span></span>  
  
 <span data-ttu-id="1f937-117">一旦您已識別您想要儲存/擷取資訊從登錄所在的根目錄機碼，您可以使用<xref:Microsoft.Win32.RegistryKey>類別來新增或移除子機碼，並操作指定的索引鍵的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-117">Once you have identified the root key under which you want to store/retrieve information from the registry, you can use the <xref:Microsoft.Win32.RegistryKey> class to add or remove subkeys, and manipulate the values for a given key.</span></span>  
  
 <span data-ttu-id="1f937-118">硬體裝置可以將資訊放在登錄中自動使用隨插即用介面。</span><span class="sxs-lookup"><span data-stu-id="1f937-118">Hardware devices can place information in the registry automatically using the Plug and Play interface.</span></span> <span data-ttu-id="1f937-119">安裝裝置驅動程式軟體可以將資訊放在登錄中，藉由將寫入標準的 Api。</span><span class="sxs-lookup"><span data-stu-id="1f937-119">Software for installing device drivers can place information in the registry by writing to standard APIs.</span></span>  
  
## <a name="static-methods-for-getting-and-setting-values"></a><span data-ttu-id="1f937-120">取得和設定值的靜態方法</span><span class="sxs-lookup"><span data-stu-id="1f937-120">Static Methods for Getting and Setting Values</span></span>  
 <span data-ttu-id="1f937-121">在.NET Framework 2.0 版中，<xref:Microsoft.Win32.Registry>類別也包含`static`<xref:Microsoft.Win32.Registry.GetValue%2A>和<xref:Microsoft.Win32.Registry.SetValue%2A>方法來設定和擷取登錄機碼的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-121">In the .NET Framework version 2.0, the <xref:Microsoft.Win32.Registry> class also contains `static`<xref:Microsoft.Win32.Registry.GetValue%2A> and <xref:Microsoft.Win32.Registry.SetValue%2A> methods for setting and retrieving values from registry keys.</span></span> <span data-ttu-id="1f937-122">這些方法都會開啟和關閉的登錄機碼每個使用，因此不會執行的時間，以及類似的方法，在<xref:Microsoft.Win32.RegistryKey>類別，當您存取大量的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-122">These methods open and close registry keys each time they are used, so they do not perform as well as analogous methods in the <xref:Microsoft.Win32.RegistryKey> class, when you access a large number of values.</span></span>  
  
 <span data-ttu-id="1f937-123"><xref:Microsoft.Win32.RegistryKey>類別也會提供方法，可讓您設定 Windows 登錄機碼，然後才能擷取它，測試值的資料類型，以及刪除金鑰的存取控制安全性。</span><span class="sxs-lookup"><span data-stu-id="1f937-123">The <xref:Microsoft.Win32.RegistryKey> class also provides methods that allow you to set Windows access control security for registry keys, to test the data type of a value before retrieving it, and to delete keys.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-124">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="1f937-124">This section contains two code examples.</span></span> <span data-ttu-id="1f937-125">第一個範例示範根目錄機碼，以及第二個範例示範`static`<xref:Microsoft.Win32.Registry.GetValue%2A>和<xref:Microsoft.Win32.Registry.SetValue%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="1f937-125">The first example demonstrates root keys, and the second example demonstrates the `static`<xref:Microsoft.Win32.Registry.GetValue%2A> and <xref:Microsoft.Win32.Registry.SetValue%2A> methods.</span></span>  
  
 <span data-ttu-id="1f937-126">範例 1</span><span class="sxs-lookup"><span data-stu-id="1f937-126">Example 1</span></span>  
  
 <span data-ttu-id="1f937-127">下列程式碼範例示範如何擷取的子機碼 HKEY_USERS 機碼，並列印其名稱到螢幕。</span><span class="sxs-lookup"><span data-stu-id="1f937-127">The following code example demonstrates how to retrieve the subkeys of the HKEY_USERS key, and print their names to the screen.</span></span> <span data-ttu-id="1f937-128">使用<xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A>方法用來建立感興趣的特定子機碼的執行個體。</span><span class="sxs-lookup"><span data-stu-id="1f937-128">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="1f937-129">然後，您可以使用中的其他作業`RegistryKey`操作該索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-129">You can then use other operations in `RegistryKey` to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.Users Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.Users Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.Users Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.Users Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.Users Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.Users Example/VB/source.vb#1)]  
  
 <span data-ttu-id="1f937-130">範例 2</span><span class="sxs-lookup"><span data-stu-id="1f937-130">Example 2</span></span>  
  
 <span data-ttu-id="1f937-131">下列程式碼範例會將數個資料類型的值儲存在範例機碼，建立金鑰，因為它在這麼做，然後擷取並顯示的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-131">The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values.</span></span> <span data-ttu-id="1f937-132">此範例示範如何儲存和擷取的預設值 （無名） 的名稱/值組，以及使用`defaultValue`名稱/值組不存在的時。</span><span class="sxs-lookup"><span data-stu-id="1f937-132">The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of `defaultValue` when a name/value pair does not exist.</span></span>  
  
 [!code-cpp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/cpp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CPP/source.cpp#1)]
 [!code-csharp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/csharp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CS/source.cs#1)]
 [!code-vb[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:Microsoft.Win32.RegistryHive" />
    <altmember cref="T:Microsoft.Win32.RegistryKey" />
  </Docs>
  <Members>
    <Member MemberName="ClassesRoot">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey ClassesRoot;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey ClassesRoot" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.ClassesRoot" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly ClassesRoot As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ ClassesRoot;" />
      <MemberSignature Language="F#" Value=" staticval mutable ClassesRoot : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.ClassesRoot" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="1f937-133">定義文件的型別 (或類別) 以及與型別相關聯的屬性。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-133">Defines the types (or classes) of documents and the properties associated with those types.</span>
          </span>
          <span data-ttu-id="1f937-134">這個欄位會讀取 Windows 登錄主要機碼 HKEY_CLASSES_ROOT。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-134">This field reads the Windows registry base key HKEY_CLASSES_ROOT.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-135">傳統的應用程式和 OLE 應用程式使用此機碼下儲存的資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-135">Both conventional applications and OLE applications use data that is stored under this key.</span></span> <span data-ttu-id="1f937-136">此機碼也會提供回溯相容性 Windows 3.1 註冊資料庫儲存 DDE 和 OLE 支援資訊。</span><span class="sxs-lookup"><span data-stu-id="1f937-136">This key also provides backward compatibility with the Windows 3.1 registration database by storing information for DDE and OLE support.</span></span> <span data-ttu-id="1f937-137">檔案檢視器和使用者介面擴充功能的 OLE 類別識別碼則會在此機碼，儲存和處理伺服器都登錄在此機碼。</span><span class="sxs-lookup"><span data-stu-id="1f937-137">File viewers and user interface extensions store their OLE class identifiers in this key, and processing servers are registered in this key.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-138">下列範例示範如何擷取此機碼中的子機碼，並列印其名稱到螢幕。</span><span class="sxs-lookup"><span data-stu-id="1f937-138">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="1f937-139">使用<xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A>方法用來建立感興趣的特定子機碼的執行個體。</span><span class="sxs-lookup"><span data-stu-id="1f937-139">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="1f937-140">然後，您可以使用中的其他作業<xref:Microsoft.Win32.RegistryKey>操作該索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-140">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.ClassesRoot Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.ClassesRoot Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.ClassesRoot Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.ClassesRoot Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.ClassesRoot Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.ClassesRoot Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CurrentConfig">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey CurrentConfig;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey CurrentConfig" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.CurrentConfig" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly CurrentConfig As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ CurrentConfig;" />
      <MemberSignature Language="F#" Value=" staticval mutable CurrentConfig : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.CurrentConfig" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="1f937-141">包含非針對特定使用者的硬體相關組態資訊。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-141">Contains configuration information pertaining to the hardware that is not specific to the user.</span>
          </span>
          <span data-ttu-id="1f937-142">這個欄位會讀取 Windows 登錄主要機碼 HKEY_CURRENT_CONFIG。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-142">This field reads the Windows registry base key HKEY_CURRENT_CONFIG.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-143">這個成員會對應到內的子機碼<xref:Microsoft.Win32.Registry.LocalMachine>。</span><span class="sxs-lookup"><span data-stu-id="1f937-143">This member is mapped to a subkey within <xref:Microsoft.Win32.Registry.LocalMachine>.</span></span>  
  
 <span data-ttu-id="1f937-144">使用這個成員的範例是儲存不同的伺服器名稱，其資料，根據系統是否連接到網路的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1f937-144">An example of using this member is an application that stores a different server name for its data depending on whether the system is attached to a network.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-145">下列範例示範如何擷取此機碼中的子機碼，並列印其名稱到螢幕。</span><span class="sxs-lookup"><span data-stu-id="1f937-145">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="1f937-146">使用<xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A>方法用來建立感興趣的特定子機碼的執行個體。</span><span class="sxs-lookup"><span data-stu-id="1f937-146">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="1f937-147">然後，您可以使用中的其他作業<xref:Microsoft.Win32.RegistryKey>操作該索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-147">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.CurrentConfig Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.CurrentConfig Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.CurrentConfig Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.CurrentConfig Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.CurrentConfig Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.CurrentConfig Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CurrentUser">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey CurrentUser;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey CurrentUser" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.CurrentUser" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly CurrentUser As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ CurrentUser;" />
      <MemberSignature Language="F#" Value=" staticval mutable CurrentUser : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.CurrentUser" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="1f937-148">包含有關目前使用者喜好設定的資訊。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-148">Contains information about the current user preferences.</span>
          </span>
          <span data-ttu-id="1f937-149">這個欄位會讀取 Windows 登錄主要機碼 HKEY_CURRENT_USER。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-149">This field reads the Windows registry base key HKEY_CURRENT_USER</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-150">此機碼中儲存的資訊包括環境變數和程式群組、 色彩、 印表機、 網路連線和應用程式喜好設定的相關資料的設定。</span><span class="sxs-lookup"><span data-stu-id="1f937-150">Information stored in this key includes the settings of environment variables and data about program groups, colors, printers, network connections, and application preferences.</span></span> <span data-ttu-id="1f937-151">此金鑰可讓您更輕鬆地建立目前使用者的設定。</span><span class="sxs-lookup"><span data-stu-id="1f937-151">This key makes it easier to establish the current user's settings.</span></span> <span data-ttu-id="1f937-152">在此機碼中，軟體廠商會儲存在其應用程式要使用的目前使用者特定喜好設定。</span><span class="sxs-lookup"><span data-stu-id="1f937-152">In this key, software vendors store the current user-specific preferences to be used within their applications.</span></span> <span data-ttu-id="1f937-153">比方說，Microsoft，就會建立其應用程式以搭配每個應用程式，建立自己的子機碼，Microsoft 機碼下 HKEY_CURRENT_USER\Software\Microsoft 機碼。</span><span class="sxs-lookup"><span data-stu-id="1f937-153">Microsoft, for example, creates the HKEY_CURRENT_USER\Software\Microsoft key for its applications to use, with each application creating its own subkey under the Microsoft key.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-154">下列範例示範如何擷取此機碼中的子機碼，並列印其名稱到螢幕。</span><span class="sxs-lookup"><span data-stu-id="1f937-154">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="1f937-155">使用<xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A>方法用來建立感興趣的特定子機碼的執行個體。</span><span class="sxs-lookup"><span data-stu-id="1f937-155">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="1f937-156">然後，您可以使用中的其他作業<xref:Microsoft.Win32.RegistryKey>操作該索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-156">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.CurrentUser Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.CurrentUser Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.CurrentUser Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.CurrentUser Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.CurrentUser Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.CurrentUser Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="DynData">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey DynData;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey DynData" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.DynData" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly DynData As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ DynData;" />
      <MemberSignature Language="F#" Value=" staticval mutable DynData : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.DynData" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0">
          <AttributeName>System.Obsolete("Use PerformanceData instead")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("The DynData registry key only works on Win9x, which is no longer supported by the CLR.  On NT-based operating systems, use the PerformanceData registry key instead.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="1f937-157">包含動態登錄資料。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-157">Contains dynamic registry data.</span>
          </span>
          <span data-ttu-id="1f937-158">這個欄位會讀取 Windows 登錄主要機碼 HKEY_DYN_DATA。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-158">This field reads the Windows registry base key HKEY_DYN_DATA.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-159">Windows 98/Windows Me 登錄支援靜態資料 （也就儲存在登錄中的磁碟上） 和動態的資料 （但經常變更，例如效能統計資料）。</span><span class="sxs-lookup"><span data-stu-id="1f937-159">The Windows 98/Windows Me registry supports both static data (which is stored on disk in the registry) and dynamic data (which changes frequently, such as performance statistics).</span></span> <span data-ttu-id="1f937-160">這個動態的資料區域是從遠端同時在本機執行的 Win32 應用程式可讓虛擬裝置驅動程式 (Vxd)，以提供即時資料的機制。</span><span class="sxs-lookup"><span data-stu-id="1f937-160">This dynamic data area is the mechanism that allows Virtual Device Drivers (VxDs) to provide real-time data to Win32 applications that can run remotely as well as locally.</span></span> <span data-ttu-id="1f937-161">它也可讓系統監視器 」 來提供 Windows 98/Windows 我在遠端系統上的效能統計資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-161">It also allows the system monitor to provide performance statistics on remote Windows 98/Windows Me systems.</span></span>  
  
 <span data-ttu-id="1f937-162">Vxd 不限於效能資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-162">VxDs are not limited to performance data.</span></span> <span data-ttu-id="1f937-163">它們可以提供他們想要傳遞從 Ring 0 至 Ring 3 有效率而不獨佔 CPU 的任何資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-163">They can provide any data they want to pass from Ring 0 to Ring 3 efficiently without monopolizing the CPU.</span></span> <span data-ttu-id="1f937-164">登錄會儲存傳回值 （或許多值） 的函式的指標，以支援動態資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-164">The registry supports dynamic data by storing a pointer to a function that returns a value (or many values).</span></span> <span data-ttu-id="1f937-165">當查詢值的登錄呼叫動態索引鍵相關聯，呼叫函式可傳回的所需的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-165">When a Registry call queries values associated with a dynamic key, that function is called to return the desired value or values.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-166">有了動態金鑰是導入在 Microsoft Windows 95 中處理動態登錄資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-166">Dynamic keys were introduced in Microsoft Windows 95 to handle dynamic Registry data.</span></span> <span data-ttu-id="1f937-167">它們只是在 Windows 98/Windows me 中支援</span><span class="sxs-lookup"><span data-stu-id="1f937-167">They are supported only in Windows 98/Windows Me.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-168">下列範例示範如何擷取此機碼中的子機碼，並列印其名稱到螢幕。</span><span class="sxs-lookup"><span data-stu-id="1f937-168">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="1f937-169">使用<xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A>方法用來建立感興趣的特定子機碼的執行個體。</span><span class="sxs-lookup"><span data-stu-id="1f937-169">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="1f937-170">然後，您可以使用中的其他作業<xref:Microsoft.Win32.RegistryKey>操作該索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-170">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span> <span data-ttu-id="1f937-171">請注意，此範例可以傳回任何結果，因為有可能不是動態的資料可用，或者您可能不在執行 Windows 98 / 分享。</span><span class="sxs-lookup"><span data-stu-id="1f937-171">Note that this example can return no results, since there might not be dynamic data available, or you might not be running Windows 98/ME.</span></span> <span data-ttu-id="1f937-172">使用此金鑰，可能會在其他系統上造成錯誤。</span><span class="sxs-lookup"><span data-stu-id="1f937-172">Using this key may cause an error on other systems.</span></span>  
  
 [!code-cpp[Classic Registry.DynData Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.DynData Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.DynData Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.DynData Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.DynData Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.DynData Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ObjectDisposedException">
          <span data-ttu-id="1f937-173">作業系統不支援動態資料；也就是說，它不是 Windows 98、Windows 98 Second Edition 或 Windows Millennium Edition (Windows Me)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-173">The operating system does not support dynamic data; that is, it is not Windows 98, Windows 98 Second Edition, or Windows Millennium Edition (Windows Me).</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="GetValue">
      <MemberSignature Language="C#" Value="public static object GetValue (string keyName, string valueName, object defaultValue);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig object GetValue(string keyName, string valueName, object defaultValue) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.Win32.Registry.GetValue(System.String,System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetValue (keyName As String, valueName As String, defaultValue As Object) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ GetValue(System::String ^ keyName, System::String ^ valueName, System::Object ^ defaultValue);" />
      <MemberSignature Language="F#" Value="static member GetValue : string * string * obj -&gt; obj" Usage="Microsoft.Win32.Registry.GetValue (keyName, valueName, defaultValue)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="keyName" Type="System.String" />
        <Parameter Name="valueName" Type="System.String" />
        <Parameter Name="defaultValue" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="keyName">
          <span data-ttu-id="1f937-174">機碼的完整登錄路徑，以有效登錄根目錄開頭 (例如 "HKEY_CURRENT_USER")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-174">The full registry path of the key, beginning with a valid registry root, such as "HKEY_CURRENT_USER".</span>
          </span>
        </param>
        <param name="valueName">
          <span data-ttu-id="1f937-175">名稱/值組的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-175">The name of the name/value pair.</span>
          </span>
        </param>
        <param name="defaultValue">
          <span data-ttu-id="1f937-176">
            <c>valueName</c> 不存在時所傳回的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-176">The value to return if <c>valueName</c> does not exist.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="1f937-177">在指定的登錄機碼中，擷取與所指定名稱關聯的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-177">Retrieves the value associated with the specified name, in the specified registry key.</span>
          </span>
          <span data-ttu-id="1f937-178">如果在指定的機碼中找不到該名稱，則會傳回提供的預設值；如果指定的機碼不存在，則傳回 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-178">If the name is not found in the specified key, returns a default value that you provide, or <see langword="null" /> if the specified key does not exist.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="1f937-179">如果 <paramref name="keyName" /> 指定的子機碼不存在，則為 <see langword="null" />，否則為與 <paramref name="valueName" /> 關聯的值；如果找不到 <paramref name="defaultValue" />，則為 <paramref name="valueName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-179">
              <see langword="null" /> if the subkey specified by <paramref name="keyName" /> does not exist; otherwise, the value associated with <paramref name="valueName" />, or <paramref name="defaultValue" /> if <paramref name="valueName" /> is not found.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-180">字串`valueName`不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="1f937-180">The string `valueName` is not case-sensitive.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-181">登錄機碼可以包含一個不是任何名稱相關聯的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-181">A registry key can contain one value that is not associated with any name.</span></span> <span data-ttu-id="1f937-182">當這個未命名的值顯示在登錄編輯程式中時，字串 「 （預設） 」 會出現而不是名稱。</span><span class="sxs-lookup"><span data-stu-id="1f937-182">When this unnamed value is displayed in the registry editor, the string "(Default)" appears instead of a name.</span></span> <span data-ttu-id="1f937-183">若要擷取這個未命名的值，指定`null`或空字串 ("") 的`valuName`。</span><span class="sxs-lookup"><span data-stu-id="1f937-183">To retrieve this unnamed value, specify either `null` or the empty string ("") for `valuName`.</span></span>  
  
 <span data-ttu-id="1f937-184">有效的根名稱是 HKEY_CURRENT_USER 中，HKEY_LOCAL_MACHINE、 HKEY_CLASSES_ROOT、 HKEY_USERS、 HKEY_PERFORMANCE_DATA、 機碼 HKEY_CURRENT_CONFIG 和機碼 HKEY_DYN_DATA。</span><span class="sxs-lookup"><span data-stu-id="1f937-184">Valid root names are HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA.</span></span> <span data-ttu-id="1f937-185">比方說，在 Visual Basic 中的字串"HKEY_CURRENT_USER\MyTestKey 「 存取子機碼"MyTestKey 」 在 HKEY_CURRENT_USER 根目錄中的索引鍵/值組。</span><span class="sxs-lookup"><span data-stu-id="1f937-185">For example, in Visual Basic the string "HKEY_CURRENT_USER\MyTestKey" accesses key/value pairs for the subkey "MyTestKey" in the HKEY_CURRENT_USER root.</span></span>  
  
 <span data-ttu-id="1f937-186">當<xref:Microsoft.Win32.RegistryKey.GetValue%2A>方法會擷取可展開的字串值 (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>)，它會展開環境字串使用本機的環境中的資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-186">When the <xref:Microsoft.Win32.RegistryKey.GetValue%2A> method retrieves expandable string values (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>), it expands environment strings using data from the local environment.</span></span> <span data-ttu-id="1f937-187">如果已儲存為字串的值，包含可展開環境變數參考 (<xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType>)，而不是可擴充的字串 (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>)，<xref:Microsoft.Win32.RegistryKey.GetValue%2A>不會展開。</span><span class="sxs-lookup"><span data-stu-id="1f937-187">If a value containing expandable references to environment variables has been stored as a string (<xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType>), rather than as an expandable string (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>), <xref:Microsoft.Win32.RegistryKey.GetValue%2A> does not expand it.</span></span> <span data-ttu-id="1f937-188">已擷取透過呼叫之後，您可以展開此類字串<xref:System.Environment.ExpandEnvironmentVariables%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="1f937-188">You can expand such a string after it has been retrieved by calling the <xref:System.Environment.ExpandEnvironmentVariables%2A?displayProperty=nameWithType> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-189">從 HKEY_PERFORMANCE_DATA 擷取資料的建議的方式是使用<xref:System.Diagnostics.PerformanceCounter>類別而非<xref:Microsoft.Win32.RegistryKey.GetValue%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="1f937-189">The recommended way to retrieve data from HKEY_PERFORMANCE_DATA is to use the <xref:System.Diagnostics.PerformanceCounter> class rather than the <xref:Microsoft.Win32.RegistryKey.GetValue%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="1f937-190"><xref:Microsoft.Win32.Registry.GetValue%2A>並<xref:Microsoft.Win32.Registry.SetValue%2A>方法都會開啟和關閉的登錄機碼每次使用，因此不會執行，以及方法<xref:Microsoft.Win32.RegistryKey>類別，如果您在存取大量的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-190">The <xref:Microsoft.Win32.Registry.GetValue%2A> and <xref:Microsoft.Win32.Registry.SetValue%2A> methods open and close registry keys each time they are used, so they do not perform as well as the methods of the <xref:Microsoft.Win32.RegistryKey> class if you access a large number of values.</span></span>  
  
 <span data-ttu-id="1f937-191"><xref:Microsoft.Win32.RegistryKey> 也提供方法，可讓您將存取控制清單 (ACL) 新增至登錄機碼，然後才能擷取它，測試值的資料類型，並刪除索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-191"><xref:Microsoft.Win32.RegistryKey> also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-192">下列程式碼範例會將數個資料類型的值儲存在範例機碼，建立金鑰，因為它在這麼做，然後擷取並顯示的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-192">The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values.</span></span> <span data-ttu-id="1f937-193">此範例示範如何儲存和擷取的預設值 （無名） 的名稱/值組，以及使用`defaultValue`名稱/值組不存在的時。</span><span class="sxs-lookup"><span data-stu-id="1f937-193">The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of `defaultValue` when a name/value pair does not exist.</span></span>  
  
 [!code-cpp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/cpp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CPP/source.cpp#1)]
 [!code-csharp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/csharp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CS/source.cs#1)]
 [!code-vb[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="1f937-194">使用者沒有讀取登錄機碼所需的使用權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-194">The user does not have the permissions required to read from the registry key.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="1f937-195">包含指定值的 <see cref="T:Microsoft.Win32.RegistryKey" /> 已標記為刪除。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-195">The <see cref="T:Microsoft.Win32.RegistryKey" /> that contains the specified value has been marked for deletion.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="1f937-196">
            <paramref name="keyName" /> 不是以有效的登錄根目錄開頭。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-196">
              <paramref name="keyName" /> does not begin with a valid registry root.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.RegistryPermission">
          <span data-ttu-id="1f937-197">若要從登錄讀取。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-197">to read from the registry.</span>
          </span>
          <span data-ttu-id="1f937-198">相關聯的列舉型別： <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-198">Associated enumeration: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission">
          <span data-ttu-id="1f937-199">讀取REG_EXPAND_SZ類型的註冊表項。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-199">to read a registry key of type REG_EXPAND_SZ.</span>
          </span>
          <span data-ttu-id="1f937-200">相關聯的列舉型別： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-200">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
      </Docs>
    </Member>
    <Member MemberName="LocalMachine">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey LocalMachine;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey LocalMachine" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.LocalMachine" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly LocalMachine As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ LocalMachine;" />
      <MemberSignature Language="F#" Value=" staticval mutable LocalMachine : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.LocalMachine" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="1f937-201">包含本機電腦的組態資料。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-201">Contains the configuration data for the local machine.</span>
          </span>
          <span data-ttu-id="1f937-202">這個欄位會讀取 Windows 登錄主要機碼 HKEY_LOCAL_MACHINE。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-202">This field reads the Windows registry base key HKEY_LOCAL_MACHINE.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-203">`LocalMachine` 包含五個索引鍵：</span><span class="sxs-lookup"><span data-stu-id="1f937-203">`LocalMachine` contains five keys:</span></span>  
  
 <span data-ttu-id="1f937-204">硬體</span><span class="sxs-lookup"><span data-stu-id="1f937-204">Hardware</span></span>  
 <span data-ttu-id="1f937-205">描述在 [電腦] 的實體硬體裝置驅動程式會使用該硬體，並對應和連結以使用者模式程式碼的核心模式驅動程式的相關的資料的方式。</span><span class="sxs-lookup"><span data-stu-id="1f937-205">Describes the physical hardware in the computer, the way device drivers use that hardware, and mappings and related data that link kernel-mode drivers with user-mode code.</span></span> <span data-ttu-id="1f937-206">此機碼中的所有資料會重新都建立每次啟動系統時。</span><span class="sxs-lookup"><span data-stu-id="1f937-206">All data in this key is recreated each time the system is started.</span></span> <span data-ttu-id="1f937-207">在描述子機碼描述實際的電腦硬體。</span><span class="sxs-lookup"><span data-stu-id="1f937-207">The Description subkey describes the actual computer hardware.</span></span> <span data-ttu-id="1f937-208">DeviceMap 子機碼包含格式特定類別的驅動程式特有的其他資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-208">The DeviceMap subkey contains miscellaneous data in formats specific to particular classes of drivers.</span></span> <span data-ttu-id="1f937-209">ResourceMap 子機碼告訴您哪些裝置驅動程式宣告的硬體資源。</span><span class="sxs-lookup"><span data-stu-id="1f937-209">The ResourceMap subkey describes which device drivers claim which hardware resources.</span></span> <span data-ttu-id="1f937-210">Windows NT 診斷程式 (Winmsdp.exe) 可以報告其內容以容易閱讀的格式。</span><span class="sxs-lookup"><span data-stu-id="1f937-210">The Windows NT Diagnostics program (Winmsdp.exe) can report on its contents in an easy-to-read form.</span></span>  
  
 <span data-ttu-id="1f937-211">SAM</span><span class="sxs-lookup"><span data-stu-id="1f937-211">SAM</span></span>  
 <span data-ttu-id="1f937-212">目錄服務資料庫的使用者和群組帳戶，以及 Windows 2000 Server 中的定義域的安全性資訊 （SAM 是安全性帳戶管理員，稱為 「 目錄服務 」 資料庫）。</span><span class="sxs-lookup"><span data-stu-id="1f937-212">The directory services database of security information for user and group accounts, and for the domains in Windows 2000 Server (SAM is the Security Account Manager, known as the directory services database).</span></span>  
  
 <span data-ttu-id="1f937-213">安全性</span><span class="sxs-lookup"><span data-stu-id="1f937-213">Security</span></span>  
 <span data-ttu-id="1f937-214">包含的本機安全性原則，例如特定的使用者權限。</span><span class="sxs-lookup"><span data-stu-id="1f937-214">Contains the local security policy, such as specific user rights.</span></span> <span data-ttu-id="1f937-215">Windows 2000 安全性子系統只會使用此金鑰。</span><span class="sxs-lookup"><span data-stu-id="1f937-215">This key is used only by the Windows 2000 security subsystem.</span></span>  
  
 <span data-ttu-id="1f937-216">軟體</span><span class="sxs-lookup"><span data-stu-id="1f937-216">Software</span></span>  
 <span data-ttu-id="1f937-217">每部電腦軟體的資料庫。</span><span class="sxs-lookup"><span data-stu-id="1f937-217">The per-computer software database.</span></span> <span data-ttu-id="1f937-218">此金鑰包含在本機電腦，以及其他組態資料的各種項目上安裝軟體的相關資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-218">This key contains data about software installed on the local computer, along with various items of miscellaneous configuration data.</span></span>  
  
 <span data-ttu-id="1f937-219">系統</span><span class="sxs-lookup"><span data-stu-id="1f937-219">System</span></span>  
 <span data-ttu-id="1f937-220">控制系統啟動、 裝置驅動程式的載入、 Windows 2000 服務和作業系統的行為。</span><span class="sxs-lookup"><span data-stu-id="1f937-220">Controls system startup, device driver loading, Windows 2000 services, and operating system behavior.</span></span>  
  
 <span data-ttu-id="1f937-221">依照慣例，如果下的類似資料存在<xref:Microsoft.Win32.Registry.CurrentUser>歲<xref:Microsoft.Win32.Registry.LocalMachine>中的資料<xref:Microsoft.Win32.Registry.CurrentUser>會優先使用。</span><span class="sxs-lookup"><span data-stu-id="1f937-221">By convention, if similar data exists under <xref:Microsoft.Win32.Registry.CurrentUser> and under <xref:Microsoft.Win32.Registry.LocalMachine>, the data in <xref:Microsoft.Win32.Registry.CurrentUser> takes precedence.</span></span> <span data-ttu-id="1f937-222">不過，在此機碼的值可以也延伸 （而非取代） Registry.LocalMachine 中的資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-222">However, values in this key can also extend (rather than replace) data in Registry.LocalMachine.</span></span> <span data-ttu-id="1f937-223">此外，某些項目 （例如裝置驅動程式載入的項目） 是如果它們發生 Registry.LocalMachine 之外，沒有任何意義。</span><span class="sxs-lookup"><span data-stu-id="1f937-223">Also, some items (such as device driver loading entries) are meaningless if they occur outside of Registry.LocalMachine.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-224">下列範例示範如何擷取此機碼中的子機碼，並列印其名稱到螢幕。</span><span class="sxs-lookup"><span data-stu-id="1f937-224">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="1f937-225">使用<xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A>方法用來建立感興趣的特定子機碼的執行個體。</span><span class="sxs-lookup"><span data-stu-id="1f937-225">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="1f937-226">然後，您可以使用中的其他作業<xref:Microsoft.Win32.RegistryKey>操作該索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-226">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.LocalMachine Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.LocalMachine Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.LocalMachine Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.LocalMachine Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.LocalMachine Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.LocalMachine Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="PerformanceData">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey PerformanceData;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey PerformanceData" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.PerformanceData" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly PerformanceData As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ PerformanceData;" />
      <MemberSignature Language="F#" Value=" staticval mutable PerformanceData : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.PerformanceData" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="1f937-227">包含軟體元件的效能資訊。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-227">Contains performance information for software components.</span>
          </span>
          <span data-ttu-id="1f937-228">這個欄位會讀取 Windows 登錄主要機碼 HKEY_PERFORMANCE_DATA。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-228">This field reads the Windows registry base key HKEY_PERFORMANCE_DATA.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-229">每個軟體元件會建立它的物件、 計數器時它會安裝，而且當它執行時，寫入計數器資料的索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-229">Each software component creates keys for its objects, counters when it is installed, and writes counter data while it is executing.</span></span> <span data-ttu-id="1f937-230">您可以存取此資料，因為您會存取任何其他登錄的資料，使用<xref:Microsoft.Win32.RegistryKey>函式。</span><span class="sxs-lookup"><span data-stu-id="1f937-230">You can access this data as you would access any other registry data, using the <xref:Microsoft.Win32.RegistryKey> functions.</span></span>  
  
 <span data-ttu-id="1f937-231">雖然您可以使用登錄來收集效能資料，資料不會儲存在登錄資料庫中。</span><span class="sxs-lookup"><span data-stu-id="1f937-231">Although you use the registry to collect performance data, the data is not stored in the registry database.</span></span> <span data-ttu-id="1f937-232">相反地，使用此金鑰存取登錄會使系統收集適當的系統物件管理員中的資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-232">Instead, accessing the registry with this key causes the system to collect the data from the appropriate system object managers.</span></span>  
  
 <span data-ttu-id="1f937-233">若要從本機系統取得效能資料，請使用<xref:Microsoft.Win32.RegistryKey.GetValue%2A>方法，具有 Registry.PerformanceData 索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-233">To obtain performance data from the local system, use the <xref:Microsoft.Win32.RegistryKey.GetValue%2A> method, with the Registry.PerformanceData key.</span></span> <span data-ttu-id="1f937-234">第一次呼叫會開啟索引鍵 （您不需要明確地開啟索引鍵第一次）。</span><span class="sxs-lookup"><span data-stu-id="1f937-234">The first call opens the key (you do not need to explicitly open the key first).</span></span> <span data-ttu-id="1f937-235">不過，請務必使用<xref:Microsoft.Win32.RegistryKey.Close%2A>方法以關閉的機碼的控制代碼，當您完成取得效能資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-235">However, be sure to use the <xref:Microsoft.Win32.RegistryKey.Close%2A> method to close the handle to the key when you are finished obtaining performance data.</span></span> <span data-ttu-id="1f937-236">使用者無法安裝或移除軟體元件，其效能資料時使用。</span><span class="sxs-lookup"><span data-stu-id="1f937-236">The user cannot install or remove a software component while its performance data is in use.</span></span>  
  
 <span data-ttu-id="1f937-237">若要從遠端系統取得效能資料，您必須使用<xref:Microsoft.Win32.RegistryKey.OpenRemoteBaseKey%2A>方法，在遠端系統及 Registry.PerformanceData 金鑰的電腦名稱。</span><span class="sxs-lookup"><span data-stu-id="1f937-237">To obtain performance data from a remote system, you must use the <xref:Microsoft.Win32.RegistryKey.OpenRemoteBaseKey%2A> method, with the computer name of the remote system and the Registry.PerformanceData key.</span></span> <span data-ttu-id="1f937-238">此呼叫會擷取索引鍵代表的遠端系統的效能資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-238">This call retrieves a key representing the performance data for the remote system.</span></span> <span data-ttu-id="1f937-239">若要擷取的資料，請呼叫<xref:Microsoft.Win32.RegistryKey.GetValue%2A>使用這個金鑰，而不是 Registry.PerformanceData 索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-239">To retrieve the data, call <xref:Microsoft.Win32.RegistryKey.GetValue%2A> using this key, rather than the Registry.PerformanceData key.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-240">Windows Server 2003，使用者必須至少屬於 Performance Monitor Users 群組才能存取此基底的索引鍵的子機碼。</span><span class="sxs-lookup"><span data-stu-id="1f937-240">On Windows Server 2003, a user must at least belong to the Performance Monitor Users group in order to access subkeys of this base key.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-241">下列範例示範如何擷取此機碼中的子機碼，並列印其名稱到螢幕。</span><span class="sxs-lookup"><span data-stu-id="1f937-241">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="1f937-242">使用<xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A>方法用來建立感興趣的特定子機碼的執行個體。</span><span class="sxs-lookup"><span data-stu-id="1f937-242">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="1f937-243">然後，您可以使用中的其他作業<xref:Microsoft.Win32.RegistryKey>操作該索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-243">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span> <span data-ttu-id="1f937-244">請注意，此範例可以通常會傳回任何結果，因為可能會不有任何效能資料。</span><span class="sxs-lookup"><span data-stu-id="1f937-244">Note that this example can often return no results, since there might be no performance data.</span></span>  
  
 [!code-cpp[Classic Registry.PerformanceData Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.PerformanceData Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.PerformanceData Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.PerformanceData Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.PerformanceData Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.PerformanceData Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="SetValue">
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="1f937-245">設定登錄機碼中名稱/值組的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-245">Sets the value of a name/value pair in a registry key.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="1f937-246">下列程式碼範例會將數個資料類型的值儲存在範例機碼，建立金鑰，因為它在這麼做，然後擷取並顯示的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-246">The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values.</span></span> <span data-ttu-id="1f937-247">此範例示範如何儲存和擷取的預設值 （無名） 的名稱/值組，以及使用`defaultValue`名稱/值組不存在的時。</span><span class="sxs-lookup"><span data-stu-id="1f937-247">The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of `defaultValue` when a name/value pair does not exist.</span></span>  
  
 [!code-cpp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/cpp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CPP/source.cpp#1)]
 [!code-csharp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/csharp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CS/source.cs#1)]
 [!code-vb[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </MemberGroup>
    <Member MemberName="SetValue">
      <MemberSignature Language="C#" Value="public static void SetValue (string keyName, string valueName, object value);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetValue(string keyName, string valueName, object value) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.Win32.Registry.SetValue(System.String,System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetValue (keyName As String, valueName As String, value As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetValue(System::String ^ keyName, System::String ^ valueName, System::Object ^ value);" />
      <MemberSignature Language="F#" Value="static member SetValue : string * string * obj -&gt; unit" Usage="Microsoft.Win32.Registry.SetValue (keyName, valueName, value)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="keyName" Type="System.String" />
        <Parameter Name="valueName" Type="System.String" />
        <Parameter Name="value" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="keyName">
          <span data-ttu-id="1f937-248">機碼的完整登錄路徑，以有效登錄根目錄開頭 (例如 "HKEY_CURRENT_USER")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-248">The full registry path of the key, beginning with a valid registry root, such as "HKEY_CURRENT_USER".</span>
          </span>
        </param>
        <param name="valueName">
          <span data-ttu-id="1f937-249">名稱/值組的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-249">The name of the name/value pair.</span>
          </span>
        </param>
        <param name="value">
          <span data-ttu-id="1f937-250">要儲存的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-250">The value to be stored.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="1f937-251">在指定的登錄機碼上設定指定的名稱/值組。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-251">Sets the specified name/value pair on the specified registry key.</span>
          </span>
          <span data-ttu-id="1f937-252">如果指定的機碼不存在，則會建立它。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-252">If the specified key does not exist, it is created.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-253">開頭[!INCLUDE[net_v40_long](~/includes/net-v40-long-md.md)]，則`valueName`參數已不再限制為最多 255 個字元; 不過，`keyName`參數會繼續有 255 個字元限制。</span><span class="sxs-lookup"><span data-stu-id="1f937-253">Starting with the [!INCLUDE[net_v40_long](~/includes/net-v40-long-md.md)], the `valueName` parameter is no longer restricted to a maximum of 255 characters; however, the `keyName` parameter continues to have the 255-character restriction.</span></span>  
  
 <span data-ttu-id="1f937-254">因為許多值可以儲存在登錄中的每個索引鍵中，您必須使用`valueName`參數來指定您想要設定的特定值。</span><span class="sxs-lookup"><span data-stu-id="1f937-254">Because many values can be stored in each key in the registry, you must use the `valueName` parameter to specify the particular value you want to set.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-255">登錄機碼可以包含一個不是任何名稱相關聯的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-255">A registry key can contain one value that is not associated with any name.</span></span> <span data-ttu-id="1f937-256">當這個未命名的值顯示在登錄編輯程式中時，字串 「 （預設） 」 會出現而不是名稱。</span><span class="sxs-lookup"><span data-stu-id="1f937-256">When this unnamed value is displayed in the registry editor, the string "(Default)" appears instead of a name.</span></span> <span data-ttu-id="1f937-257">若要設定這個未命名的值，指定`null`或空字串 ("") 的`valueName`。</span><span class="sxs-lookup"><span data-stu-id="1f937-257">To set this unnamed value, specify either `null` or the empty string ("") for `valueName`.</span></span>  
  
 <span data-ttu-id="1f937-258">如果`valueName`不存在的機碼中建立和相關聯的值設定為`value`。</span><span class="sxs-lookup"><span data-stu-id="1f937-258">If `valueName` does not exist in the key, it is created and the associated value is set to `value`.</span></span>  
  
 <span data-ttu-id="1f937-259">如果`keyName`指定子機碼不存在，在指定的根目錄中建立子機碼。</span><span class="sxs-lookup"><span data-stu-id="1f937-259">If `keyName` specifies a subkey that does not exist, the subkey is created in the specified root.</span></span> <span data-ttu-id="1f937-260">比方說，在 Visual Basic 中的字串"HKEY_CURRENT_USER\MyTestKey 」 建立在 HKEY_CURRENT_USER 根目錄中的子機碼"MyTestKey 」。</span><span class="sxs-lookup"><span data-stu-id="1f937-260">For example, in Visual Basic the string "HKEY_CURRENT_USER\MyTestKey" creates the subkey "MyTestKey" in the HKEY_CURRENT_USER root.</span></span> <span data-ttu-id="1f937-261">字串"HKEY_CURRENT_USER\MyTestKey\Key2\Key3 」 會建立 「 MyTestKey"、"MyTestKey\Key2 」 和 「 MyTestKey\Key2\Key3"的巢狀子機碼。</span><span class="sxs-lookup"><span data-stu-id="1f937-261">The string "HKEY_CURRENT_USER\MyTestKey\Key2\Key3" creates the nested subkeys "MyTestKey", "MyTestKey\Key2", and "MyTestKey\Key2\Key3".</span></span>  
  
 <span data-ttu-id="1f937-262">有效的根名稱包含 HKEY_CURRENT_USER，HKEY_LOCAL_MACHINE，HKEY_CLASSES_ROOT、 HKEY_USERS、 HKEY_PERFORMANCE_DATA、 機碼 HKEY_CURRENT_CONFIG 和機碼 HKEY_DYN_DATA。</span><span class="sxs-lookup"><span data-stu-id="1f937-262">Valid root names include HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-263"><xref:Microsoft.Win32.Registry.SetValue%2A>方法，可開啟登錄機碼、 設定值，並在關閉機碼每次呼叫時。</span><span class="sxs-lookup"><span data-stu-id="1f937-263">The <xref:Microsoft.Win32.Registry.SetValue%2A> method opens a registry key, sets the value, and closes the key each time it is called.</span></span> <span data-ttu-id="1f937-264">如果您需要修改大量數值，<xref:Microsoft.Win32.RegistryKey.SetValue%2A?displayProperty=nameWithType>方法可能會提供更佳的效能。</span><span class="sxs-lookup"><span data-stu-id="1f937-264">If you need to modify a large number of values, the <xref:Microsoft.Win32.RegistryKey.SetValue%2A?displayProperty=nameWithType> method might provide better performance.</span></span> <span data-ttu-id="1f937-265"><xref:Microsoft.Win32.RegistryKey>類別也會提供方法，可讓您將存取控制清單 (ACL) 新增至登錄機碼，然後才能擷取它，測試值的資料類型，並刪除索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-265">The <xref:Microsoft.Win32.RegistryKey> class also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</span></span>  
  
 <span data-ttu-id="1f937-266">這個多載<xref:Microsoft.Win32.Registry.SetValue%2A>儲存為字串的 64 位元整數 (<xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType>)。</span><span class="sxs-lookup"><span data-stu-id="1f937-266">This overload of <xref:Microsoft.Win32.Registry.SetValue%2A> stores 64-bit integers as strings (<xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType>).</span></span> <span data-ttu-id="1f937-267">若要儲存為 64 位元數字<xref:Microsoft.Win32.RegistryValueKind.QWord?displayProperty=nameWithType>值，會使用<xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29>方法多載。</span><span class="sxs-lookup"><span data-stu-id="1f937-267">To store 64-bit numbers as <xref:Microsoft.Win32.RegistryValueKind.QWord?displayProperty=nameWithType> values, use the <xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29> method overload.</span></span>  
  
 <span data-ttu-id="1f937-268">這個多載<xref:Microsoft.Win32.Registry.SetValue%2A>會儲存所有的字串值視為<xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType>物件，即使它們包含可展開環境變數參考。</span><span class="sxs-lookup"><span data-stu-id="1f937-268">This overload of <xref:Microsoft.Win32.Registry.SetValue%2A> stores all string values as <xref:Microsoft.Win32.RegistryValueKind.String?displayProperty=nameWithType> objects, even if they contain expandable references to environment variables.</span></span> <span data-ttu-id="1f937-269">若要儲存字串值為可展開的字串 (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>)，使用<xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29>方法多載。</span><span class="sxs-lookup"><span data-stu-id="1f937-269">To save string values as expandable strings (<xref:Microsoft.Win32.RegistryValueKind.ExpandString?displayProperty=nameWithType>), use the <xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29> method overload.</span></span>  
  
 <span data-ttu-id="1f937-270">這個多載就相當於呼叫<xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29>方法多載<xref:Microsoft.Win32.RegistryValueKind.Unknown?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="1f937-270">This overload is equivalent to calling the <xref:Microsoft.Win32.Registry.SetValue%28System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind%29> method overload with <xref:Microsoft.Win32.RegistryValueKind.Unknown?displayProperty=nameWithType>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-271">在 Windows 98 和 Windows Millennium Edition (Windows Me 檔案)，登錄不是 Unicode，而且並非所有的 Unicode 字元則是適用於所有字碼頁。</span><span class="sxs-lookup"><span data-stu-id="1f937-271">On Windows 98 and Windows Millennium Edition (Windows Me), the registry is not Unicode, and not all Unicode characters are valid for all code pages.</span></span> <span data-ttu-id="1f937-272">可用最佳的配對會取代目前的字碼頁而言是無效的 Unicode 字元。</span><span class="sxs-lookup"><span data-stu-id="1f937-272">A Unicode character that is invalid for the current code page is replaced by the best available match.</span></span> <span data-ttu-id="1f937-273">不會有例外狀況擲回。</span><span class="sxs-lookup"><span data-stu-id="1f937-273">No exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-274">下列程式碼範例會將數個資料類型的值儲存在範例機碼，建立金鑰，因為它在這麼做，然後擷取並顯示的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-274">The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values.</span></span> <span data-ttu-id="1f937-275">此範例示範如何儲存和擷取的預設值 （無名） 的名稱/值組，以及使用`defaultValue`名稱/值組不存在的時。</span><span class="sxs-lookup"><span data-stu-id="1f937-275">The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of `defaultValue` when a name/value pair does not exist.</span></span>  
  
 [!code-cpp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/cpp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CPP/source.cpp#1)]
 [!code-csharp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/csharp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CS/source.cs#1)]
 [!code-vb[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="1f937-276">
            <paramref name="value" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-276">
              <paramref name="value" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="1f937-277">
            <paramref name="keyName" /> 不是以有效的登錄根目錄開頭。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-277">
              <paramref name="keyName" /> does not begin with a valid registry root.</span>
          </span>
          <span data-ttu-id="1f937-278">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-278">-or-</span>
          </span>
          <span data-ttu-id="1f937-279">
            <paramref name="keyName" /> 超過允許的最大長度 (255 個字元)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-279">
              <paramref name="keyName" /> is longer than the maximum length allowed (255 characters).</span>
          </span>
        </exception>
        <exception cref="T:System.UnauthorizedAccessException">
          <span data-ttu-id="1f937-280">
            <see cref="T:Microsoft.Win32.RegistryKey" /> 為唯讀，因此無法寫入 (例如，它是根層次節點)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-280">The <see cref="T:Microsoft.Win32.RegistryKey" /> is read-only, and thus cannot be written to; for example, it is a root-level node.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="1f937-281">使用者沒有建立或修改登錄機碼所需的使用權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-281">The user does not have the permissions required to create or modify registry keys.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.RegistryPermission">
          <span data-ttu-id="1f937-282">若要修改指定的登錄機碼，如果存在，或不存在時建立登錄機碼。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-282">to modify the specified registry key if it exists, or to create the registry key if it does not already exist.</span>
          </span>
          <span data-ttu-id="1f937-283">相關聯的列舉型別： <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />， <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-283">Associated enumerations: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />, <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span>
          </span>
        </permission>
      </Docs>
    </Member>
    <Member MemberName="SetValue">
      <MemberSignature Language="C#" Value="public static void SetValue (string keyName, string valueName, object value, Microsoft.Win32.RegistryValueKind valueKind);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void SetValue(string keyName, string valueName, object value, valuetype Microsoft.Win32.RegistryValueKind valueKind) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.Win32.Registry.SetValue(System.String,System.String,System.Object,Microsoft.Win32.RegistryValueKind)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub SetValue (keyName As String, valueName As String, value As Object, valueKind As RegistryValueKind)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SetValue(System::String ^ keyName, System::String ^ valueName, System::Object ^ value, Microsoft::Win32::RegistryValueKind valueKind);" />
      <MemberSignature Language="F#" Value="static member SetValue : string * string * obj * Microsoft.Win32.RegistryValueKind -&gt; unit" Usage="Microsoft.Win32.Registry.SetValue (keyName, valueName, value, valueKind)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="keyName" Type="System.String" />
        <Parameter Name="valueName" Type="System.String" />
        <Parameter Name="value" Type="System.Object" />
        <Parameter Name="valueKind" Type="Microsoft.Win32.RegistryValueKind" />
      </Parameters>
      <Docs>
        <param name="keyName">
          <span data-ttu-id="1f937-284">機碼的完整登錄路徑，以有效登錄根目錄開頭 (例如 "HKEY_CURRENT_USER")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-284">The full registry path of the key, beginning with a valid registry root, such as "HKEY_CURRENT_USER".</span>
          </span>
        </param>
        <param name="valueName">
          <span data-ttu-id="1f937-285">名稱/值組的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-285">The name of the name/value pair.</span>
          </span>
        </param>
        <param name="value">
          <span data-ttu-id="1f937-286">要儲存的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-286">The value to be stored.</span>
          </span>
        </param>
        <param name="valueKind">
          <span data-ttu-id="1f937-287">儲存資料時要使用的登錄資料類型。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-287">The registry data type to use when storing the data.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="1f937-288">使用指定的登錄資料型別，在指定的登錄機碼上設定名稱/值組。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-288">Sets the name/value pair on the specified registry key, using the specified registry data type.</span>
          </span>
          <span data-ttu-id="1f937-289">如果指定的機碼不存在，則會建立它。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-289">If the specified key does not exist, it is created.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-290">開頭[!INCLUDE[net_v40_long](~/includes/net-v40-long-md.md)]，則`valueName`參數已不再限制為最多 255 個字元; 不過，`keyName`參數可讓您繼續有 255 個字元限制。</span><span class="sxs-lookup"><span data-stu-id="1f937-290">Starting with the [!INCLUDE[net_v40_long](~/includes/net-v40-long-md.md)], the `valueName` parameter is no longer restricted to a maximum of 255 characters; however, the `keyName` parameter continues have the 255-character restriction.</span></span>  
  
 <span data-ttu-id="1f937-291">因為許多值可以儲存在登錄中的每個索引鍵中，您必須使用`valueName`參數來指定您想要設定的特定值。</span><span class="sxs-lookup"><span data-stu-id="1f937-291">Because many values can be stored in each key in the registry, you must use the `valueName` parameter to specify the particular value you want to set.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-292">登錄機碼可以包含一個不是任何名稱相關聯的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-292">A registry key can contain one value that is not associated with any name.</span></span> <span data-ttu-id="1f937-293">當這個未命名的值顯示在登錄編輯程式中時，字串 「 （預設） 」 會出現而不是名稱。</span><span class="sxs-lookup"><span data-stu-id="1f937-293">When this unnamed value is displayed in the registry editor, the string "(Default)" appears instead of a name.</span></span> <span data-ttu-id="1f937-294">若要設定這個未命名的值，指定`null`或空字串 ("") 的`valueName`。</span><span class="sxs-lookup"><span data-stu-id="1f937-294">To set this unnamed value, specify either `null` or the empty string ("") for `valueName`.</span></span>  
  
 <span data-ttu-id="1f937-295">如果`valueName`不存在的機碼中建立和相關聯的值設定為`value`。</span><span class="sxs-lookup"><span data-stu-id="1f937-295">If `valueName` does not exist in the key, it is created and the associated value is set to `value`.</span></span>  
  
 <span data-ttu-id="1f937-296">如果`keyName`指定子機碼不存在，在指定的根目錄中建立子機碼。</span><span class="sxs-lookup"><span data-stu-id="1f937-296">If `keyName` specifies a subkey that does not exist, the subkey is created in the specified root.</span></span> <span data-ttu-id="1f937-297">比方說，在 Visual Basic 中的字串"HKEY_CURRENT_USER\MyTestKey 」 建立在 HKEY_CURRENT_USER 根目錄中的子機碼"MyTestKey 」。</span><span class="sxs-lookup"><span data-stu-id="1f937-297">For example, in Visual Basic the string "HKEY_CURRENT_USER\MyTestKey" creates the subkey "MyTestKey" in the HKEY_CURRENT_USER root.</span></span> <span data-ttu-id="1f937-298">字串"HKEY_CURRENT_USER\MyTestKey\Key2\Key3 」 會建立 「 MyTestKey"、"MyTestKey\Key2 」 和 「 MyTestKey\Key2\Key3"的巢狀子機碼。</span><span class="sxs-lookup"><span data-stu-id="1f937-298">The string "HKEY_CURRENT_USER\MyTestKey\Key2\Key3" creates the nested subkeys "MyTestKey", "MyTestKey\Key2", and "MyTestKey\Key2\Key3".</span></span>  
  
 <span data-ttu-id="1f937-299">有效的根名稱包含 HKEY_CURRENT_USER，HKEY_LOCAL_MACHINE，HKEY_CLASSES_ROOT、 HKEY_USERS、 HKEY_PERFORMANCE_DATA、 機碼 HKEY_CURRENT_CONFIG 和機碼 HKEY_DYN_DATA。</span><span class="sxs-lookup"><span data-stu-id="1f937-299">Valid root names include HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-300"><xref:Microsoft.Win32.Registry.SetValue%2A>方法，可開啟登錄機碼、 設定值，並在關閉機碼每次呼叫時。</span><span class="sxs-lookup"><span data-stu-id="1f937-300">The <xref:Microsoft.Win32.Registry.SetValue%2A> method opens a registry key, sets the value, and closes the key each time it is called.</span></span> <span data-ttu-id="1f937-301">如果您需要修改大量數值，<xref:Microsoft.Win32.RegistryKey.SetValue%2A?displayProperty=nameWithType>方法可能會提供更佳的效能。</span><span class="sxs-lookup"><span data-stu-id="1f937-301">If you need to modify a large number of values, the <xref:Microsoft.Win32.RegistryKey.SetValue%2A?displayProperty=nameWithType> method might provide better performance.</span></span> <span data-ttu-id="1f937-302"><xref:Microsoft.Win32.RegistryKey>類別也會提供方法，可讓您將存取控制清單 (ACL) 新增至登錄機碼，然後才能擷取它，測試值的資料類型，並刪除索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-302">The <xref:Microsoft.Win32.RegistryKey> class also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</span></span>  
  
 <span data-ttu-id="1f937-303">如果指定的型別`value`不符合指定`valueKind`，而且不能是資料轉換，<xref:System.ArgumentException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="1f937-303">If the type of the specified `value` does not match the specified `valueKind`, and the data cannot be converted, <xref:System.ArgumentException> is thrown.</span></span> <span data-ttu-id="1f937-304">例如，您可以在其中儲存<xref:System.Int64?displayProperty=nameWithType>作為<xref:Microsoft.Win32.RegistryValueKind.DWord?displayProperty=nameWithType>，但其值小於最大值時，只有<xref:System.Int32?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="1f937-304">For example, you can store a <xref:System.Int64?displayProperty=nameWithType> as a <xref:Microsoft.Win32.RegistryValueKind.DWord?displayProperty=nameWithType>, but only if its value is less than the maximum value of a <xref:System.Int32?displayProperty=nameWithType>.</span></span> <span data-ttu-id="1f937-305">您無法儲存單一字串值做為<xref:Microsoft.Win32.RegistryValueKind.MultiString?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="1f937-305">You cannot store a single string value as a <xref:Microsoft.Win32.RegistryValueKind.MultiString?displayProperty=nameWithType>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-306">如果經過 boxing 處理的值會傳遞給<xref:Microsoft.Win32.RegistryValueKind.DWord?displayProperty=nameWithType>或<xref:Microsoft.Win32.RegistryValueKind.QWord?displayProperty=nameWithType>，表示轉換已完成使用文化特性而異。</span><span class="sxs-lookup"><span data-stu-id="1f937-306">If boxed values are passed for <xref:Microsoft.Win32.RegistryValueKind.DWord?displayProperty=nameWithType> or <xref:Microsoft.Win32.RegistryValueKind.QWord?displayProperty=nameWithType>, the conversion is done using the invariant culture.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f937-307">在 Windows 98 和 Windows Millennium Edition (Windows Me 檔案)，登錄不是 Unicode，而且並非所有的 Unicode 字元則是適用於所有字碼頁。</span><span class="sxs-lookup"><span data-stu-id="1f937-307">On Windows 98 and Windows Millennium Edition (Windows Me), the registry is not Unicode, and not all Unicode characters are valid for all code pages.</span></span> <span data-ttu-id="1f937-308">可用最佳的配對會取代目前的字碼頁而言是無效的 Unicode 字元。</span><span class="sxs-lookup"><span data-stu-id="1f937-308">A Unicode character that is invalid for the current code page is replaced by the best available match.</span></span> <span data-ttu-id="1f937-309">不會有例外狀況擲回。</span><span class="sxs-lookup"><span data-stu-id="1f937-309">No exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-310">下列程式碼範例會將數個資料類型的值儲存在範例機碼，建立金鑰，因為它在這麼做，然後擷取並顯示的值。</span><span class="sxs-lookup"><span data-stu-id="1f937-310">The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values.</span></span> <span data-ttu-id="1f937-311">此範例示範如何儲存和擷取的預設值 （無名） 的名稱/值組，以及使用`defaultValue`名稱/值組不存在的時。</span><span class="sxs-lookup"><span data-stu-id="1f937-311">The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of `defaultValue` when a name/value pair does not exist.</span></span>  
  
 [!code-cpp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/cpp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CPP/source.cpp#1)]
 [!code-csharp[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/csharp/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/CS/source.cs#1)]
 [!code-vb[Microsoft.Win32.Registry.GetSet#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/Microsoft.Win32.Registry.GetSet/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="1f937-312">
            <paramref name="value" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-312">
              <paramref name="value" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="1f937-313">
            <paramref name="keyName" /> 不是以有效的登錄根目錄開頭。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-313">
              <paramref name="keyName" /> does not begin with a valid registry root.</span>
          </span>
          <span data-ttu-id="1f937-314">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-314">-or-</span>
          </span>
          <span data-ttu-id="1f937-315">
            <paramref name="keyName" /> 超過允許的最大長度 (255 個字元)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-315">
              <paramref name="keyName" /> is longer than the maximum length allowed (255 characters).</span>
          </span>
          <span data-ttu-id="1f937-316">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-316">-or-</span>
          </span>
          <span data-ttu-id="1f937-317">
            <paramref name="value" /> 的型別與 <paramref name="valueKind" /> 所指定的登錄資料型別不符，因此，無法正確轉換資料。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-317">The type of <paramref name="value" /> did not match the registry data type specified by <paramref name="valueKind" />, therefore the data could not be converted properly.</span>
          </span>
        </exception>
        <exception cref="T:System.UnauthorizedAccessException">
          <span data-ttu-id="1f937-318">
            <see cref="T:Microsoft.Win32.RegistryKey" /> 為唯讀，因此無法寫入 (例如，它是根層次節點，或未以寫入權限來開啟該機碼)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-318">The <see cref="T:Microsoft.Win32.RegistryKey" /> is read-only, and thus cannot be written to; for example, it is a root-level node, or the key has not been opened with write access.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="1f937-319">使用者沒有建立或修改登錄機碼所需的使用權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-319">The user does not have the permissions required to create or modify registry keys.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.RegistryPermission">
          <span data-ttu-id="1f937-320">若要修改指定的登錄機碼，如果存在，或不存在時建立登錄機碼。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-320">to modify the specified registry key if it exists, or to create the registry key if it does not already exist.</span>
          </span>
          <span data-ttu-id="1f937-321">相關聯的列舉型別： <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />， <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-321">Associated enumerations: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />, <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span>
          </span>
        </permission>
      </Docs>
    </Member>
    <Member MemberName="Users">
      <MemberSignature Language="C#" Value="public static readonly Microsoft.Win32.RegistryKey Users;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly class Microsoft.Win32.RegistryKey Users" />
      <MemberSignature Language="DocId" Value="F:Microsoft.Win32.Registry.Users" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Users As RegistryKey " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly Microsoft::Win32::RegistryKey ^ Users;" />
      <MemberSignature Language="F#" Value=" staticval mutable Users : Microsoft.Win32.RegistryKey" Usage="Microsoft.Win32.Registry.Users" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.Win32.Registry</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="1f937-322">包含有關預設使用者組態的資訊。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-322">Contains information about the default user configuration.</span>
          </span>
          <span data-ttu-id="1f937-323">這個欄位會讀取 Windows 登錄主要機碼 HKEY_USERS。</span>
          <span class="sxs-lookup">
            <span data-stu-id="1f937-323">This field reads the Windows registry base key HKEY_USERS.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f937-324">此金鑰包含電腦的每個使用者的分支。</span><span class="sxs-lookup"><span data-stu-id="1f937-324">This key contains a branch for each user of the computer.</span></span> <span data-ttu-id="1f937-325">如果使用者未變更喜好設定，在本機電腦上的新使用者及預設的目前使用者被提供的預設組態。</span><span class="sxs-lookup"><span data-stu-id="1f937-325">The default configuration is supplied for new users on the local computer and for the default current user if the user has not changed preferences.</span></span> <span data-ttu-id="1f937-326">因為 Windows 98 / 我也支援 Registry.Users，應用程式可以存取相同的方式，就在 Windows 2000 的使用者特定資訊。</span><span class="sxs-lookup"><span data-stu-id="1f937-326">Because Windows 98/ME also supports Registry.Users, applications can access the user-specific information the same way they do under Windows 2000.</span></span> <span data-ttu-id="1f937-327">每個使用者的資訊會儲存在不同的檔案，可以儲存在本機或網路伺服器上。</span><span class="sxs-lookup"><span data-stu-id="1f937-327">Each user's information is stored in a separate file, which can be stored locally or on a network server.</span></span> <span data-ttu-id="1f937-328">Windows 98 / 我可以將此檔案複製到使用者的目前的系統，以便設定從一部電腦之間移動與使用者。</span><span class="sxs-lookup"><span data-stu-id="1f937-328">Windows 98/ME can copy this file to the user's current system so that settings can move from one computer to another with the user.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f937-329">下列範例示範如何擷取此機碼中的子機碼，並列印其名稱到螢幕。</span><span class="sxs-lookup"><span data-stu-id="1f937-329">The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen.</span></span> <span data-ttu-id="1f937-330">使用<xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A>方法用來建立感興趣的特定子機碼的執行個體。</span><span class="sxs-lookup"><span data-stu-id="1f937-330">Use the <xref:Microsoft.Win32.RegistryKey.OpenSubKey%2A> method to create an instance of the particular subkey of interest.</span></span> <span data-ttu-id="1f937-331">然後，您可以使用中的其他作業<xref:Microsoft.Win32.RegistryKey>操作該索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1f937-331">You can then use other operations in <xref:Microsoft.Win32.RegistryKey> to manipulate that key.</span></span>  
  
 [!code-cpp[Classic Registry.Users Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic Registry.Users Example/CPP/source.cpp#1)]
 [!code-csharp[Classic Registry.Users Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic Registry.Users Example/CS/source.cs#1)]
 [!code-vb[Classic Registry.Users Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic Registry.Users Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>