<Type Name="ObjectDataSource" FullName="System.Web.UI.WebControls.ObjectDataSource">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="15236dc6073fb19c95955afb8e0d9d895643e546" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36381743" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class ObjectDataSource : System.Web.UI.DataSourceControl" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit ObjectDataSource extends System.Web.UI.DataSourceControl" />
  <TypeSignature Language="DocId" Value="T:System.Web.UI.WebControls.ObjectDataSource" />
  <TypeSignature Language="VB.NET" Value="Public Class ObjectDataSource&#xA;Inherits DataSourceControl" />
  <TypeSignature Language="C++ CLI" Value="public ref class ObjectDataSource : System::Web::UI::DataSourceControl" />
  <TypeSignature Language="F#" Value="type ObjectDataSource = class&#xA;    inherit DataSourceControl" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.UI.DataSourceControl</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.ComponentModel.DefaultEvent("Selecting")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.DefaultProperty("TypeName")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.Designer("System.Web.UI.Design.WebControls.ObjectDataSourceDesigner, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Drawing.ToolboxBitmap(typeof(System.Web.UI.WebControls.ObjectDataSource))</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Web.UI.ParseChildren(true)</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Web.UI.PersistChildren(false)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="21d7d-101">表示向多層 Web 應用程式架構中資料繫結控制項提供資料的商務物件 (Business Object)。</span>
      <span class="sxs-lookup">
        <span data-stu-id="21d7d-101">Represents a business object that provides data to data-bound controls in multitier Web application architectures.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-102">本主題內容：</span><span class="sxs-lookup"><span data-stu-id="21d7d-102">In this topic:</span></span>  
  
-   [<span data-ttu-id="21d7d-103">簡介</span><span class="sxs-lookup"><span data-stu-id="21d7d-103">Introduction</span></span>](#introduction)  
  
-   [<span data-ttu-id="21d7d-104">用途</span><span class="sxs-lookup"><span data-stu-id="21d7d-104">Purpose</span></span>](#purpose)  
  
-   [<span data-ttu-id="21d7d-105">擷取資料</span><span class="sxs-lookup"><span data-stu-id="21d7d-105">Retrieving Data</span></span>](#retrieving_data)  
  
-   [<span data-ttu-id="21d7d-106">執行資料作業</span><span class="sxs-lookup"><span data-stu-id="21d7d-106">Performing Data Operations</span></span>](#performing_data_operations)  
  
-   [<span data-ttu-id="21d7d-107">篩選資料</span><span class="sxs-lookup"><span data-stu-id="21d7d-107">Filtering Data</span></span>](#filtering_data)  
  
-   [<span data-ttu-id="21d7d-108">快取</span><span class="sxs-lookup"><span data-stu-id="21d7d-108">Caching</span></span>](#caching)  
  
-   [<span data-ttu-id="21d7d-109">功能</span><span class="sxs-lookup"><span data-stu-id="21d7d-109">Features</span></span>](#features)  
  
-   [<span data-ttu-id="21d7d-110">資料檢視</span><span class="sxs-lookup"><span data-stu-id="21d7d-110">Data View</span></span>](#data_view)  
  
-   [<span data-ttu-id="21d7d-111">使用 LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="21d7d-111">Using LINQ to SQL</span></span>](#using_linq_to_sql)  
  
-   [<span data-ttu-id="21d7d-112">宣告式語法</span><span class="sxs-lookup"><span data-stu-id="21d7d-112">Declarative Syntax</span></span>](#declarative_syntax)  
  
<a name="introduction"></a>   
## <a name="introduction"></a><span data-ttu-id="21d7d-113">簡介</span><span class="sxs-lookup"><span data-stu-id="21d7d-113">Introduction</span></span>  
 <span data-ttu-id="21d7d-114"><xref:System.Web.UI.WebControls.ObjectDataSource>控制的運作方式與您所建立的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-114">An <xref:System.Web.UI.WebControls.ObjectDataSource> control works with a class that you create.</span></span> <span data-ttu-id="21d7d-115">建立方法，擷取並更新資料，而且您提供的這些方法的名稱<xref:System.Web.UI.WebControls.ObjectDataSource>標記中的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-115">You create methods that retrieve and update data, and you provide the names of those methods to the <xref:System.Web.UI.WebControls.ObjectDataSource> control in markup.</span></span> <span data-ttu-id="21d7d-116">轉譯或回傳的處理期間<xref:System.Web.UI.WebControls.ObjectDataSource>呼叫您指定的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-116">During rendering or postback processing, the <xref:System.Web.UI.WebControls.ObjectDataSource> calls the methods that you have specified.</span></span>  
  
 <span data-ttu-id="21d7d-117">沒有任何視覺化呈現<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-117">There is no visual rendering of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-118">如此一來，<xref:System.Web.UI.WebControls.ObjectDataSource>不支援例如 visual 功能<xref:System.Web.UI.DataSourceControl.EnableTheming%2A>或<xref:System.Web.UI.DataSourceControl.SkinID%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-118">As a result, the <xref:System.Web.UI.WebControls.ObjectDataSource> does not support visual features such as the <xref:System.Web.UI.DataSourceControl.EnableTheming%2A> or <xref:System.Web.UI.DataSourceControl.SkinID%2A> property.</span></span>  
  
<a name="purpose"></a>   
## <a name="purpose"></a><span data-ttu-id="21d7d-119">用途</span><span class="sxs-lookup"><span data-stu-id="21d7d-119">Purpose</span></span>  
 <span data-ttu-id="21d7d-120">將展示層與商務邏輯，而封裝商務物件的商務邏輯非常常見的應用程式設計作法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-120">A very common application design practice is to separate the presentation layer from business logic and to encapsulate the business logic in business objects.</span></span> <span data-ttu-id="21d7d-121">這些商務物件會形成之間展示層和資料層，產生三層式應用程式架構的不同層級。</span><span class="sxs-lookup"><span data-stu-id="21d7d-121">These business objects form a distinct layer between the presentation layer and the data tier, resulting in a three-tier application architecture.</span></span> <span data-ttu-id="21d7d-122"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項可讓開發人員可以使用 ASP.NET 資料來源控制項，同時保留其三層式應用程式架構。</span><span class="sxs-lookup"><span data-stu-id="21d7d-122">The <xref:System.Web.UI.WebControls.ObjectDataSource> control enables developers to use an ASP.NET data source control while retaining their three-tier application architecture.</span></span>  
  
 <span data-ttu-id="21d7d-123"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項使用反映來建立商務物件的執行個體，並呼叫方法以擷取、 更新、 插入和刪除資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-123">The <xref:System.Web.UI.WebControls.ObjectDataSource> control uses reflection to create instances of business objects and to call methods on them to retrieve, update, insert, and delete data.</span></span> <span data-ttu-id="21d7d-124"><xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性會識別類別的名稱，<xref:System.Web.UI.WebControls.ObjectDataSource>搭配。</span><span class="sxs-lookup"><span data-stu-id="21d7d-124">The <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property identifies the name of the class that the <xref:System.Web.UI.WebControls.ObjectDataSource> works with.</span></span> <span data-ttu-id="21d7d-125"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項建立並終結每個方法呼叫類別的執行個體，其並未持有物件在記憶體中的 Web 要求的存留期。</span><span class="sxs-lookup"><span data-stu-id="21d7d-125">The <xref:System.Web.UI.WebControls.ObjectDataSource> control creates and destroys an instance of the class for each method call; it does not hold the object in memory for the lifetime of the Web request.</span></span> <span data-ttu-id="21d7d-126">如果您使用的商務物件需要許多資源，或因建立和終結耗費資源，這是一個重要的考量。</span><span class="sxs-lookup"><span data-stu-id="21d7d-126">This is a serious consideration if the business object that you use requires many resources or is otherwise expensive to create and destroy.</span></span> <span data-ttu-id="21d7d-127">使用高度耗費資源的物件可能不是最佳的設計選擇，但您可以使用，以控制物件的生命週期<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>， <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>，和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-127">Using an expensive object might not be an optimal design choice, but you can control the life cycle of the object by using the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>, <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>, and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> events.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="21d7d-128">所識別的方法<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>，和<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>屬性可以是執行個體方法或`static`(`Shared`在 Visual Basic 中) 的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-128">The methods that are identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>, and <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> properties can be instance methods or `static` (`Shared` in Visual Basic) methods.</span></span> <span data-ttu-id="21d7d-129">如果方法都是`static`(`Shared`在 Visual Basic 中)，無法建立商務物件的執行個體，而<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>， <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>，和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>不引發事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-129">If the methods are `static` (`Shared` in Visual Basic), an instance of the business object is not created, and the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>, <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>, and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> events are not raised.</span></span>  
  
<a name="retrieving_data"></a>   
## <a name="retrieving-data"></a><span data-ttu-id="21d7d-130">擷取資料</span><span class="sxs-lookup"><span data-stu-id="21d7d-130">Retrieving Data</span></span>  
 <span data-ttu-id="21d7d-131">若要從商務物件擷取資料，設定<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性來擷取資料之方法的名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-131">To retrieve data from a business object, set the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property to the name of the method that retrieves data.</span></span> <span data-ttu-id="21d7d-132">如果此方法不會傳回<xref:System.Collections.IEnumerable>或<xref:System.Data.DataSet>物件，該物件會包裝在執行階段<xref:System.Collections.IEnumerable>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-132">If the method does not return an <xref:System.Collections.IEnumerable> or <xref:System.Data.DataSet> object, the object is wrapped by the runtime in an <xref:System.Collections.IEnumerable> collection.</span></span> <span data-ttu-id="21d7d-133">如果方法簽章有參數，您可以加入<xref:System.Web.UI.WebControls.Parameter>物件加入至<xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>集合，然後將它們加入您想要傳遞至方法所指定的值繫結<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-133">If the method signature has parameters, you can add <xref:System.Web.UI.WebControls.Parameter> objects to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> collection, and then bind them to the values that you want to pass to the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span> <span data-ttu-id="21d7d-134">為了讓<xref:System.Web.UI.WebControls.ObjectDataSource>控制要使用的參數，參數必須符合的名稱和方法簽章中參數的型別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-134">In order for the <xref:System.Web.UI.WebControls.ObjectDataSource> control to use the parameters, the parameters must match the names and types of the parameters in the method signature.</span></span> <span data-ttu-id="21d7d-135">如需詳細資訊，請參閱[ObjectDataSource 控制項配合使用參數](http://msdn.microsoft.com/library/45fb67ee-9be7-49b7-9421-e242203dafa4)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-135">For more information, see [Using Parameters with the ObjectDataSource Control](http://msdn.microsoft.com/library/45fb67ee-9be7-49b7-9421-e242203dafa4).</span></span>  
  
 <span data-ttu-id="21d7d-136"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項擷取資料時<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-136">The <xref:System.Web.UI.WebControls.ObjectDataSource> control retrieves data whenever the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method is called.</span></span> <span data-ttu-id="21d7d-137">這個方法會提供以程式設計方式存取所指定的方法<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-137">This method provides programmatic access to the method that is specified by <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span> <span data-ttu-id="21d7d-138">所指定的方法<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性會自動呼叫繫結至控制項<xref:System.Web.UI.WebControls.ObjectDataSource>時其`DataBind`方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-138">The method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property is called automatically by controls that are bound to the <xref:System.Web.UI.WebControls.ObjectDataSource> when their `DataBind` method is called.</span></span> <span data-ttu-id="21d7d-139">如果您設定`DataSourceID`資料繫結控制項的屬性，控制項自動繫結至資料來源的資料，視需要。</span><span class="sxs-lookup"><span data-stu-id="21d7d-139">If you set the `DataSourceID` property of a data-bound control, the control automatically binds to data from the data source, as needed.</span></span> <span data-ttu-id="21d7d-140">設定`DataSourceID`屬性是建議的方法繫結<xref:System.Web.UI.WebControls.ObjectDataSource>資料繫結控制項的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-140">Setting the `DataSourceID` property is the recommended method for binding an <xref:System.Web.UI.WebControls.ObjectDataSource> control to a data-bound control.</span></span> <span data-ttu-id="21d7d-141">或者，您可以設定`DataSource`屬性，但接著您必須明確地呼叫`DataBind`資料繫結控制項的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-141">Alternatively, you can set the `DataSource` property, but then you must explicitly call the `DataBind` method of the data-bound control.</span></span> <span data-ttu-id="21d7d-142">您可以呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>以程式設計方式在任何時間，以擷取資料的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-142">You can call the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method programmatically at any time to retrieve data.</span></span>  
  
 <span data-ttu-id="21d7d-143">如需資料繫結控制項繫結至資料來源控制項的詳細資訊，請參閱[繫結至資料使用資料來源控制項](http://msdn.microsoft.com/library/e41adfff-8fb8-449e-9cd1-9bd49788c5f7)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-143">For more information about binding data-bound controls to data source controls, see [Binding to Data Using a Data Source Control](http://msdn.microsoft.com/library/e41adfff-8fb8-449e-9cd1-9bd49788c5f7).</span></span>  
  
<a name="performing_data_operations"></a>   
## <a name="performing-data-operations"></a><span data-ttu-id="21d7d-144">執行資料作業</span><span class="sxs-lookup"><span data-stu-id="21d7d-144">Performing Data Operations</span></span>  
 <span data-ttu-id="21d7d-145">根據商務的功能物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項使用，您可以執行資料作業，例如更新、 插入和刪除。</span><span class="sxs-lookup"><span data-stu-id="21d7d-145">Depending on the capabilities of the business object that the <xref:System.Web.UI.WebControls.ObjectDataSource> control works with, you can perform data operations, such as updates, insertions, and deletions.</span></span> <span data-ttu-id="21d7d-146">若要執行這些資料作業，設定適當的方法名稱和任何您想要執行的作業相關聯的參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-146">To perform these data operations, set the appropriate method name and any associated parameters for the operation that you want to perform.</span></span> <span data-ttu-id="21d7d-147">例如，更新作業中，設定<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性名稱的商務物件方法會執行更新，並將任何必要的參數來<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-147">For example, for an update operation, set the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property to the name of the business object method that performs updates and add any required parameters to the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-148">如果<xref:System.Web.UI.WebControls.ObjectDataSource>控制項是與資料繫結控制項產生關聯，會將參數加入資料繫結控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-148">If the <xref:System.Web.UI.WebControls.ObjectDataSource> control is associated with a data-bound control, the parameters are added by the data-bound control.</span></span> <span data-ttu-id="21d7d-149">在此情況下，您需要確定方法的參數名稱相符的資料繫結控制項中的欄位名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-149">In this case, you need to ensure that the parameter names of the method match the field names in the data-bound control.</span></span> <span data-ttu-id="21d7d-150">在執行更新時<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>呼叫方法時，可以明確地您的程式碼也會自動由資料繫結控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-150">The update is performed when the <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> method is called, either explicitly by your code or automatically by a data-bound control.</span></span> <span data-ttu-id="21d7d-151">遵循相同的一般模式<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>和<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-151">The same general pattern is followed for <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> and <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> operations.</span></span> <span data-ttu-id="21d7d-152">商務物件會假設為會執行這些類型的資料作業的一筆記錄一次而批次處理。</span><span class="sxs-lookup"><span data-stu-id="21d7d-152">Business objects are assumed to perform these types of data operations one record at a time, rather than batched.</span></span>  
  
<a name="filtering_data"></a>   
## <a name="filtering-data"></a><span data-ttu-id="21d7d-153">篩選資料</span><span class="sxs-lookup"><span data-stu-id="21d7d-153">Filtering Data</span></span>  
 <span data-ttu-id="21d7d-154"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項可以篩選所擷取的資料<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性，如果資料以傳回<xref:System.Data.DataSet>或<xref:System.Data.DataTable>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-154">The <xref:System.Web.UI.WebControls.ObjectDataSource> control can filter data that is retrieved by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property, if the data is returned as a <xref:System.Data.DataSet> or <xref:System.Data.DataTable> object.</span></span> <span data-ttu-id="21d7d-155">您可以設定<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性，即可篩選運算式所使用的格式字串的語法，以及將值繫結至參數中指定的運算式中<xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-155">You can set the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property to a filtering expression by using a format string syntax and bind values in the expression to parameters that are specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> collection.</span></span>  
  
<a name="caching"></a>   
## <a name="caching"></a><span data-ttu-id="21d7d-156">快取</span><span class="sxs-lookup"><span data-stu-id="21d7d-156">Caching</span></span>  
 <span data-ttu-id="21d7d-157">雖然<xref:System.Web.UI.WebControls.ObjectDataSource>不會保留執行個體在多個要求的商務物件，它可以快取的呼叫所識別的方法結果<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-157">Although the <xref:System.Web.UI.WebControls.ObjectDataSource> does not retain the instance of the business object across multiple requests, it can cache the result of calling the method identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span> <span data-ttu-id="21d7d-158">當資料快取，後續呼叫時<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法會傳回快取的資料，而不要建立商務物件，然後呼叫其<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>使用反映。</span><span class="sxs-lookup"><span data-stu-id="21d7d-158">While the data is cached, subsequent calls to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method return the cached data instead of creating the business object and calling its <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> using reflection.</span></span> <span data-ttu-id="21d7d-159">快取可讓您避免建立物件，然後呼叫其資料方法，但會犧牲記憶體，在 Web 伺服器上。</span><span class="sxs-lookup"><span data-stu-id="21d7d-159">Caching lets you avoid creating the object and calling its data method at the expense of memory on the Web server.</span></span> <span data-ttu-id="21d7d-160"><xref:System.Web.UI.WebControls.ObjectDataSource>自動快取資料時<xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A>屬性設定為`true`，而<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>屬性設定為快取會儲存資料快取會捨棄之前的秒數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-160">The <xref:System.Web.UI.WebControls.ObjectDataSource> automatically caches data when the <xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A> property is set to `true`, and the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> property is set to the number of seconds that the cache stores data before the cache is discarded.</span></span> <span data-ttu-id="21d7d-161">您也可以指定<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>屬性和選用<xref:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-161">You can also specify a <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> property and an optional <xref:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency%2A> property.</span></span> <span data-ttu-id="21d7d-162"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項可讓您快取所有類型的資料，但您應該不會快都取保留資源或無法共用服務的多個要求的狀態的物件 (例如，開啟<xref:System.Data.SqlClient.SqlDataReader>物件)，因為相同的執行個體的物件將用於服務的多個要求。</span><span class="sxs-lookup"><span data-stu-id="21d7d-162">The <xref:System.Web.UI.WebControls.ObjectDataSource> control allows you to cache all types of data, but you should not cache objects that retain resources or state that cannot be shared to service multiple requests (for example, an open <xref:System.Data.SqlClient.SqlDataReader> object), because the same instance of the object will be used to service multiple requests.</span></span>  
  
<a name="features"></a>   
## <a name="features"></a><span data-ttu-id="21d7d-163">功能</span><span class="sxs-lookup"><span data-stu-id="21d7d-163">Features</span></span>  
 <span data-ttu-id="21d7d-164">下表描述的功能<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-164">The following table describes the features of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
|<span data-ttu-id="21d7d-165">功能</span><span class="sxs-lookup"><span data-stu-id="21d7d-165">Capability</span></span>|<span data-ttu-id="21d7d-166">需求</span><span class="sxs-lookup"><span data-stu-id="21d7d-166">Requirements</span></span>|  
|----------------|------------------|  
|<span data-ttu-id="21d7d-167">選取</span><span class="sxs-lookup"><span data-stu-id="21d7d-167">Selecting</span></span>|<span data-ttu-id="21d7d-168">設定<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>公司名稱的屬性物件中選取的資料，方法，並包括任何必要的參數中<xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>集合以程式設計方式或使用資料繫結控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-168">Set the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property to the name of the business object method that selects data, and include any necessary parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> collection either programmatically or by using a data-bound control.</span></span>|  
|<span data-ttu-id="21d7d-169">排序</span><span class="sxs-lookup"><span data-stu-id="21d7d-169">Sorting</span></span>|<span data-ttu-id="21d7d-170">設定<xref:System.Web.UI.WebControls.ObjectDataSource.SortParameterName%2A>屬性中的參數名稱<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>帶有排序準則的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-170">Set the <xref:System.Web.UI.WebControls.ObjectDataSource.SortParameterName%2A> property to the name of the parameter in the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> method that carries the sort criteria.</span></span>|  
|<span data-ttu-id="21d7d-171">篩選</span><span class="sxs-lookup"><span data-stu-id="21d7d-171">Filtering</span></span>|<span data-ttu-id="21d7d-172">設定<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性篩選運算式，並選擇性地加入任何參數，以便<xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>集合來篩選的資料時<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-172">Set the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property to a filtering expression and optionally add any parameters to the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> collection to filter the data when the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method is called.</span></span> <span data-ttu-id="21d7d-173">所指定的方法<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性必須傳回<xref:System.Data.DataSet>或<xref:System.Data.DataTable>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-173">The method specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property must return a <xref:System.Data.DataSet> or <xref:System.Data.DataTable>.</span></span>|  
|<span data-ttu-id="21d7d-174">分頁</span><span class="sxs-lookup"><span data-stu-id="21d7d-174">Paging</span></span>|<span data-ttu-id="21d7d-175">支援資料來源分頁，如果<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>方法包含要擷取的記錄數目上限和要擷取的第一個記錄索引的參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-175">Data source paging is supported, if the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> method contains parameters for the maximum number of records to retrieve and the index of the first record to retrieve.</span></span> <span data-ttu-id="21d7d-176">這些參數的名稱必須在設定<xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A>和<xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A>屬性，分別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-176">The names of those parameters must be set in the  <xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A> and <xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A> properties, respectively.</span></span> <span data-ttu-id="21d7d-177">資料繫結控制項可能會執行分頁本身，即使<xref:System.Web.UI.WebControls.ObjectDataSource>控制項不支援直接在所指定的方法中的分頁<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-177">A data-bound control might be able to perform paging itself, even if the <xref:System.Web.UI.WebControls.ObjectDataSource> control does not support paging directly in the method specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span> <span data-ttu-id="21d7d-178">資料繫結控制項，可以執行這項操作的需求是所指定的方法<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性傳回物件，用於實作<xref:System.Collections.ICollection>介面。</span><span class="sxs-lookup"><span data-stu-id="21d7d-178">The requirement for the data-bound control to be able to do this is that the method specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property return an object that implements the <xref:System.Collections.ICollection> interface.</span></span>|  
|<span data-ttu-id="21d7d-179">Updating</span><span class="sxs-lookup"><span data-stu-id="21d7d-179">Updating</span></span>|<span data-ttu-id="21d7d-180">設定<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性設為名稱的商務物件方法會更新資料，並包括任何必要的參數中<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-180">Set the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property to the name of the business object method that updates data, and include any necessary parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection.</span></span>|  
|<span data-ttu-id="21d7d-181">Deleting</span><span class="sxs-lookup"><span data-stu-id="21d7d-181">Deleting</span></span>|<span data-ttu-id="21d7d-182">設定<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>屬性設為名稱的商務物件方法或函式會刪除資料，並包括任何必要的參數中<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-182">Set the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property to the name of the business object method or function that deletes data, and include any necessary parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection.</span></span>|  
|<span data-ttu-id="21d7d-183">插入</span><span class="sxs-lookup"><span data-stu-id="21d7d-183">Inserting</span></span>|<span data-ttu-id="21d7d-184">設定<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性設為名稱的商務物件方法或函式插入資料，並包括任何必要的參數中<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-184">Set the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property to the name of the business object method or function that inserts data, and include any necessary parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection.</span></span>|  
|<span data-ttu-id="21d7d-185">快取</span><span class="sxs-lookup"><span data-stu-id="21d7d-185">Caching</span></span>|<span data-ttu-id="21d7d-186">設定<xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A>屬性`true`，而<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>和<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>根據您想要針對您快取資料的快取行為的屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-186">Set the <xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A> property to `true`, and the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> and <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> properties according to the caching behavior you want for your cached data.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="21d7d-187">當您使用<xref:System.Web.UI.WebControls.ObjectDataSource>類別用來更新或插入資料，會在用戶端輸入的字串不自動轉換從用戶端文化特性格式為伺服器的文化特性格式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-187">When you use the <xref:System.Web.UI.WebControls.ObjectDataSource> class to update or insert data, strings that are entered at the client are not automatically converted from the client culture format to the server culture format.</span></span> <span data-ttu-id="21d7d-188">例如，用戶端文化特性可能會與日期格式，指定 DD/MM/YYYY，而且在伺服器上的日期格式可能 MM/DD/YYYY。</span><span class="sxs-lookup"><span data-stu-id="21d7d-188">For example, the client culture might specify DD/MM/YYYY as the date format, and the date format on the server might be MM/DD/YYYY.</span></span> <span data-ttu-id="21d7d-189">在此情況下，會在輸入 2009 年 10 月 5 日<xref:System.Web.UI.WebControls.TextBox>為 2009 年 5 月 10 日的控制項，但是會被解譯為 2009 年 10 日。</span><span class="sxs-lookup"><span data-stu-id="21d7d-189">In that case, October 5, 2009 would be entered in a <xref:System.Web.UI.WebControls.TextBox> control as 5/10/2009 but would be interpreted as May 10, 2009.</span></span> <span data-ttu-id="21d7d-190">2009 年 10 月 15 日會輸入為 15/10/2009年，成為無效的日期會遭到拒絕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-190">October 15, 2009 would be entered as 15/10/2009, and would be rejected as an invalid date.</span></span>  
  
<a name="data_view"></a>   
## <a name="data-view"></a><span data-ttu-id="21d7d-191">資料檢視</span><span class="sxs-lookup"><span data-stu-id="21d7d-191">Data View</span></span>  
 <span data-ttu-id="21d7d-192">如同所有的資料來源控制項<xref:System.Web.UI.WebControls.ObjectDataSource>控制項是相關聯的資料來源檢視類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-192">As with all data source controls, the <xref:System.Web.UI.WebControls.ObjectDataSource> control is associated with a data source view class.</span></span> <span data-ttu-id="21d7d-193">雖然<xref:System.Web.UI.WebControls.ObjectDataSource>控制項是網頁開發人員用來處理資料的介面<xref:System.Web.UI.WebControls.ObjectDataSourceView>類別是資料繫結控制項所使用的介面。</span><span class="sxs-lookup"><span data-stu-id="21d7d-193">While the <xref:System.Web.UI.WebControls.ObjectDataSource> control is the interface that the page developer uses to work with data, the <xref:System.Web.UI.WebControls.ObjectDataSourceView> class is the interface that data-bound controls work with.</span></span> <span data-ttu-id="21d7d-194">此外，<xref:System.Web.UI.WebControls.ObjectDataSourceView>類別說明資料來源控制項的功能，並執行實際工作。</span><span class="sxs-lookup"><span data-stu-id="21d7d-194">Additionally, the <xref:System.Web.UI.WebControls.ObjectDataSourceView> class describes the capabilities of the data source control, and performs the actual work.</span></span> <span data-ttu-id="21d7d-195"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項有只有一個相關聯<xref:System.Web.UI.WebControls.ObjectDataSourceView>，一律會命名為`DefaultView`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-195">The <xref:System.Web.UI.WebControls.ObjectDataSource> control has only one associated <xref:System.Web.UI.WebControls.ObjectDataSourceView>, and it is always named `DefaultView`.</span></span> <span data-ttu-id="21d7d-196">雖然<xref:System.Web.UI.WebControls.ObjectDataSourceView>物件由<xref:System.Web.UI.WebControls.ObjectDataSource.GetView%2A>方法，其屬性和方法的許多包裝，且直接以公開<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-196">While the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object is exposed by the <xref:System.Web.UI.WebControls.ObjectDataSource.GetView%2A> method, many of its properties and methods are wrapped and exposed directly by the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-197">在幕後<xref:System.Web.UI.WebControls.ObjectDataSourceView>物件執行所有的資料作業，包括擷取、 插入、 更新、 刪除、 篩選和排序資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-197">Behind the scenes, the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object performs all data operations, including retrieving, inserting, updating, deleting, filtering, and sorting the data.</span></span> <span data-ttu-id="21d7d-198">如需詳細資訊，請參閱<xref:System.Web.UI.WebControls.ObjectDataSourceView>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-198">For more information, see <xref:System.Web.UI.WebControls.ObjectDataSourceView>.</span></span>  
  
<a name="using_linq_to_sql"></a>   
## <a name="using-linq-to-sql"></a><span data-ttu-id="21d7d-199">使用 LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="21d7d-199">Using LINQ to SQL</span></span>  
 <span data-ttu-id="21d7d-200">您可以使用<xref:System.Web.UI.WebControls.ObjectDataSource>與 LINQ to SQL 類別的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-200">You can use the <xref:System.Web.UI.WebControls.ObjectDataSource> control with a LINQ to SQL class.</span></span> <span data-ttu-id="21d7d-201">若要這樣做，您將<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性設為資料內容類別的名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-201">To do so, you set the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property to the name of the data-context class.</span></span> <span data-ttu-id="21d7d-202">您也設定<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>，和<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>執行對應作業的資料內容類別中方法的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-202">You also set the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>, and <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> methods to the methods in the data-context class that perform the corresponding operations.</span></span> <span data-ttu-id="21d7d-203">您必須建立事件處理常式<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>才能取消資料內容類別的處置事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-203">You must create an event handler for the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event in order to cancel disposing of the data-context class.</span></span> <span data-ttu-id="21d7d-204">這是必要步驟，因為 LINQ to SQL 支援延後的執行，而<xref:System.Web.UI.WebControls.ObjectDataSource>控制項嘗試處置之後選取作業的資料內容。</span><span class="sxs-lookup"><span data-stu-id="21d7d-204">This step is necessary because LINQ to SQL supports deferred execution, whereas the <xref:System.Web.UI.WebControls.ObjectDataSource> control tries to dispose the data context after the Select operation.</span></span> <span data-ttu-id="21d7d-205">如需如何建立 LINQ to SQL 類別的詳細資訊，請參閱[How to： 建立 LINQ to SQL 類別，在 Web 專案](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-205">For more information about how to create LINQ to SQL classes, see [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081).</span></span> <span data-ttu-id="21d7d-206">如需如何取消資料內容類別的處置的範例，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-206">For an example of how to cancel the disposing of a data context class, see the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event.</span></span>  
  
## <a name="using-the-entity-framework"></a><span data-ttu-id="21d7d-207">使用 Entity Framework</span><span class="sxs-lookup"><span data-stu-id="21d7d-207">Using the Entity Framework</span></span>  
 <span data-ttu-id="21d7d-208">您也可以使用<xref:System.Web.UI.WebControls.ObjectDataSource>與 Entity Framework 的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-208">You can also use the <xref:System.Web.UI.WebControls.ObjectDataSource> control with the Entity Framework.</span></span> <span data-ttu-id="21d7d-209">如需詳細資訊，請參閱[使用 Entity Framework 和 ObjectDataSource 控制項](http://go.microsoft.com/fwlink/?LinkId=209117)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-209">For more information, see [Using the Entity Framework and the ObjectDataSource Control](http://go.microsoft.com/fwlink/?LinkId=209117).</span></span>  
  
<a name="declarative_syntax"></a>   
## <a name="declarative-syntax"></a><span data-ttu-id="21d7d-210">宣告式語法</span><span class="sxs-lookup"><span data-stu-id="21d7d-210">Declarative Syntax</span></span>  
  
```  
<asp:ObjectDataSource  
    CacheDuration="string|Infinite"  
    CacheExpirationPolicy="Absolute|Sliding"  
    CacheKeyDependency="string"  
    ConflictDetection="OverwriteChanges|CompareAllValues"  
    ConvertNullToDBNull="True|False"  
    DataObjectTypeName="string"  
    DeleteMethod="string"  
    EnableCaching="True|False"  
    EnablePaging="True|False"  
    EnableTheming="True|False"  
    EnableViewState="True|False"  
    FilterExpression="string"  
    ID="string"  
    InsertMethod="string"  
    MaximumRowsParameterName="string"  
    OldValuesParameterFormatString="string"  
    OnDataBinding="DataBinding event handler"  
    OnDeleted="Deleted event handler"  
    OnDeleting="Deleting event handler"  
    OnDisposed="Disposed event handler"  
    OnFiltering="Filtering event handler"  
    OnInit="Init event handler"  
    OnInserted="Inserted event handler"  
    OnInserting="Inserting event handler"  
    OnLoad="Load event handler"  
    OnObjectCreated="ObjectCreated event handler"  
    OnObjectCreating="ObjectCreating event handler"  
    OnObjectDisposing="ObjectDisposing event handler"  
    OnPreRender="PreRender event handler"  
    OnSelected="Selected event handler"  
    OnSelecting="Selecting event handler"  
    OnUnload="Unload event handler"  
    OnUpdated="Updated event handler"  
    OnUpdating="Updating event handler"  
    runat="server"  
    SelectCountMethod="string"  
    SelectMethod="string"  
    SkinID="string"  
    SortParameterName="string"  
    SqlCacheDependency="string"  
    StartRowIndexParameterName="string"  
    TypeName="string"  
    UpdateMethod="string"  
    Visible="True|False"  
>  
        <DeleteParameters>  
                <asp:ControlParameter  
                    ControlID="string"  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    PropertyName="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:CookieParameter  
                    ConvertEmptyStringToNull="True|False"  
                    CookieName="string"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:FormParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    FormField="string"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:Parameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:ProfileParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    PropertyName="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:QueryStringParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    QueryStringField="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:SessionParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    SessionField="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
        </DeleteParameters>  
        <FilterParameters>  
                <asp:ControlParameter  
                    ControlID="string"  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    PropertyName="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:CookieParameter  
                    ConvertEmptyStringToNull="True|False"  
                    CookieName="string"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:FormParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    FormField="string"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:Parameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:ProfileParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    PropertyName="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:QueryStringParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    QueryStringField="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:SessionParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    SessionField="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
        </FilterParameters>  
        <InsertParameters>  
                <asp:ControlParameter  
                    ControlID="string"  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    PropertyName="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:CookieParameter  
                    ConvertEmptyStringToNull="True|False"  
                    CookieName="string"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:FormParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    FormField="string"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:Parameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:ProfileParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    PropertyName="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:QueryStringParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    QueryStringField="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:SessionParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    SessionField="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
        </InsertParameters>  
        <SelectParameters>  
                <asp:ControlParameter  
                    ControlID="string"  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    PropertyName="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:CookieParameter  
                    ConvertEmptyStringToNull="True|False"  
                    CookieName="string"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:FormParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    FormField="string"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:Parameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:ProfileParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    PropertyName="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:QueryStringParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    QueryStringField="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:SessionParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    SessionField="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
        </SelectParameters>  
        <UpdateParameters>  
                <asp:ControlParameter  
                    ControlID="string"  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    PropertyName="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:CookieParameter  
                    ConvertEmptyStringToNull="True|False"  
                    CookieName="string"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:FormParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    FormField="string"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:Parameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:ProfileParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    PropertyName="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:QueryStringParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    QueryStringField="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
                <asp:SessionParameter  
                    ConvertEmptyStringToNull="True|False"  
                    DefaultValue="string"  
                    Direction="Input|Output|InputOutput|ReturnValue"  
                    Name="string"  
                    SessionField="string"  
                    Size="integer"  
                    Type="Empty|Object|DBNull|Boolean|Char|SByte|  
                        Byte|Int16|UInt16|Int32|UInt32|Int64|UInt64|  
                        Single|Double|Decimal|DateTime|String"  
                />  
        </UpdateParameters>  
</asp:ObjectDataSource>  
```  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-211">本主題隨附了含有原始程式碼的 Visual Studio Web 站台專案：[下載](http://code.msdn.microsoft.com/Project/Download/FileDownload.aspx?ProjectName=aspnetmsdnexamples&DownloadId=14838)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-211">A Visual Studio Web site project with source code is available to accompany this topic: [Download](http://code.msdn.microsoft.com/Project/Download/FileDownload.aspx?ProjectName=aspnetmsdnexamples&DownloadId=14838).</span></span>  
  
 <span data-ttu-id="21d7d-212">此區段會顯示<xref:System.Web.UI.WebControls.ObjectDataSource>.aspx 在標記中，頁面上，它指出它所使用的商務物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-212">This section shows an <xref:System.Web.UI.WebControls.ObjectDataSource> in markup in an .aspx page and it shows the business objects that it works with.</span></span> <span data-ttu-id="21d7d-213">此範例是.aspx 網頁。</span><span class="sxs-lookup"><span data-stu-id="21d7d-213">The example is the .aspx page.</span></span> <span data-ttu-id="21d7d-214">它包含<xref:System.Web.UI.WebControls.GridView>繫結至控制項<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-214">It contains a <xref:System.Web.UI.WebControls.GridView> control that is bound to an <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-215"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項標記指定的商務物件的名稱和呼叫以擷取資料的商務物件方法的名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-215">The <xref:System.Web.UI.WebControls.ObjectDataSource> control markup specifies the name of the business object and the name of the business object method to call in order to retrieve data.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_1#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_1/CS/objds1cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_1#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_1/VB/objds1vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-216">下列範例顯示的商務物件<xref:System.Web.UI.WebControls.ObjectDataSource>.aspx 頁面中的控制項使用。</span><span class="sxs-lookup"><span data-stu-id="21d7d-216">The following example shows the business object that the <xref:System.Web.UI.WebControls.ObjectDataSource> control in the .aspx page uses.</span></span> <span data-ttu-id="21d7d-217">(許多其他<xref:System.Web.UI.WebControls.ObjectDataSource>程式碼範例也使用此商務物件。)此範例包含下列兩個基本類別：</span><span class="sxs-lookup"><span data-stu-id="21d7d-217">(Many other <xref:System.Web.UI.WebControls.ObjectDataSource> code examples use this business object also.) The example consists of the following two basic classes:</span></span>  
  
-   <span data-ttu-id="21d7d-218">`EmployeeLogic`類別是商務邏輯類別<xref:System.Web.UI.WebControls.ObjectDataSource>使用。</span><span class="sxs-lookup"><span data-stu-id="21d7d-218">The `EmployeeLogic` class is the business logic class that the <xref:System.Web.UI.WebControls.ObjectDataSource> uses.</span></span>  
  
-   <span data-ttu-id="21d7d-219">`NorthwindEmployee`類別會定義所傳回的資料物件`GetAllEmployees`方法`EmployeeLogic`類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-219">The `NorthwindEmployee` class defines the data object that is returned by the `GetAllEmployees` method of the `EmployeeLogic` class.</span></span>  
  
 <span data-ttu-id="21d7d-220">額外`NorthwindDataException`提供類別是為了方便起見。</span><span class="sxs-lookup"><span data-stu-id="21d7d-220">An additional `NorthwindDataException` class is provided as a convenience.</span></span>  
  
 <span data-ttu-id="21d7d-221">這組範例類別搭配使用 Microsoft SQL Server 和 Microsoft Access Northwind Traders 資料庫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-221">This set of example classes works with the Northwind Traders database, which is available with Microsoft SQL Server and Microsoft Access.</span></span> <span data-ttu-id="21d7d-222">如需完整的工作範例，您必須編譯並與.aspx 頁面提供的範例，會使用這些類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-222">For a complete working example, you must compile and use these classes with the .aspx page example that is provided.</span></span> <span data-ttu-id="21d7d-223">如需如何安裝 Northwind Traders 資料庫資訊，請參閱[如何： 安裝範例資料庫](http://msdn.microsoft.com/library/ed1291f6-604c-4972-ae22-0345c6dea12e)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-223">For information about how to install the Northwind Traders database, see [How to: Install Sample Databases](http://msdn.microsoft.com/library/ed1291f6-604c-4972-ae22-0345c6dea12e).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_1#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_1/CS/northwindemployee1.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_1#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_1/VB/northwindemployee1.vb#2)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Web.UI.IDataSource" />
    <altmember cref="T:System.Web.UI.DataSourceControl" />
    <altmember cref="T:System.Web.UI.WebControls.ObjectDataSourceView" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-224">初始化 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-224">Initializes a new instance of the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ObjectDataSource ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; ObjectDataSource();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-225">初始化 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-225">Initializes a new instance of the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> class.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ObjectDataSource (string typeName, string selectMethod);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string typeName, string selectMethod) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.#ctor(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (typeName As String, selectMethod As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; ObjectDataSource(System::String ^ typeName, System::String ^ selectMethod);" />
      <MemberSignature Language="F#" Value="new System.Web.UI.WebControls.ObjectDataSource : string * string -&gt; System.Web.UI.WebControls.ObjectDataSource" Usage="new System.Web.UI.WebControls.ObjectDataSource (typeName, selectMethod)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="typeName" Type="System.String" />
        <Parameter Name="selectMethod" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="typeName">
          <span data-ttu-id="21d7d-226">
            <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 使用之類別的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-226">The name of the class that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> works with.</span>
          </span>
        </param>
        <param name="selectMethod">
          <span data-ttu-id="21d7d-227">
            <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 叫用 (Invoke) 以擷取資料之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-227">The name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> invokes to retrieve data.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="21d7d-228">使用指定的型別名稱和資料擷取方法名稱，初始化 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-228">Initializes a new instance of the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> class with the specified type name and data retrieval method name.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-229">值`typeName`參數可以是位於 Bin 或 App_Code 目錄中的程式碼的不完整的類型或全域組件快取中註冊的程式碼的完整限定的類型名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-229">The value of the `typeName` parameter can be a partially qualified type for code that is located in the Bin or App_Code directory or a fully qualified type name for code that is registered in the global assembly cache.</span></span> <span data-ttu-id="21d7d-230">如果您使用全域組件快取，您必須加入至適當的參考`assemblies`Machine.config 或 Web.config 組態檔的區段。</span><span class="sxs-lookup"><span data-stu-id="21d7d-230">If you use the global assembly cache, you must add the appropriate reference to the `assemblies` section of the Machine.config or Web.config configuration file.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.TypeName" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectParameters" />
      </Docs>
    </Member>
    <Member MemberName="CacheDuration">
      <MemberSignature Language="C#" Value="public virtual int CacheDuration { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 CacheDuration" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.CacheDuration" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Property CacheDuration As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int CacheDuration { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.CacheDuration : int with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.CacheDuration" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(0)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Web.UI.DataSourceCacheDurationConverter))</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-231">取得或設定資料來源控制項快取 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> 屬性擷取之資料的時間長度 (以秒為單位)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-231">Gets or sets the length of time, in seconds, that the data source control caches data that is retrieved by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> property.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-232">
            <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 快取 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> 屬性引動之結果的秒數。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-232">The number of seconds that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> caches the results of a <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> property invocation.</span>
          </span>
          <span data-ttu-id="21d7d-233">預設值為 0。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-233">The default is 0.</span>
          </span>
          <span data-ttu-id="21d7d-234">值不能為負。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-234">The value cannot be negative.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-235"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援的資料快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-235">The <xref:System.Web.UI.WebControls.ObjectDataSource> control supports data caching.</span></span> <span data-ttu-id="21d7d-236">雖然快取資料，則呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法擷取資料，從快取，而不是從商務物件<xref:System.Web.UI.WebControls.ObjectDataSource>搭配。</span><span class="sxs-lookup"><span data-stu-id="21d7d-236">While data is cached, calls to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method retrieve data from the cache rather than from the business object that the <xref:System.Web.UI.WebControls.ObjectDataSource> works with.</span></span> <span data-ttu-id="21d7d-237">當快取到期時，<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法從商務物件，擷取資料，並再次快取資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-237">When the cache expires, the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method retrieves data from the business object, and then caches the data again.</span></span>  
  
 <span data-ttu-id="21d7d-238"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項會自動快取資料時<xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A>屬性設定為`true`和<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>屬性設定為值大於 0，表示快取，儲存資料快取項目之前的秒數會被捨棄。</span><span class="sxs-lookup"><span data-stu-id="21d7d-238">The <xref:System.Web.UI.WebControls.ObjectDataSource> control automatically caches data when the <xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A> property is set to `true` and the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> property is set to a value greater than 0, which indicates the number of seconds that the cache stores data before the cache entry is discarded.</span></span> <span data-ttu-id="21d7d-239">值為 0 指出無限長的快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-239">A value of 0 indicates an infinitely long cache.</span></span>  
  
 <span data-ttu-id="21d7d-240">持續時間的組合調整快取和<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>設定。</span><span class="sxs-lookup"><span data-stu-id="21d7d-240">The cache is regulated by a combination of the duration and the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> setting.</span></span> <span data-ttu-id="21d7d-241">如果<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>屬性設定為<xref:System.Web.UI.DataSourceCacheExpiry.Absolute>值<xref:System.Web.UI.WebControls.ObjectDataSource>會快取資料上的第一個呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法並保留它在記憶體中的最多的時間所指定的量<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-241">If the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> property is set to the <xref:System.Web.UI.DataSourceCacheExpiry.Absolute> value, the <xref:System.Web.UI.WebControls.ObjectDataSource> caches data on the first call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method and holds it in memory for, at most, the amount of time that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> property.</span></span> <span data-ttu-id="21d7d-242">如果需要記憶體，可能釋放資料持續時間的時間之前。</span><span class="sxs-lookup"><span data-stu-id="21d7d-242">The data might be released before the duration time, if the memory is needed.</span></span> <span data-ttu-id="21d7d-243">然後會在下一個呼叫會重新整理快取<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-243">The cache is then refreshed during the next call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span> <span data-ttu-id="21d7d-244">如果<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>屬性設定為<xref:System.Web.UI.DataSourceCacheExpiry.Sliding>值，資料來源控制項會快取資料上的第一個呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法，但卻會重設為其保留每個後續呼叫上的快取的時間間隔<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-244">If the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> property is set to <xref:System.Web.UI.DataSourceCacheExpiry.Sliding> value, the data source control caches data on the first call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method, but resets the time window for which it holds the cache on each subsequent call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span> <span data-ttu-id="21d7d-245">快取逾期相當的時間沒有活動是否<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>屬性自上次呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-245">The cache expires if there is no activity for a time that is equal to the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> property since the last call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-246">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-246">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-247">第一個程式碼範例示範如何<xref:System.Web.UI.WebControls.ObjectDataSource>物件支援快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-247">The first code example demonstrates how an <xref:System.Web.UI.WebControls.ObjectDataSource> object supports caching.</span></span> <span data-ttu-id="21d7d-248">第二個程式碼範例示範如何實作包裝函式方法會傳回<xref:System.Data.DataSet>物件啟用快取與<xref:System.Web.UI.WebControls.ObjectDataSource>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-248">The second code example demonstrates how to implement a wrapper method that returns a <xref:System.Data.DataSet> object to enable caching with an <xref:System.Web.UI.WebControls.ObjectDataSource> object.</span></span>  
  
 <span data-ttu-id="21d7d-249">下列程式碼範例示範如何<xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-249">The following code example demonstrates how an <xref:System.Web.UI.WebControls.ObjectDataSource> control supports caching.</span></span> <span data-ttu-id="21d7d-250">若要啟用快取，您必須實作的方法，擷取資料，以識別<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性，來傳回資料當做<xref:System.Data.DataSet>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-250">To enable caching, you must implement the method that retrieves data, which is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property, to return the data as a <xref:System.Data.DataSet> object.</span></span> <span data-ttu-id="21d7d-251">在此範例中，<xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A>屬性設定為`true`，而<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>和<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>屬性設定。</span><span class="sxs-lookup"><span data-stu-id="21d7d-251">In this example, the <xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A> property is set to `true`, and the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> and <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> properties are set.</span></span> <span data-ttu-id="21d7d-252"><xref:System.Web.UI.WebControls.ObjectDataSource>會快取所傳回的資料<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>30 秒的屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-252">The <xref:System.Web.UI.WebControls.ObjectDataSource> caches data that is returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property for 30 seconds.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_6#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_6/CS/objds6cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_6#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_6/VB/objds6vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-253">下列程式碼範例示範如何實作包裝函式方法會傳回<xref:System.Data.DataSet>物件啟用快取與<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-253">The following code example demonstrates how to implement a wrapper method that returns a <xref:System.Data.DataSet> object to enable caching with an <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-254">中的基底實作`EmployeeLogic`類別`GetAllEmployees`方法會傳回<xref:System.Collections.ArrayList>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-254">In the base implementation of the `EmployeeLogic` class, the `GetAllEmployees` method returns an <xref:System.Collections.ArrayList> object.</span></span> <span data-ttu-id="21d7d-255">而不是重構物件完全使用<xref:System.Web.UI.WebControls.ObjectDataSource>Web Form 網頁上，包裝函式方法名為`GetAllEmployeesAsDataSet`加入傳回一組`NorthwindEmployee`資料做為<xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-255">Instead of refactoring the object completely to work with the <xref:System.Web.UI.WebControls.ObjectDataSource> on a Web Forms page, a wrapper method named `GetAllEmployeesAsDataSet` is added that returns a set of `NorthwindEmployee` data as a <xref:System.Data.DataSet>.</span></span>  
  
 <span data-ttu-id="21d7d-256">這個程式碼範例是針對所提供之較大範例的一部分<xref:System.Web.UI.WebControls.ObjectDataSource>類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-256">This code example is part of a larger example provided for the <xref:System.Web.UI.WebControls.ObjectDataSource> class.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_5#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_5/CS/northwindemployee5.cs#3)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_5#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_5/VB/northwindemployee5.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.EnableCaching" />
      </Docs>
    </Member>
    <Member MemberName="CacheExpirationPolicy">
      <MemberSignature Language="C#" Value="public virtual System.Web.UI.DataSourceCacheExpiry CacheExpirationPolicy { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.UI.DataSourceCacheExpiry CacheExpirationPolicy" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Property CacheExpirationPolicy As DataSourceCacheExpiry" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::Web::UI::DataSourceCacheExpiry CacheExpirationPolicy { System::Web::UI::DataSourceCacheExpiry get(); void set(System::Web::UI::DataSourceCacheExpiry value); };" />
      <MemberSignature Language="F#" Value="member this.CacheExpirationPolicy : System.Web.UI.DataSourceCacheExpiry with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(Mono.Cecil.CustomAttributeArgument)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.DataSourceCacheExpiry</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-257">取得或設定快取到期行為，當與持續期間搭配使用時，用來描述資料來源控制項所使用的快取行為。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-257">Gets or sets the cache expiration behavior that, when combined with the duration, describes the behavior of the cache that the data source control uses.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-258">其中一個 <see cref="T:System.Web.UI.DataSourceCacheExpiry" /> 值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-258">One of the <see cref="T:System.Web.UI.DataSourceCacheExpiry" /> values.</span>
          </span>
          <span data-ttu-id="21d7d-259">預設值為 <see cref="F:System.Web.UI.DataSourceCacheExpiry.Absolute" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-259">The default is <see cref="F:System.Web.UI.DataSourceCacheExpiry.Absolute" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-260"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援的資料快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-260">The <xref:System.Web.UI.WebControls.ObjectDataSource> control supports data caching.</span></span> <span data-ttu-id="21d7d-261">雖然快取資料，則呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法擷取資料，從快取，而不是從商務物件<xref:System.Web.UI.WebControls.ObjectDataSource>搭配。</span><span class="sxs-lookup"><span data-stu-id="21d7d-261">While data is cached, calls to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method retrieve data from the cache rather than from the business object that the <xref:System.Web.UI.WebControls.ObjectDataSource> works with.</span></span> <span data-ttu-id="21d7d-262">當快取到期時，<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法從商務物件，擷取資料，並再次快取資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-262">When the cache expires, the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method retrieves data from the business object, and then caches the data again.</span></span>  
  
 <span data-ttu-id="21d7d-263"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項會自動快取資料時<xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A>屬性設定為`true`和<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>屬性設定為值大於 0，表示快取，儲存資料快取項目之前的秒數會被捨棄。</span><span class="sxs-lookup"><span data-stu-id="21d7d-263">The <xref:System.Web.UI.WebControls.ObjectDataSource> control automatically caches data when the <xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A> property is set to `true` and the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> property is set to a value greater than 0, which indicates the number of seconds that the cache stores data before the cache entry is discarded.</span></span> <span data-ttu-id="21d7d-264">值為 0 表示無限長快取期間。</span><span class="sxs-lookup"><span data-stu-id="21d7d-264">A value of 0 indicates an infinitely long cache period.</span></span>  
  
 <span data-ttu-id="21d7d-265">持續時間的組合調整快取和<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>設定。</span><span class="sxs-lookup"><span data-stu-id="21d7d-265">The cache is regulated by a combination of the duration and the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> setting.</span></span> <span data-ttu-id="21d7d-266">如果<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>屬性設定為<xref:System.Web.UI.DataSourceCacheExpiry.Absolute>值<xref:System.Web.UI.WebControls.ObjectDataSource>會快取資料上的第一個呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法並保留它在記憶體中的最多的時間所指定的量<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-266">If the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> property is set to the <xref:System.Web.UI.DataSourceCacheExpiry.Absolute> value, the <xref:System.Web.UI.WebControls.ObjectDataSource> caches data on the first call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method and holds it in memory for, at most, the amount of time that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> property.</span></span> <span data-ttu-id="21d7d-267">如果需要記憶體，可能釋放資料持續時間的時間之前。</span><span class="sxs-lookup"><span data-stu-id="21d7d-267">The data might be released before the duration time, if the memory is needed.</span></span> <span data-ttu-id="21d7d-268">然後會在下一個呼叫會重新整理快取<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-268">The cache is then refreshed during the next call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span> <span data-ttu-id="21d7d-269">如果<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>屬性設定為<xref:System.Web.UI.DataSourceCacheExpiry.Sliding>值，資料來源控制項會快取資料上的第一個呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法，但卻會重設為其保留快取中的每個後續呼叫的時間間隔<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-269">If the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> property is set to the <xref:System.Web.UI.DataSourceCacheExpiry.Sliding> value, the data source control caches data on the first call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method, but resets the time window for which it holds the cache for each subsequent call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span> <span data-ttu-id="21d7d-270">快取逾期相當的時間沒有活動是否<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>屬性自上次呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-270">The cache expires if there is no activity for a time that is equal to the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> property since the last call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-271">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-271">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-272">第一個程式碼範例示範如何<xref:System.Web.UI.WebControls.ObjectDataSource>物件支援篩選和快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-272">The first code example demonstrates how an <xref:System.Web.UI.WebControls.ObjectDataSource> object supports filtering and caching.</span></span> <span data-ttu-id="21d7d-273">第二個程式碼範例示範如何實作包裝函式方法會傳回<xref:System.Data.DataSet>物件，讓快取和使用篩選<xref:System.Web.UI.WebControls.ObjectDataSource>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-273">The second code example demonstrates how to implement a wrapper method that returns a <xref:System.Data.DataSet> object to enable caching and filtering with an <xref:System.Web.UI.WebControls.ObjectDataSource> object.</span></span>  
  
 <span data-ttu-id="21d7d-274">下列程式碼範例示範如何<xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援篩選和快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-274">The following code example demonstrates how an <xref:System.Web.UI.WebControls.ObjectDataSource> control supports filtering and caching.</span></span> <span data-ttu-id="21d7d-275">若要啟用篩選和快取，您必須實作的方法，擷取資料，以識別<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性，來傳回資料當做<xref:System.Data.DataSet>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-275">To enable filtering and caching, you must implement the method that retrieves data, which is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property, to return the data as a <xref:System.Data.DataSet> object.</span></span> <span data-ttu-id="21d7d-276">在此範例中，啟用快取因為`EmployeeLogic`物件傳回資料做為<xref:System.Data.DataSet>、<xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A>屬性設定為`true`，而<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>和<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>屬性設定。</span><span class="sxs-lookup"><span data-stu-id="21d7d-276">In this example, caching is enabled because the `EmployeeLogic` object returns data as a <xref:System.Data.DataSet>, the <xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A> property is set to `true`, and the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> and <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> properties are set.</span></span> <span data-ttu-id="21d7d-277"><xref:System.Web.UI.WebControls.ObjectDataSource>會快取所傳回的資料<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>30 秒的屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-277">The <xref:System.Web.UI.WebControls.ObjectDataSource> caches data that is returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property for 30 seconds.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_6#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_6/CS/objds6cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_6#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_6/VB/objds6vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-278">下列程式碼範例示範如何實作包裝函式方法會傳回<xref:System.Data.DataSet>物件，讓快取和使用篩選<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-278">The following code example demonstrates how to implement a wrapper method that returns a <xref:System.Data.DataSet> object to enable caching and filtering with an <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-279">中的基底實作`EmployeeLogic`類別`GetAllEmployees`方法會傳回<xref:System.Collections.ArrayList>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-279">In the base implementation of the `EmployeeLogic` class, the `GetAllEmployees` method returns an <xref:System.Collections.ArrayList>.</span></span> <span data-ttu-id="21d7d-280">而不是重構物件完全使用<xref:System.Web.UI.WebControls.ObjectDataSource>Web Form 網頁上，包裝函式方法名為`GetAllEmployeesAsDataSet`加入傳回一組`NorthwindEmployee`資料做為<xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-280">Instead of refactoring the object completely to work with the <xref:System.Web.UI.WebControls.ObjectDataSource> on a Web Forms page, a wrapper method named `GetAllEmployeesAsDataSet` is added that returns a set of `NorthwindEmployee` data as a <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="21d7d-281">這個程式碼範例是針對所提供之較大範例的一部分<xref:System.Web.UI.WebControls.ObjectDataSource>類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-281">This code example is part of a larger example provided for the <xref:System.Web.UI.WebControls.ObjectDataSource> class.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_5#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_5/CS/northwindemployee5.cs#3)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_5#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_5/VB/northwindemployee5.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.CacheDuration" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.EnableCaching" />
      </Docs>
    </Member>
    <Member MemberName="CacheKeyDependency">
      <MemberSignature Language="C#" Value="public virtual string CacheKeyDependency { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string CacheKeyDependency" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Property CacheKeyDependency As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ CacheKeyDependency { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.CacheKeyDependency : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-282">取得或設定使用者定義的索引鍵相依性，連結至資料來源控制項所建立的所有資料快取物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-282">Gets or sets a user-defined key dependency that is linked to all data cache objects that are created by the data source control.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-283">索引鍵，識別 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 建立的所有快取物件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-283">A key that identifies all cache objects created by the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-284"><xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A>屬性可以設定為任何任意字串值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-284">The <xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A> property can be set to any arbitrary string value.</span></span>  
  
 <span data-ttu-id="21d7d-285">當索引鍵過期時，所有快取的物件也會明確過期。</span><span class="sxs-lookup"><span data-stu-id="21d7d-285">All cache objects are explicitly expired when the key is expired.</span></span> <span data-ttu-id="21d7d-286">這可讓您使快取項目所建立的<xref:System.Web.UI.WebControls.ObjectDataSource>從自己的網頁程式碼以程式設計的方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-286">This allows you to invalidate cache entries that are created by the <xref:System.Web.UI.WebControls.ObjectDataSource> from your own page code programmatically.</span></span>  
  
 <span data-ttu-id="21d7d-287"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援的資料快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-287">The <xref:System.Web.UI.WebControls.ObjectDataSource> control supports data caching.</span></span> <span data-ttu-id="21d7d-288">雖然快取資料，則呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法擷取資料，從快取，而不是從商務物件<xref:System.Web.UI.WebControls.ObjectDataSource>搭配。</span><span class="sxs-lookup"><span data-stu-id="21d7d-288">While data is cached, calls to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method retrieve data from the cache rather than from the business object that the <xref:System.Web.UI.WebControls.ObjectDataSource> works with.</span></span> <span data-ttu-id="21d7d-289">當快取到期時，<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法從商務物件，擷取資料，並再次快取資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-289">When the cache expires, the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method retrieves data from the business object, and then caches the data again.</span></span>  
  
 <span data-ttu-id="21d7d-290"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項會自動快取資料時<xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A>屬性設定為`true`和<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>屬性設定為值大於 0，表示快取，儲存資料快取項目之前的秒數會被捨棄。</span><span class="sxs-lookup"><span data-stu-id="21d7d-290">The <xref:System.Web.UI.WebControls.ObjectDataSource> control automatically caches data when the <xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A> property is set to `true` and the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> property is set to a value greater than 0, which indicates the number of seconds that the cache stores data before the cache entry is discarded.</span></span> <span data-ttu-id="21d7d-291">值為 0 指出無限長的快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-291">A value of 0 indicates an infinitely long cache.</span></span>  
  
 <span data-ttu-id="21d7d-292">您可以設定<xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A>屬性以建立所建立的所有快取項目之間的相依性<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和索引鍵。</span><span class="sxs-lookup"><span data-stu-id="21d7d-292">You can set the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A> property to create a dependency between all cache entries that are created by the <xref:System.Web.UI.WebControls.ObjectDataSource> control and the key.</span></span> <span data-ttu-id="21d7d-293">您可能會過期的快取項目以程式設計方式在任何時間索引鍵設定為已過期。</span><span class="sxs-lookup"><span data-stu-id="21d7d-293">You can expire all the cache entries programmatically at any time by expiring the key.</span></span> <span data-ttu-id="21d7d-294">使用過期的索引鍵<xref:System.Web.Caching.Cache.Remove%2A?displayProperty=nameWithType>與目前的方法<xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A>做為參數的值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-294">Expire the key by using the <xref:System.Web.Caching.Cache.Remove%2A?displayProperty=nameWithType> method with the current <xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A> value as the parameter.</span></span>  
  
 <span data-ttu-id="21d7d-295">唯一的快取項目建立的每個組合<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>，和<xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-295">A unique cache entry is created for every combination of the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>, and <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> properties.</span></span> <span data-ttu-id="21d7d-296">多個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項可以使用相同的快取項目在案例中使用相同的型別、 方法和參數的資料載入其中。</span><span class="sxs-lookup"><span data-stu-id="21d7d-296">Multiple <xref:System.Web.UI.WebControls.ObjectDataSource> controls can use the same cache entries in scenarios where they load data using the same type, method, and parameters.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-297">下列三個範例顯示 Web 網頁、 程式碼後置頁面類別和從 Northwind 資料庫中的 [員工] 資料表中擷取記錄的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-297">The following three examples show a Web page, a code-behind page class, and a data-access class that retrieve records from the Employees table in the Northwind database.</span></span>  
  
 <span data-ttu-id="21d7d-298">第一個範例顯示包含兩個的 Web 網頁<xref:System.Web.UI.WebControls.ObjectDataSource>控制項<xref:System.Web.UI.WebControls.DropDownList>控制項和<xref:System.Web.UI.WebControls.DetailsView>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-298">The first example shows a Web page that contains two <xref:System.Web.UI.WebControls.ObjectDataSource> controls, a <xref:System.Web.UI.WebControls.DropDownList> control, and a <xref:System.Web.UI.WebControls.DetailsView> control.</span></span> <span data-ttu-id="21d7d-299">第一個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和<xref:System.Web.UI.WebControls.DropDownList>控制項用來擷取並顯示資料庫中的員工名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-299">The first <xref:System.Web.UI.WebControls.ObjectDataSource> control and the <xref:System.Web.UI.WebControls.DropDownList> control are used to retrieve and display employee names from the database.</span></span> <span data-ttu-id="21d7d-300">第二個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和<xref:System.Web.UI.WebControls.DetailsView>控制項用來擷取及顯示員工記錄所選取的使用者。</span><span class="sxs-lookup"><span data-stu-id="21d7d-300">The second <xref:System.Web.UI.WebControls.ObjectDataSource> control and the <xref:System.Web.UI.WebControls.DetailsView> control are used to retrieve and display the employee record that is selected by the user.</span></span>  
  
 <span data-ttu-id="21d7d-301">啟用快取<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-301">Caching is enabled for the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-302">因此，每一筆記錄會擷取從資料庫一次。</span><span class="sxs-lookup"><span data-stu-id="21d7d-302">Therefore, each record is retrieved only one time from the database.</span></span> <span data-ttu-id="21d7d-303"><xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A>屬性設定為"EmployeeDetails"，但任何字串值可做為索引鍵。</span><span class="sxs-lookup"><span data-stu-id="21d7d-303">The <xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A> property is set to "EmployeeDetails", but any string value can work as the key.</span></span> <span data-ttu-id="21d7d-304">網頁也包括<xref:System.Web.UI.WebControls.Button>使用者可以按一下過期的快取的資料的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-304">The Web page also includes a <xref:System.Web.UI.WebControls.Button> control that the user can click to expire the cached data.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_18#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/Default2.aspx#3)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_18#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/Default2.aspx#3)]  
  
 <span data-ttu-id="21d7d-305">第二個範例顯示的處理常式<xref:System.Web.UI.Control.Load>事件和處理常式<xref:System.Web.UI.WebControls.Button.Click>事件<xref:System.Web.UI.WebControls.Button>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-305">The second example shows a handler for the <xref:System.Web.UI.Control.Load> event and a handler for the <xref:System.Web.UI.WebControls.Button.Click> event of the <xref:System.Web.UI.WebControls.Button> control.</span></span> <span data-ttu-id="21d7d-306"><xref:System.Web.UI.Control.Load>事件處理常式建立快取項目的索引鍵設定為<xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A>值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-306">The <xref:System.Web.UI.Control.Load> event handler creates a cache item with a key set to the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A> value.</span></span> <span data-ttu-id="21d7d-307"><xref:System.Web.UI.WebControls.Button.Click>事件處理常式中移除快取項目索引鍵是否等於<xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A>值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-307">The <xref:System.Web.UI.WebControls.Button.Click> event handler removes the cache item whose key is equal to the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A> value.</span></span> <span data-ttu-id="21d7d-308">當移除快取項目時，相依於索引鍵的所有快取的資料已過期。</span><span class="sxs-lookup"><span data-stu-id="21d7d-308">When the cache item is removed, all the cached data that is dependent on the key is expired.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_18#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/Default2.aspx.cs#4)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_18#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/Default2.aspx.vb#4)]  
  
 <span data-ttu-id="21d7d-309">第三個範例會顯示與 Northwind 資料庫互動的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-309">The third example shows the data access class that interacts with the Northwind database.</span></span> <span data-ttu-id="21d7d-310">類別會使用 LINQ 查詢 [員工] 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-310">The class uses LINQ to query the Employees table.</span></span> <span data-ttu-id="21d7d-311">這個範例需要 LINQ to SQL 類別表示 Northwind 資料庫的 Employees 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-311">The example requires a LINQ to SQL class that represents the Northwind database and the Employees table.</span></span> <span data-ttu-id="21d7d-312">如需詳細資訊，請參閱[How to： 建立 LINQ to SQL 類別，在 Web 專案](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-312">For more information, see [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_18#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/App_Code/EmployeeLogic.cs#5)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_18#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/App_Code/EmployeeLogic.vb#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.SqlCacheDependency" />
      </Docs>
    </Member>
    <Member MemberName="ConflictDetection">
      <MemberSignature Language="C#" Value="public System.Web.UI.ConflictOptions ConflictDetection { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.UI.ConflictOptions ConflictDetection" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection" />
      <MemberSignature Language="VB.NET" Value="Public Property ConflictDetection As ConflictOptions" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::ConflictOptions ConflictDetection { System::Web::UI::ConflictOptions get(); void set(System::Web::UI::ConflictOptions value); };" />
      <MemberSignature Language="F#" Value="member this.ConflictDetection : System.Web.UI.ConflictOptions with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.ConflictDetection" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(Mono.Cecil.CustomAttributeArgument)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.ConflictOptions</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-313">取得或設定值，判斷是只有新值傳遞至 <see langword="Update" /> 方法，還是舊值和新值都傳遞至 <see langword="Update" /> 方法。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-313">Gets or sets a value that determines whether or not just the new values are passed to the <see langword="Update" /> method or both the old and new values are passed to the <see langword="Update" /> method.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-314">其中一個 <see cref="T:System.Web.UI.ConflictOptions" /> 值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-314">One of the <see cref="T:System.Web.UI.ConflictOptions" /> values.</span>
          </span>
          <span data-ttu-id="21d7d-315">預設值為 <see cref="F:System.Web.UI.ConflictOptions.OverwriteChanges" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-315">The default is <see cref="F:System.Web.UI.ConflictOptions.OverwriteChanges" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-316">這個屬性會決定是否要將舊的和新值的參數套用至所指定的方法<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-316">This property determines whether parameters for old and new values are applied to the method specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property.</span></span> <span data-ttu-id="21d7d-317">比方說，如果該方法是由指定<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性會傳回<xref:System.Data.DataTable>控制項與資料行`Name`和`Number`，和<xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A>屬性設定為<xref:System.Web.UI.ConflictOptions.OverwriteChanges> 欄位中，會針對建立參數`Name`和`Number`如`Update`方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-317">For example, if the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property returns a <xref:System.Data.DataTable> control with the columns `Name` and `Number`, and the <xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A> property is set to the <xref:System.Web.UI.ConflictOptions.OverwriteChanges> field, parameters are created for `Name` and `Number` for the `Update` method.</span></span> <span data-ttu-id="21d7d-318">如果<xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A>屬性設定為<xref:System.Web.UI.ConflictOptions.CompareAllValues>值的建立參數`Name`， `Number`， `original_Name`，和`original_Number`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-318">If the <xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A> property is set to the <xref:System.Web.UI.ConflictOptions.CompareAllValues> value, parameters are created for `Name`, `Number`, `original_Name`, and `original_Number`.</span></span> <span data-ttu-id="21d7d-319">(取決於原始值參數的完整名稱<xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A>屬性。)<xref:System.Web.UI.WebControls.ObjectDataSource>然後判斷方法，是否在指定<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性具有相符的參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-319">(The exact name of the parameters for the original values depends on the <xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A> property.) The <xref:System.Web.UI.WebControls.ObjectDataSource> then determines whether the method that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property has parameters that match.</span></span>  
  
 <span data-ttu-id="21d7d-320">並行存取控制是用來控制如何讀取和多個用戶端存取和管理相同的資料時，存放區中變更資料的資料存放區的技術。</span><span class="sxs-lookup"><span data-stu-id="21d7d-320">Concurrency control is a technique that data stores use to control how data is read and changed in the store when multiple clients are accessing and manipulating the same data.</span></span> <span data-ttu-id="21d7d-321">例如，一個用戶端讀取資料並呈現給使用者，而另一個用戶端讀取相同的資料並呈現給不同的使用者。</span><span class="sxs-lookup"><span data-stu-id="21d7d-321">For example, one client reads data and presents it to a user, while another client reads the same data and presents it to a different user.</span></span> <span data-ttu-id="21d7d-322">如果兩個使用者更新的資料，並送出至資料存放區，可能會發生非預期的結果，因為兩個用戶端可能會提供不同的值為相同的資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-322">If both users update the data and submit it to the data storage, an unexpected result might occur, because both clients might provide different values for the same data.</span></span> <span data-ttu-id="21d7d-323">這被視為衝突。</span><span class="sxs-lookup"><span data-stu-id="21d7d-323">This is considered a conflict.</span></span> <span data-ttu-id="21d7d-324">藉由設定<xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A>屬性<xref:System.Web.UI.ConflictOptions.CompareAllValues>值`Update`方法可以再比較原始資料來源，以便偵測衝突，並視需要處理這類舊的和新值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-324">By setting the <xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A> property to the <xref:System.Web.UI.ConflictOptions.CompareAllValues> value, the `Update` method can then compare the old and new values to the original data source to detect conflicts and handle them as necessary.</span></span>  
  
 <span data-ttu-id="21d7d-325"><xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.ConflictDetection%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-325">The <xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.ConflictDetection%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.ConflictOptions" />
      </Docs>
    </Member>
    <Member MemberName="ConvertNullToDBNull">
      <MemberSignature Language="C#" Value="public bool ConvertNullToDBNull { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool ConvertNullToDBNull" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.ConvertNullToDBNull" />
      <MemberSignature Language="VB.NET" Value="Public Property ConvertNullToDBNull As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool ConvertNullToDBNull { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.ConvertNullToDBNull : bool with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.ConvertNullToDBNull" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-326">取得或設定值，指出傳遞至更新、傳入或刪除作業的 <see cref="T:System.Web.UI.WebControls.Parameter" /> 值是否由 <see cref="F:System.DBNull.Value" /> 控制項自動從 <see langword="null" /> 轉換為 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-326">Gets or sets a value indicating whether the <see cref="T:System.Web.UI.WebControls.Parameter" /> values that are passed to an update, insert, or delete operation are automatically converted from <see langword="null" /> to the <see cref="F:System.DBNull.Value" /> value by the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-327">如果 <see cref="T:System.Web.UI.WebControls.Parameter" /> 物件中傳遞至 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項的任何 <see langword="true" /> 值會自動轉換成 <see cref="F:System.DBNull.Value" /> 值，則為 <see langword="null" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-327">
              <see langword="true" />, if any <see langword="null" /> values in <see cref="T:System.Web.UI.WebControls.Parameter" /> objects passed to the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control are automatically converted to <see cref="F:System.DBNull.Value" /> values; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="21d7d-328">預設值為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-328">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-329">不會將轉換`null`至<xref:System.DBNull.Value>值會在執行階段發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="21d7d-329">Not converting `null` to the <xref:System.DBNull.Value> value can result in errors at run time.</span></span> <span data-ttu-id="21d7d-330">使用<xref:System.Web.UI.WebControls.ObjectDataSource.ConvertNullToDBNull%2A>屬性，指出是否<xref:System.Web.UI.WebControls.Parameter>值傳遞給更新、 插入或刪除作業會自動轉換從`null`至<xref:System.DBNull.Value>值<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-330">Use the <xref:System.Web.UI.WebControls.ObjectDataSource.ConvertNullToDBNull%2A> property to indicate whether <xref:System.Web.UI.WebControls.Parameter> values that are passed to an update, insert, or delete operation are automatically converted from `null` to the <xref:System.DBNull.Value> value by the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="F:System.DBNull.Value" />
        <altmember cref="T:System.Web.UI.WebControls.ObjectDataSource" />
      </Docs>
    </Member>
    <Member MemberName="DataObjectTypeName">
      <MemberSignature Language="C#" Value="public string DataObjectTypeName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string DataObjectTypeName" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName" />
      <MemberSignature Language="VB.NET" Value="Public Property DataObjectTypeName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ DataObjectTypeName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DataObjectTypeName : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-331">取得或設定類別的名稱，<see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項會將該類別用於更新、插入或刪除資料作業中的參數，而不會從資料繫結控制項傳遞個別的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-331">Gets or sets the name of a class that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control uses for a parameter in an update, insert, or delete data operation, instead of passing individual values from the data-bound control.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-332">部分或完整類別名稱，識別 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 可做為參數用於 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Insert" />、<see cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" /> 或 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" /> 作業的物件型別。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-332">A partially or fully qualified class name that identifies the type of the object that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> can use as a parameter for an <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Insert" />, <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" />, or a <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" /> operation.</span>
          </span>
          <span data-ttu-id="21d7d-333">預設為空字串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-333">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-334">而不是指定數個參數傳遞給<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>，和<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>方法，您可以建立數個資料欄位值彙總的一個物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-334">Instead of specifying several parameters that are passed to the <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>, and <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> methods, you can create one object that aggregates several data field values.</span></span> <span data-ttu-id="21d7d-335">這一個物件會傳遞至方法，而不是數個參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-335">This one object is passed to the methods, instead of several parameters.</span></span>  
  
 <span data-ttu-id="21d7d-336">預設行為<xref:System.Web.UI.WebControls.ObjectDataSource>繫結至資料繫結控制項的控制項時，就會建立資料繫結控制項<xref:System.Web.UI.WebControls.Parameter>資料來源中的每個參數的物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-336">The default behavior of an <xref:System.Web.UI.WebControls.ObjectDataSource> control that is bound to a data-bound control is that the data-bound control creates a <xref:System.Web.UI.WebControls.Parameter> object for each parameter in the data source.</span></span> <span data-ttu-id="21d7d-337">如果商務物件有許多欄位，則產生的方法也會有許多欄位。</span><span class="sxs-lookup"><span data-stu-id="21d7d-337">If the business object has many fields, the resulting method also has many fields.</span></span> <span data-ttu-id="21d7d-338"><xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性可讓您指定的類型具有每個資料欄位的屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-338">The <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property allows you to specify a type that has a property for each data field.</span></span> <span data-ttu-id="21d7d-339">然後，而不是將數個參數傳遞給方法，執行階段會建立一個物件，並設定其所有屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-339">Then, instead of passing several parameters to the method, the runtime creates one object and sets all of its properties.</span></span> <span data-ttu-id="21d7d-340">此物件會加入至方法呼叫的參數集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-340">This one object is added to the parameters collection for the method call.</span></span>  
  
 <span data-ttu-id="21d7d-341">所指定的型別<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性必須有預設建構函式沒有參數，所以<xref:System.Web.UI.WebControls.ObjectDataSource>控制項可以建立類型的執行個體。</span><span class="sxs-lookup"><span data-stu-id="21d7d-341">The type that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property must have a default constructor that has no parameters, so the <xref:System.Web.UI.WebControls.ObjectDataSource> control can create an instance of the type.</span></span> <span data-ttu-id="21d7d-342">類型也必須具有可設定屬性，可讓<xref:System.Web.UI.WebControls.ObjectDataSource>控制項將填入該物件會從資料繫結控制項的值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-342">The type must also have settable properties that allow the <xref:System.Web.UI.WebControls.ObjectDataSource> control to populate the object with values that are passed from the data-bound control.</span></span> <span data-ttu-id="21d7d-343">屬性名稱<xref:System.Web.UI.WebControls.ObjectDataSource>控制項應完全符合傳遞的資料繫結控制項的值的參數名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-343">The property names on the <xref:System.Web.UI.WebControls.ObjectDataSource> control are expected to exactly match the parameter names of values that are passed by the data-bound control.</span></span>  
  
 <span data-ttu-id="21d7d-344">當<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性設定和<xref:System.Web.UI.WebControls.ObjectDataSource>控制項已資料繫結控制項，所指定的方法相關聯<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>和<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>屬性必須各有一個中所指定之類型參數<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-344">When the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property is set and the <xref:System.Web.UI.WebControls.ObjectDataSource> control is associated with a data-bound control, the methods that are specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> and <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> properties must each have one parameter of the type that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property.</span></span> <span data-ttu-id="21d7d-345">如果<xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A>屬性設定為<xref:System.Web.UI.ConflictOptions.OverwriteChanges>值所指定的方法<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性必須有一個參數中指定之型別的<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-345">If the <xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A> property is set to the <xref:System.Web.UI.ConflictOptions.OverwriteChanges> value, the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property must have one parameter of the type that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property.</span></span> <span data-ttu-id="21d7d-346">如果<xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A>屬性設定為<xref:System.Web.UI.ConflictOptions.CompareAllValues>值所指定的方法<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性必須有兩個參數中指定之型別的<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-346">If the <xref:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection%2A> property is set to the <xref:System.Web.UI.ConflictOptions.CompareAllValues> value, the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property must have two parameters of the type that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property.</span></span> <span data-ttu-id="21d7d-347">第一個參數包含的原始值。第二個參數會包含新值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-347">The first parameter contains the original values; the second parameter contains the new values.</span></span>  
  
 <span data-ttu-id="21d7d-348"><xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.DataObjectTypeName%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>相關聯<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-348">The <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.DataObjectTypeName%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-349">這個區段包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-349">The section contains two code examples.</span></span> <span data-ttu-id="21d7d-350">第一個程式碼範例示範如何實作的型別，將所有參數值都結合成一個物件，使用<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-350">The first code example demonstrates how to implement a type that combines all parameter values into one object, using the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property.</span></span> <span data-ttu-id="21d7d-351">第二個程式碼範例顯示使用兩個類別中的第一個程式碼範例所使用的網頁。</span><span class="sxs-lookup"><span data-stu-id="21d7d-351">The second code example shows the Web page that uses the two classes that are used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-352">下列程式碼範例示範如何實作的型別，將所有參數值都結合成一個物件，使用<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-352">The following code example demonstrates how to implement a type that combines all parameter values into one object, using the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property.</span></span> <span data-ttu-id="21d7d-353">Select 方法的`AggregateData`類別會傳回<xref:System.Data.DataTable>物件具有兩個資料行名為`Name`和`Number`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-353">The select method of the `AggregateData` class returns a <xref:System.Data.DataTable> object with two columns named `Name` and `Number`.</span></span> <span data-ttu-id="21d7d-354">同樣地，`NewData`類別會定義兩個讀取/寫入屬性，`Name`和`Number`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-354">Similarly, the `NewData` class defines two read/write properties, `Name` and `Number`.</span></span> <span data-ttu-id="21d7d-355">`Insert`方法`AggregateData`類別接受一個參數的型別`NewData`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-355">The `Insert` method of the `AggregateData` class takes one parameter of type `NewData`.</span></span> <span data-ttu-id="21d7d-356">`TypeName`屬性<xref:System.Web.UI.WebControls.ObjectDataSource>設`AggregateData`和<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性設定為`NewData`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-356">The `TypeName` property of the <xref:System.Web.UI.WebControls.ObjectDataSource> is set to `AggregateData` and the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property is set to `NewData`.</span></span>  
  
 [!code-csharp[ObjectDataSourceDataObjectTypeName#2](~/samples/snippets/csharp/VS_Snippets_WebNet/ObjectDataSourceDataObjectTypeName/CS/AggregateData.cs#2)]
 [!code-vb[ObjectDataSourceDataObjectTypeName#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/ObjectDataSourceDataObjectTypeName/VB/AggregateData.vb#2)]  
  
 <span data-ttu-id="21d7d-357">下列程式碼範例顯示使用兩個類別中先前的程式碼範例所使用的網頁。</span><span class="sxs-lookup"><span data-stu-id="21d7d-357">The following code example shows the Web page that uses the two classes that are used in the preceding code example.</span></span>  
  
 [!code-aspx-csharp[ObjectDataSourceDataObjectTypeName#1](~/samples/snippets/csharp/VS_Snippets_WebNet/ObjectDataSourceDataObjectTypeName/CS/AggregateDataPageCS.aspx#1)]
 [!code-aspx-vb[ObjectDataSourceDataObjectTypeName#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/ObjectDataSourceDataObjectTypeName/VB/AggregateDataPageVB.aspx#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public int Delete ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32 Delete() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.Delete" />
      <MemberSignature Language="VB.NET" Value="Public Function Delete () As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; int Delete();" />
      <MemberSignature Language="F#" Value="member this.Delete : unit -&gt; int" Usage="objectDataSource.Delete " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-358">藉由呼叫由 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod" /> 屬性所識別的方法，同時使用 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters" /> 集合中的任何參數，執行刪除作業。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-358">Performs a delete operation by calling the method that is identified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod" /> property with any parameters that are in the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters" /> collection.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="21d7d-359">如果在 <see cref="P:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs.AffectedRows" /> 事件中設定了 <see cref="T:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs" /> 的 <see cref="E:System.Web.UI.WebControls.ObjectDataSource.Deleted" /> 屬性，則為表示從基礎資料存放區刪除之資料列數目的值，否則為 -1。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-359">A value that represents the number of rows deleted from the underlying data storage, if the <see cref="P:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs.AffectedRows" /> property of the <see cref="T:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs" /> is set in the <see cref="E:System.Web.UI.WebControls.ObjectDataSource.Deleted" /> event; otherwise, -1.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-360">之前<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>執行作業時，<xref:System.Web.UI.WebControls.ObjectDataSourceView.OnDeleting%2A>呼叫方法來引發<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-360">Before the <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> operation is performed, the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OnDeleting%2A> method is called to raise the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event.</span></span> <span data-ttu-id="21d7d-361">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>事件檢查參數的值，並執行任何前置處理之前<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-361">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event to examine the values of the parameters and to perform any preprocessing before a <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> operation.</span></span> <span data-ttu-id="21d7d-362">若要執行刪除作業<xref:System.Web.UI.WebControls.ObjectDataSourceView>物件使用反映來建立物件所識別的執行個體<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-362">To perform a delete operation, the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object uses reflection to create an instance of the object that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property.</span></span> <span data-ttu-id="21d7d-363">然後它會呼叫的方法，由<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>使用所有相關聯的屬性<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-363">It then calls the method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property, using any associated <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> properties.</span></span> <span data-ttu-id="21d7d-364">如果刪除參數來自相關聯的資料繫結控制項時，參數的名稱會根據建立<xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-364">If the deletion parameters come from an associated data-bound control, the name of the parameters is created according to the <xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A> property.</span></span> <span data-ttu-id="21d7d-365">之後<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>作業完成時，<xref:System.Web.UI.WebControls.ObjectDataSourceView.OnDeleted%2A>呼叫方法來引發<xref:System.Web.UI.WebControls.ObjectDataSource.Deleted>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-365">After the <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> operation completes, the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OnDeleted%2A> method is called to raise the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleted> event.</span></span> <span data-ttu-id="21d7d-366">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleted>檢查任何傳回值、 輸出參數，以及例外狀況，以及執行的任何後續處理的事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-366">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleted> event to examine any return values, output parameters, and exceptions, and to perform any post-processing.</span></span>  
  
 <span data-ttu-id="21d7d-367"><xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>方法會委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.Delete%2A>方法<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-367">The <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> method delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.Delete%2A> method of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
## <a name="data-bound-controls"></a><span data-ttu-id="21d7d-368">資料繫結控制項</span><span class="sxs-lookup"><span data-stu-id="21d7d-368">Data-Bound Controls</span></span>  
 <span data-ttu-id="21d7d-369">當<xref:System.Web.UI.WebControls.ObjectDataSource>與相關聯控制項的資料繫結控制項，例如<xref:System.Web.UI.WebControls.GridView>控制項，不需要呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>從網頁程式碼的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-369">When the <xref:System.Web.UI.WebControls.ObjectDataSource> control is associated with a data-bound control, such as the <xref:System.Web.UI.WebControls.GridView> control, it is not necessary to call the <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> method from page code.</span></span> <span data-ttu-id="21d7d-370"><xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>方法叫用資料繫結控制項來直接改為。</span><span class="sxs-lookup"><span data-stu-id="21d7d-370">The <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> method is invoked directly by the data-bound control instead.</span></span>  
  
 <span data-ttu-id="21d7d-371">如需參數合併、 物件存留期，以及方法解析的詳細資訊，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-371">For more information about parameter merging, object lifetime, and method resolution, see <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters" />
      </Docs>
    </Member>
    <Member MemberName="Deleted">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler Deleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler Deleted" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.Deleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event Deleted As ObjectDataSourceStatusEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceStatusEventHandler ^ Deleted;" />
      <MemberSignature Language="F#" Value="member this.Deleted : System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler " Usage="member this.Deleted : System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-372">發生於 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" /> 作業已經完成時。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-372">Occurs when a <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" /> operation has completed.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-373">處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleted>事件來檢查傳回值或輸出參數的值，或是判斷是否發生例外狀況之後<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>作業已完成。</span><span class="sxs-lookup"><span data-stu-id="21d7d-373">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleted> event to examine the values of a return value or output parameters, or to determine whether an exception was thrown after a <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> operation has completed.</span></span> <span data-ttu-id="21d7d-374">傳回值，輸出參數和例外狀況處理屬性都是從<xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs>與事件相關聯的物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-374">The return value, output parameters, and exception handling properties are available from the <xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs> object that is associated with the event.</span></span>  
  
 <span data-ttu-id="21d7d-375">您可以使用<xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs.AffectedRows%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs>物件從已刪除的資料列數目傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-375">You can use the <xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs.AffectedRows%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs> object to return the number of rows that were deleted from the <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> method.</span></span> <span data-ttu-id="21d7d-376">若要這樣做，請設定<xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs.AffectedRows%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-376">To do this, set the <xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs.AffectedRows%2A> property.</span></span> <span data-ttu-id="21d7d-377">如果您從所指定的方法傳回已刪除的資料列數目<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>屬性值是可從<xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs.ReturnValue%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-377">If you return the number of deleted rows from the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property, the value is available from the <xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs.ReturnValue%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs> object.</span></span>  
  
 <span data-ttu-id="21d7d-378">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-378">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-379">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-379">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-380">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的物件和<xref:System.Web.UI.WebControls.GridView>控制項刪除資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-380">The first code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> object with a business object and a <xref:System.Web.UI.WebControls.GridView> control to delete data.</span></span> <span data-ttu-id="21d7d-381">第二個程式碼範例顯示`EmployeeLogic`第一個程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-381">The second code example shows the `EmployeeLogic` class that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-382">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的控制和<xref:System.Web.UI.WebControls.GridView>控制項刪除資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-382">The following code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> control with a business object and a <xref:System.Web.UI.WebControls.GridView> control to delete data.</span></span> <span data-ttu-id="21d7d-383">一開始，<xref:System.Web.UI.WebControls.GridView>控制項會顯示一組使用的方法，由所指定的所有員工<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性來擷取資料的`EmployeeLogic`物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-383">Initially, the <xref:System.Web.UI.WebControls.GridView> control displays a set of all employees, using the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property to retrieve the data from the `EmployeeLogic` object.</span></span> <span data-ttu-id="21d7d-384">因為<xref:System.Web.UI.WebControls.GridView.AutoGenerateDeleteButton%2A>屬性設定為`true`、<xref:System.Web.UI.WebControls.GridView>控制自動顯示**刪除** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-384">Because the <xref:System.Web.UI.WebControls.GridView.AutoGenerateDeleteButton%2A> property is set to `true`, the <xref:System.Web.UI.WebControls.GridView> control automatically displays a **Delete** button.</span></span>  
  
 <span data-ttu-id="21d7d-385">如果您按一下**刪除**使用所指定的方法來執行刪除作業 按鈕，<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>屬性和任何參數中指定的<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-385">If you click the **Delete** button, the delete operation is performed using the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property and any parameters that are specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-386">在此程式碼範例中，也會執行一些前置處理和後置處理步驟。</span><span class="sxs-lookup"><span data-stu-id="21d7d-386">In this code example, some preprocessing and post-processing steps are also performed.</span></span> <span data-ttu-id="21d7d-387">`NorthwindEmployeeDeleting`委派呼叫以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>事件之前執行作業和`NorthwindEmployeeDeleted`委派呼叫以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleted>後作業完成執行例外狀況處理的事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-387">The `NorthwindEmployeeDeleting` delegate is called to handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event before the operation is performed and the `NorthwindEmployeeDeleted` delegate is called to handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleted> event after the operation has completed to perform exception handling.</span></span> <span data-ttu-id="21d7d-388">在此程式碼範例中，如果`NorthwindDataException`會擲回，它由`NorthwindEmployeeDeleted`方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-388">In this code example, if a `NorthwindDataException` is thrown, it is handled by the `NorthwindEmployeeDeleted` method.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_10#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/CS/objds10cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_10#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/VB/objds10vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-389">下列程式碼範例示範`EmployeeLogic`上述程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-389">The following code example shows the `EmployeeLogic` class that is used in the preceding code example.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_10#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/CS/northwindemployee10.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_10#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/VB/northwindemployee10.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.Deleting" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSourceView.OnDeleted(System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs)" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters" />
      </Docs>
    </Member>
    <Member MemberName="DeleteMethod">
      <MemberSignature Language="C#" Value="public string DeleteMethod { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string DeleteMethod" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod" />
      <MemberSignature Language="VB.NET" Value="Public Property DeleteMethod As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ DeleteMethod { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DeleteMethod : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.DeleteMethod" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-390">取得或設定 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項叫用以刪除資料之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-390">Gets or sets the name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control invokes to delete data.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-391">字串，表示 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 用於刪除資料之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-391">A string that represents the name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> uses to delete data.</span>
          </span>
          <span data-ttu-id="21d7d-392">預設為空字串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-392">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-393">商務物件會假設為一次，而不是批次中刪除資料的一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="21d7d-393">The business object is assumed to delete data one record at a time, rather than in a batch.</span></span>  
  
 <span data-ttu-id="21d7d-394"><xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.DeleteMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-394">The <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.DeleteMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-395">請確定參數名稱設定為<xref:System.Web.UI.WebControls.ObjectDataSource>控制<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>集合符合 select 方法所傳回的資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-395">Make sure that the parameter names configured for the <xref:System.Web.UI.WebControls.ObjectDataSource> control in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection match the column names that are returned by the select method.</span></span>  
  
## <a name="object-lifetime"></a><span data-ttu-id="21d7d-396">物件存留期</span><span class="sxs-lookup"><span data-stu-id="21d7d-396">Object Lifetime</span></span>  
 <span data-ttu-id="21d7d-397">所識別的方法<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>屬性可以是執行個體方法或`static`(`Shared`在 Visual Basic 中) 方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-397">The method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property can be an instance method or a `static` (`Shared` in Visual Basic) method.</span></span> <span data-ttu-id="21d7d-398">如果是執行個體方法，建立及終結每次商務物件<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-398">If it is an instance method, the business object is created and destroyed each time the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-399">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>事件，以使用之前的商務物件<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-399">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated> and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating> events to work with the business object before the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-400">您也可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>之後，就會引發的事件<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-400">You can also handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event that is raised after the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-401">如果實作的商務物件<xref:System.IDisposable>介面，<xref:System.IDisposable.Dispose%2A>方法會終結物件之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-401">If the business object implements the <xref:System.IDisposable> interface, the <xref:System.IDisposable.Dispose%2A> method is called before the object is destroyed.</span></span> <span data-ttu-id="21d7d-402">如果該方法是`static`(`Shared`在 Visual Basic 中) 方法，不會建立商務物件，而且您無法處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>， <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>，和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-402">If the method is a `static` (`Shared` in Visual Basic) method, the business object is never created and you cannot handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>, <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>, and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> events.</span></span>  
  
## <a name="parameter-merging"></a><span data-ttu-id="21d7d-403">合併的參數</span><span class="sxs-lookup"><span data-stu-id="21d7d-403">Parameter Merging</span></span>  
 <span data-ttu-id="21d7d-404">若要加入參數<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>三個來源的集合：</span><span class="sxs-lookup"><span data-stu-id="21d7d-404">Parameters are added to the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection from three sources:</span></span>  
  
-   <span data-ttu-id="21d7d-405">從資料繫結控制項，在執行階段。</span><span class="sxs-lookup"><span data-stu-id="21d7d-405">From the data-bound control, at run time.</span></span>  
  
-   <span data-ttu-id="21d7d-406">從`DeleteParameters`項目，以宣告方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-406">From the `DeleteParameters` element, declaratively.</span></span>  
  
-   <span data-ttu-id="21d7d-407">從`Deleting`方法，以宣告方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-407">From the `Deleting` method, declaratively.</span></span>  
  
 <span data-ttu-id="21d7d-408">首先，將資料繫結控制項所產生的任何參數加入至<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-408">First, any parameters that are generated from data-bound controls are added to the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-409">例如，如果<xref:System.Web.UI.WebControls.ObjectDataSource>控制項繫結至<xref:System.Web.UI.WebControls.GridView>具有資料行的控制`Name`和`Number`，參數`Name`和`Number`加入至集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-409">For example, if the <xref:System.Web.UI.WebControls.ObjectDataSource> control is bound to a <xref:System.Web.UI.WebControls.GridView> control that has the columns `Name` and `Number`, parameters for `Name` and `Number` are added to the collection.</span></span> <span data-ttu-id="21d7d-410">完整名稱的參數取決於<xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-410">The exact name of the parameter depends on the <xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A> property.</span></span> <span data-ttu-id="21d7d-411">這些參數的資料類型是`string`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-411">The data type of these parameters is `string`.</span></span> <span data-ttu-id="21d7d-412">下一步，參數中所列`DeleteParameters`加入項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-412">Next, the parameters that are listed in the `DeleteParameters` element are added.</span></span> <span data-ttu-id="21d7d-413">如果中的參數`DeleteParameters`找到項目具有相同名稱做為參數已經在<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>修改集合，現有的參數符合參數中指定`DeleteParameters`項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-413">If a parameter in the `DeleteParameters` element is found with the same name as a parameter that is already in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection, the existing parameter is modified to match the parameter that is specified in the `DeleteParameters` element.</span></span> <span data-ttu-id="21d7d-414">一般而言，這用來修改參數中的資料類型。</span><span class="sxs-lookup"><span data-stu-id="21d7d-414">Typically, this is used to modify the type of the data in the parameter.</span></span> <span data-ttu-id="21d7d-415">最後，您可以透過程式設計方式加入和移除參數中的<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>事件之前發生<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>方法執行。</span><span class="sxs-lookup"><span data-stu-id="21d7d-415">Finally, you can programmatically add and remove parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event, which occurs before the <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> method is run.</span></span> <span data-ttu-id="21d7d-416">會合併這些參數之後，就會解決方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-416">The method is resolved after the parameters are merged.</span></span> <span data-ttu-id="21d7d-417">在下一節討論方法解析。</span><span class="sxs-lookup"><span data-stu-id="21d7d-417">Method resolution is discussed in the next section.</span></span>  
  
## <a name="method-resolution"></a><span data-ttu-id="21d7d-418">方法解析</span><span class="sxs-lookup"><span data-stu-id="21d7d-418">Method Resolution</span></span>  
 <span data-ttu-id="21d7d-419">當<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>呼叫方法時，資料繫結控制項，以宣告方式中所建立的參數的資料欄位`DeleteParameters`項目，並已加入的參數<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>所有合併事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-419">When the <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> method is called, the data fields from the data-bound control, the parameters that were created declaratively in the `DeleteParameters` element, and the parameters that were added in the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event handler are all merged.</span></span> <span data-ttu-id="21d7d-420">（如需詳細資訊，請參閱上一節）。<xref:System.Web.UI.WebControls.ObjectDataSource>物件會嘗試尋找要呼叫的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-420">(For more information, see the preceding section.) The <xref:System.Web.UI.WebControls.ObjectDataSource> object then attempts to find a method to call.</span></span> <span data-ttu-id="21d7d-421">首先，它會尋找名稱中指定的一或多個方法<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-421">First, it looks for one or more methods with the name that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property.</span></span> <span data-ttu-id="21d7d-422">如果找到相符項目，<xref:System.InvalidOperationException>擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="21d7d-422">If no match is found, an <xref:System.InvalidOperationException> exception is thrown.</span></span> <span data-ttu-id="21d7d-423">如果找到相符項目，則會尋找相符的參數名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-423">If a match is found, it then looks for matching parameter names.</span></span> <span data-ttu-id="21d7d-424">例如，假設由所指定的型別<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性有兩個方法，名為`DeleteARecord`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-424">For example, suppose the type that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property has two methods named `DeleteARecord`.</span></span> <span data-ttu-id="21d7d-425">一個`DeleteARecord`具有一個參數， `ID`，和其他`DeleteARecord`有兩個參數，`Name`和`Number`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-425">One `DeleteARecord` has one parameter, `ID`, and the other `DeleteARecord` has two parameters, `Name` and `Number`.</span></span> <span data-ttu-id="21d7d-426">如果<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>集合具有名為只有一個參數`ID`、`DeleteARecord`方法只`ID`參數呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-426">If the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection has only one parameter named `ID`, the `DeleteARecord` method with just the `ID` parameter is called.</span></span> <span data-ttu-id="21d7d-427">參數的型別不會檢查在解析方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-427">The type of the parameter is not checked in resolving the methods.</span></span> <span data-ttu-id="21d7d-428">參數的順序不重要。</span><span class="sxs-lookup"><span data-stu-id="21d7d-428">The order of the parameters does not matter.</span></span>  
  
 <span data-ttu-id="21d7d-429">如果<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性設定，方法解決了不同的方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-429">If the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property is set, the method is resolved in a different way.</span></span> <span data-ttu-id="21d7d-430"><xref:System.Web.UI.WebControls.ObjectDataSource>中指定名稱的方法會尋找<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>採用一個參數類型的屬性中指定<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-430">The <xref:System.Web.UI.WebControls.ObjectDataSource> looks for a method with the name that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property that takes one parameter of the type that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property.</span></span> <span data-ttu-id="21d7d-431">在此情況下，參數的名稱並不重要。</span><span class="sxs-lookup"><span data-stu-id="21d7d-431">In this case, the name of the parameter does not matter.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-432">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-432">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-433">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的物件和<xref:System.Web.UI.WebControls.GridView>控制項刪除資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-433">The first code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> object with a business object and a <xref:System.Web.UI.WebControls.GridView> control to delete data.</span></span> <span data-ttu-id="21d7d-434">第二個程式碼範例顯示`EmployeeLogic`第一個程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-434">The second code example shows the `EmployeeLogic` class that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-435">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的控制和<xref:System.Web.UI.WebControls.GridView>控制項刪除資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-435">The following code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> control with a business object and a <xref:System.Web.UI.WebControls.GridView> control to delete data.</span></span> <span data-ttu-id="21d7d-436">一開始，<xref:System.Web.UI.WebControls.GridView>控制項會顯示一組使用的方法，由所指定的所有員工<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性來擷取資料的`EmployeeLogic`物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-436">Initially, the <xref:System.Web.UI.WebControls.GridView> control displays a set of all employees, using the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property to retrieve the data from the `EmployeeLogic` object.</span></span> <span data-ttu-id="21d7d-437">因為<xref:System.Web.UI.WebControls.GridView.AutoGenerateDeleteButton%2A>屬性設定為`true`、<xref:System.Web.UI.WebControls.GridView>控制自動顯示**刪除** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-437">Because the <xref:System.Web.UI.WebControls.GridView.AutoGenerateDeleteButton%2A> property is set to `true`, the <xref:System.Web.UI.WebControls.GridView> control automatically displays a **Delete** button.</span></span>  
  
 <span data-ttu-id="21d7d-438">如果您按一下**刪除**使用所指定的方法來執行刪除作業 按鈕，<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>屬性和任何參數中指定的<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-438">If you click the **Delete** button, the delete operation is performed using the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property and any parameters that are specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-439">在此程式碼範例中，也會執行一些前置處理和後置處理步驟。</span><span class="sxs-lookup"><span data-stu-id="21d7d-439">In this code example, some preprocessing and post-processing steps are also performed.</span></span> <span data-ttu-id="21d7d-440">`NorthwindEmployeeDeleting`委派呼叫以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>前執行的作業時，事件和`NorthwindEmployeeDeleted`委派呼叫以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleted>後作業完成執行例外狀況處理的事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-440">The `NorthwindEmployeeDeleting` delegate is called to handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event before the operation is performed, and the `NorthwindEmployeeDeleted` delegate is called to handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleted> event after the operation has completed to perform exception handling.</span></span> <span data-ttu-id="21d7d-441">在此範例中，如果`NorthwindDataException`會擲回，它由`NorthwindDataException`委派。</span><span class="sxs-lookup"><span data-stu-id="21d7d-441">In this example, if a `NorthwindDataException` is thrown, it is handled by the `NorthwindDataException` delegate.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_10#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/CS/objds10cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_10#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/VB/objds10vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-442">下列程式碼範例示範`EmployeeLogic`上述程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-442">The following code example shows the `EmployeeLogic` class that is used in the preceding code example.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_10#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/CS/northwindemployee10.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_10#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/VB/northwindemployee10.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters" />
      </Docs>
    </Member>
    <Member MemberName="DeleteParameters">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.ParameterCollection DeleteParameters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.ParameterCollection DeleteParameters" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property DeleteParameters As ParameterCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::ParameterCollection ^ DeleteParameters { System::Web::UI::WebControls::ParameterCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.DeleteParameters : System.Web.UI.WebControls.ParameterCollection" Usage="System.Web.UI.WebControls.ObjectDataSource.DeleteParameters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("System.Web.UI.Design.WebControls.ParameterCollectionEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", typeof(System.Drawing.Design.UITypeEditor))</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.MergableProperty(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Web.UI.PersistenceMode(System.Web.UI.PersistenceMode.InnerProperty)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ParameterCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-443">取得包含 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod" /> 方法所用參數的參數集合。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-443">Gets the parameters collection that contains the parameters that are used by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod" /> method.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-444">
            <see cref="T:System.Web.UI.WebControls.ParameterCollection" />，包含 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod" /> 方法所使用的參數。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-444">A <see cref="T:System.Web.UI.WebControls.ParameterCollection" /> that contains the parameters used by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod" /> method.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-445">名稱和參數中所包含的型別<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>集合的名稱和型別中的參數，必須符合<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>方法簽章。</span><span class="sxs-lookup"><span data-stu-id="21d7d-445">The names and types of the parameters that are contained in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection must match the names and types of the parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> method signature.</span></span> <span data-ttu-id="21d7d-446">參數名稱會受到<xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A>屬性而且有區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-446">The parameter names are affected by the <xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A> property and are case-sensitive.</span></span> <span data-ttu-id="21d7d-447">集合中的參數取決於資料中的資料繫結控制項以宣告方式，指定的參數和以程式設計方式加入的參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-447">The parameters in the collection depend on the data that is in the data-bound control, the parameters that are specified declaratively, and the parameters that are added programmatically.</span></span> <span data-ttu-id="21d7d-448">如需詳細資訊，請參閱 「 參數合併 」，在<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>和[ObjectDataSource 控制項配合使用參數](http://msdn.microsoft.com/library/45fb67ee-9be7-49b7-9421-e242203dafa4)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-448">For more information, see "Parameter Merging" in <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> and [Using Parameters with the ObjectDataSource Control](http://msdn.microsoft.com/library/45fb67ee-9be7-49b7-9421-e242203dafa4).</span></span>  
  
 <span data-ttu-id="21d7d-449"><xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>屬性擷取<xref:System.Web.UI.WebControls.ObjectDataSourceView.DeleteParameters%2A>屬性所包含的<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-449">The <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> property retrieves the <xref:System.Web.UI.WebControls.ObjectDataSourceView.DeleteParameters%2A> property that is contained by the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-450">如需參數合併、 物件存留期，以及方法解析的詳細資訊，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-450">For more information about parameter merging, object lifetime, and method resolution, see <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-451">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-451">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-452">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的物件和<xref:System.Web.UI.WebControls.GridView>控制項刪除資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-452">The first code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> object with a business object and a <xref:System.Web.UI.WebControls.GridView> control to delete data.</span></span> <span data-ttu-id="21d7d-453">第二個程式碼範例顯示`EmployeeLogic`第一個程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-453">The second code example shows the `EmployeeLogic` class that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-454">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的控制和<xref:System.Web.UI.WebControls.GridView>控制項刪除資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-454">The following code example demonstrates how to use the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSource> control with a business object and a <xref:System.Web.UI.WebControls.GridView> control to delete data.</span></span> <span data-ttu-id="21d7d-455">一開始，<xref:System.Web.UI.WebControls.GridView>控制項會顯示一組使用的方法，由所指定的所有員工<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性來擷取資料的`EmployeeLogic`物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-455">Initially, the <xref:System.Web.UI.WebControls.GridView> control displays a set of all employees, using the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property to retrieve the data from the `EmployeeLogic` object.</span></span> <span data-ttu-id="21d7d-456">因為<xref:System.Web.UI.WebControls.GridView.AutoGenerateDeleteButton%2A>屬性設定為`true`、<xref:System.Web.UI.WebControls.GridView>控制自動顯示**刪除** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-456">Because the <xref:System.Web.UI.WebControls.GridView.AutoGenerateDeleteButton%2A> property is set to `true`, the <xref:System.Web.UI.WebControls.GridView> control automatically displays a **Delete** button.</span></span>  
  
 <span data-ttu-id="21d7d-457">如果您按一下**刪除** 按鈕，<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>具有兩個參數呼叫事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-457">If you click the **Delete** button, the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event is called with two parameters.</span></span> <span data-ttu-id="21d7d-458">一個參數， `EmpID`，來自<xref:System.Web.UI.WebControls.DataGrid>控制項，然後根據<xref:System.Web.UI.WebControls.GridView.DataKeyNames%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-458">One parameter, `EmpID`, comes from the <xref:System.Web.UI.WebControls.DataGrid> control, and is based on the <xref:System.Web.UI.WebControls.GridView.DataKeyNames%2A> property.</span></span> <span data-ttu-id="21d7d-459">另一個參數是來自宣告式<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-459">The other parameter comes from the declarative <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> property.</span></span> <span data-ttu-id="21d7d-460">`EmployeeLogic`類別多載`DeleteEmployee`方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-460">The `EmployeeLogic` class overloads the `DeleteEmployee` method.</span></span> <span data-ttu-id="21d7d-461">一個多載會採用`NorthwindEmployee`參數和另一個接受<xref:System.Int32>參數名為`anID`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-461">One overload takes a `NorthwindEmployee` parameter, and the other takes an <xref:System.Int32> parameter named `anID`.</span></span> <span data-ttu-id="21d7d-462">在<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>事件、 中的項目<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A>屬性調整為包含名為只有一個參數`anID`從值`original_EmpID`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-462">In the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event, the entries in the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A> property are adjusted to include only one parameter named `anID` with the value from `original_EmpID`.</span></span> <span data-ttu-id="21d7d-463">此事件處理常式存在時，比對`DeleteEmployee`方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-463">When the event handler exists, the matching `DeleteEmployee` method is called.</span></span>  
  
 <span data-ttu-id="21d7d-464">下列程式碼範例示範顯示的 Web 網頁<xref:System.Web.UI.WebControls.DataGrid>控制項，並處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-464">The following code example shows the Web page that displays the <xref:System.Web.UI.WebControls.DataGrid> control and handles the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_11#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_11/CS/objds11cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_11#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_11/VB/objds11vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-465">下列程式碼範例示範`EmployeeLogic`上述程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-465">The following code example shows the `EmployeeLogic` class that is used in the preceding code example.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_11#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_11/CS/northwindemployee11.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_11#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_11/VB/northwindemployee11.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" />
      </Docs>
    </Member>
    <Member MemberName="Deleting">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler Deleting;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler Deleting" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.Deleting" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event Deleting As ObjectDataSourceMethodEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceMethodEventHandler ^ Deleting;" />
      <MemberSignature Language="F#" Value="member this.Deleting : System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler " Usage="member this.Deleting : System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-466">在 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" /> 作業之前發生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-466">Occurs before a <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" /> operation.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-467">處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>事件以執行特定應用程式，來驗證參數的值，或變更之前的參數值的其他初始化<xref:System.Web.UI.WebControls.ObjectDataSource>控制項執行刪除作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-467">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event to perform additional initialization that is specific to your application, to validate the values of parameters, or to change the parameter values before the <xref:System.Web.UI.WebControls.ObjectDataSource> control performs the delete operation.</span></span> <span data-ttu-id="21d7d-468">參數是可做為<xref:System.Collections.IDictionary>所存取的集合<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A>屬性，由<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-468">The parameters are available as an <xref:System.Collections.IDictionary> collection that is accessed by the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A> property, which is exposed by the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs> object.</span></span>  
  
 <span data-ttu-id="21d7d-469">您可以藉由設定取消刪除作業<xref:Microsoft.Win32.SessionEndingEventArgs.Cancel%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs>至`true`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-469">You can cancel the delete operation by setting the <xref:Microsoft.Win32.SessionEndingEventArgs.Cancel%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs> to `true`.</span></span>  
  
 <span data-ttu-id="21d7d-470">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-470">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-471">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-471">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-472">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的物件和<xref:System.Web.UI.WebControls.GridView>控制項刪除資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-472">The first code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> object with a business object and a <xref:System.Web.UI.WebControls.GridView> control to delete data.</span></span> <span data-ttu-id="21d7d-473">第二個程式碼範例顯示`EmployeeLogic`第一個程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-473">The second code example shows the `EmployeeLogic` class that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-474">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的控制和<xref:System.Web.UI.WebControls.GridView>控制項刪除資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-474">The following code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> control with a business object and a <xref:System.Web.UI.WebControls.GridView> control to delete data.</span></span> <span data-ttu-id="21d7d-475">一開始，<xref:System.Web.UI.WebControls.GridView>控制項會顯示一組使用的方法，由所指定的所有員工<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性來擷取資料的`EmployeeLogic`物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-475">Initially, the <xref:System.Web.UI.WebControls.GridView> control displays a set of all employees, using the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property to retrieve the data from the `EmployeeLogic` object.</span></span> <span data-ttu-id="21d7d-476">因為<xref:System.Web.UI.WebControls.GridView.AutoGenerateDeleteButton%2A>屬性設定為`true`、<xref:System.Web.UI.WebControls.GridView>控制自動顯示**刪除** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-476">Because the <xref:System.Web.UI.WebControls.GridView.AutoGenerateDeleteButton%2A> property is set to `true`, the <xref:System.Web.UI.WebControls.GridView> control automatically displays a **Delete** button.</span></span>  
  
 <span data-ttu-id="21d7d-477">如果您按一下**刪除**使用所指定的方法來執行刪除作業 按鈕，<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>屬性和任何參數中指定的<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-477">If you click the **Delete** button, the delete operation is performed using the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property and any parameters that are specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-478">在此程式碼範例中，也會執行一些前置處理和後置處理步驟。</span><span class="sxs-lookup"><span data-stu-id="21d7d-478">In this code example, some preprocessing and post-processing steps are also performed.</span></span> <span data-ttu-id="21d7d-479">`NorthwindEmployeeDeleting`委派呼叫以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleting>前執行的作業時，事件和`NorthwindEmployeeDeleted`委派呼叫以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Deleted>後作業完成執行例外狀況處理的事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-479">The `NorthwindEmployeeDeleting` delegate is called to handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleting> event before the operation is performed, and the `NorthwindEmployeeDeleted` delegate is called to handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Deleted> event after the operation has completed to perform exception handling.</span></span> <span data-ttu-id="21d7d-480">在此程式碼範例中，如果`NorthwindDataException`會擲回，它由`NorthwindEmployeeDeleted`方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-480">In this code example, if a `NorthwindDataException` is thrown, it is handled by the `NorthwindEmployeeDeleted` method.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_10#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/CS/objds10cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_10#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/VB/objds10vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-481">下列程式碼範例示範`EmployeeLogic`上述程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-481">The following code example shows the `EmployeeLogic` class that is used in the preceding code example.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_10#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/CS/northwindemployee10.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_10#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_10/VB/northwindemployee10.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.Deleted" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSourceView.OnDeleting(System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs)" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters" />
      </Docs>
    </Member>
    <Member MemberName="EnableCaching">
      <MemberSignature Language="C#" Value="public virtual bool EnableCaching { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableCaching" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.EnableCaching" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Property EnableCaching As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnableCaching { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableCaching : bool with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.EnableCaching" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-482">取得或設定值，指出 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項是否啟用了資料快取。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-482">Gets or sets a value indicating whether the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control has data caching enabled.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-483">如果啟用了資料來源控制項的資料快取則為 <see langword="true" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-483">
              <see langword="true" /> if data caching is enabled for the data source control; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="21d7d-484">預設值為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-484">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-485"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援的資料快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-485">The <xref:System.Web.UI.WebControls.ObjectDataSource> control supports data caching.</span></span> <span data-ttu-id="21d7d-486">雖然快取資料，則呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法會擷取快取中的資料而非<xref:System.Web.UI.WebControls.ObjectDataSource>建立商務物件的執行個體，然後呼叫其資料的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-486">While data is cached, calls to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method retrieve data from the cache rather than the <xref:System.Web.UI.WebControls.ObjectDataSource> creating an instance of the business object and calling its data method.</span></span> <span data-ttu-id="21d7d-487">當快取到期時，<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法從商務物件，擷取資料，並再次快取資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-487">When the cache expires, the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method retrieves data from the business object, and then caches the data again.</span></span>  
  
 <span data-ttu-id="21d7d-488"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項會自動快取資料時<xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A>屬性設定為`true`和<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>屬性設定為值大於 0，表示快取，儲存資料快取項目之前的秒數會被捨棄。</span><span class="sxs-lookup"><span data-stu-id="21d7d-488">The <xref:System.Web.UI.WebControls.ObjectDataSource> control automatically caches data when the <xref:System.Web.UI.WebControls.ObjectDataSource.EnableCaching%2A> property is set to `true` and the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> property is set to a value greater than 0, which indicates the number of seconds that the cache stores data before the cache entry is discarded.</span></span> <span data-ttu-id="21d7d-489">值為 0 指出無限長的快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-489">A value of 0 indicates an infinitely long cache.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-490">下列三個範例顯示 Web 網頁、 程式碼後置頁面類別和從 Northwind 資料庫中的 [員工] 資料表中擷取記錄的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-490">The following three examples show a Web page, a code-behind page class, and a data-access class that retrieve records from the Employees table in the Northwind database.</span></span>  
  
 <span data-ttu-id="21d7d-491">第一個範例顯示包含兩個的 Web 網頁<xref:System.Web.UI.WebControls.ObjectDataSource>控制項<xref:System.Web.UI.WebControls.DropDownList>控制項和<xref:System.Web.UI.WebControls.DetailsView>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-491">The first example shows a Web page that contains two <xref:System.Web.UI.WebControls.ObjectDataSource> controls, a <xref:System.Web.UI.WebControls.DropDownList> control, and a <xref:System.Web.UI.WebControls.DetailsView> control.</span></span> <span data-ttu-id="21d7d-492">第一個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和<xref:System.Web.UI.WebControls.DropDownList>控制項用來擷取並顯示資料庫中的員工名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-492">The first <xref:System.Web.UI.WebControls.ObjectDataSource> control and the <xref:System.Web.UI.WebControls.DropDownList> control are used to retrieve and display employee names from the database.</span></span> <span data-ttu-id="21d7d-493">第二個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和<xref:System.Web.UI.WebControls.DetailsView>控制項用來擷取及顯示員工記錄所選取的使用者。</span><span class="sxs-lookup"><span data-stu-id="21d7d-493">The second <xref:System.Web.UI.WebControls.ObjectDataSource> control and the <xref:System.Web.UI.WebControls.DetailsView> control are used to retrieve and display the employee record that is selected by the user.</span></span>  
  
 <span data-ttu-id="21d7d-494">啟用快取<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-494">Caching is enabled for the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-495">因此，每一筆記錄會擷取從資料庫一次。</span><span class="sxs-lookup"><span data-stu-id="21d7d-495">Therefore, each record is retrieved only one time from the database.</span></span> <span data-ttu-id="21d7d-496"><xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A>屬性設定為"EmployeeDetails"，但任何字串值可做為索引鍵。</span><span class="sxs-lookup"><span data-stu-id="21d7d-496">The <xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A> property is set to "EmployeeDetails", but any string value can work as the key.</span></span> <span data-ttu-id="21d7d-497">網頁也包括<xref:System.Web.UI.WebControls.Button>使用者可以按一下過期的快取的資料的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-497">The Web page also includes a <xref:System.Web.UI.WebControls.Button> control that the user can click to expire the cached data.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_18#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/Default2.aspx#3)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_18#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/Default2.aspx#3)]  
  
 <span data-ttu-id="21d7d-498">第二個範例顯示的處理常式<xref:System.Web.UI.Control.Load>事件和處理常式<xref:System.Web.UI.WebControls.Button.Click>事件<xref:System.Web.UI.WebControls.Button>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-498">The second example shows a handler for the <xref:System.Web.UI.Control.Load> event and a handler for the <xref:System.Web.UI.WebControls.Button.Click> event of the <xref:System.Web.UI.WebControls.Button> control.</span></span> <span data-ttu-id="21d7d-499"><xref:System.Web.UI.Control.Load>事件處理常式建立快取項目的索引鍵設定為<xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A>值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-499">The <xref:System.Web.UI.Control.Load> event handler creates a cache item with a key set to the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A> value.</span></span> <span data-ttu-id="21d7d-500"><xref:System.Web.UI.WebControls.Button.Click>事件處理常式中移除快取項目索引鍵是否等於<xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A>值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-500">The <xref:System.Web.UI.WebControls.Button.Click> event handler removes the cache item whose key is equal to the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheKeyDependency%2A> value.</span></span> <span data-ttu-id="21d7d-501">當移除快取項目時，相依於索引鍵的所有快取的資料已過期。</span><span class="sxs-lookup"><span data-stu-id="21d7d-501">When the cache item is removed, all the cached data that is dependent on the key is expired.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_18#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/Default2.aspx.cs#4)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_18#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/Default2.aspx.vb#4)]  
  
 <span data-ttu-id="21d7d-502">第三個範例會顯示與 Northwind 資料庫互動的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-502">The third example shows the data access class that interacts with the Northwind database.</span></span> <span data-ttu-id="21d7d-503">類別會使用 LINQ 查詢 [員工] 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-503">The class uses LINQ to query the Employees table.</span></span> <span data-ttu-id="21d7d-504">這個範例需要 LINQ to SQL 類別表示 Northwind 資料庫的 Employees 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-504">The example requires a LINQ to SQL class that represents the Northwind database and the Employees table.</span></span> <span data-ttu-id="21d7d-505">如需詳細資訊，請參閱[How to： 建立 LINQ to SQL 類別，在 Web 專案](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-505">For more information, see [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_18#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/App_Code/EmployeeLogic.cs#5)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_18#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/App_Code/EmployeeLogic.vb#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="21d7d-506">
            <see cref="P:System.Web.UI.WebControls.ObjectDataSource.EnableCaching" /> 屬性指定的方法傳回 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> 時，<see cref="T:System.Data.Common.DbDataReader" /> 屬性會設為 <see langword="true" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-506">The <see cref="P:System.Web.UI.WebControls.ObjectDataSource.EnableCaching" /> property is set to <see langword="true" /> when the method specified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> property returns a <see cref="T:System.Data.Common.DbDataReader" />.</span>
          </span>
        </exception>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.CacheDuration" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy" />
      </Docs>
    </Member>
    <Member MemberName="EnablePaging">
      <MemberSignature Language="C#" Value="public bool EnablePaging { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePaging" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.EnablePaging" />
      <MemberSignature Language="VB.NET" Value="Public Property EnablePaging As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnablePaging { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnablePaging : bool with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.EnablePaging" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-507">取得或設定值，指出資料來源控制項是否支援對其擷取的資料集進行分頁。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-507">Gets or sets a value that indicates whether the data source control supports paging through the set of data that it retrieves.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-508">如果資料來源控制項支援對其擷取的資料進行分頁則為 <see langword="true" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-508">
              <see langword="true" /> if the data source control supports paging through the data it retrieves; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-509">由分頁<xref:System.Web.UI.WebControls.ObjectDataSource>控制項由設定<xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A>，和<xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>和 select 方法定義中的商務物件，以適當的參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-509">Paging by the <xref:System.Web.UI.WebControls.ObjectDataSource> control is handled by setting the <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A>, and <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> properties of the <xref:System.Web.UI.WebControls.ObjectDataSource> and defining a select method in the business object with the proper parameters.</span></span> <span data-ttu-id="21d7d-510">當<xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>屬性設定為`true`、<xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>集合包含兩個額外的參數，要求第一個資料列和要求的資料列數目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-510">When the <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A> property is set to `true`, the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> collection includes two additional parameters for the first row that is requested and the number of rows that are requested.</span></span> <span data-ttu-id="21d7d-511">這兩個參數的命名方式所定義<xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A>和<xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-511">These two parameters are named as defined by the <xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A> and <xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A> properties.</span></span> <span data-ttu-id="21d7d-512">`Select`方法應傳回的資料列，指定索引處開始要求的數目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-512">The `Select` method should return the requested number of rows, starting at the specified index.</span></span> <span data-ttu-id="21d7d-513">因為資料可能不完整地分配依頁面大小，最後一頁可能會包含較少的資料列。</span><span class="sxs-lookup"><span data-stu-id="21d7d-513">Because the data might not divide evenly by the page size, the last page might contain fewer rows.</span></span> <span data-ttu-id="21d7d-514">因此，要求資料列數目是實際上會傳回的資料列的最大數目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-514">Thus, the number of rows that are requested is actually the maximum number of rows that are returned.</span></span>  
  
 <span data-ttu-id="21d7d-515">資料繫結控制項相關聯的資料繫結控制項上啟用分頁時，呼叫`Select`方法的起始索引和所需的資料列數目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-515">When paging is enabled on the associated data-bound control, the data-bound control calls the `Select` method with the start index and number of rows that are required.</span></span> <span data-ttu-id="21d7d-516">此外，如果<xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性設定，將資料繫結控制項之前呈現頁面巡覽區控制項，呼叫的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-516">Additionally, if the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property is set, the data-bound control calls the method before rendering the pager controls.</span></span> <span data-ttu-id="21d7d-517">例如，如果<xref:System.Web.UI.WebControls.GridView>控制項具有分頁的頁面大小為 5，而且由所指定的方法已啟用<xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性傳回 20，只有 4 頁會顯示在頁面巡覽區。</span><span class="sxs-lookup"><span data-stu-id="21d7d-517">For example, if a <xref:System.Web.UI.WebControls.GridView> control has paging enabled with a page size of 5, and the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property returns 20, only 4 pages are displayed in the pager.</span></span>  
  
 <span data-ttu-id="21d7d-518"><xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.EnablePaging%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-518">The <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.EnablePaging%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-519">下列三個範例顯示 Web 網頁、 程式碼後置頁面類別和資料存取類別，可讓使用者能夠選取的多少筆記錄會顯示在頁面。</span><span class="sxs-lookup"><span data-stu-id="21d7d-519">The following three examples show a Web page, a code-behind page class, and a data-access class that enable the user to pick how many records are displayed in the page.</span></span>  
  
 <span data-ttu-id="21d7d-520">網頁包含<xref:System.Web.UI.WebControls.ObjectDataSource>控制項<xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-520">The Web page contains an <xref:System.Web.UI.WebControls.ObjectDataSource> control whose <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A> property is set to `true`.</span></span> <span data-ttu-id="21d7d-521"><xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性設定為在查詢中傳回的總記錄數的方法名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-521">The <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property is set to the name of a method that returns the total number of records in the query.</span></span> <span data-ttu-id="21d7d-522"><xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A>屬性和<xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A>屬性都設為 Select 方法中使用參數的名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-522">The <xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A> property and the <xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A> property are set to the names of the parameters that are used in the Select method.</span></span> <span data-ttu-id="21d7d-523">這個頁面也包含<xref:System.Web.UI.WebControls.DropDownList>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-523">The page also contains a <xref:System.Web.UI.WebControls.DropDownList> control.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_17#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/Default3.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_17#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/Default3.aspx#1)]  
  
 <span data-ttu-id="21d7d-524">第二個範例顯示的處理常式<xref:System.Web.UI.WebControls.ListControl.SelectedIndexChanged?displayProperty=nameWithType>事件<xref:System.Web.UI.WebControls.DropDownList>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-524">The second example shows a handler for the <xref:System.Web.UI.WebControls.ListControl.SelectedIndexChanged?displayProperty=nameWithType> event of the <xref:System.Web.UI.WebControls.DropDownList> control.</span></span> <span data-ttu-id="21d7d-525">處理常式集合中的程式碼<xref:System.Web.UI.WebControls.GridView.PageSize%2A>使用者選取的屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-525">The code in the handler sets the <xref:System.Web.UI.WebControls.GridView.PageSize%2A> property to the user's selection.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_17#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/Default3.aspx.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_17#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/Default3.aspx.vb#2)]  
  
 <span data-ttu-id="21d7d-526">第三個範例會顯示 Customers 資料表中擷取資料的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-526">The third example shows the data access class that retrieves data from the Customers table.</span></span> <span data-ttu-id="21d7d-527">它包含方法，名為`GetSubsetOfEmployees`，這指派給<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-527">It includes a method named `GetSubsetOfEmployees`, which is assigned to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-528">此範例也會包含名為的方法`GetEmployeeCount`，這指派給<xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-528">The example also includes a method named `GetEmployeeCount`, which is assigned to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-529">類別會使用 LINQ 查詢的 Customers 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-529">The class uses LINQ to query the Customers table.</span></span> <span data-ttu-id="21d7d-530">這個範例需要 LINQ to SQL 類別代表 Customers 資料表與 Northwind 資料庫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-530">The example requires a LINQ to SQL class that represents the Northwind database and Customers table.</span></span> <span data-ttu-id="21d7d-531">如需詳細資訊，請參閱[How to： 建立 LINQ to SQL 類別，在 Web 專案](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-531">For more information, see [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_17#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/App_Code/CustomerLogic.cs#3)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_17#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/App_Code/CustomerLogic.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSourceView.CanPage" />
      </Docs>
    </Member>
    <Member MemberName="FilterExpression">
      <MemberSignature Language="C#" Value="public string FilterExpression { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string FilterExpression" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" />
      <MemberSignature Language="VB.NET" Value="Public Property FilterExpression As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ FilterExpression { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.FilterExpression : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.FilterExpression" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-532">取得或設定呼叫 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> 屬性所指定之方法時套用的篩選條件運算式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-532">Gets or sets a filtering expression that is applied when the method that is specified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> property is called.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-533">表示使用 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> 屬性識別之方法或函式擷取資料時，所套用之篩選條件運算式的字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-533">A string that represents a filtering expression that is applied when data is retrieved by using the method or function identified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> property.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-534"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援篩選的資料時，才<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法會傳回<xref:System.Data.DataSet>或<xref:System.Data.DataTable>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-534">The <xref:System.Web.UI.WebControls.ObjectDataSource> control supports filtering data only when the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method returns a <xref:System.Data.DataSet> or <xref:System.Data.DataTable> object.</span></span>  
  
 <span data-ttu-id="21d7d-535">用於語法<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性是格式字串樣式的運算式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-535">The syntax that is used for the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property is a format string–style expression.</span></span> <span data-ttu-id="21d7d-536">篩選運算式語法是相同的語法可接受的<xref:System.Data.DataColumn.Expression%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-536">The filter expression syntax is the same syntax that is accepted by the <xref:System.Data.DataColumn.Expression%2A> property.</span></span> <span data-ttu-id="21d7d-537">如果您加入參數，以便<xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>集合，您也可以包含格式字串的預留位置。</span><span class="sxs-lookup"><span data-stu-id="21d7d-537">If you add parameters to the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> collection, you can also include format string placeholders.</span></span> <span data-ttu-id="21d7d-538">例如，包含`"{0}"`中替換參數值的運算式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-538">For example, include `"{0}"` in the expression to substitute for parameter values.</span></span> <span data-ttu-id="21d7d-539">根據中的參數索引來取代預留位置<xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-539">The placeholders are replaced according to the index of the parameter in the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> collection.</span></span>  
  
 <span data-ttu-id="21d7d-540">您可以包含在參數<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-540">You can include parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property.</span></span> <span data-ttu-id="21d7d-541">如果參數類型是字串或字元類型，請使用單引號括住參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-541">If the type of the parameter is a string or character type, enclose the parameter in single quotation marks.</span></span> <span data-ttu-id="21d7d-542">如果參數是數值類型，就不需要引號。</span><span class="sxs-lookup"><span data-stu-id="21d7d-542">Quotation marks are not required if the parameter is a numeric type.</span></span>  
  
 <span data-ttu-id="21d7d-543"><xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>集合包含的參數，會評估中找到的預留位置<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-543">The <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> collection contains the parameters that are evaluated for the placeholders that are found in the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property.</span></span>  
  
 <span data-ttu-id="21d7d-544"><xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.FilterExpression%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-544">The <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.FilterExpression%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="21d7d-545">您應該先驗證您從用戶端接收任何篩選參數值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-545">You should validate any filter parameter value that you receive from the client.</span></span> <span data-ttu-id="21d7d-546">執行階段只會取代篩選條件運算式的參數值並將其以套用<xref:System.Data.DataSet>或<xref:System.Data.DataTable>所傳回的物件<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-546">The runtime simply substitutes the parameter value into the filter expression and applies it to the <xref:System.Data.DataSet> or <xref:System.Data.DataTable> object that is returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span> <span data-ttu-id="21d7d-547">如果您使用<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性作為安全性考量，以限制所傳回的篩選發生之前，您必須驗證的參數值的項目數目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-547">If you are using the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property as a security measure to limit the number of items that are returned, you must validate the parameter values before the filtering occurs.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-548">下列程式碼範例示範如何顯示篩選的資料使用<xref:System.Web.UI.WebControls.ObjectDataSource>來自中介層商務物件擷取資料的控制項和<xref:System.Web.UI.WebControls.GridView>控制項來顯示結果。</span><span class="sxs-lookup"><span data-stu-id="21d7d-548">The following code example demonstrates how to display filtered data using an <xref:System.Web.UI.WebControls.ObjectDataSource> control to retrieve data from a middle-tier business object and a <xref:System.Web.UI.WebControls.GridView> control to display the results.</span></span> <span data-ttu-id="21d7d-549"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項可以篩選資料，只時擷取資料的方法會擷取為<xref:System.Data.DataSet>或<xref:System.Data.DataTable>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-549">The <xref:System.Web.UI.WebControls.ObjectDataSource> control can filter data only when the method that retrieves the data retrieves it as a <xref:System.Data.DataSet> or <xref:System.Data.DataTable> object.</span></span> <span data-ttu-id="21d7d-550">基於這個理由，<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性會識別擷取資料的商務物件方法<xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-550">For this reason, the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property identifies a business object method that retrieves data as a <xref:System.Data.DataSet>.</span></span>  
  
 <span data-ttu-id="21d7d-551">程式碼範例包含<xref:System.Web.UI.WebControls.TextBox>控制項，<xref:System.Web.UI.WebControls.GridView>控制項，<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和**送出** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-551">The code example consists of a <xref:System.Web.UI.WebControls.TextBox> control, a <xref:System.Web.UI.WebControls.GridView> control, the <xref:System.Web.UI.WebControls.ObjectDataSource> control, and a **Submit** button.</span></span> <span data-ttu-id="21d7d-552">根據預設，<xref:System.Web.UI.WebControls.TextBox>會填入其中一個 Northwind Traders 員工的名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-552">By default, the <xref:System.Web.UI.WebControls.TextBox> is populated with the name of one of the Northwind Traders employees.</span></span> <span data-ttu-id="21d7d-553"><xref:System.Web.UI.WebControls.GridView>顯示員工中的名稱所識別的相關資訊<xref:System.Web.UI.WebControls.TextBox>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-553">The <xref:System.Web.UI.WebControls.GridView> displays information about the employee that is identified by the name in the <xref:System.Web.UI.WebControls.TextBox>.</span></span> <span data-ttu-id="21d7d-554">若要擷取另一位員工的資料，請輸入中的員工的完整名稱<xref:System.Web.UI.WebControls.TextBox>，然後按一下 [**送出**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-554">To retrieve data on another employee, enter the full name of the employee in the <xref:System.Web.UI.WebControls.TextBox>, and then click the **Submit** button.</span></span>  
  
 <span data-ttu-id="21d7d-555"><xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性會指定用來篩選所指定之方法所擷取的資料運算式<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-555">The <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property specifies an expression that is used to filter the data that is retrieved by the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span> <span data-ttu-id="21d7d-556">它會使用參數預留位置中所包含的參數進行評估之<xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-556">It uses parameter placeholders that are evaluated to the parameters that are contained in the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-557">在此範例中，參數預留位置會受限於單一引號因為參數類型是可能含有空格的字串類型。</span><span class="sxs-lookup"><span data-stu-id="21d7d-557">In this example, the parameter placeholder is bounded by single quotation marks because the type of the parameter is a string type that might contain spaces.</span></span> <span data-ttu-id="21d7d-558">如果參數的型別是數值或日期類型，不需要繫結的引號。</span><span class="sxs-lookup"><span data-stu-id="21d7d-558">If the type of the parameter is a numeric or date type, bounding quotation marks are not required.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-559">這個範例有一個可接受使用者輸入的文字方塊，這可能會造成安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="21d7d-559">This example has a text box that accepts user input, which is a potential security threat.</span></span> <span data-ttu-id="21d7d-560">根據預設，ASP.NET Web 網頁會驗證使用者輸入未包含指令碼或 HTML 項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-560">By default, ASP.NET Web pages validate that user input does not include script or HTML elements.</span></span> <span data-ttu-id="21d7d-561">如需詳細資訊，請參閱 [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07) (指令碼攻擊概觀)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-561">For more information, see [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07).</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_9#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_9/CS/objds9cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_9#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_9/VB/objds9vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-562">下列程式碼範例提供上述的程式碼範例使用的中介層商務物件的範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-562">The following code example provides an example of a middle-tier business object that the preceding code example uses.</span></span> <span data-ttu-id="21d7d-563">程式碼範例是由兩個基本類別所組成：</span><span class="sxs-lookup"><span data-stu-id="21d7d-563">The code example consists of two basic classes:</span></span>  
  
-   <span data-ttu-id="21d7d-564">`EmployeeLogic`類別，這是封裝商務邏輯的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-564">The `EmployeeLogic` class, which is a class that encapsulates business logic.</span></span>  
  
-   <span data-ttu-id="21d7d-565">`NorthwindEmployee`類別，這是包含只需要以載入保存資料與資料層的基本功能的模型類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-565">The `NorthwindEmployee` class, which is a model class that contains only the basic functionality that is required to load and persist data from the data tier.</span></span>  
  
 <span data-ttu-id="21d7d-566">為了簡單起見，`EmployeeLogic`類別會建立一組靜態的資料，而非從資料層擷取資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-566">For simplicity, the `EmployeeLogic` class creates a static set of data, rather than retrieving the data from a data tier.</span></span> <span data-ttu-id="21d7d-567">它也很有用的此範例中，因為此範例依賴您提供示範篩選 Northwind Traders 員工的完整名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-567">It is also helpful for this example, because the sample relies on you to provide the full name of a Northwind Traders employee to demonstrate filtering.</span></span> <span data-ttu-id="21d7d-568">如需完整的工作範例，您必須編譯，並使用這些類別提供的 Web Form 程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-568">For a complete working example, you must compile and use these classes with the Web Forms code examples that are provided.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_9#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_9/CS/northwindemployee9.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_9#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_9/VB/northwindemployee9.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="21d7d-569">已設定 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" /> 屬性，但 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" /> 方法沒有傳回 <see cref="T:System.Data.DataSet" /> 或 <see cref="T:System.Data.DataTable" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-569">The <see cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" /> property was set and the <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" /> method does not return a <see cref="T:System.Data.DataSet" /> or <see cref="T:System.Data.DataTable" />.</span>
          </span>
        </exception>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterParameters" />
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.Filtering" />
      </Docs>
    </Member>
    <Member MemberName="Filtering">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceFilteringEventHandler Filtering;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceFilteringEventHandler Filtering" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.Filtering" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event Filtering As ObjectDataSourceFilteringEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceFilteringEventHandler ^ Filtering;" />
      <MemberSignature Language="F#" Value="member this.Filtering : System.Web.UI.WebControls.ObjectDataSourceFilteringEventHandler " Usage="member this.Filtering : System.Web.UI.WebControls.ObjectDataSourceFilteringEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceFilteringEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-570">在篩選作業之前發生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-570">Occurs before a filter operation.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-571">處理<xref:System.Web.UI.WebControls.ObjectDataSource.Filtering>事件以執行驗證作業篩選參數值之前<xref:System.Web.UI.WebControls.ObjectDataSource>控制項執行篩選作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-571">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Filtering> event to perform validation operations on filter parameter values before the <xref:System.Web.UI.WebControls.ObjectDataSource> control performs a filter operation.</span></span> <span data-ttu-id="21d7d-572">您可以取消選取的作業，藉由設定<xref:System.ComponentModel.CancelEventArgs.Cancel%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceFilteringEventArgs>至`true`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-572">You can cancel the selected operation by setting the <xref:System.ComponentModel.CancelEventArgs.Cancel%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceFilteringEventArgs> to `true`.</span></span> <span data-ttu-id="21d7d-573">引發事件時，才<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性設定。</span><span class="sxs-lookup"><span data-stu-id="21d7d-573">The event is raised only if the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property is set.</span></span>  
  
 <span data-ttu-id="21d7d-574"><xref:System.Web.UI.WebControls.ObjectDataSource.Filtering?displayProperty=nameWithType>事件委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.Filtering?displayProperty=nameWithType>事件<xref:System.Web.UI.WebControls.ObjectDataSourceView>相關聯<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-574">The <xref:System.Web.UI.WebControls.ObjectDataSource.Filtering?displayProperty=nameWithType> event delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.Filtering?displayProperty=nameWithType> event of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-575">您應該先驗證您從用戶端接收任何篩選參數值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-575">You should validate any filter parameter value that you receive from the client.</span></span> <span data-ttu-id="21d7d-576">執行階段只會取代篩選條件運算式的參數值並將其以套用<xref:System.Data.DataSet>或<xref:System.Data.DataTable>所傳回的物件<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-576">The runtime simply substitutes the parameter value into the filter expression and applies it to the <xref:System.Data.DataSet> or <xref:System.Data.DataTable> object that is returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span> <span data-ttu-id="21d7d-577">如果您使用<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性作為安全性考量，以限制所傳回的篩選發生之前，您必須驗證的參數值的項目數目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-577">If you are using the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property as a security measure to limit the number of items that are returned, you must validate the parameter values before the filtering occurs.</span></span>  
  
 <span data-ttu-id="21d7d-578">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-578">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterParameters" />
      </Docs>
    </Member>
    <Member MemberName="FilterParameters">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.ParameterCollection FilterParameters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.ParameterCollection FilterParameters" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.FilterParameters" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property FilterParameters As ParameterCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::ParameterCollection ^ FilterParameters { System::Web::UI::WebControls::ParameterCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.FilterParameters : System.Web.UI.WebControls.ParameterCollection" Usage="System.Web.UI.WebControls.ObjectDataSource.FilterParameters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("System.Web.UI.Design.WebControls.ParameterCollectionEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", typeof(System.Drawing.Design.UITypeEditor))</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.MergableProperty(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Web.UI.PersistenceMode(System.Web.UI.PersistenceMode.InnerProperty)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ParameterCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-579">取得與 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" /> 字串中任何參數替代符號關聯的參數集合。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-579">Gets a collection of parameters that are associated with any parameter placeholders in the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" /> string.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-580">
            <see cref="T:System.Web.UI.WebControls.ParameterCollection" />，其中所包含的一組參數，與在 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" /> 屬性中找到的任何參數預留位置相關聯。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-580">A <see cref="T:System.Web.UI.WebControls.ParameterCollection" /> that contains a set of parameters associated with any parameter placeholders found in the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" /> property.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-581"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援篩選的資料時，才<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法會傳回<xref:System.Data.DataSet>或<xref:System.Data.DataTable>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-581">The <xref:System.Web.UI.WebControls.ObjectDataSource> control supports filtering data only when the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method returns a <xref:System.Data.DataSet> or <xref:System.Data.DataTable> object.</span></span>  
  
 <span data-ttu-id="21d7d-582">用於語法<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>是格式字串樣式的運算式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-582">The syntax that is used for the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> is a format string–style expression.</span></span> <span data-ttu-id="21d7d-583">篩選運算式語法是相同的語法可接受的<xref:System.Data.DataColumn.Expression%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-583">The filter expression syntax is the same syntax that is accepted by the <xref:System.Data.DataColumn.Expression%2A> property.</span></span> <span data-ttu-id="21d7d-584">如果您加入參數，以便<xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>集合，您也可以包含格式字串的預留位置。</span><span class="sxs-lookup"><span data-stu-id="21d7d-584">If you add parameters to the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> collection, you can also include format string placeholders.</span></span> <span data-ttu-id="21d7d-585">例如，包含`"{0}"`中替換參數值的運算式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-585">For example, include `"{0}"` in the expression to substitute for parameter values.</span></span> <span data-ttu-id="21d7d-586">根據中的參數索引來取代預留位置<xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-586">The placeholders are replaced according to the index of the parameter in the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> collection.</span></span>  
  
 <span data-ttu-id="21d7d-587">您可以包含在參數<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-587">You can include parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property.</span></span> <span data-ttu-id="21d7d-588">如果參數是字串或字元類型，請使用單引號括住參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-588">If the parameter is a string or character type, enclose the parameter in single quotation marks.</span></span> <span data-ttu-id="21d7d-589">如果參數是數值類型，就不需要引號。</span><span class="sxs-lookup"><span data-stu-id="21d7d-589">Quotation marks are not required if the parameter is a numeric type.</span></span>  
  
 <span data-ttu-id="21d7d-590"><xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>屬性擷取<xref:System.Web.UI.WebControls.ObjectDataSourceView.FilterParameters%2A>屬性所包含的<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-590">The <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> property retrieves the <xref:System.Web.UI.WebControls.ObjectDataSourceView.FilterParameters%2A> property that is contained by the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-591">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-591">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-592">第一個程式碼範例示範如何顯示篩選的資料使用<xref:System.Web.UI.WebControls.ObjectDataSource>來自中介層商務物件擷取資料的物件和<xref:System.Web.UI.WebControls.GridView>控制項來顯示結果。</span><span class="sxs-lookup"><span data-stu-id="21d7d-592">The first code example demonstrates how to display filtered data using an <xref:System.Web.UI.WebControls.ObjectDataSource> object to retrieve data from a middle-tier business object and a <xref:System.Web.UI.WebControls.GridView> control to display the results.</span></span> <span data-ttu-id="21d7d-593">第二個程式碼範例提供第一個程式碼範例中使用的中介層商務物件的範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-593">The second code example provides an example of a middle-tier business object that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-594">下列程式碼範例示範如何顯示篩選的資料使用<xref:System.Web.UI.WebControls.ObjectDataSource>來自中介層商務物件擷取資料的控制項和<xref:System.Web.UI.WebControls.GridView>控制項來顯示結果。</span><span class="sxs-lookup"><span data-stu-id="21d7d-594">The following code example demonstrates how to display filtered data using an <xref:System.Web.UI.WebControls.ObjectDataSource> control to retrieve data from a middle-tier business object and a <xref:System.Web.UI.WebControls.GridView> control to display the results.</span></span> <span data-ttu-id="21d7d-595"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項可以篩選資料，只時擷取資料的方法會擷取為<xref:System.Data.DataSet>或<xref:System.Data.DataTable>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-595">The <xref:System.Web.UI.WebControls.ObjectDataSource> control can filter data only when the method that retrieves the data retrieves it as a <xref:System.Data.DataSet> or <xref:System.Data.DataTable> object.</span></span> <span data-ttu-id="21d7d-596">基於這個理由，<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性會識別擷取資料的商務物件方法<xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-596">For this reason, the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property identifies a business object method that retrieves data as a <xref:System.Data.DataSet>.</span></span>  
  
 <span data-ttu-id="21d7d-597">程式碼範例包含<xref:System.Web.UI.WebControls.TextBox>控制項，<xref:System.Web.UI.WebControls.GridView>控制項，<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和**送出** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-597">The code example consists of a <xref:System.Web.UI.WebControls.TextBox> control, a <xref:System.Web.UI.WebControls.GridView> control, the <xref:System.Web.UI.WebControls.ObjectDataSource> control, and a **Submit** button.</span></span> <span data-ttu-id="21d7d-598">根據預設，<xref:System.Web.UI.WebControls.TextBox>會填入其中一個 Northwind Traders 員工的名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-598">By default, the <xref:System.Web.UI.WebControls.TextBox> is populated with the name of one of the Northwind Traders employees.</span></span> <span data-ttu-id="21d7d-599"><xref:System.Web.UI.WebControls.GridView>顯示員工中的名稱所識別的相關資訊<xref:System.Web.UI.WebControls.TextBox>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-599">The <xref:System.Web.UI.WebControls.GridView> displays information about the employee that is identified by the name in the <xref:System.Web.UI.WebControls.TextBox>.</span></span> <span data-ttu-id="21d7d-600">中要擷取資料的另一位員工， <xref:System.Web.UI.WebControls.TextBox>，輸入員工的完整名稱，然後按一下**送出** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-600">To retrieve data on another employee, in the <xref:System.Web.UI.WebControls.TextBox>, enter the full name of the employee, and then click the **Submit** button.</span></span>  
  
 <span data-ttu-id="21d7d-601"><xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性會指定用來篩選所擷取的資料運算式<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-601">The <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property specifies an expression that is used to filter the data that is retrieved by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span> <span data-ttu-id="21d7d-602">它會使用參數預留位置中所包含的參數進行評估之<xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-602">It uses parameter placeholders that are evaluated to the parameters that are contained in the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-603">在此範例中，參數預留位置會受限於單一引號因為參數類型是可能含有空格的字串類型。</span><span class="sxs-lookup"><span data-stu-id="21d7d-603">In this example, the parameter placeholder is bounded by single quotation marks because the type of the parameter is a string type that might contain spaces.</span></span> <span data-ttu-id="21d7d-604">如果參數的型別是數值或日期類型，不需要繫結的引號。</span><span class="sxs-lookup"><span data-stu-id="21d7d-604">If the type of the parameter is a numeric or date type, bounding quotation marks are not required.</span></span> <span data-ttu-id="21d7d-605"><xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>集合包含一個參數，<xref:System.Web.UI.WebControls.FormParameter>物件繫結至<xref:System.Web.UI.WebControls.TextBox>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-605">The <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> collection contains one parameter, a <xref:System.Web.UI.WebControls.FormParameter> object that is bound to the <xref:System.Web.UI.WebControls.TextBox> control.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-606">您應該先驗證您從用戶端接收任何篩選參數值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-606">You should validate any filter parameter value that you receive from the client.</span></span> <span data-ttu-id="21d7d-607">執行階段只會取代篩選條件運算式的參數值並將其以套用<xref:System.Data.DataView>所傳回的物件<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-607">The runtime simply substitutes the parameter value into the filter expression and applies it to the <xref:System.Data.DataView> object that is returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span> <span data-ttu-id="21d7d-608">如果您使用<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>屬性作為安全性考量，以限制所傳回的篩選發生之前，您必須驗證的參數值的項目數目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-608">If you are using the <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property as a security measure to limit the number of items that are returned, you must validate the parameter values before the filtering occurs.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_9#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_9/CS/objds9cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_9#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_9/VB/objds9vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-609">下列程式碼範例提供上述的程式碼範例使用的中介層商務物件的範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-609">The following code example provides an example of a middle-tier business object that the preceding code example uses.</span></span> <span data-ttu-id="21d7d-610">程式碼範例是由兩個基本類別所組成：</span><span class="sxs-lookup"><span data-stu-id="21d7d-610">The code example consists of two basic classes:</span></span>  
  
-   <span data-ttu-id="21d7d-611">`EmployeeLogic`類別，這是封裝商務邏輯的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-611">The `EmployeeLogic` class, which is a class that encapsulates business logic.</span></span>  
  
-   <span data-ttu-id="21d7d-612">`NorthwindEmployee`類別，這是包含只需要以載入保存資料與資料層的基本功能的模型類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-612">The `NorthwindEmployee` class, which is a model class that contains only the basic functionality that is required to load and persist data from the data tier.</span></span>  
  
 <span data-ttu-id="21d7d-613">為了簡單起見，`EmployeeLogic`類別會建立一組靜態的資料，而非從資料層擷取資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-613">For simplicity, the `EmployeeLogic` class creates a static set of data, rather than retrieving the data from a data tier.</span></span> <span data-ttu-id="21d7d-614">它也很有用的此範例中，因為此範例依賴您提供示範篩選 Northwind Traders 員工的完整名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-614">It is also helpful for this example, because the sample relies on you to provide the full name of a Northwind Traders employee to demonstrate filtering.</span></span> <span data-ttu-id="21d7d-615">如需完整的工作範例，您必須編譯，並使用這些類別提供的 Web Form 程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-615">For a complete working example, you must compile and use these classes with the Web Forms code examples that are provided.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_9#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_9/CS/northwindemployee9.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_9#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_9/VB/northwindemployee9.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="21d7d-616">您設定了 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" /> 屬性，但 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" /> 方法沒有傳回 <see cref="T:System.Data.DataSet" /> 或 <see cref="T:System.Data.DataTable" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-616">You set the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" /> property and the <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" /> method does not return a <see cref="T:System.Data.DataSet" /> or <see cref="T:System.Data.DataTable" />.</span>
          </span>
        </exception>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.FilterExpression" />
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.Filtering" />
      </Docs>
    </Member>
    <Member MemberName="GetView">
      <MemberSignature Language="C#" Value="protected override System.Web.UI.DataSourceView GetView (string viewName);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance class System.Web.UI.DataSourceView GetView(string viewName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.GetView(System.String)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Function GetView (viewName As String) As DataSourceView" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override System::Web::UI::DataSourceView ^ GetView(System::String ^ viewName);" />
      <MemberSignature Language="F#" Value="override this.GetView : string -&gt; System.Web.UI.DataSourceView" Usage="objectDataSource.GetView viewName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.DataSourceView</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="viewName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="viewName">
          <span data-ttu-id="21d7d-617">要擷取的檢視名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-617">The name of the view to retrieve.</span>
          </span>
          <span data-ttu-id="21d7d-618">因為 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 只支援一個檢視，所以會忽略 <c>viewName</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-618">Because the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> supports only one view, <c>viewName</c> is ignored.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="21d7d-619">擷取與資料來源控制項關聯的具名資料來源檢視。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-619">Retrieves the named data source view that is associated with the data source control.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="21d7d-620">與 <see cref="T:System.Web.UI.WebControls.ObjectDataSourceView" /> 關聯之名為 <see langword="DefaultView" /> 的 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-620">The <see cref="T:System.Web.UI.WebControls.ObjectDataSourceView" /> named <see langword="DefaultView" /> that is associated with the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-621"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援只有一個資料來源檢視。</span><span class="sxs-lookup"><span data-stu-id="21d7d-621">The <xref:System.Web.UI.WebControls.ObjectDataSource> control supports only one data source view.</span></span> <span data-ttu-id="21d7d-622">如同所有的資料來源檢視物件，<xref:System.Web.UI.WebControls.ObjectDataSourceView>相關聯的資料，原始檔控制定義其功能、 執行所有的工作是為了從基礎資料存放區中，擷取資料並執行排序，這類的作業插入、 刪除和更新。</span><span class="sxs-lookup"><span data-stu-id="21d7d-622">As with all data source view objects, the <xref:System.Web.UI.WebControls.ObjectDataSourceView> that is associated with the data source control defines its capabilities, performs all the work that is necessary to retrieve data from the underlying data storage, and performs operations such as sorting, inserting, deleting, and updating.</span></span>  
  
 <span data-ttu-id="21d7d-623"><xref:System.Web.UI.WebControls.ObjectDataSource.GetView%2A>方法是由資料繫結控制項，呼叫不是由網頁程式碼。</span><span class="sxs-lookup"><span data-stu-id="21d7d-623">The <xref:System.Web.UI.WebControls.ObjectDataSource.GetView%2A> method is intended to be called by data-bound controls, not by page code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="21d7d-624">指定的 <paramref name="viewName" /> 為 <see langword="null" /> 或其他非 <see langword="DefaultView" /> 的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-624">The specified <paramref name="viewName" /> is <see langword="null" /> or something other than <see langword="DefaultView" />.</span>
          </span>
        </exception>
        <altmember cref="T:System.Web.UI.WebControls.ObjectDataSourceView" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.GetViewNames" />
      </Docs>
    </Member>
    <Member MemberName="GetViewNames">
      <MemberSignature Language="C#" Value="protected override System.Collections.ICollection GetViewNames ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance class System.Collections.ICollection GetViewNames() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.GetViewNames" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Function GetViewNames () As ICollection" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override System::Collections::ICollection ^ GetViewNames();" />
      <MemberSignature Language="F#" Value="override this.GetViewNames : unit -&gt; System.Collections.ICollection" Usage="objectDataSource.GetViewNames " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ICollection</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-625">擷取名稱集合，表示與 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 物件關聯的檢視物件清單。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-625">Retrieves a collection of names representing the list of view objects that are associated with the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="21d7d-626">
            <see cref="T:System.Collections.ICollection" />，包含與 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 關聯的檢視名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-626">An <see cref="T:System.Collections.ICollection" /> that contains the names of the views associated with the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-627"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援只有一個檢視中，名為`DefaultView`，其基礎資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-627">The <xref:System.Web.UI.WebControls.ObjectDataSource> control supports only one view, named `DefaultView`, on its underlying data.</span></span> <span data-ttu-id="21d7d-628"><xref:System.Web.UI.WebControls.ObjectDataSource.GetViewNames%2A>方法會傳回此一檢視名稱的單一項目集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-628">The <xref:System.Web.UI.WebControls.ObjectDataSource.GetViewNames%2A> method returns a single-element collection of this one view name.</span></span>  
  
 <span data-ttu-id="21d7d-629"><xref:System.Web.UI.WebControls.ObjectDataSource.GetViewNames%2A>方法是由資料繫結控制項，呼叫不是由網頁程式碼。</span><span class="sxs-lookup"><span data-stu-id="21d7d-629">The <xref:System.Web.UI.WebControls.ObjectDataSource.GetViewNames%2A> method is intended to be called by data-bound controls, not by page code.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.GetView(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="Insert">
      <MemberSignature Language="C#" Value="public int Insert ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32 Insert() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.Insert" />
      <MemberSignature Language="VB.NET" Value="Public Function Insert () As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; int Insert();" />
      <MemberSignature Language="F#" Value="member this.Insert : unit -&gt; int" Usage="objectDataSource.Insert " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-630">藉由呼叫由 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertMethod" /> 屬性所識別的方法，和 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertParameters" /> 集合中的任何參數，執行插入作業。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-630">Performs an insert operation by calling the method that is identified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertMethod" /> property and any parameters in the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertParameters" /> collection.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="21d7d-631">表示插入基礎資料儲存之資料列數目的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-631">A value that represents the number of rows inserted into the underlying data storage.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-632">之前<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>執行作業時，<xref:System.Web.UI.WebControls.ObjectDataSourceView.OnInserting%2A>呼叫方法來引發<xref:System.Web.UI.WebControls.ObjectDataSource.Inserting>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-632">Before the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> operation is performed, the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OnInserting%2A> method is called to raise the <xref:System.Web.UI.WebControls.ObjectDataSource.Inserting> event.</span></span> <span data-ttu-id="21d7d-633">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Inserting>事件檢查參數的值，並執行任何前置處理之前<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-633">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Inserting> event to examine the values of the parameters and to perform any preprocessing before an <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> operation.</span></span> <span data-ttu-id="21d7d-634">若要執行插入作業，<xref:System.Web.UI.WebControls.ObjectDataSourceView>物件使用反映來建立物件所識別的執行個體<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-634">To perform an insert operation, the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object uses reflection to create an instance of the object that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property.</span></span> <span data-ttu-id="21d7d-635">然後它會呼叫的方法，由<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>使用所有相關聯的屬性<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-635">It then calls the method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property, using any associated <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> properties.</span></span> <span data-ttu-id="21d7d-636">之後<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>作業完成時，<xref:System.Web.UI.WebControls.ObjectDataSourceView.OnInserted%2A>呼叫方法來引發<xref:System.Web.UI.WebControls.ObjectDataSource.Inserted>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-636">After the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> operation completes, the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OnInserted%2A> method is called to raise the <xref:System.Web.UI.WebControls.ObjectDataSource.Inserted> event.</span></span> <span data-ttu-id="21d7d-637">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Inserted>檢查任何傳回值、 輸出參數，以及例外狀況，以及執行的任何後續處理的事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-637">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Inserted> event to examine any return values, output parameters, and exceptions, and to perform any post-processing.</span></span>  
  
 <span data-ttu-id="21d7d-638"><xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>方法會委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.Insert%2A>方法<xref:System.Web.UI.WebControls.ObjectDataSourceView>相關聯<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-638">The <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> method delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.Insert%2A> method of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-639">如需參數合併、 物件存留期，以及方法解析的詳細資訊，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-639">For more information about parameter merging, object lifetime, and method resolution, see <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>.</span></span>  
  
## <a name="data-bound-controls"></a><span data-ttu-id="21d7d-640">資料繫結控制項</span><span class="sxs-lookup"><span data-stu-id="21d7d-640">Data-Bound Controls</span></span>  
 <span data-ttu-id="21d7d-641">當<xref:System.Web.UI.WebControls.ObjectDataSource>物件相關聯的資料繫結控制項，例如<xref:System.Web.UI.WebControls.GridView>控制項，不需要呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>從網頁程式碼的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-641">When the <xref:System.Web.UI.WebControls.ObjectDataSource> object is associated with a data-bound control, such as the <xref:System.Web.UI.WebControls.GridView> control, it is not necessary to call the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> method from page code.</span></span> <span data-ttu-id="21d7d-642"><xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>方法叫用資料繫結控制項來直接改為。</span><span class="sxs-lookup"><span data-stu-id="21d7d-642">The <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> method is invoked directly by the data-bound control instead.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertMethod" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertParameters" />
      </Docs>
    </Member>
    <Member MemberName="Inserted">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler Inserted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler Inserted" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.Inserted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event Inserted As ObjectDataSourceStatusEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceStatusEventHandler ^ Inserted;" />
      <MemberSignature Language="F#" Value="member this.Inserted : System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler " Usage="member this.Inserted : System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-643">發生於 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Insert" /> 作業已經完成時。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-643">Occurs when an <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Insert" /> operation has completed.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-644">處理<xref:System.Web.UI.WebControls.ObjectDataSource.Inserted>事件來檢查傳回值或輸出參數的值，或是判斷是否發生例外狀況之後<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>作業已完成。</span><span class="sxs-lookup"><span data-stu-id="21d7d-644">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Inserted> event to examine the values of a return value or output parameters, or to determine whether an exception was thrown after an <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> operation has completed.</span></span> <span data-ttu-id="21d7d-645">傳回值，輸出參數和例外狀況處理屬性都是從<xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs>與事件相關聯的物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-645">The return value, output parameters, and exception handling properties are available from the <xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs> object that is associated with the event.</span></span>  
  
 <span data-ttu-id="21d7d-646">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-646">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.Inserting" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSourceView.OnInserted(System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs)" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Insert" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertParameters" />
      </Docs>
    </Member>
    <Member MemberName="Inserting">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler Inserting;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler Inserting" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.Inserting" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event Inserting As ObjectDataSourceMethodEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceMethodEventHandler ^ Inserting;" />
      <MemberSignature Language="F#" Value="member this.Inserting : System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler " Usage="member this.Inserting : System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-647">在 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Insert" /> 作業之前發生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-647">Occurs before an <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Insert" /> operation.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-648">處理<xref:System.Web.UI.WebControls.ObjectDataSource.Inserting>事件以執行特定應用程式，來驗證參數的值，或變更之前的參數值的其他初始化<xref:System.Web.UI.WebControls.ObjectDataSource>控制項執行插入作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-648">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Inserting> event to perform additional initialization that is specific to your application, to validate the values of parameters, or to change the parameter values before the <xref:System.Web.UI.WebControls.ObjectDataSource> control performs the insert operation.</span></span> <span data-ttu-id="21d7d-649">參數是可做為<xref:System.Collections.IDictionary>所存取的集合<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A>屬性，由<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-649">The parameters are available as an <xref:System.Collections.IDictionary> collection that is accessed by the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A> property, which is exposed by the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs> object.</span></span>  
  
 <span data-ttu-id="21d7d-650">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-650">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-651">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-651">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-652">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的物件和<xref:System.Web.UI.WebControls.DetailsView>控制項以插入資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-652">The first code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> object with a business object and a <xref:System.Web.UI.WebControls.DetailsView> control to insert data.</span></span> <span data-ttu-id="21d7d-653">第二個程式碼範例提供第一個程式碼範例中使用的中介層商務物件的範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-653">The second code example provides an example of the middle-tier business object that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-654">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的控制和<xref:System.Web.UI.WebControls.DetailsView>控制項以插入資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-654">The following code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> control with a business object and a <xref:System.Web.UI.WebControls.DetailsView> control to insert data.</span></span> <span data-ttu-id="21d7d-655">一開始，<xref:System.Web.UI.WebControls.DetailsView>顯示新`NorthwindEmployee`記錄，以及自動產生**插入** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-655">Initially, the <xref:System.Web.UI.WebControls.DetailsView> displays a new `NorthwindEmployee` record, along with an automatically generated **Insert** button.</span></span> <span data-ttu-id="21d7d-656">資料輸入的欄位之後<xref:System.Web.UI.WebControls.DetailsView>控制，請按一下**插入** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-656">After you enter data into the fields of the <xref:System.Web.UI.WebControls.DetailsView> control, click the **Insert** button.</span></span> <span data-ttu-id="21d7d-657"><xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性會識別哪一種方法執行插入作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-657">The <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property identifies which method performs the insert operation.</span></span>  
  
 <span data-ttu-id="21d7d-658">在此範例中，`UpdateEmployeeInfo`方法用來執行插入; 不過，它需要`NorthwindEmployee`來插入資料的參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-658">In this example, the `UpdateEmployeeInfo` method is used to perform an insert; however, it requires a `NorthwindEmployee` parameter to insert the data.</span></span> <span data-ttu-id="21d7d-659">基於這個理由，集合的字串，<xref:System.Web.UI.WebControls.DetailsView>控制項將會自動是不夠的。</span><span class="sxs-lookup"><span data-stu-id="21d7d-659">For this reason, the collection of strings that the <xref:System.Web.UI.WebControls.DetailsView> control passes automatically is not sufficient.</span></span> <span data-ttu-id="21d7d-660">`NorthwindEmployeeInserting`委派<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler>處理物件<xref:System.Web.UI.WebControls.ObjectDataSource.Inserting>事件可讓您操作之前輸入的參數和<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>作業會繼續進行。</span><span class="sxs-lookup"><span data-stu-id="21d7d-660">The `NorthwindEmployeeInserting` delegate is an <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler> object that handles the <xref:System.Web.UI.WebControls.ObjectDataSource.Inserting> event and enables you to manipulate the input parameters before the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> operation proceeds.</span></span> <span data-ttu-id="21d7d-661">因為`UpdateEmployeeInfo`方法需要`NorthwindEmployee`物件做為參數，其中會使用字串集合來建立並加入至<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A>使用參數名稱的集合 (`ne`) 該方法所預期。</span><span class="sxs-lookup"><span data-stu-id="21d7d-661">Because the `UpdateEmployeeInfo` method requires a `NorthwindEmployee` object as a parameter, one is created using the collection of strings and is added to the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A> collection using a parameter name (`ne`) that the method expects.</span></span> <span data-ttu-id="21d7d-662">使用現有的中介層物件做為資料來源，具有類型和方法不是特別針對搭配使用時，您可能會執行這些步驟<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-662">You might perform steps like these when using an existing middle-tier object as a data source with types and methods that are not designed specifically for use with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-663">當<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>執行作業時，所識別的方法<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-663">When the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> operation is performed, the method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-664">如果`Insert`物件的方法有包含參數，參數的方法簽章<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>集合必須包含其名稱符合的方法簽章參數的參數<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>方法順利完成。</span><span class="sxs-lookup"><span data-stu-id="21d7d-664">If the `Insert` method of the object has a method signature that includes parameters, the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection must contain a parameter with names that match the method signature parameters for the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> method to complete successfully.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_4#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_4/CS/objds4cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_4#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_4/VB/objds4vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-665">下列程式碼範例提供上述的程式碼範例使用的中介層商務物件的範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-665">The following code example provides an example of a middle-tier business object that the preceding code example uses.</span></span> <span data-ttu-id="21d7d-666">程式碼範例是由兩個基本類別所組成：</span><span class="sxs-lookup"><span data-stu-id="21d7d-666">The code example consists of two basic classes:</span></span>  
  
-   <span data-ttu-id="21d7d-667">`EmployeeLogic`類別，這是無狀態的類別封裝商務邏輯。</span><span class="sxs-lookup"><span data-stu-id="21d7d-667">The `EmployeeLogic` class, which is a stateless class that encapsulates business logic.</span></span>  
  
-   <span data-ttu-id="21d7d-668">`NorthwindEmployee`類別，這是包含只需要以載入保存資料與資料層的基本功能的模型類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-668">The `NorthwindEmployee` class, which is a model class that contains only the basic functionality that is required to load and persist data from the data tier.</span></span>  
  
 <span data-ttu-id="21d7d-669">額外`NorthwindDataException`提供類別是為了方便起見。</span><span class="sxs-lookup"><span data-stu-id="21d7d-669">An additional `NorthwindDataException` class is provided as a convenience.</span></span> <span data-ttu-id="21d7d-670">如需完整的工作範例，您必須編譯，並使用這些類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-670">For a complete working example, you must compile and use these classes.</span></span> <span data-ttu-id="21d7d-671">`UpdateEmployeeInfo`方法未完全實作，因此您會將資料插入 Northwind Traders 資料庫時嘗試使用這個範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-671">The `UpdateEmployeeInfo` method is not completely implemented, so you will not insert data into the Northwind Traders database when you experiment with this example.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_4#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_4/CS/northwindemployee4.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_4#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_4/VB/northwindemployee4.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.Inserted" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSourceView.OnInserting(System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs)" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Insert" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertParameters" />
      </Docs>
    </Member>
    <Member MemberName="InsertMethod">
      <MemberSignature Language="C#" Value="public string InsertMethod { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string InsertMethod" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.InsertMethod" />
      <MemberSignature Language="VB.NET" Value="Public Property InsertMethod As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ InsertMethod { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.InsertMethod : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.InsertMethod" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-672">取得或設定 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項叫用以插入資料之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-672">Gets or sets the name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control invokes to insert data.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-673">字串，表示 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 用於插入資料之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-673">A string that represents the name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> uses to insert data.</span>
          </span>
          <span data-ttu-id="21d7d-674">預設為空字串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-674">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-675">商務物件會假設為一次，而不是批次中插入一筆記錄的資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-675">The business object is assumed to insert data one record at a time, rather than in a batch.</span></span>  
  
 <span data-ttu-id="21d7d-676"><xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.InsertMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-676">The <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.InsertMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> object.</span></span>  
  
## <a name="object-lifetime"></a><span data-ttu-id="21d7d-677">物件存留期</span><span class="sxs-lookup"><span data-stu-id="21d7d-677">Object Lifetime</span></span>  
 <span data-ttu-id="21d7d-678">所識別的方法<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性可以是執行個體方法或`static`(`Shared`在 Visual Basic 中) 方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-678">The method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property can be an instance method or a `static` (`Shared` in Visual Basic) method.</span></span> <span data-ttu-id="21d7d-679">如果執行個體方法，商務物件建立和終結所指定之方法的每次<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-679">If it is an instance method, the business object is created and destroyed each time the method specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-680">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>事件，以使用之前的商務物件<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-680">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated> and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating> events to work with the business object before the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-681">您也可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>所指定的方法之後，就會引發的事件<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-681">You can also handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event that is raised after the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-682">如果實作的商務物件<xref:System.IDisposable>介面，<xref:System.IDisposable.Dispose%2A>方法會終結物件之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-682">If the business object implements the <xref:System.IDisposable> interface, the <xref:System.IDisposable.Dispose%2A> method is called before the object is destroyed.</span></span> <span data-ttu-id="21d7d-683">如果該方法是`static`(`Shared`在 Visual Basic 中)，不會建立商務物件，而且您無法處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>， <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>，和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-683">If the method is `static` (`Shared` in Visual Basic), the business object is never created and you cannot handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>, <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>, and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> events.</span></span>  
  
## <a name="parameter-merging"></a><span data-ttu-id="21d7d-684">合併的參數</span><span class="sxs-lookup"><span data-stu-id="21d7d-684">Parameter Merging</span></span>  
 <span data-ttu-id="21d7d-685">若要加入參數<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>三個來源的集合：</span><span class="sxs-lookup"><span data-stu-id="21d7d-685">Parameters are added to the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection from three sources:</span></span>  
  
-   <span data-ttu-id="21d7d-686">從資料繫結控制項，在執行階段。</span><span class="sxs-lookup"><span data-stu-id="21d7d-686">From the data-bound control, at run time.</span></span>  
  
-   <span data-ttu-id="21d7d-687">從`InsertParameters`項目，以宣告方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-687">From the `InsertParameters` element, declaratively.</span></span>  
  
-   <span data-ttu-id="21d7d-688">從`Inserting`方法，以程式設計的方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-688">From the `Inserting` method, programmatically.</span></span>  
  
 <span data-ttu-id="21d7d-689">首先，將資料繫結控制項所產生的任何參數加入至<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-689">First, any parameters that are generated from data-bound controls are added to the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-690">例如，如果<xref:System.Web.UI.WebControls.ObjectDataSource>控制項繫結至<xref:System.Web.UI.WebControls.GridView>具有資料行的控制`Name`和`Number`，參數`Name`和`Number`加入至集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-690">For example, if the <xref:System.Web.UI.WebControls.ObjectDataSource> control is bound to a <xref:System.Web.UI.WebControls.GridView> control that has the columns `Name` and `Number`, the parameters for `Name` and `Number` are added to the collection.</span></span> <span data-ttu-id="21d7d-691">這些參數的資料類型是`string`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-691">The data type of these parameters is `string`.</span></span> <span data-ttu-id="21d7d-692">下一步，參數中所列`InsertParameters`加入項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-692">Next, the parameters that are listed in the `InsertParameters` element are added.</span></span> <span data-ttu-id="21d7d-693">如果中的參數`InsertParameters`找到項目具有相同名稱做為參數已經在<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>修改集合，現有的參數符合參數中指定`InsertParameters`項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-693">If a parameter in the `InsertParameters` element is found with the same name as a parameter that is already in the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection, the existing parameter is modified to match the parameter that is specified in the `InsertParameters` element.</span></span> <span data-ttu-id="21d7d-694">一般而言，這用來修改參數中的資料類型。</span><span class="sxs-lookup"><span data-stu-id="21d7d-694">Typically, this is used to modify the type of the data in the parameter.</span></span> <span data-ttu-id="21d7d-695">最後，您可以透過程式設計方式加入和移除參數中的<xref:System.Web.UI.WebControls.ObjectDataSource.Inserting>事件之前發生<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>方法執行。</span><span class="sxs-lookup"><span data-stu-id="21d7d-695">Finally, you can programmatically add and remove parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.Inserting> event, which occurs before the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> method is run.</span></span> <span data-ttu-id="21d7d-696">會合併這些參數之後，就會解決方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-696">The method is resolved after the parameters are merged.</span></span> <span data-ttu-id="21d7d-697">在下一節討論方法解析。</span><span class="sxs-lookup"><span data-stu-id="21d7d-697">Method resolution is discussed in the next section.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-698">您應該驗證您從用戶端接收任何參數值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-698">You should validate any parameter value that you receive from the client.</span></span> <span data-ttu-id="21d7d-699">執行階段只會替代參數值到<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-699">The runtime simply substitutes the parameter value into the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property.</span></span>  
  
## <a name="method-resolution"></a><span data-ttu-id="21d7d-700">方法解析</span><span class="sxs-lookup"><span data-stu-id="21d7d-700">Method Resolution</span></span>  
 <span data-ttu-id="21d7d-701">當<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>呼叫方法時，資料繫結控制項，以宣告方式中所建立的參數的資料欄位`InsertParameters`項目，並已加入的參數<xref:System.Web.UI.WebControls.ObjectDataSource.Inserting>所有合併事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-701">When the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> method is called, the data fields from the data-bound control, the parameters that were created declaratively in the `InsertParameters` element, and the parameters that were added in the <xref:System.Web.UI.WebControls.ObjectDataSource.Inserting> event handler are all merged.</span></span> <span data-ttu-id="21d7d-702">（如需詳細資訊，請參閱上一節）。<xref:System.Web.UI.WebControls.ObjectDataSource>物件會嘗試尋找要呼叫的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-702">(For more information, see the preceding section.) The <xref:System.Web.UI.WebControls.ObjectDataSource> object then attempts to find a method to call.</span></span> <span data-ttu-id="21d7d-703">首先，它會尋找名稱中指定的一或多個方法<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-703">First, it looks for one or more methods with the name that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property.</span></span> <span data-ttu-id="21d7d-704">如果找到相符項目，<xref:System.InvalidOperationException>擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="21d7d-704">If no match is found, an <xref:System.InvalidOperationException> exception is thrown.</span></span> <span data-ttu-id="21d7d-705">如果找到相符項目，則會尋找相符的參數名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-705">If a match is found, it then looks for matching parameter names.</span></span> <span data-ttu-id="21d7d-706">例如，假設由所指定的型別<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性有兩個方法，名為`InsertARecord`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-706">For example, suppose a type that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property has two methods named `InsertARecord`.</span></span> <span data-ttu-id="21d7d-707">一個`InsertARecord`具有一個參數， `ID`，和其他`InsertARecord`有兩個參數，`Name`和`Number`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-707">One `InsertARecord` has one parameter, `ID`, and the other `InsertARecord` has two parameters, `Name` and `Number`.</span></span> <span data-ttu-id="21d7d-708">如果<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>集合具有名為只有一個參數`ID`、`InsertARecord`方法只`ID`參數呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-708">If the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection has only one parameter named `ID`, the `InsertARecord` method with just the `ID` parameter is called.</span></span> <span data-ttu-id="21d7d-709">參數的型別不會檢查在解析方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-709">The type of the parameter is not checked in resolving the methods.</span></span> <span data-ttu-id="21d7d-710">參數的順序不重要。</span><span class="sxs-lookup"><span data-stu-id="21d7d-710">The order of the parameters does not matter.</span></span>  
  
 <span data-ttu-id="21d7d-711">如果<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性設定，方法解決了不同的方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-711">If the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property is set, the method is resolved in a different way.</span></span> <span data-ttu-id="21d7d-712"><xref:System.Web.UI.WebControls.ObjectDataSource>中指定名稱的方法會尋找<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>採用一個參數類型的屬性中指定<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-712">The <xref:System.Web.UI.WebControls.ObjectDataSource> looks for a method with the name that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property that takes one parameter of the type that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property.</span></span> <span data-ttu-id="21d7d-713">在此情況下，參數的名稱並不重要。</span><span class="sxs-lookup"><span data-stu-id="21d7d-713">In this case, the name of the parameter does not matter.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-714">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-714">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-715">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的物件和<xref:System.Web.UI.WebControls.DetailsView>控制項以插入資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-715">The first code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> object with a business object and a <xref:System.Web.UI.WebControls.DetailsView> control to insert data.</span></span> <span data-ttu-id="21d7d-716">第二個程式碼範例提供第一個程式碼範例中使用的中介層商務物件的範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-716">The second code example provides an example of the middle-tier business object that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-717">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的控制和<xref:System.Web.UI.WebControls.DetailsView>控制項以插入資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-717">The following code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> control with a business object and a <xref:System.Web.UI.WebControls.DetailsView> control to insert data.</span></span> <span data-ttu-id="21d7d-718">一開始，<xref:System.Web.UI.WebControls.DetailsView>顯示新`NorthwindEmployee`記錄，以及自動產生**插入** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-718">Initially, the <xref:System.Web.UI.WebControls.DetailsView> displays a new `NorthwindEmployee` record, along with an automatically generated **Insert** button.</span></span> <span data-ttu-id="21d7d-719">資料輸入的欄位之後<xref:System.Web.UI.WebControls.DetailsView>控制，請按一下**插入** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-719">After you enter data into the fields of the <xref:System.Web.UI.WebControls.DetailsView> control, click the **Insert** button.</span></span> <span data-ttu-id="21d7d-720"><xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性會識別哪一種方法執行插入作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-720">The <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property identifies which method performs the insert operation.</span></span>  
  
 <span data-ttu-id="21d7d-721">在此範例中，`UpdateEmployeeInfo`方法用來執行插入; 不過，它需要`NorthwindEmployee`來插入資料的參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-721">In this example, the `UpdateEmployeeInfo` method is used to perform an insert; however, it requires a `NorthwindEmployee` parameter to insert the data.</span></span> <span data-ttu-id="21d7d-722">基於這個理由，集合的字串，<xref:System.Web.UI.WebControls.DetailsView>控制項將會自動是不夠的。</span><span class="sxs-lookup"><span data-stu-id="21d7d-722">For this reason, the collection of strings that the <xref:System.Web.UI.WebControls.DetailsView> control passes automatically is not sufficient.</span></span> <span data-ttu-id="21d7d-723">`NorthwindEmployeeInserting`委派<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler>處理物件<xref:System.Web.UI.WebControls.ObjectDataSource.Inserting>事件可讓您操作之前輸入的參數和<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>作業會繼續進行。</span><span class="sxs-lookup"><span data-stu-id="21d7d-723">The `NorthwindEmployeeInserting` delegate is an <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler> object that handles the <xref:System.Web.UI.WebControls.ObjectDataSource.Inserting> event and enables you to manipulate the input parameters before the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> operation proceeds.</span></span> <span data-ttu-id="21d7d-724">因為`UpdateEmployeeInfo`方法需要`NorthwindEmployee`物件做為參數，其中會使用字串集合來建立並加入至<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A>使用參數名稱的集合 (`ne`) 該方法所預期。</span><span class="sxs-lookup"><span data-stu-id="21d7d-724">Because the `UpdateEmployeeInfo` method requires a `NorthwindEmployee` object as a parameter, one is created using the collection of strings and is added to the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A> collection using a parameter name (`ne`) that the method expects.</span></span> <span data-ttu-id="21d7d-725">使用現有的中介層物件做為資料來源，具有類型和方法不是特別針對搭配使用時，您可能會執行這些步驟<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-725">You might perform steps like these when using an existing middle-tier object as a data source with types and methods that are not designed specifically for use with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-726">當<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>執行作業時，所識別的方法<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-726">When the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> operation is performed, the method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-727">如果`Insert`物件的方法有包含參數，參數的方法簽章<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>集合必須包含其名稱符合的方法簽章參數的參數<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>方法順利完成。</span><span class="sxs-lookup"><span data-stu-id="21d7d-727">If the `Insert` method of the object has a method signature that includes parameters, the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection must contain a parameter with names that match the method signature parameters for the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> method to complete successfully.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_4#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_4/CS/objds4cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_4#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_4/VB/objds4vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-728">下列程式碼範例提供上述的程式碼範例使用的中介層商務物件的範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-728">The following code example provides an example of a middle-tier business object that the preceding code example uses.</span></span> <span data-ttu-id="21d7d-729">程式碼範例是由兩個基本類別所組成：</span><span class="sxs-lookup"><span data-stu-id="21d7d-729">The code example consists of two basic classes:</span></span>  
  
-   <span data-ttu-id="21d7d-730">`EmployeeLogic`類別，這是無狀態的類別封裝商務邏輯。</span><span class="sxs-lookup"><span data-stu-id="21d7d-730">The `EmployeeLogic` class, which is a stateless class that encapsulates business logic.</span></span>  
  
-   <span data-ttu-id="21d7d-731">`NorthwindEmployee`類別，這是包含只需要以載入保存資料與資料層的基本功能的模型類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-731">The `NorthwindEmployee` class, which is a model class that contains only the basic functionality that is required to load and persist data from the data tier.</span></span>  
  
 <span data-ttu-id="21d7d-732">額外`NorthwindDataException`提供類別是為了方便起見。</span><span class="sxs-lookup"><span data-stu-id="21d7d-732">An additional `NorthwindDataException` class is provided as a convenience.</span></span> <span data-ttu-id="21d7d-733">如需完整的工作範例，您必須編譯，並使用這些類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-733">For a complete working example, you must compile and use these classes.</span></span> <span data-ttu-id="21d7d-734">`UpdateEmployeeInfo`方法未完全實作，因此您會將資料插入 Northwind Traders 資料庫時嘗試使用這個範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-734">The `UpdateEmployeeInfo` method is not completely implemented, so you will not insert data into the Northwind Traders database when you experiment with this example.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_4#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_4/CS/northwindemployee4.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_4#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_4/VB/northwindemployee4.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertParameters" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Insert" />
      </Docs>
    </Member>
    <Member MemberName="InsertParameters">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.ParameterCollection InsertParameters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.ParameterCollection InsertParameters" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.InsertParameters" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property InsertParameters As ParameterCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::ParameterCollection ^ InsertParameters { System::Web::UI::WebControls::ParameterCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.InsertParameters : System.Web.UI.WebControls.ParameterCollection" Usage="System.Web.UI.WebControls.ObjectDataSource.InsertParameters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("System.Web.UI.Design.WebControls.ParameterCollectionEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", typeof(System.Drawing.Design.UITypeEditor))</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.MergableProperty(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Web.UI.PersistenceMode(System.Web.UI.PersistenceMode.InnerProperty)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ParameterCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-735">取得包含 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertMethod" /> 屬性所使用參數的參數集合。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-735">Gets the parameters collection that contains the parameters that are used by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertMethod" /> property.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-736">
            <see cref="T:System.Web.UI.WebControls.ParameterCollection" />，包含 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertMethod" /> 屬性識別之方法所使用的參數。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-736">A <see cref="T:System.Web.UI.WebControls.ParameterCollection" /> that contains the parameters used by the method identified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertMethod" /> property.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-737">名稱和參數中所包含的型別<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>集合的名稱和型別中的參數，必須符合<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性簽章。</span><span class="sxs-lookup"><span data-stu-id="21d7d-737">The names and types of the parameters that are contained in the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection must match the names and types of the parameters that are in the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property signature.</span></span> <span data-ttu-id="21d7d-738">參數名稱會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-738">The parameter names are case sensitive.</span></span> <span data-ttu-id="21d7d-739">使用提供的參數，例如資料繫結控制項時<xref:System.Web.UI.WebControls.GridView>和<xref:System.Web.UI.WebControls.DetailsView>控制項<xref:System.Web.UI.WebControls.ObjectDataSource>控制項自動合併之參數的集合中已明確指定任何參數資料繫結控制項所提供。</span><span class="sxs-lookup"><span data-stu-id="21d7d-739">When working with data-bound controls that supply parameters, such as the <xref:System.Web.UI.WebControls.GridView> and <xref:System.Web.UI.WebControls.DetailsView> controls, the <xref:System.Web.UI.WebControls.ObjectDataSource> control automatically merges any parameters that are explicitly specified in the collection with the parameters that are provided by the data-bound control.</span></span> <span data-ttu-id="21d7d-740">這是很重要，因為資料繫結控制項一律提供做為其參數<xref:System.String>類型，而且如果方法簽章包含數值或日期類型，您必須明確地包含在參數<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>具有正確的類型集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-740">This is important because data-bound controls always supply their parameters as <xref:System.String> types, and if the method signature includes numeric or date types, you must explicitly include a parameter in the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection with the correct type.</span></span> <span data-ttu-id="21d7d-741">否則，<xref:System.Web.UI.WebControls.ObjectDataSource>控制項嘗試轉換成根據集合中的參數所定義的型別參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-741">Otherwise, the <xref:System.Web.UI.WebControls.ObjectDataSource> control attempts to cast the parameters according to the type that is defined by the parameters in the collection.</span></span> <span data-ttu-id="21d7d-742">如需詳細資訊，請參閱[ObjectDataSource 控制項配合使用參數](http://msdn.microsoft.com/library/45fb67ee-9be7-49b7-9421-e242203dafa4)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-742">For more information, see [Using Parameters with the ObjectDataSource Control](http://msdn.microsoft.com/library/45fb67ee-9be7-49b7-9421-e242203dafa4).</span></span>  
  
 <span data-ttu-id="21d7d-743"><xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>屬性擷取<xref:System.Web.UI.WebControls.ObjectDataSourceView.InsertParameters%2A>屬性所包含的<xref:System.Web.UI.WebControls.ObjectDataSourceView>相關聯<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-743">The <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> property retrieves the <xref:System.Web.UI.WebControls.ObjectDataSourceView.InsertParameters%2A> property that is contained by the <xref:System.Web.UI.WebControls.ObjectDataSourceView> that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-744">如需參數合併、 物件存留期，以及方法解析的詳細資訊，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-744">For more information about parameter merging, object lifetime, and method resolution, see <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-745">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-745">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-746">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的物件和<xref:System.Web.UI.WebControls.DetailsView>控制項以插入資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-746">The first code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> object with a business object and a <xref:System.Web.UI.WebControls.DetailsView> control to insert data.</span></span> <span data-ttu-id="21d7d-747">第二個程式碼範例提供的範例實作`Insert`第一個程式碼範例中使用的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-747">The second code example provides an example implementation of the `Insert` method that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-748">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的控制和<xref:System.Web.UI.WebControls.DetailsView>控制項以插入資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-748">The following code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> control with a business object and a <xref:System.Web.UI.WebControls.DetailsView> control to insert data.</span></span> <span data-ttu-id="21d7d-749">一開始，<xref:System.Web.UI.WebControls.DetailsView>顯示文字方塊中，您可以在此輸入新的資料`NorthwindEmployee`記錄，以及自動產生**插入** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-749">Initially, the <xref:System.Web.UI.WebControls.DetailsView> displays text boxes in which you can enter data for a new `NorthwindEmployee` record, along with an automatically generated **Insert** button.</span></span> <span data-ttu-id="21d7d-750">資料輸入的欄位之後<xref:System.Web.UI.WebControls.DetailsView>控制，請按一下**插入** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="21d7d-750">After you enter data into the fields of the <xref:System.Web.UI.WebControls.DetailsView> control, click the **Insert** button.</span></span> <span data-ttu-id="21d7d-751"><xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性會識別哪一種方法執行插入作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-751">The <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property identifies which method performs the insert operation.</span></span>  
  
 <span data-ttu-id="21d7d-752">如果您按一下**插入**按鈕時，作業會執行使用的方法，由指定<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性和任何參數中指定的<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-752">If you click the **Insert** button, the operation is performed using the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property and any parameters that are specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-753">在此程式碼範例中，一個參數指定<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>集合對應至監督員的識別碼。</span><span class="sxs-lookup"><span data-stu-id="21d7d-753">In this code example, one parameter is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection that corresponds to the supervisor's ID.</span></span> <span data-ttu-id="21d7d-754">這是因為即使 ID 會顯示在<xref:System.Web.UI.WebControls.GridView.Rows%2A>集合<xref:System.Web.UI.WebControls.DetailsView>控制項作為<xref:System.Web.UI.WebControls.BoundField>物件，它會傳遞為字串<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-754">This is because even though the ID is displayed in the <xref:System.Web.UI.WebControls.GridView.Rows%2A> collection for the <xref:System.Web.UI.WebControls.DetailsView> control as a <xref:System.Web.UI.WebControls.BoundField> object, it is passed as a string to the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-755">明確地將它加入<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>集合<xref:System.Web.UI.WebControls.Parameter.Type%2A>屬性設定為<xref:System.TypeCode.Int32>值，它會傳遞正確<xref:System.Web.UI.WebControls.ObjectDataSource>給方法的<xref:System.Int32>，而不是做為字串。</span><span class="sxs-lookup"><span data-stu-id="21d7d-755">By adding it explicitly to the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection with a <xref:System.Web.UI.WebControls.Parameter.Type%2A> property set to the <xref:System.TypeCode.Int32> value, it will be passed correctly by the <xref:System.Web.UI.WebControls.ObjectDataSource> to the method as an <xref:System.Int32>, not as a string.</span></span>  
  
 <span data-ttu-id="21d7d-756">當<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>執行作業時，所識別的方法<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-756">When the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> operation is performed, the method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-757">如果<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>物件的方法有包含參數，參數的方法簽章<xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A>集合必須包含具有符合的方法簽章參數名稱的參數<xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>方法順利完成。</span><span class="sxs-lookup"><span data-stu-id="21d7d-757">If the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> method of the object has a method signature that includes parameters, the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertParameters%2A> collection must contain parameters that have names that match the method signature parameters for the <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A> method to complete successfully.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-758">您應該驗證您從用戶端接收任何參數值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-758">You should validate any parameter value that you receive from the client.</span></span> <span data-ttu-id="21d7d-759">執行階段只會替代參數值到<xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-759">The runtime simply substitutes the parameter value into the <xref:System.Web.UI.WebControls.ObjectDataSource.InsertMethod%2A> property.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_8#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_8/CS/objds8cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_8#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_8/VB/objds8vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-760">下列程式碼範例提供的範例實作`Insert`先前的程式碼範例會使用的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-760">The following code example provides an example implementation of the `Insert` method that the preceding code example uses.</span></span> <span data-ttu-id="21d7d-761">`InsertNewEmployeeWrapper`方法加入至`EmployeeLogic`中提供的中介層物件<xref:System.Web.UI.WebControls.ObjectDataSource>以便更輕鬆地使用物件類別概觀<xref:System.Web.UI.WebControls.ObjectDataSource>在 Web 案例中，而不大幅重寫為實際的控制項商務邏輯。</span><span class="sxs-lookup"><span data-stu-id="21d7d-761">The `InsertNewEmployeeWrapper` method is added to the `EmployeeLogic` middle-tier object that is provided in the <xref:System.Web.UI.WebControls.ObjectDataSource> class overview to enable the object to work more easily with the <xref:System.Web.UI.WebControls.ObjectDataSource> control in Web scenarios, without a substantial rewrite to the actual business logic.</span></span>  
  
 <span data-ttu-id="21d7d-762">若要執行範例時，您必須擁有`NorthwindEmployee`中提供的類別<xref:System.Web.UI.WebControls.ObjectDataSource>類別概觀。</span><span class="sxs-lookup"><span data-stu-id="21d7d-762">To run the example, you must have the `NorthwindEmployee` class that is provided in the <xref:System.Web.UI.WebControls.ObjectDataSource> class overview.</span></span> <span data-ttu-id="21d7d-763">此範例說明如何將連接<xref:System.Web.UI.WebControls.ObjectDataSource>來取得新的資料庫記錄中的資料，使用參數的商務物件方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-763">This example illustrates only how to connect the <xref:System.Web.UI.WebControls.ObjectDataSource> to a business object method that gets data for a new database record by using parameters.</span></span> <span data-ttu-id="21d7d-764">此範例不會新增記錄至資料庫，因為`Save`方法`NorthwindEmployee`類別不包含程式碼以更新資料庫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-764">The example does not add records to the database, because the `Save` method of the `NorthwindEmployee` class does not include code to update the database.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_8#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_8/CS/northwindemployee8.cs#3)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_8#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_8/VB/northwindemployee8.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.InsertMethod" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Insert" />
      </Docs>
    </Member>
    <Member MemberName="LoadViewState">
      <MemberSignature Language="C#" Value="protected override void LoadViewState (object savedState);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void LoadViewState(object savedState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.LoadViewState(System.Object)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub LoadViewState (savedState As Object)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void LoadViewState(System::Object ^ savedState);" />
      <MemberSignature Language="F#" Value="override this.LoadViewState : obj -&gt; unit" Usage="objectDataSource.LoadViewState savedState" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="savedState" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="savedState">
          <span data-ttu-id="21d7d-765">物件，含有控制項的已儲存檢視狀態值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-765">An object that contains the saved view state values for the control.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="21d7d-766">載入先前儲存的 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項檢視狀態。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-766">Loads the previously saved view state of the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-767">這個方法主要供.NET Framework 基礎結構，並不是直接從您的程式碼使用。</span><span class="sxs-lookup"><span data-stu-id="21d7d-767">This method is used primarily by the .NET Framework infrastructure and is not intended to be used directly from your code.</span></span> <span data-ttu-id="21d7d-768">不過，控制項開發人員可以覆寫這個方法，以指定自訂的伺服器控制項如何還原其檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="21d7d-768">However, control developers can override this method to specify how a custom server control restores its view state.</span></span> <span data-ttu-id="21d7d-769">如需詳細資訊，請參閱[ASP.NET 狀態管理概觀](http://msdn.microsoft.com/library/0218d965-5d30-445b-b6a6-8870e70e63ce)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-769">For more information, see [ASP.NET State Management Overview](http://msdn.microsoft.com/library/0218d965-5d30-445b-b6a6-8870e70e63ce).</span></span>  
  
 <span data-ttu-id="21d7d-770"><xref:System.Web.UI.WebControls.ObjectDataSource.LoadViewState%2A>方法用來載入先前儲存的檢視狀態的<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-770">The <xref:System.Web.UI.WebControls.ObjectDataSource.LoadViewState%2A> method is used to load the previously saved view state of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides">
          <span data-ttu-id="21d7d-771">
            <para>
              <see cref="M:System.Web.UI.WebControls.ObjectDataSource.LoadViewState(System.Object)" />擴充時，方法使用主要由控制項開發人員<see cref="T:System.Web.UI.WebControls.ObjectDataSource" />控制項。</para>
          </span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-771">
              <para>The <see cref="M:System.Web.UI.WebControls.ObjectDataSource.LoadViewState(System.Object)" /> method is used primarily by control developers when extending the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control.</para>
            </span>
          </span>
        </block>
      </Docs>
    </Member>
    <Member MemberName="MaximumRowsParameterName">
      <MemberSignature Language="C#" Value="public string MaximumRowsParameterName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MaximumRowsParameterName" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumRowsParameterName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MaximumRowsParameterName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumRowsParameterName : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("maximumRows")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-772">取得或設定商務物件資料擷取方法參數的名稱，用於指出為資料來源分頁支援所擷取的資料錄數目。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-772">Gets or sets the name of the business object data retrieval method parameter that is used to indicate the number of records to retrieve for data source paging support.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-773">用於指出要擷取之資料錄數目的 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> 參數名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-773">The name of the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> parameter that is used to indicate the number of records to retrieve.</span>
          </span>
          <span data-ttu-id="21d7d-774">預設值是<c>"maximumRows"</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-774">The default is <c>"maximumRows"</c>.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-775"><xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A>屬性用來支援資料來源分頁。</span><span class="sxs-lookup"><span data-stu-id="21d7d-775">The <xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A> property is used to support data source paging.</span></span> <span data-ttu-id="21d7d-776">如需分頁會受到<xref:System.Web.UI.WebControls.ObjectDataSource>控制，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-776">For information about how paging is supported by the <xref:System.Web.UI.WebControls.ObjectDataSource> control, see <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>.</span></span>  
  
 <span data-ttu-id="21d7d-777"><xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.MaximumRowsParameterName%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-777">The <xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.MaximumRowsParameterName%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-778">下列三個範例顯示 Web 網頁、 程式碼後置頁面類別和資料存取類別，可讓使用者能夠選取的多少筆記錄會顯示在頁面。</span><span class="sxs-lookup"><span data-stu-id="21d7d-778">The following three examples show a Web page, a code-behind page class, and a data-access class that enable the user to pick how many records are displayed in the page.</span></span>  
  
 <span data-ttu-id="21d7d-779">網頁包含<xref:System.Web.UI.WebControls.ObjectDataSource>控制項<xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-779">The Web page contains an <xref:System.Web.UI.WebControls.ObjectDataSource> control whose <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A> property is set to `true`.</span></span> <span data-ttu-id="21d7d-780"><xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性設定為在查詢中傳回的總記錄數的方法名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-780">The <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property is set to the name of a method that returns the total number of records in the query.</span></span> <span data-ttu-id="21d7d-781"><xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A>屬性和<xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A>屬性都設為 Select 方法中使用參數的名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-781">The <xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A> property and the <xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A> property are set to the names of the parameters that are used in the Select method.</span></span> <span data-ttu-id="21d7d-782">這個頁面也包含<xref:System.Web.UI.WebControls.DropDownList>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-782">The page also contains a <xref:System.Web.UI.WebControls.DropDownList> control.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_17#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/Default3.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_17#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/Default3.aspx#1)]  
  
 <span data-ttu-id="21d7d-783">第二個範例顯示的處理常式<xref:System.Web.UI.WebControls.ListControl.SelectedIndexChanged?displayProperty=nameWithType>事件<xref:System.Web.UI.WebControls.DropDownList>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-783">The second example shows a handler for the <xref:System.Web.UI.WebControls.ListControl.SelectedIndexChanged?displayProperty=nameWithType> event of the <xref:System.Web.UI.WebControls.DropDownList> control.</span></span> <span data-ttu-id="21d7d-784">處理常式集合中的程式碼<xref:System.Web.UI.WebControls.GridView.PageSize%2A>使用者選取的屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-784">The code in the handler sets the <xref:System.Web.UI.WebControls.GridView.PageSize%2A> property to the user's selection.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_17#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/Default3.aspx.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_17#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/Default3.aspx.vb#2)]  
  
 <span data-ttu-id="21d7d-785">第三個範例會顯示 Customers 資料表中擷取資料的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-785">The third example shows the data access class that retrieves data from the Customers table.</span></span> <span data-ttu-id="21d7d-786">它包含方法，名為`GetSubsetOfEmployees`，這指派給<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-786">It includes a method named `GetSubsetOfEmployees`, which is assigned to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-787">此範例也會包含名為的方法`GetEmployeeCount`，這指派給<xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-787">The example also includes a method named `GetEmployeeCount`, which is assigned to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-788">類別會使用 LINQ 查詢的 Customers 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-788">The class uses LINQ to query the Customers table.</span></span> <span data-ttu-id="21d7d-789">這個範例需要 LINQ to SQL 類別代表 Customers 資料表與 Northwind 資料庫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-789">The example requires a LINQ to SQL class that represents the Northwind database and Customers table.</span></span> <span data-ttu-id="21d7d-790">如需詳細資訊，請參閱[How to： 建立 LINQ to SQL 類別，在 Web 專案](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-790">For more information, see [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_17#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/App_Code/CustomerLogic.cs#3)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_17#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/App_Code/CustomerLogic.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.EnablePaging" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSourceView.CanPage" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" />
      </Docs>
    </Member>
    <Member MemberName="ObjectCreated">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceObjectEventHandler ObjectCreated;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceObjectEventHandler ObjectCreated" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event ObjectCreated As ObjectDataSourceObjectEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceObjectEventHandler ^ ObjectCreated;" />
      <MemberSignature Language="F#" Value="member this.ObjectCreated : System.Web.UI.WebControls.ObjectDataSourceObjectEventHandler " Usage="member this.ObjectCreated : System.Web.UI.WebControls.ObjectDataSourceObjectEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceObjectEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-791">在建立 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.TypeName" /> 屬性識別的物件之後發生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-791">Occurs after the object that is identified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.TypeName" /> property is created.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-792">處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>商務物件上呼叫其他方法的事件設定屬性，或執行其他特有之前的商務物件的初始化<xref:System.Web.UI.WebControls.ObjectDataSource>物件呼叫商務物件資料的方法來執行資料作業.</span><span class="sxs-lookup"><span data-stu-id="21d7d-792">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated> event to call other methods on the business object, set properties, or perform other initialization that is specific to the business object before the <xref:System.Web.UI.WebControls.ObjectDataSource> object calls the business object data method to perform a data operation.</span></span> <span data-ttu-id="21d7d-793">存取物件的參考<xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs.ObjectInstance%2A>屬性，由<xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-793">A reference to the object is accessed by the <xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs.ObjectInstance%2A> property, which is exposed by the <xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs> object.</span></span>  
  
 <span data-ttu-id="21d7d-794">如果識別來執行資料作業的方法是`static`(`Shared`在 Visual Basic 中)，則<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>永遠不會引發事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-794">If the method that is identified to perform the data operation is `static` (`Shared` in Visual Basic), the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating> and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated> events are never raised.</span></span>  
  
 <span data-ttu-id="21d7d-795">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-795">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating" />
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing" />
      </Docs>
    </Member>
    <Member MemberName="ObjectCreating">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceObjectEventHandler ObjectCreating;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceObjectEventHandler ObjectCreating" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event ObjectCreating As ObjectDataSourceObjectEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceObjectEventHandler ^ ObjectCreating;" />
      <MemberSignature Language="F#" Value="member this.ObjectCreating : System.Web.UI.WebControls.ObjectDataSourceObjectEventHandler " Usage="member this.ObjectCreating : System.Web.UI.WebControls.ObjectDataSourceObjectEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceObjectEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-796">在建立 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.TypeName" /> 屬性識別的物件之前發生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-796">Occurs before the object that is identified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.TypeName" /> property is created.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-797">如果識別來執行資料作業的方法是`static`(`Shared`在 Visual Basic 中)，則<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>永遠不會引發事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-797">If the method that is identified to perform the data operation is `static` (`Shared` in Visual Basic), the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating> and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated> events are never raised.</span></span>  
  
 <span data-ttu-id="21d7d-798"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項會自動呼叫的商務物件來建立使用反映它的執行個體的預設建構函式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-798">The <xref:System.Web.UI.WebControls.ObjectDataSource> control automatically calls the default constructor of a business object to create an instance of it using reflection.</span></span> <span data-ttu-id="21d7d-799">處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>事件，以明確地呼叫另一個建構函式，並將結果儲存至的物件執行個體設定<xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs.ObjectInstance%2A>屬性相關聯的<xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-799">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating> event to explicitly call another constructor, and set the instance of the object that results to the <xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs.ObjectInstance%2A> property of the associated <xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs> object.</span></span>  
  
 <span data-ttu-id="21d7d-800">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-800">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-801">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-801">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-802">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的物件和<xref:System.Web.UI.WebControls.GridView>控制項來顯示資訊。</span><span class="sxs-lookup"><span data-stu-id="21d7d-802">The first code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> object with a business object and a <xref:System.Web.UI.WebControls.GridView> control to display information.</span></span> <span data-ttu-id="21d7d-803">第二個程式碼範例提供第一個程式碼範例中使用的中介層商務物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-803">The second code example provides the middle-tier business object that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-804">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的控制和<xref:System.Web.UI.WebControls.GridView>控制項來顯示資訊。</span><span class="sxs-lookup"><span data-stu-id="21d7d-804">The following code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> control with a business object and a <xref:System.Web.UI.WebControls.GridView> control to display information.</span></span> <span data-ttu-id="21d7d-805">您可能使用非常昂貴的 Web 網頁執行每一資料作業 （依據時間或資源） 建立的商務物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-805">You might work with a business object that is very expensive to create (in terms of time or resources) for every data operation your Web page performs.</span></span> <span data-ttu-id="21d7d-806">其中一種方式使用高度耗費資源的物件可能要一次，建立它的執行個體，並快取將在後續的作業，而不是建立及終結針對每個資料作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-806">One way to work with an expensive object might be to create an instance of it once, and then cache it for subsequent operations instead of creating and destroying it for every data operation.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="21d7d-807">在實際執行應用程式中，多個要求可能會同時使用相同的執行個體。</span><span class="sxs-lookup"><span data-stu-id="21d7d-807">In a production application, multiple requests might end up simultaneously using the same instance.</span></span> <span data-ttu-id="21d7d-808">因此，物件必須實作以執行緒安全的方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-808">Therefore, the object needs to be implemented in a thread-safe manner.</span></span>  
  
 <span data-ttu-id="21d7d-809">這個程式碼範例會示範這個模式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-809">This code example demonstrates this pattern.</span></span> <span data-ttu-id="21d7d-810">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>事件，請先檢查物件的快取，並只能建立物件的執行個體，如果其中一個已快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-810">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating> event to check the cache for an object first, and only create an instance of the object, if one is not already cached.</span></span> <span data-ttu-id="21d7d-811">然後，處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>快取供日後使用，而不是終結該商務物件的事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-811">Then, handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event to cache the business object for future use, instead of destroying it.</span></span> <span data-ttu-id="21d7d-812">在此程式碼範例中，<xref:System.ComponentModel.CancelEventArgs.Cancel?displayProperty=nameWithType>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceDisposingEventArgs>物件設定為`true`導向<xref:System.Web.UI.WebControls.ObjectDataSource>不呼叫<xref:System.IDisposable.Dispose%2A>物件上的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-812">In this code example, the <xref:System.ComponentModel.CancelEventArgs.Cancel?displayProperty=nameWithType> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceDisposingEventArgs> object is set to `true` to direct the <xref:System.Web.UI.WebControls.ObjectDataSource> to not call <xref:System.IDisposable.Dispose%2A> method on the object.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_16#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_16/CS/objds16cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_16#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_16/VB/objds16vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-813">下列程式碼範例提供上述的程式碼範例會使用的範例中介層商務物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-813">The following code example provides the example middle-tier business object that the preceding code example uses.</span></span> <span data-ttu-id="21d7d-814">程式碼範例包含的基本商務物件，定義`EmployeeLogic`類別，這是可設定狀態的類別封裝商務邏輯。</span><span class="sxs-lookup"><span data-stu-id="21d7d-814">The code example consists of a basic business object, defined by the `EmployeeLogic` class, which is a stateful class that encapsulates business logic.</span></span> <span data-ttu-id="21d7d-815">如需完整的工作範例，您必須編譯此程式碼做為程式庫，並使用這些類別，從 ASP.NET 網頁 （.aspx 檔）。</span><span class="sxs-lookup"><span data-stu-id="21d7d-815">For a complete working example, you must compile this code as a library and use these classes from an ASP.NET page (.aspx file).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_16#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_16/CS/northwindemployee16.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_16#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_16/VB/northwindemployee16.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSourceView.OnObjectCreating(System.Web.UI.WebControls.ObjectDataSourceEventArgs)" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.TypeName" />
      </Docs>
    </Member>
    <Member MemberName="ObjectDisposing">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceDisposingEventHandler ObjectDisposing;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceDisposingEventHandler ObjectDisposing" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event ObjectDisposing As ObjectDataSourceDisposingEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceDisposingEventHandler ^ ObjectDisposing;" />
      <MemberSignature Language="F#" Value="member this.ObjectDisposing : System.Web.UI.WebControls.ObjectDataSourceDisposingEventHandler " Usage="member this.ObjectDisposing : System.Web.UI.WebControls.ObjectDataSourceDisposingEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceDisposingEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-816">在捨棄 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.TypeName" /> 屬性識別的物件之前發生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-816">Occurs before the object that is identified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.TypeName" /> property is discarded.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-817"><xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>商務物件的執行個體就會捨棄之前，一律會引發事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-817">The <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event is always raised before the instance of the business object is discarded.</span></span> <span data-ttu-id="21d7d-818">如果實作的商務物件<xref:System.IDisposable>介面，<xref:System.IDisposable.Dispose%2A>方法呼叫之後會引發這個事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-818">If the business object implements the <xref:System.IDisposable> interface, the <xref:System.IDisposable.Dispose%2A> method is called after this event is raised.</span></span>  
  
 <span data-ttu-id="21d7d-819">處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>事件物件上呼叫其他方法設定屬性，或執行清理之前終結物件的特定物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-819">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event to call other methods on the object, set properties, or perform clean-up that is specific to the object before the object is destroyed.</span></span> <span data-ttu-id="21d7d-820">存取物件的參考<xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs.ObjectInstance%2A>屬性，由<xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-820">A reference to the object is accessed by the <xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs.ObjectInstance%2A> property, which is exposed by the <xref:System.Web.UI.WebControls.ObjectDataSourceEventArgs> object.</span></span>  
  
 <span data-ttu-id="21d7d-821">當您使用<xref:System.Web.UI.WebControls.ObjectDataSource>控制項 linq to SQL 類別中，您必須取消處理常式中的資料內容類別的處置<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-821">When you use a <xref:System.Web.UI.WebControls.ObjectDataSource> control with a LINQ to SQL class, you must cancel the disposing of the data-context class in an handler for the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event.</span></span> <span data-ttu-id="21d7d-822">這是必要步驟，因為 LINQ to SQL 支援延後的執行，而<xref:System.Web.UI.WebControls.ObjectDataSource>控制項嘗試處置之後選取作業的資料內容。</span><span class="sxs-lookup"><span data-stu-id="21d7d-822">This step is necessary because LINQ to SQL supports deferred execution, whereas the <xref:System.Web.UI.WebControls.ObjectDataSource> control tries to dispose the data context after the Select operation.</span></span>  
  
 <span data-ttu-id="21d7d-823">如需如何處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-823">For more information about how to handle events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-824">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-824">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-825">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的物件和<xref:System.Web.UI.WebControls.GridView>控制項來顯示資訊。</span><span class="sxs-lookup"><span data-stu-id="21d7d-825">The first code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> object with a business object and a <xref:System.Web.UI.WebControls.GridView> control to display information.</span></span> <span data-ttu-id="21d7d-826">第二個程式碼範例提供第一個程式碼範例中使用的中介層商務物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-826">The second code example provides the middle-tier business object that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-827">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.ObjectDataSource>的商務物件的控制和<xref:System.Web.UI.WebControls.GridView>控制項來顯示資訊。</span><span class="sxs-lookup"><span data-stu-id="21d7d-827">The following code example demonstrates how to use an <xref:System.Web.UI.WebControls.ObjectDataSource> control with a business object and a <xref:System.Web.UI.WebControls.GridView> control to display information.</span></span> <span data-ttu-id="21d7d-828">您可能使用非常昂貴的 Web 網頁執行每一資料作業 （依據時間或資源） 建立的商務物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-828">You might work with a business object that is very expensive to create (in terms of time or resources) for every data operation your Web page performs.</span></span> <span data-ttu-id="21d7d-829">其中一種方式使用高度耗費資源的物件可能要一次，建立它的執行個體，並快取將在後續的作業，而不是建立及終結針對每個資料作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-829">One way to work with an expensive object might be to create an instance of it once, and then cache it for subsequent operations instead of creating and destroying it for every data operation.</span></span> <span data-ttu-id="21d7d-830">這個範例會示範這個模式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-830">This example demonstrates this pattern.</span></span> <span data-ttu-id="21d7d-831">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>事件，請先檢查物件的快取，並只能建立執行個體，如果其中一個已快取。</span><span class="sxs-lookup"><span data-stu-id="21d7d-831">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating> event to check the cache for an object first, and only create an instance of it, if one is not already cached.</span></span> <span data-ttu-id="21d7d-832">然後，處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>快取供日後使用，而不是終結該商務物件的事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-832">Then, handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event to cache the business object for future use, instead of destroying it.</span></span> <span data-ttu-id="21d7d-833">在此程式碼範例中，<xref:System.ComponentModel.CancelEventArgs.Cancel?displayProperty=nameWithType>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceDisposingEventArgs>物件設定為`true`導向<xref:System.Web.UI.WebControls.ObjectDataSource>不呼叫<xref:System.IDisposable.Dispose%2A>物件上的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-833">In this code example, the <xref:System.ComponentModel.CancelEventArgs.Cancel?displayProperty=nameWithType> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceDisposingEventArgs> object is set to `true` to direct the <xref:System.Web.UI.WebControls.ObjectDataSource> to not call the <xref:System.IDisposable.Dispose%2A> method on the object.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_16#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_16/CS/objds16cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_16#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_16/VB/objds16vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-834">下列程式碼範例提供上述的程式碼範例會使用的範例中介層商務物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-834">The following code example provides the example middle-tier business object that the preceding code example uses.</span></span> <span data-ttu-id="21d7d-835">程式碼範例包含的基本商務物件，定義`EmployeeLogic`類別，這是可設定狀態的類別封裝商務邏輯。</span><span class="sxs-lookup"><span data-stu-id="21d7d-835">The code example consists of a basic business object, defined by the `EmployeeLogic` class, which is a stateful class that encapsulates business logic.</span></span> <span data-ttu-id="21d7d-836">如需完整的工作範例，您必須編譯此程式碼做為程式庫，並使用這些類別，從 ASP.NET 網頁 （.aspx 檔）。</span><span class="sxs-lookup"><span data-stu-id="21d7d-836">For a complete working example, you must compile this code as a library and use these classes from an ASP.NET page (.aspx file).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_16#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_16/CS/northwindemployee16.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_16#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_16/VB/northwindemployee16.vb#2)]  
  
 <span data-ttu-id="21d7d-837">下列範例示範如何處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>事件時使用<xref:System.Web.UI.WebControls.ObjectDataSource>與 LINQ to SQL 類別的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-837">The following example shows how to handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event when using an <xref:System.Web.UI.WebControls.ObjectDataSource> control with a LINQ to SQL class.</span></span>  
  
```vb  
Public Sub ExampleObjectDisposing(ByVal sender As Object, _   
        ByVal e As ObjectDataSourceDisposingEventArgs)  
    e.Cancel = True  
End Sub  
```  
  
```csharp  
public void ExampleObjectDisposing(object sender,   
        ObjectDataSourceDisposingEventArgs e)  
{  
    e.Cancel = true;  
}  
```  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated" />
      </Docs>
    </Member>
    <Member MemberName="OldValuesParameterFormatString">
      <MemberSignature Language="C#" Value="public string OldValuesParameterFormatString { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string OldValuesParameterFormatString" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString" />
      <MemberSignature Language="VB.NET" Value="Public Property OldValuesParameterFormatString As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ OldValuesParameterFormatString { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.OldValuesParameterFormatString : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("{0}")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-838">取得或設定格式字串，套用至傳遞給 <see langword="Delete" /> 或 <see langword="Update" /> 方法之原始值的參數名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-838">Gets or sets a format string to apply to the names of the parameters for original values that are passed to the <see langword="Delete" /> or <see langword="Update" /> methods.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-839">字串，表示套用至傳遞給 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" /> 或 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" /> 方法之任何 <paramref name="oldValues" /> 或索引鍵參數名稱的格式字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-839">A string that represents a format string applied to the names of any <paramref name="oldValues" /> or key parameters passed to the <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Delete" /> or <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" /> methods.</span>
          </span>
          <span data-ttu-id="21d7d-840">預設值是<c>"{0}"</c>，這表示參數名稱都是欄位名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-840">The default is <c>"{0}"</c>, which means the parameter name is the field name.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-841">值<xref:System.Web.UI.WebControls.ObjectDataSourceView.OldValuesParameterFormatString%2A>屬性套用至主索引鍵，例如識別與`DataKeyNames`屬性的資料繫結控制項，或在刪除和更新案例其中<xref:System.Web.UI.WebControls.ObjectDataSourceView.ConflictDetection%2A>屬性設定為<xref:System.Web.UI.ConflictOptions.CompareAllValues>值，以及一組原始的值會傳遞至對應的資料方法中。</span><span class="sxs-lookup"><span data-stu-id="21d7d-841">The value of the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OldValuesParameterFormatString%2A> property is applied to primary keys only, such as those that are identified with the `DataKeyNames` property of a data-bound control, or in delete and update scenarios where the <xref:System.Web.UI.WebControls.ObjectDataSourceView.ConflictDetection%2A> property is set to the <xref:System.Web.UI.ConflictOptions.CompareAllValues> value, and the set of original values are passed to the corresponding data method.</span></span>  
  
 <span data-ttu-id="21d7d-842">以下是兩個常見的案例，您可能會在其中變更<xref:System.Web.UI.WebControls.ObjectDataSourceView.OldValuesParameterFormatString%2A>屬性：</span><span class="sxs-lookup"><span data-stu-id="21d7d-842">The following are two common scenarios where you might change the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OldValuesParameterFormatString%2A> property:</span></span>  
  
-   <span data-ttu-id="21d7d-843">您可能想要變更屬性，以區別舊的和新值更新。</span><span class="sxs-lookup"><span data-stu-id="21d7d-843">You might want to change the property to differentiate between old and new values in updates.</span></span> <span data-ttu-id="21d7d-844">當<xref:System.Web.UI.WebControls.ObjectDataSourceView.ConflictDetection%2A>屬性設定為<xref:System.Web.UI.ConflictOptions.CompareAllValues>值參數的原始和新的值都會加入<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-844">When the <xref:System.Web.UI.WebControls.ObjectDataSourceView.ConflictDetection%2A> property is set to the <xref:System.Web.UI.ConflictOptions.CompareAllValues> value, parameters for both the original and new values are added to the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-845">而格式化的字串，不會為每個資料欄位建立具有相同名稱的兩個參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-845">Without the formatting string, two parameters with the same name would be created for each data field.</span></span> <span data-ttu-id="21d7d-846">藉由變更原始值參數的名稱，您可以比較原始資料來源偵測衝突，並比較索引鍵值的資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-846">By changing the name of the original value parameter, you can compare the data to the original data source to detect conflicts and compare key values.</span></span>  
  
-   <span data-ttu-id="21d7d-847">有些視覺化設計工具會實作特定的命名配置，針對原始值和索引鍵。</span><span class="sxs-lookup"><span data-stu-id="21d7d-847">Some visual designers implement a particular naming scheme for original values and keys.</span></span>  
  
 <span data-ttu-id="21d7d-848"><xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.OldValuesParameterFormatString%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-848">The <xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OldValuesParameterFormatString%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.ConflictDetection" />
      </Docs>
    </Member>
    <Member MemberName="OnInit">
      <MemberSignature Language="C#" Value="protected internal override void OnInit (EventArgs e);" />
      <MemberSignature Language="ILAsm" Value=".method familyorassemblyhidebysig virtual instance void OnInit(class System.EventArgs e) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.OnInit(System.EventArgs)" />
      <MemberSignature Language="VB.NET" Value="Protected Friend Overrides Sub OnInit (e As EventArgs)" />
      <MemberSignature Language="C++ CLI" Value="protected public:&#xA; override void OnInit(EventArgs ^ e);" />
      <MemberSignature Language="F#" Value="override this.OnInit : EventArgs -&gt; unit" Usage="objectDataSource.OnInit e" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="e" Type="System.EventArgs" />
      </Parameters>
      <Docs>
        <param name="e">
          <span data-ttu-id="21d7d-849">包含事件資料的 <see cref="T:System.EventArgs" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-849">An <see cref="T:System.EventArgs" /> that contains event data.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="21d7d-850">將 <see cref="E:System.Web.UI.Page.LoadComplete" /> 事件處理常式加入包含 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項的網頁。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-850">Adds a <see cref="E:System.Web.UI.Page.LoadComplete" /> event handler to the page that contains the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-851">引發事件會透過委派叫用此事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-851">Raising an event invokes the event handler through a delegate.</span></span> <span data-ttu-id="21d7d-852">如需詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-852">For more information, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
 <span data-ttu-id="21d7d-853"><xref:System.Web.UI.WebControls.ObjectDataSource.OnInit%2A> 方法也允許衍生類別處理事件，而不用附加委派。</span><span class="sxs-lookup"><span data-stu-id="21d7d-853">The <xref:System.Web.UI.WebControls.ObjectDataSource.OnInit%2A> method also allows derived classes to handle the event without attaching a delegate.</span></span> <span data-ttu-id="21d7d-854">這是在衍生類別中處理事件的慣用技巧。</span><span class="sxs-lookup"><span data-stu-id="21d7d-854">This is the preferred technique for handling the event in a derived class.</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides">
          <span data-ttu-id="21d7d-855">
            <para>在覆寫<see cref="M:System.Web.UI.WebControls.ObjectDataSource.OnInit(System.EventArgs)" />方法在衍生類別中，請務必呼叫<see cref="M:System.Web.UI.Control.OnInit(System.EventArgs)" />方法的基底類別，使已註冊的委派能接收到事件。</para>
          </span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-855">
              <para>When overriding the <see cref="M:System.Web.UI.WebControls.ObjectDataSource.OnInit(System.EventArgs)" /> method in a derived class, be sure to call the <see cref="M:System.Web.UI.Control.OnInit(System.EventArgs)" /> method for the base class so that registered delegates receive the event.</para>
            </span>
          </span>
        </block>
        <altmember cref="T:System.Web.UI.WebControls.ObjectDataSource" />
        <altmember cref="M:System.Web.UI.Control.OnInit(System.EventArgs)" />
      </Docs>
    </Member>
    <Member MemberName="ParsingCulture">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.ParsingCulture ParsingCulture { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.UI.WebControls.ParsingCulture ParsingCulture" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.ParsingCulture" />
      <MemberSignature Language="VB.NET" Value="Public Property ParsingCulture As ParsingCulture" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::ParsingCulture ParsingCulture { System::Web::UI::WebControls::ParsingCulture get(); void set(System::Web::UI::WebControls::ParsingCulture value); };" />
      <MemberSignature Language="F#" Value="member this.ParsingCulture : System.Web.UI.WebControls.ParsingCulture with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.ParsingCulture" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(Mono.Cecil.CustomAttributeArgument)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ParsingCulture</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-856">取得或設定值，指出在將字串值轉換成實際的屬性型別，以建構 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName" /> 所表示的型別物件時，使用何種文化特性資訊。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-856">Gets a or sets a value that indicates what culture information is used when converting string values to actual property types in order to construct an object of the type indicated by <see cref="P:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName" />.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-857">文化特性資訊。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-857">The culture information.</span>
          </span>
          <span data-ttu-id="21d7d-858">預設值是 <see cref="F:System.Web.UI.WebControls.ParsingCulture.Invariant" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-858">The default value is <see cref="F:System.Web.UI.WebControls.ParsingCulture.Invariant" />.</span>
          </span>
        </value>
        <remarks>To be added.</remarks>
        <altmember cref="T:System.Globalization.CultureInfo" />
      </Docs>
    </Member>
    <Member MemberName="SaveViewState">
      <MemberSignature Language="C#" Value="protected override object SaveViewState ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance object SaveViewState() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.SaveViewState" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Function SaveViewState () As Object" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override System::Object ^ SaveViewState();" />
      <MemberSignature Language="F#" Value="override this.SaveViewState : unit -&gt; obj" Usage="objectDataSource.SaveViewState " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-859">儲存 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項的狀態。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-859">Saves the state of the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="21d7d-860">傳回伺服器控制項的目前檢視狀態；如果沒有與控制項關聯的檢視狀態，則會傳回 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-860">Returns the server control's current view state; otherwise, returns <see langword="null" />, if there is no view state associated with the control.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
        <altmember cref="M:System.Web.UI.IStateManager.SaveViewState" />
        <altmember cref="T:System.Web.UI.WebControls.ObjectDataSource" />
      </Docs>
    </Member>
    <Member MemberName="Select">
      <MemberSignature Language="C#" Value="public System.Collections.IEnumerable Select ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Collections.IEnumerable Select() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.Select" />
      <MemberSignature Language="VB.NET" Value="Public Function Select () As IEnumerable" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Collections::IEnumerable ^ Select();" />
      <MemberSignature Language="F#" Value="member this.Select : unit -&gt; System.Collections.IEnumerable" Usage="objectDataSource.Select " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.IEnumerable</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-861">藉由呼叫 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> 屬性所識別的方法，同時使用 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectParameters" /> 集合中的參數，從基礎資料儲存擷取資料。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-861">Retrieves data from the underlying data storage by calling the method that is identified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> property with the parameters in the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectParameters" /> collection.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="21d7d-862">資料列的 <see cref="T:System.Collections.IEnumerable" /> 清單。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-862">An <see cref="T:System.Collections.IEnumerable" /> list of data rows.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-863">指定的方法可能會有任何方法簽章，但它必須傳回或衍生自其中一個類型中的下列資料表列出<xref:System.Web.UI.WebControls.ObjectDataSource>能夠成功呼叫它的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-863">The specified method might have any method signature, but it must return or be derived from one of the types listed in the following table for the <xref:System.Web.UI.WebControls.ObjectDataSource> control to call it successfully.</span></span>  
  
|<span data-ttu-id="21d7d-864">傳回型別</span><span class="sxs-lookup"><span data-stu-id="21d7d-864">Return type</span></span>|<span data-ttu-id="21d7d-865">動作</span><span class="sxs-lookup"><span data-stu-id="21d7d-865">Action</span></span>|  
|-----------------|------------|  
|<xref:System.Collections.IEnumerable>|<span data-ttu-id="21d7d-866"><xref:System.Collections.IEnumerable>傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-866">The <xref:System.Collections.IEnumerable> is returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>|  
|<xref:System.Data.DataTable>|<span data-ttu-id="21d7d-867">A<xref:System.Data.DataView>建立使用<xref:System.Data.DataTable>，並由傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-867">A <xref:System.Data.DataView> is created by using the <xref:System.Data.DataTable> and returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>|  
|<xref:System.Data.DataView>|<span data-ttu-id="21d7d-868"><xref:System.Data.DataView>傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-868">The <xref:System.Data.DataView> is returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>|  
|<xref:System.Data.DataSet>|<span data-ttu-id="21d7d-869">第一個<xref:System.Data.DataTable>的<xref:System.Data.DataSet>擷取和<xref:System.Data.DataView>建立並傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-869">The first <xref:System.Data.DataTable> of the <xref:System.Data.DataSet> is extracted and a <xref:System.Data.DataView> is created and returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>|  
|<xref:System.Object>|<span data-ttu-id="21d7d-870">物件會包裝在一個項目<xref:System.Collections.IEnumerable>集合，並由傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-870">The object is wrapped in a one-element <xref:System.Collections.IEnumerable> collection and returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>|  
  
 <span data-ttu-id="21d7d-871">所識別的方法<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性可以是執行個體方法或`static`(`Shared`在 Visual Basic 中) 方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-871">The method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property can be an instance method or a `static` (`Shared` in Visual Basic) method.</span></span> <span data-ttu-id="21d7d-872">如果是執行個體方法，商務物件會建立，並且由所指定的方法終結每次<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>呼叫屬性時，不同之處在於相同的執行個體用來呼叫的方法所指定<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性和所指定的方法<xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-872">If it is an instance method, the business object is created and destroyed each time the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property is called, except that the same instance is used to call the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property and the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property.</span></span> <span data-ttu-id="21d7d-873"><xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法會傳回<xref:System.Collections.IEnumerable>介面。</span><span class="sxs-lookup"><span data-stu-id="21d7d-873">The <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method returns an <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="21d7d-874">不過，若要啟用快取和篩選案例，傳回的值必須是<xref:System.Data.DataSet>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-874">However, to enable caching and filtering scenarios, the return value must be a <xref:System.Data.DataSet> object.</span></span> <span data-ttu-id="21d7d-875">雖然<xref:System.Data.DataSet>類別未實作<xref:System.Collections.IEnumerable>介面，<xref:System.Web.UI.WebControls.ObjectDataSource>控制項自動擷取預設<xref:System.Data.DataView>控制，它會實作<xref:System.Collections.IEnumerable>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-875">While the <xref:System.Data.DataSet> class does not implement the <xref:System.Collections.IEnumerable> interface, the <xref:System.Web.UI.WebControls.ObjectDataSource> control automatically extracts the default <xref:System.Data.DataView> control, which implements the <xref:System.Collections.IEnumerable>.</span></span>  
  
 <span data-ttu-id="21d7d-876">之前<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>執行作業時，<xref:System.Web.UI.WebControls.ObjectDataSourceView.OnSelecting%2A>呼叫方法來引發<xref:System.Web.UI.WebControls.ObjectDataSource.Selecting>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-876">Before the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> operation is performed, the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OnSelecting%2A> method is called to raise the <xref:System.Web.UI.WebControls.ObjectDataSource.Selecting> event.</span></span> <span data-ttu-id="21d7d-877">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Selecting>事件檢查參數的值，並執行任何前置處理之前<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-877">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Selecting> event to examine the values of the parameters and to perform any preprocessing before a <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> operation.</span></span> <span data-ttu-id="21d7d-878">若要執行資料擷取作業，<xref:System.Web.UI.WebControls.ObjectDataSourceView>物件使用反映來建立物件所識別的執行個體<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-878">To perform a data retrieval operation, the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object uses reflection to create an instance of the object that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property.</span></span> <span data-ttu-id="21d7d-879">然後它會呼叫的方法，由<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>使用所有相關聯的屬性<xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-879">It then calls the method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property, using any associated <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> properties.</span></span> <span data-ttu-id="21d7d-880">之後<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>作業完成時，<xref:System.Web.UI.WebControls.ObjectDataSourceView.OnSelected%2A>呼叫方法來引發<xref:System.Web.UI.WebControls.ObjectDataSource.Selected>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-880">After the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> operation completes, the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OnSelected%2A> method is called to raise the <xref:System.Web.UI.WebControls.ObjectDataSource.Selected> event.</span></span> <span data-ttu-id="21d7d-881">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Selected>檢查任何傳回值、 輸出參數，以及例外狀況，以及執行的任何後續處理的事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-881">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Selected> event to examine any return values, output parameters, and exceptions, and to perform any post-processing.</span></span>  
  
 <span data-ttu-id="21d7d-882">如果<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性會傳回<xref:System.Data.DataSet>， <xref:System.Data.DataTable>，或<xref:System.Data.DataView>物件和快取已啟用，<xref:System.Web.UI.WebControls.ObjectDataSource>擷取的資料，並將資料儲存至快取期間<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-882">If the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property returns a <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, or <xref:System.Data.DataView> object and caching is enabled, the <xref:System.Web.UI.WebControls.ObjectDataSource> retrieves data from and saves data to the cache during the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> operation.</span></span> <span data-ttu-id="21d7d-883">快取，已捨棄，或重新整理會根據建立指定之組合的快取行為<xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A>和<xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-883">The cache is created, discarded, or refreshed based on the caching behavior that is specified by the combination of the <xref:System.Web.UI.WebControls.ObjectDataSource.CacheDuration%2A> and <xref:System.Web.UI.WebControls.ObjectDataSource.CacheExpirationPolicy%2A> properties.</span></span>  
  
 <span data-ttu-id="21d7d-884">如果<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性會傳回<xref:System.Data.DataSet>或<xref:System.Data.DataTable>物件，和<xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A>指定屬性，它會與任何提供評估<xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A>屬性和結果篩選條件會套用到期間資料清單<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-884">If the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property returns a <xref:System.Data.DataSet> or <xref:System.Data.DataTable> object, and a <xref:System.Web.UI.WebControls.ObjectDataSource.FilterExpression%2A> property has been specified, it is evaluated with any supplied <xref:System.Web.UI.WebControls.ObjectDataSource.FilterParameters%2A> properties and the resulting filter is applied to the list of data during the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> operation.</span></span>  
  
 <span data-ttu-id="21d7d-885"><xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法會委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.Select%2A>方法<xref:System.Web.UI.WebControls.ObjectDataSourceView>相關聯<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-885">The <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.Select%2A> method of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-886">如需參數合併、 物件存留期，以及方法解析的詳細資訊，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-886">For more information about parameter merging, object lifetime, and method resolution, see <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>.</span></span>  
  
## <a name="data-bound-controls"></a><span data-ttu-id="21d7d-887">資料繫結控制項</span><span class="sxs-lookup"><span data-stu-id="21d7d-887">Data-Bound Controls</span></span>  
 <span data-ttu-id="21d7d-888">當<xref:System.Web.UI.WebControls.ObjectDataSource>與相關聯控制項的資料繫結控制項，例如<xref:System.Web.UI.WebControls.GridView>控制項，不需要呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>從網頁程式碼的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-888">When the <xref:System.Web.UI.WebControls.ObjectDataSource> control is associated with a data-bound control, such as the <xref:System.Web.UI.WebControls.GridView> control, it is not necessary to call the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method from page code.</span></span> <span data-ttu-id="21d7d-889"><xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法叫用資料繫結控制項來直接改為。</span><span class="sxs-lookup"><span data-stu-id="21d7d-889">The <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method is invoked directly by the data-bound control instead.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-890">如需程式碼範例，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-890">For a code example, see <xref:System.Web.UI.WebControls.ObjectDataSource>.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectParameters" />
      </Docs>
    </Member>
    <Member MemberName="SelectCountMethod">
      <MemberSignature Language="C#" Value="public string SelectCountMethod { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string SelectCountMethod" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod" />
      <MemberSignature Language="VB.NET" Value="Public Property SelectCountMethod As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ SelectCountMethod { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SelectCountMethod : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-891">取得或設定 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項叫用以擷取資料列計數之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-891">Gets or sets the name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control invokes to retrieve a row count.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-892">字串，表示 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 用於擷取資料列計數之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-892">A string that represents the name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> uses to retrieve a row count.</span>
          </span>
          <span data-ttu-id="21d7d-893">此方法必須傳回整數 (<see cref="T:System.Int32" />)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-893">The method must return an integer (<see cref="T:System.Int32" />).</span>
          </span>
          <span data-ttu-id="21d7d-894">預設為空字串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-894">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-895"><xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性會識別用來擷取總計資料列計數，以支援資料來源分頁的商務物件方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-895">The <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property identifies a business object method that is used to retrieve a total row count, to support data source paging.</span></span> <span data-ttu-id="21d7d-896"><xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>才會評估屬性<xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-896">The <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property is evaluated only if the <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A> property is set to `true`.</span></span>  
  
 <span data-ttu-id="21d7d-897"><xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.SelectCountMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-897">The <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.SelectCountMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-898">如需分頁會受到<xref:System.Web.UI.WebControls.ObjectDataSource>控制，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-898">For information about how paging is supported by the <xref:System.Web.UI.WebControls.ObjectDataSource> control, see <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-899">下列三個範例顯示 Web 網頁、 程式碼後置頁面類別和資料存取類別，可讓使用者能夠選取的多少筆記錄會顯示在頁面。</span><span class="sxs-lookup"><span data-stu-id="21d7d-899">The following three examples show a Web page, a code-behind page class, and a data-access class that enable the user to pick how many records are displayed in the page.</span></span>  
  
 <span data-ttu-id="21d7d-900">網頁包含<xref:System.Web.UI.WebControls.ObjectDataSource>控制項<xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-900">The Web page contains an <xref:System.Web.UI.WebControls.ObjectDataSource> control whose <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A> property is set to `true`.</span></span> <span data-ttu-id="21d7d-901"><xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性設定為在查詢中傳回的總記錄數的方法名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-901">The <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property is set to the name of a method that returns the total number of records in the query.</span></span> <span data-ttu-id="21d7d-902"><xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A>屬性和<xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A>屬性都設為 Select 方法中使用參數的名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-902">The <xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A> property and the <xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A> property are set to the names of the parameters that are used in the Select method.</span></span> <span data-ttu-id="21d7d-903">這個頁面也包含<xref:System.Web.UI.WebControls.DropDownList>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-903">The page also contains a <xref:System.Web.UI.WebControls.DropDownList> control.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_17#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/Default3.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_17#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/Default3.aspx#1)]  
  
 <span data-ttu-id="21d7d-904">第二個範例顯示的處理常式<xref:System.Web.UI.WebControls.ListControl.SelectedIndexChanged?displayProperty=nameWithType>事件<xref:System.Web.UI.WebControls.DropDownList>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-904">The second example shows a handler for the <xref:System.Web.UI.WebControls.ListControl.SelectedIndexChanged?displayProperty=nameWithType> event of the <xref:System.Web.UI.WebControls.DropDownList> control.</span></span> <span data-ttu-id="21d7d-905">處理常式集合中的程式碼<xref:System.Web.UI.WebControls.GridView.PageSize%2A>使用者選取的屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-905">The code in the handler sets the <xref:System.Web.UI.WebControls.GridView.PageSize%2A> property to the user's selection.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_17#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/Default3.aspx.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_17#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/Default3.aspx.vb#2)]  
  
 <span data-ttu-id="21d7d-906">第三個範例會顯示 Customers 資料表中擷取資料的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-906">The third example shows the data access class that retrieves data from the Customers table.</span></span> <span data-ttu-id="21d7d-907">它包含方法，名為`GetSubsetOfEmployees`，這指派給<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-907">It includes a method named `GetSubsetOfEmployees`, which is assigned to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-908">此範例也會包含名為的方法`GetEmployeeCount`，這指派給<xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-908">The example also includes a method named `GetEmployeeCount`, which is assigned to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-909">類別會使用 LINQ 查詢的 Customers 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-909">The class uses LINQ to query the Customers table.</span></span> <span data-ttu-id="21d7d-910">這個範例需要 LINQ to SQL 類別代表 Customers 資料表與 Northwind 資料庫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-910">The example requires a LINQ to SQL class that represents the Northwind database and Customers table.</span></span> <span data-ttu-id="21d7d-911">如需詳細資訊，請參閱[How to： 建立 LINQ to SQL 類別，在 Web 專案](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-911">For more information, see [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_17#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/App_Code/CustomerLogic.cs#3)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_17#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/App_Code/CustomerLogic.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.EnablePaging" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSourceView.CanRetrieveTotalRowCount" />
      </Docs>
    </Member>
    <Member MemberName="Selected">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler Selected;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler Selected" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.Selected" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event Selected As ObjectDataSourceStatusEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceStatusEventHandler ^ Selected;" />
      <MemberSignature Language="F#" Value="member this.Selected : System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler " Usage="member this.Selected : System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-912">發生於 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" /> 作業已經完成時。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-912">Occurs when a <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" /> operation has completed.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-913">處理<xref:System.Web.UI.WebControls.ObjectDataSource.Selected>事件來檢查傳回值或輸出參數的值，或是判斷是否發生例外狀況之後<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>作業已完成。</span><span class="sxs-lookup"><span data-stu-id="21d7d-913">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Selected> event to examine the values of a return value or output parameters, or to determine whether an exception was thrown after a <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> operation has completed.</span></span> <span data-ttu-id="21d7d-914">傳回值，輸出參數和例外狀況處理屬性都是從<xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs>與事件相關聯的物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-914">The return value, output parameters, and exception handling properties are available from the <xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs> object that is associated with the event.</span></span>  
  
 <span data-ttu-id="21d7d-915">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-915">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-916">下列三個範例顯示 Web 網頁、 程式碼後置頁面類別和資料存取類別，可讓使用者擷取並更新 Northwind 資料庫中的 [員工] 資料表中的記錄。</span><span class="sxs-lookup"><span data-stu-id="21d7d-916">The following three examples show a Web page, a code-behind page class, and a data-access class that enable a user to retrieve and update records in the Employees table in the Northwind database.</span></span>  
  
 <span data-ttu-id="21d7d-917">第一個範例顯示包含兩個的 Web 網頁<xref:System.Web.UI.WebControls.ObjectDataSource>控制項<xref:System.Web.UI.WebControls.DropDownList>控制項和<xref:System.Web.UI.WebControls.DetailsView>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-917">The first example shows a Web page that contains two <xref:System.Web.UI.WebControls.ObjectDataSource> controls, a <xref:System.Web.UI.WebControls.DropDownList> control, and a <xref:System.Web.UI.WebControls.DetailsView> control.</span></span> <span data-ttu-id="21d7d-918">第一個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和<xref:System.Web.UI.WebControls.DropDownList>控制項用來擷取並顯示資料庫中的員工名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-918">The first <xref:System.Web.UI.WebControls.ObjectDataSource> control and the <xref:System.Web.UI.WebControls.DropDownList> control are used to retrieve and display employee names from the database.</span></span> <span data-ttu-id="21d7d-919">第二個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和<xref:System.Web.UI.WebControls.DetailsView>控制項用來擷取、 顯示和修改所選取的使用者的員工記錄的資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-919">The second <xref:System.Web.UI.WebControls.ObjectDataSource> control and the <xref:System.Web.UI.WebControls.DetailsView> control are used to retrieve, display, and modify the data from the employee record that is selected by the user.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_18#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/Default.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_18#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/Default.aspx#1)]  
  
 <span data-ttu-id="21d7d-920">第二個範例示範處理常式<xref:System.Web.UI.WebControls.ObjectDataSource.Selected>和<xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-920">The second example shows handlers for the <xref:System.Web.UI.WebControls.ObjectDataSource.Selected> and <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> events.</span></span> <span data-ttu-id="21d7d-921"><xref:System.Web.UI.WebControls.ObjectDataSource.Selected>事件處理常式會序列化物件，包含從 Employee 資料表中擷取的資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-921">The <xref:System.Web.UI.WebControls.ObjectDataSource.Selected> event handler serializes the object that contains data that was retrieved from the Employee table.</span></span> <span data-ttu-id="21d7d-922">已序列化的物件會儲存在檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="21d7d-922">The serialized object is stored in view state.</span></span> <span data-ttu-id="21d7d-923"><xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件處理常式會還原序列化的物件包含正在更新的資料記錄的原始資料的檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="21d7d-923">The <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> event handler deserializes the object in view state that contains the original data for the data record that is being updated.</span></span> <span data-ttu-id="21d7d-924">Update 方法，包含原始資料的物件會傳遞做為參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-924">The object that contains the original data is passed as a parameter to the Update method.</span></span> <span data-ttu-id="21d7d-925">原始的資料必須傳遞至資料庫，使它可以用來檢查是否已由其他處理序修改資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-925">The original data must be passed to the database so that it can be used to check whether the data has been modified by another process.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_18#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/Default.aspx.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_18#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/Default.aspx.vb#2)]  
  
 <span data-ttu-id="21d7d-926">第三個範例會顯示與 Northwind 資料庫互動的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-926">The third example shows the data access class that interacts with the Northwind database.</span></span> <span data-ttu-id="21d7d-927">類別會使用 LINQ 查詢並更新 [員工] 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-927">The class uses LINQ to query and update the Employees table.</span></span> <span data-ttu-id="21d7d-928">這個範例需要 LINQ to SQL 類別代表 Northwind 資料庫與 Employees 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-928">The example requires a LINQ to SQL class that represents the Northwind database and Employees table.</span></span> <span data-ttu-id="21d7d-929">如需詳細資訊，請參閱[How to： 建立 LINQ to SQL 類別，在 Web 專案](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-929">For more information, see [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_18#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/App_Code/EmployeeLogic.cs#5)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_18#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/App_Code/EmployeeLogic.vb#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.Selecting" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSourceView.OnSelected(System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs)" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectParameters" />
      </Docs>
    </Member>
    <Member MemberName="Selecting">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceSelectingEventHandler Selecting;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceSelectingEventHandler Selecting" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.Selecting" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event Selecting As ObjectDataSourceSelectingEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceSelectingEventHandler ^ Selecting;" />
      <MemberSignature Language="F#" Value="member this.Selecting : System.Web.UI.WebControls.ObjectDataSourceSelectingEventHandler " Usage="member this.Selecting : System.Web.UI.WebControls.ObjectDataSourceSelectingEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceSelectingEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-930">在 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" /> 作業之前發生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-930">Occurs before a <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" /> operation.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-931">處理<xref:System.Web.UI.WebControls.ObjectDataSource.Selecting>事件以執行特定應用程式，來驗證參數的值，或變更之前的參數值的其他初始化<xref:System.Web.UI.WebControls.ObjectDataSource>控制項執行資料擷取作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-931">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Selecting> event to perform additional initialization that is specific to your application, to validate the values of parameters, or to change the parameter values before the <xref:System.Web.UI.WebControls.ObjectDataSource> control performs the data retrieval operation.</span></span> <span data-ttu-id="21d7d-932">參數是可做為<xref:System.Collections.IDictionary>所存取的集合<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A>屬性，由<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-932">The parameters are available as an <xref:System.Collections.IDictionary> collection that is accessed by the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A> property, which is exposed by the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs> object.</span></span>  
  
 <span data-ttu-id="21d7d-933">這個事件可以引發兩次的單一呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法，如果<xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性設定。</span><span class="sxs-lookup"><span data-stu-id="21d7d-933">This event can be fired twice for a single call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method, if the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property is set.</span></span> <span data-ttu-id="21d7d-934"><xref:System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs.ExecutingSelectCount%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs>物件用來判斷是否選取已呼叫以擷取資料，或擷取計數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-934">The <xref:System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs.ExecutingSelectCount%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs> object is used to determine if select was called to retrieve data or retrieve the count.</span></span>  
  
 <span data-ttu-id="21d7d-935">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-935">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.Selected" />
        <altmember cref="M:System.Web.UI.WebControls.SqlDataSourceView.OnSelecting(System.Web.UI.WebControls.SqlDataSourceSelectingEventArgs)" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectParameters" />
      </Docs>
    </Member>
    <Member MemberName="SelectMethod">
      <MemberSignature Language="C#" Value="public string SelectMethod { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string SelectMethod" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" />
      <MemberSignature Language="VB.NET" Value="Public Property SelectMethod As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ SelectMethod { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SelectMethod : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.SelectMethod" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-936">取得或設定 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項叫用以擷取資料之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-936">Gets or sets the name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control invokes to retrieve data.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-937">字串，表示 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 用於擷取資料之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-937">A string that represents the name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> uses to retrieve data.</span>
          </span>
          <span data-ttu-id="21d7d-938">預設為空字串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-938">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-939">指定的方法可以有任何方法簽章，但它必須傳回一個顯示的下列資料表中的型別<xref:System.Web.UI.WebControls.ObjectDataSource>能夠成功呼叫它的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-939">The specified method can have any method signature, but it must return one of the types shown in the following table for the <xref:System.Web.UI.WebControls.ObjectDataSource> control to call it successfully.</span></span>  
  
|<span data-ttu-id="21d7d-940">傳回類型</span><span class="sxs-lookup"><span data-stu-id="21d7d-940">Return type</span></span>|<span data-ttu-id="21d7d-941">動作</span><span class="sxs-lookup"><span data-stu-id="21d7d-941">Action</span></span>|  
|-----------------|------------|  
|<xref:System.Collections.IEnumerable>|<span data-ttu-id="21d7d-942"><xref:System.Collections.IEnumerable>傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-942">The <xref:System.Collections.IEnumerable> is returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>|  
|<xref:System.Data.DataTable>|<span data-ttu-id="21d7d-943">A<xref:System.Data.DataView>使用建立<xref:System.Data.DataTable>，並由傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-943">A <xref:System.Data.DataView> is created using the <xref:System.Data.DataTable> and returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>|  
|<xref:System.Data.DataView>|<span data-ttu-id="21d7d-944">A<xref:System.Data.DataView>傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-944">A <xref:System.Data.DataView> is returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>|  
|<xref:System.Data.DataSet>|<span data-ttu-id="21d7d-945">第一個<xref:System.Data.DataTable>的<xref:System.Data.DataSet>擷取時，與<xref:System.Data.DataView>建立並傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-945">The first <xref:System.Data.DataTable> of the <xref:System.Data.DataSet> is extracted, and a <xref:System.Data.DataView> is created and returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>|  
|<xref:System.Object>|<span data-ttu-id="21d7d-946">物件會包裝在一個項目<xref:System.Collections.IEnumerable>集合，並由傳回<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-946">The object is wrapped in a one-element <xref:System.Collections.IEnumerable> collection and returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method.</span></span>|  
  
 <span data-ttu-id="21d7d-947"><xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.SelectMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-947">The <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.SelectMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-948">當您使用<xref:System.Web.UI.WebControls.ObjectDataSource>類別若要刪除或更新資料，請確定參數名稱設定為<xref:System.Web.UI.WebControls.ObjectDataSource>控制<xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A>集合或<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>集合符合 select 方法所傳回的資料行名稱.</span><span class="sxs-lookup"><span data-stu-id="21d7d-948">When you use the <xref:System.Web.UI.WebControls.ObjectDataSource> class to delete or update data, make sure that the parameter names configured for the <xref:System.Web.UI.WebControls.ObjectDataSource> control in the <xref:System.Web.UI.WebControls.ObjectDataSource.DeleteParameters%2A> collection or <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection match the column names that are returned by the select method.</span></span>  
  
## <a name="object-lifetime"></a><span data-ttu-id="21d7d-949">物件存留期</span><span class="sxs-lookup"><span data-stu-id="21d7d-949">Object Lifetime</span></span>  
 <span data-ttu-id="21d7d-950">所識別的方法<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性可以是執行個體方法或`static`(`Shared`在 Visual Basic 中) 方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-950">The method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property can be an instance method or a `static` (`Shared` in Visual Basic) method.</span></span> <span data-ttu-id="21d7d-951">如果是執行個體方法，商務物件會建立，並且由所指定的方法終結每次<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-951">If it is an instance method, the business object is created and destroyed each time the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-952">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>事件，以使用商務物件由所指定的方法之前<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-952">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated> and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating> events to work with the business object before the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-953">您也可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>所指定的方法之後，就會引發的事件<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-953">You can also handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event that is raised after the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-954">如果實作的商務物件<xref:System.IDisposable>介面，<xref:System.IDisposable.Dispose%2A>方法會終結物件之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-954">If the business object implements the <xref:System.IDisposable> interface, the <xref:System.IDisposable.Dispose%2A> method is called before the object is destroyed.</span></span> <span data-ttu-id="21d7d-955">如果該方法是`static`(`Shared`在 Visual Basic 中)，不會建立商務物件，而且您無法處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>， <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>，和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-955">If the method is `static` (`Shared` in Visual Basic), the business object is never created and you cannot handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>, <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>, and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> events.</span></span>  
  
## <a name="parameter-merging"></a><span data-ttu-id="21d7d-956">合併的參數</span><span class="sxs-lookup"><span data-stu-id="21d7d-956">Parameter Merging</span></span>  
 <span data-ttu-id="21d7d-957">若要加入參數<xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>集合，從下列來源：</span><span class="sxs-lookup"><span data-stu-id="21d7d-957">Parameters are added to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> collection from these sources:</span></span>  
  
-   <span data-ttu-id="21d7d-958">以宣告方式從`SelectParameters`項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-958">Declaratively from the `SelectParameters` element.</span></span>  
  
-   <span data-ttu-id="21d7d-959">以程式設計方式從`Selecting`方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-959">Programmatically from the `Selecting` method.</span></span>  
  
 <span data-ttu-id="21d7d-960">首先，在列出參數`SelectParameters`加入項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-960">First, the parameters listed in the `SelectParameters` element are added.</span></span> <span data-ttu-id="21d7d-961">第二，以程式設計方式加入和移除參數<xref:System.Web.UI.WebControls.ObjectDataSource.Selecting>事件之前發生<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法執行。</span><span class="sxs-lookup"><span data-stu-id="21d7d-961">Second, parameters are programmatically added and removed in the <xref:System.Web.UI.WebControls.ObjectDataSource.Selecting> event, which occurs before the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method is run.</span></span> <span data-ttu-id="21d7d-962">會合併這些參數之後，就會解決方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-962">The method is resolved after the parameters are merged.</span></span> <span data-ttu-id="21d7d-963">在下一節討論方法解析。</span><span class="sxs-lookup"><span data-stu-id="21d7d-963">Method resolution is discussed in the next section.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-964">您應該驗證您從用戶端接收任何參數值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-964">You should validate any parameter value that you receive from the client.</span></span> <span data-ttu-id="21d7d-965">執行階段只會替代參數值到<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-965">The runtime simply substitutes the parameter value into the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span>  
  
## <a name="method-resolution"></a><span data-ttu-id="21d7d-966">方法解析</span><span class="sxs-lookup"><span data-stu-id="21d7d-966">Method Resolution</span></span>  
 <span data-ttu-id="21d7d-967">當<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>呼叫方法時，資料繫結控制項，以宣告方式中所建立的參數的資料欄位`SelectParameters`項目，並已加入的參數<xref:System.Web.UI.WebControls.ObjectDataSource.Selecting>所有合併事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-967">When the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method is called, the data fields from the data-bound control, the parameters that were created declaratively in the `SelectParameters` element, and the parameters that were added in the <xref:System.Web.UI.WebControls.ObjectDataSource.Selecting> event handler are all merged.</span></span> <span data-ttu-id="21d7d-968">（如需詳細資訊，請參閱上一節）。<xref:System.Web.UI.WebControls.ObjectDataSource>控制然後嘗試尋找要呼叫的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-968">(For more information, see the preceding section.) The <xref:System.Web.UI.WebControls.ObjectDataSource> control then attempts to find a method to call.</span></span> <span data-ttu-id="21d7d-969">首先，它會尋找名稱中指定的一或多個方法<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-969">First, it looks for one or more methods with the name that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span> <span data-ttu-id="21d7d-970">如果找到相符項目，<xref:System.InvalidOperationException>擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="21d7d-970">If no match is found, an <xref:System.InvalidOperationException> exception is thrown.</span></span> <span data-ttu-id="21d7d-971">如果找到相符項目，則會尋找相符的參數名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-971">If a match is found, it then looks for matching parameter names.</span></span> <span data-ttu-id="21d7d-972">例如，假設由所指定的型別<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性有兩個方法，名為`SelectARecord`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-972">For example, suppose a type that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property has two methods named `SelectARecord`.</span></span> <span data-ttu-id="21d7d-973">一個`SelectARecord`具有一個參數， `ID`，和其他`SelectARecord`有兩個參數，`Name`和`Number`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-973">One `SelectARecord` has one parameter, `ID`, and the other `SelectARecord` has two parameters, `Name` and `Number`.</span></span> <span data-ttu-id="21d7d-974">如果<xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>集合具有名為只有一個參數`ID`、`SelectARecord`方法只`ID`參數呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-974">If the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> collection has only one parameter named `ID`, the `SelectARecord` method with just the `ID` parameter is called.</span></span> <span data-ttu-id="21d7d-975">參數的型別不會檢查在解析方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-975">The type of the parameter is not checked in resolving the methods.</span></span> <span data-ttu-id="21d7d-976">參數的順序不重要。</span><span class="sxs-lookup"><span data-stu-id="21d7d-976">The order of the parameters does not matter.</span></span>  
  
 <span data-ttu-id="21d7d-977">如果<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性設定，方法解決了不同的方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-977">If the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property is set, the method is resolved in a different way.</span></span> <span data-ttu-id="21d7d-978"><xref:System.Web.UI.WebControls.ObjectDataSource>中指定名稱的方法會尋找<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>採用一個參數類型的屬性中指定<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-978">The <xref:System.Web.UI.WebControls.ObjectDataSource> looks for a method with the name that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property that takes one parameter of the type that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property.</span></span> <span data-ttu-id="21d7d-979">在此情況下，參數的名稱並不重要。</span><span class="sxs-lookup"><span data-stu-id="21d7d-979">In this case, the name of the parameter does not matter.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-980">下列程式碼範例示範如何<xref:System.Web.UI.WebControls.GridView>控制項可以顯示資料使用<xref:System.Web.UI.WebControls.ObjectDataSource>Web Form 網頁上的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-980">The following code example demonstrates how a <xref:System.Web.UI.WebControls.GridView> control can display data using an <xref:System.Web.UI.WebControls.ObjectDataSource> control on a Web Forms page.</span></span> <span data-ttu-id="21d7d-981"><xref:System.Web.UI.WebControls.ObjectDataSource>識別部分或完整限定的類別名稱及其<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性和方法，呼叫以擷取資料以其<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-981">The <xref:System.Web.UI.WebControls.ObjectDataSource> identifies a partially or fully qualified class name with its <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property and a method that is called to retrieve data with its <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span> <span data-ttu-id="21d7d-982">在執行階段，建立物件，並使用反映來呼叫方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-982">At run time, the object is created and the method is called using reflection.</span></span> <span data-ttu-id="21d7d-983"><xref:System.Web.UI.WebControls.GridView>控制項列舉<xref:System.Collections.IEnumerable>所指定之方法所傳回的集合<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性，並顯示資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-983">The <xref:System.Web.UI.WebControls.GridView> control enumerates through the <xref:System.Collections.IEnumerable> collection that is returned by the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property, and displays the data.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_1#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_1/CS/objds1cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_1#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_1/VB/objds1vb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectParameters" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" />
      </Docs>
    </Member>
    <Member MemberName="SelectParameters">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.ParameterCollection SelectParameters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.ParameterCollection SelectParameters" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.SelectParameters" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property SelectParameters As ParameterCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::ParameterCollection ^ SelectParameters { System::Web::UI::WebControls::ParameterCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.SelectParameters : System.Web.UI.WebControls.ParameterCollection" Usage="System.Web.UI.WebControls.ObjectDataSource.SelectParameters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("System.Web.UI.Design.WebControls.ParameterCollectionEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", typeof(System.Drawing.Design.UITypeEditor))</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.MergableProperty(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Web.UI.PersistenceMode(System.Web.UI.PersistenceMode.InnerProperty)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ParameterCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-984">取得參數的集合，這些參數是由 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> 屬性指定的方法所使用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-984">Gets a collection of parameters that are used by the method specified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> property.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-985">參數的集合，這些參數是由 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> 屬性指定的方法所使用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-985">A collection of parameters that are used by the method specified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> property.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-986"><xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>屬性會取得<xref:System.Web.UI.WebControls.ObjectDataSourceView.SelectParameters%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-986">The <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> property gets the <xref:System.Web.UI.WebControls.ObjectDataSourceView.SelectParameters%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-987">加入參數，以便<xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>集合中的以宣告方式依使用`SelectParameters`項目或以程式設計方式中的處理常式<xref:System.Web.UI.WebControls.ObjectDataSource.Selecting>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-987">You add parameters to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> collection declaratively by using the `SelectParameters` element or programmatically in the handler for the <xref:System.Web.UI.WebControls.ObjectDataSource.Selecting> event.</span></span> <span data-ttu-id="21d7d-988">在執行階段，參數會列在`SelectParameters`項目會先加入至集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-988">At run time, parameters listed in the `SelectParameters` element are added to the collection first.</span></span> <span data-ttu-id="21d7d-989">然後加入或移除的處理常式集合中的參數<xref:System.Web.UI.WebControls.ObjectDataSource.Selecting>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-989">Parameters in the collection are then added or removed by the handler for the <xref:System.Web.UI.WebControls.ObjectDataSource.Selecting> event.</span></span> <span data-ttu-id="21d7d-990"><xref:System.Web.UI.WebControls.ObjectDataSource.Selecting>之前引發事件<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法執行。</span><span class="sxs-lookup"><span data-stu-id="21d7d-990">The <xref:System.Web.UI.WebControls.ObjectDataSource.Selecting> event is raised before the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method is run.</span></span>  
  
 <span data-ttu-id="21d7d-991">之前<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>執行方法時，名稱和參數中所包含的型別<xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>集合必須符合所指定之方法的簽章<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-991">Before the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method is run, the names and types of the parameters that are contained in the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> collection must match the signature of the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span> <span data-ttu-id="21d7d-992">例如，如果名為 select 方法`GetEmployeesByStateAndAge`採用`string`和整數做為參數，<xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A>集合必須包含兩個參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-992">For example, if a select method named `GetEmployeesByStateAndAge` takes a `string` and an integer as parameters, the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectParameters%2A> collection must contain two parameters.</span></span> <span data-ttu-id="21d7d-993">第一個參數必須解析成字串，而且第二個參數必須解析成整數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-993">The first parameter must resolve to a string and the second parameter must resolve to an integer.</span></span> <span data-ttu-id="21d7d-994">這兩個參數可以指定在標記中`SelectParameters`項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-994">Both parameters can be specified in markup in the `SelectParameters` element.</span></span> <span data-ttu-id="21d7d-995">或者，也可以加入<xref:System.Web.UI.WebControls.ObjectDataSource.Selecting>加入事件處理常式或一個參數標記，而且可以透過程式設計方式加入另一個。</span><span class="sxs-lookup"><span data-stu-id="21d7d-995">Alternatively, they can be can be added in the <xref:System.Web.UI.WebControls.ObjectDataSource.Selecting> event handler, or one parameter can be added in markup and the other one can be added programmatically.</span></span>  
  
 <span data-ttu-id="21d7d-996">如需詳細資訊，請參閱[ObjectDataSource 控制項配合使用參數](http://msdn.microsoft.com/library/45fb67ee-9be7-49b7-9421-e242203dafa4)和<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-996">For more information, see [Using Parameters with the ObjectDataSource Control](http://msdn.microsoft.com/library/45fb67ee-9be7-49b7-9421-e242203dafa4) and the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod> property.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-997">在程式碼<xref:System.Web.UI.WebControls.ObjectDataSource.Selecting>事件處理常式或所指定的方法中<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性，請確定您驗證接收自用戶端的任何參數值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-997">In the code for the <xref:System.Web.UI.WebControls.ObjectDataSource.Selecting> event handler or in the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property, make sure that you validate any parameter value that is received from the client.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-998">下列程式碼範例示範如何擷取單一資料記錄使用<xref:System.Web.UI.WebControls.ObjectDataSource>控制，並顯示在<xref:System.Web.UI.WebControls.DetailsView>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-998">The following code example demonstrates how to retrieve a single data record using an <xref:System.Web.UI.WebControls.ObjectDataSource> control and display it in a <xref:System.Web.UI.WebControls.DetailsView> control.</span></span> <span data-ttu-id="21d7d-999"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項擷取特定員工記錄藉由呼叫`GetEmployee`方法`EmployeeLogic`類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-999">The <xref:System.Web.UI.WebControls.ObjectDataSource> control retrieves a specific employee record by calling the `GetEmployee` method of the `EmployeeLogic` class.</span></span> <span data-ttu-id="21d7d-1000">`GetEmployee`方法要求員工識別碼參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1000">The `GetEmployee` method requires an employee ID parameter.</span></span> <span data-ttu-id="21d7d-1001"><xref:System.Web.UI.WebControls.ObjectDataSource>控制使用`QueryStringParameter`建立標記中的項目<xref:System.Web.UI.WebControls.QueryStringParameter>物件，將從 URL 擷取指定的查詢字串參數的值，並將它傳遞給`GetEmployee`方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1001">The <xref:System.Web.UI.WebControls.ObjectDataSource> control uses a `QueryStringParameter` element in markup to create a <xref:System.Web.UI.WebControls.QueryStringParameter> object that will retrieve the value of a specified query-string parameter from the URL and pass it to the `GetEmployee` method.</span></span>  
  
 <span data-ttu-id="21d7d-1002">其他參數類別可以用來擷取其他來源，例如控制項屬性、 表單欄位、 cookie、 ASP.NET 設定檔資料或工作階段狀態的值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1002">Other parameter classes can be used to retrieve values from other sources, such as control properties, form fields, cookies, ASP.NET profile data, or session state.</span></span> <span data-ttu-id="21d7d-1003">您也可以使用標記中定義以硬式編碼值傳遞給 select 方法的參數物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1003">You can also use a parameter object that is defined in markup in order to pass a hard-coded value to the select method.</span></span> <span data-ttu-id="21d7d-1004">如需可用的參數類別的詳細資訊，請參閱[使用參數與篩選的資料來源控制項](http://msdn.microsoft.com/library/88622d04-2989-484e-93fe-594cd98dcf5f)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1004">For more information about parameter classes that are available, see [Using Parameters with Data Source Controls for Filtering](http://msdn.microsoft.com/library/88622d04-2989-484e-93fe-594cd98dcf5f).</span></span>  
  
 <span data-ttu-id="21d7d-1005">若要執行此範例中，您需要下列項目：</span><span class="sxs-lookup"><span data-stu-id="21d7d-1005">To run this example, you will need the following:</span></span>  
  
-   <span data-ttu-id="21d7d-1006">網站具有名為連線字串`NorthwindConnection`連接至 Northwind Traders 資料庫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1006">A Web site that has a connection string named `NorthwindConnection` that connects to the Northwind Traders database.</span></span> <span data-ttu-id="21d7d-1007">如需詳細資訊，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource>類別概觀。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1007">For more information, see the <xref:System.Web.UI.WebControls.ObjectDataSource> class overview.</span></span>  
  
-   <span data-ttu-id="21d7d-1008">`EmployeeLogic`類別做為其中一個程式碼範例顯示<xref:System.Web.UI.WebControls.ObjectDataSource>類別概觀。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1008">The `EmployeeLogic` class that is shown as one of the code examples for the <xref:System.Web.UI.WebControls.ObjectDataSource> class overview.</span></span> <span data-ttu-id="21d7d-1009">將類別檔案必須位於 App_Code 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1009">The class file must be located in the App_Code folder.</span></span>  
  
-   <span data-ttu-id="21d7d-1010">範例程式碼可以執行的.aspx 網頁。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1010">The sample code can be run as an .aspx page.</span></span> <span data-ttu-id="21d7d-1011">如果您要求的頁面不含查詢字串參數，則會顯示錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1011">If you request the page without a query-string parameter, an error message is displayed.</span></span> <span data-ttu-id="21d7d-1012">如果您要求的頁面使用的查詢字串，例如`?empid=1`.aspx 檔案的名稱之後, 您會看到詳細資料要求的員工。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1012">If you request the page using a query string such as `?empid=1` after the name of the .aspx file, you will see the details for the requested employee.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_3#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_3/CS/objds3cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_3#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_3/VB/objds3vb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" />
      </Docs>
    </Member>
    <Member MemberName="SortParameterName">
      <MemberSignature Language="C#" Value="public string SortParameterName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string SortParameterName" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.SortParameterName" />
      <MemberSignature Language="VB.NET" Value="Public Property SortParameterName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ SortParameterName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SortParameterName : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.SortParameterName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-1013">取得或設定商務物件的名稱，<see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> 參數使用該名稱指定資料來源排序支援的排序運算式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1013">Gets or sets the name of the business object that the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.SelectMethod" /> parameter used to specify a sort expression for data source sorting support.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-1014">方法參數的名稱，用於指出要用於排序資料的參數。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1014">The name of the method parameter used to indicate the parameter which is used to sort the data.</span>
          </span>
          <span data-ttu-id="21d7d-1015">預設為空字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1015">The default is an empty string.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-1016"><xref:System.Web.UI.WebControls.ObjectDataSource.SortParameterName%2A>屬性用來支援資料來源排序。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1016">The <xref:System.Web.UI.WebControls.ObjectDataSource.SortParameterName%2A> property is used to support data source sorting.</span></span> <span data-ttu-id="21d7d-1017">當<xref:System.Web.UI.DataSourceSelectArguments.SortExpression%2A>上設定屬性<xref:System.Web.UI.DataSourceSelectArguments>物件，並傳遞至<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>方法，<xref:System.Web.UI.WebControls.ObjectDataSource.SortParameterName%2A>值識別的參數名稱<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>，據此排序資料的商務物件方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1017">When a <xref:System.Web.UI.DataSourceSelectArguments.SortExpression%2A> property is set on the <xref:System.Web.UI.DataSourceSelectArguments> object and passed to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method, the <xref:System.Web.UI.WebControls.ObjectDataSource.SortParameterName%2A> value identifies the parameter name of the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> business object method according to which the data is sorted.</span></span>  
  
 <span data-ttu-id="21d7d-1018">如果<xref:System.Web.UI.WebControls.ObjectDataSource>與資料繫結控制項，會傳遞至以逗號分隔的欄位值的形式，後面加上此參數採用的值相關聯`"ASC"`或`"DESC"`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1018">If the <xref:System.Web.UI.WebControls.ObjectDataSource> is associated with a data-bound control, the values that are passed to this parameter take the form of comma-separated field values followed by `"ASC"` or `"DESC"`.</span></span> <span data-ttu-id="21d7d-1019">例如，在遞增排序的值`Name`會`"Name ASC"`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1019">For example, the value for an ascending sort on `Name` would be `"Name ASC"`.</span></span>  
  
 <span data-ttu-id="21d7d-1020"><xref:System.Web.UI.WebControls.ObjectDataSource.SortParameterName%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.SortParameterName%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1020">The <xref:System.Web.UI.WebControls.ObjectDataSource.SortParameterName%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.SortParameterName%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-1021">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1021">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-1022">第一個程式碼範例示範如何實作支援排序的型別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1022">The first code example demonstrates how to implement a type that supports sorting.</span></span> <span data-ttu-id="21d7d-1023">第二個程式碼範例示範如何實作的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1023">The second code example demonstrates how to implement a sort expression.</span></span>  
  
 <span data-ttu-id="21d7d-1024">下列程式碼範例示範如何實作支援排序的型別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1024">The following code example demonstrates how to implement a type that supports sorting.</span></span> <span data-ttu-id="21d7d-1025">`SelectMethod`的`SortingData`類別接受參數， `sortExpression`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1025">The `SelectMethod` of the `SortingData` class takes a parameter, `sortExpression`.</span></span> <span data-ttu-id="21d7d-1026">傳遞至字串`SelectMethod`用於<xref:System.Data.DataView.Sort%2A>屬性<xref:System.Data.DataView>所傳回的物件`SelectMethod`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1026">The string that is passed to `SelectMethod` is used for the <xref:System.Data.DataView.Sort%2A> property of the <xref:System.Data.DataView> object that is returned by `SelectMethod`.</span></span>  
  
 [!code-csharp[ObjectDataSourceSorting#1](~/samples/snippets/csharp/VS_Snippets_WebNet/ObjectDataSourceSorting/CS/SortingData.cs#1)]
 [!code-vb[ObjectDataSourceSorting#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/ObjectDataSourceSorting/VB/SortingData.vb#1)]  
  
 <span data-ttu-id="21d7d-1027">下列程式碼範例示範如何實作的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1027">The following code example demonstrates how to implement a sort expression.</span></span> <span data-ttu-id="21d7d-1028">Web 網頁中的程式碼建立的執行個體<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1028">The code in the Web page creates an instance of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-1029"><xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性設定為`SortingData`和<xref:System.Web.UI.WebControls.ObjectDataSource.SortParameterName%2A>屬性設定為`sortExpression`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1029">The <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property is set to `SortingData` and the <xref:System.Web.UI.WebControls.ObjectDataSource.SortParameterName%2A> property is set to `sortExpression`.</span></span> <span data-ttu-id="21d7d-1030"><xref:System.Web.UI.WebControls.GridView.AllowSorting%2A>屬性<xref:System.Web.UI.WebControls.GridView>控制設為  `true`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1030">The <xref:System.Web.UI.WebControls.GridView.AllowSorting%2A> property of the <xref:System.Web.UI.WebControls.GridView> control is set to `true`.</span></span> <span data-ttu-id="21d7d-1031">當使用者按一下**排序**按鈕、 欄位名稱`Name`或`Number`，傳遞至`SelectMethod`排序參數中。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1031">When the user clicks the **Sort** button, the field name, `Name` or `Number`, is passed to `SelectMethod` in the sort parameter.</span></span>  
  
 [!code-aspx-csharp[ObjectDataSourceSorting#2](~/samples/snippets/csharp/VS_Snippets_WebNet/ObjectDataSourceSorting/CS/SortingDataExample.aspx#2)]
 [!code-aspx-vb[ObjectDataSourceSorting#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/ObjectDataSourceSorting/VB/SortingDataExampleVB.aspx#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSourceView.CanSort" />
      </Docs>
    </Member>
    <Member MemberName="SqlCacheDependency">
      <MemberSignature Language="C#" Value="public virtual string SqlCacheDependency { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string SqlCacheDependency" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Property SqlCacheDependency As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ SqlCacheDependency { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SqlCacheDependency : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-1032">取得或設定以分號分隔的字串，表示用於 Microsoft SQL Server 快取相依性的資料庫和資料表。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1032">Gets or sets a semicolon-delimited string that indicates which databases and tables to use for the Microsoft SQL Server cache dependency.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-1033">字串，表示用於 SQL Server 快取相依性的資料庫和資料表。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1033">A string that indicates which databases and tables to use for the SQL Server cache dependency.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-1034"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項支援選擇性的到期原則為基礎的<xref:System.Web.Caching.SqlCacheDependency>（服務必須設定為資料庫伺服器） 的資料快取的物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1034">The <xref:System.Web.UI.WebControls.ObjectDataSource> control supports an optional expiration policy that is based on the <xref:System.Web.Caching.SqlCacheDependency> object for the data cache (the service must be configured for the database server).</span></span>  
  
 <span data-ttu-id="21d7d-1035">SQL Server 支援兩種機制，快取無效： 輪詢和通知。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1035">SQL Server supports two mechanisms for cache invalidation: polling and notification.</span></span> <span data-ttu-id="21d7d-1036">每一種機制具有不同的語法為<xref:System.Web.Caching.SqlCacheDependency>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1036">Each mechanism has a different syntax for the <xref:System.Web.Caching.SqlCacheDependency> object.</span></span>  
  
 <span data-ttu-id="21d7d-1037"><xref:System.Web.UI.WebControls.ObjectDataSource>支援只有輪詢。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1037">The <xref:System.Web.UI.WebControls.ObjectDataSource> supports only polling.</span></span> <span data-ttu-id="21d7d-1038"><xref:System.Web.Caching.SqlCacheDependency>字串用來建立<xref:System.Data.SqlClient.SqlDependency>物件傳遞至<xref:System.Data.Common.DbCommand>建構函式之前<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>執行方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1038">The <xref:System.Web.Caching.SqlCacheDependency> string is used to create a <xref:System.Data.SqlClient.SqlDependency> object that is passed to the <xref:System.Data.Common.DbCommand> constructor before the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A> method is executed.</span></span> <span data-ttu-id="21d7d-1039"><xref:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency%2A>字串會識別資料庫和資料表，根據所使用的相同格式`@ Page`指示詞，其中字串的第一個部分是 SQL Server 資料庫的連接字串，後面接著冒號分隔符號和最後名稱資料庫資料表 (例如， `"connectionstring1:table1"`)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1039">The <xref:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency%2A> string identifies databases and tables according to the same format that is used by the `@ Page` directive, where the first part of the string is a connection string to a SQL Server database, followed by a colon delimiter, and finally the name of the database table (for example, `"connectionstring1:table1"`).</span></span> <span data-ttu-id="21d7d-1040">如果<xref:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency%2A>屬性相依於多個資料表，連接字串和資料表名稱組以分號分隔 (例如， `"connectionstring1:table1";connectionstring2:table2"`)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1040">If the <xref:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency%2A> property depends on more than one table, the connection string and table name pairs are separated by semicolons (for example, `"connectionstring1:table1";connectionstring2:table2"`).</span></span>  
  
 <span data-ttu-id="21d7d-1041">若要支援通知，您必須撰寫的快取邏輯中的實作您<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性及處理建構<xref:System.Web.Caching.SqlCacheDependency>程式碼中的物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1041">To support notification, you must write the cache logic in the implementation of your <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property and handle the construction of the <xref:System.Web.Caching.SqlCacheDependency> object in your code.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-1042">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1042">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-1043">第一個程式碼範例示範如何建立 SQL Server 的快取相依性，並設定<xref:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1043">The first code example demonstrates how to create a SQL Server cache dependency and set the <xref:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency%2A> property of a <xref:System.Web.UI.WebControls.ObjectDataSource> object.</span></span> <span data-ttu-id="21d7d-1044">第二個程式碼範例示範如何實作包裝函式方法會傳回<xref:System.Data.DataSet>物件，讓快取和使用篩選<xref:System.Web.UI.WebControls.ObjectDataSource>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1044">The second code example demonstrates how to implement a wrapper method that returns a <xref:System.Data.DataSet> object to enable caching and filtering with an <xref:System.Web.UI.WebControls.ObjectDataSource> object.</span></span>  
  
 <span data-ttu-id="21d7d-1045">下列程式碼範例示範如何建立 SQL Server 的快取相依性，並設定<xref:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1045">The following code example demonstrates how to create a SQL Server cache dependency and set the <xref:System.Web.UI.WebControls.ObjectDataSource.SqlCacheDependency%2A> property of a <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-1046">在此範例中，資料庫會輪詢每隔 120 秒。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1046">In this example, the database is polled every 120 seconds.</span></span> <span data-ttu-id="21d7d-1047">如果 Northwind Traders 員工中的資料表格變更期間的時間、 快取的任何資料<xref:System.Web.UI.WebControls.ObjectDataSource>控制和顯示<xref:System.Web.UI.WebControls.GridView>控制項已過期，而且新的資料集擷取下一個頁面要求上。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1047">If the data in the Northwind Traders Employees table changes during that time, any data that is cached by the <xref:System.Web.UI.WebControls.ObjectDataSource> control and displayed by the <xref:System.Web.UI.WebControls.GridView> control is expired and a new set of data is retrieved on the next request for the page.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_7#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_7/CS/objds7cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_7#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_7/VB/objds7vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-1048">下列程式碼範例示範如何實作包裝函式方法會傳回<xref:System.Data.DataSet>物件，讓快取和使用篩選<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1048">The following code example demonstrates how to implement a wrapper method that returns a <xref:System.Data.DataSet> object to enable caching and filtering with an <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-1049">中的基底實作`EmployeeLogic`類別`GetAllEmployees`方法會傳回<xref:System.Collections.ArrayList>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1049">In the base implementation of the `EmployeeLogic` class, the `GetAllEmployees` method returns an <xref:System.Collections.ArrayList> object.</span></span> <span data-ttu-id="21d7d-1050">而不是重構物件完全使用<xref:System.Web.UI.WebControls.ObjectDataSource>Web Form 網頁上，包裝函式方法名為`GetAllEmployeesAsDataSet`加入傳回一組`NorthwindEmployee`資料做為<xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1050">Instead of refactoring the object completely to work with the <xref:System.Web.UI.WebControls.ObjectDataSource> on a Web Forms page, a wrapper method named `GetAllEmployeesAsDataSet` is added that returns a set of `NorthwindEmployee` data as a <xref:System.Data.DataSet>.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_5#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_5/CS/northwindemployee5.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_5#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_5/VB/northwindemployee5.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.Caching.SqlCacheDependency" />
      </Docs>
    </Member>
    <Member MemberName="StartRowIndexParameterName">
      <MemberSignature Language="C#" Value="public string StartRowIndexParameterName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string StartRowIndexParameterName" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName" />
      <MemberSignature Language="VB.NET" Value="Public Property StartRowIndexParameterName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ StartRowIndexParameterName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.StartRowIndexParameterName : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("startRowIndex")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-1051">取得或設定資料擷取方法參數的名稱，用於指出為資料來源分頁支援所擷取之第一個資料錄的識別項的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1051">Gets or sets the name of the data retrieval method parameter that is used to indicate the value of the identifier of the first record to retrieve for data source paging support.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-1052">用於指出要擷取之第一個資料錄的商務物件方法參數名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1052">The name of the business object method parameter used to indicate the first record to retrieve.</span>
          </span>
          <span data-ttu-id="21d7d-1053">參數必須傳回整數值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1053">The parameter must return an integer value.</span>
          </span>
          <span data-ttu-id="21d7d-1054">預設值是<c>"startRowIndex"</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1054">The default is <c>"startRowIndex"</c>.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-1055"><xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A>屬性用來支援資料來源分頁。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1055">The <xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A> property is used to support data source paging.</span></span> <span data-ttu-id="21d7d-1056">如需分頁會受到<xref:System.Web.UI.WebControls.ObjectDataSource>控制，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1056">For information about how paging is supported by the <xref:System.Web.UI.WebControls.ObjectDataSource> control, see <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>.</span></span>  
  
 <span data-ttu-id="21d7d-1057"><xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.StartRowIndexParameterName%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1057">The <xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.StartRowIndexParameterName%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-1058">下列三個範例顯示 Web 網頁、 程式碼後置頁面類別和資料存取類別，可讓使用者能夠選取的多少筆記錄會顯示在頁面。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1058">The following three examples show a Web page, a code-behind page class, and a data-access class that enable the user to pick how many records are displayed in the page.</span></span>  
  
 <span data-ttu-id="21d7d-1059">網頁包含<xref:System.Web.UI.WebControls.ObjectDataSource>控制項<xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A>屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1059">The Web page contains an <xref:System.Web.UI.WebControls.ObjectDataSource> control whose <xref:System.Web.UI.WebControls.ObjectDataSource.EnablePaging%2A> property is set to `true`.</span></span> <span data-ttu-id="21d7d-1060"><xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性設定為在查詢中傳回的總記錄數的方法名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1060">The <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property is set to the name of a method that returns the total number of records in the query.</span></span> <span data-ttu-id="21d7d-1061"><xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A>屬性和<xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A>屬性都設為 Select 方法中使用參數的名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1061">The <xref:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName%2A> property and the <xref:System.Web.UI.WebControls.ObjectDataSource.StartRowIndexParameterName%2A> property are set to the names of the parameters that are used in the Select method.</span></span> <span data-ttu-id="21d7d-1062">這個頁面也包含<xref:System.Web.UI.WebControls.DropDownList>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1062">The page also contains a <xref:System.Web.UI.WebControls.DropDownList> control.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_17#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/Default3.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_17#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/Default3.aspx#1)]  
  
 <span data-ttu-id="21d7d-1063">第二個範例顯示的處理常式<xref:System.Web.UI.WebControls.ListControl.SelectedIndexChanged?displayProperty=nameWithType>事件<xref:System.Web.UI.WebControls.DropDownList>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1063">The second example shows a handler for the <xref:System.Web.UI.WebControls.ListControl.SelectedIndexChanged?displayProperty=nameWithType> event of the <xref:System.Web.UI.WebControls.DropDownList> control.</span></span> <span data-ttu-id="21d7d-1064">處理常式集合中的程式碼<xref:System.Web.UI.WebControls.GridView.PageSize%2A>使用者選取的屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1064">The code in the handler sets the <xref:System.Web.UI.WebControls.GridView.PageSize%2A> property to the user's selection.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_17#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/Default3.aspx.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_17#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/Default3.aspx.vb#2)]  
  
 <span data-ttu-id="21d7d-1065">第三個範例會顯示 Customers 資料表中擷取資料的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1065">The third example shows the data access class that retrieves data from the Customers table.</span></span> <span data-ttu-id="21d7d-1066">它包含方法，名為`GetSubsetOfEmployees`，這指派給<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1066">It includes a method named `GetSubsetOfEmployees`, which is assigned to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-1067">此範例也會包含名為的方法`GetEmployeeCount`，這指派給<xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1067">The example also includes a method named `GetEmployeeCount`, which is assigned to the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectCountMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span> <span data-ttu-id="21d7d-1068">類別會使用 LINQ 查詢的 Customers 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1068">The class uses LINQ to query the Customers table.</span></span> <span data-ttu-id="21d7d-1069">這個範例需要 LINQ to SQL 類別代表 Customers 資料表與 Northwind 資料庫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1069">The example requires a LINQ to SQL class that represents the Northwind database and Customers table.</span></span> <span data-ttu-id="21d7d-1070">如需詳細資訊，請參閱[How to： 建立 LINQ to SQL 類別，在 Web 專案](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1070">For more information, see [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_17#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/CS/App_Code/CustomerLogic.cs#3)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_17#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_17/VB/App_Code/CustomerLogic.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.MaximumRowsParameterName" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.EnablePaging" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSourceView.CanPage" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Select" />
      </Docs>
    </Member>
    <Member MemberName="TrackViewState">
      <MemberSignature Language="C#" Value="protected override void TrackViewState ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void TrackViewState() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.TrackViewState" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub TrackViewState ()" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void TrackViewState();" />
      <MemberSignature Language="F#" Value="override this.TrackViewState : unit -&gt; unit" Usage="objectDataSource.TrackViewState " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-1071">追蹤 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項的檢視狀態變更，讓這些變更能夠儲存在 <see cref="T:System.Web.UI.StateBag" /> 物件中。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1071">Tracks view-state changes to the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control so that they can be stored in the <see cref="T:System.Web.UI.StateBag" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-1072"><xref:System.Web.UI.WebControls.ObjectDataSource.TrackViewState%2A>標示的起點開始追蹤並儲存變更至控制項的檢視狀態物件的一部分，會覆寫方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1072">The <xref:System.Web.UI.WebControls.ObjectDataSource.TrackViewState%2A> method is overridden to mark the starting point to begin tracking and saving changes to the control as part of the view state for the object.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Web.UI.IStateManager.TrackViewState" />
        <altmember cref="T:System.Web.UI.WebControls.ObjectDataSource" />
      </Docs>
    </Member>
    <Member MemberName="TypeName">
      <MemberSignature Language="C#" Value="public string TypeName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string TypeName" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.TypeName" />
      <MemberSignature Language="VB.NET" Value="Public Property TypeName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ TypeName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.TypeName : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.TypeName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-1073">取得或設定 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 物件表示之類別的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1073">Gets or sets the name of the class that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> object represents.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-1074">部分或完整類別名稱 (Fully Qualified Class Name)，識別 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 表示的物件型別。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1074">A partially or fully qualified class name that identifies the type of the object that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> represents.</span>
          </span>
          <span data-ttu-id="21d7d-1075">預設為空字串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1075">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-1076">若要建立物件的執行個體<xref:System.Web.UI.WebControls.ObjectDataSource>控制項繫結至、 控制項使用反映來載入執行階段的型別名稱識別的型別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1076">To create an instance of the object that the <xref:System.Web.UI.WebControls.ObjectDataSource> control binds to, the control uses reflection to load the type that is identified by the type name at run time.</span></span> <span data-ttu-id="21d7d-1077">因此，值<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性可以是位於 Bin 或 App_Code 目錄中的程式碼的不完整的類型或全域組件快取中註冊的程式碼的完整限定的類型名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1077">Therefore, the value of the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property can be a partially qualified type for code that is located in the Bin or App_Code directories or a fully qualified type name for code that is registered in the global assembly cache.</span></span> <span data-ttu-id="21d7d-1078">如果您使用全域組件快取，您必須加入至適當的參考`assemblies`Machine.config 或 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1078">If you use the global assembly cache, you must add the appropriate reference to the `assemblies` section of the Machine.config or Web.config file.</span></span>  
  
 <span data-ttu-id="21d7d-1079">類型必須有預設建構函式，除非您處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>自行建立它的執行個體的事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1079">The type must have a default constructor, unless you handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating> event to create an instance of it yourself.</span></span> <span data-ttu-id="21d7d-1080">每次呼叫建立類型的執行個體<xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>， <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>，和<xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A>方法，如果型別上的方法成員方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1080">An instance of the type is created for each call to the <xref:System.Web.UI.WebControls.ObjectDataSource.Select%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>, <xref:System.Web.UI.WebControls.ObjectDataSource.Insert%2A>, and <xref:System.Web.UI.WebControls.ObjectDataSource.Delete%2A> methods, if the methods on the type are member methods.</span></span> <span data-ttu-id="21d7d-1081">如果方法不會建立執行個體`static`(`Shared`在 Visual Basic 中)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1081">An instance is not created if the methods are `static` (`Shared` in Visual Basic).</span></span> <span data-ttu-id="21d7d-1082">如果類型實作<xref:System.IDisposable>介面，<xref:System.IDisposable.Dispose%2A>方法會終結物件之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1082">If the type implements the <xref:System.IDisposable> interface, the <xref:System.IDisposable.Dispose%2A> method is called before the object is destroyed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-1083">下列程式碼範例示範如何<xref:System.Web.UI.WebControls.GridView>控制項可以顯示資料，使用<xref:System.Web.UI.WebControls.ObjectDataSource>Web Form 網頁上的控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1083">The following code example demonstrates how a <xref:System.Web.UI.WebControls.GridView> control can display data by using an <xref:System.Web.UI.WebControls.ObjectDataSource> control on a Web Forms page.</span></span> <span data-ttu-id="21d7d-1084"><xref:System.Web.UI.WebControls.ObjectDataSource>識別部分或完整限定的類別名稱及其<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性和方法，呼叫以擷取資料以其<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1084">The <xref:System.Web.UI.WebControls.ObjectDataSource> identifies a partially or fully qualified class name with its <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property and a method that is called to retrieve data with its <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property.</span></span> <span data-ttu-id="21d7d-1085">在執行階段，建立物件，並使用反映來呼叫方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1085">At run time, the object is created and the method is called using reflection.</span></span> <span data-ttu-id="21d7d-1086"><xref:System.Web.UI.WebControls.GridView>控制項列舉<xref:System.Collections.IEnumerable>所傳回的集合<xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A>屬性，並顯示資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1086">The <xref:System.Web.UI.WebControls.GridView> control enumerates through the <xref:System.Collections.IEnumerable> collection that is returned by the <xref:System.Web.UI.WebControls.ObjectDataSource.SelectMethod%2A> property, and displays the data.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_1#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_1/CS/objds1cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_1#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_1/VB/objds1vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-1087">下列範例顯示類別<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性值參考。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1087">The following example shows the class that the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property value refers to.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_1#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_1/CS/northwindemployee1.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_1#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_1/VB/northwindemployee1.vb#2)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Update">
      <MemberSignature Language="C#" Value="public int Update ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32 Update() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.ObjectDataSource.Update" />
      <MemberSignature Language="VB.NET" Value="Public Function Update () As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; int Update();" />
      <MemberSignature Language="F#" Value="member this.Update : unit -&gt; int" Usage="objectDataSource.Update " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-1088">藉由呼叫由 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod" /> 屬性所識別的方法，同時使用 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters" /> 集合中的任何參數，執行更新作業。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1088">Performs an update operation by calling the method that is identified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod" /> property and any parameters that are in the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters" /> collection.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="21d7d-1089">表示基礎資料儲存中更新之資料列數目的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1089">A value that represents the number of rows updated in the underlying data storage.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-1090">商務物件會假設為一次，而不是批次中更新資料的一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1090">The business object is assumed to update data one record at a time, rather than in a batch.</span></span>  
  
 <span data-ttu-id="21d7d-1091">之前<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>執行作業時，<xref:System.Web.UI.WebControls.ObjectDataSourceView.OnUpdating%2A>呼叫方法來引發<xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1091">Before the <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> operation is performed, the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OnUpdating%2A> method is called to raise the <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> event.</span></span> <span data-ttu-id="21d7d-1092">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件檢查參數的值，並執行任何前置處理之前<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1092">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> event to examine the values of the parameters and to perform any preprocessing before an <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> operation.</span></span> <span data-ttu-id="21d7d-1093">若要執行更新作業，<xref:System.Web.UI.WebControls.ObjectDataSourceView>物件使用反映來建立物件所識別的執行個體<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1093">To perform an update operation, the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object uses reflection to create an instance of the object that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property.</span></span> <span data-ttu-id="21d7d-1094">然後它會呼叫的方法，由<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>使用所有相關聯的屬性<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1094">It then calls the method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property, using any associated <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> properties.</span></span> <span data-ttu-id="21d7d-1095">之後<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>作業完成時，<xref:System.Web.UI.WebControls.ObjectDataSourceView.OnUpdated%2A>呼叫方法來引發<xref:System.Web.UI.WebControls.ObjectDataSource.Updated>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1095">After the <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> operation completes, the <xref:System.Web.UI.WebControls.ObjectDataSourceView.OnUpdated%2A> method is called to raise the <xref:System.Web.UI.WebControls.ObjectDataSource.Updated> event.</span></span> <span data-ttu-id="21d7d-1096">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.Updated>檢查任何傳回值、 輸出參數，以及例外狀況，以及執行的任何後續處理的事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1096">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Updated> event to examine any return values, output parameters, and exceptions, and to perform any post-processing.</span></span>  
  
 <span data-ttu-id="21d7d-1097"><xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>方法會委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.Update%2A>方法<xref:System.Web.UI.WebControls.ObjectDataSourceView>相關聯<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1097">The <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> method delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.Update%2A> method of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-1098">如需參數合併、 物件存留期，以及方法解析的詳細資訊，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1098">For more information about parameter merging, object lifetime, and method resolution, see <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-1099">您應該驗證您從用戶端接收任何參數值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1099">You should validate any parameter value that you receive from the client.</span></span> <span data-ttu-id="21d7d-1100">執行階段只會替代參數值到<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1100">The runtime simply substitutes the parameter value into the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property.</span></span>  
  
## <a name="data-bound-controls"></a><span data-ttu-id="21d7d-1101">資料繫結控制項</span><span class="sxs-lookup"><span data-stu-id="21d7d-1101">Data-Bound Controls</span></span>  
 <span data-ttu-id="21d7d-1102">當<xref:System.Web.UI.WebControls.ObjectDataSource>與相關聯控制項的資料繫結控制項，例如<xref:System.Web.UI.WebControls.GridView>控制項，不需要呼叫<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>從網頁程式碼的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1102">When the <xref:System.Web.UI.WebControls.ObjectDataSource> control is associated with a data-bound control, such as the <xref:System.Web.UI.WebControls.GridView> control, it is not necessary to call the <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> method from page code.</span></span> <span data-ttu-id="21d7d-1103"><xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>方法叫用資料繫結控制項來直接改為。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1103">The <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> method is invoked directly by the data-bound control instead.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-1104">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1104">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-1105">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.DropDownList>控制項，<xref:System.Web.UI.WebControls.TextBox>控制項，以及數個<xref:System.Web.UI.WebControls.ObjectDataSource>物件來更新資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1105">The first code example demonstrates how to use a <xref:System.Web.UI.WebControls.DropDownList> control, <xref:System.Web.UI.WebControls.TextBox> controls, and several <xref:System.Web.UI.WebControls.ObjectDataSource> objects to update data.</span></span> <span data-ttu-id="21d7d-1106">第二個程式碼範例顯示`EmployeeLogic`第一個程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1106">The second code example shows the `EmployeeLogic` class that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-1107">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.DropDownList>控制項，<xref:System.Web.UI.WebControls.TextBox>控制項，以及數個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項更新資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1107">The following code example demonstrates how to use a <xref:System.Web.UI.WebControls.DropDownList> control, <xref:System.Web.UI.WebControls.TextBox> controls, and several <xref:System.Web.UI.WebControls.ObjectDataSource> controls to update data.</span></span> <span data-ttu-id="21d7d-1108"><xref:System.Web.UI.WebControls.DropDownList>顯示 Northwind 員工的名稱時<xref:System.Web.UI.WebControls.TextBox>控制項可用來輸入和更新位址資訊。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1108">The <xref:System.Web.UI.WebControls.DropDownList> displays the name of a Northwind employee, while the <xref:System.Web.UI.WebControls.TextBox> controls are used to enter and update address information.</span></span> <span data-ttu-id="21d7d-1109">因為<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>集合包含<xref:System.Web.UI.WebControls.ControlParameter>物件繫結至選取的值<xref:System.Web.UI.WebControls.DropDownList>，引發按鈕<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>員工選取之後，才啟用作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1109">Because the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection contains a <xref:System.Web.UI.WebControls.ControlParameter> object that is bound to the selected value of the <xref:System.Web.UI.WebControls.DropDownList>, the button that raises the <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> operation is enabled only after an employee is selected.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-1110">這個範例有一個可接受使用者輸入的文字方塊，這可能會造成安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1110">This example has a text box that accepts user input, which is a potential security threat.</span></span> <span data-ttu-id="21d7d-1111">根據預設，ASP.NET Web 網頁會驗證使用者輸入未包含指令碼或 HTML 項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1111">By default, ASP.NET Web pages validate that user input does not include script or HTML elements.</span></span> <span data-ttu-id="21d7d-1112">如需詳細資訊，請參閱 [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07) (指令碼攻擊概觀)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1112">For more information, see [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07).</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_12#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_12/CS/objds12cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_12#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_12/VB/objds12vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-1113">下列程式碼範例示範`EmployeeLogic`上述程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1113">The following code example shows the `EmployeeLogic` class that is used in the preceding code example.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_12#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_12/CS/northwindemployee12.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_12#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_12/VB/northwindemployee12.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters" />
      </Docs>
    </Member>
    <Member MemberName="Updated">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler Updated;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler Updated" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.Updated" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event Updated As ObjectDataSourceStatusEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceStatusEventHandler ^ Updated;" />
      <MemberSignature Language="F#" Value="member this.Updated : System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler " Usage="member this.Updated : System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceStatusEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-1114">發生於 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" /> 作業已經完成時。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1114">Occurs when an <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" /> operation has completed.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-1115">處理<xref:System.Web.UI.WebControls.ObjectDataSource.Updated>事件來檢查傳回值或輸出參數的值，或是判斷是否發生例外狀況之後<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>作業已完成。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1115">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Updated> event to examine the values of a return value or output parameters, or to determine whether an exception was thrown after an <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> operation has completed.</span></span> <span data-ttu-id="21d7d-1116">傳回值，輸出參數和例外狀況處理屬性都是從<xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs>與事件相關聯的物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1116">The return value, output parameters, and exception handling properties are available from the <xref:System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs> object that is associated with the event.</span></span>  
  
 <span data-ttu-id="21d7d-1117">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1117">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.Updating" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSourceView.OnUpdated(System.Web.UI.WebControls.ObjectDataSourceStatusEventArgs)" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters" />
      </Docs>
    </Member>
    <Member MemberName="UpdateMethod">
      <MemberSignature Language="C#" Value="public string UpdateMethod { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string UpdateMethod" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod" />
      <MemberSignature Language="VB.NET" Value="Public Property UpdateMethod As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ UpdateMethod { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.UpdateMethod : string with get, set" Usage="System.Web.UI.WebControls.ObjectDataSource.UpdateMethod" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-1118">取得或設定 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 控制項叫用以更新資料之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1118">Gets or sets the name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> control invokes to update data.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-1119">字串，表示 <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> 用於更新資料之方法或函式的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1119">A string that represents the name of the method or function that the <see cref="T:System.Web.UI.WebControls.ObjectDataSource" /> uses to update data.</span>
          </span>
          <span data-ttu-id="21d7d-1120">預設為空字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1120">The default is an empty string.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-1121"><xref:System.Web.UI.WebControls.ObjectDataSource>控制項假設的方法，由<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性會執行更新一次，而不是批次中。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1121">The <xref:System.Web.UI.WebControls.ObjectDataSource> control assumes that the method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property performs updates one at a time, rather than in a batch.</span></span>  
  
 <span data-ttu-id="21d7d-1122"><xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性委派給<xref:System.Web.UI.WebControls.ObjectDataSourceView.UpdateMethod%2A>屬性<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1122">The <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property delegates to the <xref:System.Web.UI.WebControls.ObjectDataSourceView.UpdateMethod%2A> property of the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-1123">請確定參數名稱設定為<xref:System.Web.UI.WebControls.ObjectDataSource>控制<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>集合符合 select 方法所傳回的資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1123">Make sure that the parameter names configured for the <xref:System.Web.UI.WebControls.ObjectDataSource> control in the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection match the column names that are returned by the select method.</span></span>  
  
## <a name="object-lifetime"></a><span data-ttu-id="21d7d-1124">物件存留期</span><span class="sxs-lookup"><span data-stu-id="21d7d-1124">Object Lifetime</span></span>  
 <span data-ttu-id="21d7d-1125">所識別的方法<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性可以是執行個體方法或`static`(`Shared`在 Visual Basic 中) 方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1125">The method that is identified by the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property can be an instance method or a `static` (`Shared` in Visual Basic) method.</span></span> <span data-ttu-id="21d7d-1126">如果是執行個體方法，商務物件會建立，並且由所指定的方法終結每次<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1126">If it is an instance method, the business object is created and destroyed each time the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-1127">您可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>事件，以使用商務物件由所指定的方法之前<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1127">You can handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated> and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating> events to work with the business object before the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-1128">您也可以處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>所指定的方法之後，就會引發的事件<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>呼叫屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1128">You can also handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> event that is raised after the method that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property is called.</span></span> <span data-ttu-id="21d7d-1129">如果實作的商務物件<xref:System.IDisposable>介面，<xref:System.IDisposable.Dispose%2A>方法會終結物件之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1129">If the business object implements the <xref:System.IDisposable> interface, the <xref:System.IDisposable.Dispose%2A> method is called before the object is destroyed.</span></span> <span data-ttu-id="21d7d-1130">如果該方法是`static`(`Shared`在 Visual Basic 中)，不會建立商務物件，而且您無法處理<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>， <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>，和<xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1130">If the method is `static` (`Shared` in Visual Basic), the business object is never created and you cannot handle the <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreated>, <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectCreating>, and <xref:System.Web.UI.WebControls.ObjectDataSource.ObjectDisposing> events.</span></span>  
  
## <a name="parameter-merging"></a><span data-ttu-id="21d7d-1131">合併的參數</span><span class="sxs-lookup"><span data-stu-id="21d7d-1131">Parameter Merging</span></span>  
 <span data-ttu-id="21d7d-1132">若要加入參數<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>三個來源的集合：</span><span class="sxs-lookup"><span data-stu-id="21d7d-1132">Parameters are added to the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection from three sources:</span></span>  
  
-   <span data-ttu-id="21d7d-1133">從資料繫結控制項，在執行階段。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1133">From the data-bound control, at run time.</span></span>  
  
-   <span data-ttu-id="21d7d-1134">從`UpdateParameters`項目，以宣告方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1134">From the `UpdateParameters` element, declaratively.</span></span>  
  
-   <span data-ttu-id="21d7d-1135">從<xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件處理常式，以程式設計的方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1135">From the <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> event handler, programmatically.</span></span>  
  
 <span data-ttu-id="21d7d-1136">首先，將資料繫結控制項所產生的任何參數加入至<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1136">First, any parameters that are generated from data-bound controls are added to the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection.</span></span> <span data-ttu-id="21d7d-1137">例如，如果<xref:System.Web.UI.WebControls.ObjectDataSource>控制項繫結至<xref:System.Web.UI.WebControls.GridView>具有資料行的控制`Name`和`Number`，參數`Name`和`Number`加入至集合。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1137">For example, if the <xref:System.Web.UI.WebControls.ObjectDataSource> control is bound to a <xref:System.Web.UI.WebControls.GridView> control that has the columns `Name` and `Number`, the parameters for `Name` and `Number` are added to the collection.</span></span> <span data-ttu-id="21d7d-1138">完整名稱的參數取決於<xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1138">The exact name of the parameter depends on the <xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A> property.</span></span> <span data-ttu-id="21d7d-1139">這些參數的資料類型是`string`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1139">The data type of these parameters is `string`.</span></span> <span data-ttu-id="21d7d-1140">下一步，參數中所列`UpdateParameters`加入項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1140">Next, the parameters that are listed in the `UpdateParameters` element are added.</span></span> <span data-ttu-id="21d7d-1141">如果中的參數`UpdateParameters`找到項目具有相同名稱做為參數已經在<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>修改集合，現有的參數符合參數中指定`UpdateParameters`項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1141">If a parameter in the `UpdateParameters` element is found with the same name as a parameter that is already in the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection, the existing parameter is modified to match the parameter that is specified in the `UpdateParameters` element.</span></span> <span data-ttu-id="21d7d-1142">一般而言，這用來修改參數中的資料類型。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1142">Typically, this is used to modify the type of the data in the parameter.</span></span> <span data-ttu-id="21d7d-1143">最後，您可以透過程式設計方式加入和移除參數中的<xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件之前發生<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>方法執行。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1143">Finally, you can programmatically add and remove parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> event, which occurs before the <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> method is run.</span></span> <span data-ttu-id="21d7d-1144">會合併這些參數之後，就會解決方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1144">The method is resolved after the parameters are merged.</span></span> <span data-ttu-id="21d7d-1145">在下一節討論方法解析。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1145">Method resolution is discussed in the next section.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-1146">您應該驗證您從用戶端接收任何參數值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1146">You should validate any parameter value that you receive from the client.</span></span> <span data-ttu-id="21d7d-1147">執行階段只會替代參數值到<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1147">The runtime simply substitutes the parameter value into the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property.</span></span>  
  
## <a name="method-resolution"></a><span data-ttu-id="21d7d-1148">方法解析</span><span class="sxs-lookup"><span data-stu-id="21d7d-1148">Method Resolution</span></span>  
 <span data-ttu-id="21d7d-1149">當<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>呼叫方法時，資料繫結控制項，以宣告方式中所建立的參數的資料欄位`UpdateParameters`項目，並已加入的參數<xref:System.Web.UI.WebControls.ObjectDataSource.Updating>所有合併事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1149">When the <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> method is called, the data fields from the data-bound control, the parameters that were created declaratively in the `UpdateParameters` element, and the parameters that were added in the <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> event handler are all merged.</span></span> <span data-ttu-id="21d7d-1150">（如需詳細資訊，請參閱上一節）。<xref:System.Web.UI.WebControls.ObjectDataSource>控制然後嘗試尋找要呼叫的方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1150">(For more information, see the preceding section.) The <xref:System.Web.UI.WebControls.ObjectDataSource> control then attempts to find a method to call.</span></span> <span data-ttu-id="21d7d-1151">首先，它會尋找名稱中指定的一或多個方法<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1151">First, it looks for one or more methods with the name that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property.</span></span> <span data-ttu-id="21d7d-1152">如果找到相符項目，<xref:System.InvalidOperationException>擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1152">If no match is found, an <xref:System.InvalidOperationException> exception is thrown.</span></span> <span data-ttu-id="21d7d-1153">如果找到相符項目，則會尋找相符的參數名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1153">If a match is found, it then looks for matching parameter names.</span></span> <span data-ttu-id="21d7d-1154">例如，假設由所指定的型別<xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A>屬性有兩個方法，名為`UpdateARecord`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1154">For example, suppose a type that is specified by the <xref:System.Web.UI.WebControls.ObjectDataSource.TypeName%2A> property has two methods named `UpdateARecord`.</span></span> <span data-ttu-id="21d7d-1155">一個`UpdateARecord`具有一個參數， `ID`，和其他`UpdateARecord`有兩個參數，`Name`和`Number`。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1155">One `UpdateARecord` has one parameter, `ID`, and the other `UpdateARecord` has two parameters, `Name` and `Number`.</span></span> <span data-ttu-id="21d7d-1156">如果<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>集合具有名為只有一個參數`ID`、`UpdateARecord`方法只`ID`參數呼叫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1156">If the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection has only one parameter named `ID`, the `UpdateARecord` method with just the `ID` parameter is called.</span></span> <span data-ttu-id="21d7d-1157">參數的型別不會檢查在解析方法。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1157">The type of the parameter is not checked in resolving the methods.</span></span> <span data-ttu-id="21d7d-1158">參數的順序不重要。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1158">The order of the parameters does not matter.</span></span>  
  
 <span data-ttu-id="21d7d-1159">如果<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性設定，方法解決了不同的方式。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1159">If the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property is set, the method is resolved in a different way.</span></span> <span data-ttu-id="21d7d-1160"><xref:System.Web.UI.WebControls.ObjectDataSource>中指定名稱的方法會尋找<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>採用一個參數類型的屬性中指定<xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1160">The <xref:System.Web.UI.WebControls.ObjectDataSource> looks for a method with the name that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property that takes one parameter of the type that is specified in the <xref:System.Web.UI.WebControls.ObjectDataSource.DataObjectTypeName%2A> property.</span></span> <span data-ttu-id="21d7d-1161">在此情況下，參數的名稱並不重要。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1161">In this case, the name of the parameter does not matter.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-1162">下列三個範例顯示 Web 網頁、 程式碼後置頁面類別和資料存取類別，可讓使用者擷取並更新 Northwind 資料庫中的 [員工] 資料表中的記錄。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1162">The following three examples show a Web page, a code-behind page class, and a data-access class that enable a user to retrieve and update records in the Employees table in the Northwind database.</span></span>  
  
 <span data-ttu-id="21d7d-1163">第一個範例顯示包含兩個的 Web 網頁<xref:System.Web.UI.WebControls.ObjectDataSource>控制項<xref:System.Web.UI.WebControls.DropDownList>控制項和<xref:System.Web.UI.WebControls.DetailsView>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1163">The first example shows a Web page that contains two <xref:System.Web.UI.WebControls.ObjectDataSource> controls, a <xref:System.Web.UI.WebControls.DropDownList> control, and a <xref:System.Web.UI.WebControls.DetailsView> control.</span></span> <span data-ttu-id="21d7d-1164">第一個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和<xref:System.Web.UI.WebControls.DropDownList>控制項用來擷取並顯示資料庫中的員工名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1164">The first <xref:System.Web.UI.WebControls.ObjectDataSource> control and the <xref:System.Web.UI.WebControls.DropDownList> control are used to retrieve and display employee names from the database.</span></span> <span data-ttu-id="21d7d-1165">第二個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和<xref:System.Web.UI.WebControls.DetailsView>控制項用來擷取、 顯示和修改所選取的使用者的員工記錄的資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1165">The second <xref:System.Web.UI.WebControls.ObjectDataSource> control and the <xref:System.Web.UI.WebControls.DetailsView> control are used to retrieve, display, and modify the data from the employee record that is selected by the user.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_18#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/Default.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_18#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/Default.aspx#1)]  
  
 <span data-ttu-id="21d7d-1166">第二個範例示範處理常式<xref:System.Web.UI.WebControls.ObjectDataSource.Selected>和<xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1166">The second example shows handlers for the <xref:System.Web.UI.WebControls.ObjectDataSource.Selected> and <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> events.</span></span> <span data-ttu-id="21d7d-1167"><xref:System.Web.UI.WebControls.ObjectDataSource.Selected>事件處理常式會序列化物件，包含從 Employee 資料表中擷取的資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1167">The <xref:System.Web.UI.WebControls.ObjectDataSource.Selected> event handler serializes the object that contains data that was retrieved from the Employee table.</span></span> <span data-ttu-id="21d7d-1168">已序列化的物件會儲存在檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1168">The serialized object is stored in view state.</span></span> <span data-ttu-id="21d7d-1169"><xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件處理常式會還原序列化的物件包含正在更新的資料記錄的原始資料的檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1169">The <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> event handler deserializes the object in view state that contains the original data for the data record that is being updated.</span></span> <span data-ttu-id="21d7d-1170">Update 方法，包含原始資料的物件會傳遞做為參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1170">The object that contains the original data is passed as a parameter to the Update method.</span></span> <span data-ttu-id="21d7d-1171">原始的資料必須傳遞至資料庫，使它可以用來檢查是否已由其他處理序修改資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1171">The original data must be passed to the database so that it can be used to check whether the data has been modified by another process.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_18#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/Default.aspx.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_18#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/Default.aspx.vb#2)]  
  
 <span data-ttu-id="21d7d-1172">第三個範例會顯示與 Northwind 資料庫互動的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1172">The third example shows the data access class that interacts with the Northwind database.</span></span> <span data-ttu-id="21d7d-1173">類別會使用 LINQ 查詢並更新 [員工] 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1173">The class uses LINQ to query and update the Employees table.</span></span> <span data-ttu-id="21d7d-1174">這個範例需要 LINQ to SQL 類別代表 Northwind 資料庫與 Employees 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1174">The example requires a LINQ to SQL class that represents the Northwind database and Employees table.</span></span> <span data-ttu-id="21d7d-1175">如需詳細資訊，請參閱[How to： 建立 LINQ to SQL 類別，在 Web 專案](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1175">For more information, see [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_18#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/App_Code/EmployeeLogic.cs#5)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_18#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/App_Code/EmployeeLogic.vb#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" />
      </Docs>
    </Member>
    <Member MemberName="UpdateParameters">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.ParameterCollection UpdateParameters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.ParameterCollection UpdateParameters" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property UpdateParameters As ParameterCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::ParameterCollection ^ UpdateParameters { System::Web::UI::WebControls::ParameterCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.UpdateParameters : System.Web.UI.WebControls.ParameterCollection" Usage="System.Web.UI.WebControls.ObjectDataSource.UpdateParameters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("System.Web.UI.Design.WebControls.ParameterCollectionEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", typeof(System.Drawing.Design.UITypeEditor))</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.MergableProperty(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Web.UI.PersistenceMode(System.Web.UI.PersistenceMode.InnerProperty)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ParameterCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-1176">取得參數集合，包含 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod" /> 屬性指定之方法所使用的參數。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1176">Gets the parameters collection that contains the parameters that are used by the method that is specified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod" /> property.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="21d7d-1177">
            <see cref="T:System.Web.UI.WebControls.ParameterCollection" />，包含由 <see cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod" /> 屬性指定之方法所使用的參數。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1177">A <see cref="T:System.Web.UI.WebControls.ParameterCollection" /> that contains the parameters used by the method that is specified by the <see cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod" /> property.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-1178">名稱和參數中所包含的型別<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>集合的名稱和型別中的參數，必須符合<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>方法簽章。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1178">The names and types of the parameters that are contained in the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection must match the names and types of the parameters in the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> method signature.</span></span> <span data-ttu-id="21d7d-1179">參數名稱會受到<xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A>屬性而且有區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1179">The parameter names are affected by the <xref:System.Web.UI.WebControls.ObjectDataSource.OldValuesParameterFormatString%2A> property and are case-sensitive.</span></span> <span data-ttu-id="21d7d-1180">集合中的參數取決於資料繫結控制項，以宣告方式，指定的參數和以程式設計方式加入的參數中的資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1180">The parameters in the collection depend on the data in the data-bound control, the parameters that are specified declaratively, and the parameters that are added programmatically.</span></span> <span data-ttu-id="21d7d-1181">如需詳細資訊，請參閱中的 「 合併參數 」 一節<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>和[ObjectDataSource 控制項配合使用參數](http://msdn.microsoft.com/library/45fb67ee-9be7-49b7-9421-e242203dafa4)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1181">For more information, see the "Parameter Merging" section in <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> and [Using Parameters with the ObjectDataSource Control](http://msdn.microsoft.com/library/45fb67ee-9be7-49b7-9421-e242203dafa4).</span></span>  
  
 <span data-ttu-id="21d7d-1182"><xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>屬性擷取<xref:System.Web.UI.WebControls.ObjectDataSourceView.UpdateParameters%2A>屬性所包含的<xref:System.Web.UI.WebControls.ObjectDataSourceView>與其相關聯物件<xref:System.Web.UI.WebControls.ObjectDataSource>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1182">The <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> property retrieves the <xref:System.Web.UI.WebControls.ObjectDataSourceView.UpdateParameters%2A> property that is contained by the <xref:System.Web.UI.WebControls.ObjectDataSourceView> object that is associated with the <xref:System.Web.UI.WebControls.ObjectDataSource> control.</span></span>  
  
 <span data-ttu-id="21d7d-1183">如需參數合併、 物件存留期，以及方法解析的詳細資訊，請參閱<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1183">For more information about parameter merging, object lifetime, and method resolution, see <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-1184">您應該驗證您從用戶端接收任何參數值。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1184">You should validate any parameter value that you receive from the client.</span></span> <span data-ttu-id="21d7d-1185">執行階段只會替代參數值到<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1185">The runtime simply substitutes the parameter value into the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-1186">本節包含兩個程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1186">This section contains two code examples.</span></span> <span data-ttu-id="21d7d-1187">第一個程式碼範例示範如何使用<xref:System.Web.UI.WebControls.DropDownList>控制項，<xref:System.Web.UI.WebControls.TextBox>控制項，以及數個<xref:System.Web.UI.WebControls.ObjectDataSource>物件來更新資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1187">The first code example demonstrates how to use a <xref:System.Web.UI.WebControls.DropDownList> control, <xref:System.Web.UI.WebControls.TextBox> controls, and several <xref:System.Web.UI.WebControls.ObjectDataSource> objects to update data.</span></span> <span data-ttu-id="21d7d-1188">第二個程式碼範例顯示`EmployeeLogic`第一個程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1188">The second code example shows the `EmployeeLogic` class that is used in the first code example.</span></span>  
  
 <span data-ttu-id="21d7d-1189">下列程式碼範例示範如何使用<xref:System.Web.UI.WebControls.DropDownList>控制項，<xref:System.Web.UI.WebControls.TextBox>控制項，以及數個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項更新資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1189">The following code example demonstrates how to use a <xref:System.Web.UI.WebControls.DropDownList> control, <xref:System.Web.UI.WebControls.TextBox> controls, and several <xref:System.Web.UI.WebControls.ObjectDataSource> controls to update data.</span></span> <span data-ttu-id="21d7d-1190"><xref:System.Web.UI.WebControls.DropDownList>顯示 Northwind 員工的名稱時<xref:System.Web.UI.WebControls.TextBox>控制項可用來輸入和更新位址資訊。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1190">The <xref:System.Web.UI.WebControls.DropDownList> displays the name of a Northwind employee, while the <xref:System.Web.UI.WebControls.TextBox> controls are used to enter and update address information.</span></span> <span data-ttu-id="21d7d-1191">因為<xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A>集合包含<xref:System.Web.UI.WebControls.ControlParameter>繫結到選取的值的<xref:System.Web.UI.WebControls.DropDownList>，引發按鈕<xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A>員工選取之後，才啟用作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1191">Because the <xref:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters%2A> collection contains a <xref:System.Web.UI.WebControls.ControlParameter> that is bound to the selected value of the <xref:System.Web.UI.WebControls.DropDownList>, the button that raises the <xref:System.Web.UI.WebControls.ObjectDataSource.Update%2A> operation is enabled only after an employee is selected.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="21d7d-1192">這個範例有一個可接受使用者輸入的文字方塊，這可能會造成安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1192">This example has a text box that accepts user input, which is a potential security threat.</span></span> <span data-ttu-id="21d7d-1193">根據預設，ASP.NET Web 網頁會驗證使用者輸入未包含指令碼或 HTML 項目。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1193">By default, ASP.NET Web pages validate that user input does not include script or HTML elements.</span></span> <span data-ttu-id="21d7d-1194">如需詳細資訊，請參閱 [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07) (指令碼攻擊概觀)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1194">For more information, see [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07).</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_12#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_12/CS/objds12cs.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_12#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_12/VB/objds12vb.aspx#1)]  
  
 <span data-ttu-id="21d7d-1195">下列程式碼範例示範`EmployeeLogic`上述程式碼範例中使用的類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1195">The following code example shows the `EmployeeLogic` class that is used in the preceding code example.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_12#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_12/CS/northwindemployee12.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_12#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_12/VB/northwindemployee12.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateMethod" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" />
      </Docs>
    </Member>
    <Member MemberName="Updating">
      <MemberSignature Language="C#" Value="public event System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler Updating;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler Updating" />
      <MemberSignature Language="DocId" Value="E:System.Web.UI.WebControls.ObjectDataSource.Updating" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event Updating As ObjectDataSourceMethodEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Web::UI::WebControls::ObjectDataSourceMethodEventHandler ^ Updating;" />
      <MemberSignature Language="F#" Value="member this.Updating : System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler " Usage="member this.Updating : System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.ObjectDataSourceMethodEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="21d7d-1196">在 <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" /> 作業之前發生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="21d7d-1196">Occurs before an <see cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" /> operation.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21d7d-1197">處理<xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件以執行特定應用程式，來驗證參數的值，或變更之前的參數值的其他初始化<xref:System.Web.UI.WebControls.ObjectDataSource>控制項執行更新作業。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1197">Handle the <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> event to perform additional initialization that is specific to your application, to validate the values of parameters, or to change the parameter values before the <xref:System.Web.UI.WebControls.ObjectDataSource> control performs the update operation.</span></span> <span data-ttu-id="21d7d-1198">參數是可做為<xref:System.Collections.IDictionary>所存取的集合<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A>屬性，由<xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs>物件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1198">The parameters are available as an <xref:System.Collections.IDictionary> collection that is accessed by the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs.InputParameters%2A> property, which is exposed by the <xref:System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs> object.</span></span>  
  
 <span data-ttu-id="21d7d-1199">如需處理事件的詳細資訊，請參閱[NIB： 使用事件](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1199">For more information about handling events, see [NIB: Consuming Events](http://msdn.microsoft.com/library/01e4f1bc-e55e-413f-98c7-6588493e5f67).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21d7d-1200">下列三個範例顯示 Web 網頁、 程式碼後置頁面類別和資料存取類別，可讓使用者擷取並更新 Northwind 資料庫中的 [員工] 資料表中的記錄。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1200">The following three examples show a Web page, a code-behind page class, and a data-access class that enable a user to retrieve and update records in the Employees table in the Northwind database.</span></span>  
  
 <span data-ttu-id="21d7d-1201">第一個範例顯示包含兩個的 Web 網頁<xref:System.Web.UI.WebControls.ObjectDataSource>控制項<xref:System.Web.UI.WebControls.DropDownList>控制項和<xref:System.Web.UI.WebControls.DetailsView>控制項。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1201">The first example shows a Web page that contains two <xref:System.Web.UI.WebControls.ObjectDataSource> controls, a <xref:System.Web.UI.WebControls.DropDownList> control, and a <xref:System.Web.UI.WebControls.DetailsView> control.</span></span> <span data-ttu-id="21d7d-1202">第一個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和<xref:System.Web.UI.WebControls.DropDownList>控制項用來擷取並顯示資料庫中的員工名稱。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1202">The first <xref:System.Web.UI.WebControls.ObjectDataSource> control and the <xref:System.Web.UI.WebControls.DropDownList> control are used to retrieve and display employee names from the database.</span></span> <span data-ttu-id="21d7d-1203">第二個<xref:System.Web.UI.WebControls.ObjectDataSource>控制項和<xref:System.Web.UI.WebControls.DetailsView>控制項用來擷取、 顯示和修改所選取的使用者的員工記錄的資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1203">The second <xref:System.Web.UI.WebControls.ObjectDataSource> control and the <xref:System.Web.UI.WebControls.DetailsView> control are used to retrieve, display, and modify the data from the employee record that is selected by the user.</span></span>  
  
 [!code-aspx-csharp[System.Web.UI.WebControls.ObjectDataSource_18#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/Default.aspx#1)]
 [!code-aspx-vb[System.Web.UI.WebControls.ObjectDataSource_18#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/Default.aspx#1)]  
  
 <span data-ttu-id="21d7d-1204">第二個範例示範處理常式<xref:System.Web.UI.WebControls.ObjectDataSource.Selected>和<xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1204">The second example shows handlers for the <xref:System.Web.UI.WebControls.ObjectDataSource.Selected> and <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> events.</span></span> <span data-ttu-id="21d7d-1205"><xref:System.Web.UI.WebControls.ObjectDataSource.Selected>事件處理常式會序列化物件，包含從 Employee 資料表中擷取的資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1205">The <xref:System.Web.UI.WebControls.ObjectDataSource.Selected> event handler serializes the object that contains data that was retrieved from the Employee table.</span></span> <span data-ttu-id="21d7d-1206">已序列化的物件會儲存在檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1206">The serialized object is stored in view state.</span></span> <span data-ttu-id="21d7d-1207"><xref:System.Web.UI.WebControls.ObjectDataSource.Updating>事件處理常式會還原序列化的物件包含正在更新的資料記錄的原始資料的檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1207">The <xref:System.Web.UI.WebControls.ObjectDataSource.Updating> event handler deserializes the object in view state that contains the original data for the data record that is being updated.</span></span> <span data-ttu-id="21d7d-1208">Update 方法，包含原始資料的物件會傳遞做為參數。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1208">The object that contains the original data is passed as a parameter to the Update method.</span></span> <span data-ttu-id="21d7d-1209">原始的資料必須傳遞至資料庫，使它可以用來檢查是否已由其他處理序修改資料。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1209">The original data must be passed to the database so that it can be used to check whether the data has been modified by another process.</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_18#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/Default.aspx.cs#2)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_18#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/Default.aspx.vb#2)]  
  
 <span data-ttu-id="21d7d-1210">第三個範例會顯示與 Northwind 資料庫互動的資料存取類別。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1210">The third example shows the data access class that interacts with the Northwind database.</span></span> <span data-ttu-id="21d7d-1211">類別會使用 LINQ 查詢並更新 [員工] 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1211">The class uses LINQ to query and update the Employees table.</span></span> <span data-ttu-id="21d7d-1212">這個範例需要 LINQ to SQL 類別代表 Northwind 資料庫與 Employees 資料表。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1212">The example requires a LINQ to SQL class that represents the Northwind database and Employees table.</span></span> <span data-ttu-id="21d7d-1213">如需詳細資訊，請參閱[How to： 建立 LINQ to SQL 類別，在 Web 專案](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081)。</span><span class="sxs-lookup"><span data-stu-id="21d7d-1213">For more information, see [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/library/20bf925f-2a6d-410d-8f65-7b5b8f555081).</span></span>  
  
 [!code-csharp[System.Web.UI.WebControls.ObjectDataSource_18#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/CS/App_Code/EmployeeLogic.cs#5)]
 [!code-vb[System.Web.UI.WebControls.ObjectDataSource_18#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.UI.WebControls.ObjectDataSource_18/VB/App_Code/EmployeeLogic.vb#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Web.UI.WebControls.ObjectDataSource.Updated" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSourceView.OnUpdating(System.Web.UI.WebControls.ObjectDataSourceMethodEventArgs)" />
        <altmember cref="M:System.Web.UI.WebControls.ObjectDataSource.Update" />
        <altmember cref="P:System.Web.UI.WebControls.ObjectDataSource.UpdateParameters" />
      </Docs>
    </Member>
  </Members>
</Type>