<Type Name="IMessageSink" FullName="System.Runtime.Remoting.Messaging.IMessageSink">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="1dd3980c6db096c63bf5a16dc14529fdeaebe51c" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36631070" />
  </Metadata>
  <TypeSignature Language="C#" Value="public interface IMessageSink" />
  <TypeSignature Language="ILAsm" Value=".class public interface auto ansi abstract IMessageSink" />
  <TypeSignature Language="DocId" Value="T:System.Runtime.Remoting.Messaging.IMessageSink" />
  <TypeSignature Language="VB.NET" Value="Public Interface IMessageSink" />
  <TypeSignature Language="C++ CLI" Value="public interface class IMessageSink" />
  <TypeSignature Language="F#" Value="type IMessageSink = interface" />
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.Runtime.InteropServices.ComVisible(true)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="0a70f-101">定義訊息接收的介面。</span>
      <span class="sxs-lookup">
        <span data-stu-id="0a70f-101">Defines the interface for a message sink.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0a70f-102">在 proxy 上方法呼叫時，遠端執行功能基礎結構提供必要的支援跨越遠端界限時，將引數傳遞至實際物件、 呼叫實際物件方法，以引數和傳回的結果回proxy 物件的用戶端。</span><span class="sxs-lookup"><span data-stu-id="0a70f-102">When a method call is made on the proxy, the remoting infrastructure provides the necessary support for passing the arguments to the actual object across the remoting boundaries, calling the actual object method with the arguments, and returning the results back to the client of the proxy object.</span></span>  
  
 <span data-ttu-id="0a70f-103">遠端方法呼叫是從用戶端到伺服器端的訊息，而且可能再次返回。</span><span class="sxs-lookup"><span data-stu-id="0a70f-103">A remote method call is a message that goes from the client end to the server end and possibly back again.</span></span> <span data-ttu-id="0a70f-104">遠端方法呼叫的方式跨遠端界限，通過一連串`IMessageSink`物件。</span><span class="sxs-lookup"><span data-stu-id="0a70f-104">As it crosses remoting boundaries on the way, the remote method call passes through a chain of `IMessageSink` objects.</span></span> <span data-ttu-id="0a70f-105">鏈結中的每個接收接收訊息物件、 執行特定作業，並委派至鏈結中的下一個接收。</span><span class="sxs-lookup"><span data-stu-id="0a70f-105">Each sink in the chain receives the message object, performs a specific operation, and delegates to the next sink in the chain.</span></span> <span data-ttu-id="0a70f-106">Proxy 物件包含第一個參考`IMessageSink`它需要使用啟動關閉的鏈結。</span><span class="sxs-lookup"><span data-stu-id="0a70f-106">The proxy object contains a reference to the first `IMessageSink` it needs to use to start off the chain.</span></span>  
  
 <span data-ttu-id="0a70f-107">非同步呼叫，委派，在每個接收提供回覆接收 (另一個`IMessageSink`)，會先呼叫下一個接收回覆時途中回。</span><span class="sxs-lookup"><span data-stu-id="0a70f-107">For asynchronous calls, at the time of delegation, each sink provides a reply sink (another `IMessageSink`) that will be called by the next sink when the reply is on its way back.</span></span>  
  
 <span data-ttu-id="0a70f-108">不同類型的接收執行不同的作業，根據收到的訊息物件的類型。</span><span class="sxs-lookup"><span data-stu-id="0a70f-108">Different types of sinks perform different operations, depending on the type of message object received.</span></span> <span data-ttu-id="0a70f-109">比方說，一個接收可能會導致要採取的鎖定，另一個無法強制執行呼叫安全性、 另一個可能會執行資料流程呼叫控制項和可靠性服務，以及另一個可能尚未會傳輸到不同的呼叫<xref:System.AppDomain>，處理程序或電腦。</span><span class="sxs-lookup"><span data-stu-id="0a70f-109">For example, one sink could cause a lock to be taken, another could enforce call security, another could perform flow call control and reliability services, and yet another could transport the call to a different <xref:System.AppDomain>, process, or computer.</span></span> <span data-ttu-id="0a70f-110">鏈結中的兩個或多個訊息接收可以與彼此互動，對每個特定的動作。</span><span class="sxs-lookup"><span data-stu-id="0a70f-110">Two or more message sinks in the chain can interact with each other in regard to each specific action.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="0a70f-111">下列程式碼範例顯示的實作<xref:System.Runtime.Remoting.Messaging.IMessageSink>介面。</span><span class="sxs-lookup"><span data-stu-id="0a70f-111">The following code example shows the implementation of the <xref:System.Runtime.Remoting.Messaging.IMessageSink> interface.</span></span> <span data-ttu-id="0a70f-112">請注意此範例假設類型定義和組件參考，您必須提供要編譯範例。</span><span class="sxs-lookup"><span data-stu-id="0a70f-112">Note that the sample assumes type definitions and assembly references that must be provided for the sample to compile.</span></span>  
  
 [!code-cpp[IMessageSink_Client#3](~/samples/snippets/cpp/VS_Snippets_Remoting/IMessageSink_Client/CPP/imessagesink_client.cpp#3)]
 [!code-csharp[IMessageSink_Client#3](~/samples/snippets/csharp/VS_Snippets_Remoting/IMessageSink_Client/CS/imessagesink_client.cs#3)]
 [!code-vb[IMessageSink_Client#3](~/samples/snippets/visualbasic/VS_Snippets_Remoting/IMessageSink_Client/VB/imessagesink_client.vb#3)]  
  
 ]]></format>
    </remarks>
    <block subset="none" type="overrides">
      <span data-ttu-id="0a70f-113">
        <para>它是很重要的一點，對目前介面的實作程式碼必須提供兩個實作<see cref="M:System.Runtime.Remoting.Messaging.IMessageSink.SyncProcessMessage(System.Runtime.Remoting.Messaging.IMessage)" />和<see cref="M:System.Runtime.Remoting.Messaging.IMessageSink.AsyncProcessMessage(System.Runtime.Remoting.Messaging.IMessage,System.Runtime.Remoting.Messaging.IMessageSink)" />，因為同步呼叫可以轉換為非同步呼叫，反之亦然。必須實作這兩種方法，即使接收不支援非同步處理。</para>
      </span>
      <span class="sxs-lookup">
        <span data-stu-id="0a70f-113">
          <para>It is important to note that code implementing the current interface must provide implementations for both <see cref="M:System.Runtime.Remoting.Messaging.IMessageSink.SyncProcessMessage(System.Runtime.Remoting.Messaging.IMessage)" /> and <see cref="M:System.Runtime.Remoting.Messaging.IMessageSink.AsyncProcessMessage(System.Runtime.Remoting.Messaging.IMessage,System.Runtime.Remoting.Messaging.IMessageSink)" />, since synchronous calls can be converted to asynchronous calls and vice versa. Both methods must be implemented, even if the sink does not support asynchronous processing.</para>
        </span>
      </span>
    </block>
  </Docs>
  <Members>
    <Member MemberName="AsyncProcessMessage">
      <MemberSignature Language="C#" Value="public System.Runtime.Remoting.Messaging.IMessageCtrl AsyncProcessMessage (System.Runtime.Remoting.Messaging.IMessage msg, System.Runtime.Remoting.Messaging.IMessageSink replySink);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Runtime.Remoting.Messaging.IMessageCtrl AsyncProcessMessage(class System.Runtime.Remoting.Messaging.IMessage msg, class System.Runtime.Remoting.Messaging.IMessageSink replySink) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Runtime.Remoting.Messaging.IMessageSink.AsyncProcessMessage(System.Runtime.Remoting.Messaging.IMessage,System.Runtime.Remoting.Messaging.IMessageSink)" />
      <MemberSignature Language="VB.NET" Value="Public Function AsyncProcessMessage (msg As IMessage, replySink As IMessageSink) As IMessageCtrl" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Runtime::Remoting::Messaging::IMessageCtrl ^ AsyncProcessMessage(System::Runtime::Remoting::Messaging::IMessage ^ msg, System::Runtime::Remoting::Messaging::IMessageSink ^ replySink);" />
      <MemberSignature Language="F#" Value="abstract member AsyncProcessMessage : System.Runtime.Remoting.Messaging.IMessage * System.Runtime.Remoting.Messaging.IMessageSink -&gt; System.Runtime.Remoting.Messaging.IMessageCtrl" Usage="iMessageSink.AsyncProcessMessage (msg, replySink)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Runtime.Remoting.Messaging.IMessageCtrl</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="msg" Type="System.Runtime.Remoting.Messaging.IMessage" />
        <Parameter Name="replySink" Type="System.Runtime.Remoting.Messaging.IMessageSink" />
      </Parameters>
      <Docs>
        <param name="msg">
          <span data-ttu-id="0a70f-114">要處理的訊息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-114">The message to process.</span>
          </span>
        </param>
        <param name="replySink">
          <span data-ttu-id="0a70f-115">回覆訊息的回覆接收。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-115">The reply sink for the reply message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="0a70f-116">非同步處理指定的訊息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-116">Asynchronously processes the given message.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="0a70f-117">傳回 <see cref="T:System.Runtime.Remoting.Messaging.IMessageCtrl" /> 介面，在已經分派它們之後提供控制非同步訊息的方式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-117">Returns an <see cref="T:System.Runtime.Remoting.Messaging.IMessageCtrl" /> interface that provides a way to control asynchronous messages after they have been dispatched.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0a70f-118">這個方法會在訊息接收上叫用的遠端執行功能基礎結構，或由先前的非同步訊息接收。</span><span class="sxs-lookup"><span data-stu-id="0a70f-118">This method is invoked on the message sink by the remoting infrastructure or by a previous sink for asynchronous messages.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="0a70f-119">立即呼叫者透過對介面的參考進行呼叫，且沒有基礎結構權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-119">The immediate caller makes the call through a reference to the interface and does not have infrastructure permission.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="0a70f-120">營運與基礎結構程式碼。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-120">for operating with infrastructure code.</span>
          </span>
          <span data-ttu-id="0a70f-121">要求的值： <see cref="F:System.Security.Permissions.SecurityAction.LinkDemand" />;權限的值： <see cref="F:System.Security.Permissions.SecurityPermissionFlag.Infrastructure" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-121">Demand value: <see cref="F:System.Security.Permissions.SecurityAction.LinkDemand" />; Permission value: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.Infrastructure" /></span>
          </span>
        </permission>
      </Docs>
    </Member>
    <Member MemberName="NextSink">
      <MemberSignature Language="C#" Value="public System.Runtime.Remoting.Messaging.IMessageSink NextSink { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Runtime.Remoting.Messaging.IMessageSink NextSink" />
      <MemberSignature Language="DocId" Value="P:System.Runtime.Remoting.Messaging.IMessageSink.NextSink" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property NextSink As IMessageSink" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Runtime::Remoting::Messaging::IMessageSink ^ NextSink { System::Runtime::Remoting::Messaging::IMessageSink ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.NextSink : System.Runtime.Remoting.Messaging.IMessageSink" Usage="System.Runtime.Remoting.Messaging.IMessageSink.NextSink" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Runtime.Remoting.Messaging.IMessageSink</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="0a70f-122">取得接收鏈結中的下一個訊息接收。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-122">Gets the next message sink in the sink chain.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="0a70f-123">接收鏈結中的下一個訊息接收。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-123">The next message sink in the sink chain.</span>
          </span>
        </value>
        <remarks>To be added.</remarks>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="0a70f-124">立即呼叫者透過對介面的參考進行呼叫，且沒有基礎結構權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-124">The immediate caller makes the call through a reference to the interface and does not have infrastructure permission.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="0a70f-125">營運與基礎結構程式碼。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-125">for operating with infrastructure code.</span>
          </span>
          <span data-ttu-id="0a70f-126">要求的值： <see cref="F:System.Security.Permissions.SecurityAction.LinkDemand" />;權限的值： <see cref="F:System.Security.Permissions.SecurityPermissionFlag.Infrastructure" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-126">Demand value: <see cref="F:System.Security.Permissions.SecurityAction.LinkDemand" />; Permission value: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.Infrastructure" /></span>
          </span>
        </permission>
      </Docs>
    </Member>
    <Member MemberName="SyncProcessMessage">
      <MemberSignature Language="C#" Value="public System.Runtime.Remoting.Messaging.IMessage SyncProcessMessage (System.Runtime.Remoting.Messaging.IMessage msg);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Runtime.Remoting.Messaging.IMessage SyncProcessMessage(class System.Runtime.Remoting.Messaging.IMessage msg) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Runtime.Remoting.Messaging.IMessageSink.SyncProcessMessage(System.Runtime.Remoting.Messaging.IMessage)" />
      <MemberSignature Language="VB.NET" Value="Public Function SyncProcessMessage (msg As IMessage) As IMessage" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Runtime::Remoting::Messaging::IMessage ^ SyncProcessMessage(System::Runtime::Remoting::Messaging::IMessage ^ msg);" />
      <MemberSignature Language="F#" Value="abstract member SyncProcessMessage : System.Runtime.Remoting.Messaging.IMessage -&gt; System.Runtime.Remoting.Messaging.IMessage" Usage="iMessageSink.SyncProcessMessage msg" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Runtime.Remoting.Messaging.IMessage</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="msg" Type="System.Runtime.Remoting.Messaging.IMessage" />
      </Parameters>
      <Docs>
        <param name="msg">
          <span data-ttu-id="0a70f-127">要處理的訊息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-127">The message to process.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="0a70f-128">同步處理指定的訊息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-128">Synchronously processes the given message.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="0a70f-129">回應要求的回覆訊息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-129">A reply message in response to the request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0a70f-130"><xref:System.Runtime.Remoting.Messaging.IMessageSink.SyncProcessMessage%2A>方法上叫用的訊息接收的遠端執行功能基礎結構，或先前接收同步訊息。</span><span class="sxs-lookup"><span data-stu-id="0a70f-130">The <xref:System.Runtime.Remoting.Messaging.IMessageSink.SyncProcessMessage%2A> method is invoked on the message sink by the remoting infrastructure or by a previous sink for synchronous messages.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="0a70f-131">立即呼叫者透過對介面的參考進行呼叫，且沒有基礎結構權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-131">The immediate caller makes the call through a reference to the interface and does not have infrastructure permission.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="0a70f-132">營運與基礎結構程式碼。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-132">for operating with infrastructure code.</span>
          </span>
          <span data-ttu-id="0a70f-133">要求的值： <see cref="F:System.Security.Permissions.SecurityAction.LinkDemand" />;權限的值： <see cref="F:System.Security.Permissions.SecurityPermissionFlag.Infrastructure" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="0a70f-133">Demand value: <see cref="F:System.Security.Permissions.SecurityAction.LinkDemand" />; Permission value: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.Infrastructure" /></span>
          </span>
        </permission>
      </Docs>
    </Member>
  </Members>
</Type>