<Type Name="AuthorizationStoreRoleProvider" FullName="System.Web.Security.AuthorizationStoreRoleProvider">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="d0fcd501cfb76d52f5637a2f15d84ca5dd63a262" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class AuthorizationStoreRoleProvider : System.Web.Security.RoleProvider" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit AuthorizationStoreRoleProvider extends System.Web.Security.RoleProvider" />
  <TypeSignature Language="DocId" Value="T:System.Web.Security.AuthorizationStoreRoleProvider" />
  <TypeSignature Language="VB.NET" Value="Public Class AuthorizationStoreRoleProvider&#xA;Inherits RoleProvider" />
  <TypeSignature Language="C++ CLI" Value="public ref class AuthorizationStoreRoleProvider : System::Web::Security::RoleProvider" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.Security.RoleProvider</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="aa1d8-101">管理授權管理員原則存放區中 ASP.NET 應用程式的角色成員資格資訊儲存區，位於 XML 檔案、Active Directory 或 Active Directory 應用程式模式伺服器之中。</span>
      <span class="sxs-lookup">
        <span data-stu-id="aa1d8-101">Manages storage of role-membership information for an ASP.NET application in an authorization-manager policy store, either in an XML file, in an Active Directory, or on an Active Directory Application Mode server.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-102">這個類別由<xref:System.Web.Security.Roles>和<xref:System.Web.Security.RolePrincipal>類別提供 ASP.NET 應用程式使用授權管理員存放區的角色管理服務。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-102">This class is used by the <xref:System.Web.Security.Roles> and <xref:System.Web.Security.RolePrincipal> classes to provide role-management services for an ASP.NET application using an authorization-manager store.</span></span> <span data-ttu-id="aa1d8-103">您可以使用角色管理您的應用程式指定不同的層級的授權。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-103">You can use role management to specify different levels of authorization for your application.</span></span> <span data-ttu-id="aa1d8-104">授權管理員可以使用 Microsoft Management Console 來存取。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-104">The authorization manager can be accessed using the Microsoft Management Console.</span></span>  
  
 <span data-ttu-id="aa1d8-105"><xref:System.Web.Security.AuthorizationStoreRoleProvider>物件搭配 Windows 驗證，而且表單驗證模式。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-105">The <xref:System.Web.Security.AuthorizationStoreRoleProvider> object works with both Windows authentication and forms authentication modes.</span></span>  
  
 <span data-ttu-id="aa1d8-106">您可以設定<xref:System.Web.Security.AuthorizationStoreRoleProvider>来使用本機的 XML 檔案或 Active Directory 或 Active Directory 應用程式模式 (ADAM) 的伺服器物件。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-106">You can configure the <xref:System.Web.Security.AuthorizationStoreRoleProvider> object to use either a local XML file or an Active Directory or Active Directory Application Mode (ADAM) server.</span></span> <span data-ttu-id="aa1d8-107">使用本機檔案，連接字串看起來應該類似下列的範例。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-107">When using a local file, the connection string should look like the following example.</span></span>  
  
```  
msxml://<path to xml file>  
```  
  
 <span data-ttu-id="aa1d8-108">如果本機檔案儲存在 ASP.NET Web 應用程式的目錄樹狀結構中，您可以使用波狀符號 ("~") 字元來表示目錄的根目錄。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-108">If the local file is stored in the directory tree of an ASP.NET Web application, you can use the tilde ("~") character to indicate the root directory.</span></span> <span data-ttu-id="aa1d8-109">例如，若要指出本機檔案會儲存在 Web 應用程式的資料目錄，您會使用類似下列的範例連接字串。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-109">For example, to indicate that the local file is stored in the Web application's data directory, you would use a connection string similar to the following example.</span></span>  
  
 `msxml://~\App_Data\datafilename.xml`  
  
> [!IMPORTANT]
>  <span data-ttu-id="aa1d8-110">Web 應用程式目錄中儲存 XML 資料檔可能會造成安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-110">Storing an XML data file in the Web application directory is a potential security threat.</span></span> <span data-ttu-id="aa1d8-111">根據預設，IIS 將 web 服務 XML 資料檔案。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-111">By default, IIS will serve XML data files to the Web.</span></span> <span data-ttu-id="aa1d8-112">為了提高安全性，使用本機資料檔中的 ASP.NET 應用程式時，您應該儲存資料檔中的`App_Data`目錄。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-112">To improve security when using a local data file in an ASP.NET application, you should store the data file in the `App_Data` directory.</span></span> <span data-ttu-id="aa1d8-113">檔案儲存在`App_Data`目錄將不會以 Web 服務。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-113">Files stored in the `App_Data` directory will not be served to the Web.</span></span>  
  
 <span data-ttu-id="aa1d8-114">如果您使用 Active Directory 或 ADAM 伺服器的原則存放區，您的連接字串應該類似下列的範例。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-114">If you are using an Active Directory or ADAM server for the policy store, your connection string should be similar to the following example.</span></span>  
  
 `msldap://myserver/CN=MyAzManStore,OU=MyOU,DC=MyDomain,DC=MyDC,DC=Com`  
  
 <span data-ttu-id="aa1d8-115">列出的文件中的例外狀況<xref:System.Web.Security.AuthorizationStoreRoleProvider>物件的方法是由所引發的例外狀況<xref:System.Web.Security.AuthorizationStoreRoleProvider>物件。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-115">The exceptions listed in the documentation for <xref:System.Web.Security.AuthorizationStoreRoleProvider> object methods are the exceptions that are raised by the <xref:System.Web.Security.AuthorizationStoreRoleProvider> object.</span></span> <span data-ttu-id="aa1d8-116">由於提供者依賴基礎的驗證管理員執行階段，<xref:System.Runtime.InteropServices.COMException>例外狀況可能是每當擲回<xref:System.Web.Security.AuthorizationStoreRoleProvider>物件會轉送驗證管理員執行階段的方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-116">Since the provider relies on the underlying Authentication Manager runtime, a <xref:System.Runtime.InteropServices.COMException> exception may be thrown whenever the <xref:System.Web.Security.AuthorizationStoreRoleProvider> object forwards a method call to the Authentication Manager runtime.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="aa1d8-117"><xref:System.Web.Security.AuthorizationStoreRoleProvider>物件具有在部分信任環境中執行的下列需求：</span><span class="sxs-lookup"><span data-stu-id="aa1d8-117">The <xref:System.Web.Security.AuthorizationStoreRoleProvider> object has the following requirements for running in partial-trust environments:</span></span>  
>   
>  <span data-ttu-id="aa1d8-118">當使用 ASP.NET 應用程式中，授與的目前信任層級的檔案 I/O 權限以檔案為基礎的原則存放區決定是否讀取及提供者允許寫入動作。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-118">When using a file-based policy store in an ASP.NET application, the file I/O permissions granted by the current trust level determine whether read and write actions are allowed by the provider.</span></span> <span data-ttu-id="aa1d8-119">ASP.NET 應用程式必須有讀取檔案的權限，才能讀取原則存放區中的資料，而且必須具有寫入權限，以儲存新的資訊或更新的原則存放區中的現有資訊。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-119">The ASP.NET application must have read permission on the file to read data from the policy store, and must have write permission to save new information or update existing information in the policy store.</span></span> <span data-ttu-id="aa1d8-120">預設的中度信任原則檔案提供其應用程式目錄中的 ASP.NET 應用程式讀取/寫入權限。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-120">The default Medium-trust policy file gives an ASP.NET application read/write permissions in its application directory.</span></span> <span data-ttu-id="aa1d8-121">預設值低度信任原則檔案僅提供 ASP.NET 應用程式讀取其應用程式目錄中的權限。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-121">The default Low-trust policy file only gives an ASP.NET application read permission in its application directory.</span></span> <span data-ttu-id="aa1d8-122">此外，ASP.NET 應用程式執行所在的處理序識別必須具有讀取和/或寫入原則檔案的檔案系統權限。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-122">In addition, the process identity under which the ASP.NET application runs must have file-system permissions to read and/or write the policy file.</span></span>  
>   
>  <span data-ttu-id="aa1d8-123">ASP.NET 應用程式使用 Active Directory 或 ADAM 的伺服器時，需要 unmanaged 程式碼權限，因為內部<xref:System.Web.Security.AuthorizationStoreRoleProvider>物件程式碼會使用 COM interop。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-123">When using an Active Directory or ADAM server, the ASP.NET application needs unmanaged-code permission because the internal <xref:System.Web.Security.AuthorizationStoreRoleProvider> object code uses COM interop.</span></span>  
>   
>  <span data-ttu-id="aa1d8-124">當使用<xref:System.Web.Security.AuthorizationStoreRoleProvider>物件在 ASP.NET 之外，呼叫程式碼需要 unmanaged 程式碼的權限。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-124">When using the <xref:System.Web.Security.AuthorizationStoreRoleProvider> object outside of ASP.NET, the calling code needs unmanaged-code permission.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-125">下列程式碼範例顯示 Web.config 檔案設定為使用<xref:System.Web.Security.AuthorizationStoreRoleProvider>用於角色管理。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-125">The following code example shows a Web.config file set to use the <xref:System.Web.Security.AuthorizationStoreRoleProvider> for role management.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="AuthorizationServices" connectionString="msxml://~\App_Data\SampleStore.xml" />  
  </connectionStrings>  
  
  <system.web>  
  
    <authentication mode="Windows" />  
    <identity impersonate="true" />  
  
    <roleManager defaultProvider="AuthorizationStoreRoleProvider"   
      enabled="true"  
      cacheRolesInCookie="true"  
      cookieName=".ASPROLES"  
      cookieTimeout="30"  
      cookiePath="/"  
      cookieRequireSSL="false"  
      cookieSlidingExpiration="true"  
      cookieProtection="All" >  
      <providers>  
        <clear />  
          <add  
            name="AuthorizationStoreRoleProvider"  
            type="System.Web.Security.AuthorizationStoreRoleProvider"  
            connectionStringName="AuthorizationServices"  
            applicationName="SampleApplication"   
            cacheRefreshInterval="60"  
            scopeName="" />  
      </providers>  
    </roleManager>  
  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public AuthorizationStoreRoleProvider ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; AuthorizationStoreRoleProvider();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="aa1d8-126">初始化 <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 類別的新執行個體。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-126">Initializes a new instance of the <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-127"><xref:System.Web.Security.AuthorizationStoreRoleProvider.%23ctor%2A>建構函式由 ASP.NET 呼叫來建立的執行個體<xref:System.Web.Security.AuthorizationStoreRoleProvider>類別做為應用程式的組態中指定。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-127">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.%23ctor%2A> constructor is called by ASP.NET to create an instance of the <xref:System.Web.Security.AuthorizationStoreRoleProvider> class as specified in the configuration for the application.</span></span> <span data-ttu-id="aa1d8-128">這個建構函式不是從您的程式碼使用。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-128">This constructor is not intended to be used from your code.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="AddUsersToRoles">
      <MemberSignature Language="C#" Value="public override void AddUsersToRoles (string[] usernames, string[] roleNames);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void AddUsersToRoles(string[] usernames, string[] roleNames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.AddUsersToRoles(System.String[],System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub AddUsersToRoles (usernames As String(), roleNames As String())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void AddUsersToRoles(cli::array &lt;System::String ^&gt; ^ usernames, cli::array &lt;System::String ^&gt; ^ roleNames);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernames" Type="System.String[]" />
        <Parameter Name="roleNames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="usernames">
          <span data-ttu-id="aa1d8-129">要加入指定角色中的使用者名稱字串陣列。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-129">A string array of user names to be added to the specified roles.</span>
          </span>
        </param>
        <param name="roleNames">
          <span data-ttu-id="aa1d8-130">角色名稱的字串陣列，要在其中加入指定的使用者名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-130">A string array of role names to add the specified user names to.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="aa1d8-131">將指定使用者加入每個指定的角色。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-131">Adds the specified user names to each of the specified roles.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-132"><xref:System.Web.Security.AuthorizationStoreRoleProvider.AddUsersToRoles%2A>方法透過呼叫<xref:System.Web.Security.Roles>一或多個使用者與授權管理員資料存放區中的 ASP.NET 應用程式組態檔 (Web.config) 中指定的一個或多個角色建立關聯的類別。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-132">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.AddUsersToRoles%2A> method is called by the <xref:System.Web.Security.Roles> class to associate one or more users with one or more roles in the authorization-manager data store specified in the ASP.NET application's configuration file (Web.config).</span></span> <span data-ttu-id="aa1d8-133">這個方法會呼叫<xref:System.Web.Security.Roles.AddUserToRole%2A?displayProperty=nameWithType>， <xref:System.Web.Security.Roles.AddUserToRoles%2A?displayProperty=nameWithType>， <xref:System.Web.Security.Roles.AddUsersToRole%2A?displayProperty=nameWithType>，和<xref:System.Web.Security.Roles.AddUsersToRoles%2A?displayProperty=nameWithType>方法<xref:System.Web.Security.Roles>類別。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-133">This method is called by the <xref:System.Web.Security.Roles.AddUserToRole%2A?displayProperty=nameWithType>, <xref:System.Web.Security.Roles.AddUserToRoles%2A?displayProperty=nameWithType>, <xref:System.Web.Security.Roles.AddUsersToRole%2A?displayProperty=nameWithType>, and <xref:System.Web.Security.Roles.AddUsersToRoles%2A?displayProperty=nameWithType> methods of the <xref:System.Web.Security.Roles> class.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-134">下列程式碼範例將一個或多個使用者加入角色，或從角色移除使用者。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-134">The following code example adds one or more users to a role or removes a user from a role.</span></span> <span data-ttu-id="aa1d8-135">如需可讓您管理角色的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.AuthorizationStoreRoleProvider>。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-135">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.AuthorizationStoreRoleProvider>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/adduserstorolecs.aspx#3)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/adduserstorolevb.aspx#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="aa1d8-136">其中一個指定的使用者名稱為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-136">One of the specified user names is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="aa1d8-137">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-137">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-138">其中一個指定的角色名稱為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-138">One of the specified role names is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="aa1d8-139">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-139">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-140">
            <paramref name="usernames" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-140">
              <paramref name="usernames" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="aa1d8-141">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-141">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-142">
            <paramref name="roleNames" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-142">
              <paramref name="roleNames" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="aa1d8-143">其中一個指定的使用者名稱是空字串，或包含逗號 (,)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-143">One of the specified user names is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="aa1d8-144">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-144">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-145">其中一個指定的角色名稱是空字串，或包含逗號 (,)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-145">One of the specified role names is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="aa1d8-146">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-146">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-147">
            <paramref name="usernames" /> 包含重複的項目。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-147">
              <paramref name="usernames" /> contains a duplicate element.</span>
          </span>
          <span data-ttu-id="aa1d8-148">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-148">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-149">
            <paramref name="roleNames" /> 包含重複的項目。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-149">
              <paramref name="roleNames" /> contains a duplicate element.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-150">找不到設定的 <see langword="applicationName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-150">The configured <see langword="applicationName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-151">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-151">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-152">找不到設定的 <see langword="scopeName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-152">The configured <see langword="scopeName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-153">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-153">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-154">授權管理員執行階段未安裝在伺服器上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-154">The authorization-manager runtime is not installed on the server.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="aa1d8-155">
            <see langword="connectionStringName" /> 屬性參考到不存在檔案的連接字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-155">The <see langword="connectionStringName" /> attribute references a connection string to a file that does not exist.</span>
          </span>
        </exception>
        <exception cref="T:System.Web.HttpException">
          <span data-ttu-id="aa1d8-156">
            <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體是使用檔案架構的原則存放區所設定，而且目前的信任層級不允許檔案的讀取權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-156">The <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance is configured with a file-based policy store, and read access to the file is not allowed at the current trust level.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public override string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="aa1d8-157">取得或設定授權存放應用程式的名稱，要為它存放及擷取角色資訊。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-157">Gets or sets the name of the authorization store application for which to store and retrieve role information.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="aa1d8-158">要為它存放和擷取角色資訊的授權存放應用程式名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-158">The name of the authorization store application for which to store and retrieve role information.</span>
          </span>
          <span data-ttu-id="aa1d8-159">預設為目前 <see cref="P:System.Web.HttpRequest.ApplicationPath" /> 的 <see cref="P:System.Web.HttpContext.Request" /> 屬性值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-159">The default is the <see cref="P:System.Web.HttpRequest.ApplicationPath" /> property value for the current <see cref="P:System.Web.HttpContext.Request" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-160"><xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A>正由<xref:System.Web.Security.AuthorizationStoreRoleProvider>使用者和角色與不同的授權管理員應用程式，可讓多個 ASP.NET 應用程式使用相同的授權管理員原則存放區來儲存角色資訊，而不重複的角色名稱之間發生衝突。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-160">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A> is used by the <xref:System.Web.Security.AuthorizationStoreRoleProvider> to associate users and roles with different authorization-manager applications, which enables multiple ASP.NET applications to use the same authorization-manager policy store to store role information without running into conflicts between duplicate role names.</span></span> <span data-ttu-id="aa1d8-161">或者，多個 ASP.NET 應用程式時，可以藉由指定相同的值中使用相同的原則存放區<xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-161">Alternatively, multiple ASP.NET applications can use the same policy store by specifying the same value in the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A> property.</span></span> <span data-ttu-id="aa1d8-162"><xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A>可以透過程式設計的方式，設定屬性，或者可以設定以宣告方式在應用程式的 Web.config 檔案中使用`applicationName`屬性。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-162">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A> property can be set programmatically, or it can be set declaratively in the application's Web.config file by using the `applicationName` attribute.</span></span>  
  
 <span data-ttu-id="aa1d8-163">如果未指定值`applicationName`屬性在 Web.config 檔案中，然後在<xref:System.Web.HttpRequest.ApplicationPath%2A?displayProperty=nameWithType>目前屬性值<xref:System.Web.HttpContext.Request%2A?displayProperty=nameWithType>物件使用。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-163">If a value is not specified for the `applicationName` attribute in the Web.config file, then the <xref:System.Web.HttpRequest.ApplicationPath%2A?displayProperty=nameWithType> property value for the current <xref:System.Web.HttpContext.Request%2A?displayProperty=nameWithType> object is used.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="aa1d8-164">授權管理員應用程式名稱不可包含"/"字元包含在<xref:System.Web.HttpRequest.ApplicationPath%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-164">Authorization-manager application names cannot contain the "/" character that is included in the <xref:System.Web.HttpRequest.ApplicationPath%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="aa1d8-165">如此一來的預設值<xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A>屬性不能做為授權管理員應用程式名稱，而且在應用程式的 Web.config 檔案中，您一定要指定`applicationName`屬性`provider`項目來設定您<xref:System.Web.Security.AuthorizationStoreRoleProvider>執行個體。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-165">As a result, the default value for the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A> property cannot be used as an authorization-manager application name, and in the application's Web.config file, you must always specify an `applicationName` attribute in the `provider` element to configure your <xref:System.Web.Security.AuthorizationStoreRoleProvider> instance.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="aa1d8-166">因為所有由提供服務的要求會使用單一預設角色提供者執行個體<xref:System.Web.HttpApplication>物件，您可以有多個要求同時執行，而且嘗試設定<xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A>屬性值。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-166">Because a single default role provider instance is used for all of the requests served by an <xref:System.Web.HttpApplication> object, you can have multiple requests executing concurrently and attempting to set the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A> property value.</span></span> <span data-ttu-id="aa1d8-167"><xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A>屬性不是執行緒安全的多個寫入，且變更<xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A>屬性值可能會導致非預期的行為時有多個應用程式的使用者。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-167">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A> property is not thread safe for multiple writes, and changing the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A> property value can result in unexpected behavior when there are multiple users of an application.</span></span> <span data-ttu-id="aa1d8-168">我們建議您避免撰寫程式碼，讓使用者設定<xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A>屬性除非必要，否則。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-168">We recommend that you avoid writing code that allows users to set the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A> property unless you must.</span></span> <span data-ttu-id="aa1d8-169">應用程式的範例設定<xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A>屬性可能需要為系統管理的應用程式管理角色的多個應用程式的資料。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-169">An example of an application where setting the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A> property may be required is an administrative application that manages role data for multiple applications.</span></span> <span data-ttu-id="aa1d8-170">這類應用程式應該在單一使用者應用程式並不是 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-170">Such an application should be a single-user application and not a Web application.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-171">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-171">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="aa1d8-172">它會指定應用程式的<xref:System.Web.Security.AuthorizationStoreRoleProvider>執行個體和設定<xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A>屬性`MyApplication`。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-172">It specifies the application's <xref:System.Web.Security.AuthorizationStoreRoleProvider> instance and sets the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName%2A> property to `MyApplication`.</span></span>  
  
```  
<roleManager defaultProvider="AuthorizationStoreProvider"   
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/"  
  cookieRequireSSL="false"  
  cookieSlidingExpiration="true"  
  cookieProtection="All" >  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.AuthorizationStoreRoleProvider"  
      connectionStringName="AuthorizationStoreServices"   
      scopeName="MyScope"  
      applicationName="MyApplication" />  
  </providers>  
</roleManager>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-173">嘗試將 <see cref="P:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName" /> 設定為長度超過 256 個字元的字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-173">An attempt was made to set the <see cref="P:System.Web.Security.AuthorizationStoreRoleProvider.ApplicationName" /> to a string that is longer than 256 characters.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="CacheRefreshInterval">
      <MemberSignature Language="C#" Value="public int CacheRefreshInterval { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 CacheRefreshInterval" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.AuthorizationStoreRoleProvider.CacheRefreshInterval" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CacheRefreshInterval As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int CacheRefreshInterval { int get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="aa1d8-174">取得原則存放區資料快取之重新整理間的分鐘數。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-174">Gets the number of minutes between refreshes of the cache of the policy-store data.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="aa1d8-175">快取的原則存放區資料之重新整理間的分鐘數。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-175">The number of minutes between refreshes of cached policy-store data.</span>
          </span>
          <span data-ttu-id="aa1d8-176">預設為 60。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-176">The default is 60.</span>
          </span>
        </value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="CreateRole">
      <MemberSignature Language="C#" Value="public override void CreateRole (string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void CreateRole(string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.CreateRole(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub CreateRole (roleName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void CreateRole(System::String ^ roleName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="aa1d8-177">要建立的角色名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-177">The name of the role to create.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="aa1d8-178">加入新的角色至角色授權管理員原則存放區。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-178">Adds a new role to the role authorization-manager policy store.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-179"><xref:System.Web.Security.AuthorizationStoreRoleProvider.CreateRole%2A>方法透過呼叫<xref:System.Web.Security.Roles>類別來建立 ASP.NET 應用程式組態檔 (Web.config) 中指定的授權管理員資料存放區中的角色。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-179">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.CreateRole%2A> method is called by the <xref:System.Web.Security.Roles> class to create a role in the authorization-manager data store specified in the ASP.NET application's configuration file (Web.config).</span></span>  
  
 <span data-ttu-id="aa1d8-180">角色名稱不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-180">Role names are not case sensitive.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-181">下列程式碼範例會建立新的角色，授權管理員原則存放區中。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-181">The following code example creates a new role in the authorization-manager policy store.</span></span> <span data-ttu-id="aa1d8-182">如需可讓您管理角色的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.AuthorizationStoreRoleProvider>。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-182">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.AuthorizationStoreRoleProvider>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/createrolecs.aspx#1)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/createrolevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="aa1d8-183">
            <paramref name="roleName" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-183">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="aa1d8-184">
            <paramref name="roleName" /> 為空字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-184">
              <paramref name="roleName" /> is an empty string.</span>
          </span>
          <span data-ttu-id="aa1d8-185">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-185">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-186">
            <paramref name="roleName" /> 包含逗號。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-186">
              <paramref name="roleName" /> contains a comma.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-187">找不到設定的 <see langword="applicationName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-187">The configured <see langword="applicationName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-188">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-188">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-189">找不到設定的 <see langword="scopeName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-189">The configured <see langword="scopeName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-190">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-190">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-191">授權管理員執行階段未安裝在伺服器上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-191">The authorization-manager runtime is not installed on the server.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="aa1d8-192">
            <see langword="connectionStringName" /> 屬性參考到不存在檔案的連接字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-192">The <see langword="connectionStringName" /> attribute references a connection string to a file that does not exist.</span>
          </span>
        </exception>
        <exception cref="T:System.Web.HttpException">
          <span data-ttu-id="aa1d8-193">
            <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體是使用檔案架構的原則存放區所設定，而且目前的信任層級不允許檔案的讀取權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-193">The <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance is configured with a file-based policy store, and read access to the file is not allowed at the current trust level.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="DeleteRole">
      <MemberSignature Language="C#" Value="public override bool DeleteRole (string roleName, bool throwOnPopulatedRole);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool DeleteRole(string roleName, bool throwOnPopulatedRole) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.DeleteRole(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function DeleteRole (roleName As String, throwOnPopulatedRole As Boolean) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool DeleteRole(System::String ^ roleName, bool throwOnPopulatedRole);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
        <Parameter Name="throwOnPopulatedRole" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="aa1d8-194">要刪除的角色名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-194">The name of the role to delete.</span>
          </span>
        </param>
        <param name="throwOnPopulatedRole">
          <span data-ttu-id="aa1d8-195">如果為 <see langword="true" />，就會在 <c>roleName</c> 有一或多個成員時，擲回例外狀況。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-195">If <see langword="true" />, throws an exception if <c>roleName</c> has one or more members.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="aa1d8-196">從授權管理員原則存放區移除角色。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-196">Removes a role from the authorization-manager policy store.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="aa1d8-197">如果已刪除角色，則為 <see langword="true" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-197">
              <see langword="true" /> if the role was deleted; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-198"><xref:System.Web.Security.AuthorizationStoreRoleProvider.DeleteRole%2A>方法透過呼叫<xref:System.Web.Security.Roles>類別，以從 ASP.NET 應用程式組態檔 (Web.config) 中指定的授權管理員原則存放區刪除的角色。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-198">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.DeleteRole%2A> method is called by the <xref:System.Web.Security.Roles> class to delete a role from the authorization-manager policy store specified in the ASP.NET application's configuration file (Web.config).</span></span> <span data-ttu-id="aa1d8-199">刪除角色時，也會從原則存放區刪除與該角色相關聯的使用者清單。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-199">When a role is deleted, the list of users associated with that role is also deleted from the policy store.</span></span> <span data-ttu-id="aa1d8-200">不會影響資料庫中的使用者資訊。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-200">The user information in the database is not affected.</span></span>  
  
 <span data-ttu-id="aa1d8-201">如果`throwOnPopulatedRole`是`true`則會擲回例外狀況，角色將不會刪除，如果角色由`roleName`參數有一個或多個成員。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-201">If `throwOnPopulatedRole` is `true`, then an exception will be thrown and the role will not be deleted if the role identified by the `roleName` parameter has one or more members.</span></span> <span data-ttu-id="aa1d8-202">如果`throwOnPopulatedRole`是`false`，則它是空的或不會刪除該角色。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-202">If `throwOnPopulatedRole` is `false`, then the role will be deleted whether it is empty or not.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-203">下列範例會從授權管理員原則存放區刪除角色。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-203">The following example deletes a role from the authorization-manager policy store.</span></span> <span data-ttu-id="aa1d8-204">如需可讓您管理角色的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.AuthorizationStoreRoleProvider>。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-204">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.AuthorizationStoreRoleProvider>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/deleterolecs.aspx#2)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/deleterolevb.aspx#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="aa1d8-205">
            <paramref name="roleName" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-205">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="aa1d8-206">
            <paramref name="roleName" /> 為空字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-206">
              <paramref name="roleName" /> is an empty string.</span>
          </span>
          <span data-ttu-id="aa1d8-207">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-207">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-208">
            <paramref name="roleName" /> 包含逗號。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-208">
              <paramref name="roleName" /> contains a comma.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-209">
            <paramref name="roleName" /> 具有一或多個成員，且 <paramref name="throwOnPopulatedRole" /> 是 <see langword="true" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-209">
              <paramref name="roleName" /> has one or more members and <paramref name="throwOnPopulatedRole" /> is <see langword="true" />.</span>
          </span>
          <span data-ttu-id="aa1d8-210">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-210">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-211">找不到設定的 <see langword="applicationName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-211">The configured <see langword="applicationName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-212">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-212">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-213">找不到設定的 <see langword="scopeName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-213">The configured <see langword="scopeName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-214">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-214">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-215">授權管理員執行階段未安裝在伺服器上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-215">The authorization-manager runtime is not installed on the server.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="aa1d8-216">
            <see langword="connectionStringName" /> 屬性參考到不存在檔案的連接字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-216">The <see langword="connectionStringName" /> attribute references a connection string to a file that does not exist.</span>
          </span>
        </exception>
        <exception cref="T:System.Web.HttpException">
          <span data-ttu-id="aa1d8-217">
            <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體是使用檔案架構的原則存放區所設定，而且目前的信任層級不允許檔案的讀取權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-217">The <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance is configured with a file-based policy store, and read access to the file is not allowed at the current trust level.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="FindUsersInRole">
      <MemberSignature Language="C#" Value="public override string[] FindUsersInRole (string roleName, string usernameToMatch);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string[] FindUsersInRole(string roleName, string usernameToMatch) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.FindUsersInRole(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersInRole (roleName As String, usernameToMatch As String) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override cli::array &lt;System::String ^&gt; ^ FindUsersInRole(System::String ^ roleName, System::String ^ usernameToMatch);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
        <Parameter Name="usernameToMatch" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="aa1d8-218">要搜尋的角色。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-218">The role to search in.</span>
          </span>
        </param>
        <param name="usernameToMatch">
          <span data-ttu-id="aa1d8-219">要搜尋的使用者名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-219">The user name to search for.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="aa1d8-220">授權存放區角色提供者不支援這個方法。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-220">This method is not supported by the authorization store role provider.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="aa1d8-221">字串陣列，包含所有使用者的名稱，這些使用者的使用者名稱符合 <paramref name="usernameToMatch" />，而且是指定角色的成員。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-221">A string array containing the names of all the users whose user name matches <paramref name="usernameToMatch" /> and who are members of the specified role.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
        <exception cref="T:System.NotImplementedException">
          <span data-ttu-id="aa1d8-222">呼叫了不支援的方法。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-222">An unsupported method was called.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="GetAllRoles">
      <MemberSignature Language="C#" Value="public override string[] GetAllRoles ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string[] GetAllRoles() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.GetAllRoles" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetAllRoles () As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override cli::array &lt;System::String ^&gt; ^ GetAllRoles();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="aa1d8-223">取得應用程式所有角色的清單。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-223">Gets a list of all the roles for the application.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="aa1d8-224">字串陣列，其中包含存放在特定應用程式之授權管理員原則存放區中的所有角色名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-224">A string array containing the names of all the roles stored in the authorization-manager policy store for a particular application.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-225"><xref:System.Web.Security.AuthorizationStoreRoleProvider.GetAllRoles%2A>方法透過呼叫<xref:System.Web.Security.Roles>類別來擷取的 ASP.NET 應用程式組態檔 (Web.config) 中指定的授權管理員原則存放區中的所有角色清單。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-225">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.GetAllRoles%2A> method is called by the <xref:System.Web.Security.Roles> class to retrieve a list of all the roles in the authorization-manager policy store specified in the ASP.NET application's configuration file (Web.config).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-226">下列程式碼範例使用<xref:System.Web.Security.Roles.GetAllRoles%2A>方法，以取得應用程式角色的清單，以及繫結至結果<xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType>控制項。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-226">The following code example uses the <xref:System.Web.Security.Roles.GetAllRoles%2A> method to get the list of roles for an application and bind the results to a <xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType> control.</span></span> <span data-ttu-id="aa1d8-227">如需可讓您管理角色的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.AuthorizationStoreRoleProvider>。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-227">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.AuthorizationStoreRoleProvider>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/createrolecs.aspx#1)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/createrolevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-228">找不到設定的 <see langword="applicationName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-228">The configured <see langword="applicationName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-229">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-229">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-230">找不到設定的 <see langword="scopeName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-230">The configured <see langword="scopeName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-231">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-231">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-232">授權管理員執行階段未安裝在伺服器上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-232">The authorization-manager runtime is not installed on the server.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="aa1d8-233">
            <see langword="connectionStringName" /> 屬性參考到不存在檔案的連接字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-233">The <see langword="connectionStringName" /> attribute references a connection string to a file that does not exist.</span>
          </span>
        </exception>
        <exception cref="T:System.Web.HttpException">
          <span data-ttu-id="aa1d8-234">
            <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體是使用檔案架構的原則存放區所設定，而且目前的信任層級不允許檔案的讀取權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-234">The <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance is configured with a file-based policy store, and read access to the file is not allowed at the current trust level.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="GetRolesForUser">
      <MemberSignature Language="C#" Value="public override string[] GetRolesForUser (string username);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string[] GetRolesForUser(string username) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.GetRolesForUser(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetRolesForUser (username As String) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override cli::array &lt;System::String ^&gt; ^ GetRolesForUser(System::String ^ username);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">
          <span data-ttu-id="aa1d8-235">要傳回角色清單的使用者。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-235">The user to return a list of roles for.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="aa1d8-236">取得使用者所屬角色的清單。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-236">Gets a list of the roles that a user is in.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="aa1d8-237">字串陣列，包含指定使用者所屬的所有角色名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-237">A string array containing the names of all the roles that the specified user is in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-238"><xref:System.Web.Security.AuthorizationStoreRoleProvider.GetRolesForUser%2A>方法透過呼叫<xref:System.Web.Security.Roles>類別來擷取指定的使用者角色的清單，從 ASP.NET 應用程式組態檔 (Web.config) 中指定的授權管理員原則存放區。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-238">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.GetRolesForUser%2A> method is called by the <xref:System.Web.Security.Roles> class to retrieve a list of a specified user's roles from the authorization-manager policy store specified in the ASP.NET application's configuration file (Web.config).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-239">下列程式碼範例使用<xref:System.Web.Security.Roles.GetRolesForUser%2A>方法來擷取指定的使用者角色的清單並將它們繫結<xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType>控制項。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-239">The following code example uses the <xref:System.Web.Security.Roles.GetRolesForUser%2A> method to retrieve a list of roles for a specified user and binds them to a <xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType> control.</span></span> <span data-ttu-id="aa1d8-240">如需可讓您管理角色的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.AuthorizationStoreRoleProvider>。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-240">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.AuthorizationStoreRoleProvider>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/ViewRolescs.aspx#4)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/ViewRolesvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="aa1d8-241">
            <paramref name="username" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-241">
              <paramref name="username" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="aa1d8-242">
            <paramref name="username" /> 包含逗號。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-242">
              <paramref name="username" /> contains a comma.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-243">找不到設定的 <see langword="applicationName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-243">The configured <see langword="applicationName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-244">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-244">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-245">找不到設定的 <see langword="scopeName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-245">The configured <see langword="scopeName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-246">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-246">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-247">授權管理員執行階段未安裝在伺服器上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-247">The authorization-manager runtime is not installed on the server.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="aa1d8-248">
            <see langword="connectionStringName" /> 屬性參考到不存在檔案的連接字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-248">The <see langword="connectionStringName" /> attribute references a connection string to a file that does not exist.</span>
          </span>
        </exception>
        <exception cref="T:System.Web.HttpException">
          <span data-ttu-id="aa1d8-249">
            <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體是使用檔案架構的原則存放區所設定，而且目前的信任層級不允許檔案的讀取權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-249">The <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance is configured with a file-based policy store, and read access to the file is not allowed at the current trust level.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="GetUsersInRole">
      <MemberSignature Language="C#" Value="public override string[] GetUsersInRole (string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string[] GetUsersInRole(string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.GetUsersInRole(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUsersInRole (roleName As String) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override cli::array &lt;System::String ^&gt; ^ GetUsersInRole(System::String ^ roleName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="aa1d8-250">要取得使用者清單的角色名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-250">The name of the role to get the list of users for.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="aa1d8-251">取得指定角色的使用者清單。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-251">Gets a list of users in the specified role.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="aa1d8-252">字串陣列，包含屬於指定角色成員的所有使用者名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-252">A string array containing the names of all the users who are members of the specified role.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-253"><xref:System.Web.Security.AuthorizationStoreRoleProvider.GetUsersInRole%2A>方法透過呼叫<xref:System.Web.Security.Roles>類別來擷取與 ASP.NET 應用程式組態檔 (Web.config) 中指定的授權管理員原則存放區中的指定角色相關聯的使用者清單。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-253">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.GetUsersInRole%2A> method is called by the <xref:System.Web.Security.Roles> class to retrieve the list of users associated with the specified role in the authorization-manager policy store specified in the ASP.NET application's configuration file (Web.config).</span></span>  
  
 <span data-ttu-id="aa1d8-254"><xref:System.Web.Security.AuthorizationStoreRoleProvider.GetUsersInRole%2A>方法只會傳回直接包含的使用者名稱中所指定的授權管理員角色`roleName`參數。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-254">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.GetUsersInRole%2A> method only returns user names that are directly contained in the authorization-manager role specified by the `roleName` parameter.</span></span> <span data-ttu-id="aa1d8-255">基礎授權管理員應用程式開發介面呼叫<xref:System.Web.Security.AuthorizationStoreRoleProvider.GetUsersInRole%2A>方法不支援的群組擴充，因此將不會傳回包含巢狀的 NT 群組、 巢狀的授權管理員群組和 LDAP 查詢群組中的使用者。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-255">The underlying authorization-manager API called by the <xref:System.Web.Security.AuthorizationStoreRoleProvider.GetUsersInRole%2A> method does not support group expansion, so users contained in nested NT groups, nested authorization-manager groups, and LDAP query groups will not be returned.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-256">下列程式碼範例使用<xref:System.Web.Security.Roles.GetUsersInRole%2A>方法來取得特定角色中的使用者清單，並繫結至結果<xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType>控制項。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-256">The following code example uses the <xref:System.Web.Security.Roles.GetUsersInRole%2A> method to get a list of the users in a particular role and bind the results to a <xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType> control.</span></span> <span data-ttu-id="aa1d8-257">如需可讓您管理角色的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.AuthorizationStoreRoleProvider>。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-257">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.AuthorizationStoreRoleProvider>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/adduserstorolecs.aspx#3)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/adduserstorolevb.aspx#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="aa1d8-258">
            <paramref name="roleName" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-258">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="aa1d8-259">
            <paramref name="roleName" /> 為空字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-259">
              <paramref name="roleName" /> is an empty string.</span>
          </span>
          <span data-ttu-id="aa1d8-260">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-260">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-261">
            <paramref name="roleName" /> 包含逗號。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-261">
              <paramref name="roleName" /> contains a comma.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-262">找不到設定的 <see langword="applicationName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-262">The configured <see langword="applicationName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-263">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-263">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-264">找不到設定的 <see langword="scopeName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-264">The configured <see langword="scopeName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-265">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-265">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-266">授權管理員執行階段未安裝在伺服器上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-266">The authorization-manager runtime is not installed on the server.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="aa1d8-267">
            <see langword="connectionStringName" /> 屬性參考到不存在檔案的連接字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-267">The <see langword="connectionStringName" /> attribute references a connection string to a file that does not exist.</span>
          </span>
        </exception>
        <exception cref="T:System.Web.HttpException">
          <span data-ttu-id="aa1d8-268">
            <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體是使用檔案架構的原則存放區所設定，而且目前的信任層級不允許檔案的讀取權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-268">The <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance is configured with a file-based policy store, and read access to the file is not allowed at the current trust level.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="Initialize">
      <MemberSignature Language="C#" Value="public override void Initialize (string name, System.Collections.Specialized.NameValueCollection config);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Initialize(string name, class System.Collections.Specialized.NameValueCollection config) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Initialize (name As String, config As NameValueCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Initialize(System::String ^ name, System::Collections::Specialized::NameValueCollection ^ config);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="name" Type="System.String" />
        <Parameter Name="config" Type="System.Collections.Specialized.NameValueCollection" />
      </Parameters>
      <Docs>
        <param name="name">
          <span data-ttu-id="aa1d8-269">要初始化的 <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體之名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-269">The name of the <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance to initialize.</span>
          </span>
        </param>
        <param name="config">
          <span data-ttu-id="aa1d8-270">
            <see cref="T:System.Collections.Specialized.NameValueCollection" />，包含角色提供者的組態選項名稱和值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-270">A <see cref="T:System.Collections.Specialized.NameValueCollection" /> that contains the names and values of configuration options for the role provider.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="aa1d8-271">使用 ASP.NET 應用程式組態檔中指定的屬性值，初始化授權管理員角色提供者。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-271">Initializes the authorization-manager role provider with the property values specified in the ASP.NET application's configuration file.</span>
          </span>
          <span data-ttu-id="aa1d8-272">這個方法不能從程式碼直接使用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-272">This method is not intended to be used directly from your code.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-273"><xref:System.Web.Security.AuthorizationStoreRoleProvider.Initialize%2A>方法初始化<xref:System.Web.Security.AuthorizationStoreRoleProvider>屬性指定值 ASP.NET 應用程式組態檔 (Web.config) 中，而且不是直接從您的程式碼使用。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-273">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.Initialize%2A> method initializes the <xref:System.Web.Security.AuthorizationStoreRoleProvider> with the property values specified in the ASP.NET application configuration file (Web.config) and is not intended to be used directly from your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="aa1d8-274">
            <paramref name="config" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-274">
              <paramref name="config" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-275">
            <see langword="connectionStringName" /> 屬性在 [connectionStrings 元素 (ASP.NET 設定結構描述)](http://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de) 組態區段中是空的或不存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-275">The <see langword="connectionStringName" /> attribute is empty or does not exist in the [connectionStrings Element (ASP.NET Settings Schema)](http://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de) configuration section.</span>
          </span>
          <span data-ttu-id="aa1d8-276">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-276">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-277">
            <see langword="applicationName" /> 長於 256 個字元。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-277">The configured <see langword="applicationName" /> is longer than 256 characters.</span>
          </span>
          <span data-ttu-id="aa1d8-278">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-278">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-279">此 <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體的組態包含無法辨認的屬性。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-279">The configuration for this <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance contains an unrecognized attribute.</span>
          </span>
        </exception>
        <exception cref="T:System.Web.HttpException">
          <span data-ttu-id="aa1d8-280">ASP.NET 應用程式不是在 <see cref="F:System.Web.AspNetHostingPermissionLevel.Low" /> 信任 (含) 以上執行。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-280">The ASP.NET application is not running at <see cref="F:System.Web.AspNetHostingPermissionLevel.Low" /> trust or higher.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="IsUserInRole">
      <MemberSignature Language="C#" Value="public override bool IsUserInRole (string username, string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool IsUserInRole(string username, string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.IsUserInRole(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function IsUserInRole (username As String, roleName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool IsUserInRole(System::String ^ username, System::String ^ roleName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">
          <span data-ttu-id="aa1d8-281">要搜尋的使用者名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-281">The user name to search for.</span>
          </span>
        </param>
        <param name="roleName">
          <span data-ttu-id="aa1d8-282">要搜尋的角色。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-282">The role to search in.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="aa1d8-283">取得值，指出指定使用者是否在指定的角色中。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-283">Gets a value indicating whether the specified user is in the specified role.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="aa1d8-284">如果指定使用者在指定的角色中，則為 <see langword="true" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-284">
              <see langword="true" /> if the specified user name is in the specified role; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-285"><xref:System.Web.Security.AuthorizationStoreRoleProvider.IsUserInRole%2A>方法透過呼叫<xref:System.Web.Security.Roles>類別和<xref:System.Security.Principal.IPrincipal.IsInRole%2A>方法<xref:System.Web.UI.Page.User%2A?displayProperty=nameWithType>屬性來決定使用者是否為 ASP.NET 應用程式中指定的授權管理員資料存放區中的角色相關聯組態檔 (Web.config)。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-285">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.IsUserInRole%2A> method is called by the <xref:System.Web.Security.Roles> class and the <xref:System.Security.Principal.IPrincipal.IsInRole%2A> method of the <xref:System.Web.UI.Page.User%2A?displayProperty=nameWithType> property to determine whether a user is associated with a role in the authorization-manager data store specified in the ASP.NET application's configuration file (Web.config).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-286">下列程式碼範例會以程式設計方式檢查登入的使用者是否在系統管理員角色中，然後才允許使用者檢視的使用者角色。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-286">The following code example programmatically checks to see whether the logged-on user is in the Administrators role before allowing the user to view user roles.</span></span> <span data-ttu-id="aa1d8-287">如需可讓您管理角色的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.AuthorizationStoreRoleProvider>。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-287">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.AuthorizationStoreRoleProvider>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/ViewRolescs.aspx#4)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/ViewRolesvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="aa1d8-288">
            <paramref name="username" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-288">
              <paramref name="username" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="aa1d8-289">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-289">-or</span>
          </span>
          <span data-ttu-id="aa1d8-290">
            <paramref name="roleName" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-290">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="aa1d8-291">
            <paramref name="roleName" /> 為空字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-291">
              <paramref name="roleName" /> is an empty string.</span>
          </span>
          <span data-ttu-id="aa1d8-292">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-292">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-293">
            <paramref name="roleName" /> 包含逗號。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-293">
              <paramref name="roleName" /> contains a comma.</span>
          </span>
          <span data-ttu-id="aa1d8-294">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-294">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-295">
            <paramref name="username" /> 包含逗號。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-295">
              <paramref name="username" /> contains a comma.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-296">找不到設定的 <see langword="applicationName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-296">The configured <see langword="applicationName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-297">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-297">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-298">找不到設定的 <see langword="scopeName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-298">The configured <see langword="scopeName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-299">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-299">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-300">授權管理員執行階段未安裝在伺服器上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-300">The authorization-manager runtime is not installed on the server.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="aa1d8-301">
            <see langword="connectionStringName" /> 屬性參考到不存在檔案的連接字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-301">The <see langword="connectionStringName" /> attribute references a connection string to a file that does not exist.</span>
          </span>
        </exception>
        <exception cref="T:System.Web.HttpException">
          <span data-ttu-id="aa1d8-302">
            <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體是使用檔案架構的原則存放區所設定，而且目前的信任層級不允許檔案的讀取權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-302">The <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance is configured with a file-based policy store, and read access to the file is not allowed at the current trust level.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="RemoveUsersFromRoles">
      <MemberSignature Language="C#" Value="public override void RemoveUsersFromRoles (string[] userNames, string[] roleNames);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void RemoveUsersFromRoles(string[] userNames, string[] roleNames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.RemoveUsersFromRoles(System.String[],System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub RemoveUsersFromRoles (userNames As String(), roleNames As String())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void RemoveUsersFromRoles(cli::array &lt;System::String ^&gt; ^ userNames, cli::array &lt;System::String ^&gt; ^ roleNames);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="userNames" Type="System.String[]" />
        <Parameter Name="roleNames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="userNames">
          <span data-ttu-id="aa1d8-303">要從指定角色中移除之使用者名稱的字串陣列。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-303">A string array of user names to be removed from the specified roles.</span>
          </span>
        </param>
        <param name="roleNames">
          <span data-ttu-id="aa1d8-304">要從中移除指定使用者名稱之角色名稱的字串陣列。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-304">A string array of role names to remove the specified user names from.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="aa1d8-305">從指定的角色移除指定的使用者名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-305">Removes the specified user names from the specified roles.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-306"><xref:System.Web.Security.AuthorizationStoreRoleProvider.RemoveUsersFromRoles%2A>方法透過呼叫<xref:System.Web.Security.Roles>從 ASP.NET 應用程式組態檔 (Web.config) 中指定的授權管理員原則存放區中的一個或多個角色移除一或多個使用者的類別。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-306">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.RemoveUsersFromRoles%2A> method is called by the <xref:System.Web.Security.Roles> class to remove one or more users from one or more roles in the authorization-manager policy store specified in the ASP.NET application's configuration file (Web.config).</span></span> <span data-ttu-id="aa1d8-307">這個方法會呼叫<xref:System.Web.Security.Roles.RemoveUserFromRole%2A>， <xref:System.Web.Security.Roles.RemoveUserFromRoles%2A>， <xref:System.Web.Security.Roles.RemoveUsersFromRole%2A>，和<xref:System.Web.Security.Roles.RemoveUsersFromRoles%2A>方法<xref:System.Web.Security.Roles>類別。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-307">This method is called by the <xref:System.Web.Security.Roles.RemoveUserFromRole%2A>, <xref:System.Web.Security.Roles.RemoveUserFromRoles%2A>, <xref:System.Web.Security.Roles.RemoveUsersFromRole%2A>, and <xref:System.Web.Security.Roles.RemoveUsersFromRoles%2A> methods of the <xref:System.Web.Security.Roles> class.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-308">下列程式碼範例將一個或多個使用者加入角色，或從角色移除使用者。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-308">The following code example adds one or more users to a role or removes a user from a role.</span></span> <span data-ttu-id="aa1d8-309">如需可讓您管理角色的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.AuthorizationStoreRoleProvider>。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-309">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.AuthorizationStoreRoleProvider>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/adduserstorolecs.aspx#3)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/adduserstorolevb.aspx#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="aa1d8-310">其中一個指定的使用者名稱為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-310">One of the specified user names is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="aa1d8-311">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-311">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-312">其中一個指定的角色名稱為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-312">One of the specified role names is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="aa1d8-313">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-313">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-314">
            <paramref name="userNames" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-314">
              <paramref name="userNames" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="aa1d8-315">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-315">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-316">
            <paramref name="roleNames" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-316">
              <paramref name="roleNames" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="aa1d8-317">其中一個指定的使用者名稱是空字串，或包含逗號。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-317">One of the specified user names is an empty string or contains a comma.</span>
          </span>
          <span data-ttu-id="aa1d8-318">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-318">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-319">其中一個指定的角色名稱是空字串，或包含逗號。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-319">One of the specified role names is an empty string or contains a comma.</span>
          </span>
          <span data-ttu-id="aa1d8-320">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-320">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-321">
            <paramref name="userNames" /> 包含重複的項目。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-321">
              <paramref name="userNames" /> contains a duplicate element.</span>
          </span>
          <span data-ttu-id="aa1d8-322">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-322">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-323">
            <paramref name="roleNames" /> 包含重複的項目。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-323">
              <paramref name="roleNames" /> contains a duplicate element.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-324">找不到設定的 <see langword="applicationName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-324">The configured <see langword="applicationName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-325">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-325">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-326">找不到設定的 <see langword="scopeName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-326">The configured <see langword="scopeName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-327">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-327">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-328">授權管理員執行階段未安裝在伺服器上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-328">The authorization-manager runtime is not installed on the server.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="aa1d8-329">
            <see langword="connectionStringName" /> 屬性參考到不存在檔案的連接字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-329">The <see langword="connectionStringName" /> attribute references a connection string to a file that does not exist.</span>
          </span>
        </exception>
        <exception cref="T:System.Web.HttpException">
          <span data-ttu-id="aa1d8-330">
            <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體是使用檔案架構的原則存放區所設定，而且目前的信任層級不允許檔案的讀取權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-330">The <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance is configured with a file-based policy store, and read access to the file is not allowed at the current trust level.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="RoleExists">
      <MemberSignature Language="C#" Value="public override bool RoleExists (string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool RoleExists(string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.AuthorizationStoreRoleProvider.RoleExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function RoleExists (roleName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool RoleExists(System::String ^ roleName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="aa1d8-331">要在授權管理員原則存放區中搜尋的角色名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-331">The name of the role to search for in the authorization-manager policy store.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="aa1d8-332">取得值，指出授權管理員原則存放區中是否已有指定的角色名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-332">Gets a value indicating whether the specified role name already exists in the authorization-manager policy store.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="aa1d8-333">如果授權管理員原則存放區中已經有角色名稱，則為 <see langword="true" />，否則為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-333">
              <see langword="true" /> if the role name already exists in the authorization-manager policy store; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-334"><xref:System.Web.Security.AuthorizationStoreRoleProvider.RoleExists%2A>方法透過呼叫<xref:System.Web.Security.Roles>類別以決定在 ASP.NET 應用程式組態檔 (Web.config) 中指定的資料存放區授權管理員角色名稱是否存在。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-334">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.RoleExists%2A> method is called by the <xref:System.Web.Security.Roles> class to determine whether a role name exists in the authorization-manager data store specified in the ASP.NET application's configuration file (Web.config).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aa1d8-335">下列程式碼範例使用<xref:System.Web.Security.Roles.RoleExists%2A>方法來判斷角色名稱是否已存在於之前建立的角色。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-335">The following code example uses the <xref:System.Web.Security.Roles.RoleExists%2A> method to determine whether a role name already exists before creating the role.</span></span> <span data-ttu-id="aa1d8-336">如需可讓您管理角色的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.AuthorizationStoreRoleProvider>。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-336">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.AuthorizationStoreRoleProvider>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/createrolecs.aspx#1)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/createrolevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="aa1d8-337">
            <paramref name="roleName" /> 為 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-337">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="aa1d8-338">
            <paramref name="roleName" /> 為空字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-338">
              <paramref name="roleName" /> is an empty string.</span>
          </span>
          <span data-ttu-id="aa1d8-339">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-339">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-340">
            <paramref name="roleName" /> 包含逗號。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-340">
              <paramref name="roleName" /> contains a comma.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="aa1d8-341">找不到設定的 <see langword="applicationName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-341">The configured <see langword="applicationName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-342">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-342">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-343">找不到設定的 <see langword="scopeName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-343">The configured <see langword="scopeName" /> was not found.</span>
          </span>
          <span data-ttu-id="aa1d8-344">-或-</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-344">-or-</span>
          </span>
          <span data-ttu-id="aa1d8-345">授權管理員執行階段未安裝在伺服器上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-345">The authorization-manager runtime is not installed on the server.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="aa1d8-346">
            <see langword="connectionStringName" /> 屬性參考到不存在檔案的連接字串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-346">The <see langword="connectionStringName" /> attribute references a connection string to a file that does not exist.</span>
          </span>
        </exception>
        <exception cref="T:System.Web.HttpException">
          <span data-ttu-id="aa1d8-347">
            <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> 執行個體是使用檔案架構的原則存放區所設定，而且目前的信任層級不允許檔案的讀取權限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-347">The <see cref="T:System.Web.Security.AuthorizationStoreRoleProvider" /> instance is configured with a file-based policy store, and read access to the file is not allowed at the current trust level.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ScopeName">
      <MemberSignature Language="C#" Value="public string ScopeName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ScopeName" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName" />
      <MemberSignature Language="VB.NET" Value="Public Property ScopeName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ScopeName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="aa1d8-348">取得或設定授權存放區的範圍名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-348">Gets or sets the scope name for the authorization store.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="aa1d8-349">授權存放區的範圍名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="aa1d8-349">The scope name for the authorization store.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aa1d8-350"><xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A>屬性可以使用設定`scopeName`中的提供者執行個體的組態屬性`providers`組態區段的區段。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-350">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A> property can be set using the `scopeName` configuration attribute for the provider instance in the `providers` section of the  configuration section.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="aa1d8-351">因為所有由提供服務的要求會使用單一預設角色提供者執行個體<xref:System.Web.HttpApplication>物件，您可以有多個要求同時執行，而且嘗試設定<xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A>屬性值。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-351">Because a single default role provider instance is used for all of the requests served by an <xref:System.Web.HttpApplication> object, you can have multiple requests executing concurrently and attempting to set the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A> property value.</span></span> <span data-ttu-id="aa1d8-352"><xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A>屬性不是執行緒安全的多個寫入，且變更<xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A>屬性值可能會導致非預期的行為時有多個應用程式的使用者。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-352">The <xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A> property is not thread safe for multiple writes, and changing the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A> property value can result in unexpected behavior when there are multiple users of an application.</span></span> <span data-ttu-id="aa1d8-353">我們建議您避免撰寫程式碼，讓使用者設定<xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A>屬性除非必要，否則。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-353">We recommend that you avoid writing code that allows users to set the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A> property unless you must.</span></span> <span data-ttu-id="aa1d8-354">應用程式的範例設定<xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A>屬性可能需要為系統管理的應用程式管理角色的多個應用程式的資料。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-354">An example of an application where setting the <xref:System.Web.Security.AuthorizationStoreRoleProvider.ScopeName%2A> property may be required is an administrative application that manages role data for multiple applications.</span></span> <span data-ttu-id="aa1d8-355">這類應用程式應該在單一使用者應用程式並不是 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="aa1d8-355">Such an application should be a single-user application and not a Web application.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>