<Type Name="ActiveDirectoryMembershipProvider" FullName="System.Web.Security.ActiveDirectoryMembershipProvider">
  <Metadata><Meta Name="ms.openlocfilehash" Value="ef60c94ed5cad241679e6411511e05473b61b9f0" /><Meta Name="ms.sourcegitcommit" Value="3efce15f3841385ee3ba24bd71ff0c0cf9a47815" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-TW" /><Meta Name="ms.lasthandoff" Value="04/03/2019" /><Meta Name="ms.locfileid" Value="58875316" /></Metadata><TypeSignature Language="C#" Value="public class ActiveDirectoryMembershipProvider : System.Web.Security.MembershipProvider" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit ActiveDirectoryMembershipProvider extends System.Web.Security.MembershipProvider" />
  <TypeSignature Language="DocId" Value="T:System.Web.Security.ActiveDirectoryMembershipProvider" />
  <TypeSignature Language="VB.NET" Value="Public Class ActiveDirectoryMembershipProvider&#xA;Inherits MembershipProvider" />
  <TypeSignature Language="C++ CLI" Value="public ref class ActiveDirectoryMembershipProvider : System::Web::Security::MembershipProvider" />
  <TypeSignature Language="F#" Value="type ActiveDirectoryMembershipProvider = class&#xA;    inherit MembershipProvider" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.Security.MembershipProvider</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="62543-101">管理 Active Directory 和 Active Directory 應用程式模式伺服器中 ASP.NET 應用程式之成員資格資訊的儲存。</span><span class="sxs-lookup"><span data-stu-id="62543-101">Manages storage of membership information for an ASP.NET application in Active Directory and Active Directory Application Mode servers.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-102">此類別由<xref:System.Web.Security.Membership>和<xref:System.Web.Security.MembershipUser>提供 ASP.NET 應用程式使用 Active Directory (AD) 或 Active Directory Application Mode (ADAM) 伺服器的成員資格服務的類別。</span><span class="sxs-lookup"><span data-stu-id="62543-102">This class is used by the <xref:System.Web.Security.Membership> and <xref:System.Web.Security.MembershipUser> classes to provide membership services for an ASP.NET application using an Active Directory (AD) or Active Directory Application Mode (ADAM) server.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62543-103">使用 ADAM 伺服器需要特定的組態。</span><span class="sxs-lookup"><span data-stu-id="62543-103">Using an ADAM server requires specific configuration.</span></span> <span data-ttu-id="62543-104">如需詳細資訊，請參閱下方的 [ADAM 組態] 區段。</span><span class="sxs-lookup"><span data-stu-id="62543-104">For more information, see the ADAM Configuration section below.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="62543-105"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體只適用於 ASP.NET 的完全信任原則預設設定。</span><span class="sxs-lookup"><span data-stu-id="62543-105">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance works only in the full-trust policy default configuration of ASP.NET.</span></span> <span data-ttu-id="62543-106">若要使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體在任何部分信任層級中，您必須以適當的信任原則檔案進行變更，您的應用程式或您必須建立已部署的 「 沙箱 」 組件在 GAC 中。</span><span class="sxs-lookup"><span data-stu-id="62543-106">In order to use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance at any partial-trust level, either you must make changes to the appropriate trust policy file for your application or you must create a "sandbox" assembly that is deployed in the GAC.</span></span>  
>   
>  <span data-ttu-id="62543-107"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會要求不受限制的<xref:System.DirectoryServices.DirectoryServicesPermission>執行權限。</span><span class="sxs-lookup"><span data-stu-id="62543-107">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class requires unrestricted <xref:System.DirectoryServices.DirectoryServicesPermission> permission to run.</span></span> <span data-ttu-id="62543-108">此權限不會加入至任何隨附 ASP.NET 部分信任原則檔案中。</span><span class="sxs-lookup"><span data-stu-id="62543-108">This permission is not added to any of the partial-trust policy files supplied with ASP.NET.</span></span> <span data-ttu-id="62543-109">雖然新增<xref:System.DirectoryServices.DirectoryServicesPermission>至部分信任原則檔案的權限可讓使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別，這麼做的話會<xref:System.DirectoryServices>可用在 ASP.NET 網頁中執行的任何程式碼的命名空間類別。</span><span class="sxs-lookup"><span data-stu-id="62543-109">Although adding the <xref:System.DirectoryServices.DirectoryServicesPermission> permission to a partial-trust policy file will enable use of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class, doing so makes the <xref:System.DirectoryServices> namespace classes available to any code running in your ASP.NET pages.</span></span> <span data-ttu-id="62543-110">此選項不需要在安全的鎖定模式中執行的任何 Web 伺服器的建議。</span><span class="sxs-lookup"><span data-stu-id="62543-110">This option is not recommended for any Web servers that need to run in a secure, locked-down mode.</span></span>  
>   
>  <span data-ttu-id="62543-111">或者，您可以建立 「 沙箱 」 組件呼叫<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別。</span><span class="sxs-lookup"><span data-stu-id="62543-111">As an alternative, you can create a "sandbox" assembly that calls the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span> <span data-ttu-id="62543-112">這個組件可以包含的包裝函式類別，將轉送的方法呼叫<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別或衍生自類別<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別。</span><span class="sxs-lookup"><span data-stu-id="62543-112">This assembly can contain either a wrapper class that forwards method calls to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class or a class that derives from the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span> <span data-ttu-id="62543-113">在任一情況下，包裝函式類別必須判斷提示不受限制<xref:System.DirectoryServices.DirectoryServicesPermission>權限。</span><span class="sxs-lookup"><span data-stu-id="62543-113">In either case, the wrapper class must assert unrestricted <xref:System.DirectoryServices.DirectoryServicesPermission> permission.</span></span> <span data-ttu-id="62543-114">部署在 GAC 中的沙箱組件，並將標示組件<xref:System.Security.AllowPartiallyTrustedCallersAttribute>(APTCA) 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-114">Deploy the sandbox assembly in the GAC and mark the assembly with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) attribute.</span></span> <span data-ttu-id="62543-115">這可讓部分信任的 ASP.NET 程式碼呼叫您的包裝函式類別，而且因為包裝函式類別在內部判斷提示不受限制<xref:System.DirectoryServices.DirectoryServicesPermission>權限，您的包裝函式類別都能夠成功呼叫提供者</span><span class="sxs-lookup"><span data-stu-id="62543-115">This will enable your partially trusted ASP.NET code to call your wrapper class, and since the wrapper class internally asserts the unrestricted <xref:System.DirectoryServices.DirectoryServicesPermission> permission, your wrapper class will be able to successfully call the provider</span></span>  
  
 <span data-ttu-id="62543-116">您必須建立[connectionStrings 項目 （ASP.NET 設定結構描述）](https://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de)識別 ADAM 来使用的應用程式磁碟分割、 Active Directory 網域，或是 Active Directory 伺服器的 Web.config 檔案中的項目。</span><span class="sxs-lookup"><span data-stu-id="62543-116">You must create a [connectionStrings Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de) entry in the Web.config file that identifies the Active Directory server, Active Directory domain, or ADAM application partition to use.</span></span> <span data-ttu-id="62543-117">提供者只會在網域範圍，或在網域內的子範圍。</span><span class="sxs-lookup"><span data-stu-id="62543-117">The provider will only operate at domain scope, or in a subscope within a domain.</span></span> <span data-ttu-id="62543-118">下表列出允許的連接字串和所使用的範圍。</span><span class="sxs-lookup"><span data-stu-id="62543-118">The following table lists allowed connection strings and the scope used.</span></span>  
  
|<span data-ttu-id="62543-119">連接字串</span><span class="sxs-lookup"><span data-stu-id="62543-119">Connection string</span></span>|<span data-ttu-id="62543-120">範圍</span><span class="sxs-lookup"><span data-stu-id="62543-120">Scope</span></span>|  
|-----------------------|-----------|  
|<span data-ttu-id="62543-121">LDAP: / /\<網域或伺服器 >: [連接埠]</span><span class="sxs-lookup"><span data-stu-id="62543-121">LDAP://\<domain or server>:[port]</span></span><br /><br /> <span data-ttu-id="62543-122">ADAM 的選擇性而不需要 Active Directory 的連接埠號碼。</span><span class="sxs-lookup"><span data-stu-id="62543-122">Port number is optional for ADAM and not needed for Active Directory.</span></span>|<span data-ttu-id="62543-123">提供者會針對指定的網域或伺服器執行。</span><span class="sxs-lookup"><span data-stu-id="62543-123">The provider runs against the specified domain or server.</span></span> <span data-ttu-id="62543-124">與 AD，使用者建立和刪除是在預設的 [使用者] 容器。</span><span class="sxs-lookup"><span data-stu-id="62543-124">With AD, user creation and deletion is done in the default users container.</span></span> <span data-ttu-id="62543-125">所有其他作業，包括任何搜尋方法，將根目錄的預設命名內容位於網域中。</span><span class="sxs-lookup"><span data-stu-id="62543-125">All other operations, including any search methods, will be rooted at the default naming context for the domain.</span></span><br /><br /> <span data-ttu-id="62543-126">如果連接字串指定了 Active Directory 網域，而不是特定伺服器和<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，則<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體一律都會連線至網域，以確保該密碼的 PDC 角色的伺服器變更生效，並使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>呼叫方法。</span><span class="sxs-lookup"><span data-stu-id="62543-126">If the connection string specifies an Active Directory domain rather than a specific server and the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will always connect to the server with the PDC role for the domain to ensure that password changes take effect and are available when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method is called.</span></span><br /><br /> <span data-ttu-id="62543-127">此連接字串時，不允許使用 ADAM，並將擲回<xref:System.NotSupportedException>。</span><span class="sxs-lookup"><span data-stu-id="62543-127">This connection string is not allowed when using ADAM, and will throw a <xref:System.NotSupportedException>.</span></span>|  
|<span data-ttu-id="62543-128">LDAP: / /\<網域或伺服器 >: [port] /\<容器 dn ></span><span class="sxs-lookup"><span data-stu-id="62543-128">LDAP://\<domain or server>:[port]/\<container dn></span></span><br /><br /> <span data-ttu-id="62543-129">ADAM 的選擇性而不需要 Active Directory 的連接埠號碼。</span><span class="sxs-lookup"><span data-stu-id="62543-129">Port number is optional for ADAM and not needed for Active Directory.</span></span>|<span data-ttu-id="62543-130">提供者會針對指定的網域或伺服器執行。</span><span class="sxs-lookup"><span data-stu-id="62543-130">The provider runs against the specified domain or server.</span></span> <span data-ttu-id="62543-131">使用者建立和刪除只會在指定的容器中完成。</span><span class="sxs-lookup"><span data-stu-id="62543-131">User creation and deletion is only done in the specified container.</span></span> <span data-ttu-id="62543-132">所有其他作業，包括任何搜尋方法，執行其根容器的樹狀子目錄搜尋。</span><span class="sxs-lookup"><span data-stu-id="62543-132">All other operations, including any search methods, perform subtree searches rooted at the container.</span></span><br /><br /> <span data-ttu-id="62543-133">ADAM 伺服器時，容器會指定應用程式分割或應用程式磁碟分割內的容器的根目錄。</span><span class="sxs-lookup"><span data-stu-id="62543-133">For ADAM servers, the container specifies the root of an application partition, or a container within an application partition.</span></span><br /><br /> <span data-ttu-id="62543-134">我們建議連接字串會定義特定的容器，以改善效能。</span><span class="sxs-lookup"><span data-stu-id="62543-134">We recommend that the connection string define a specific container to improve performance.</span></span>|  
  
 <span data-ttu-id="62543-135"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體會對應至 directory 屬性<xref:System.Web.Security.ActiveDirectoryMembershipUser>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-135">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance maps directory attributes to <xref:System.Web.Security.ActiveDirectoryMembershipUser> properties.</span></span> <span data-ttu-id="62543-136">如果沒有屬性對應是在 Web.config 檔案中，會使用預設屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-136">Default attributes are used if no attribute mapping is done in the Web.config file.</span></span> <span data-ttu-id="62543-137">如需有關屬性對應的詳細資訊，請參閱中的個別屬性<xref:System.Web.Security.ActiveDirectoryMembershipUser>類別文件。</span><span class="sxs-lookup"><span data-stu-id="62543-137">For more information on attribute mappings, see the individual properties in the <xref:System.Web.Security.ActiveDirectoryMembershipUser> class documentation.</span></span>  
  
 <span data-ttu-id="62543-138">下表列出<xref:System.Web.Security.ActiveDirectoryMembershipUser>屬性和其預設屬性對應。</span><span class="sxs-lookup"><span data-stu-id="62543-138">The following table lists the <xref:System.Web.Security.ActiveDirectoryMembershipUser> properties and their default attribute mappings.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="62543-139"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不會明確檢查提供者屬性不對應到使用者物件在目錄中的核心屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-139">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not explicitly check that provider attributes are not mapped to core attributes of the user object in the directory.</span></span> <span data-ttu-id="62543-140">您必須確保目錄中的機密資訊不會公開透過對應的屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-140">You must ensure that sensitive information from the directory is not exposed through mapped attributes.</span></span>  
  
|<span data-ttu-id="62543-141">屬性</span><span class="sxs-lookup"><span data-stu-id="62543-141">Property</span></span>|<span data-ttu-id="62543-142">預設目錄屬性</span><span class="sxs-lookup"><span data-stu-id="62543-142">Default directory attribute</span></span>|<span data-ttu-id="62543-143">可以對應嗎？</span><span class="sxs-lookup"><span data-stu-id="62543-143">Can be mapped?</span></span>|  
|--------------|---------------------------------|--------------------|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.ProviderUserKey%2A>|<span data-ttu-id="62543-144">securityIdentifier</span><span class="sxs-lookup"><span data-stu-id="62543-144">securityIdentifier</span></span>|<span data-ttu-id="62543-145">否</span><span class="sxs-lookup"><span data-stu-id="62543-145">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.UserName%2A>|<span data-ttu-id="62543-146">userPrincipalName</span><span class="sxs-lookup"><span data-stu-id="62543-146">userPrincipalName</span></span>|<span data-ttu-id="62543-147">是，但必須是 userPrincipalName 或 sAMAccountName</span><span class="sxs-lookup"><span data-stu-id="62543-147">Yes, but must be either userPrincipalName or sAMAccountName</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A>|<span data-ttu-id="62543-148">註解</span><span class="sxs-lookup"><span data-stu-id="62543-148">comment</span></span>|<span data-ttu-id="62543-149">否</span><span class="sxs-lookup"><span data-stu-id="62543-149">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.CreationDate%2A>|<span data-ttu-id="62543-150">whenCreated</span><span class="sxs-lookup"><span data-stu-id="62543-150">whenCreated</span></span>|<span data-ttu-id="62543-151">否</span><span class="sxs-lookup"><span data-stu-id="62543-151">No</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.Email%2A>|<span data-ttu-id="62543-152">郵件</span><span class="sxs-lookup"><span data-stu-id="62543-152">mail</span></span>|<span data-ttu-id="62543-153">是，但必須是 Unicode String 型別的單一值屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-153">Yes, but must be a single-valued attribute of type Unicode String.</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.LastActivityDate%2A>|<span data-ttu-id="62543-154">N/A</span><span class="sxs-lookup"><span data-stu-id="62543-154">n/a</span></span>|<span data-ttu-id="62543-155">不支援<xref:System.Web.Security.ActiveDirectoryMembershipProvider>。</span><span class="sxs-lookup"><span data-stu-id="62543-155">Not supported by <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A>|<span data-ttu-id="62543-156">N/A</span><span class="sxs-lookup"><span data-stu-id="62543-156">n/a</span></span>|<span data-ttu-id="62543-157">不支援<xref:System.Web.Security.ActiveDirectoryMembershipProvider>。</span><span class="sxs-lookup"><span data-stu-id="62543-157">Not supported by <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span></span>|  
|<xref:System.Web.Security.MembershipUser.LastPasswordChangedDate%2A>|<span data-ttu-id="62543-158">pwdLastSet</span><span class="sxs-lookup"><span data-stu-id="62543-158">pwdLastSet</span></span>|<span data-ttu-id="62543-159">否</span><span class="sxs-lookup"><span data-stu-id="62543-159">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.PasswordQuestion%2A>|<span data-ttu-id="62543-160">none</span><span class="sxs-lookup"><span data-stu-id="62543-160">none</span></span>|<span data-ttu-id="62543-161">是，但必須是 Unicode String 型別的單一值屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-161">Yes, but must be a single-valued attribute of type Unicode String.</span></span>|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.IsApproved%2A>|<span data-ttu-id="62543-162">使用者帳戶控制 (AD)</span><span class="sxs-lookup"><span data-stu-id="62543-162">User-Account-Control (AD)</span></span><br /><br /> <span data-ttu-id="62543-163">mDS Msds-useraccountdisabled (ADAM)</span><span class="sxs-lookup"><span data-stu-id="62543-163">mDS-UserAccountDisabled (ADAM)</span></span>|<span data-ttu-id="62543-164">否</span><span class="sxs-lookup"><span data-stu-id="62543-164">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.IsLockedOut%2A>|<span data-ttu-id="62543-165">計算從 lockoutTime 和 AD 的鎖定期間 (在 Windows 2000 上的 AD)</span><span class="sxs-lookup"><span data-stu-id="62543-165">computed from lockoutTime and the AD lockout duration (AD on Windows 2000)</span></span><br /><br /> <span data-ttu-id="62543-166">msDS-使用者-帳戶-控制項-計算 (AD Windows Server 2003)</span><span class="sxs-lookup"><span data-stu-id="62543-166">msDS-User-Account-Control-Computed (AD on Windows Server 2003)</span></span><br /><br /> <span data-ttu-id="62543-167">msDS-使用者-帳戶-控制項-計算 (ADAM)</span><span class="sxs-lookup"><span data-stu-id="62543-167">msDS-User-Account-Control-Computed (ADAM)</span></span>|<span data-ttu-id="62543-168">否</span><span class="sxs-lookup"><span data-stu-id="62543-168">No</span></span>|  
|<xref:System.Web.Security.MembershipUser.LastLockoutDate%2A>|<span data-ttu-id="62543-169">如果使用者因為不正確密碼嘗試次數過多而遭到鎖定，則會傳回鎖定時間屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-169">If user is locked out due to too many bad password attempts, the lockout time attribute is returned.</span></span><br /><br /> <span data-ttu-id="62543-170">如果使用者已遭鎖定，因為太多的不正確的密碼解答嘗試，所定義的屬性中儲存的值`attributeMapFailedPasswordAnswerLockoutTime`會傳回。</span><span class="sxs-lookup"><span data-stu-id="62543-170">If user is locked out due to too many bad password answer attempts, the value stored in the attribute defined by `attributeMapFailedPasswordAnswerLockoutTime` is returned.</span></span><br /><br /> <span data-ttu-id="62543-171">如果使用者已遭鎖定，因為發生錯誤的密碼和錯誤密碼嘗試次數過多，最新的日期/時間值會傳回。</span><span class="sxs-lookup"><span data-stu-id="62543-171">If user is locked out due to both a bad password and too many bad password attempts, the most recent date/time value is returned.</span></span><br /><br /> <span data-ttu-id="62543-172">若該帳戶並未鎖定，則傳回 1/1/1754 SQL 相容性。</span><span class="sxs-lookup"><span data-stu-id="62543-172">If the account is not locked out, return 1/1/1754 for SQL compatibility.</span></span>|<span data-ttu-id="62543-173">否</span><span class="sxs-lookup"><span data-stu-id="62543-173">No</span></span>|  
  
 <span data-ttu-id="62543-174">當同時<xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>和<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`、<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別支援密碼重設的安全性，藉由要求使用者回答預先決定的問題。</span><span class="sxs-lookup"><span data-stu-id="62543-174">When both the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> and <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> properties are `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class supports password-reset security by requiring the user to answer a predetermined question.</span></span> <span data-ttu-id="62543-175">若要支援的問題和解答，您必須設定使用的下列組態屬性[（ASP.NET 設定結構描述） 的成員資格提供者的 add 項目](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18)應用程式組態檔中。</span><span class="sxs-lookup"><span data-stu-id="62543-175">To support the question and answer, you must set the following configuration attributes using the [add Element for providers for membership (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) in the application configuration file.</span></span>  
  
|<span data-ttu-id="62543-176">組態屬性</span><span class="sxs-lookup"><span data-stu-id="62543-176">Configuration attribute</span></span>|<span data-ttu-id="62543-177">屬性類型</span><span class="sxs-lookup"><span data-stu-id="62543-177">Attribute type</span></span>|  
|-----------------------------|--------------------|  
|`attributeMapPasswordQuestion`|<span data-ttu-id="62543-178">必須是 Unicode String 型別的單一值屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-178">Must be a single-valued attribute of type Unicode String.</span></span>|  
|`attributeMapPasswordAnswer`|<span data-ttu-id="62543-179">必須是 Unicode String 型別的單一值屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-179">Must be a single-valued attribute of type Unicode String.</span></span>|  
|`attributeMapFailedPasswordAnswerCount`|<span data-ttu-id="62543-180">必須是整數類型的單一值屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-180">Must be a single-valued attribute of type Integer.</span></span>|  
|`attributeMapFailedPasswordAnswerTime`|<span data-ttu-id="62543-181">必須是類型大的整數間隔的單一值屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-181">Must be a single-valued attribute of type Large Integer/Interval.</span></span>|  
|`attributeMapFailedPasswordAnswerLockoutTime`|<span data-ttu-id="62543-182">必須是類型大的整數間隔的單一值屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-182">Must be a single-valued attribute of type Large Integer/Interval.</span></span>|  
  
 <span data-ttu-id="62543-183">如需有關使用密碼重設安全性的詳細資訊，請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-183">For more information on using password-reset security, see the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property.</span></span>  
  
## <a name="active-directory-connections"></a><span data-ttu-id="62543-184">Active Directory 連線</span><span class="sxs-lookup"><span data-stu-id="62543-184">Active Directory connections</span></span>  
 <span data-ttu-id="62543-185">當<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別用來連線到 Active Directory 或 Active Directory Application Mode (ADAM) 伺服器，`connectionProtection`屬性已設定使用[（ASP.NET 設定結構描述） 的成員資格提供者的 add 項目](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18)在應用程式組態檔可能會限制的作業類型<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別可以透過連接執行。</span><span class="sxs-lookup"><span data-stu-id="62543-185">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is used to connect to an Active Directory or an Active Directory Application Mode (ADAM) server, the `connectionProtection` attribute that is set using the [add Element for providers for membership (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) in the application configuration file may restrict the types of operations the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class can perform over the connection.</span></span> <span data-ttu-id="62543-186">`connectionProtection`屬性也會決定方法<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將用來建立 Active Directory 或 ADAM 伺服器的連線。</span><span class="sxs-lookup"><span data-stu-id="62543-186">The `connectionProtection` attribute also determines the methods the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will use to create the connection to the Active Directory or ADAM server.</span></span>  
  
 <span data-ttu-id="62543-187">下表顯示的效果`connectionProtection`屬性時，連線到 Active Directory。</span><span class="sxs-lookup"><span data-stu-id="62543-187">The following table shows the effect of the `connectionProtection` attribute when connecting to an Active Directory.</span></span>  
  
|`connectionProtection` <span data-ttu-id="62543-188">設定</span><span class="sxs-lookup"><span data-stu-id="62543-188">setting</span></span>|<span data-ttu-id="62543-189">作用</span><span class="sxs-lookup"><span data-stu-id="62543-189">Effect</span></span>|  
|------------------------------------|------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<span data-ttu-id="62543-190"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將會連線到 Active Directory，這些限制。</span><span class="sxs-lookup"><span data-stu-id="62543-190">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will connect to an Active Directory, with these restrictions.</span></span><br /><br /> <span data-ttu-id="62543-191">-設定密碼任何方法將會失敗。</span><span class="sxs-lookup"><span data-stu-id="62543-191">-   Any method that sets a password will fail.</span></span> <span data-ttu-id="62543-192">變更密碼時，active Directory 需要安全連線。</span><span class="sxs-lookup"><span data-stu-id="62543-192">Active Directory requires a secure connection when changing passwords.</span></span><br /><span data-ttu-id="62543-193">-您必須明確設定`connectionUsername`並`connectionPassword`屬性使用[（ASP.NET 設定結構描述） 的成員資格提供者的 add 項目](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18)應用程式組態檔中; 否則<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將會擲回<xref:System.Configuration.Provider.ProviderException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="62543-193">-   You must explicitly set the `connectionUsername` and `connectionPassword` attributes using the [add Element for providers for membership (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) in the application configuration file; otherwise, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will throw a <xref:System.Configuration.Provider.ProviderException> exception.</span></span>|  
|`Secure`|<span data-ttu-id="62543-194"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會嘗試連線到 Active Directory 使用 SSL。</span><span class="sxs-lookup"><span data-stu-id="62543-194">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will attempt to connect to Active Directory using SSL.</span></span> <span data-ttu-id="62543-195">如果 SSL 失敗，將會進行第二個嘗試連線到 Active Directory 使用標誌及徽章。</span><span class="sxs-lookup"><span data-stu-id="62543-195">If SSL fails, a second attempt to connect to Active Directory using sign-and-seal will be made.</span></span> <span data-ttu-id="62543-196">如果這兩個嘗試都失敗，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將會擲回<xref:System.Configuration.Provider.ProviderException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="62543-196">If both attempts fail, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will throw a <xref:System.Configuration.Provider.ProviderException> exception.</span></span><br /><br /> <span data-ttu-id="62543-197">支援的程序認證和明確的認證。</span><span class="sxs-lookup"><span data-stu-id="62543-197">Both process credentials and explicit credentials are supported.</span></span>|  
  
 <span data-ttu-id="62543-198">下表顯示的效果`connectionProtection`屬性連接至 ADAM 伺服器時。</span><span class="sxs-lookup"><span data-stu-id="62543-198">The following table shows the effect of the `connectionProtection` attribute when connecting to an ADAM server.</span></span>  
  
|`connectionProtection` <span data-ttu-id="62543-199">設定</span><span class="sxs-lookup"><span data-stu-id="62543-199">setting</span></span>|<span data-ttu-id="62543-200">作用</span><span class="sxs-lookup"><span data-stu-id="62543-200">Effect</span></span>|  
|------------------------------------|------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<span data-ttu-id="62543-201"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將會連接至 ADAM 伺服器，但有此限制。</span><span class="sxs-lookup"><span data-stu-id="62543-201">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will connect to an ADAM server, with this restriction.</span></span><br /><br /> <span data-ttu-id="62543-202">-除非您明確設定 ADAM 伺服器，以允許傳送和變更透過不安全連線的密碼，將會失敗任何方法，以設定密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-202">-   Any method that sets passwords will fail unless you explicitly configure the ADAM server to allow passwords to be sent and changed over an insecure connection.</span></span><br /><br /> <span data-ttu-id="62543-203">支援的程序認證和明確的認證。</span><span class="sxs-lookup"><span data-stu-id="62543-203">Both process credentials and explicit credentials are supported.</span></span>|  
|`Secure`|<span data-ttu-id="62543-204"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會嘗試連線到 ADAM 伺服器使用 SSL。</span><span class="sxs-lookup"><span data-stu-id="62543-204">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will attempt to connect to the ADAM server using SSL.</span></span> <span data-ttu-id="62543-205">無法建立連線，如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將會擲回<xref:System.Configuration.Provider.ProviderException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="62543-205">If a connection cannot be made, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will throw a <xref:System.Configuration.Provider.ProviderException> exception.</span></span><br /><br /> <span data-ttu-id="62543-206">支援的程序認證和明確的認證。</span><span class="sxs-lookup"><span data-stu-id="62543-206">Both process credentials and explicit credentials are supported.</span></span>|  
  
## <a name="adam-configuration"></a><span data-ttu-id="62543-207">ADAM 設定</span><span class="sxs-lookup"><span data-stu-id="62543-207">ADAM Configuration</span></span>  
 <span data-ttu-id="62543-208">Instance služby ADAM 使用 ADAM 伺服器時，必須包含定義的結構描述`User`類別。</span><span class="sxs-lookup"><span data-stu-id="62543-208">When using an ADAM server, the ADAM instance must contain a schema that defines the `User` class.</span></span> <span data-ttu-id="62543-209">您可以匯入`User`LDIF 匯入類別`MS-User.ldf`ADAM 安裝目錄中，您可使用的檔案。</span><span class="sxs-lookup"><span data-stu-id="62543-209">You can import the `User` class with an LDIF import of the `MS-User.ldf` file available in the ADAM install directory.</span></span>  
  
 <span data-ttu-id="62543-210"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別適用於與 ADAM 伺服器設定為使用預設的網路連接埠。</span><span class="sxs-lookup"><span data-stu-id="62543-210">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will work with an ADAM server configured to use the default network ports.</span></span> <span data-ttu-id="62543-211">下表顯示預期的 ADAM 伺服器的預設值。</span><span class="sxs-lookup"><span data-stu-id="62543-211">The following table shows the defaults expected for the ADAM server.</span></span>  
  
|<span data-ttu-id="62543-212">connectionProtection 設定</span><span class="sxs-lookup"><span data-stu-id="62543-212">connectionProtection setting</span></span>|<span data-ttu-id="62543-213">預期的 ADAM 連接埠</span><span class="sxs-lookup"><span data-stu-id="62543-213">Expected ADAM port</span></span>|  
|----------------------------------|------------------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<span data-ttu-id="62543-214">389</span><span class="sxs-lookup"><span data-stu-id="62543-214">389</span></span>|  
|`Secure`|<span data-ttu-id="62543-215">636</span><span class="sxs-lookup"><span data-stu-id="62543-215">636</span></span>|  
  
 <span data-ttu-id="62543-216">如果您的 ADAM 伺服器不使用預設連接埠，請參閱文章 Q817583，「 Active Directory 服務不會透過 SSL 連線，要求安全的授權 」 中[Microsoft Knowledge Base](https://go.microsoft.com/fwlink/?linkid=37115)。</span><span class="sxs-lookup"><span data-stu-id="62543-216">If your ADAM server is not using the default ports, see article Q817583, "Active Directory Services does not request secure authorization over an SSL connection," in the [Microsoft Knowledge Base](https://go.microsoft.com/fwlink/?linkid=37115).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-217">下列程式碼範例顯示設定為使用 ASP.NET 應用程式的 Web.config 檔案<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-217">The following code examples show the Web.config file for an ASP.NET application configured to use an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance.</span></span> <span data-ttu-id="62543-218">第一個範例會使用預設對應的 Active Directory 屬性，並不支援密碼重設安全性問題答案，也不能呼叫搜尋方法。</span><span class="sxs-lookup"><span data-stu-id="62543-218">The first example uses the default mappings for Active Directory attributes, and does not support password-reset security with question-and-answer nor the ability to call search methods.</span></span> <span data-ttu-id="62543-219">第二個範例會示範所允許的所有屬性設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-219">The second example shows all the attribute settings allowed for an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance.</span></span>  
  
 <span data-ttu-id="62543-220">第一個範例是簡單的組態檔使用的 Active Directory 屬性的預設對應。</span><span class="sxs-lookup"><span data-stu-id="62543-220">The first example is a simple configuration file using default mappings for Active Directory attributes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 <span data-ttu-id="62543-221">此範例示範的所有屬性設定可供使用的執行個體<xref:System.Web.Security.ActiveDirectoryMembershipProvider>。</span><span class="sxs-lookup"><span data-stu-id="62543-221">This example shows all of the attribute settings that are available for an instance of <xref:System.Web.Security.ActiveDirectoryMembershipProvider>.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership  
      defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"  
          type="System.Web.Security.ActiveDirectoryMembershipProvider,  
          System.Web, Version=1.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionStringName="ADService"  
          connectionUsername="UserWithAppropriateRights"  
          connectionPassword="PasswordForUser"  
          connectionProtection="Secure"  
          enablePasswordReset="true"  
          enableSearchMethods="true"  
          requiresQuestionAndAnswer="true"  
          applicationName="/"  
          description="Default AD connection"  
          requiresUniqueEmail="false"  
          clientSearchTimeout="30"  
          serverSearchTimeout="30"  
          timeoutUnit="Minutes"  
          attributeMapPasswordQuestion="department"  
          attributeMapPasswordAnswer="division"  
          attributeMapFailedPasswordAnswerCount="singleIntAttribute"  
         attributeMapFailedPasswordAnswerTime="singleLargeIntAttribute"  
         attributeMapFailedPasswordAnswerLockoutTime="singleLargeIntAttribute"  
          attributeMapEmail = "mail"  
          attributeMapUsername = "userPrincipalName"  
          maxInvalidPasswordAttempts = "5"  
          passwordAttemptWindow = "10"  
          passwordAnswerAttemptLockoutDuration = "30"  
          minRequiredPasswordLength="7"  
          minRequiredNonalphanumericCharacters="1"  
          passwordStrengthRegularExpression="  
          @\"(?=.{6,})(?=(.*\d){1,})(?=(.*\W){1,})" />  
        />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 `clientSearchTimeout` <span data-ttu-id="62543-222">和`serverSearchTimeout`為分鐘的預設值。</span><span class="sxs-lookup"><span data-stu-id="62543-222">and `serverSearchTimeout` default to minutes.</span></span> <span data-ttu-id="62543-223">若要變更的單位，請設定`timeoutUnit`"Days"、"Hours"、"Minutes"、"Seconds"或 「 毫秒 」 的其中一個屬性值。</span><span class="sxs-lookup"><span data-stu-id="62543-223">To change the units, set the `timeoutUnit` attribute value to one of "Days", "Hours", "Minutes", "Seconds", or "Milliseconds".</span></span> <span data-ttu-id="62543-224">如果未指定屬性，預設值是 「 分鐘 」。</span><span class="sxs-lookup"><span data-stu-id="62543-224">If the attribute is not specified, the default is "Minutes".</span></span>  
  
 ]]></format>
    </remarks>
    <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-225">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-225">Introduction to ASP.NET Membership</span></span></related>
    <related type="ExternalDocumentation" href="https://go.microsoft.com/fwlink/?linkid=149233"><span data-ttu-id="62543-226">HOW TO：使用 ASP.NET 2.0 中的成員資格</span><span class="sxs-lookup"><span data-stu-id="62543-226">How to: Use Membership in ASP.NET 2.0</span></span></related>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ActiveDirectoryMembershipProvider ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; ActiveDirectoryMembershipProvider();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="62543-227">建立 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-227">Creates a new instance of the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-228"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>建構函式由 ASP.NET 呼叫來建立的執行個體<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別做為應用程式組態中指定。</span><span class="sxs-lookup"><span data-stu-id="62543-228">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> constructor is called by ASP.NET to create an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class as specified in the configuration for the application.</span></span> <span data-ttu-id="62543-229">這個建構函式不是從您的程式碼使用。</span><span class="sxs-lookup"><span data-stu-id="62543-229">This constructor is not intended to be used from your code.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-230">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-230">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public override string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-231">使用自訂成員資格提供者的應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-231">The name of the application using the custom membership provider.</span></span></summary>
        <value><span data-ttu-id="62543-232">使用自訂成員資格提供者的應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-232">The name of the application using the custom membership provider.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-233"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName%2A>屬性可以設定為 ASP.NET 應用程式的名稱; 不過，應用程式名稱不是由<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別。</span><span class="sxs-lookup"><span data-stu-id="62543-233">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName%2A> property can be set to the name of the ASP.NET application; however, the application name is not used by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span>  
  
 <span data-ttu-id="62543-234">因此，不同於其他<xref:System.Web.Security.MembershipProvider>實作中，所有的 ASP.NET 應用程式存取相同的 Active Directory 資料存放區，一律會共用相同的使用者資料。</span><span class="sxs-lookup"><span data-stu-id="62543-234">Therefore, unlike other <xref:System.Web.Security.MembershipProvider> implementations, all ASP.NET applications that access the same Active Directory data store will always share the same user data.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="62543-235">已嘗試設定 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-235">An attempt was made to set the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> property.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-236">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> 執行個體之前，已先嘗試存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-236">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="ChangePassword">
      <MemberSignature Language="C#" Value="public override bool ChangePassword (string username, string oldPassword, string newPassword);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ChangePassword(string username, string oldPassword, string newPassword) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ChangePassword (username As String, oldPassword As String, newPassword As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ChangePassword(System::String ^ username, System::String ^ oldPassword, System::String ^ newPassword);" />
      <MemberSignature Language="F#" Value="override this.ChangePassword : string * string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ChangePassword (username, oldPassword, newPassword)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="oldPassword" Type="System.String" />
        <Parameter Name="newPassword" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="62543-237">要更新密碼之使用者的名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-237">The name of the user to update the password for.</span></span></param>
        <param name="oldPassword"><span data-ttu-id="62543-238">指定之使用者目前的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-238">The current password for the specified user.</span></span></param>
        <param name="newPassword"><span data-ttu-id="62543-239">指定之使用者的新密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-239">The new password for the specified user.</span></span></param>
        <summary><span data-ttu-id="62543-240">變更指定之使用者的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-240">Changes the password for the specified user.</span></span></summary>
        <returns><see langword="true" /> <span data-ttu-id="62543-241">如果密碼已成功更新；否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-241">if the password was updated successfully; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-242"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A>方法用來更新 Active Directory 資料存放區中的使用者的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-242">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A> method is used to update the user's password in the Active Directory data store.</span></span> <span data-ttu-id="62543-243">不論認證所<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體設定為使用中，提供者連接到 Active Directory 伺服器中使用`username`和`oldPassword`與連線認證參數。</span><span class="sxs-lookup"><span data-stu-id="62543-243">Regardless of the credentials that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance is configured to use, the provider connects to the Active Directory server using the `username` and `oldPassword` parameters as the connection credentials.</span></span>  
  
 <span data-ttu-id="62543-244">如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，使用者無法變更他或她的密碼，如果先前鎖定的帳戶，因為進行太多使用者會嘗試回答密碼問題。</span><span class="sxs-lookup"><span data-stu-id="62543-244">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user cannot change his or her password if the account was previously locked because the user made too many attempts to answer the password question.</span></span> <span data-ttu-id="62543-245">使用者必須等候中指定的分鐘數<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性，才能變更密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-245">The user will need to wait the number of minutes specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property before changing the password.</span></span>  
  
 <span data-ttu-id="62543-246">如果成功變更密碼並<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，則會重設使用者的密碼不正確的答案追蹤計數器。</span><span class="sxs-lookup"><span data-stu-id="62543-246">If the password change succeeds and the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, then the user's bad password answer tracking counters are reset.</span></span>  
  
 <span data-ttu-id="62543-247">提供者會尋找要更新的連接字串中指定的搜尋點啟動的使用者名稱的樹狀子目錄搜尋的使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-247">The provider finds the user instance to update by performing a subtree search for the user name starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-248">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-248">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="62543-249">若要變更的 Active Directory 伺服器上的密碼`connectionProtection`屬性必須設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>。</span><span class="sxs-lookup"><span data-stu-id="62543-249">To change passwords on an Active Directory server the `connectionProtection` attribute must be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span></span>  
  
 <span data-ttu-id="62543-250">使用了 ADAM 伺服器，當`connectionProtection`屬性可以設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>，但只有在您明確設定 ADAM 伺服器以允許透過不安全連線的密碼變更。</span><span class="sxs-lookup"><span data-stu-id="62543-250">When using an ADAM server, the `connectionProtection` attribute can be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, but only if you explicitly configure the ADAM server to allow password change over unsecured connections.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> <span data-ttu-id="62543-251">為空白，或是超過使用者名稱的長度上限 (通常是 256 個字元)。</span><span class="sxs-lookup"><span data-stu-id="62543-251">is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="62543-252">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-252">-or-</span></span> 
 <paramref name="username" /> <span data-ttu-id="62543-253">包含逗號。</span><span class="sxs-lookup"><span data-stu-id="62543-253">contains commas.</span></span>  
  
<span data-ttu-id="62543-254">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-254">-or-</span></span> 
<span data-ttu-id="62543-255">使用者名稱會對應到 <see langword="userPrincipalName" /> 屬性，且 <paramref name="username" /> 參數會包含反斜線。</span><span class="sxs-lookup"><span data-stu-id="62543-255">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.</span></span>  
  
<span data-ttu-id="62543-256">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-256">-or-</span></span> 
 <paramref name="oldPassword" /> <span data-ttu-id="62543-257">或 <paramref name="newPassword" /> 是長度為零的字串。</span><span class="sxs-lookup"><span data-stu-id="62543-257">or <paramref name="newPassword" /> is a zero-length string.</span></span>  
  
<span data-ttu-id="62543-258">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-258">-or-</span></span> 
 <paramref name="oldPassword" /> <span data-ttu-id="62543-259">或 <paramref name="newPassword" /> 超過密碼長度上限 (通常是 128 個字元)。</span><span class="sxs-lookup"><span data-stu-id="62543-259">or <paramref name="newPassword" /> exceeds the maximum password length (usually 128 characters).</span></span>  
  
<span data-ttu-id="62543-260">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-260">-or-</span></span> 
 <paramref name="newPassword" /> <span data-ttu-id="62543-261">小於 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> 屬性中指定的密碼大小下限</span><span class="sxs-lookup"><span data-stu-id="62543-261">is less than the minimum password size specified in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> property</span></span> 
<span data-ttu-id="62543-262">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-262">-or-</span></span> 
 <paramref name="newPassword" /> <span data-ttu-id="62543-263">包含少於 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> 屬性中所指定的非字母字元數。</span><span class="sxs-lookup"><span data-stu-id="62543-263">contains fewer than the number of non-alphabetic characters specified in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> property.</span></span>  
  
<span data-ttu-id="62543-264">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-264">-or-</span></span> 
 <paramref name="newPassword" /> <span data-ttu-id="62543-265">無法通過 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> 屬性中所定義規則運算式的驗證。</span><span class="sxs-lookup"><span data-stu-id="62543-265">fails validation by the regular expression defined in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> property.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> <span data-ttu-id="62543-266">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-266">is <see langword="null" />.</span></span>  
  
<span data-ttu-id="62543-267">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-267">-or-</span></span> 
 <paramref name="oldPassword" /> <span data-ttu-id="62543-268">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-268">is <see langword="null" />.</span></span>  
  
<span data-ttu-id="62543-269">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-269">-or-</span></span> 
 <paramref name="newPassword" /> <span data-ttu-id="62543-270">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-270">is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Web.Security.MembershipPasswordException"><paramref name="newPassword" /> <span data-ttu-id="62543-271">不符合 Active Directory 伺服器定義的複雜度需求。</span><span class="sxs-lookup"><span data-stu-id="62543-271">does not meet the complexity requirements defined by the Active Directory server.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="62543-272">無法建立至 Active Directory 應用程式模式伺服器的安全連接。</span><span class="sxs-lookup"><span data-stu-id="62543-272">A secure connection could not be made to an Active Directory Application Mode server.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-273"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-273">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.Exception"><span data-ttu-id="62543-274">發生未處理的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="62543-274">An unhandled exception occurred.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-275">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-275">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ChangePasswordQuestionAndAnswer">
      <MemberSignature Language="C#" Value="public override bool ChangePasswordQuestionAndAnswer (string username, string password, string newPasswordQuestion, string newPasswordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ChangePasswordQuestionAndAnswer(string username, string password, string newPasswordQuestion, string newPasswordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ChangePasswordQuestionAndAnswer (username As String, password As String, newPasswordQuestion As String, newPasswordAnswer As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ChangePasswordQuestionAndAnswer(System::String ^ username, System::String ^ password, System::String ^ newPasswordQuestion, System::String ^ newPasswordAnswer);" />
      <MemberSignature Language="F#" Value="override this.ChangePasswordQuestionAndAnswer : string * string * string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer (username, password, newPasswordQuestion, newPasswordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="newPasswordQuestion" Type="System.String" />
        <Parameter Name="newPasswordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="62543-276">要為其變更密碼問題和解答的使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-276">The user to change the password question and answer for.</span></span></param>
        <param name="password"><span data-ttu-id="62543-277">指定之使用者的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-277">The password for the specified user.</span></span></param>
        <param name="newPasswordQuestion"><span data-ttu-id="62543-278">指定之使用者的新密碼問題。</span><span class="sxs-lookup"><span data-stu-id="62543-278">The new password question for the specified user.</span></span></param>
        <param name="newPasswordAnswer"><span data-ttu-id="62543-279">指定之使用者的新密碼解答。</span><span class="sxs-lookup"><span data-stu-id="62543-279">The new password answer for the specified user.</span></span></param>
        <summary><span data-ttu-id="62543-280">為 Active Directory 存放區中的使用者更新密碼問題與解答。</span><span class="sxs-lookup"><span data-stu-id="62543-280">Updates the password question and answer for a user in the Active Directory store.</span></span></summary>
        <returns><see langword="true" /> <span data-ttu-id="62543-281">如果更新已成功；否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-281">if the update was successful; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="62543-282">如果密碼不正確、使用者遭到鎖定，或者 Active Directory 資料存放區中沒有該使用者，也會傳回 <see langword="false" /> 值。</span><span class="sxs-lookup"><span data-stu-id="62543-282">A value of <see langword="false" /> is also returned if the password is incorrect, the user is locked out, or the user does not exist in the Active Directory data store.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-283">方法會呼叫<xref:System.Web.Security.ActiveDirectoryMembershipUser>類別來更新密碼問題和解答，以便在 Active Directory 成員資格儲存區中的使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-283">The method is called by the <xref:System.Web.Security.ActiveDirectoryMembershipUser> class to update the password question and answer for a user in the Active Directory membership store.</span></span>  
  
 <span data-ttu-id="62543-284">重設使用者的密碼時，需要密碼問題和答案提供一層額外的安全性。</span><span class="sxs-lookup"><span data-stu-id="62543-284">Requiring a password question and answer provides an additional layer of security when resetting a user's password.</span></span> <span data-ttu-id="62543-285">建立使用者名稱時，使用者可以提供一組問題和解答，稍後可以用來重設遺忘的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-285">When creating a user name, a user can supply a question and answer that can later be used to reset a forgotten password.</span></span> <span data-ttu-id="62543-286"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A>方法更新密碼問題和成員資格使用者的回應為新的值。</span><span class="sxs-lookup"><span data-stu-id="62543-286">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> method updates the password question and answer for a membership user to new values.</span></span>  
  
 <span data-ttu-id="62543-287">若要使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A>方法中，您必須在您的應用程式組態檔中設定這些額外的屬性：</span><span class="sxs-lookup"><span data-stu-id="62543-287">In order to use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> method, you must set these additional attributes in your application's configuration file:</span></span>  
  
-   `requiresQuestionAndAnswer` <span data-ttu-id="62543-288">必須是</span><span class="sxs-lookup"><span data-stu-id="62543-288">must be</span></span> `true.`  
  
-   `attributeMapPasswordQuestion` <span data-ttu-id="62543-289">和`attributeMapPasswordAnswer`必須對應到 Active Directory 結構描述中的屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-289">and `attributeMapPasswordAnswer` must be mapped to attributes in the Active Directory schema.</span></span>  
  
 <span data-ttu-id="62543-290">如果不符合上述準則，<xref:System.Configuration.Provider.ProviderException>在初始化時擲回。</span><span class="sxs-lookup"><span data-stu-id="62543-290">If the above criteria are not met, a <xref:System.Configuration.Provider.ProviderException> is thrown at initialization.</span></span>  
  
 <span data-ttu-id="62543-291"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體連接到 Active Directory 資料存放區中提供的認證`username`和`password`參數來驗證使用者名稱/密碼組合。</span><span class="sxs-lookup"><span data-stu-id="62543-291">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance connects to the Active Directory data store with the credentials provided in the `username` and `password` parameters to validate the user name/password combination.</span></span> <span data-ttu-id="62543-292">設定的連線認證提供者會執行實際更新的問題和解答。</span><span class="sxs-lookup"><span data-stu-id="62543-292">The actual update of the question and answer is performed with the configured connection credentials of the provider.</span></span>  
  
 <span data-ttu-id="62543-293">如果不正確的密碼提供給<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A>方法中，目錄伺服器會遞增的計數器可追蹤無效的密碼嘗試次數。</span><span class="sxs-lookup"><span data-stu-id="62543-293">If an incorrect password is supplied to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A> method, the directory server will increment the counters that track invalid password attempts.</span></span> <span data-ttu-id="62543-294">這會導致使用者遭到鎖定，無法登入之前的鎖定狀態，以清除呼叫<xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A>方法或指定目錄中的鎖定持續時間。</span><span class="sxs-lookup"><span data-stu-id="62543-294">This can result in the user being locked and unable to log on until either the lock status is cleared by a call to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A> method or the locked duration specified in the directory passes.</span></span>  
  
 <span data-ttu-id="62543-295">如果到的問題和解答更新成功，<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`、 追蹤使用者的密碼不正確的答案會重設計數器。</span><span class="sxs-lookup"><span data-stu-id="62543-295">If the update to the question and answer succeeds and the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user's bad password answer tracking counters are reset.</span></span>  
  
 <span data-ttu-id="62543-296">使用加密的密碼解答<xref:System.Web.Security.MembershipProvider.EncryptPassword%2A>方法之前會儲存在 Active Directory 資料存放區。</span><span class="sxs-lookup"><span data-stu-id="62543-296">The password answer is encrypted using the <xref:System.Web.Security.MembershipProvider.EncryptPassword%2A> method before it is stored in the Active Directory data store.</span></span> <span data-ttu-id="62543-297">所指定的加密金鑰和演算法[machineKey 項目 （ASP.NET 設定結構描述）](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46)組態項目。</span><span class="sxs-lookup"><span data-stu-id="62543-297">The encryption key and algorithm are specified by the [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) configuration element.</span></span> <span data-ttu-id="62543-298">解密屬性[machineKey 項目 （ASP.NET 設定結構描述）](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46)必須指定項目，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不支援自動產生的加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="62543-298">The decryption attribute on the [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) element must be specified, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support auto-generated encryption keys.</span></span>  
  
 <span data-ttu-id="62543-299">密碼問題的最大長度為 256 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-299">The maximum length for the password question is 256 characters.</span></span> <span data-ttu-id="62543-300">密碼解答的最大長度為 128 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-300">The maximum length for the password answer is 128 characters.</span></span>  
  
 <span data-ttu-id="62543-301">前置和尾端空格，會刪減除外的所有參數值`password`。</span><span class="sxs-lookup"><span data-stu-id="62543-301">Leading and trailing spaces are trimmed from all parameter values except for `password`.</span></span>  
  
 <span data-ttu-id="62543-302">提供者會尋找要更新的連接字串中指定的搜尋點啟動的使用者名稱的樹狀子目錄搜尋的使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-302">The provider finds the user instance to update by performing a subtree search for the user name starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-303">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-303">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="62543-304">系統管理員尚未將密碼問題與解答欄位對應至 Active Directory 結構描述的屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-304">The administrator has not mapped the password question-and-answer fields to attributes of the Active Directory schema.</span></span></exception>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> <span data-ttu-id="62543-305">為空白，或是超過使用者名稱的長度上限 (通常是 256 個字元)。</span><span class="sxs-lookup"><span data-stu-id="62543-305">is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="62543-306">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-306">-or-</span></span> 
 <paramref name="username" /> <span data-ttu-id="62543-307">包含逗號。</span><span class="sxs-lookup"><span data-stu-id="62543-307">contains commas.</span></span>  
  
<span data-ttu-id="62543-308">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-308">-or-</span></span> 
<span data-ttu-id="62543-309">使用者名稱會對應到 <see langword="userPrincipalName" /> 屬性，且 <paramref name="username" /> 參數會包含反斜線。</span><span class="sxs-lookup"><span data-stu-id="62543-309">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.</span></span>  
  
<span data-ttu-id="62543-310">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-310">-or-</span></span> 
 <paramref name="password" /> <span data-ttu-id="62543-311">是長度為零的字串。</span><span class="sxs-lookup"><span data-stu-id="62543-311">is a zero-length string.</span></span>  
  
<span data-ttu-id="62543-312">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-312">-or-</span></span> 
 <paramref name="password" /> <span data-ttu-id="62543-313">超過密碼長度上限 (通常是 128 個字元)。</span><span class="sxs-lookup"><span data-stu-id="62543-313">exceeds the maximum password length (usually 128 characters).</span></span>  
  
<span data-ttu-id="62543-314">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-314">-or-</span></span> 
 <paramref name="newPasswordQuestion" /> <span data-ttu-id="62543-315">為空白，且 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> 屬性值為 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="62543-315">is empty and the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property value is <see langword="true" />.</span></span>  
  
<span data-ttu-id="62543-316">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-316">-or-</span></span> 
 <paramref name="newPasswordQuestion" /> <span data-ttu-id="62543-317">超過 256 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-317">exceeds 256 characters.</span></span>  
  
<span data-ttu-id="62543-318">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-318">-or-</span></span> 
 <paramref name="newPasswordAnswer" /> <span data-ttu-id="62543-319">在解答加密後超過 128 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-319">exceeds 128 characters after the answer is encrypted.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> <span data-ttu-id="62543-320">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-320">is <see langword="null" />.</span></span>  
  
<span data-ttu-id="62543-321">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-321">-or-</span></span> 
 <paramref name="password" /> <span data-ttu-id="62543-322">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-322">is <see langword="null" />.</span></span>  
  
<span data-ttu-id="62543-323">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-323">-or-</span></span> 
 <paramref name="newPasswordQuestion" /> <span data-ttu-id="62543-324">為 <see langword="null" /> 且 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> 屬性為 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="62543-324">is <see langword="null" /> and <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property is <see langword="true" />.</span></span>  
  
<span data-ttu-id="62543-325">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-325">-or-</span></span> 
 <paramref name="newPasswordAnswer" /> <span data-ttu-id="62543-326">為 <see langword="null" /> 且 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> 屬性為 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="62543-326">is <see langword="null" /> and <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property is <see langword="true" />.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="62543-327">[machineKey 元素 (ASP.NET 設定結構描述)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) 組態元素表示自動產生的機器加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="62543-327">The [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) configuration element indicates an auto-generated machine encryption key.</span></span> <span data-ttu-id="62543-328">您必須明確設定 [machineKey 元素 (ASP.NET 設定結構描述)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) 元素的 <see langword="decryptionKey" /> 屬性，以與 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 一起儲存密碼回應。</span><span class="sxs-lookup"><span data-stu-id="62543-328">You must explicitly set the <see langword="decryptionKey" /> attribute of the [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) element to store password answers with the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-329"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-329">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-330">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-330">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CreateUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser CreateUser (string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, out System.Web.Security.MembershipCreateStatus status);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser CreateUser(string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, [out] valuetype System.Web.Security.MembershipCreateStatus&amp; status) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function CreateUser (username As String, password As String, email As String, passwordQuestion As String, passwordAnswer As String, isApproved As Boolean, providerUserKey As Object, ByRef status As MembershipCreateStatus) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ CreateUser(System::String ^ username, System::String ^ password, System::String ^ email, System::String ^ passwordQuestion, System::String ^ passwordAnswer, bool isApproved, System::Object ^ providerUserKey, [Runtime::InteropServices::Out] System::Web::Security::MembershipCreateStatus % status);" />
      <MemberSignature Language="F#" Value="override this.CreateUser : string * string * string * string * string * bool * obj *  -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.CreateUser (username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, status)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="email" Type="System.String" />
        <Parameter Name="passwordQuestion" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
        <Parameter Name="isApproved" Type="System.Boolean" />
        <Parameter Name="providerUserKey" Type="System.Object" />
        <Parameter Name="status" Type="System.Web.Security.MembershipCreateStatus" RefType="out" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="62543-331">新使用者的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-331">The user name for the new user.</span></span></param>
        <param name="password"><span data-ttu-id="62543-332">新使用者的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-332">The password for the new user.</span></span></param>
        <param name="email"><span data-ttu-id="62543-333">新使用者的電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="62543-333">The email address of the new user.</span></span></param>
        <param name="passwordQuestion"><span data-ttu-id="62543-334">新使用者的密碼問題。</span><span class="sxs-lookup"><span data-stu-id="62543-334">The password question for the new user.</span></span></param>
        <param name="passwordAnswer"><span data-ttu-id="62543-335">新使用者的密碼解答。</span><span class="sxs-lookup"><span data-stu-id="62543-335">The password answer for the new user.</span></span></param>
        <param name="isApproved"><span data-ttu-id="62543-336">新的使用者是否核准為通過驗證。</span><span class="sxs-lookup"><span data-stu-id="62543-336">Whether or not the new user is approved to be validated.</span></span></param>
        <param name="providerUserKey"><span data-ttu-id="62543-337">使用者成員資格資料來源中的唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="62543-337">The unique identifier from the membership data source for the user.</span></span> <span data-ttu-id="62543-338">使用 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 類別時這個參數必須為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-338">This parameter must be <see langword="null" /> when using the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</span></span></param>
        <param name="status"><span data-ttu-id="62543-339">這個方法返回時，會包含其中一個 <see cref="T:System.Web.Security.MembershipCreateStatus" /> 列舉值，指出是否已成功建立使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-339">When this method returns, contains one of the <see cref="T:System.Web.Security.MembershipCreateStatus" /> enumeration values indicating whether the user was created successfully.</span></span></param>
        <summary><span data-ttu-id="62543-340">將新的使用者加入 Active Directory 資料存放區。</span><span class="sxs-lookup"><span data-stu-id="62543-340">Adds a new user to the Active Directory data store.</span></span></summary>
        <returns><span data-ttu-id="62543-341">包含新建立之使用者資訊的 <see cref="T:System.Web.Security.ActiveDirectoryMembershipUser" /> 執行個體；如果未成功建立使用者則為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-341">An <see cref="T:System.Web.Security.ActiveDirectoryMembershipUser" /> instance containing the information for the newly created user, or <see langword="null" /> if the user was not successfully created.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-342"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A>方法會呼叫<xref:System.Web.Security.Membership>類別，以在 Active Directory 資料存放區中建立新的使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-342">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A> method is called by the <xref:System.Web.Security.Membership> class to create a new user in the Active Directory data store.</span></span>  
  
 <span data-ttu-id="62543-343">Active Directory 與 Active Directory Application Mode (ADAM) 伺服器<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別，必須在目錄中的執行個體類別`user`。</span><span class="sxs-lookup"><span data-stu-id="62543-343">For both Active Directory and Active Directory Application Mode (ADAM) servers, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class requires that the instance class in the directory be `user`.</span></span> <span data-ttu-id="62543-344">這類替代的使用者類別`inetOrgPerson`不支援。</span><span class="sxs-lookup"><span data-stu-id="62543-344">Alternative user classes such as `inetOrgPerson` are not supported.</span></span>  
  
 <span data-ttu-id="62543-345">當使用 Active Directory 伺服器和使用者名稱對應到`userPrincipalName`屬性，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會自動產生的隨機 20 個字元的使用者名稱`sAMAccountName`代表您的參數。</span><span class="sxs-lookup"><span data-stu-id="62543-345">When using an Active Directory server and the user name is mapped to the `userPrincipalName` attribute, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will automatically generate a random 20-character user name for the `sAMAccountName` parameter on your behalf.</span></span>  
  
 <span data-ttu-id="62543-346">下列的最大費周章參數預設值。</span><span class="sxs-lookup"><span data-stu-id="62543-346">Parameters default to the following maximum lengths.</span></span>  
  
|<span data-ttu-id="62543-347">參數</span><span class="sxs-lookup"><span data-stu-id="62543-347">Parameter</span></span>|<span data-ttu-id="62543-348">最大長度</span><span class="sxs-lookup"><span data-stu-id="62543-348">Maximum length</span></span>|  
|---------------|--------------------|  
|`username`|<span data-ttu-id="62543-349">64 個字元，如果使用`userPrincipalName`屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-349">64 characters if using the `userPrincipalName` attribute.</span></span> <span data-ttu-id="62543-350">如果使用`sAMAccountName`屬性，一般的限制為 20 個字元或更少。</span><span class="sxs-lookup"><span data-stu-id="62543-350">If using the `sAMAccountName` attribute, the common restriction is 20 characters or less.</span></span>|  
|`password`|<span data-ttu-id="62543-351">128 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-351">128 characters.</span></span>|  
|`email`|<span data-ttu-id="62543-352">256 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-352">256 characters.</span></span>|  
|`passwordQuestion`|<span data-ttu-id="62543-353">256 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-353">256 characters.</span></span>|  
|`passwordAnswer`|<span data-ttu-id="62543-354">之前和之後加密的 128 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-354">128 characters before and after encrypting.</span></span>|  
  
 <span data-ttu-id="62543-355"><xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A>屬性傳回的<xref:System.Web.Security.ActiveDirectoryMembershipUser>執行個體僅限於 1024年個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-355">The <xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A> property on the returned <xref:System.Web.Security.ActiveDirectoryMembershipUser> instance is limited to 1024 characters.</span></span>  
  
 <span data-ttu-id="62543-356">如果藉由減少這些屬性的最大允許長度已修改的目錄結構描述，這些長度會優先。</span><span class="sxs-lookup"><span data-stu-id="62543-356">If the directory schema has been modified by reducing the maximum allowable lengths for these attributes, these lengths will take precedence.</span></span>  
  
 <span data-ttu-id="62543-357">建立使用者之前,<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將可確保使用者名稱是唯一的。</span><span class="sxs-lookup"><span data-stu-id="62543-357">Before creating the user, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will make sure the user name is unique.</span></span> <span data-ttu-id="62543-358">如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體已設定為需要唯一的電子郵件地址，它也必須確定是唯一的電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="62543-358">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance is configured to require unique email addresses, it will also make sure the email address is unique.</span></span>  
  
 <span data-ttu-id="62543-359">Active Directory 中使用者名稱會強制執行唯一性時的使用者名稱對應至執行 GC 搜尋`userPrincipalName`。</span><span class="sxs-lookup"><span data-stu-id="62543-359">In an Active Directory user-name uniqueness is enforced by performing a GC search when the user name is mapped to `userPrincipalName`.</span></span> <span data-ttu-id="62543-360">如果`sAMAccountName`使用時，則目錄將會自動強制執行唯一性的`sAMAccountName`跨 Active Directory 網域。</span><span class="sxs-lookup"><span data-stu-id="62543-360">If `sAMAccountName` is used, then the directory will automatically enforce uniqueness of the `sAMAccountName` across the Active Directory domain.</span></span>  
  
 <span data-ttu-id="62543-361">ADAM 伺服器將會自動強制執行的使用者名稱唯一性`userPrincipalName`跨所有應用程式分割。</span><span class="sxs-lookup"><span data-stu-id="62543-361">An ADAM server will automatically enforce user name uniqueness of the `userPrincipalName` across all application partitions.</span></span>  
  
 <span data-ttu-id="62543-362">執行 [建立使用者] 容器的根目錄開始重複的電子郵件地址的樹狀子目錄搜尋，會強制執行電子郵件地址的唯一性。</span><span class="sxs-lookup"><span data-stu-id="62543-362">Uniqueness of the email address is enforced by performing a subtree search for a duplicate email address starting at the root of the container in which users are created.</span></span> <span data-ttu-id="62543-363">這是預設使用者容器 （如果連線到 Active Directory 和不到容器中所指定的連接字串） 或連接字串中指定的容器。</span><span class="sxs-lookup"><span data-stu-id="62543-363">This is either the default user container (if connected to an Active Directory and no container was specified in the connection string) or the container specified in the connection string.</span></span>  
  
 <span data-ttu-id="62543-364"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會直接在連接字串中指定的使用者容器中建立使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-364">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class creates the user directly in the user container specified in the connection string.</span></span> <span data-ttu-id="62543-365">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-365">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="62543-366">要在 Active Directory 伺服器，設定的密碼`connectionProtection`屬性必須設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>。</span><span class="sxs-lookup"><span data-stu-id="62543-366">For passwords to be set on an Active Directory server, the `connectionProtection` attribute must be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span></span>  
  
 <span data-ttu-id="62543-367">使用 ADAM 伺服器時，`connectionProtection`屬性可以設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>，但只有在您明確設定 ADAM 伺服器，以允許透過不安全連線的密碼變更。</span><span class="sxs-lookup"><span data-stu-id="62543-367">When an ADAM server is being used, the `connectionProtection` attribute can be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, but only if you explicitly configure the ADAM server to allow password changes over unsecured connections.</span></span>  
  
 <span data-ttu-id="62543-368">前置和尾端空格，會刪減以外的所有字串參數值`password`。</span><span class="sxs-lookup"><span data-stu-id="62543-368">Leading and trailing spaces are trimmed from all string parameter values except `password`.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="62543-369">您無法建立新的使用者，除非用來連接到 Active Directory 伺服器的認證具有網域系統管理員權限 （不建議） 或 「 建立子執行個體，"「 刪除子執行個體 」 和 「 集密碼 」 存取權限。</span><span class="sxs-lookup"><span data-stu-id="62543-369">You cannot create new users unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "create child instance," "delete child instance," and "set password" access rights.</span></span> <span data-ttu-id="62543-370">「 刪除子執行個體 」 存取權限是必要的因為建立使用者是多步驟程序，而且如果使用者建立的任何步驟失敗，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將會刪除使用者執行個體而不是保留中的部分建構的使用者執行個體目錄。</span><span class="sxs-lookup"><span data-stu-id="62543-370">The "delete child instance" access right is required because creating a user is a multi-step process, and if any step of user creation fails, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will delete the user instance rather than leave a partially constructed user instance in the directory.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="62543-371"><paramref name="providerUserKey" /> 參數不是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-371">The <paramref name="providerUserKey" /> parameter is not <see langword="null" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="62543-372">系統管理員尚未將密碼問題與解答欄位對應至 Active Directory 結構描述的屬性，或 <paramref name="passwordQuestion" /> 或 <paramref name="passwordAnswer" /> 參數不是 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-372">The administrator has not mapped the password question-and-answer fields to attributes of the Active Directory schema, and either the <paramref name="passwordQuestion" /> or <paramref name="passwordAnswer" /> parameter is not <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="62543-373">[machineKey 元素 (ASP.NET 設定結構描述)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) 組態元素表示自動產生的機器加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="62543-373">The [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) configuration element indicates an auto-generated machine encryption key.</span></span> <span data-ttu-id="62543-374">您必須明確設定 [machineKey 元素 (ASP.NET 設定結構描述)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) 元素的 <see langword="decryptionKey" /> 屬性，以與 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 一起儲存密碼回應。</span><span class="sxs-lookup"><span data-stu-id="62543-374">You must explicitly set the <see langword="decryptionKey" /> attribute of the [machineKey Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) element to store password answers with the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</span></span>  
  
<span data-ttu-id="62543-375">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-375">-or-</span></span> 
<span data-ttu-id="62543-376">嘗試設定新使用者的密碼時，<see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 無法建立到目錄的安全連接。</span><span class="sxs-lookup"><span data-stu-id="62543-376">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> was unable to establish a secure connection to the directory when attempting to set the password for the new user.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.COMException"><span data-ttu-id="62543-377">嘗試建立使用者時發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="62543-377">An error occurred while attempting to create the user.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-378"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-378">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-379">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-379">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CurrentConnectionProtection">
      <MemberSignature Language="C#" Value="public System.Web.Security.ActiveDirectoryConnectionProtection CurrentConnectionProtection { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.Security.ActiveDirectoryConnectionProtection CurrentConnectionProtection" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CurrentConnectionProtection As ActiveDirectoryConnectionProtection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::Security::ActiveDirectoryConnectionProtection CurrentConnectionProtection { System::Web::Security::ActiveDirectoryConnectionProtection get(); };" />
      <MemberSignature Language="F#" Value="member this.CurrentConnectionProtection : System.Web.Security.ActiveDirectoryConnectionProtection" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.ActiveDirectoryConnectionProtection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-380">取得目前的安全性層級，會使用這個安全性層級保護與伺服器的通訊。</span><span class="sxs-lookup"><span data-stu-id="62543-380">Gets the current level of security being used to protect communications with the server.</span></span></summary>
        <value><span data-ttu-id="62543-381">其中一個 <see cref="T:System.Web.Security.ActiveDirectoryConnectionProtection" /> 值。</span><span class="sxs-lookup"><span data-stu-id="62543-381">One of the <see cref="T:System.Web.Security.ActiveDirectoryConnectionProtection" /> values.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-382"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A>屬性會指出目前的層級的安全性，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體設定為使用。</span><span class="sxs-lookup"><span data-stu-id="62543-382">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property indicates the current level of security that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance is configured to use.</span></span> <span data-ttu-id="62543-383"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A>屬性根據`connnectionProtection`屬性設定[（ASP.NET 設定結構描述） 的成員資格提供者的 add 項目](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18)應用程式組態檔中。</span><span class="sxs-lookup"><span data-stu-id="62543-383">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property is based on the `connnectionProtection` attribute set with the [add Element for providers for membership (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18) in the application configuration file.</span></span>  
  
 <span data-ttu-id="62543-384">`connectionProtection`屬性只能設定為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>或<xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>組態檔中。</span><span class="sxs-lookup"><span data-stu-id="62543-384">The `connectionProtection` attribute can only be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None> or <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> in the configuration file.</span></span>  
  
 <span data-ttu-id="62543-385">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-385">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-386">下列程式碼範例顯示 Web.config 項目設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>使用 SSL 安全性通訊協定來連線至 Active Directory 伺服器的執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-386">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to use the SSL security protocol to connect to an Active Directory server.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionProtection="SignAndSeal" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-387">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" /> 執行個體之前，已先嘗試存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-387">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-388">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-388">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DeleteUser">
      <MemberSignature Language="C#" Value="public override bool DeleteUser (string username, bool deleteAllRelatedData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool DeleteUser(string username, bool deleteAllRelatedData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function DeleteUser (username As String, deleteAllRelatedData As Boolean) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool DeleteUser(System::String ^ username, bool deleteAllRelatedData);" />
      <MemberSignature Language="F#" Value="override this.DeleteUser : string * bool -&gt; bool" Usage="activeDirectoryMembershipProvider.DeleteUser (username, deleteAllRelatedData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="deleteAllRelatedData" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="62543-389">要刪除的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-389">The name of the user to delete.</span></span></param>
        <param name="deleteAllRelatedData"><span data-ttu-id="62543-390"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> 方法會忽略這個參數。</span><span class="sxs-lookup"><span data-stu-id="62543-390">This parameter is ignored by the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> method.</span></span></param>
        <summary><span data-ttu-id="62543-391">從 Active Directory 資料存放區移除使用者的成員資格資訊。</span><span class="sxs-lookup"><span data-stu-id="62543-391">Removes a user's membership information from the Active Directory data store.</span></span></summary>
        <returns><see langword="true" /> <span data-ttu-id="62543-392">如果使用者已遭到刪除；否則，若在資料存放區中沒有找到使用者，則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-392">if the user was deleted; otherwise, <see langword="false" /> if the user was not found in the data store.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-393"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A>方法會立即移除所識別的使用者`username`參數。</span><span class="sxs-lookup"><span data-stu-id="62543-393">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A> method immediately removes the user identified by the `username` parameter.</span></span> <span data-ttu-id="62543-394">由於 Active Directory 資料存放區的目錄中，不同的區域不會儲存使用者資訊`deleteAllRelatedData`參數會被忽略，不過它必須設定為`true`或是`false`呼叫時<xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="62543-394">Since the Active Directory data store does not store user information in separate areas of the directory, the `deleteAllRelatedData` parameter is ignored, although it must be set to either `true` or `false` when calling the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A> method.</span></span>  
  
 <span data-ttu-id="62543-395"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會尋找使用者執行個體，若要刪除的連接字串所決定的使用者容器中執行的使用者名稱的單一層級搜尋。</span><span class="sxs-lookup"><span data-stu-id="62543-395">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class finds the user instance to delete by performing a single-level search for the user name in the users container determined by the connection string.</span></span> <span data-ttu-id="62543-396">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-396">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 `username` <span data-ttu-id="62543-397">必須是 64 個字元或更少。</span><span class="sxs-lookup"><span data-stu-id="62543-397">must be 64 characters or less.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="62543-398">您無法刪除使用者，除非用來連線到 Active Directory 伺服器的認證有可能是網域系統管理員的權限 （不建議） 或 「 刪除子執行個體 」 存取權限。</span><span class="sxs-lookup"><span data-stu-id="62543-398">You cannot delete users unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "delete child instances" access right.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> <span data-ttu-id="62543-399">為空白，或是超過使用者名稱的長度上限 (通常是 256 個字元)。</span><span class="sxs-lookup"><span data-stu-id="62543-399">is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="62543-400">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-400">-or-</span></span> 
 <paramref name="username" /> <span data-ttu-id="62543-401">包含逗號。</span><span class="sxs-lookup"><span data-stu-id="62543-401">contains commas.</span></span>  
  
<span data-ttu-id="62543-402">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-402">-or-</span></span> 
<span data-ttu-id="62543-403">使用者名稱會對應到 <see langword="userPrincipalName" /> 屬性，且 <paramref name="userName" /> 參數會包含反斜線。</span><span class="sxs-lookup"><span data-stu-id="62543-403">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="userName" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> <span data-ttu-id="62543-404">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-404">is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.COMException"><span data-ttu-id="62543-405">嘗試刪除使用者時發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="62543-405">An error occurred while attempting to delete the user.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-406"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-406">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-407">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-407">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="EnablePasswordReset">
      <MemberSignature Language="C#" Value="public override bool EnablePasswordReset { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePasswordReset" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property EnablePasswordReset As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnablePasswordReset { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnablePasswordReset : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-408">取得值，指出是否設定 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體允許使用者重設其密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-408">Gets a value indicating whether the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is configured to allow users to reset their passwords.</span></span></summary>
        <value><see langword="true" /> <span data-ttu-id="62543-409">如果允許重設密碼;否則， <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-409">if password reset is allowed; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="62543-410">預設為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-410">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-411"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性會指出您是否可以使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法來重設使用者的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-411">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property indicates whether you can use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method to reset a user's password.</span></span> <span data-ttu-id="62543-412"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性會設定您的應用程式組態檔案中，使用`enablePasswordReset`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。</span><span class="sxs-lookup"><span data-stu-id="62543-412">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is set in your application's configuration file using the `enablePasswordReset` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span>  
  
 <span data-ttu-id="62543-413">您只能設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性`true`當下列[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)已進行項目設定。</span><span class="sxs-lookup"><span data-stu-id="62543-413">You can only set the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property `true` when the following [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element settings have been made.</span></span>  
  
-   `requiresQuestionAndAnswer` <span data-ttu-id="62543-414">必須是`true`。</span><span class="sxs-lookup"><span data-stu-id="62543-414">must be `true`.</span></span>  
  
-   <span data-ttu-id="62543-415">必須修改 Active Directory 架構，以包含儲存的密碼問題和解答，以及密碼解答變更嘗試的三種追蹤欄位的屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-415">The Active Directory schema must be modified to contain attributes for storing the password question and answer, as well as the three tracking fields for password-answer change attempts.</span></span>  
  
-   `attributeMapPasswordQuestion`<span data-ttu-id="62543-416">`attributeMapPasswordAnswer`， `attributeMapFailedPasswordAnswerCount`， `attributeMapFailedPasswordAnswerTime`，和`attributeMapFailedPasswordAnswerLockoutTime`必須對應到 Active Directory 結構描述中的屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-416">, `attributeMapPasswordAnswer`, `attributeMapFailedPasswordAnswerCount`, `attributeMapFailedPasswordAnswerTime`, and `attributeMapFailedPasswordAnswerLockoutTime` must be mapped to attributes in the Active Directory schema.</span></span>  
  
 <span data-ttu-id="62543-417">如果不符合上述準則，<xref:System.Configuration.Provider.ProviderException>在初始化時擲回。</span><span class="sxs-lookup"><span data-stu-id="62543-417">If the above criteria are not met, a <xref:System.Configuration.Provider.ProviderException> is thrown at initialization.</span></span>  
  
 <span data-ttu-id="62543-418">當應用程式組態檔中的連接字串指定 Active Directory 網域，而不是特定的伺服器，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體一律都會連線至具備以確保網域的 PDC 角色的網域控制站密碼變更生效，並使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>呼叫方法。</span><span class="sxs-lookup"><span data-stu-id="62543-418">When the connection string in the application configuration file specifies an Active Directory domain rather than a specific server, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will always connect to the domain controller that has the PDC role for the domain to ensure that password changes take effect and are available when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method is called.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62543-419">即使<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，除非用來連接到 Active Directory 伺服器的認證具有網域系統管理員權限 （不建議） 或 「 重設密碼 」 存取權限，您無法重設使用者密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-419">Even if the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, you cannot reset user passwords unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "reset password" access right.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-420">下列程式碼範例顯示 Web.config 項目設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>啟用密碼重設的執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-420">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to enable password resets.</span></span> <span data-ttu-id="62543-421">它會使用明確的 「 重設密碼 」 存取權限的使用者的認證。</span><span class="sxs-lookup"><span data-stu-id="62543-421">It uses the explicit credentials of a user given the "reset password" access right.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="62543-422">當您將使用者認證放在您的 Web.config 檔案中時，有潛在的安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="62543-422">When you place user credentials in your Web.config file, there are potential security threats.</span></span> <span data-ttu-id="62543-423">Web.config 檔案所在的目錄的存取權限的使用者可以讀取檔案，並因此看到認證。</span><span class="sxs-lookup"><span data-stu-id="62543-423">Users with access rights to the directory containing the Web.config file can read the file, and thus see the credentials.</span></span> <span data-ttu-id="62543-424">如需如何有效防止這種威脅的詳細資訊，請參閱[組態加密組態資訊使用受保護的](https://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1)。</span><span class="sxs-lookup"><span data-stu-id="62543-424">For details on how to protect against this threat, see [Encrypting Configuration Information Using Protected Configuration](https://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionUsername="UserWithResetPasswordRights"  
          connectionPassword="PasswordForUser"  
          enablePasswordReset="true"  
          requiresQuestionAndAnswer="true"  
          attributeMapPasswordQuestion="PasswordQuestionADAttribute"  
          attributeMapPasswordAnswer="PasswordAnswerADAttribute"  
          attributeMapFailedPasswordAnswerCount="AnswerCountADAttribute"  
          attributeMapFailedPasswordAnswerTime="AnswerTimeADAttribute"  
          attributeMapFailedPasswordAnswerLockoutTime="LockOutTimeADAttribute" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-425">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> 執行個體之前，已先嘗試存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-425">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-426">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-426">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="EnablePasswordRetrieval">
      <MemberSignature Language="C#" Value="public override bool EnablePasswordRetrieval { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePasswordRetrieval" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property EnablePasswordRetrieval As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnablePasswordRetrieval { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnablePasswordRetrieval : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-427">取得值，指出是否可以從 Active Directory 資料存放區擷取使用者的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-427">Gets a value indicating whether the user's password can be retrieved from the Active Directory data store.</span></span> <span data-ttu-id="62543-428">這個屬性永遠會傳回 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-428">This property always returns <see langword="false" />.</span></span></summary>
        <value><see langword="false" /> <span data-ttu-id="62543-429">表示由，不支援密碼擷取<see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />類別。</span><span class="sxs-lookup"><span data-stu-id="62543-429">to indicate that password retrieval is not supported by the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-430"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不支援密碼擷取。</span><span class="sxs-lookup"><span data-stu-id="62543-430">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support password retrieval.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-431">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" /> 執行個體之前，已先嘗試存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-431">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="EnableSearchMethods">
      <MemberSignature Language="C#" Value="public bool EnableSearchMethods { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableSearchMethods" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property EnableSearchMethods As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableSearchMethods { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnableSearchMethods : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-432">取得值，指出是否可以使用搜尋導向的 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="62543-432">Gets a value indicating whether search-oriented <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> methods are available.</span></span></summary>
        <value><see langword="true" /> <span data-ttu-id="62543-433">如果搜尋方法則可使用;否則， <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-433">if search methods are available; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="62543-434">預設為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-434">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-435">因為搜尋 Active Directory 伺服器可能是資源密集<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性可讓您關閉搜尋導向<xref:System.Web.Security.ActiveDirectoryMembershipProvider>方法。</span><span class="sxs-lookup"><span data-stu-id="62543-435">Because searching an Active Directory server is potentially resource intensive, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property enables you to turn off search-oriented <xref:System.Web.Security.ActiveDirectoryMembershipProvider> methods.</span></span> <span data-ttu-id="62543-436"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性會設定您的應用程式組態檔案中，使用`enableSearchMethods`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。</span><span class="sxs-lookup"><span data-stu-id="62543-436">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property is set in your application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span>  
  
 <span data-ttu-id="62543-437">當<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性是`false`，不可以使用下列方法：</span><span class="sxs-lookup"><span data-stu-id="62543-437">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property is `false`, the following methods are not available:</span></span>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A>  
  
 <span data-ttu-id="62543-438">提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。</span><span class="sxs-lookup"><span data-stu-id="62543-438">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-439">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-439">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="62543-440">我們建議您不要啟用搜尋在實際系統上，直到您已確認所簽發的搜尋查詢<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不造成不良影響您的目錄伺服器的效能。</span><span class="sxs-lookup"><span data-stu-id="62543-440">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="62543-441">由於<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別設計為無狀態 Web 環境，就無法使用由基礎分頁最佳化<xref:System.DirectoryServices>Api。</span><span class="sxs-lookup"><span data-stu-id="62543-441">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="62543-442">這表示在對大型目錄搜尋時的分頁作業相當耗費資源，應該予以避免。</span><span class="sxs-lookup"><span data-stu-id="62543-442">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="62543-443">搜尋作業一定會針對在連接字串中，設定的目錄伺服器或在連接字串指向網域的情況下會自動選取的伺服器發出。</span><span class="sxs-lookup"><span data-stu-id="62543-443">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="62543-444">提供者不會使用其搜尋方法的通用類別目錄。</span><span class="sxs-lookup"><span data-stu-id="62543-444">The provider does not use a global catalog for its search methods.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-445">下列程式碼範例顯示 Web.config 項目設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>來啟用搜尋 Active Directory 伺服器的執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-445">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to enable searching an Active Directory server.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          enableSearchMethods="true" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-446">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> 執行個體之前，已先嘗試存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-446">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-447">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-447">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="FindUsersByEmail">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection FindUsersByEmail (string emailToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection FindUsersByEmail(string emailToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersByEmail (emailToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ FindUsersByEmail(System::String ^ emailToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindUsersByEmail : string * int * int *  -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.FindUsersByEmail (emailToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="emailToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="emailToMatch"><span data-ttu-id="62543-448">要搜尋的電子郵件地址或電子郵件地址的一部分。</span><span class="sxs-lookup"><span data-stu-id="62543-448">Email address or portion of email address to search for.</span></span></param>
        <param name="pageIndex"><span data-ttu-id="62543-449">要傳回的結果網頁索引。</span><span class="sxs-lookup"><span data-stu-id="62543-449">The index of the page of results to return.</span></span> <paramref name="pageIndex" /> <span data-ttu-id="62543-450">為以零起始。</span><span class="sxs-lookup"><span data-stu-id="62543-450">is zero-based.</span></span></param>
        <param name="pageSize"><span data-ttu-id="62543-451">要傳回的結果網頁大小。</span><span class="sxs-lookup"><span data-stu-id="62543-451">The size of the page of results to return.</span></span></param>
        <param name="totalRecords"><span data-ttu-id="62543-452">這個方法返回時，會包含集合中傳回之使用者的總數。</span><span class="sxs-lookup"><span data-stu-id="62543-452">When this method returns, contains the total number of users returned in the collection.</span></span> <span data-ttu-id="62543-453">這個參數會以未初始化的狀態傳遞。</span><span class="sxs-lookup"><span data-stu-id="62543-453">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="62543-454">根據使用者的電子郵件地址從 Active Directory 資料存放區傳回成員資格使用者的集合。</span><span class="sxs-lookup"><span data-stu-id="62543-454">Returns a collection of membership users from the Active Directory data store based on the user's email address.</span></span></summary>
        <returns><span data-ttu-id="62543-455"><see cref="T:System.Web.Security.MembershipUserCollection" />，包含從 <paramref name="pageIndex" /> 所指定頁面開始的 <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> 執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-455">A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-456"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>方法取得<xref:System.Web.Security.MembershipUserCollection>包含使用者記錄從 Active Directory 儲存符合`emailToMatch`參數。</span><span class="sxs-lookup"><span data-stu-id="62543-456">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> method gets a <xref:System.Web.Security.MembershipUserCollection> containing the user records from the Active Directory store that match the `emailToMatch` parameters.</span></span> <span data-ttu-id="62543-457">使用者記錄電子郵件地址會傳回以遞增順序排序。</span><span class="sxs-lookup"><span data-stu-id="62543-457">The user records are returned sorted in ascending order by email address.</span></span>  
  
 <span data-ttu-id="62543-458">`emailToMatch`參數會限制為 256 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-458">The `emailToMatch` parameter is limited to 256 characters.</span></span>  
  
 <span data-ttu-id="62543-459"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會發出使用這兩個搜尋`clientSearchTimeout`和`serverSearchTimeout`組態值。</span><span class="sxs-lookup"><span data-stu-id="62543-459">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will issue the search using both the `clientSearchTimeout` and `serverSearchTimeout` configuration values.</span></span> <span data-ttu-id="62543-460">由於<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會執行對目錄伺服器使用 512 的資料列，每個頁面的頁面搜尋、 逾時套用至每一頁所擷取的結果<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別。</span><span class="sxs-lookup"><span data-stu-id="62543-460">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class performs searches against the directory server using pages with 512 rows per page, the time-outs apply to each page of results fetched by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span> <span data-ttu-id="62543-461">例如，如果搜尋查詢會產生 1000 個資料列，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將會擷取這項資訊做為兩個頁面的資料。</span><span class="sxs-lookup"><span data-stu-id="62543-461">For example, if a search query results in 1,000 rows of data, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class will fetch this information as two pages of data.</span></span> <span data-ttu-id="62543-462">這表示用戶端和搜尋逾時，會啟動從零時算起<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別要求資料的第二頁。</span><span class="sxs-lookup"><span data-stu-id="62543-462">This means that the client and search time-outs will start counting from zero when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class requests the second page of data.</span></span>  
  
 <span data-ttu-id="62543-463">所傳回的結果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>方法會受限於`pageIndex`和`pageSize`參數。</span><span class="sxs-lookup"><span data-stu-id="62543-463">The results returned by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> method are constrained by the `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="62543-464">`pageSize`參數指定的數目上限<xref:System.Web.Security.MembershipUser>執行個體，以傳回<xref:System.Web.Security.MembershipUserCollection>。</span><span class="sxs-lookup"><span data-stu-id="62543-464">The `pageSize` parameter specifies the maximum number of <xref:System.Web.Security.MembershipUser> instances to return in the <xref:System.Web.Security.MembershipUserCollection>.</span></span> <span data-ttu-id="62543-465">`pageIndex`參數會指定要傳回，其中 0 （零） 表示第一頁的結果頁面。</span><span class="sxs-lookup"><span data-stu-id="62543-465">The `pageIndex` parameter specifies which page of results to return, where 0 (zero) indicates the first page.</span></span>  
  
 <span data-ttu-id="62543-466">`totalRecords`參數是`out`Active Directory 資料存放區中找到的設定相符的成員資格使用者總數為的參數。</span><span class="sxs-lookup"><span data-stu-id="62543-466">The `totalRecords` parameter is an `out` parameter that is set to the total number of matching membership users found in the Active Directory data store.</span></span> <span data-ttu-id="62543-467">比方說，如果有 13 個使用者設定的資料存放區，而`pageIndex`的值為 1`pageSize`為 5，<xref:System.Web.Security.MembershipUserCollection>傳回會包含第 6 到第 10 位使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-467">For example, if there are 13 users for the configured data store, and the `pageIndex` value was 1 with a `pageSize` of 5, the <xref:System.Web.Security.MembershipUserCollection> returned would contain the sixth through the tenth users.</span></span> <span data-ttu-id="62543-468">`totalRecords`參數會設定為 13。</span><span class="sxs-lookup"><span data-stu-id="62543-468">The `totalRecords` parameter would be set to 13.</span></span>  
  
 <span data-ttu-id="62543-469">您可以控制是否要允許搜尋使用者，藉由設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>應用程式的組態中的屬性檔案中，使用`enableSearchMethods`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目.</span><span class="sxs-lookup"><span data-stu-id="62543-469">You can control whether to allow searching for users, by setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property in the application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="62543-470">設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性，以`false`會導致<xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>方法會擲回<xref:System.NotSupportedException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="62543-470">Setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property to `false` causes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A> method to throw a <xref:System.NotSupportedException> exception.</span></span>  
  
 <span data-ttu-id="62543-471">提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。</span><span class="sxs-lookup"><span data-stu-id="62543-471">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-472">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-472">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="62543-473">我們建議您不要啟用搜尋在實際系統上，直到您已確認所簽發的搜尋查詢<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不造成不良影響您的目錄伺服器的效能。</span><span class="sxs-lookup"><span data-stu-id="62543-473">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="62543-474">由於<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別設計為無狀態 Web 環境，就無法使用由基礎分頁最佳化<xref:System.DirectoryServices>Api。</span><span class="sxs-lookup"><span data-stu-id="62543-474">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="62543-475">這表示在對大型目錄搜尋時的分頁作業相當耗費資源，應該予以避免。</span><span class="sxs-lookup"><span data-stu-id="62543-475">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="62543-476">搜尋作業一定會針對在連接字串中，設定的目錄伺服器或在連接字串指向網域的情況下會自動選取的伺服器發出。</span><span class="sxs-lookup"><span data-stu-id="62543-476">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="62543-477">提供者不會使用其搜尋方法的通用類別目錄。</span><span class="sxs-lookup"><span data-stu-id="62543-477">The provider does not use a global catalog for its search methods.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-478"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-478">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><paramref name="emailToMatch" /> <span data-ttu-id="62543-479">是空的。</span><span class="sxs-lookup"><span data-stu-id="62543-479">is empty.</span></span>  
  
<span data-ttu-id="62543-480">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-480">-or-</span></span> 
 <paramref name="emailToMatch" /> <span data-ttu-id="62543-481">超過 256 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-481">exceeds 256 characters.</span></span>  
  
<span data-ttu-id="62543-482">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-482">-or-</span></span> 
 <paramref name="pageIndex" /> <span data-ttu-id="62543-483">小於 0。</span><span class="sxs-lookup"><span data-stu-id="62543-483">is less than 0.</span></span>  
  
<span data-ttu-id="62543-484">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-484">-or-</span></span> 
 <paramref name="pageSize" /> <span data-ttu-id="62543-485">小於 1。</span><span class="sxs-lookup"><span data-stu-id="62543-485">is less than 1.</span></span>  
  
<span data-ttu-id="62543-486">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-486">-or-</span></span> 
 <paramref name="pageSize" /> <span data-ttu-id="62543-487">乘以 <paramref name="pageIndex" />，加上 <paramref name="pageSize" />，再減掉 1 大於 <see cref="F:System.Int32.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="62543-487">multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="62543-488"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> 屬性為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-488">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-489">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-489">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="FindUsersByName">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection FindUsersByName (string usernameToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection FindUsersByName(string usernameToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersByName (usernameToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ FindUsersByName(System::String ^ usernameToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindUsersByName : string * int * int *  -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.FindUsersByName (usernameToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="usernameToMatch"><span data-ttu-id="62543-490">要搜尋的使用者名稱或使用者名稱的一部分。</span><span class="sxs-lookup"><span data-stu-id="62543-490">The user name or portion of a user name to search for.</span></span></param>
        <param name="pageIndex"><span data-ttu-id="62543-491">要傳回的結果網頁索引。</span><span class="sxs-lookup"><span data-stu-id="62543-491">The index of the page of results to return.</span></span> <paramref name="pageIndex" /> <span data-ttu-id="62543-492">為以零起始。</span><span class="sxs-lookup"><span data-stu-id="62543-492">is zero-based.</span></span></param>
        <param name="pageSize"><span data-ttu-id="62543-493">要傳回的結果網頁大小。</span><span class="sxs-lookup"><span data-stu-id="62543-493">The size of the page of results to return.</span></span></param>
        <param name="totalRecords"><span data-ttu-id="62543-494">這個方法返回時，會包含集合中傳回的資料錄總數。</span><span class="sxs-lookup"><span data-stu-id="62543-494">When this method returns, contains the total number of records returned in the collection.</span></span> <span data-ttu-id="62543-495">這個參數會以未初始化的狀態傳遞。</span><span class="sxs-lookup"><span data-stu-id="62543-495">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="62543-496">根據使用者名稱從 Active Directory 資料存放區傳回使用者集合。</span><span class="sxs-lookup"><span data-stu-id="62543-496">Returns a collection of users from the Active Directory data store based on the user name.</span></span></summary>
        <returns><span data-ttu-id="62543-497"><see cref="T:System.Web.Security.MembershipUserCollection" />，包含從 <paramref name="pageIndex" /> 所指定頁面開始的 <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> 執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-497">A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-498"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>方法會傳回<xref:System.Web.Security.MembershipUserCollection>執行個體，包含使用者記錄從所有相符的使用者名稱的 Active Directory 資料存放區`userNameToMatch`參數。</span><span class="sxs-lookup"><span data-stu-id="62543-498">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> method returns a <xref:System.Web.Security.MembershipUserCollection> instance containing the user records from the Active Directory data store for all user names that match the `userNameToMatch` parameters.</span></span> <span data-ttu-id="62543-499">會傳回依使用者名稱的字母順序排序記錄。</span><span class="sxs-lookup"><span data-stu-id="62543-499">The records are returned sorted alphabetically by user name.</span></span>  
  
 <span data-ttu-id="62543-500">所傳回的結果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>方法會受限於`pageIndex`和`pageSize`參數。</span><span class="sxs-lookup"><span data-stu-id="62543-500">The results returned by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> method are constrained by the `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="62543-501">`pageSize`參數指定的數目上限<xref:System.Web.Security.MembershipUser>執行個體，以傳回<xref:System.Web.Security.MembershipUserCollection>。</span><span class="sxs-lookup"><span data-stu-id="62543-501">The `pageSize` parameter specifies the maximum number of <xref:System.Web.Security.MembershipUser> instances to return in the <xref:System.Web.Security.MembershipUserCollection>.</span></span> <span data-ttu-id="62543-502">`pageIndex`參數會指定要傳回，其中 0 （零） 表示第一頁的結果頁面。</span><span class="sxs-lookup"><span data-stu-id="62543-502">The `pageIndex` parameter specifies which page of results to return, where 0 (zero) indicates the first page.</span></span>  
  
 <span data-ttu-id="62543-503">`totalRecords`參數是`out`Active Directory 資料存放區中找到的設定相符的成員資格使用者總數為的參數。</span><span class="sxs-lookup"><span data-stu-id="62543-503">The `totalRecords` parameter is an `out` parameter that is set to the total number of matching membership users found in the Active Directory data store.</span></span> <span data-ttu-id="62543-504">比方說，如果有 13 個使用者設定的資料存放區，而`pageIndex`的值為 1`pageSize`為 5，<xref:System.Web.Security.MembershipUserCollection>傳回會包含第 6 到第 10 位使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-504">For example, if there are 13 users for the configured data store, and the `pageIndex` value was 1 with a `pageSize` of 5, the <xref:System.Web.Security.MembershipUserCollection> returned would contain the sixth through the tenth users.</span></span> <span data-ttu-id="62543-505">`totalRecords`參數會設定為 13。</span><span class="sxs-lookup"><span data-stu-id="62543-505">The `totalRecords` parameter would be set to 13.</span></span>  
  
 <span data-ttu-id="62543-506">您可以控制是否要允許搜尋使用者，藉由設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>應用程式的組態中的屬性檔案中，使用`enableSearchMethods`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目.</span><span class="sxs-lookup"><span data-stu-id="62543-506">You can control whether to allow searching for users, by setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property in the application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="62543-507">設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性值，以`false`會導致<xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>方法會擲回<xref:System.NotSupportedException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="62543-507">Setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property value to `false` causes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A> method to throw a <xref:System.NotSupportedException> exception.</span></span>  
  
 <span data-ttu-id="62543-508">提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。</span><span class="sxs-lookup"><span data-stu-id="62543-508">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-509">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-509">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="62543-510">我們建議您不要啟用搜尋在實際系統上，直到您已確認所簽發的搜尋查詢<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不造成不良影響您的目錄伺服器的效能。</span><span class="sxs-lookup"><span data-stu-id="62543-510">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="62543-511">由於<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別設計為無狀態 Web 環境，就無法使用由基礎分頁最佳化<xref:System.DirectoryServices>Api。</span><span class="sxs-lookup"><span data-stu-id="62543-511">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="62543-512">這表示在對大型目錄搜尋時的分頁作業相當耗費資源，應該予以避免。</span><span class="sxs-lookup"><span data-stu-id="62543-512">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="62543-513">搜尋作業一定會針對在連接字串中，設定的目錄伺服器或在連接字串指向網域的情況下會自動選取的伺服器發出。</span><span class="sxs-lookup"><span data-stu-id="62543-513">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="62543-514">提供者不會使用其搜尋方法的通用類別目錄。</span><span class="sxs-lookup"><span data-stu-id="62543-514">The provider does not use a global catalog for its search methods.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-515"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-515">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><paramref name="usernameToMatch" /> <span data-ttu-id="62543-516">為空白，或是超過使用者名稱的長度上限 (通常是 256 個字元)。</span><span class="sxs-lookup"><span data-stu-id="62543-516">is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="62543-517">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-517">-or-</span></span> 
 <paramref name="usernameToMatch" /> <span data-ttu-id="62543-518">包含逗號。</span><span class="sxs-lookup"><span data-stu-id="62543-518">contains commas.</span></span>  
  
<span data-ttu-id="62543-519">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-519">-or-</span></span> 
 <paramref name="pageIndex" /> <span data-ttu-id="62543-520">小於 0。</span><span class="sxs-lookup"><span data-stu-id="62543-520">is less than 0.</span></span>  
  
<span data-ttu-id="62543-521">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-521">-or</span></span> 
 <paramref name="pageSize" /> <span data-ttu-id="62543-522">小於 1。</span><span class="sxs-lookup"><span data-stu-id="62543-522">is less than 1.</span></span>  
  
<span data-ttu-id="62543-523">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-523">-or-</span></span> 
 <paramref name="pageSize" /> <span data-ttu-id="62543-524">乘以 <paramref name="pageIndex" />，加上 <paramref name="pageSize" />，再減掉 1 大於 <see cref="F:System.Int32.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="62543-524">multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="usernameToMatch" /> <span data-ttu-id="62543-525">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-525">is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="62543-526"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> 屬性為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-526">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-527">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-527">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GeneratePassword">
      <MemberSignature Language="C#" Value="public virtual string GeneratePassword ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string GeneratePassword() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GeneratePassword () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::String ^ GeneratePassword();" />
      <MemberSignature Language="F#" Value="abstract member GeneratePassword : unit -&gt; string&#xA;override this.GeneratePassword : unit -&gt; string" Usage="activeDirectoryMembershipProvider.GeneratePassword " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="62543-528">產生隨機密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-528">Generates a random password.</span></span></summary>
        <returns><span data-ttu-id="62543-529">隨機密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-529">A random password.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-530"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A>方法<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會呼叫<xref:System.Web.Security.Membership.GeneratePassword%2A>方法<xref:System.Web.Security.Membership>類別來擷取隨機的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-530">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A> method of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class calls the <xref:System.Web.Security.Membership.GeneratePassword%2A> method of the <xref:System.Web.Security.Membership> class to retrieve a random password.</span></span> <span data-ttu-id="62543-531">密碼長度設為值<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-531">The password length is set to the value of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> property.</span></span> <span data-ttu-id="62543-532">密碼長度絕不可小於 14。</span><span class="sxs-lookup"><span data-stu-id="62543-532">The password length can never be less than 14.</span></span>  
  
 <span data-ttu-id="62543-533">您可以特別呼叫<xref:System.Web.Security.Membership.GeneratePassword%2A>方法，藉由參考<xref:System.Web.Security.ActiveDirectoryMembershipProvider>直接從提供者屬性的類別<xref:System.Web.Security.Membership>類別。</span><span class="sxs-lookup"><span data-stu-id="62543-533">You can specifically call the <xref:System.Web.Security.Membership.GeneratePassword%2A> method by referencing the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class directly from the Provider property of the <xref:System.Web.Security.Membership> class.</span></span>  
  
 <span data-ttu-id="62543-534">產生的密碼只能包含英數字元及下列標點符號: ！ @# $%^ & \* （） _-+ = [{}]};: <>&#124;。 /？。</span><span class="sxs-lookup"><span data-stu-id="62543-534">The generated password only contains alphanumeric characters and the following punctuation marks: !@#$%^&\*()_-+=[{]};:<>&#124;./?.</span></span> <span data-ttu-id="62543-535">沒有隱藏或非可列印的控制字元會包含在產生的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-535">No hidden or non-printable control characters are included in the generated password.</span></span>  
  
 <span data-ttu-id="62543-536">產生的密碼至少會包含在指定的非英數字元數目<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-536">The generated password will contain at least the number of non-alphanumeric characters specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> property.</span></span> <span data-ttu-id="62543-537">產生的密碼不能使用中的規則運算式測試<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-537">The generated password will not be tested with the regular expression in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62543-538"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不會產生符合複雜性需求設定目錄中的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-538">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not generate passwords that match complexity requirements set in the directory.</span></span> <span data-ttu-id="62543-539">可以產生隨機密碼失敗目錄所設定的密碼複雜性規則。</span><span class="sxs-lookup"><span data-stu-id="62543-539">It is possible to generate a random password that fails the password complexity rules set by the directory.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-540">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-540">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetAllUsers">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection GetAllUsers (int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection GetAllUsers(int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetAllUsers (pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ GetAllUsers(int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.GetAllUsers : int * int *  -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.GetAllUsers (pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pageIndex"><span data-ttu-id="62543-541">要傳回的結果網頁索引。</span><span class="sxs-lookup"><span data-stu-id="62543-541">The index of the page of results to return.</span></span> <paramref name="pageIndex" /> <span data-ttu-id="62543-542">為以零起始。</span><span class="sxs-lookup"><span data-stu-id="62543-542">is zero-based.</span></span></param>
        <param name="pageSize"><span data-ttu-id="62543-543">要傳回的結果網頁大小。</span><span class="sxs-lookup"><span data-stu-id="62543-543">The size of the page of results to return.</span></span></param>
        <param name="totalRecords"><span data-ttu-id="62543-544">這個方法返回時，會包含集合中傳回的資料錄總數。</span><span class="sxs-lookup"><span data-stu-id="62543-544">When this method returns, contains the total number of records returned in the collection.</span></span> <span data-ttu-id="62543-545">這個參數會以未初始化的狀態傳遞。</span><span class="sxs-lookup"><span data-stu-id="62543-545">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="62543-546">取得 Active Directory 資料存放區中儲存之所有使用者的集合。</span><span class="sxs-lookup"><span data-stu-id="62543-546">Gets a collection of all the users stored in an Active Directory data source.</span></span></summary>
        <returns><span data-ttu-id="62543-547"><see cref="T:System.Web.Security.MembershipUserCollection" />，包含從 <paramref name="pageIndex" /> 所指定頁面開始的 <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> 執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-547">A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-548">這個方法會呼叫<xref:System.Web.Security.Membership>類別從 ASP.NET 應用程式的組態檔中指定的 Active Directory 資料存放區擷取使用者資訊。</span><span class="sxs-lookup"><span data-stu-id="62543-548">This method is called by the <xref:System.Web.Security.Membership> class to retrieve user information from the Active Directory data store specified in the ASP.NET application's configuration file.</span></span>  
  
 <span data-ttu-id="62543-549">所傳回的結果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A>方法會受限於`pageIndex`和`pageSize`參數。</span><span class="sxs-lookup"><span data-stu-id="62543-549">The results returned by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A> method are constrained by the `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="62543-550">`pageSize`參數指定的數目上限<xref:System.Web.Security.MembershipUser>執行個體，以傳回<xref:System.Web.Security.MembershipUserCollection>集合。</span><span class="sxs-lookup"><span data-stu-id="62543-550">The `pageSize` parameter specifies the maximum number of <xref:System.Web.Security.MembershipUser> instances to return in the <xref:System.Web.Security.MembershipUserCollection> collection.</span></span> <span data-ttu-id="62543-551">`pageIndex`參數會指定要傳回，其中 0 （零） 表示第一頁的結果頁面。</span><span class="sxs-lookup"><span data-stu-id="62543-551">The `pageIndex` parameter specifies which page of results to return, where 0 (zero) indicates the first page.</span></span>  
  
 <span data-ttu-id="62543-552">`totalRecords`參數是`out`Active Directory 資料存放區中找到的設定相符的成員資格使用者總數為的參數。</span><span class="sxs-lookup"><span data-stu-id="62543-552">The `totalRecords` parameter is an `out` parameter that is set to the total number of matching membership users found in the Active Directory data store.</span></span> <span data-ttu-id="62543-553">比方說，如果有 13 個使用者設定的資料存放區，而`pageIndex`的值為 1 la`pageSize`為 5，<xref:System.Web.Security.MembershipUserCollection>傳回會包含第 6 到第 10 位使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-553">For example, if there are 13 users for the configured data store, and the `pageIndex` value was 1 with la `pageSize` of 5, the <xref:System.Web.Security.MembershipUserCollection> returned would contain the sixth through the tenth users.</span></span> <span data-ttu-id="62543-554">`totalRecords`參數會設定為 13。</span><span class="sxs-lookup"><span data-stu-id="62543-554">The `totalRecords` parameter would be set to 13.</span></span>  
  
 <span data-ttu-id="62543-555">您可以控制是否允許使用者藉由設定搜尋<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>應用程式的組態中的屬性檔案中，使用`enableSearchMethods`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。</span><span class="sxs-lookup"><span data-stu-id="62543-555">You can control whether to allow searching for users by setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property in the application's configuration file using the `enableSearchMethods` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="62543-556">設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性，以`false`會導致<xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A>方法會擲回<xref:System.NotSupportedException>例外狀況。</span><span class="sxs-lookup"><span data-stu-id="62543-556">Setting the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property to `false` causes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A> method to throw a <xref:System.NotSupportedException> exception.</span></span>  
  
 <span data-ttu-id="62543-557">提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。</span><span class="sxs-lookup"><span data-stu-id="62543-557">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-558">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-558">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="62543-559">我們建議您不要啟用搜尋在實際系統上，直到您已確認所簽發的搜尋查詢<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不造成不良影響您的目錄伺服器的效能。</span><span class="sxs-lookup"><span data-stu-id="62543-559">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span> <span data-ttu-id="62543-560">由於<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別設計為無狀態 Web 環境，就無法使用由基礎分頁最佳化<xref:System.DirectoryServices>Api。</span><span class="sxs-lookup"><span data-stu-id="62543-560">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="62543-561">這表示在對大型目錄搜尋時的分頁作業相當耗費資源，應該予以避免。</span><span class="sxs-lookup"><span data-stu-id="62543-561">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="62543-562">搜尋作業一定會針對在連接字串中，設定的目錄伺服器或在連接字串指向網域的情況下會自動選取的伺服器發出。</span><span class="sxs-lookup"><span data-stu-id="62543-562">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="62543-563">提供者不會使用其搜尋方法的通用類別目錄。</span><span class="sxs-lookup"><span data-stu-id="62543-563">The provider does not use a global catalog for its search methods.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-564"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-564">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><paramref name="pageIndex" /> <span data-ttu-id="62543-565">小於 0。</span><span class="sxs-lookup"><span data-stu-id="62543-565">is less than 0.</span></span>  
  
<span data-ttu-id="62543-566">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-566">-or</span></span> 
 <paramref name="pageSize" /> <span data-ttu-id="62543-567">小於 1。</span><span class="sxs-lookup"><span data-stu-id="62543-567">is less than 1.</span></span>  
  
<span data-ttu-id="62543-568">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-568">-or-</span></span> 
 <paramref name="pageSize" /> <span data-ttu-id="62543-569">乘以 <paramref name="pageIndex" />，加上 <paramref name="pageSize" />，再減掉 1 大於 <see cref="F:System.Int32.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="62543-569">multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="62543-570"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> 屬性為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-570">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-571">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-571">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetNumberOfUsersOnline">
      <MemberSignature Language="C#" Value="public override int GetNumberOfUsersOnline ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 GetNumberOfUsersOnline() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetNumberOfUsersOnline () As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int GetNumberOfUsersOnline();" />
      <MemberSignature Language="F#" Value="override this.GetNumberOfUsersOnline : unit -&gt; int" Usage="activeDirectoryMembershipProvider.GetNumberOfUsersOnline " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="62543-572">在所有情況下都會擲回 <see cref="T:System.NotSupportedException" /> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="62543-572">Throws a <see cref="T:System.NotSupportedException" /> exception in all cases.</span></span></summary>
        <returns><span data-ttu-id="62543-573">所有情況下的 <see cref="T:System.NotSupportedException" />。</span><span class="sxs-lookup"><span data-stu-id="62543-573">A <see cref="T:System.NotSupportedException" /> in all cases.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-574"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不支援傳回線上使用者數目。</span><span class="sxs-lookup"><span data-stu-id="62543-574">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support returning the number of users online.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="62543-575">對 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" /> 方法的任何呼叫。</span><span class="sxs-lookup"><span data-stu-id="62543-575">Any call to the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" /> method.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-576">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-576">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetPassword">
      <MemberSignature Language="C#" Value="public override string GetPassword (string username, string passwordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string GetPassword(string username, string passwordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetPassword(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetPassword (username As String, passwordAnswer As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ GetPassword(System::String ^ username, System::String ^ passwordAnswer);" />
      <MemberSignature Language="F#" Value="override this.GetPassword : string * string -&gt; string" Usage="activeDirectoryMembershipProvider.GetPassword (username, passwordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="62543-577">要擷取密碼的使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-577">The user to retrieve the password for.</span></span></param>
        <param name="passwordAnswer"><span data-ttu-id="62543-578">使用者的密碼解答。</span><span class="sxs-lookup"><span data-stu-id="62543-578">The password answer for the user.</span></span></param>
        <summary><span data-ttu-id="62543-579">從資料庫傳回指定之使用者的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-579">Returns the password of the specified user from the database.</span></span> <span data-ttu-id="62543-580"><see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 類別不支援這個方法。</span><span class="sxs-lookup"><span data-stu-id="62543-580">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class does not support this method.</span></span></summary>
        <returns><span data-ttu-id="62543-581">永遠擲回 <see cref="T:System.NotSupportedException" /> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="62543-581">Always throws a <see cref="T:System.NotSupportedException" /> exception.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-582"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不支援傳回使用者的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-582">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class does not support returning the user's password.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="62543-583"><see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 不支援密碼擷取。</span><span class="sxs-lookup"><span data-stu-id="62543-583">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> does not support password retrieval.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-584">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-584">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetUser">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="62543-585">取得 Active Directory 資料存放區中成員資格使用者的資訊。</span><span class="sxs-lookup"><span data-stu-id="62543-585">Gets the information from a membership user in the Active Directory data store.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser GetUser (object providerUserKey, bool userIsOnline);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser GetUser(object providerUserKey, bool userIsOnline) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUser (providerUserKey As Object, userIsOnline As Boolean) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ GetUser(System::Object ^ providerUserKey, bool userIsOnline);" />
      <MemberSignature Language="F#" Value="override this.GetUser : obj * bool -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.GetUser (providerUserKey, userIsOnline)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="providerUserKey" Type="System.Object" />
        <Parameter Name="userIsOnline" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="providerUserKey"><span data-ttu-id="62543-586">使用者的唯一識別項。</span><span class="sxs-lookup"><span data-stu-id="62543-586">The unique identifier for the user.</span></span></param>
        <param name="userIsOnline"><span data-ttu-id="62543-587"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> 方法會忽略這個參數。</span><span class="sxs-lookup"><span data-stu-id="62543-587">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> method ignores this parameter.</span></span></param>
        <summary><span data-ttu-id="62543-588">取得與指定之使用者金鑰關聯的成員資格使用者資訊。</span><span class="sxs-lookup"><span data-stu-id="62543-588">Gets the membership user information associated with the specified user key.</span></span></summary>
        <returns><span data-ttu-id="62543-589"><see cref="T:System.Web.Security.MembershipUser" /> 執行個體，表示指定的使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-589">A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user specified.</span></span> <span data-ttu-id="62543-590">如果在 Active Directory 資料存放區中找不到指定之 <paramref name="providerUserKey" /> 值的使用者，則會傳回 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-590">If no user is found in the Active Directory data store for the specified <paramref name="providerUserKey" /> value, <see langword="null" /> is returned.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-591"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A>方法會呼叫<xref:System.Web.Security.Membership>類別來擷取指定之使用者的詳細資訊，從 Active Directory 資料存放區。</span><span class="sxs-lookup"><span data-stu-id="62543-591">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A> method is called by the <xref:System.Web.Security.Membership> class to retrieve information on the specified user from the Active Directory data store.</span></span>  
  
 <span data-ttu-id="62543-592">搜尋會尋找的使用者執行個體的地方`objectSID`屬性相符項目`providerUserKey`參數。</span><span class="sxs-lookup"><span data-stu-id="62543-592">The search looks for a user instance where the `objectSID` attribute matches the `providerUserKey` parameter.</span></span>  
  
 <span data-ttu-id="62543-593">提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。</span><span class="sxs-lookup"><span data-stu-id="62543-593">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-594">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-594">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-595"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-595">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentException"><paramref name="providerUserKey" /> <span data-ttu-id="62543-596">不是 <see cref="T:System.Security.Principal.SecurityIdentifier" /> 類型。</span><span class="sxs-lookup"><span data-stu-id="62543-596">is not of type <see cref="T:System.Security.Principal.SecurityIdentifier" />.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="providerUserKey" /> <span data-ttu-id="62543-597">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-597">is <see langword="null" />.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="GetUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser GetUser (string username, bool userIsOnline);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser GetUser(string username, bool userIsOnline) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUser (username As String, userIsOnline As Boolean) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ GetUser(System::String ^ username, bool userIsOnline);" />
      <MemberSignature Language="F#" Value="override this.GetUser : string * bool -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.GetUser (username, userIsOnline)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="userIsOnline" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="62543-598">要取得資訊的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-598">The name of the user to get information for.</span></span></param>
        <param name="userIsOnline"><span data-ttu-id="62543-599"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> 方法會忽略這個參數。</span><span class="sxs-lookup"><span data-stu-id="62543-599">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> method ignores this parameter.</span></span></param>
        <summary><span data-ttu-id="62543-600">取得與指定之使用者名稱關聯的成員資格使用者資訊。</span><span class="sxs-lookup"><span data-stu-id="62543-600">Gets the membership user information associated with the specified user name.</span></span></summary>
        <returns><span data-ttu-id="62543-601"><see cref="T:System.Web.Security.MembershipUser" /> 執行個體，表示指定的使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-601">A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user specified.</span></span> <span data-ttu-id="62543-602">如果在 Active Directory 資料存放區中找不到指定之 <paramref name="username" /> 值的使用者，則會傳回 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-602">If no user is found in the Active Directory data store for the specified <paramref name="username" /> value, <see langword="null" /> is returned.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-603"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A>方法會呼叫<xref:System.Web.Security.Membership>類別來擷取指定之使用者的詳細資訊，從 Active Directory 資料存放區。</span><span class="sxs-lookup"><span data-stu-id="62543-603">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A> method is called by the <xref:System.Web.Security.Membership> class to retrieve information on the specified user from the Active Directory data store.</span></span>  
  
 <span data-ttu-id="62543-604">提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。</span><span class="sxs-lookup"><span data-stu-id="62543-604">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-605">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-605">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="62543-606">會修剪 `username` 參數值中的前置空格和後端空格。</span><span class="sxs-lookup"><span data-stu-id="62543-606">Leading and trailing spaces are trimmed from the `username` parameter value.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> <span data-ttu-id="62543-607">為空白，或是超過使用者名稱的長度上限 (通常是 256 個字元)。</span><span class="sxs-lookup"><span data-stu-id="62543-607">is empty, or exceeds the maximum length for the user name (usually 256 characters).</span></span>  
  
<span data-ttu-id="62543-608">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-608">-or-</span></span> 
 <paramref name="username" /> <span data-ttu-id="62543-609">包含逗號。</span><span class="sxs-lookup"><span data-stu-id="62543-609">contains commas.</span></span>  
  
<span data-ttu-id="62543-610">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-610">-or-</span></span> 
<span data-ttu-id="62543-611">使用者名稱會對應到 <see langword="userPrincipalName" /> 屬性，且 <paramref name="username" /> 參數會包含反斜線。</span><span class="sxs-lookup"><span data-stu-id="62543-611">The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> <span data-ttu-id="62543-612">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-612">is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-613"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-613">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-614">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-614">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetUserNameByEmail">
      <MemberSignature Language="C#" Value="public override string GetUserNameByEmail (string email);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string GetUserNameByEmail(string email) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUserNameByEmail (email As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ GetUserNameByEmail(System::String ^ email);" />
      <MemberSignature Language="F#" Value="override this.GetUserNameByEmail : string -&gt; string" Usage="activeDirectoryMembershipProvider.GetUserNameByEmail email" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="email" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="email"><span data-ttu-id="62543-615">要搜尋的電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="62543-615">The email address to search for.</span></span></param>
        <summary><span data-ttu-id="62543-616">取得與所指定電子郵件地址建立關聯的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-616">Gets the user name associated with the specified email address.</span></span></summary>
        <returns><span data-ttu-id="62543-617">與所指定電子郵件地址建立關聯的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-617">The user name associated with the specified email address.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-618">這個方法會呼叫<xref:System.Web.Security.Membership>類別來擷取 Active Directory 資料存放區中的使用者名稱根據使用者的電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="62543-618">This method is called by the <xref:System.Web.Security.Membership> class to retrieve a user name from the Active Directory data store based on the email address for the user.</span></span>  
  
 <span data-ttu-id="62543-619">如果成員資格資料存放區中的多個使用者具有相同的電子郵件地址，則會傳回第一個遇到的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-619">If more than one user in the membership data store has the same email address, the first user name encountered is returned.</span></span> <span data-ttu-id="62543-620">您可以設定`requiresUniqueEmail`的屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目`true`應用程式組態檔，以確保每封電子郵件位址在資料庫中的是唯一的。</span><span class="sxs-lookup"><span data-stu-id="62543-620">You can set the `requiresUniqueEmail` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element to `true` in the application configuration file to ensure that each email address in the database is unique.</span></span>  
  
 <span data-ttu-id="62543-621">會修剪 `email` 參數值中的前置空格和後端空格。</span><span class="sxs-lookup"><span data-stu-id="62543-621">Leading and trailing spaces are trimmed from the `email` parameter value.</span></span> <span data-ttu-id="62543-622">如果電子郵件地址是空的修剪後<xref:System.ArgumentException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="62543-622">If the email address is empty after trimming, an <xref:System.ArgumentException> is thrown.</span></span> <span data-ttu-id="62543-623">如果電子郵件地址`null`會搜尋 Active Directory 資料存放區中的所有使用者名稱，且會傳回第一個使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-623">If the email address is `null`, all user names in the Active Directory data store are searched, and the first user name is returned.</span></span>  
  
 <span data-ttu-id="62543-624">我們建議您不要啟用搜尋在實際系統上，直到您已確認所簽發的搜尋查詢<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不造成不良影響您的目錄伺服器的效能。</span><span class="sxs-lookup"><span data-stu-id="62543-624">We recommend that you do not enable searching on production systems until you have confirmed that the search queries issued by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class do not adversely impact your directory server's performance.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="62543-625"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail%2A>方法會執行，即使<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性是`false`。</span><span class="sxs-lookup"><span data-stu-id="62543-625">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail%2A> method will run even when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A> property is `false`.</span></span>  
  
 <span data-ttu-id="62543-626">由於<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別設計為無狀態 Web 環境，就無法使用由基礎分頁最佳化<xref:System.DirectoryServices>Api。</span><span class="sxs-lookup"><span data-stu-id="62543-626">Since the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class is designed for a stateless Web environment, it is unable to use the paging optimizations exposed by the underlying <xref:System.DirectoryServices> APIs.</span></span> <span data-ttu-id="62543-627">這表示在對大型目錄搜尋時的分頁作業相當耗費資源，應該予以避免。</span><span class="sxs-lookup"><span data-stu-id="62543-627">This means that paging operations during searches against large directories are very expensive and should be avoided.</span></span> <span data-ttu-id="62543-628">搜尋作業一定會針對在連接字串中，設定的目錄伺服器或在連接字串指向網域的情況下會自動選取的伺服器發出。</span><span class="sxs-lookup"><span data-stu-id="62543-628">Search operations are always issued against the directory server configured in the connection string, or an automatically selected server in the case of a connection string pointing at a domain.</span></span> <span data-ttu-id="62543-629">提供者不會使用其搜尋方法的通用類別目錄。</span><span class="sxs-lookup"><span data-stu-id="62543-629">The provider does not use a global catalog for its search methods.</span></span>  
  
 <span data-ttu-id="62543-630">提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。</span><span class="sxs-lookup"><span data-stu-id="62543-630">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-631">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-631">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="email" /> <span data-ttu-id="62543-632">超過 256 個字元</span><span class="sxs-lookup"><span data-stu-id="62543-632">exceeds 256 characters</span></span> 
<span data-ttu-id="62543-633">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-633">-or-</span></span> 
<span data-ttu-id="62543-634">修剪後 <paramref name="email" /> 是空的。</span><span class="sxs-lookup"><span data-stu-id="62543-634">after trimming, <paramref name="email" /> is empty.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="62543-635">資料存放區中的多位使用者有相同的電子郵件地址，且 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> 屬性值為 <see langword="true" />。</span><span class="sxs-lookup"><span data-stu-id="62543-635">More than one user exists in the data store with the same email address and the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property value is <see langword="true" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-636">提供者未初始化。</span><span class="sxs-lookup"><span data-stu-id="62543-636">The provider is not initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-637">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-637">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Initialize">
      <MemberSignature Language="C#" Value="public override void Initialize (string name, System.Collections.Specialized.NameValueCollection config);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Initialize(string name, class System.Collections.Specialized.NameValueCollection config) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Initialize (name As String, config As NameValueCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Initialize(System::String ^ name, System::Collections::Specialized::NameValueCollection ^ config);" />
      <MemberSignature Language="F#" Value="override this.Initialize : string * System.Collections.Specialized.NameValueCollection -&gt; unit" Usage="activeDirectoryMembershipProvider.Initialize (name, config)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="name" Type="System.String" />
        <Parameter Name="config" Type="System.Collections.Specialized.NameValueCollection" />
      </Parameters>
      <Docs>
        <param name="name"><span data-ttu-id="62543-638">要初始化的 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-638">The name of the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance to initialize.</span></span></param>
        <param name="config"><span data-ttu-id="62543-639"><see cref="T:System.Collections.Specialized.NameValueCollection" />，包含成員資格提供者之組態選項的名稱和值。</span><span class="sxs-lookup"><span data-stu-id="62543-639">A <see cref="T:System.Collections.Specialized.NameValueCollection" /> containing the names and values of the configuration options for the membership provider.</span></span></param>
        <summary><span data-ttu-id="62543-640">使用應用程式組態檔中的屬性值，初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-640">Initializes the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance with the property values from the application's configuration files.</span></span> <span data-ttu-id="62543-641">這個方法並不適合從您的程式碼呼叫。</span><span class="sxs-lookup"><span data-stu-id="62543-641">This method is not intended to be called from your code.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-642">這個方法會初始化<xref:System.Web.Security.ActiveDirectoryMembershipProvider>ASP.NET 應用程式組態檔 (Web.config) 中指定的屬性值的物件，而不是直接從您的程式碼使用。</span><span class="sxs-lookup"><span data-stu-id="62543-642">This method initializes the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> object with the property values specified in the ASP.NET application configuration file (Web.config) and is not intended to be used directly from your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="config" /> <span data-ttu-id="62543-643">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-643">is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="62543-644">應用程式組態中指定的 <see langword="applicationName" /> 屬性超過 256 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-644">The <see langword="applicationName" /> attribute specified in the application configuration exceeds 256 characters.</span></span>  
  
<span data-ttu-id="62543-645">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-645">-or-</span></span> 
<span data-ttu-id="62543-646"><see langword="connectionStringName" /> 屬性是空的，或不在應用程式組態中。</span><span class="sxs-lookup"><span data-stu-id="62543-646">The <see langword="connectionStringName" /> attribute is empty or does not exist in the application configuration.</span></span>  
  
<span data-ttu-id="62543-647">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-647">-or-</span></span> 
<span data-ttu-id="62543-648">應用程式組態檔中 <see langword="connectionStringName" /> 屬性所指定的連接字串是空的或不存在。</span><span class="sxs-lookup"><span data-stu-id="62543-648">The connection string specified in the <see langword="connectionStringName" /> attribute in the application configuration file is empty or does not exist.</span></span>  
  
<span data-ttu-id="62543-649">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-649">-or-</span></span> 
<span data-ttu-id="62543-650">在應用程式組態檔中將 <see langword="connectionProtection" /> 屬性設為 <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> 或 <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> 以外的值。</span><span class="sxs-lookup"><span data-stu-id="62543-650">The <see langword="connectionProtection" /> attribute is set to a value other than <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> or <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> in the application configuration file.</span></span>  
  
<span data-ttu-id="62543-651">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-651">-or-</span></span> 
<span data-ttu-id="62543-652">在應用程式組態檔中指定了 <see langword="connectionUsername" /> 屬性，但其值是空的。</span><span class="sxs-lookup"><span data-stu-id="62543-652">The <see langword="connectionUsername" /> attribute is specified in the application configuration file but its value is empty.</span></span>  
  
<span data-ttu-id="62543-653">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-653">-or-</span></span> 
<span data-ttu-id="62543-654">在應用程式組態檔中指定了 <see langword="connectionPassword" /> 屬性，但其值是空的。</span><span class="sxs-lookup"><span data-stu-id="62543-654">The <see langword="connectionPassword" /> attribute is specified in the application configuration file but its value is empty.</span></span>  
  
<span data-ttu-id="62543-655">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-655">-or-</span></span> 
<span data-ttu-id="62543-656">在應用程式組態檔中指定了 <see langword="connectionUsername" /> 屬性或 <see langword="connectionPassword" /> 屬性，但未同時指定兩者。</span><span class="sxs-lookup"><span data-stu-id="62543-656">Either the <see langword="connectionUsername" /> attribute or the <see langword="connectionPassword" /> attribute is specified in the application configuration file, but not both.</span></span>  
  
<span data-ttu-id="62543-657">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-657">-or-</span></span> 
<span data-ttu-id="62543-658">指定了 <see langword="clientSearchTimeout" /> 屬性，但是並非正整數。</span><span class="sxs-lookup"><span data-stu-id="62543-658">The <see langword="clientSearchTimeout" /> attribute is specified but is not a positive integer.</span></span>  
  
<span data-ttu-id="62543-659">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-659">-or-</span></span> 
<span data-ttu-id="62543-660">指定了 <see langword="serverSearchTimeout" /> 屬性，但是並非正整數。</span><span class="sxs-lookup"><span data-stu-id="62543-660">The <see langword="serverSearchTimeout" /> attribute is specified but is not a positive integer.</span></span>  
  
<span data-ttu-id="62543-661">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-661">-or-</span></span> 
<span data-ttu-id="62543-662">指定了 <see langword="enableSearchMethods" /> 屬性，但是並非布林值。</span><span class="sxs-lookup"><span data-stu-id="62543-662">The <see langword="enableSearchMethods" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="62543-663">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-663">-or-</span></span> 
<span data-ttu-id="62543-664">指定了 <see langword="requiresUniqueEmail" /> 屬性，但是並非布林值。</span><span class="sxs-lookup"><span data-stu-id="62543-664">The <see langword="requiresUniqueEmail" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="62543-665">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-665">-or-</span></span> 
<span data-ttu-id="62543-666">指定了 <see langword="enablePasswordReset" /> 屬性，但是並非布林值。</span><span class="sxs-lookup"><span data-stu-id="62543-666">The <see langword="enablePasswordReset" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="62543-667">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-667">-or-</span></span> 
<span data-ttu-id="62543-668">指定了 <see langword="requiresQuestionAndAnswer" /> 屬性，但是並非布林值。</span><span class="sxs-lookup"><span data-stu-id="62543-668">The <see langword="requiresQuestionAndAnswer" /> attribute is specified, but is not a Boolean value.</span></span>  
  
<span data-ttu-id="62543-669">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-669">-or-</span></span> 
<span data-ttu-id="62543-670">指定了 <see langword="minRequiredPasswordLength" /> 屬性，但它是負數或大於 128。</span><span class="sxs-lookup"><span data-stu-id="62543-670">The <see langword="minRequiredPasswordLength" /> attribute is specified and it is either negative or greater than 128.</span></span>  
  
<span data-ttu-id="62543-671">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-671">-or-</span></span> 
<span data-ttu-id="62543-672">指定了 <see langword="minRequiredNonalphanumericCharacters" /> 屬性，但它是負數或大於 128。</span><span class="sxs-lookup"><span data-stu-id="62543-672">The <see langword="minRequiredNonalphanumericCharacters" /> attribute is specified and it is either negative or greater than 128.</span></span>  
  
<span data-ttu-id="62543-673">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-673">-or-</span></span> 
<span data-ttu-id="62543-674">在應用程式組態檔的 <see langword="passwordStrengthRegularExpression" /> 屬性中指定的規則運算式不是有效的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="62543-674">The regular expression specified in the <see langword="passwordStrengthRegularExpression" /> attribute in the application configuration file is not a valid regular expression</span></span> 
<span data-ttu-id="62543-675">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-675">-or-</span></span> 
<span data-ttu-id="62543-676">指定了 <see langword="attributeMapUsername" /> 屬性，但它是空字串。</span><span class="sxs-lookup"><span data-stu-id="62543-676">The <see langword="attributeMapUsername" /> attribute is specified, but it is an empty string.</span></span>  
  
<span data-ttu-id="62543-677">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-677">-or-</span></span> 
<span data-ttu-id="62543-678"><see langword="connectionString" /> 屬性不以 "LDAP" 開頭。</span><span class="sxs-lookup"><span data-stu-id="62543-678">The <see langword="connectionString" /> attribute does not begin with "LDAP".</span></span>  
  
<span data-ttu-id="62543-679">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-679">-or-</span></span> 
<span data-ttu-id="62543-680"><see langword="connectionString" /> 屬性中指定的連接字串無效。</span><span class="sxs-lookup"><span data-stu-id="62543-680">The connection string specified in the <see langword="connectionString" /> attribute is invalid.</span></span>  
  
<span data-ttu-id="62543-681">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-681">-or-</span></span> 
<span data-ttu-id="62543-682"><see langword="connectionString" /> 屬性中的連接字串指定了無伺服器的繫結。</span><span class="sxs-lookup"><span data-stu-id="62543-682">The connection string in the <see langword="connectionString" /> attribute specifies a server-less bind.</span></span>  
  
<span data-ttu-id="62543-683">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-683">-or-</span></span> 
<span data-ttu-id="62543-684"><see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 無法建立與網域或目錄伺服器的連接。</span><span class="sxs-lookup"><span data-stu-id="62543-684">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not establish a connection with the domain or directory server.</span></span>  
  
<span data-ttu-id="62543-685">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-685">-or-</span></span> 
<span data-ttu-id="62543-686"><see langword="connectionProtection" /> 屬性設為 <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" />，但無法與伺服器建立 SSL 或簽章和密封的連接。</span><span class="sxs-lookup"><span data-stu-id="62543-686">The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" />, but neither an SSL nor a signed and sealed connection can be established with the server.</span></span>  
  
<span data-ttu-id="62543-687">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-687">-or-</span></span> 
<span data-ttu-id="62543-688"><see langword="connectionProtection" /> 屬性設為 <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" />，但 <see langword="connectionUsername" /> 和 <see langword="connectionPassword" /> 屬性都未設定。</span><span class="sxs-lookup"><span data-stu-id="62543-688">The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> but the <see langword="connectionUsername" /> and <see langword="connectionPassword" /> attributes are not set.</span></span>  
  
<span data-ttu-id="62543-689">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-689">-or-</span></span> 
<span data-ttu-id="62543-690"><see langword="connectionProtection" /> 屬性設為 <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" />，但 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 無法與 ADAM 伺服器建立 SSL 連接。</span><span class="sxs-lookup"><span data-stu-id="62543-690">The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not establish an SSL connection with an ADAM server.</span></span>  
  
<span data-ttu-id="62543-691">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-691">-or-</span></span> 
<span data-ttu-id="62543-692"><see langword="connectionString" /> 屬性指定了通用類別目錄 (GC) 或 SSL 通用類別目錄通訊埠。</span><span class="sxs-lookup"><span data-stu-id="62543-692">The <see langword="connectionString" /> attribute specifies either the global catalog (GC) or an SSL global catalog port.</span></span>  
  
<span data-ttu-id="62543-693">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-693">-or-</span></span> 
<span data-ttu-id="62543-694"><see langword="connectionString" /> 屬性指定了 Active Directory 伺服器或網域，但 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 無法擷取網域的預設命名內容。</span><span class="sxs-lookup"><span data-stu-id="62543-694">The <see langword="connectionString" /> attribute specifies an Active Directory server or domain, but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not retrieve the default naming context for the domain.</span></span>  
  
<span data-ttu-id="62543-695">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-695">-or-</span></span> 
<span data-ttu-id="62543-696"><see langword="connectionString" /> 屬性指定了 Active Directory 伺服器或網域，但 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 無法擷取預設使用者容器。</span><span class="sxs-lookup"><span data-stu-id="62543-696">The <see langword="connectionString" /> attribute specifies an Active Directory server or domain, but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not retrieve the default users container.</span></span>  
  
<span data-ttu-id="62543-697">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-697">-or-</span></span> 
<span data-ttu-id="62543-698"><see langword="connectionString" /> 屬性指定了 ADAM 伺服器，但它未指定應用程式分割或容器。</span><span class="sxs-lookup"><span data-stu-id="62543-698">The <see langword="connectionString" /> attribute specifies an ADAM server, but it does not specify an application partition or container.</span></span>  
  
<span data-ttu-id="62543-699">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-699">-or-</span></span> 
<span data-ttu-id="62543-700"><see langword="connectionString" /> 屬性指定了應用程式分割或容器，但指定的容器不存在。</span><span class="sxs-lookup"><span data-stu-id="62543-700">The <see langword="connectionString" /> attribute specifies an application partition or container, but the specified container does not exist.</span></span>  
  
<span data-ttu-id="62543-701">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-701">-or-</span></span> 
<span data-ttu-id="62543-702"><see langword="connectionString" /> 屬性指定的容器不允許包含使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-702">The <see langword="connectionString" /> attribute specifies a container that is not allowed to contain user instances.</span></span>  
  
<span data-ttu-id="62543-703">指定了屬性對應，但其值是空的。</span><span class="sxs-lookup"><span data-stu-id="62543-703">An attribute mapping is specified but its value was empty.</span></span>  
  
<span data-ttu-id="62543-704">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-704">-or-</span></span> 
<span data-ttu-id="62543-705">兩次指定了屬性對應。</span><span class="sxs-lookup"><span data-stu-id="62543-705">An attribute mapping is specified twice.</span></span>  
  
<span data-ttu-id="62543-706">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-706">-or-</span></span> 
<span data-ttu-id="62543-707">指定了屬性對應，但該屬性在使用者執行個體上不存在。</span><span class="sxs-lookup"><span data-stu-id="62543-707">An attribute mapping is specified but the attribute does not exist on the user instance.</span></span>  
  
<span data-ttu-id="62543-708">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-708">-or-</span></span> 
<span data-ttu-id="62543-709">指定了屬性對應，但目錄屬性的資料型別不正確。</span><span class="sxs-lookup"><span data-stu-id="62543-709">An attribute mapping is specified but the directory attribute is not of the correct data type.</span></span>  
  
<span data-ttu-id="62543-710">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-710">-or-</span></span> 
<span data-ttu-id="62543-711">指定了屬性對應，但目錄屬性有多個值。</span><span class="sxs-lookup"><span data-stu-id="62543-711">An attribute mapping is specified but the directory attribute is multi-valued.</span></span>  
  
<span data-ttu-id="62543-712">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-712">-or-</span></span> 
<span data-ttu-id="62543-713">指定了 <see langword="attributeMapUserName" /> 屬性，但在連線至 Active Directory 時既未對應至 <c>sAMAccountName</c> 也未對應至 <c>userPrincipalName</c> 目錄屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-713">The <see langword="attributeMapUserName" /> attribute is specified but was mapped to neither the <c>sAMAccountName</c> nor the <c>userPrincipalName</c> directory attribute when connecting to an Active Directory.</span></span>  
  
<span data-ttu-id="62543-714">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-714">-or-</span></span> 
<span data-ttu-id="62543-715">指定了 <see langword="attributeMapUserName" /> 屬性，但在連線至 ADAM 伺服器時未對應至 <c>userPrincipalName</c> 目錄屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-715">The <see langword="attributeMapUserName" /> attribute is specified but was not mapped to the <c>userPrincipalName</c> directory attribute when connecting to an ADAM server.</span></span>  
  
<span data-ttu-id="62543-716">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-716">-or-</span></span> 
<span data-ttu-id="62543-717">應用程式組態檔中的 <see langword="enablePasswordReset" /> 屬性為 <see langword="true" />，而 <see langword="requiresQuestionAndAnswer" /> 屬性為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-717">The <see langword="enablePasswordReset" /> attribute is <see langword="true" /> and the <see langword="requiresQuestionAndAnswer" /> attribute is <see langword="false" /> in the application configuration file.</span></span>  
  
<span data-ttu-id="62543-718">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-718">-or-</span></span> 
<span data-ttu-id="62543-719">指定了 <see langword="maxInvalidPasswordAttempts" /> 屬性，但不是非零的正整數。</span><span class="sxs-lookup"><span data-stu-id="62543-719">The <see langword="maxInvalidPasswordAttempts" /> attribute was specified but is not a non-zero positive integer.</span></span>  
  
<span data-ttu-id="62543-720">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-720">-or-</span></span> 
<span data-ttu-id="62543-721">指定了 <see langword="passwordAttemptWindow" /> 屬性，但不是非零的正整數。</span><span class="sxs-lookup"><span data-stu-id="62543-721">The <see langword="passwordAttemptWindow" /> attribute was specified but is not a non-zero positive integer.</span></span>  
  
<span data-ttu-id="62543-722">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-722">-or-</span></span> 
<span data-ttu-id="62543-723">指定了 <see langword="passwordAnswerAttemptLockoutDuration" /> 屬性，但不是非零的正整數。</span><span class="sxs-lookup"><span data-stu-id="62543-723">The <see langword="passwordAnswerAttemptLockoutDuration" /> attribute was specified but is not a non-zero positive integer.</span></span>  
  
<span data-ttu-id="62543-724">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-724">-or-</span></span> 
<span data-ttu-id="62543-725"><see langword="enablePasswordReset" /> 屬性為 <see langword="true" />，且 <see langword="attributeMapFailedPasswordAnswerCount" />、<see langword="attributeMapFailedPasswordAnswerTime" /> 和 <see langword="attributeMapFailedPasswordAnswerLockoutTime" /> 中的任何一個屬性是空的。</span><span class="sxs-lookup"><span data-stu-id="62543-725">The <see langword="enablePasswordReset" /> attribute is <see langword="true" /> and any of the <see langword="attributeMapFailedPasswordAnswerCount" />, <see langword="attributeMapFailedPasswordAnswerTime" />, and <see langword="attributeMapFailedPasswordAnswerLockoutTime" /> attributes are empty.</span></span>  
  
<span data-ttu-id="62543-726">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-726">-or-</span></span> 
<span data-ttu-id="62543-727"><see langword="requiresQuestionAndAnswer" /> 屬性為 <see langword="true" />，但 <see langword="attributeMapPasswordQuestion" /> 或 <see langword="attributeMapPasswordAnswer" /> 屬性是空的。</span><span class="sxs-lookup"><span data-stu-id="62543-727">The <see langword="requiresQuestionAndAnswer" /> attribute is <see langword="true" /> but either the <see langword="attributeMapPasswordQuestion" /> or the <see langword="attributeMapPasswordAnswer" /> attribute is empty.</span></span>  
  
<span data-ttu-id="62543-728">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-728">-or-</span></span> 
<span data-ttu-id="62543-729">在應用程式組態檔中指定的屬性無效。</span><span class="sxs-lookup"><span data-stu-id="62543-729">An attribute specified in the application configuration file is not valid.</span></span></exception>
        <exception cref="T:System.Web.HttpException"><span data-ttu-id="62543-730">應用程式正在裝載環境中執行，且 <see cref="T:System.Web.AspNetHostingPermissionLevel" /> 設為 <see cref="F:System.Web.AspNetHostingPermissionLevel.Minimal" />。</span><span class="sxs-lookup"><span data-stu-id="62543-730">The application is running in a hosted environment and the <see cref="T:System.Web.AspNetHostingPermissionLevel" /> is set to <see cref="F:System.Web.AspNetHostingPermissionLevel.Minimal" />.</span></span></exception>
        <exception cref="T:System.Runtime.InteropServices.COMException"><span data-ttu-id="62543-731">查詢目錄時發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="62543-731">An error occurred while querying the directory.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-732">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-732">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MaxInvalidPasswordAttempts">
      <MemberSignature Language="C#" Value="public override int MaxInvalidPasswordAttempts { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MaxInvalidPasswordAttempts" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MaxInvalidPasswordAttempts As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MaxInvalidPasswordAttempts { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MaxInvalidPasswordAttempts : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-733">取得允許使用者對密碼重設問題失敗的回應嘗試次數。</span><span class="sxs-lookup"><span data-stu-id="62543-733">Gets the number of failed answer attempts a user is allowed for the password-reset question.</span></span></summary>
        <value><span data-ttu-id="62543-734">在鎖定帳戶之前，允許使用者失敗的密碼回應嘗試次數。</span><span class="sxs-lookup"><span data-stu-id="62543-734">The number of failed password answer attempts a user is allowed before the account is locked.</span></span> <span data-ttu-id="62543-735">預設值是<c>5</c>。</span><span class="sxs-lookup"><span data-stu-id="62543-735">The default is <c>5</c>.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-736">當<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，使用者必須回答密碼問題，重設其密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-736">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user must answer the password question to reset his or her password.</span></span> <span data-ttu-id="62543-737">允許使用者有限的數目的回應嘗試藉由在時間間隔內<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-737">The user is allowed a limited number of answer attempts within the time window established by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property.</span></span> <span data-ttu-id="62543-738">密碼解答嘗試次數大於或等於中儲存的值是否<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性，使用者遭到鎖定進一步嘗試分鐘數儲存在<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-738">If the number of password answer attempts is greater than or equal to the value stored in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property, the user is locked out of further attempts for the number of minutes stored in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62543-739">這個屬性不會控制使用者能夠進行會鎖定的登入失敗的次數。Active Directory 伺服器會處理登入嘗試失敗，並不會受到這個屬性的值。</span><span class="sxs-lookup"><span data-stu-id="62543-739">This property does not control the number of failed logon attempts a user can make before being locked out. The Active Directory server handles failed logon attempts and is not affected by the value of this property.</span></span>  
  
 <span data-ttu-id="62543-740"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性會設定您的應用程式組態檔案中，使用`maxInvalidPasswordAttempts`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。</span><span class="sxs-lookup"><span data-stu-id="62543-740">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property is set in your application's configuration file using the `maxInvalidPasswordAttempts` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="62543-741">如果應用程式的組態檔中，未設定的屬性<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性設定的預設值為`5`。</span><span class="sxs-lookup"><span data-stu-id="62543-741">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property is set to the default value of `5`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-742">下列程式碼範例顯示 Web.config 項目設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>在 10 分鐘時段群組裡輸入的密碼解答嘗試要鎖定進行三個失敗的使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-742">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to lock out users who make three failed attempts to enter the password answer in a 10-minute time window.</span></span> <span data-ttu-id="62543-743">如果使用者已遭鎖定，再嘗試回答密碼問題可能 15 分鐘進行。</span><span class="sxs-lookup"><span data-stu-id="62543-743">If the user is locked out, no further attempts to answer the password question may be made for 15 minutes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
          passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-744">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" /> 執行個體之前，已先嘗試存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-744">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-745">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-745">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MinRequiredNonAlphanumericCharacters">
      <MemberSignature Language="C#" Value="public override int MinRequiredNonAlphanumericCharacters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinRequiredNonAlphanumericCharacters" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MinRequiredNonAlphanumericCharacters As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MinRequiredNonAlphanumericCharacters { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinRequiredNonAlphanumericCharacters : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-746">取得有效密碼中必須具有的最小特殊字元數。</span><span class="sxs-lookup"><span data-stu-id="62543-746">Gets the minimum number of special characters that must be present in a valid password.</span></span></summary>
        <value><span data-ttu-id="62543-747">有效密碼中必須具有的最小特殊字元數。</span><span class="sxs-lookup"><span data-stu-id="62543-747">The minimum number of special characters that must be present in a valid password.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-748"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>屬性會傳回特殊的非英數字元，必須輸入要建立有效的密碼最小數目。</span><span class="sxs-lookup"><span data-stu-id="62543-748">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> property returns the minimum number of special, non-alphanumeric characters that must be entered to create a valid password.</span></span>  
  
 <span data-ttu-id="62543-749"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>屬性值會設定在應用程式組態中使用`minRequiredNonalphanumericCharacters`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)組態項目。</span><span class="sxs-lookup"><span data-stu-id="62543-749">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> property value is set in the application configuration using the `minRequiredNonalphanumericCharacters` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element.</span></span>  
  
 <span data-ttu-id="62543-750">非英數的字元是字元，<xref:System.Char.IsLetterOrDigit%2A>方法會傳回`false`。</span><span class="sxs-lookup"><span data-stu-id="62543-750">A non-alphanumeric character is a character for which the <xref:System.Char.IsLetterOrDigit%2A> method returns `false`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-751">下列範例所示[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)中的組態項目`system.web`應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="62543-751">The following example shows the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element in the `system.web` section of the application's Web.config file.</span></span> <span data-ttu-id="62543-752">它會指定應用程式使用的執行個體<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別，以提供成員資格服務和集`minRequiredNonalphanumericCharacters`屬性設定為一個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-752">It specifies that the application use an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class to provide membership services, and sets the `minRequiredNonalphanumericCharacters` attribute to one character.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          minRequiredNonalphanumericCharacters = "1" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-753">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> 執行個體之前，會存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-753">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-754">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-754">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MinRequiredPasswordLength">
      <MemberSignature Language="C#" Value="public override int MinRequiredPasswordLength { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinRequiredPasswordLength" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MinRequiredPasswordLength As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MinRequiredPasswordLength { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinRequiredPasswordLength : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-755">取得密碼所需的最小長度。</span><span class="sxs-lookup"><span data-stu-id="62543-755">Gets the minimum length required for a password.</span></span></summary>
        <value><span data-ttu-id="62543-756">密碼所需的最小長度。</span><span class="sxs-lookup"><span data-stu-id="62543-756">The minimum length required for a password.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-757"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>屬性會取得必須建立有效的密碼輸入的字元數目下限。</span><span class="sxs-lookup"><span data-stu-id="62543-757">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> property gets the minimum number of characters that must be entered to create a valid password.</span></span>  
  
 <span data-ttu-id="62543-758"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>屬性值會設定在應用程式組態中使用`minRequiredPasswordLength`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)組態項目。</span><span class="sxs-lookup"><span data-stu-id="62543-758">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> property value is set in the application configuration using the `minRequiredPasswordLength` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-759">下列範例所示[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)中的組態項目`system.web`應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="62543-759">The following example shows the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element in the `system.web` section of the application's Web.config file.</span></span> <span data-ttu-id="62543-760">它會指定應用程式使用的執行個體<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別，以提供成員資格服務和集`minRequiredPasswordLength`屬性設定為七個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-760">It specifies that the application use an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class to provide membership services, and sets the `minRequiredPasswordLength` attribute to seven characters.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          minRequiredPasswordLength = "7" />  
  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-761">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> 執行個體之前，會存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-761">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-762">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-762">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordAnswerAttemptLockoutDuration">
      <MemberSignature Language="C#" Value="public int PasswordAnswerAttemptLockoutDuration { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 PasswordAnswerAttemptLockoutDuration" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property PasswordAnswerAttemptLockoutDuration As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int PasswordAnswerAttemptLockoutDuration { int get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordAnswerAttemptLockoutDuration : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-763">取得時間長度，使用者嘗試錯誤密碼回應的次數太多時，會在這個期間鎖定使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="62543-763">Get the length of time for which a user account is locked out after the user makes too many bad password-answer attempts.</span></span></summary>
        <value><span data-ttu-id="62543-764">在使用者提供不正確的密碼回應次數太多時鎖定使用者的時間 (以分鐘為單位)。</span><span class="sxs-lookup"><span data-stu-id="62543-764">The time, in minutes, that a user is locked out after providing too many incorrect password answers.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-765">當<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，使用者必須回答密碼問題，重設其密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-765">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user must answer the password question to reset his or her password.</span></span> <span data-ttu-id="62543-766">如果使用者無法提供正確答案連續的次數等於<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>觀察所指定的時間週期內的屬性值<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性，使用者更進一步的嘗試遭到鎖定的分鐘數包含在<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-766">If the user fails to supply the correct answer a consecutive number of times equal to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property value within the observation time period specified by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property, the user is locked out of further attempts for the number of minutes contained in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62543-767">這個屬性未設定使用者無法輸入有效的密碼之後，已遭鎖定的持續時間。</span><span class="sxs-lookup"><span data-stu-id="62543-767">This property does not set the duration a user is locked out after failing to enter a valid password.</span></span> <span data-ttu-id="62543-768">Active Directory 伺服器會處理登入嘗試失敗，並不會受到這個屬性的值。</span><span class="sxs-lookup"><span data-stu-id="62543-768">The Active Directory server handles failed logon attempts and is not affected by the value of this property.</span></span> <span data-ttu-id="62543-769">我們建議<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性設定為相同的值為帳戶鎖定期間指定太多失敗 Active Directory 組態中的登入嘗試。</span><span class="sxs-lookup"><span data-stu-id="62543-769">We recommend that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property be set to the same value as the account lockout duration specified for too many failed logon attempts in the Active Directory configuration.</span></span> <span data-ttu-id="62543-770">這將會顯示使用者，而不論是否在已鎖定由於嘗試登入失敗或不正確的密碼解答的一致的自動鎖定行為。</span><span class="sxs-lookup"><span data-stu-id="62543-770">This will present consistent auto-lockout behavior for users regardless of whether they were locked out due to failed logon attempts or to bad password answers.</span></span>  
  
 <span data-ttu-id="62543-771"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性會設定您的應用程式組態檔案中，使用`passwordAnswerAttemptLockoutDuration`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。</span><span class="sxs-lookup"><span data-stu-id="62543-771">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set in your application's configuration file using the `passwordAnswerAttemptLockoutDuration` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="62543-772">如果屬性未設定應用程式的組態檔中，<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性設定為預設值為 30 分鐘。</span><span class="sxs-lookup"><span data-stu-id="62543-772">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set to the default value of 30 minutes.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-773">下列程式碼範例顯示 Web.config 項目設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>在 10 分鐘時段群組裡輸入的密碼解答嘗試要鎖定進行三個失敗的使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-773">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to lock out users who make three failed attempts to enter the password answer in a 10-minute time window.</span></span> <span data-ttu-id="62543-774">如果使用者已遭鎖定，再嘗試回答密碼問題可能 15 分鐘進行。</span><span class="sxs-lookup"><span data-stu-id="62543-774">If the user is locked out, no further attempts to answer the password question may be made for 15 minutes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
          passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-775">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" /> 執行個體之前，已先嘗試存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-775">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-776">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-776">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordAttemptWindow">
      <MemberSignature Language="C#" Value="public override int PasswordAttemptWindow { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 PasswordAttemptWindow" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordAttemptWindow As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int PasswordAttemptWindow { int get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordAttemptWindow : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-777">取得時間範圍，在此時間範圍內會追蹤提供有效密碼或有效密碼解答的連續失敗嘗試。</span><span class="sxs-lookup"><span data-stu-id="62543-777">Gets the time window during which consecutive failed attempts to provide a valid password or a valid password answer are tracked.</span></span></summary>
        <value><span data-ttu-id="62543-778">時間範圍 (以分鐘為單位)，在此時間範圍內會追蹤提供有效密碼或有效密碼解答的連續失敗嘗試。</span><span class="sxs-lookup"><span data-stu-id="62543-778">The time window, in minutes, during which consecutive failed attempts to provide a valid password or a valid password answer are tracked.</span></span> <span data-ttu-id="62543-779">預設值為 10 分鐘。</span><span class="sxs-lookup"><span data-stu-id="62543-779">The default is 10 minutes.</span></span> <span data-ttu-id="62543-780">如果每次失敗嘗試之間的間隔大於 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> 屬性設定，則 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體會將每次失敗嘗試都視為第一次失敗嘗試。</span><span class="sxs-lookup"><span data-stu-id="62543-780">If the interval between each failed attempt is greater than the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> property setting, the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance treats each failed attempt as if it were the first failed attempt.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-781"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性可搭配<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性，以協助您抵禦猜測密碼或密碼解答的成員資格使用者執行不必要的來源的重複嘗試。</span><span class="sxs-lookup"><span data-stu-id="62543-781">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property works in conjunction with the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property to help guard against an unwanted source guessing the password or password answer of a membership user through repeated attempts.</span></span> <span data-ttu-id="62543-782">當使用者嘗試登入、 變更其密碼，或重設其密碼時，只有特定數目的連續嘗試可以在指定的時間範圍內。</span><span class="sxs-lookup"><span data-stu-id="62543-782">When users are attempting to log in, change their password, or reset their password, only a certain number of consecutive attempts are allowed within a specified time window.</span></span> <span data-ttu-id="62543-783">所指定的時間間隔長度<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性，識別允許的無效嘗試之間的分鐘數。</span><span class="sxs-lookup"><span data-stu-id="62543-783">The length of the time window is specified by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property, which identifies the number of minutes allowed between invalid attempts.</span></span> <span data-ttu-id="62543-784">如果數目的連續失敗嘗試的使用者進行重設或密碼等於中儲存的值<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性，而時間後所經過的最後一個的無效嘗試小於指定的分鐘數<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性，則使用者帳戶 s 鎖定中所包含的分鐘數<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-784">If the number of consecutive failed attempts a user makes to reset his or her password equals the value stored in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property, and the time elapsed since the last invalid attempt is less than the number of minutes specified for the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property, then the user account s locked out for the number of minutes contained in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property.</span></span> <span data-ttu-id="62543-785">如果目前失敗的嘗試和上一次失敗的嘗試之間的間隔大於<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性設定，則目前的無效嘗試會視為第一次嘗試。</span><span class="sxs-lookup"><span data-stu-id="62543-785">If the interval between the current failed attempt and the last failed attempt is greater than the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property setting, the current invalid attempt is counted as the first attempt.</span></span> <span data-ttu-id="62543-786">如果達到允許的無效嘗試次數上限之前提供有效的密碼解答，則會不正確的密碼解答嘗試次數設定為零。</span><span class="sxs-lookup"><span data-stu-id="62543-786">If a valid password answer is supplied before the maximum number of allowed invalid attempts is reached, the count of invalid password-answer attempts is set to zero.</span></span> <span data-ttu-id="62543-787">如果允許無效的最大數目之前提供有效的密碼嘗試次數達到時，不正確的密碼嘗試次數的計數和無效的密碼解答嘗試計數設定為零。</span><span class="sxs-lookup"><span data-stu-id="62543-787">If a valid password is supplied before the maximum number of allowed invalid attempts is reached, the count of invalid password attempts and the count of invalid password-answer attempts are set to zero.</span></span>  
  
 <span data-ttu-id="62543-788">我們建議<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性設定為相同的值為 Active Directory 組態中嘗試次數的最大值的指定帳戶鎖定期間失敗的登入的次數。</span><span class="sxs-lookup"><span data-stu-id="62543-788">We recommend that the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property be set to the same value as the account lockout duration that is specified for the maximum number of failed logon attempts in the Active Directory configuration.</span></span> <span data-ttu-id="62543-789">是否會已鎖定由於嘗試登入失敗，或不正確的密碼回應，這將會顯示使用者的一致的自動鎖定行為。</span><span class="sxs-lookup"><span data-stu-id="62543-789">This will present consistent auto-lockout behavior for users whether they were locked out due to failed logon attempts or to bad password answers.</span></span>  
  
 <span data-ttu-id="62543-790"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性會設定您的應用程式組態檔案中，使用`passwordAttemptWindow`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。</span><span class="sxs-lookup"><span data-stu-id="62543-790">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set in your application's configuration file using the `passwordAttemptWindow` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="62543-791">如果屬性未設定應用程式的組態檔中，<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性設定為 10 分鐘的預設值。</span><span class="sxs-lookup"><span data-stu-id="62543-791">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property is set to the default value of 10 minutes.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-792">下列程式碼範例顯示 Web.config 項目設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>在 10 分鐘時段群組裡輸入的密碼解答嘗試要鎖定進行三個失敗的使用者執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-792">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to lock out users who make three failed attempts to enter the password answer in a 10-minute time window.</span></span> <span data-ttu-id="62543-793">如果使用者已遭鎖定，再嘗試回答密碼問題可能 15 分鐘進行。</span><span class="sxs-lookup"><span data-stu-id="62543-793">If the user is locked out, no further attempts to answer the password question may be made for 15 minutes.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
        passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-794">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> 執行個體之前，已先嘗試存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-794">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-795">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-795">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordFormat">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipPasswordFormat PasswordFormat { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.Security.MembershipPasswordFormat PasswordFormat" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordFormat As MembershipPasswordFormat" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::Web::Security::MembershipPasswordFormat PasswordFormat { System::Web::Security::MembershipPasswordFormat get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordFormat : System.Web.Security.MembershipPasswordFormat" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipPasswordFormat</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-796">取得值，表示 Active Directory 資料存放區中密碼的格式。</span><span class="sxs-lookup"><span data-stu-id="62543-796">Gets a value indicating the format of passwords in the Active Directory data store.</span></span></summary>
        <value><span data-ttu-id="62543-797">其中一個 <see cref="T:System.Web.Security.MembershipPasswordFormat" /> 值。</span><span class="sxs-lookup"><span data-stu-id="62543-797">One of the <see cref="T:System.Web.Security.MembershipPasswordFormat" /> values.</span></span> <span data-ttu-id="62543-798"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" /> 屬性一定會傳回 <see cref="F:System.Web.Security.MembershipPasswordFormat.Hashed" />。</span><span class="sxs-lookup"><span data-stu-id="62543-798">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" /> property always returns <see cref="F:System.Web.Security.MembershipPasswordFormat.Hashed" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-799"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>屬性不支援密碼擷取。</span><span class="sxs-lookup"><span data-stu-id="62543-799">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> property does not support password retrieval.</span></span> <span data-ttu-id="62543-800">行為<xref:System.Web.Security.ActiveDirectoryMembershipProvider>物件是使用其他提供者相同`Hashed`密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-800">The behavior of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> object is the same as other providers working with `Hashed` passwords.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-801">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-801">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PasswordStrengthRegularExpression">
      <MemberSignature Language="C#" Value="public override string PasswordStrengthRegularExpression { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string PasswordStrengthRegularExpression" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordStrengthRegularExpression As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ PasswordStrengthRegularExpression { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordStrengthRegularExpression : string" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-802">取得用來評估密碼的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="62543-802">Gets the regular expression used to evaluate a password.</span></span></summary>
        <value><span data-ttu-id="62543-803">用來評估密碼的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="62543-803">A regular expression used to evaluate a password.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-804"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>屬性取得用來評估密碼複雜度的規則運算式。</span><span class="sxs-lookup"><span data-stu-id="62543-804">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property gets the regular expression used to evaluate password complexity.</span></span>  
  
 <span data-ttu-id="62543-805"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>屬性不用來驗證中的自動產生密碼<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="62543-805">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property is not used to validate auto-generated passwords in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method.</span></span>  
  
 <span data-ttu-id="62543-806"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>屬性設定在應用程式組態中使用`passwordStrengthRegularExpression`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)組態項目。</span><span class="sxs-lookup"><span data-stu-id="62543-806">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property is set in the application configuration using the `passwordStrengthRegularExpression` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-807">下列範例所示[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)中的組態項目`system.web`應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="62543-807">The following example shows the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) configuration element in the `system.web` section of the application's Web.config file.</span></span> <span data-ttu-id="62543-808">它會指定應用程式使用的執行個體<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別，以提供成員資格服務和集`passwordStrengthRegularExpression`屬性驗證的密碼是否符合下列準則的規則運算式：</span><span class="sxs-lookup"><span data-stu-id="62543-808">It specifies that the application use an instance of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class to provide membership services and sets the `passwordStrengthRegularExpression` attribute to a regular expression that validates that the password meets the following criteria:</span></span>  
  
-   <span data-ttu-id="62543-809">Is greater than 七個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-809">Is greater than seven characters.</span></span>  
  
-   <span data-ttu-id="62543-810">包含至少一個數字。</span><span class="sxs-lookup"><span data-stu-id="62543-810">Contains at least one digit.</span></span>  
  
-   <span data-ttu-id="62543-811">包含至少一個特殊的 （非英數） 字元。</span><span class="sxs-lookup"><span data-stu-id="62543-811">Contains at least one special (non-alphanumeric) character.</span></span>  
  
 <span data-ttu-id="62543-812">如果密碼不符合這些準則，成員資格提供者不接受密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-812">If the password does not meet these criteria, the password is not accepted by the membership provider.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          passwordStrengthRegularExpression=  
            "@\"(?=.{6,})(?=(.*\d){1,})(?=(.*\W){1,})" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-813">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> 執行個體之前，會存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-813">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-814">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-814">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RequiresQuestionAndAnswer">
      <MemberSignature Language="C#" Value="public override bool RequiresQuestionAndAnswer { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RequiresQuestionAndAnswer" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property RequiresQuestionAndAnswer As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool RequiresQuestionAndAnswer { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.RequiresQuestionAndAnswer : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-815">取得值，指出是否設定成員資格提供者在建立使用者時需要密碼問題與解答。</span><span class="sxs-lookup"><span data-stu-id="62543-815">Gets a value indicating whether the membership provider is configured to require a password question and answer when creating a user.</span></span></summary>
        <value><see langword="true" /> <span data-ttu-id="62543-816">如果<see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />物件是設定成需要密碼問題和解答使用者; 否則即為<see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-816">if the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> object is configured to require a password question and answer for a user; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="62543-817">預設為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-817">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-818"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>屬性會設定您的應用程式組態檔案中，使用`requiresQuestionAndAnswer`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。</span><span class="sxs-lookup"><span data-stu-id="62543-818">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property is set in your application's configuration file using the `requiresQuestionAndAnswer` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="62543-819">如果應用程式的組態檔中，未設定的屬性<xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>屬性設定的預設值為`false`。</span><span class="sxs-lookup"><span data-stu-id="62543-819">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property is set to the default value of `false`.</span></span>  
  
 <span data-ttu-id="62543-820">當`requiresQuestionAndAnswer`屬性設為`true`，您也必須設定這些額外的屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-820">When the `requiresQuestionAndAnswer` attribute is set to `true`, you must also set these additional attributes.</span></span>  
  
-   `attributeMapPasswordQuestion` <span data-ttu-id="62543-821">和`attributeMapPasswordAnswer`必須對應到 Active Directory 結構描述中的屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-821">and `attributeMapPasswordAnswer` must be mapped to attributes in the Active Directory schema.</span></span>  
  
 <span data-ttu-id="62543-822">如果不符合上述準則，<xref:System.Configuration.Provider.ProviderException>在初始化時擲回。</span><span class="sxs-lookup"><span data-stu-id="62543-822">If the above criteria are not met, a <xref:System.Configuration.Provider.ProviderException> is thrown at initialization.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62543-823">您可以建立使用者時需要密碼問題和解答，但設<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性，以`false`若要防止使用者變更他們使用的密碼<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別。</span><span class="sxs-lookup"><span data-stu-id="62543-823">You can require a password question and answer when creating a user, but set the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property to `false` to prevent users from changing their passwords using the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-824">下列程式碼範例顯示 Web.config 項目設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>啟用密碼重設的執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-824">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to enable password resets.</span></span> <span data-ttu-id="62543-825">它會使用明確的 「 重設密碼 」 存取權限的使用者的認證。</span><span class="sxs-lookup"><span data-stu-id="62543-825">It uses the explicit credentials of a user given the "reset password" access right.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="62543-826">當您將使用者認證放在您的 Web.config 檔案中時，有潛在的安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="62543-826">When you place user credentials in your Web.config file, there are potential security threats.</span></span> <span data-ttu-id="62543-827">Web.config 檔案所在的目錄的存取權限的使用者可以讀取檔案，並因此看到認證。</span><span class="sxs-lookup"><span data-stu-id="62543-827">Users with access rights to the directory containing the Web.config file can read the file, and thus see the credentials.</span></span> <span data-ttu-id="62543-828">如需如何有效防止這種威脅的詳細資訊，請參閱[組態加密組態資訊使用受保護的](https://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1)。</span><span class="sxs-lookup"><span data-stu-id="62543-828">For details on how to protect against this threat, see [Encrypting Configuration Information Using Protected Configuration](https://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionUsername="UserWithResetPasswordRights"  
          connectionPassword="PasswordForUser"  
          enablePasswordReset="true"  
          requiresQuestionAndAnswer="true"  
          attributeMapPasswordQuestion="PasswordQuestionADAttribute"  
          attributeMapPasswordAnswer="PasswordAnswerADAttribute"  
          attributeMapFailedPasswordAnswerCount="AnswerCountADAttribute"  
          attributeMapFailedPasswordAnswerTime="AnswerTimeADAttribute"  
          attributeMapFailedPasswordAnswerLockoutTime="LockOutTimeADAttribute" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-829">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> 執行個體之前，已先嘗試存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-829">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-830">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-830">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RequiresUniqueEmail">
      <MemberSignature Language="C#" Value="public override bool RequiresUniqueEmail { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RequiresUniqueEmail" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property RequiresUniqueEmail As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool RequiresUniqueEmail { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.RequiresUniqueEmail : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="62543-831">取得值，指出儲存在 Active Directory 伺服器上的電子郵件地址是否必須是唯一的。</span><span class="sxs-lookup"><span data-stu-id="62543-831">Gets a value indicating whether an email address stored on the Active Directory server must be unique.</span></span></summary>
        <value><see langword="true" /> <span data-ttu-id="62543-832">如果電子郵件地址必須是唯一的。否則， <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-832">if email addresses must be unique; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="62543-833">預設為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-833">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-834">時<xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A>屬性是`true`，則<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體可確保在目前的任何其他使用者不使用電子郵件地址範圍時請<xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A>或<xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A>方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="62543-834">When the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> property is `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance ensures that the email address is not used by any other user within the current scope when either the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A> or <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A> method is called.</span></span>  
  
 <span data-ttu-id="62543-835"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A>屬性會設定您的應用程式組態檔案中，使用`requiresUniqueEmail`屬性[項目 （ASP.NET 設定結構描述） 的成員資格](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。</span><span class="sxs-lookup"><span data-stu-id="62543-835">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> property is set in your application's configuration file using the `requiresUniqueEmail` attribute of the [membership Element (ASP.NET Settings Schema)](https://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049) element.</span></span> <span data-ttu-id="62543-836">如果應用程式的組態檔中，未設定的屬性<xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A>屬性設定的預設值為`false`。</span><span class="sxs-lookup"><span data-stu-id="62543-836">If the property is not set in the application's configuration file, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A> property is set to the default value of `false`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="62543-837">下列程式碼範例顯示 Web.config 項目設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>需要唯一的電子郵件地址的使用者儲存在 Active Directory 伺服器上的執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-837">The following code example shows a Web.config entry that configures an <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to require unique email addresses for users stored on the Active Directory server.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          requiresUniqueEmail="true" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-838">在初始化 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> 執行個體之前，已先嘗試存取 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-838">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-839">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-839">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ResetPassword">
      <MemberSignature Language="C#" Value="public override string ResetPassword (string username, string passwordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string ResetPassword(string username, string passwordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ResetPassword (username As String, passwordAnswer As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ ResetPassword(System::String ^ username, System::String ^ passwordAnswer);" />
      <MemberSignature Language="F#" Value="override this.ResetPassword : string * string -&gt; string" Usage="activeDirectoryMembershipProvider.ResetPassword (username, passwordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="62543-840">要重設密碼的使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-840">The user to reset the password for.</span></span></param>
        <param name="passwordAnswer"><span data-ttu-id="62543-841">指定之使用者的密碼回應。</span><span class="sxs-lookup"><span data-stu-id="62543-841">The password answer for the specified user.</span></span></param>
        <summary><span data-ttu-id="62543-842">將使用者的密碼重新設定成全新且自動產生的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-842">Resets a user's password to a new, automatically generated password.</span></span></summary>
        <returns><span data-ttu-id="62543-843">指定之使用者的新密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-843">The new password for the specified user.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-844">方法會呼叫<xref:System.Web.Security.Membership>類別，以將密碼重設 Active Directory 資料存放區中的使用者新的隨機產生的值。</span><span class="sxs-lookup"><span data-stu-id="62543-844">The method is called by the <xref:System.Web.Security.Membership> class to reset the password for a user in the Active Directory data store to a new randomly generated value.</span></span> <span data-ttu-id="62543-845">傳回新的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-845">The new password is returned.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62543-846">藉由建立隨機密碼<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法不保證傳遞中的規則運算式<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-846">The random password created by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method is not guaranteed to pass the regular expression in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A> property.</span></span> <span data-ttu-id="62543-847">不過，隨機的密碼將會符合所建立的準則<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>和<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-847">However, the random password will meet the criteria established by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A> and <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A> properties.</span></span>  
  
 <span data-ttu-id="62543-848">如果不正確的回應提供給<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法中，追蹤無效的密碼解答嘗試都會加一的內部計數器。</span><span class="sxs-lookup"><span data-stu-id="62543-848">If an incorrect answer is supplied to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method, the internal counter that tracks invalid password-answer attempts is incremented by one.</span></span> <span data-ttu-id="62543-849">這會導致使用者無法登入，直到呼叫，以清除鎖定狀態<xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="62543-849">This can result in the user being unable to log on until the lock status is cleared by a call to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A> method.</span></span> <span data-ttu-id="62543-850">如果提供了正確的密碼解答，且使用者目前並未遭到鎖定，則會追蹤無效的密碼嘗試次數的內部計數器會重設為零。</span><span class="sxs-lookup"><span data-stu-id="62543-850">If the correct password answer is supplied and the user is not currently locked out, then the internal counter that tracks invalid password attempts is reset to zero.</span></span> <span data-ttu-id="62543-851">如需詳細資訊，請參閱 <<c0> <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> 和<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-851">For more information, see the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> and <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> properties.</span></span>  
  
 <span data-ttu-id="62543-852">中所有參數值的開頭和尾端空白會被去除。</span><span class="sxs-lookup"><span data-stu-id="62543-852">Leading and trailing spaces are trimmed from all parameter values.</span></span>  
  
 <span data-ttu-id="62543-853">您可以呼叫<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>直接方法首先取得的參考<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體<xref:System.Web.Security.Membership.Provider%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-853">You can call the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method directly by first obtaining a reference to the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance from the <xref:System.Web.Security.Membership.Provider%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="62543-854">提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。</span><span class="sxs-lookup"><span data-stu-id="62543-854">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-855">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-855">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="62543-856">若要在 Active Directory 伺服器上，設定密碼`connectionProtection`屬性必須設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>。</span><span class="sxs-lookup"><span data-stu-id="62543-856">To set passwords on an Active Directory server, the `connectionProtection` attribute must be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>.</span></span>  
  
 <span data-ttu-id="62543-857">使用了 ADAM 伺服器，當`connectionProtection`屬性可以設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>，但只有在您明確設定 ADAM 伺服器，以允許透過不安全連線的密碼變更。</span><span class="sxs-lookup"><span data-stu-id="62543-857">When using an ADAM server, the `connectionProtection` attribute can be set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>, but only if you explicitly configure the ADAM server to allow password changes over unsecured connections.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="62543-858">您無法重設密碼，除非用來連接到 Active Directory 伺服器的認證具有網域系統管理員權限 （不建議） 或 「 重設密碼 」 存取權限。</span><span class="sxs-lookup"><span data-stu-id="62543-858">You cannot reset passwords unless the credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "reset password" access right.</span></span>  
  
 <span data-ttu-id="62543-859">若要重設密碼，所有下列條件必須成立：</span><span class="sxs-lookup"><span data-stu-id="62543-859">To reset a password, all of the following conditions must be true:</span></span>  
  
-   <span data-ttu-id="62543-860"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性必須設為`true`。</span><span class="sxs-lookup"><span data-stu-id="62543-860">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property must be set to `true`.</span></span>  
  
-   <span data-ttu-id="62543-861">必須修改 Active Directory 架構，以包含儲存的密碼問題和解答，屬性和三個追蹤欄位密碼解答的變更。</span><span class="sxs-lookup"><span data-stu-id="62543-861">The Active Directory schema must be modified to contain attributes for storing the password question and answer, and the three tracking fields for password answer changes.</span></span>  
  
-   <span data-ttu-id="62543-862">`attributeMapPasswordQuestion`， `attributeMapPasswordAnswer`， `attributeMapFailedPasswordAnswerCount`， `attributeMapFailedPasswordAnswerTime`，和`attributeMapFailedPasswordAnswerLockedTime`屬性必須設定應用程式組態檔中。</span><span class="sxs-lookup"><span data-stu-id="62543-862">The `attributeMapPasswordQuestion`, `attributeMapPasswordAnswer`, `attributeMapFailedPasswordAnswerCount`, `attributeMapFailedPasswordAnswerTime`, and `attributeMapFailedPasswordAnswerLockedTime` attributes must be set in the application configuration file.</span></span>  
  
-   <span data-ttu-id="62543-863"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>屬性必須設為`true`。</span><span class="sxs-lookup"><span data-stu-id="62543-863">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A> property must be set to `true`.</span></span>  
  
-   <span data-ttu-id="62543-864">連線至 Active Directory 資料存放區 （處理帳戶或明確的認證） 的安全性內容中必須有足夠的權限，才能變更密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-864">The security context for connecting to the Active Directory data store (either the process account or the explicit credentials) must have sufficient privileges to change passwords.</span></span> <span data-ttu-id="62543-865">用來連接到 Active Directory 伺服器的認證具有網域系統管理員權限 （不建議） 或 「 重設密碼 」 存取權限。</span><span class="sxs-lookup"><span data-stu-id="62543-865">The credentials used to connect to the Active Directory server have either Domain Administrator rights (not recommended) or the "reset password" access right.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62543-866">設定 Active Directory 伺服器上的安全性原則可能會讓<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法來產生密碼符合原則。</span><span class="sxs-lookup"><span data-stu-id="62543-866">Security policies set on the Active Directory server may make it impossible for the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A> method to generate a password that satisfies the policies.</span></span> <span data-ttu-id="62543-867">預設實作<xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A>方法會產生符合執行 Windows Server 2003 SP1 的網域控制站上的預設密碼原則的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-867">The default implementation of the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A> method will generate passwords that satisfy the default password policies on domain controllers running Windows Server 2003 SP1.</span></span> <span data-ttu-id="62543-868">如果無法重設密碼，因為安全性原則的 Active Directory 伺服器上，而<xref:System.Configuration.Provider.ProviderException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="62543-868">If the password cannot be reset due to security policies on the Active Directory server, a <xref:System.Configuration.Provider.ProviderException> is thrown.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-869"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-869">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="62543-870"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> 屬性值為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-870">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> property value is <see langword="false" />.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="passwordAnswer" /> <span data-ttu-id="62543-871">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-871">is <see langword="null" />.</span></span>  
  
<span data-ttu-id="62543-872">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-872">-or-</span></span> 
 <paramref name="username" /> <span data-ttu-id="62543-873">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-873">is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><paramref name="passwordAnswer" /> <span data-ttu-id="62543-874">在修剪後為空白</span><span class="sxs-lookup"><span data-stu-id="62543-874">is empty after trimming</span></span> 
<span data-ttu-id="62543-875">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-875">-or-</span></span> 
 <paramref name="passwordAnswer" /> <span data-ttu-id="62543-876">超過 128 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-876">exceeds 128 characters.</span></span>  
  
<span data-ttu-id="62543-877">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-877">-or-</span></span> 
 <paramref name="username" /> <span data-ttu-id="62543-878">為空白，或超過使用者名稱允許的長度上限 (通常是 256 個字元)。</span><span class="sxs-lookup"><span data-stu-id="62543-878">is empty, or exceeds the maximum length allowed for user names (usually 256 characters).</span></span>  
  
<span data-ttu-id="62543-879">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-879">-or-</span></span> 
 <paramref name="username" /> <span data-ttu-id="62543-880">包含逗號。</span><span class="sxs-lookup"><span data-stu-id="62543-880">contains commas.</span></span>  
  
<span data-ttu-id="62543-881">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-881">-or-</span></span> 
<span data-ttu-id="62543-882">使用者名稱對應至 <see langword="userPrincipalName" />，但 <paramref name="username" /> 參數包含反斜線。</span><span class="sxs-lookup"><span data-stu-id="62543-882">The user name is mapped to <see langword="userPrincipalName" /> but the <paramref name="username" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.Web.Security.MembershipPasswordException"><span data-ttu-id="62543-883">使用者由於錯誤登入嘗試的次數太多或密碼回應重設嘗試的次數太多而遭到鎖定。</span><span class="sxs-lookup"><span data-stu-id="62543-883">The user is locked out because of too many bad logon attempts or too many attempted password-answer reset attempts.</span></span>  
  
<span data-ttu-id="62543-884">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-884">-or-</span></span> 
 <paramref name="passwordAnswer" /> <span data-ttu-id="62543-885">不符合儲存的密碼解答。</span><span class="sxs-lookup"><span data-stu-id="62543-885">does not match the stored password answer.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="62543-886"><paramref name="username" /> 中指定的使用者在 Active Directory 資料存放區中不存在。</span><span class="sxs-lookup"><span data-stu-id="62543-886">The user specified in <paramref name="username" /> does not exist in the Active Directory data store.</span></span>  
  
<span data-ttu-id="62543-887">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-887">-or-</span></span> 
<span data-ttu-id="62543-888">產生的密碼未通過自訂驗證處理常式。</span><span class="sxs-lookup"><span data-stu-id="62543-888">A generated password does not pass a custom validation handler.</span></span>  
  
<span data-ttu-id="62543-889">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-889">-or-</span></span> 
<span data-ttu-id="62543-890">產生的密碼不夠複雜，不符合 Active Directory 伺服器上設定的自訂密碼原則。</span><span class="sxs-lookup"><span data-stu-id="62543-890">The generated password is not complex enough to satisfy custom password policies set on the Active Directory server.</span></span>  
  
<span data-ttu-id="62543-891">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-891">-or-</span></span> 
<span data-ttu-id="62543-892">無法建立至 Active Directory 應用程式模式伺服器的安全連接，以設定新密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-892">A secure connection cannot be made to an Active Directory Application Mode server to set the new password.</span></span></exception>
        <exception cref="T:System.Exception"><span data-ttu-id="62543-893">發生未處理的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="62543-893">An unhandled exception occurred.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-894">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-894">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="UnlockUser">
      <MemberSignature Language="C#" Value="public override bool UnlockUser (string username);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool UnlockUser(string username) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function UnlockUser (username As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool UnlockUser(System::String ^ username);" />
      <MemberSignature Language="F#" Value="override this.UnlockUser : string -&gt; bool" Usage="activeDirectoryMembershipProvider.UnlockUser username" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="62543-895">要清除鎖定狀態之成員資格使用者的名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-895">The name of the membership user to clear the lock status for.</span></span></param>
        <summary><span data-ttu-id="62543-896">清除鎖定，讓成員資格使用者能夠進行驗證。</span><span class="sxs-lookup"><span data-stu-id="62543-896">Clears a lock so that a membership user can be validated.</span></span></summary>
        <returns><see langword="true" /> <span data-ttu-id="62543-897">如果已成功解除鎖定成員資格使用者；否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-897">if the membership user was successfully unlocked; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="62543-898">當資料存放區中找不到成員資格使用者時，<see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> 方法也會傳回 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-898">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> method also returns <see langword="false" /> when the membership user is not found in the data store.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-899">使用者最常遭到鎖定且無法驗證所<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>方法時<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性中指定的時間內超過<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性或嘗試次數過多時進行登入使用錯誤的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-899">Users are most commonly locked out and cannot be validated by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method when the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A> property is exceeded within the time specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A> property or when too many attempts have been made to log on using the wrong password.</span></span>  
  
 <span data-ttu-id="62543-900">如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，當使用者時，會重設錯誤密碼解除鎖定的計數器。</span><span class="sxs-lookup"><span data-stu-id="62543-900">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, when a user is unlocked the counters for bad passwords are reset.</span></span>  
  
 <span data-ttu-id="62543-901">提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。</span><span class="sxs-lookup"><span data-stu-id="62543-901">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-902">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-902">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 <span data-ttu-id="62543-903">會修剪 `username` 參數值中的前置空格和後端空格。</span><span class="sxs-lookup"><span data-stu-id="62543-903">Leading and trailing spaces are trimmed from the `username` parameter value.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="username" /> <span data-ttu-id="62543-904">為空白，或超過使用者名稱允許的長度上限 (通常是 256 個字元)。</span><span class="sxs-lookup"><span data-stu-id="62543-904">is empty, or exceeds the maximum length allowed for user names (usually 256 characters).</span></span>  
  
<span data-ttu-id="62543-905">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-905">-or-</span></span> 
 <paramref name="username" /> <span data-ttu-id="62543-906">包含逗號。</span><span class="sxs-lookup"><span data-stu-id="62543-906">contains commas.</span></span>  
  
<span data-ttu-id="62543-907">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-907">-or-</span></span> 
<span data-ttu-id="62543-908">使用者名稱對應至 <see langword="userPrincipalName" />，但 <paramref name="username" /> 參數包含反斜線。</span><span class="sxs-lookup"><span data-stu-id="62543-908">The user name is mapped to <see langword="userPrincipalName" /> but the <paramref name="username" /> parameter contains backslashes.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="username" /> <span data-ttu-id="62543-909">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-909">is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-910"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-910">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-911">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-911">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="UpdateUser">
      <MemberSignature Language="C#" Value="public override void UpdateUser (System.Web.Security.MembershipUser user);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void UpdateUser(class System.Web.Security.MembershipUser user) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub UpdateUser (user As MembershipUser)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void UpdateUser(System::Web::Security::MembershipUser ^ user);" />
      <MemberSignature Language="F#" Value="override this.UpdateUser : System.Web.Security.MembershipUser -&gt; unit" Usage="activeDirectoryMembershipProvider.UpdateUser user" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.Web.Security.MembershipUser" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="62543-912"><see cref="T:System.Web.Security.MembershipUser" /> 執行個體，表示要更新的使用者，以及該使用者的更新資訊。</span><span class="sxs-lookup"><span data-stu-id="62543-912">A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user to update and the updated information for the user.</span></span></param>
        <summary><span data-ttu-id="62543-913">更新 Active Directory 資料存放區中使用者的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="62543-913">Updates information about a user in the Active Directory data store.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-914">這個方法會呼叫<xref:System.Web.Security.Membership>更新 Active Directory 資料存放區中的使用者資訊的類別。</span><span class="sxs-lookup"><span data-stu-id="62543-914">This method is called by the <xref:System.Web.Security.Membership> class to update user information in the Active Directory data store.</span></span> <span data-ttu-id="62543-915"><xref:System.Web.Security.MembershipUser.Email%2A>， <xref:System.Web.Security.MembershipUser.Comment%2A>，和<xref:System.Web.Security.MembershipUser.IsApproved%2A>屬性值會更新指定的成員資格使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-915">The <xref:System.Web.Security.MembershipUser.Email%2A>, <xref:System.Web.Security.MembershipUser.Comment%2A>, and <xref:System.Web.Security.MembershipUser.IsApproved%2A> property values are updated for the specified membership user.</span></span> <span data-ttu-id="62543-916">會忽略所有其他屬性。</span><span class="sxs-lookup"><span data-stu-id="62543-916">All other properties are ignored.</span></span>  
  
 <span data-ttu-id="62543-917">最大長度`username`參數為 256 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-917">The maximum length for the `username` parameter is 256 characters.</span></span> <span data-ttu-id="62543-918">最大長度<xref:System.Web.Security.MembershipUser.Email%2A>為 256 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-918">The maximum length for the <xref:System.Web.Security.MembershipUser.Email%2A> property is 256 characters.</span></span>  
  
 <span data-ttu-id="62543-919">無法更新成員資格使用者的密碼，使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="62543-919">The password for a membership user cannot be updated using the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A> method.</span></span> <span data-ttu-id="62543-920">若要更新成員資格使用者的密碼，請使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="62543-920">To update the password for a membership user, use the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A> method.</span></span>  
  
 <span data-ttu-id="62543-921">提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。</span><span class="sxs-lookup"><span data-stu-id="62543-921">The provider uses a subtree search starting at the search point specified in the connection string.</span></span> <span data-ttu-id="62543-922">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-922">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-923"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-923">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="user" /> <span data-ttu-id="62543-924">為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-924">is <see langword="null" />.</span></span>  
  
<span data-ttu-id="62543-925">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-925">-or-</span></span> 
<span data-ttu-id="62543-926"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> 屬性為 <see langword="true" />，但提供之 <see cref="T:System.Web.Security.MembershipUser" /> 執行個體中的電子郵件地址為 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="62543-926">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property is <see langword="true" /> but the email address from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="62543-927"><see cref="P:System.Web.Security.MembershipUser.Email" /> 屬性在修剪後是空的。</span><span class="sxs-lookup"><span data-stu-id="62543-927">The <see cref="P:System.Web.Security.MembershipUser.Email" /> property is empty after trimming.</span></span>  
  
<span data-ttu-id="62543-928">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-928">-or-</span></span> 
<span data-ttu-id="62543-929"><see cref="P:System.Web.Security.MembershipUser.Email" /> 屬性超過 256 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-929">The <see cref="P:System.Web.Security.MembershipUser.Email" /> property exceeds 256 characters.</span></span>  
  
<span data-ttu-id="62543-930">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-930">-or-</span></span> 
<span data-ttu-id="62543-931"><see cref="P:System.Web.Security.MembershipUser.Comment" /> 屬性超過 1024 個字元。</span><span class="sxs-lookup"><span data-stu-id="62543-931">The <see cref="P:System.Web.Security.MembershipUser.Comment" /> property exceeds 1024 characters.</span></span>  
  
<span data-ttu-id="62543-932">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-932">-or-</span></span> 
<span data-ttu-id="62543-933"><see cref="P:System.Web.Security.MembershipUser.Comment" /> 屬性是空的。</span><span class="sxs-lookup"><span data-stu-id="62543-933">The <see cref="P:System.Web.Security.MembershipUser.Comment" /> property is empty.</span></span>  
  
<span data-ttu-id="62543-934">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-934">-or-</span></span> 
<span data-ttu-id="62543-935">提供之 <see cref="T:System.Web.Security.MembershipUser" /> 執行個體中的使用者名稱是空的，或超過使用者名稱所允許的最大長度 (通常為 256 個字元)。</span><span class="sxs-lookup"><span data-stu-id="62543-935">The user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance is empty, or exceeds the maximum length allowed for user names (usually 256 characters).</span></span>  
  
<span data-ttu-id="62543-936">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-936">-or-</span></span> 
<span data-ttu-id="62543-937">提供之 <see cref="T:System.Web.Security.MembershipUser" /> 執行個體中的使用者名稱包含逗號。</span><span class="sxs-lookup"><span data-stu-id="62543-937">The user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance contains commas.</span></span>  
  
<span data-ttu-id="62543-938">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-938">-or-</span></span> 
<span data-ttu-id="62543-939">使用者名稱對應至 <see langword="userPrincipalName" />，但提供之 <see cref="T:System.Web.Security.MembershipUser" /> 執行個體中的使用者名稱包含反斜線。</span><span class="sxs-lookup"><span data-stu-id="62543-939">The user name is mapped to <see langword="userPrincipalName" /> but the user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance contains backslashes.</span></span></exception>
        <exception cref="T:System.Configuration.Provider.ProviderException"><span data-ttu-id="62543-940">在 Active Directory 資料存放區中找不到指定的使用者。</span><span class="sxs-lookup"><span data-stu-id="62543-940">The specified user is not found in the Active Directory data store.</span></span>  
  
<span data-ttu-id="62543-941">-或-</span><span class="sxs-lookup"><span data-stu-id="62543-941">-or-</span></span> 
<span data-ttu-id="62543-942"><see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> 屬性為 <see langword="true" />，且 <see cref="P:System.Web.Security.MembershipUser.Email" /> 屬性的新值與現有的電子郵件地址重複。</span><span class="sxs-lookup"><span data-stu-id="62543-942">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property is <see langword="true" />, and the new value of the <see cref="P:System.Web.Security.MembershipUser.Email" /> property duplicates an existing email address.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-943">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-943">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ValidateUser">
      <MemberSignature Language="C#" Value="public override bool ValidateUser (string username, string password);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ValidateUser(string username, string password) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ValidateUser (username As String, password As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ValidateUser(System::String ^ username, System::String ^ password);" />
      <MemberSignature Language="F#" Value="override this.ValidateUser : string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ValidateUser (username, password)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username"><span data-ttu-id="62543-944">要驗證的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="62543-944">The name of the user to validate.</span></span></param>
        <param name="password"><span data-ttu-id="62543-945">指定之使用者的密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-945">The password for the specified user.</span></span></param>
        <summary><span data-ttu-id="62543-946">驗證在 Active Directory 資料存放區中存在指定的使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="62543-946">Verifies that the specified user name and password exist in the Active Directory data store.</span></span></summary>
        <returns><see langword="true" /> <span data-ttu-id="62543-947">如果指定的 <paramref name="username" /> 和 <paramref name="password" /> 有效；否則為 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-947">if the specified <paramref name="username" /> and <paramref name="password" /> are valid; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="62543-948">如果 Active Directory 資料存放區中不存在指定的使用者，則 <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> 方法會傳回 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="62543-948">If the user specified does not exist in the Active Directory data store, the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> method returns <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="62543-949">這個方法會呼叫<xref:System.Web.Security.Membership>類別來驗證使用者認證，針對 Active Directory 資料存放區。</span><span class="sxs-lookup"><span data-stu-id="62543-949">This method is called by the <xref:System.Web.Security.Membership> class to validate user credentials against the Active Directory data store.</span></span>  
  
 <span data-ttu-id="62543-950">如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`和提供的認證有效，而且會重設錯誤密碼回應的使用者追蹤計數器。</span><span class="sxs-lookup"><span data-stu-id="62543-950">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true` and the supplied credentials are valid, the user's tracking counters for bad password answers are reset.</span></span>  
  
 <span data-ttu-id="62543-951"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>方法可能會傳回`false`時正確提供認證，在下列情況下：</span><span class="sxs-lookup"><span data-stu-id="62543-951">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A> method may return `false` when the correct credentials are supplied, under the following circumstances:</span></span>  
  
1.  <span data-ttu-id="62543-952">使用者帳戶已鎖定的目錄伺服器因為失敗的登入嘗試次數過多。</span><span class="sxs-lookup"><span data-stu-id="62543-952">The user account was locked out by the directory server because of too many failed logon attempts.</span></span> <span data-ttu-id="62543-953">使用者無法登入，直到通過目錄的鎖定持續時間。</span><span class="sxs-lookup"><span data-stu-id="62543-953">The user will not be able to log on until the directory's lockout duration passes.</span></span>  
  
2.  <span data-ttu-id="62543-954">如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，如果使用者提供不正確的密碼解答次數過多時，將會鎖定使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="62543-954">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the user account will be locked if the user supplied a bad password answer too many times.</span></span> <span data-ttu-id="62543-955">使用者的帳戶將會解除鎖定在指定的時間之後<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性已通過。</span><span class="sxs-lookup"><span data-stu-id="62543-955">The user's account will unlock after the time specified in the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A> property has passed.</span></span>  
  
3.  <span data-ttu-id="62543-956">使用者必須存在於連接字串中指定的容器。</span><span class="sxs-lookup"><span data-stu-id="62543-956">The user must exist in the container specified in the connection string.</span></span> <span data-ttu-id="62543-957">位於不同的容器或不同的網域使用者帳戶提供有效的認證。</span><span class="sxs-lookup"><span data-stu-id="62543-957">Valid credentials are supplied for a user account located in a different container or in a different domain.</span></span> <span data-ttu-id="62543-958">使用者必須存在於連接字串中指定的容器。</span><span class="sxs-lookup"><span data-stu-id="62543-958">The user must exist in the container specified in the connection string.</span></span>  
  
 <span data-ttu-id="62543-959">當驗證使用者時，提供者會藉由連接到 Active Directory 資料存放區，使用指定的使用者名稱和密碼，不是在應用程式組態檔中設定的認證驗證認證。</span><span class="sxs-lookup"><span data-stu-id="62543-959">When validating a user, the provider validates the credentials by connecting to the Active Directory data store using the specified user name and password, not the credentials configured in the application configuration file.</span></span>  
  
 <span data-ttu-id="62543-960">不過，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將會連接到使用已設定的認證，原因如下的目錄。</span><span class="sxs-lookup"><span data-stu-id="62543-960">However, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will connect to the directory using the configured credentials for the following reasons.</span></span>  
  
-   <span data-ttu-id="62543-961">若要確認使用者存在於由搜尋範圍<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體的連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-961">To confirm that a user exists within the search scope as determined by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance's connection string.</span></span> <span data-ttu-id="62543-962">提供者會使用從連接字串中指定的搜尋點開始的樹狀子目錄搜尋，以判斷使用者是否存在。</span><span class="sxs-lookup"><span data-stu-id="62543-962">The provider uses a subtree search starting at the search point specified in the connection string to determine whether a user exists.</span></span> <span data-ttu-id="62543-963">使用者必須存在於指定的容器。</span><span class="sxs-lookup"><span data-stu-id="62543-963">The user must exist in the specified container.</span></span> <span data-ttu-id="62543-964">有效的連接字串的指定容器之外的認證不會驗證。</span><span class="sxs-lookup"><span data-stu-id="62543-964">Credentials that are valid outside the connection string's specified container will not be validated.</span></span> <span data-ttu-id="62543-965">請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題，如需有關連接字串。</span><span class="sxs-lookup"><span data-stu-id="62543-965">See the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> class topic for more information about connection strings.</span></span>  
  
-   <span data-ttu-id="62543-966">如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，則<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將載入使用者執行個體，若要檢查是否使用者已被鎖定因為他或她已做出變更的密碼解答的太多失敗的嘗試使用已設定的認證.</span><span class="sxs-lookup"><span data-stu-id="62543-966">If the <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A> property is `true`, the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will use the configured credentials to load the user instance to check whether the user has been locked out because he or she has made too many failed attempts to change the password answer.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="62543-967">連接到 Active Directory 網域控制站啟用 「 來賓 」 帳戶是潛在的安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="62543-967">Connecting to an Active Directory domain controller with the "Guest" account enabled is a potential security threat.</span></span> <span data-ttu-id="62543-968">啟用 「 來賓 」 帳戶與 Active Directory 網域控制站上所做的所有驗證嘗試會都成功。</span><span class="sxs-lookup"><span data-stu-id="62543-968">All validation attempts made on an Active Directory domain controller with the "Guest" account enabled will succeed.</span></span> <span data-ttu-id="62543-969">若要使用的 Active Directory 網域控制站時，請提高安全性，您應該停用網域控制站上的 「 來賓 」 帳戶。</span><span class="sxs-lookup"><span data-stu-id="62543-969">To improve security when using an Active Directory domain controller, you should disable the "Guest" account on the domain controller.</span></span>  
  
 <span data-ttu-id="62543-970"><xref:System.Web.Security.ActiveDirectoryMembershipProvider>其中下列條件成立時，執行個體將會嘗試並行的繫結，對 Active Directory:</span><span class="sxs-lookup"><span data-stu-id="62543-970">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance will attempt a concurrent bind against Active Directory when one of the following conditions is met:</span></span>  
  
-   <span data-ttu-id="62543-971"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> 屬性設定為 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>。</span><span class="sxs-lookup"><span data-stu-id="62543-971">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property is set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>.</span></span>  
  
-   <span data-ttu-id="62543-972"><xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A>屬性設定為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>和 SSL 的<xref:System.Web.Security.ActiveDirectoryMembershipProvider>保護連線安全的執行個體。</span><span class="sxs-lookup"><span data-stu-id="62543-972">The <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> property is set to <xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal> and SSL is chosen by the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance to secure the connection.</span></span>  
  
 <span data-ttu-id="62543-973">此外，若要進行的並行繫結，下列條件必須成立：</span><span class="sxs-lookup"><span data-stu-id="62543-973">In addition, for a concurrent bind to be made, the following conditions must be true:</span></span>  
  
-   <span data-ttu-id="62543-974">目錄伺服器必須執行 Windows Server 2003 上。</span><span class="sxs-lookup"><span data-stu-id="62543-974">The directory server must be running on Windows Server 2003.</span></span>  
  
-   <span data-ttu-id="62543-975">執行網頁伺服器的作業系統<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體都必須支援並行繫結 (例如，Windows Server 2003)。</span><span class="sxs-lookup"><span data-stu-id="62543-975">The operating system of the Web server running the <xref:System.Web.Security.ActiveDirectoryMembershipProvider> instance must support concurrent binds (for example, Windows Server 2003).</span></span>  
  
 <span data-ttu-id="62543-976">當使用並行的繫結時，使用者的上次登入日期不會更新在目錄中;因此，<xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A>屬性無法依賴。</span><span class="sxs-lookup"><span data-stu-id="62543-976">When a concurrent bind is used, the last logon date for the user is not updated in the directory; therefore, the <xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A> property cannot be relied on.</span></span>  
  
 <span data-ttu-id="62543-977">開頭和尾端空白會刪減`username`參數。</span><span class="sxs-lookup"><span data-stu-id="62543-977">Leading and trailing spaces are trimmed from the `username` parameter.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="62543-978"><see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> 方法的呼叫，會在初始化 <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> 執行個體之前進行。</span><span class="sxs-lookup"><span data-stu-id="62543-978">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</span></span></exception>
        <related type="Article" href="https://msdn.microsoft.com/library/79184d17-f4c7-4c9f-a073-cec4f5543980(v=vs.100)"><span data-ttu-id="62543-979">ASP.NET 成員資格簡介</span><span class="sxs-lookup"><span data-stu-id="62543-979">Introduction to ASP.NET Membership</span></span></related>
      </Docs>
    </Member>
  </Members>
</Type>