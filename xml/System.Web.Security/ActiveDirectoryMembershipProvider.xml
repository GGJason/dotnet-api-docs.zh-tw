<Type Name="ActiveDirectoryMembershipProvider" FullName="System.Web.Security.ActiveDirectoryMembershipProvider">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="89ac1e5c7eade7a4a3173dd20d8e21f4f34ab1e6" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36398867" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class ActiveDirectoryMembershipProvider : System.Web.Security.MembershipProvider" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit ActiveDirectoryMembershipProvider extends System.Web.Security.MembershipProvider" />
  <TypeSignature Language="DocId" Value="T:System.Web.Security.ActiveDirectoryMembershipProvider" />
  <TypeSignature Language="VB.NET" Value="Public Class ActiveDirectoryMembershipProvider&#xA;Inherits MembershipProvider" />
  <TypeSignature Language="C++ CLI" Value="public ref class ActiveDirectoryMembershipProvider : System::Web::Security::MembershipProvider" />
  <TypeSignature Language="F#" Value="type ActiveDirectoryMembershipProvider = class&#xA;    inherit MembershipProvider" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.Security.MembershipProvider</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>Manages storage of membership information for an ASP.NET application in Active Directory and Active Directory Application Mode servers.</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個類別由<xref:System.Web.Security.Membership>和<xref:System.Web.Security.MembershipUser>提供使用 Active Directory (AD) 或 Active Directory 應用程式模式 (ADAM) 伺服器的 ASP.NET 應用程式的成員資格服務的類別。  
  
> [!NOTE]
>  使用 ADAM 伺服器需要使用特定的組態。 如需詳細資訊，請參閱下方的 ADAM 組態區段。  
  
> [!IMPORTANT]
>  <xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體只適用於 ASP.NET 的完全信任原則預設設定。 若要使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體在任何部分信任層級中，您必須適當的信任原則檔案進行變更，您的應用程式或您必須建立 「 沙箱 」 組件部署在 GAC 中。  
>   
>  <xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會要求不受限制的<xref:System.DirectoryServices.DirectoryServicesPermission>執行權限。 此權限不會加入至任何使用 ASP.NET 所提供的部分信任原則檔案。 雖然新增<xref:System.DirectoryServices.DirectoryServicesPermission>部分信任原則檔案的權限可讓使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別，執行動作，讓<xref:System.DirectoryServices>ASP.NET 網頁中執行任何程式碼可使用的命名空間類別。 這個選項不需要在安全的鎖定模式中執行任何 Web 伺服器的建議。  
>   
>  或者，您可以建立 「 沙箱 」 組件呼叫<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別。 這個組件可以包含其中一個轉送的方法呼叫的包裝函式類別<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別或衍生自類別<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別。 在任一情況下，包裝函式類別必須判斷提示不受限制<xref:System.DirectoryServices.DirectoryServicesPermission>權限。 部署在 GAC 中的沙箱組件，並將標示組件<xref:System.Security.AllowPartiallyTrustedCallersAttribute>(APTCA) 屬性。 這會讓部分信任的 ASP.NET 程式碼呼叫您的包裝函式類別，但因為包裝函式類別內部判斷提示不受限制<xref:System.DirectoryServices.DirectoryServicesPermission>權限，您的包裝函式類別都能夠成功呼叫提供者  
  
 您必須建立[connectionStrings 項目 （ASP.NET 設定結構描述）](http://msdn.microsoft.com/library/b6ffbb2e-a4d1-410e-8f7e-9755e92c65de)識別 Active Directory 伺服器、 Active Directory 網域或若要使用的 ADAM 應用程式磁碟分割在 Web.config 檔案中的項目。 提供者只會在網域範圍，或在網域內的子範圍中。 下表列出允許的連接字串，所使用的範圍。  
  
|連接字串|範圍|  
|-----------------------|-----------|  
|LDAP: / /\<網域或伺服器 >: [port]<br /><br /> ADAM 的選擇性而不需要 Active Directory 的通訊埠編號。|提供者會針對指定的網域或伺服器執行。 使用 AD 中，使用者建立和刪除會進行預設使用者容器中。 所有其他作業，包括任何搜尋方法，將網域根位置的預設命名內容。<br /><br /> 如果連接字串指定 Active Directory 網域，而不是特定伺服器和<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`、<xref:System.Web.Security.ActiveDirectoryMembershipProvider>一律都會連線到網域，以確保該密碼的 PDC 角色的伺服器執行個體變更生效，並使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>方法呼叫。<br /><br /> 這個連接字串時，不允許使用 ADAM，並將擲回<xref:System.NotSupportedException>。|  
|LDAP: / /\<網域或伺服器 >: [port] /\<容器 dn ><br /><br /> ADAM 的選擇性而不需要 Active Directory 的通訊埠編號。|提供者會針對指定的網域或伺服器執行。 使用者建立和刪除只是在指定的容器。 所有其他作業，包括任何搜尋方法執行容器為根部的樹狀子目錄搜尋。<br /><br /> ADAM 伺服器容器會指定應用程式分割或應用程式磁碟分割內的容器的根目錄。<br /><br /> 我們建議連接字串會定義特定的容器來改善效能。|  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體會對應至 directory 屬性<xref:System.Web.Security.ActiveDirectoryMembershipUser>屬性。 如果沒有屬性對應會在 Web.config 檔案中完成，會使用預設屬性。 如需有關屬性對應的詳細資訊，請參閱中的個別屬性<xref:System.Web.Security.ActiveDirectoryMembershipUser>類別文件。  
  
 下表列出<xref:System.Web.Security.ActiveDirectoryMembershipUser>屬性和其預設值的屬性對應。  
  
> [!IMPORTANT]
>  <xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不會明確地檢查提供者屬性不對應到使用者物件在目錄中的核心屬性。 您必須確定目錄中的機密資訊不會公開對應的屬性。  
  
|屬性|預設目錄屬性|可對應嗎？|  
|--------------|---------------------------------|--------------------|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.ProviderUserKey%2A>|securityIdentifier|否|  
|<xref:System.Web.Security.MembershipUser.UserName%2A>|userPrincipalName|是，但必須是 userPrincipalName 或 sAMAccountName|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A>|註解|否|  
|<xref:System.Web.Security.MembershipUser.CreationDate%2A>|whenCreated|否|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.Email%2A>|郵件|是，但必須是 Unicode 字串類型的單一值屬性。|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.LastActivityDate%2A>|N/A|不支援<xref:System.Web.Security.ActiveDirectoryMembershipProvider>。|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A>|N/A|不支援<xref:System.Web.Security.ActiveDirectoryMembershipProvider>。|  
|<xref:System.Web.Security.MembershipUser.LastPasswordChangedDate%2A>|pwdLastSet|否|  
|<xref:System.Web.Security.MembershipUser.PasswordQuestion%2A>|無|是，但必須是 Unicode 字串類型的單一值屬性。|  
|<xref:System.Web.Security.ActiveDirectoryMembershipUser.IsApproved%2A>|使用者帳戶控制 (AD)<br /><br /> mDS Msds-useraccountdisabled (ADAM)|否|  
|<xref:System.Web.Security.MembershipUser.IsLockedOut%2A>|計算從 lockoutTime 和廣告鎖定持續時間 (在 Windows 2000 上的 AD)<br /><br /> 使用者的帳戶-控制項-計算 (AD 上 Windows Server 2003)<br /><br /> 使用者的帳戶-控制項-計算 (ADAM)|否|  
|<xref:System.Web.Security.MembershipUser.LastLockoutDate%2A>|如果使用者因為不正確的密碼嘗試次數過多而遭到鎖定，鎖定時間屬性會傳回。<br /><br /> 如果使用者鎖定因為太多錯誤密碼解答嘗試，儲存在所定義之屬性的值`attributeMapFailedPasswordAnswerLockoutTime`傳回。<br /><br /> 如果使用者鎖定因為發生錯誤的密碼並不正確的密碼嘗試次數過多，最新的日期/時間值會傳回。<br /><br /> 如果帳戶未鎖定，則傳回 1/1/1754 為了與 SQL 相容。|否|  
  
 當同時<xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>和<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性`true`、<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別支援密碼重設安全性透過要求使用者回答預先決定的資訊。 若要支援的問題和解答，您必須設定下列組態屬性使用[新增項目 （ASP.NET 設定結構描述） 的成員資格提供者](http://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18)應用程式組態檔中。  
  
|組態屬性|屬性類型|  
|-----------------------------|--------------------|  
|`attributeMapPasswordQuestion`|必須是 Unicode 字串類型的單一值屬性。|  
|`attributeMapPasswordAnswer`|必須是 Unicode 字串類型的單一值屬性。|  
|`attributeMapFailedPasswordAnswerCount`|必須是整數類型的單一值屬性。|  
|`attributeMapFailedPasswordAnswerTime`|必須是單一值屬性的型別大的整數間隔。|  
|`attributeMapFailedPasswordAnswerLockoutTime`|必須是單一值屬性的型別大的整數間隔。|  
  
 如需有關使用密碼重設安全性的詳細資訊，請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>屬性。  
  
## <a name="active-directory-connections"></a>Active Directory 連線  
 當<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別用來連接到 Active Directory 或 Active Directory 應用程式模式 (ADAM) 伺服器，`connectionProtection`屬性已設定使用[新增項目 （ASP.NET 設定結構描述） 的成員資格提供者](http://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18)的應用程式組態檔可能會限制的作業類型<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別可以透過連接執行。 `connectionProtection`屬性也會決定方法<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將用來建立 Active Directory 或 ADAM 伺服器的連線。  
  
 下表顯示的效果`connectionProtection`屬性連接到 Active Directory 時。  
  
|`connectionProtection` 設定|作用|  
|------------------------------------|------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將會連接到 Active Directory，請遵循這些限制。<br /><br /> -任何設定密碼的方法將會失敗。 變更密碼時，active Directory 需要安全連接。<br />-您必須明確設定`connectionUsername`和`connectionPassword`屬性使用[新增項目 （ASP.NET 設定結構描述） 的成員資格提供者](http://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18)應用程式組態檔中; 否則<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將會擲回<xref:System.Configuration.Provider.ProviderException>例外狀況。|  
|`Secure`|<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將嘗試連線到 Active Directory 使用 SSL。 如果 SSL 失敗，將會進行第二次嘗試連線到 Active Directory 使用簽署密封。 如果這兩個嘗試都失敗，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將會擲回<xref:System.Configuration.Provider.ProviderException>例外狀況。<br /><br /> 支援的程序認證和明確的認證。|  
  
 下表顯示的效果`connectionProtection`屬性連接到 ADAM 伺服器時。  
  
|`connectionProtection` 設定|作用|  
|------------------------------------|------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將會連接到 ADAM 伺服器，但有此限制。<br /><br /> -任何設定密碼的方法將會失敗，除非您明確設定 ADAM 伺服器以允許密碼，才能傳送和變更透過不安全的連線。<br /><br /> 支援的程序認證和明確的認證。|  
|`Secure`|<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將嘗試連線到 ADAM 伺服器使用 SSL。 如果無法建立連線，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將會擲回<xref:System.Configuration.Provider.ProviderException>例外狀況。<br /><br /> 支援的程序認證和明確的認證。|  
  
## <a name="adam-configuration"></a>ADAM 組態  
 ADAM 執行個體使用 ADAM 伺服器時，必須包含定義的結構描述`User`類別。 您可以匯入`User`類別的匯入 LDIF `MS-User.ldf` ADAM 安裝目錄中可使用的檔案。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別適用於與 ADAM 伺服器設定為使用預設的網路連接埠。 下表顯示預期的 ADAM 伺服器的預設值。  
  
|connectionProtection 設定|必須是的 ADAM 連接埠|  
|----------------------------------|------------------------|  
|<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>|389|  
|`Secure`|636|  
  
 如果您的 ADAM 伺服器未使用的預設連接埠，請參閱文件 Q817583，「 Active Directory 服務不會要求安全授權透過 SSL 連線，「 在[Microsoft Knowledge Base](http://go.microsoft.com/fwlink/?linkid=37115)。  
  
   
  
## Examples  
 下列程式碼範例顯示設定為使用 ASP.NET 應用程式的 Web.config 檔案<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體。 第一個範例會使用 Active Directory 屬性的預設對應，並不支援密碼重設安全性問題答案，也不能呼叫搜尋方法使用。 第二個範例會顯示所有屬性設定為允許<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體。  
  
 第一個範例是簡單的組態檔使用預設對應的 Active Directory 屬性。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 這個範例會顯示所有可用執行個體的屬性設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership  
      defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"  
          type="System.Web.Security.ActiveDirectoryMembershipProvider,  
          System.Web, Version=1.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionStringName="ADService"  
          connectionUsername="UserWithAppropriateRights"  
          connectionPassword="PasswordForUser"  
          connectionProtection="Secure"  
          enablePasswordReset="true"  
          enableSearchMethods="true"  
          requiresQuestionAndAnswer="true"  
          applicationName="/"  
          description="Default AD connection"  
          requiresUniqueEmail="false"  
          clientSearchTimeout="30"  
          serverSearchTimeout="30"  
          timeoutUnit="Minutes"  
          attributeMapPasswordQuestion="department"  
          attributeMapPasswordAnswer="division"  
          attributeMapFailedPasswordAnswerCount="singleIntAttribute"  
         attributeMapFailedPasswordAnswerTime="singleLargeIntAttribute"  
         attributeMapFailedPasswordAnswerLockoutTime="singleLargeIntAttribute"  
          attributeMapEmail = "mail"  
          attributeMapUsername = "userPrincipalName"  
          maxInvalidPasswordAttempts = "5"  
          passwordAttemptWindow = "10"  
          passwordAnswerAttemptLockoutDuration = "30"  
          minRequiredPasswordLength="7"  
          minRequiredNonalphanumericCharacters="1"  
          passwordStrengthRegularExpression="  
          @\"(?=.{6,})(?=(.*\d){1,})(?=(.*\W){1,})" />  
        />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 `clientSearchTimeout` 和`serverSearchTimeout`預設值為分鐘。 若要變更單位，設定`timeoutUnit`"Days"、"Hours"、"Minutes"、"Seconds"或"（毫秒） 」 的其中一個屬性值。 如果未指定屬性，則預設為"Minutes"。  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ActiveDirectoryMembershipProvider ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; ActiveDirectoryMembershipProvider();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>Creates a new instance of the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>建構函式由 ASP.NET 呼叫來建立的執行個體<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別做為應用程式的組態中指定。 這個建構函式不是從您的程式碼使用。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public override string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>The name of the application using the custom membership provider.</summary>
        <value>使用自訂成員資格提供者的應用程式名稱。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName%2A>屬性可以設定為 ASP.NET 應用程式的名稱; 不過，應用程式名稱不是由<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別。  
  
 因此，不同於其他<xref:System.Web.Security.MembershipProvider>實作中，所有存取相同的 Active Directory 資料存放區，一律會共用相同的使用者資料的 ASP.NET 應用程式。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException">An attempt was made to set the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> property.</exception>
        <exception cref="T:System.InvalidOperationException">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.ApplicationName" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="ChangePassword">
      <MemberSignature Language="C#" Value="public override bool ChangePassword (string username, string oldPassword, string newPassword);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ChangePassword(string username, string oldPassword, string newPassword) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ChangePassword (username As String, oldPassword As String, newPassword As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ChangePassword(System::String ^ username, System::String ^ oldPassword, System::String ^ newPassword);" />
      <MemberSignature Language="F#" Value="override this.ChangePassword : string * string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ChangePassword (username, oldPassword, newPassword)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="oldPassword" Type="System.String" />
        <Parameter Name="newPassword" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">The name of the user to update the password for.</param>
        <param name="oldPassword">The current password for the specified user.</param>
        <param name="newPassword">The new password for the specified user.</param>
        <summary>Changes the password for the specified user.</summary>
        <returns>
          <see langword="true" /> if the password was updated successfully; otherwise, <see langword="false" />.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A>方法用來更新 Active Directory 資料存放區中的使用者的密碼。 不論認證，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體設定為使用時，提供者連線至 Active Directory 伺服器使用`username`和`oldPassword`與連線認證參數。  
  
 如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`、 使用者無法變更他或她的密碼，如果先前鎖定帳戶，因為使用者太多，因此嘗試回答密碼問題。 使用者必須等候中指定的分鐘數<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性，才能變更密碼。  
  
 如果成功完成密碼變更和<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，則會重設使用者的密碼解答追蹤計數器。  
  
 提供者尋找要執行的連接字串中指定的搜尋點啟動的使用者名稱的樹狀子目錄搜尋更新的使用者執行個體。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 若要變更 Active Directory 伺服器上的密碼`connectionProtection`屬性必須設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>。  
  
 當使用 ADAM 伺服器，`connectionProtection`屬性可以設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>，但如果您已明確設定 ADAM 伺服器以允許透過不安全連接的密碼變更。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).  \- or -  <paramref name="username" /> contains commas.  \- or -  The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.  \- or -  <paramref name="oldPassword" /> or <paramref name="newPassword" /> is a zero-length string.  \- or -  <paramref name="oldPassword" /> or <paramref name="newPassword" /> exceeds the maximum password length (usually 128 characters).  \- or -  <paramref name="newPassword" /> is less than the minimum password size specified in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> property  \- or -  <paramref name="newPassword" /> contains fewer than the number of non-alphabetic characters specified in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> property.  \- or -  <paramref name="newPassword" /> fails validation by the regular expression defined in the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> property.</exception>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="username" /> is <see langword="null" />.  \- or -  <paramref name="oldPassword" /> is <see langword="null" />.  \- or -  <paramref name="newPassword" /> is <see langword="null" />.</exception>
        <exception cref="T:System.Web.Security.MembershipPasswordException">
          <paramref name="newPassword" /> does not meet the complexity requirements defined by the Active Directory server.</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">A secure connection could not be made to an Active Directory Application Mode server.</exception>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(System.String,System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
        <exception cref="T:System.Exception">An unhandled exception occurred.</exception>
      </Docs>
    </Member>
    <Member MemberName="ChangePasswordQuestionAndAnswer">
      <MemberSignature Language="C#" Value="public override bool ChangePasswordQuestionAndAnswer (string username, string password, string newPasswordQuestion, string newPasswordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ChangePasswordQuestionAndAnswer(string username, string password, string newPasswordQuestion, string newPasswordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ChangePasswordQuestionAndAnswer (username As String, password As String, newPasswordQuestion As String, newPasswordAnswer As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ChangePasswordQuestionAndAnswer(System::String ^ username, System::String ^ password, System::String ^ newPasswordQuestion, System::String ^ newPasswordAnswer);" />
      <MemberSignature Language="F#" Value="override this.ChangePasswordQuestionAndAnswer : string * string * string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer (username, password, newPasswordQuestion, newPasswordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="newPasswordQuestion" Type="System.String" />
        <Parameter Name="newPasswordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">The user to change the password question and answer for.</param>
        <param name="password">The password for the specified user.</param>
        <param name="newPasswordQuestion">The new password question for the specified user.</param>
        <param name="newPasswordAnswer">The new password answer for the specified user.</param>
        <summary>Updates the password question and answer for a user in the Active Directory store.</summary>
        <returns>
          <see langword="true" /> if the update was successful; otherwise, <see langword="false" />. A value of <see langword="false" /> is also returned if the password is incorrect, the user is locked out, or the user does not exist in the Active Directory data store.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 方法會呼叫<xref:System.Web.Security.ActiveDirectoryMembershipUser>類別，以更新的密碼問題和解答的 Active Directory 成員資格存放區中的使用者。  
  
 重設使用者的密碼時，需要密碼問題和解答提供額外一層安全性。 建立使用者名稱時，使用者可以提供問題和解答，稍後可以用來重設忘記的密碼。 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A>方法會更新的密碼問題和解答的成員資格使用者的新值。  
  
 若要使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A>方法，您必須在您的應用程式組態檔中設定這些額外的屬性：  
  
-   `requiresQuestionAndAnswer` 必須是 `true.`  
  
-   `attributeMapPasswordQuestion` 和`attributeMapPasswordAnswer`必須對應到 Active Directory 架構中的屬性。  
  
 如果不符合上述準則，<xref:System.Configuration.Provider.ProviderException>會在初始設定擲回。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體連接到 Active Directory 資料存放區中提供的認證`username`和`password`參數來驗證使用者名稱/密碼組合。 實際的問題和解答的更新會執行的提供者設定的連接認證。  
  
 如果不正確的密碼提供給<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer%2A>方法中，目錄伺服器會遞增的計數器可追蹤無效的密碼嘗試次數。 這會導致使用者鎖定和無法登入之前的鎖定狀態，以清除呼叫<xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A>方法或目錄階段中指定的鎖定持續時間。  
  
 如果成功的問題和解答的更新和<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`、 使用者的密碼解答追蹤計數器會重設。  
  
 使用加密的密碼解答<xref:System.Web.Security.MembershipProvider.EncryptPassword%2A>方法之前會儲存在 Active Directory 資料存放區。 會指定加密金鑰和演算法[machineKey 項目 （ASP.NET 設定結構描述）](http://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46)組態項目。 上的解密屬性[machineKey 項目 （ASP.NET 設定結構描述）](http://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46)元素必須加以指定、<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不支援自動產生的加密金鑰。  
  
 密碼問題的最大長度為 256 個字元。 密碼解答的最大長度為 128 個字元。  
  
 開頭和尾端空白會從所有的參數值，除了修剪`password`。  
  
 提供者尋找要執行的連接字串中指定的搜尋點啟動的使用者名稱的樹狀子目錄搜尋更新的使用者執行個體。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException">The administrator has not mapped the password question-and-answer fields to attributes of the Active Directory schema.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).  \- or -  <paramref name="username" /> contains commas.  \- or -  The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.  \- or -  <paramref name="password" /> is a zero-length string.  \- or -  <paramref name="password" /> exceeds the maximum password length (usually 128 characters).  \- or -  <paramref name="newPasswordQuestion" /> is empty and the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property value is <see langword="true" />.  \- or -  <paramref name="newPasswordQuestion" /> exceeds 256 characters.  \- or -  <paramref name="newPasswordAnswer" /> exceeds 128 characters after the answer is encrypted.</exception>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="username" /> is <see langword="null" />.  \- or -  <paramref name="password" /> is <see langword="null" />.  \- or -  <paramref name="newPasswordQuestion" /> is <see langword="null" /> and <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property is <see langword="true" />.  \- or -  <paramref name="newPasswordAnswer" /> is <see langword="null" /> and <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property is <see langword="true" />.</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">The [machineKey Element (ASP.NET Settings Schema)](http://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) configuration element indicates an auto-generated machine encryption key. You must explicitly set the <see langword="decriptionKey" /> attribute of the [machineKey Element (ASP.NET Settings Schema)](http://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) element to store password answers with the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.</exception>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePasswordQuestionAndAnswer(System.String,System.String,System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="CreateUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser CreateUser (string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, out System.Web.Security.MembershipCreateStatus status);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser CreateUser(string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, [out] valuetype System.Web.Security.MembershipCreateStatus&amp; status) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function CreateUser (username As String, password As String, email As String, passwordQuestion As String, passwordAnswer As String, isApproved As Boolean, providerUserKey As Object, ByRef status As MembershipCreateStatus) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ CreateUser(System::String ^ username, System::String ^ password, System::String ^ email, System::String ^ passwordQuestion, System::String ^ passwordAnswer, bool isApproved, System::Object ^ providerUserKey, [Runtime::InteropServices::Out] System::Web::Security::MembershipCreateStatus % status);" />
      <MemberSignature Language="F#" Value="override this.CreateUser : string * string * string * string * string * bool * obj *  -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.CreateUser (username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, status)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="email" Type="System.String" />
        <Parameter Name="passwordQuestion" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
        <Parameter Name="isApproved" Type="System.Boolean" />
        <Parameter Name="providerUserKey" Type="System.Object" />
        <Parameter Name="status" Type="System.Web.Security.MembershipCreateStatus&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="username">The user name for the new user.</param>
        <param name="password">The password for the new user.</param>
        <param name="email">The email address of the new user.</param>
        <param name="passwordQuestion">The password question for the new user.</param>
        <param name="passwordAnswer">The password answer for the new user.</param>
        <param name="isApproved">Whether or not the new user is approved to be validated.</param>
        <param name="providerUserKey">The unique identifier from the membership data source for the user. This parameter must be <see langword="null" /> when using the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class.</param>
        <param name="status">When this method returns, contains one of the <see cref="T:System.Web.Security.MembershipCreateStatus" /> enumeration values indicating whether the user was created successfully.</param>
        <summary>Adds a new user to the Active Directory data store.</summary>
        <returns>An <see cref="T:System.Web.Security.ActiveDirectoryMembershipUser" /> instance containing the information for the newly created user, or <see langword="null" /> if the user was not successfully created.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A>方法透過呼叫<xref:System.Web.Security.Membership>類別來建立新的使用者在 Active Directory 資料存放區。  
  
 Active Directory 和 Active Directory 應用程式模式 (ADAM) 伺服器<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會要求執行個體中的類別目錄是`user`。 替代使用者之類的類別`inetOrgPerson`不支援。  
  
 當使用 Active Directory 伺服器和使用者名稱對應到`userPrincipalName`屬性<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會自動產生的隨機 20 個字元的使用者名稱`sAMAccountName`代表您的參數。  
  
 參數預設為下列的最大長度。  
  
|參數|最大長度|  
|---------------|--------------------|  
|`username`|64 個字元，如果使用`userPrincipalName`屬性。 如果使用`sAMAccountName`屬性，一般的限制為 20 個字元或更少。|  
|`password`|128 個字元。|  
|`email`|256 個字元。|  
|`passwordQuestion`|256 個字元。|  
|`passwordAnswer`|之前和之後加密的 128 個字元。|  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipUser.Comment%2A>屬性傳回的<xref:System.Web.Security.ActiveDirectoryMembershipUser>執行個體僅限於 1024年個字元。  
  
 如果藉由減少這些屬性的最大允許長度已修改的目錄結構描述，這些長度會優先。  
  
 建立使用者之前<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別可確保使用者名稱是唯一的。 如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體已設定為需要唯一的電子郵件地址，它也必須確定是唯一的電子郵件地址。  
  
 Active Directory 中使用者名稱會強制執行唯一性時的使用者名稱對應至執行 GC 搜尋`userPrincipalName`。 如果`sAMAccountName`使用時，則目錄將會自動強制執行唯一性`sAMAccountName`跨 Active Directory 網域。  
  
 ADAM 伺服器將會自動強制執行的使用者名稱唯一性`userPrincipalName`跨所有應用程式分割。  
  
 執行樹狀子目錄搜尋開始於根容器建立使用者的重複電子郵件地址的方式，會強制執行唯一性電子郵件地址。 這是預設使用者容器 （如果連接到 Active Directory 和任何容器已指定連接字串中） 或連接字串中指定的容器。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會直接在連接字串中指定的使用者容器中建立使用者。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 在 Active Directory 伺服器上，設定密碼`connectionProtection`屬性必須設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>。  
  
 使用 ADAM 伺服器時，`connectionProtection`屬性可以設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>，但如果您已明確設定 ADAM 伺服器以允許透過不安全連接的密碼變更。  
  
 開頭和尾端空白會刪減以外的所有字串參數值`password`。  
  
> [!IMPORTANT]
>  您無法建立新的使用者，用來連接到 Active Directory 伺服器的認證具有網域系統管理員權限 （不建議） 或 「 建立子執行個體，「 除非 「 刪除子系執行個體 」 和 設定密碼 」 存取權限。 「 刪除子系執行個體 」 存取權限是必要的因為建立的使用者是多步驟的程序，而且如果使用者建立的任何步驟失敗，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將會刪除使用者執行個體而不是保留中的部分建構的使用者執行個體目錄。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">The <paramref name="providerUserKey" /> parameter is not <see langword="null" />.</exception>
        <exception cref="T:System.NotSupportedException">The administrator has not mapped the password question-and-answer fields to attributes of the Active Directory schema, and either the <paramref name="passwordQuestion" /> or <paramref name="passwordAnswer" /> parameter is not <see langword="null" />.</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">The [machineKey Element (ASP.NET Settings Schema)](http://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) configuration element indicates an auto-generated machine encryption key. You must explicitly set the <see langword="decriptionKey" /> attribute of the [machineKey Element (ASP.NET Settings Schema)](http://msdn.microsoft.com/library/4b5699a9-bc21-4c4a-85f1-8b3b8ebd2d46) element to store password answers with the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />.  \- or -  The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> was unable to establish a secure connection to the directory when attempting to set the password for the new user.</exception>
        <exception cref="T:System.Runtime.InteropServices.COMException">An error occurred while attempting to create the user.</exception>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser(System.String,System.String,System.String,System.String,System.String,System.Boolean,System.Object,System.Web.Security.MembershipCreateStatus@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="CurrentConnectionProtection">
      <MemberSignature Language="C#" Value="public System.Web.Security.ActiveDirectoryConnectionProtection CurrentConnectionProtection { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.Security.ActiveDirectoryConnectionProtection CurrentConnectionProtection" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CurrentConnectionProtection As ActiveDirectoryConnectionProtection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::Security::ActiveDirectoryConnectionProtection CurrentConnectionProtection { System::Web::Security::ActiveDirectoryConnectionProtection get(); };" />
      <MemberSignature Language="F#" Value="member this.CurrentConnectionProtection : System.Web.Security.ActiveDirectoryConnectionProtection" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.ActiveDirectoryConnectionProtection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets the current level of security being used to protect communications with the server.</summary>
        <value>其中一個 <see cref="T:System.Web.Security.ActiveDirectoryConnectionProtection" /> 值。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A>屬性會指出目前的安全性層級的<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體設定為使用。 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A>屬性根據`connnectionProtection`屬性集[新增項目 （ASP.NET 設定結構描述） 的成員資格提供者](http://msdn.microsoft.com/library/8423ec7f-a06d-4606-977e-a46400b2fc18)應用程式組態檔中。  
  
 `connectionProtection`屬性只能設定為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>或<xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>組態檔中。  
  
 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
   
  
## Examples  
 下列程式碼範例顯示 Web.config 項目，以設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>来使用的 SSL 安全性通訊協定連線到 Active Directory 伺服器執行個體。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionProtection="SignAndSeal" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="DeleteUser">
      <MemberSignature Language="C#" Value="public override bool DeleteUser (string username, bool deleteAllRelatedData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool DeleteUser(string username, bool deleteAllRelatedData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function DeleteUser (username As String, deleteAllRelatedData As Boolean) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool DeleteUser(System::String ^ username, bool deleteAllRelatedData);" />
      <MemberSignature Language="F#" Value="override this.DeleteUser : string * bool -&gt; bool" Usage="activeDirectoryMembershipProvider.DeleteUser (username, deleteAllRelatedData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="deleteAllRelatedData" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="username">The name of the user to delete.</param>
        <param name="deleteAllRelatedData">This parameter is ignored by the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> method.</param>
        <summary>Removes a user's membership information from the Active Directory data store.</summary>
        <returns>
          <see langword="true" /> if the user was deleted; otherwise, <see langword="false" /> if the user was not found in the data store.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A>方法會立即移除所識別的使用者`username`參數。 由於 Active Directory 資料存放區的目錄中，不同的區域不會儲存使用者資訊`deleteAllRelatedData`參數已忽略，雖然它必須設定為 `true`或`false`呼叫時<xref:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser%2A>方法。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會尋找使用者執行個體，若要刪除的連接字串所決定的使用者容器中執行的使用者名稱的單一層級搜尋。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 `username` 必須有 64 個字元或更少。  
  
> [!IMPORTANT]
>  您無法刪除使用者，除非用來連線到 Active Directory 伺服器的認證有可能是網域系統管理員權限 （不建議） 或 「 刪除子執行個體 」 存取權限。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).  \- or -  <paramref name="username" /> contains commas.  \- or -  The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="userName" /> parameter contains backslashes.</exception>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="username" /> is <see langword="null" />.</exception>
        <exception cref="T:System.Runtime.InteropServices.COMException">An error occurred while attempting to delete the user.</exception>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.DeleteUser(System.String,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="EnablePasswordReset">
      <MemberSignature Language="C#" Value="public override bool EnablePasswordReset { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePasswordReset" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property EnablePasswordReset As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnablePasswordReset { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnablePasswordReset : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets a value indicating whether the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is configured to allow users to reset their passwords.</summary>
        <value>
          <see langword="true" /> 如果允許重設密碼，則否則， <see langword="false" />。 預設值為 <see langword="false" />。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性會指出是否可以使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法來重設使用者的密碼。 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性設定您的應用程式組態檔使用`enablePasswordReset`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。  
  
 您只能設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性`true`時下列[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)已進行項目設定。  
  
-   `requiresQuestionAndAnswer` 必須是`true`。  
  
-   Active Directory 架構必須修改成包含儲存的密碼問題和解答，以及密碼解答變更嘗試的三種追蹤欄位的屬性。  
  
-   `attributeMapPasswordQuestion``attributeMapPasswordAnswer`， `attributeMapFailedPasswordAnswerCount`， `attributeMapFailedPasswordAnswerTime`，和`attributeMapFailedPasswordAnswerLockoutTime`必須對應到 Active Directory 架構中的屬性。  
  
 如果不符合上述準則，<xref:System.Configuration.Provider.ProviderException>會在初始設定擲回。  
  
 當應用程式組態檔中的連接字串指定 Active Directory 網域，而不是特定的伺服器，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體一律都會連線至具有 PDC 角色，以確保網域的網域控制站密碼變更才會生效，和當<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>方法呼叫。  
  
> [!NOTE]
>  即使<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，除非用來連接到 Active Directory 伺服器的認證具有網域系統管理員權限 （不建議） 或 「 重設密碼 」 存取權限，無法重設使用者密碼。  
  
   
  
## Examples  
 下列程式碼範例顯示 Web.config 項目，以設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>来啟用密碼重設執行個體。 它會使用明確的認證的使用者指定的 「 重設密碼 」 存取權限。  
  
> [!IMPORTANT]
>  當您將使用者認證放在您的 Web.config 檔案中時，有潛在的安全性威脅。 包含 Web.config 檔案的目錄的存取權限的使用者可以讀取的檔案，並因此看到認證。 如需有關如何防範這項威脅的詳細資訊，請參閱[加密組態資訊使用受保護的組態](http://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1)。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionUsername="UserWithResetPasswordRights"  
          connectionPassword="PasswordForUser"  
          enablePasswordReset="true"  
          requiresQuestionAndAnswer="true"  
          attributeMapPasswordQuestion="PasswordQuestionADAttribute"  
          attributeMapPasswordAnswer="PasswordAnswerADAttribute"  
          attributeMapFailedPasswordAnswerCount="AnswerCountADAttribute"  
          attributeMapFailedPasswordAnswerTime="AnswerTimeADAttribute"  
          attributeMapFailedPasswordAnswerLockoutTime="LockOutTimeADAttribute" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="EnablePasswordRetrieval">
      <MemberSignature Language="C#" Value="public override bool EnablePasswordRetrieval { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnablePasswordRetrieval" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property EnablePasswordRetrieval As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool EnablePasswordRetrieval { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnablePasswordRetrieval : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets a value indicating whether the user's password can be retrieved from the Active Directory data store. This property always returns <see langword="false" />.</summary>
        <value>
          <see langword="false" /> 表示所不支援密碼擷取<see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />類別。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不支援密碼擷取。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordRetrieval" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="EnableSearchMethods">
      <MemberSignature Language="C#" Value="public bool EnableSearchMethods { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableSearchMethods" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property EnableSearchMethods As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableSearchMethods { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.EnableSearchMethods : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets a value indicating whether search-oriented <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> methods are available.</summary>
        <value>
          <see langword="true" /> 如果搜尋方法可供使用。否則， <see langword="false" />。 預設值為 <see langword="false" />。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 搜尋 Active Directory 伺服器可能會消耗大量資源，因為<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性可讓您關閉搜尋導向<xref:System.Web.Security.ActiveDirectoryMembershipProvider>方法。 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性設定您的應用程式組態檔使用`enableSearchMethods`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。  
  
 當<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性是`false`，沒有可用的方法，如下：  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A>  
  
 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 我們建議您不要啟用搜尋實際系統上，直到您已經確認所簽發的搜尋查詢<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不造成不良影響目錄伺服器的效能。 因為<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別設計為無狀態 Web 環境，就無法使用基礎所公開的分頁最佳化<xref:System.DirectoryServices>應用程式開發介面。 這表示在大型目錄搜尋時的分頁作業相當耗費資源，且應予以避免。 搜尋作業一定會針對連接字串中設定的目錄伺服器或在連接字串指向網域的情況下自動選取的伺服器發出。 提供者不為其搜尋方法使用通用類別目錄。  
  
   
  
## Examples  
 下列程式碼範例顯示 Web.config 項目，以設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>啟用搜尋 Active Directory 伺服器的執行個體。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          enableSearchMethods="true" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="FindUsersByEmail">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection FindUsersByEmail (string emailToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection FindUsersByEmail(string emailToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersByEmail (emailToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ FindUsersByEmail(System::String ^ emailToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindUsersByEmail : string * int * int *  -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.FindUsersByEmail (emailToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="emailToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="emailToMatch">Email address or portion of email address to search for.</param>
        <param name="pageIndex">The index of the page of results to return. <c>pageIndex</c> is zero-based.</param>
        <param name="pageSize">The size of the page of results to return.</param>
        <param name="totalRecords">When this method returns, contains the total number of users returned in the collection. This parameter is passed uninitialized.</param>
        <summary>Returns a collection of membership users from the Active Directory data store based on the user's email address.</summary>
        <returns>A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>方法取得<xref:System.Web.Security.MembershipUserCollection>其中含有使用者記錄，從 Active Directory 儲存符合`emailToMatch`參數。 使用者資料錄的電子郵件地址傳回以遞增順序排序。  
  
 `emailToMatch`參數會限制為 256 個字元。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別將會發出使用這兩個搜尋`clientSearchTimeout`和`serverSearchTimeout`組態值。 因為<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別執行搜尋目錄伺服器使用 512 每頁的資料列的頁面，逾時套用到所提取結果的每一頁<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別。 例如，如果搜尋查詢會產生 1000 個資料列，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會擷取這項資訊做為兩個頁面的資料。 這表示用戶端，並搜尋逾時將會開始從零時算起<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別要求資料的第二個頁面。  
  
 所傳回的結果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>方法受到`pageIndex`和`pageSize`參數。 `pageSize`參數指定的最大數目<xref:System.Web.Security.MembershipUser>中傳回的執行個體<xref:System.Web.Security.MembershipUserCollection>。 `pageIndex`參數會指定要傳回，其中 0 （零） 表示的第一頁的結果的分頁。  
  
 `totalRecords`參數是`out`Active Directory 資料存放區中找到的參數，設定為相符的成員資格使用者總數。 比方說，如果有 13 使用者設定的資料存放區，而`pageIndex`值為 1 以`pageSize`5，<xref:System.Web.Security.MembershipUserCollection>傳回會包含第 6 到第十個使用者。 `totalRecords`參數會設定為 13。  
  
 您可以控制是否允許使用者，藉由設定搜尋<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性中的應用程式組態檔使用`enableSearchMethods`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目. 設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性`false`導致<xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail%2A>方法會擲回<xref:System.NotSupportedException>例外狀況。  
  
 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 我們建議您不要啟用搜尋實際系統上，直到您已經確認所簽發的搜尋查詢<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不造成不良影響目錄伺服器的效能。 因為<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別設計為無狀態 Web 環境，就無法使用基礎所公開的分頁最佳化<xref:System.DirectoryServices>應用程式開發介面。 這表示在大型目錄搜尋時的分頁作業相當耗費資源，且應予以避免。 搜尋作業一定會針對連接字串中設定的目錄伺服器或在連接字串指向網域的情況下自動選取的伺服器發出。 提供者不為其搜尋方法使用通用類別目錄。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByEmail(System.String,System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="emailToMatch" /> is empty.  \- or -  <paramref name="emailToMatch" /> exceeds 256 characters.  \- or -  <paramref name="pageIndex" /> is less than 0.  \- or -  <paramref name="pageSize" /> is less than 1.  \- or -  <paramref name="pageSize" /> multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</exception>
        <exception cref="T:System.NotSupportedException">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</exception>
      </Docs>
    </Member>
    <Member MemberName="FindUsersByName">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection FindUsersByName (string usernameToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection FindUsersByName(string usernameToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindUsersByName (usernameToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ FindUsersByName(System::String ^ usernameToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindUsersByName : string * int * int *  -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.FindUsersByName (usernameToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="usernameToMatch">The user name or portion of a user name to search for.</param>
        <param name="pageIndex">The index of the page of results to return. <c>pageIndex</c> is zero-based.</param>
        <param name="pageSize">The size of the page of results to return.</param>
        <param name="totalRecords">When this method returns, contains the total number of records returned in the collection. This parameter is passed uninitialized.</param>
        <summary>Returns a collection of users from the Active Directory data store based on the user name.</summary>
        <returns>A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>方法會傳回<xref:System.Web.Security.MembershipUserCollection>含有使用者記錄從符合的所有使用者名稱的 Active Directory 資料存放區執行個體`userNameToMatch`參數。 會傳回依使用者名稱的字母順序排序記錄。  
  
 所傳回的結果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>方法受到`pageIndex`和`pageSize`參數。 `pageSize`參數指定的最大數目<xref:System.Web.Security.MembershipUser>中傳回的執行個體<xref:System.Web.Security.MembershipUserCollection>。 `pageIndex`參數會指定要傳回，其中 0 （零） 表示的第一頁的結果的分頁。  
  
 `totalRecords`參數是`out`Active Directory 資料存放區中找到的參數，設定為相符的成員資格使用者總數。 比方說，如果有 13 使用者設定的資料存放區，而`pageIndex`值為 1 以`pageSize`5，<xref:System.Web.Security.MembershipUserCollection>傳回會包含第 6 到第十個使用者。 `totalRecords`參數會設定為 13。  
  
 您可以控制是否允許使用者，藉由設定搜尋<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性中的應用程式組態檔使用`enableSearchMethods`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目. 設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性值設定為`false`導致<xref:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName%2A>方法會擲回<xref:System.NotSupportedException>例外狀況。  
  
 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 我們建議您不要啟用搜尋實際系統上，直到您已經確認所簽發的搜尋查詢<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不造成不良影響目錄伺服器的效能。 因為<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別設計為無狀態 Web 環境，就無法使用基礎所公開的分頁最佳化<xref:System.DirectoryServices>應用程式開發介面。 這表示在大型目錄搜尋時的分頁作業相當耗費資源，且應予以避免。 搜尋作業一定會針對連接字串中設定的目錄伺服器或在連接字串指向網域的情況下自動選取的伺服器發出。 提供者不為其搜尋方法使用通用類別目錄。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.FindUsersByName(System.String,System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="usernameToMatch" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).  \- or -  <paramref name="usernameToMatch" /> contains commas.  \- or -  <paramref name="pageIndex" /> is less than 0.  -or  <paramref name="pageSize" /> is less than 1.  \- or -  <paramref name="pageSize" /> multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</exception>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="usernameToMatch" /> is <see langword="null" />.</exception>
        <exception cref="T:System.NotSupportedException">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</exception>
      </Docs>
    </Member>
    <Member MemberName="GeneratePassword">
      <MemberSignature Language="C#" Value="public virtual string GeneratePassword ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string GeneratePassword() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GeneratePassword () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::String ^ GeneratePassword();" />
      <MemberSignature Language="F#" Value="abstract member GeneratePassword : unit -&gt; string&#xA;override this.GeneratePassword : unit -&gt; string" Usage="activeDirectoryMembershipProvider.GeneratePassword " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>Generates a random password.</summary>
        <returns>A random password.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A>方法<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別會呼叫<xref:System.Web.Security.Membership.GeneratePassword%2A>方法<xref:System.Web.Security.Membership>類別來擷取的隨機密碼。 密碼長度設定為值<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>屬性。 密碼長度不可以小於 14。  
  
 您可以特別呼叫<xref:System.Web.Security.Membership.GeneratePassword%2A>方法藉由參考<xref:System.Web.Security.ActiveDirectoryMembershipProvider>可以直接從提供者屬性的類別<xref:System.Web.Security.Membership>類別。  
  
 產生的密碼只能包含英數字元以及下列標點符號: ！ @# $%^ & * （） _-+ = [{}]};: <>&#124;。 /？。 沒有隱藏的或非可列印的控制字元會包含在產生的密碼。  
  
 產生的密碼至少會包含在指定的非英數字元數目<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>屬性。 產生的密碼不會測試中的規則運算式與<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>屬性。  
  
> [!NOTE]
>  <xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不會產生符合複雜性需求設定的目錄中的密碼。 很可能產生隨機密碼失敗目錄所設定的密碼複雜性規則。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="GetAllUsers">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUserCollection GetAllUsers (int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUserCollection GetAllUsers(int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetAllUsers (pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As MembershipUserCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUserCollection ^ GetAllUsers(int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.GetAllUsers : int * int *  -&gt; System.Web.Security.MembershipUserCollection" Usage="activeDirectoryMembershipProvider.GetAllUsers (pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUserCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pageIndex">The index of the page of results to return. <c>pageIndex</c> is zero-based.</param>
        <param name="pageSize">The size of the page of results to return.</param>
        <param name="totalRecords">When this method returns, contains the total number of records returned in the collection. This parameter is passed uninitialized.</param>
        <summary>Gets a collection of all the users stored in an Active Directory data source.</summary>
        <returns>A <see cref="T:System.Web.Security.MembershipUserCollection" /> containing <paramref name="pageSize" /><see cref="T:System.Web.Security.MembershipUser" /> instances beginning at the page specified by <paramref name="pageIndex" />.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個方法會呼叫<xref:System.Web.Security.Membership>從 ASP.NET 應用程式組態檔中指定的 Active Directory 資料存放區擷取使用者資訊的類別。  
  
 所傳回的結果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A>方法受到`pageIndex`和`pageSize`參數。 `pageSize`參數指定的最大數目<xref:System.Web.Security.MembershipUser>中傳回的執行個體<xref:System.Web.Security.MembershipUserCollection>集合。 `pageIndex`參數會指定要傳回，其中 0 （零） 表示的第一頁的結果的分頁。  
  
 `totalRecords`參數是`out`Active Directory 資料存放區中找到的參數，設定為相符的成員資格使用者總數。 比方說，如果有 13 使用者設定的資料存放區，而`pageIndex`值為 1 以 la `pageSize` 5，<xref:System.Web.Security.MembershipUserCollection>傳回會包含第 6 到第十個使用者。 `totalRecords`參數會設定為 13。  
  
 您可以控制是否允許使用者藉由設定搜尋<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性中的應用程式組態檔使用`enableSearchMethods`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。 設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性`false`導致<xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers%2A>方法會擲回<xref:System.NotSupportedException>例外狀況。  
  
 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 我們建議您不要啟用搜尋實際系統上，直到您已經確認所簽發的搜尋查詢<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不造成不良影響目錄伺服器的效能。 因為<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別設計為無狀態 Web 環境，就無法使用基礎所公開的分頁最佳化<xref:System.DirectoryServices>應用程式開發介面。 這表示在大型目錄搜尋時的分頁作業相當耗費資源，且應予以避免。 搜尋作業一定會針對連接字串中設定的目錄伺服器或在連接字串指向網域的情況下自動選取的伺服器發出。 提供者不為其搜尋方法使用通用類別目錄。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetAllUsers(System.Int32,System.Int32,System.Int32@)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="pageIndex" /> is less than 0.  -or  <paramref name="pageSize" /> is less than 1.  \- or -  <paramref name="pageSize" /> multiplied by <paramref name="pageIndex" />, plus <paramref name="pageSize" />, minus 1 is greater than <see cref="F:System.Int32.MaxValue" />.</exception>
        <exception cref="T:System.NotSupportedException">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods" /> property is <see langword="false" />.</exception>
      </Docs>
    </Member>
    <Member MemberName="GetNumberOfUsersOnline">
      <MemberSignature Language="C#" Value="public override int GetNumberOfUsersOnline ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 GetNumberOfUsersOnline() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetNumberOfUsersOnline () As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int GetNumberOfUsersOnline();" />
      <MemberSignature Language="F#" Value="override this.GetNumberOfUsersOnline : unit -&gt; int" Usage="activeDirectoryMembershipProvider.GetNumberOfUsersOnline " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>Throws a <see cref="T:System.NotSupportedException" /> exception in all cases.</summary>
        <returns>A <see cref="T:System.NotSupportedException" /> in all cases.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不支援傳回線上使用者的數目。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException">Any call to the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetNumberOfUsersOnline" /> method.</exception>
      </Docs>
    </Member>
    <Member MemberName="GetPassword">
      <MemberSignature Language="C#" Value="public override string GetPassword (string username, string passwordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string GetPassword(string username, string passwordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetPassword(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetPassword (username As String, passwordAnswer As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ GetPassword(System::String ^ username, System::String ^ passwordAnswer);" />
      <MemberSignature Language="F#" Value="override this.GetPassword : string * string -&gt; string" Usage="activeDirectoryMembershipProvider.GetPassword (username, passwordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">The user to retrieve the password for.</param>
        <param name="passwordAnswer">The password answer for the user.</param>
        <summary>Returns the password of the specified user from the database. The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> class does not support this method.</summary>
        <returns>Always throws a <see cref="T:System.NotSupportedException" /> exception.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不支援傳回使用者的密碼。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotSupportedException">The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> does not support password retrieval.</exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetUser">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Gets the information from a membership user in the Active Directory data store.</summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser GetUser (object providerUserKey, bool userIsOnline);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser GetUser(object providerUserKey, bool userIsOnline) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUser (providerUserKey As Object, userIsOnline As Boolean) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ GetUser(System::Object ^ providerUserKey, bool userIsOnline);" />
      <MemberSignature Language="F#" Value="override this.GetUser : obj * bool -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.GetUser (providerUserKey, userIsOnline)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="providerUserKey" Type="System.Object" />
        <Parameter Name="userIsOnline" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="providerUserKey">The unique identifier for the user.</param>
        <param name="userIsOnline">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> method ignores this parameter.</param>
        <summary>Gets the membership user information associated with the specified user key.</summary>
        <returns>A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user specified. If no user is found in the Active Directory data store for the specified <paramref name="providerUserKey" /> value, <see langword="null" /> is returned.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A>方法透過呼叫<xref:System.Web.Security.Membership>類別來擷取指定之使用者的詳細資訊，從 Active Directory 資料存放區。  
  
 搜尋會尋找的使用者執行個體的其中`objectSID`屬性相符項目`providerUserKey`參數。  
  
 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.Object,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="providerUserKey" /> is not of type <see cref="T:System.Security.Principal.SecurityIdentifier" />.</exception>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="providerUserKey" /> is <see langword="null" />.</exception>
      </Docs>
    </Member>
    <Member MemberName="GetUser">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipUser GetUser (string username, bool userIsOnline);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Security.MembershipUser GetUser(string username, bool userIsOnline) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUser (username As String, userIsOnline As Boolean) As MembershipUser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Security::MembershipUser ^ GetUser(System::String ^ username, bool userIsOnline);" />
      <MemberSignature Language="F#" Value="override this.GetUser : string * bool -&gt; System.Web.Security.MembershipUser" Usage="activeDirectoryMembershipProvider.GetUser (username, userIsOnline)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipUser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="userIsOnline" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="username">The name of the user to get information for.</param>
        <param name="userIsOnline">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> method ignores this parameter.</param>
        <summary>Gets the membership user information associated with the specified user name.</summary>
        <returns>A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user specified. If no user is found in the Active Directory data store for the specified <paramref name="username" /> value, <see langword="null" /> is returned.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser%2A>方法透過呼叫<xref:System.Web.Security.Membership>類別來擷取指定之使用者的詳細資訊，從 Active Directory 資料存放區。  
  
 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 開頭和尾端空白會刪減`username`參數值。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="username" /> is empty, or exceeds the maximum length for the user name (usually 256 characters).  \- or -  <paramref name="username" /> contains commas.  \- or -  The user name is mapped to the <see langword="userPrincipalName" /> attribute and the <paramref name="username" /> parameter contains backslashes.</exception>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="username" /> is <see langword="null" />.</exception>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUser(System.String,System.Boolean)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="GetUserNameByEmail">
      <MemberSignature Language="C#" Value="public override string GetUserNameByEmail (string email);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string GetUserNameByEmail(string email) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetUserNameByEmail (email As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ GetUserNameByEmail(System::String ^ email);" />
      <MemberSignature Language="F#" Value="override this.GetUserNameByEmail : string -&gt; string" Usage="activeDirectoryMembershipProvider.GetUserNameByEmail email" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="email" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="email">The email address to search for.</param>
        <summary>Gets the user name associated with the specified email address.</summary>
        <returns>The user name associated with the specified email address.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個方法會呼叫<xref:System.Web.Security.Membership>從 Active Directory 資料存放區擷取使用者名稱的類別，根據使用者的電子郵件地址。  
  
 如果成員資格資料存放區中的多個使用者具有相同電子郵件地址，則會傳回第一個遇到的使用者名稱。 您可以設定`requiresUniqueEmail`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)元素`true`應用程式組態檔，以確保每個電子郵件位址在資料庫中的是唯一的。  
  
 開頭和尾端空白會刪減`email`參數值。 如果電子郵件地址是空的修剪之後,<xref:System.ArgumentException>就會擲回。 如果電子郵件地址`null`，搜尋 Active Directory 資料存放區中的所有使用者名稱時，會傳回第一個使用者名稱。  
  
 我們建議您不要啟用搜尋實際系統上，直到您已經確認所簽發的搜尋查詢<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別不造成不良影響目錄伺服器的效能。  
  
> [!IMPORTANT]
>  <xref:System.Web.Security.ActiveDirectoryMembershipProvider.GetUserNameByEmail%2A>方法會執行，即使<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnableSearchMethods%2A>屬性是`false`。  
  
 因為<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別設計為無狀態 Web 環境，就無法使用基礎所公開的分頁最佳化<xref:System.DirectoryServices>應用程式開發介面。 這表示在大型目錄搜尋時的分頁作業相當耗費資源，且應予以避免。 搜尋作業一定會針對連接字串中設定的目錄伺服器或在連接字串指向網域的情況下自動選取的伺服器發出。 提供者不為其搜尋方法使用通用類別目錄。  
  
 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="email" /> exceeds 256 characters  \- or -  after trimming, <paramref name="email" /> is empty.</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">More than one user exists in the data store with the same email address and the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property value is <see langword="true" />.</exception>
        <exception cref="T:System.InvalidOperationException">The provider is not initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="Initialize">
      <MemberSignature Language="C#" Value="public override void Initialize (string name, System.Collections.Specialized.NameValueCollection config);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Initialize(string name, class System.Collections.Specialized.NameValueCollection config) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Initialize (name As String, config As NameValueCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Initialize(System::String ^ name, System::Collections::Specialized::NameValueCollection ^ config);" />
      <MemberSignature Language="F#" Value="override this.Initialize : string * System.Collections.Specialized.NameValueCollection -&gt; unit" Usage="activeDirectoryMembershipProvider.Initialize (name, config)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="name" Type="System.String" />
        <Parameter Name="config" Type="System.Collections.Specialized.NameValueCollection" />
      </Parameters>
      <Docs>
        <param name="name">The name of the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance to initialize.</param>
        <param name="config">A <see cref="T:System.Collections.Specialized.NameValueCollection" /> containing the names and values of the configuration options for the membership provider.</param>
        <summary>Initializes the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance with the property values from the application's configuration files. This method is not intended to be called from your code.</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個方法會初始化<xref:System.Web.Security.ActiveDirectoryMembershipProvider>ASP.NET 應用程式組態檔 (Web.config) 中指定物件的屬性值，而不是直接從您的程式碼使用。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="config" /> is <see langword="null" />.</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">The <see langword="applicationName" /> attribute specified in the application configuration exceeds 256 characters.  \- or -  The <see langword="connectionStringName" /> attribute is empty or does not exist in the application configuration.  \- or -  The connection string specified in the <see langword="connectionStringName" /> attribute in the application configuration file is empty or does not exist.  \- or -  The <see langword="connectionProtection" /> attribute is set to a value other than <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> or <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> in the application configuration file.  \- or -  The <see langword="connectionUsername" /> attribute is specified in the application configuration file but its value is empty.  \- or -  The <see langword="connectionPassword" /> attribute is specified in the application configuration file but its value is empty.  \- or -  Either the <see langword="connectionUsername" /> attribute or the <see langword="connectionPassword" /> attribute is specified in the application configuration file, but not both.  \- or -  The <see langword="clientSearchTimeout" /> attribute is specified but is not a positive integer.  \- or -  The <see langword="serverSearchTimeout" /> attribute is specified but is not a positive integer.  \- or -  The <see langword="enableSearchMethods" /> attribute is specified, but is not a Boolean value.  \- or -  The <see langword="requiresUniqueEmail" /> attribute is specified, but is not a Boolean value.  \- or -  The <see langword="enablePasswordReset" /> attribute is specified, but is not a Boolean value.  \- or -  The <see langword="requiresQuestionAndAnswer" /> attribute is specified, but is not a Boolean value.  \- or -  The <see langword="minRequiredPasswordLength" /> attribute is specified and it is either negative or greater than 128.  \- or -  The <see langword="minRequiredNonalphanumericCharacters" /> attribute is specified and it is either negative or greater than 128.  \- or -  The regular expression specified in the <see langword="passwordStrengthRegularExpression" /> attribute in the application configuration file is not a valid regular expression  \- or -  The <see langword="attributeMapUsername" /> attribute is specified, but it is an empty string.  \- or -  The <see langword="connectionString" /> attribute does not begin with "LDAP".  \- or -  The connection string specified in the <see langword="connectionString" /> attribute is invalid.  \- or -  The connection string in the <see langword="connectionString" /> attribute specifies a server-less bind.  \- or -  The <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not establish a connection with the domain or directory server.  \- or -  The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" />, but neither an SSL nor a signed and sealed connection can be established with the server.  \- or -  The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.None" /> but the <see langword="connectionUsername" /> and <see langword="connectionPassword" /> attributes are not set.  \- or -  The <see langword="connectionProtection" /> attribute is set to <see cref="F:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal" /> but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not establish an SSL connection with an ADAM server.  \- or -  The <see langword="connectionString" /> attribute specifies either the global catalog (GC) or an SSL global catalog port.  \- or -  The <see langword="connectionString" /> attribute specifies an Active Directory server or domain, but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not retrieve the default naming context for the domain.  \- or -  The <see langword="connectionString" /> attribute specifies an Active Directory server or domain, but the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> could not retrieve the default users container.  \- or -  The <see langword="connectionString" /> attribute specifies an ADAM server, but it does not specify an application partition or container.  \- or -  The <see langword="connectionString" /> attribute specifies an application partition or container, but the specified container does not exist.  \- or -  The <see langword="connectionString" /> attribute specifies a container that is not allowed to contain user instances.  An attribute mapping is specified but its value was empty.  \- or -  An attribute mapping is specified twice.  \- or -  An attribute mapping is specified but the attribute does not exist on the user instance.  \- or -  An attribute mapping is specified but the directory attribute is not of the correct data type.  \- or -  An attribute mapping is specified but the directory attribute is multi-valued.  \- or -  The <see langword="attributeMapUserName" /> attribute is specified but was mapped to neither the <c>sAMAccountName</c> nor the <c>userPrincipalName</c> directory attribute when connecting to an Active Directory.  \- or -  The <see langword="attributeMapUserName" /> attribute is specified but was not mapped to the <c>userPrincipalName</c> directory attribute when connecting to an ADAM server.  \- or -  The <see langword="enablePasswordReset" /> attribute is <see langword="true" /> and the <see langword="requiresQuestionAndAnswer" /> attribute is <see langword="false" /> in the application configuration file.  \- or -  The <see langword="maxInvalidPasswordAttempts" /> attribute was specified but is not a non-zero positive integer.  \- or -  The <see langword="passwordAttemptWindow" /> attribute was specified but is not a non-zero positive integer.  \- or -  The <see langword="passwordAnswerAttemptLockoutDuration" /> attribute was specified but is not a non-zero positive integer.  \- or -  The <see langword="enablePasswordReset" /> attribute is <see langword="true" /> and any of the <see langword="attributeMapFailedPasswordAnswerCount" />, <see langword="attributeMapFailedPasswordAnswerTime" />, and <see langword="attributeMapFailedPasswordAnswerLockoutTime" /> attributes are empty.  \- or -  The <see langword="requiresQuestionAndAnswer" /> attribute is <see langword="true" /> but either the <see langword="attributeMapPasswordQuestion" /> or the <see langword="attributeMapPasswordAnswer" /> attribute is empty.  \- or -  An attribute specified in the application configuration file is not valid.</exception>
        <exception cref="T:System.Web.HttpException">The application is running in a hosted environment and the <see cref="T:System.Web.AspNetHostingPermissionLevel" /> is set to <see cref="F:System.Web.AspNetHostingPermissionLevel.Minimal" />.</exception>
        <exception cref="T:System.Runtime.InteropServices.COMException">An error occurred while querying the directory.</exception>
      </Docs>
    </Member>
    <Member MemberName="MaxInvalidPasswordAttempts">
      <MemberSignature Language="C#" Value="public override int MaxInvalidPasswordAttempts { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MaxInvalidPasswordAttempts" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MaxInvalidPasswordAttempts As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MaxInvalidPasswordAttempts { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MaxInvalidPasswordAttempts : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets the number of failed answer attempts a user is allowed for the password-reset question.</summary>
        <value>失敗的密碼數目回答允許使用者帳戶鎖定前的嘗試。 預設值是<c>5</c>。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 當<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，使用者必須回答密碼重設其密碼。 使用者所建立的時間間隔內允許有限的數目的解答嘗試<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性。 如果密碼解答嘗試次數大於或等於值儲存在<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性，使用者會遭到鎖定而無法進一步嘗試分鐘數儲存在<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性。  
  
> [!NOTE]
>  這個屬性不會控制使用者可以進行之前被鎖定的登入失敗的次數。Active Directory 伺服器處理登入嘗試失敗，並不會受到這個屬性的值。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性設定您的應用程式組態檔使用`maxInvalidPasswordAttempts`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。 如果應用程式的組態檔中，未設定的屬性<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性設定的預設值為`5`。  
  
   
  
## Examples  
 下列程式碼範例顯示 Web.config 項目，以設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>在 10 分鐘時間視窗中輸入的密碼解答嘗試要鎖定失敗，產生三個使用者執行個體。 如果使用者遭到鎖定時，不進行任何可能在 15 分鐘進行嘗試回答密碼問題。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
          passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="MinRequiredNonAlphanumericCharacters">
      <MemberSignature Language="C#" Value="public override int MinRequiredNonAlphanumericCharacters { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinRequiredNonAlphanumericCharacters" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MinRequiredNonAlphanumericCharacters As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MinRequiredNonAlphanumericCharacters { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinRequiredNonAlphanumericCharacters : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets the minimum number of special characters that must be present in a valid password.</summary>
        <value>有效的密碼中必須要有的特殊字元數目下限。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>屬性會傳回特殊的非英數字元，必須輸入來建立有效的密碼最小數目。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>屬性值會設定在應用程式組態中，使用`minRequiredNonalphanumericCharacters`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)組態項目。  
  
 非英數字元是字元的<xref:System.Char.IsLetterOrDigit%2A>方法會傳回`false`。  
  
   
  
## Examples  
 下列範例所示[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)中的組態項目`system.web`應用程式的 Web.config 檔案區段。 它會指定應用程式使用的執行個體<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別提供成員資格服務與集`minRequiredNonalphanumericCharacters`屬性設定為一個字元。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          minRequiredNonalphanumericCharacters = "1" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="MinRequiredPasswordLength">
      <MemberSignature Language="C#" Value="public override int MinRequiredPasswordLength { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinRequiredPasswordLength" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property MinRequiredPasswordLength As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int MinRequiredPasswordLength { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinRequiredPasswordLength : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets the minimum length required for a password.</summary>
        <value>密碼所需的最小長度。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>屬性會取得建立有效的密碼必須輸入的字元數目下限。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>屬性值會設定在應用程式組態中，使用`minRequiredPasswordLength`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)組態項目。  
  
   
  
## Examples  
 下列範例所示[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)中的組態項目`system.web`應用程式的 Web.config 檔案區段。 它會指定應用程式使用的執行個體<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別提供成員資格服務與集`minRequiredPasswordLength`屬性設定為七個字元。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          minRequiredPasswordLength = "7" />  
  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="PasswordAnswerAttemptLockoutDuration">
      <MemberSignature Language="C#" Value="public int PasswordAnswerAttemptLockoutDuration { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 PasswordAnswerAttemptLockoutDuration" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property PasswordAnswerAttemptLockoutDuration As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int PasswordAnswerAttemptLockoutDuration { int get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordAnswerAttemptLockoutDuration : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Get the length of time for which a user account is locked out after the user makes too many bad password-answer attempts.</summary>
        <value>時間，以分鐘為單位，使用者會提供太多的不正確的密碼解答之後鎖定。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 當<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，使用者必須回答密碼重設其密碼。 如果使用者無法提供正確答案連續的次數等於<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>觀察所指定的時間週期內的屬性值<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性，使用者會進一步嘗試會基於鎖定的分鐘數包含在<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性。  
  
> [!NOTE]
>  這個屬性未設定使用者鎖定無法輸入有效的密碼後的持續時間。 Active Directory 伺服器處理登入嘗試失敗，並不會受到這個屬性的值。 我們建議最好讓<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性設定為相同的值為帳戶鎖定期間，指定太多失敗 Active Directory 組態中的登入嘗試。 這會呈現一致的自動鎖定行為的使用者，不論是否他們鎖定由於嘗試登入失敗或錯誤密碼解答。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性設定您的應用程式組態檔使用`passwordAnswerAttemptLockoutDuration`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。 如果應用程式的組態檔中，未設定的屬性<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性設定為預設值為 30 分鐘。  
  
   
  
## Examples  
 下列程式碼範例顯示 Web.config 項目，以設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>在 10 分鐘時間視窗中輸入的密碼解答嘗試要鎖定失敗，產生三個使用者執行個體。 如果使用者遭到鎖定時，不進行任何可能在 15 分鐘進行嘗試回答密碼問題。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
          passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="PasswordAttemptWindow">
      <MemberSignature Language="C#" Value="public override int PasswordAttemptWindow { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 PasswordAttemptWindow" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordAttemptWindow As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property int PasswordAttemptWindow { int get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordAttemptWindow : int" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets the time window during which consecutive failed attempts to provide a valid password or a valid password answer are tracked.</summary>
        <value>時間間隔，以分鐘為單位，回應會追蹤期間的連續失敗嘗試提供有效的密碼或有效的密碼。 預設為 10 分鐘。 每個失敗的嘗試之間的間隔是否大於<see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" />屬性設定<see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />執行個體會將每個失敗的嘗試，如同它是第一次嘗試失敗。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性可搭配<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>內容，協助防範不必要的來源，破解的密碼或密碼解答的成員資格使用者，透過重複嘗試。 當使用者嘗試登入、 變更其密碼，或重設其密碼時，請指定的時間間隔內允許只有特定數目的連續嘗試。 所指定的時間間隔長度<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性，其可識別允許無效嘗試之間的分鐘數。 如果嘗試失敗的連續數使用者進行重設其或其密碼等於中儲存的值<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性，以及時間後經過無效上次小於指定的分鐘數<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性，則使用者帳戶 s 鎖定中所包含的分鐘數<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性。 如果目前的失敗的嘗試和上一次的失敗的嘗試之間的間隔超過<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性設定值，目前的無效嘗試視為第一次嘗試。 如果之前允許的無效嘗試次數上限為止，請提供有效的密碼解答，無效的密碼解答嘗試計數是設定為零。 如果允許無效的最大數目之前提供有效的密碼嘗試次數達到時，不正確的密碼嘗試次數的計數和無效的密碼解答嘗試計數設定為零。  
  
 我們建議最好讓<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性設定為相同的值為帳戶鎖定期間指定為最大數目的失敗登入嘗試次數 Active Directory 組態中。 這會在他們鎖定由於嘗試登入失敗或錯誤密碼解答是否呈現一致的自動鎖定行為的使用者。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性設定您的應用程式組態檔使用`passwordAttemptWindow`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。 如果應用程式的組態檔中，未設定的屬性<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性設定為預設值為 10 分鐘。  
  
   
  
## Examples  
 下列程式碼範例顯示 Web.config 項目，以設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>在 10 分鐘時間視窗中輸入的密碼解答嘗試要鎖定失敗，產生三個使用者執行個體。 如果使用者遭到鎖定時，不進行任何可能在 15 分鐘進行嘗試回答密碼問題。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          maxInvalidPasswordAttempts="3"  
          passwordAttemptWindow="10"  
        passwordAnswerAttemptLockoutDuration="15" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="PasswordFormat">
      <MemberSignature Language="C#" Value="public override System.Web.Security.MembershipPasswordFormat PasswordFormat { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Web.Security.MembershipPasswordFormat PasswordFormat" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordFormat As MembershipPasswordFormat" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::Web::Security::MembershipPasswordFormat PasswordFormat { System::Web::Security::MembershipPasswordFormat get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordFormat : System.Web.Security.MembershipPasswordFormat" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.MembershipPasswordFormat</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets a value indicating the format of passwords in the Active Directory data store.</summary>
        <value>其中一個 <see cref="T:System.Web.Security.MembershipPasswordFormat" /> 值。 <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordFormat" />屬性一律會傳回<see cref="F:System.Web.Security.MembershipPasswordFormat.Hashed" />。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>屬性不支援密碼擷取。 行為<xref:System.Web.Security.ActiveDirectoryMembershipProvider>物件是使用其他提供者與相同`Hashed`密碼。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="PasswordStrengthRegularExpression">
      <MemberSignature Language="C#" Value="public override string PasswordStrengthRegularExpression { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string PasswordStrengthRegularExpression" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property PasswordStrengthRegularExpression As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ PasswordStrengthRegularExpression { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.PasswordStrengthRegularExpression : string" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets the regular expression used to evaluate a password.</summary>
        <value>用來評估密碼的規則運算式。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>屬性會取得用來評估密碼複雜度的規則運算式。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>屬性不用來驗證中的自動產生密碼<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>屬性設定在應用程式組態中，使用`passwordStrengthRegularExpression`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)組態項目。  
  
   
  
## Examples  
 下列範例所示[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)中的組態項目`system.web`應用程式的 Web.config 檔案區段。 它會指定應用程式使用的執行個體<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別提供成員資格服務與集`passwordStrengthRegularExpression`屬性驗證的密碼是否符合下列條件的規則運算式：  
  
-   Is greater than 七個字元。  
  
-   包含至少一個數字。  
  
-   包含至少一個特殊的 （非英數） 字元。  
  
 如果密碼不符合這些準則，成員資格提供者不接受的密碼。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          passwordStrengthRegularExpression=  
            "@\"(?=.{6,})(?=(.*\d){1,})(?=(.*\W){1,})" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression" /> property is accessed before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="RequiresQuestionAndAnswer">
      <MemberSignature Language="C#" Value="public override bool RequiresQuestionAndAnswer { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RequiresQuestionAndAnswer" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property RequiresQuestionAndAnswer As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool RequiresQuestionAndAnswer { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.RequiresQuestionAndAnswer : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets a value indicating whether the membership provider is configured to require a password question and answer when creating a user.</summary>
        <value>
          <see langword="true" /> 如果<see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" />物件是設定成需要密碼問題和解答的使用者; 否則<see langword="false" />。 預設值為 <see langword="false" />。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>屬性設定您的應用程式組態檔使用`requiresQuestionAndAnswer`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。 如果應用程式的組態檔中，未設定的屬性<xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>屬性設定的預設值為`false`。  
  
 當`requiresQuestionAndAnswer`屬性設為`true`，您也必須設定這些額外的屬性。  
  
-   `attributeMapPasswordQuestion` 和`attributeMapPasswordAnswer`必須對應到 Active Directory 架構中的屬性。  
  
 如果不符合上述準則，<xref:System.Configuration.Provider.ProviderException>會在初始設定擲回。  
  
> [!NOTE]
>  您可以建立使用者時需要密碼問題和解答，但設<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性`false`以防止使用者變更他們使用的密碼<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別。  
  
   
  
## Examples  
 下列程式碼範例顯示 Web.config 項目，以設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>来啟用密碼重設執行個體。 它會使用明確的認證的使用者指定的 「 重設密碼 」 存取權限。  
  
> [!IMPORTANT]
>  當您將使用者認證放在您的 Web.config 檔案中時，有潛在的安全性威脅。 包含 Web.config 檔案的目錄的存取權限的使用者可以讀取的檔案，並因此看到認證。 如需有關如何防範這項威脅的詳細資訊，請參閱[加密組態資訊使用受保護的組態](http://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1)。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"  
          connectionUsername="UserWithResetPasswordRights"  
          connectionPassword="PasswordForUser"  
          enablePasswordReset="true"  
          requiresQuestionAndAnswer="true"  
          attributeMapPasswordQuestion="PasswordQuestionADAttribute"  
          attributeMapPasswordAnswer="PasswordAnswerADAttribute"  
          attributeMapFailedPasswordAnswerCount="AnswerCountADAttribute"  
          attributeMapFailedPasswordAnswerTime="AnswerTimeADAttribute"  
          attributeMapFailedPasswordAnswerLockoutTime="LockOutTimeADAttribute" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="RequiresUniqueEmail">
      <MemberSignature Language="C#" Value="public override bool RequiresUniqueEmail { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool RequiresUniqueEmail" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" />
      <MemberSignature Language="VB.NET" Value="Public Overrides ReadOnly Property RequiresUniqueEmail As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property bool RequiresUniqueEmail { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.RequiresUniqueEmail : bool" Usage="System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets a value indicating whether an email address stored on the Active Directory server must be unique.</summary>
        <value>
          <see langword="true" /> 如果電子郵件地址必須是唯一的。否則， <see langword="false" />。 預設值為 <see langword="false" />。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 當<xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A>屬性是`true`、<xref:System.Web.Security.ActiveDirectoryMembershipProvider>電子郵件地址不由任何其他使用者在目前執行個體可確保內時請<xref:System.Web.Security.ActiveDirectoryMembershipProvider.CreateUser%2A>或<xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A>方法呼叫。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A>屬性設定您的應用程式組態檔使用`requiresUniqueEmail`屬性[元素 （ASP.NET 設定結構描述） 的成員資格](http://msdn.microsoft.com/library/b9c1ee8f-33ca-4361-8666-b42a0fe86049)項目。 如果應用程式的組態檔中，未設定的屬性<xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail%2A>屬性設定的預設值為`false`。  
  
   
  
## Examples  
 下列程式碼範例顯示 Web.config 項目，以設定<xref:System.Web.Security.ActiveDirectoryMembershipProvider>需要唯一的電子郵件地址的使用者儲存在 Active Directory 伺服器上的執行個體。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="ADService" connectionString="LDAP://ldapServer/" />  
  </connectionStrings>  
  <system.web>  
    <membership defaultProvider="AspNetActiveDirectoryMembershipProvider">  
      <providers>  
        <add name="AspNetActiveDirectoryMembershipProvider"   
          type="System.Web.Security.ActiveDirectoryMembershipProvider,   
          System.Web, Version=2.0.3600, Culture=neutral,   
          PublicKeyToken=b03f5f7f11d50a3a"  
          requiresUniqueEmail="true" />  
      </providers>  
    </membership>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">An attempt to access the <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property was made before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance was initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="ResetPassword">
      <MemberSignature Language="C#" Value="public override string ResetPassword (string username, string passwordAnswer);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string ResetPassword(string username, string passwordAnswer) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ResetPassword (username As String, passwordAnswer As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ ResetPassword(System::String ^ username, System::String ^ passwordAnswer);" />
      <MemberSignature Language="F#" Value="override this.ResetPassword : string * string -&gt; string" Usage="activeDirectoryMembershipProvider.ResetPassword (username, passwordAnswer)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="passwordAnswer" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">The user to reset the password for.</param>
        <param name="passwordAnswer">The password answer for the specified user.</param>
        <summary>Resets a user's password to a new, automatically generated password.</summary>
        <returns>The new password for the specified user.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 方法會呼叫<xref:System.Web.Security.Membership>隨機 Active Directory 資料存放區中的使用者密碼重設到新的類別產生的值。 傳回新的密碼。  
  
> [!NOTE]
>  所建立的隨機密碼<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法不保證傳遞規則運算式中的<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordStrengthRegularExpression%2A>屬性。 不過，隨機密碼將會符合所建立的準則<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredPasswordLength%2A>和<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MinRequiredNonAlphanumericCharacters%2A>屬性。  
  
 如果不正確的回應提供給<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法時，追蹤無效的密碼解答嘗試都會加一的內部計數器。 這會導致使用者無法登入，直到鎖定狀態的呼叫，以清除<xref:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser%2A>方法。 如果提供正確的密碼解答，且使用者目前並不遭到鎖定，則會追蹤無效的密碼嘗試次數的內部計數器會重設為零。 如需詳細資訊，請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>和<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性。  
  
 所有參數值會都修剪開頭和尾端空白。  
  
 您可以呼叫<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法，直接由第一次取得參考<xref:System.Web.Security.ActiveDirectoryMembershipProvider>的執行個體<xref:System.Web.Security.Membership.Provider%2A?displayProperty=nameWithType>屬性。  
  
 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 若要在 Active Directory 伺服器上，設定密碼`connectionProtection`屬性必須設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>。  
  
 當使用 ADAM 伺服器，`connectionProtection`屬性可以設為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>，但如果您已明確設定 ADAM 伺服器以允許透過不安全連接的密碼變更。  
  
> [!IMPORTANT]
>  除非用來連接到 Active Directory 伺服器的認證具有網域系統管理員權限 （不建議） 或 「 重設密碼 」 存取權限，無法重設密碼。  
  
 重設密碼，所有下列條件必須成立：  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性必須設定為`true`。  
  
-   Active Directory 架構必須修改成包含儲存的密碼問題和解答，屬性和三種追蹤欄位的密碼解答的變更。  
  
-   `attributeMapPasswordQuestion`， `attributeMapPasswordAnswer`， `attributMapFailedPasswordAnswerCount`， `attributeMapFailedPasswordAnswerTime`，和`attributeMapFailedPasswordAnswerLockedTime`屬性必須設定應用程式組態檔中。  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresQuestionAndAnswer%2A>屬性必須設定為`true`。  
  
-   連線至 Active Directory 資料存放區 （處理帳戶或明確的認證） 的安全性內容中必須有足夠的權限，才能變更密碼。 用來連接到 Active Directory 伺服器的認證具有網域系統管理員權限 （不建議） 或 「 重設密碼 」 存取權限。  
  
> [!NOTE]
>  設定 Active Directory 伺服器上的安全性原則可能會使得<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword%2A>方法來產生密碼符合原則。 預設實作<xref:System.Web.Security.ActiveDirectoryMembershipProvider.GeneratePassword%2A>方法會產生滿足網域控制站執行 Windows Server 2003 SP1 上的預設密碼原則的密碼。 如果無法重設密碼，因為安全性原則的 Active Directory 伺服器上，<xref:System.Configuration.Provider.ProviderException>就會擲回。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ResetPassword(System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
        <exception cref="T:System.NotSupportedException">The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset" /> property value is <see langword="false" />.</exception>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="passwordAnswer" /> is <see langword="null" />.  \- or -  <paramref name="username" /> is <see langword="null" />.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="passwordAnswer" /> is empty after trimming  \- or -  <paramref name="passwordAnswer" /> exceeds 128 characters.  \- or -  <paramref name="username" /> is empty, or exceeds the maximum length allowed for user names (usually 256 characters).  \- or -  <paramref name="username" /> contains commas.  \- or -  The user name is mapped to <see langword="userPrincipalName" /> but the <paramref name="username" /> parameter contains backslashes.</exception>
        <exception cref="T:System.Web.Security.MembershipPasswordException">The user is locked out because of too many bad logon attempts or too many attempted password-answer reset attempts.  \- or -  <paramref name="passwordAnswer" /> does not match the stored password answer.</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">The user specified in <paramref name="username" /> does not exist in the Active Directory data store.  \- or -  A generated password does not pass a custom validation handler.  \- or -  The generated password is not complex enough to satisfy custom password policies set on the Active Directory server.  \- or -  A secure connection cannot be made to an Active Directory Application Mode server to set the new password.</exception>
        <exception cref="T:System.Exception">An unhandled exception occurred.</exception>
      </Docs>
    </Member>
    <Member MemberName="UnlockUser">
      <MemberSignature Language="C#" Value="public override bool UnlockUser (string username);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool UnlockUser(string username) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function UnlockUser (username As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool UnlockUser(System::String ^ username);" />
      <MemberSignature Language="F#" Value="override this.UnlockUser : string -&gt; bool" Usage="activeDirectoryMembershipProvider.UnlockUser username" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">The name of the membership user to clear the lock status for.</param>
        <summary>Clears a lock so that a membership user can be validated.</summary>
        <returns>
          <see langword="true" /> if the membership user was successfully unlocked; otherwise, <see langword="false" />. The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> method also returns <see langword="false" /> when the membership user is not found in the data store.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 使用者最常鎖定且無法驗證所<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>方法時<xref:System.Web.Security.ActiveDirectoryMembershipProvider.MaxInvalidPasswordAttempts%2A>屬性中指定的時間內超過<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAttemptWindow%2A>屬性或嘗試次數過多時進行登入使用的密碼錯誤。  
  
 如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，當使用者時，解除鎖定計數器會重設不正確的密碼。  
  
 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 開頭和尾端空白會刪減`username`參數值。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="username" /> is empty, or exceeds the maximum length allowed for user names (usually 256 characters).  \- or -  <paramref name="username" /> contains commas.  \- or -  The user name is mapped to <see langword="userPrincipalName" /> but the <paramref name="username" /> parameter contains backslashes.</exception>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="username" /> is <see langword="null" />.</exception>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UnlockUser(System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
      </Docs>
    </Member>
    <Member MemberName="UpdateUser">
      <MemberSignature Language="C#" Value="public override void UpdateUser (System.Web.Security.MembershipUser user);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void UpdateUser(class System.Web.Security.MembershipUser user) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub UpdateUser (user As MembershipUser)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void UpdateUser(System::Web::Security::MembershipUser ^ user);" />
      <MemberSignature Language="F#" Value="override this.UpdateUser : System.Web.Security.MembershipUser -&gt; unit" Usage="activeDirectoryMembershipProvider.UpdateUser user" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.Web.Security.MembershipUser" />
      </Parameters>
      <Docs>
        <param name="user">A <see cref="T:System.Web.Security.MembershipUser" /> instance representing the user to update and the updated information for the user.</param>
        <summary>Updates information about a user in the Active Directory data store.</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個方法會呼叫<xref:System.Web.Security.Membership>更新 Active Directory 資料存放區中的使用者資訊的類別。 <xref:System.Web.Security.MembershipUser.Email%2A>， <xref:System.Web.Security.MembershipUser.Comment%2A>，和<xref:System.Web.Security.MembershipUser.IsApproved%2A>屬性值也會更新指定的成員資格使用者。 會忽略所有其他屬性。  
  
 最大長度`username`參數為 256 個字元。 最大長度<xref:System.Web.Security.MembershipUser.Email%2A>屬性為 256 個字元。  
  
 成員資格使用者的密碼不能使用更新<xref:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser%2A>方法。 若要更新成員資格使用者的密碼，請使用<xref:System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword%2A>方法。  
  
 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.UpdateUser(System.Web.Security.MembershipUser)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="user" /> is <see langword="null" />.  \- or -  The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property is <see langword="true" /> but the email address from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance is <see langword="null" />.</exception>
        <exception cref="T:System.ArgumentException">The <see cref="P:System.Web.Security.MembershipUser.Email" /> property is empty after trimming.  \- or -  The <see cref="P:System.Web.Security.MembershipUser.Email" /> property exceeds 256 characters.  \- or -  The <see cref="P:System.Web.Security.MembershipUser.Comment" /> property exceeds 1024 characters.  \- or -  The <see cref="P:System.Web.Security.MembershipUser.Comment" /> property is empty.  \- or -  The user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance is empty, or exceeds the maximum length allowed for user names (usually 256 characters).  \- or -  The user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance contains commas.  \- or -  The user name is mapped to <see langword="userPrincipalName" /> but the user name from the supplied <see cref="T:System.Web.Security.MembershipUser" /> instance contains backslashes.</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">The specified user is not found in the Active Directory data store.  \- or -  The <see cref="P:System.Web.Security.ActiveDirectoryMembershipProvider.RequiresUniqueEmail" /> property is <see langword="true" />, and the new value of the <see cref="P:System.Web.Security.MembershipUser.Email" /> property duplicates an existing email address.</exception>
      </Docs>
    </Member>
    <Member MemberName="ValidateUser">
      <MemberSignature Language="C#" Value="public override bool ValidateUser (string username, string password);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool ValidateUser(string username, string password) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ValidateUser (username As String, password As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool ValidateUser(System::String ^ username, System::String ^ password);" />
      <MemberSignature Language="F#" Value="override this.ValidateUser : string * string -&gt; bool" Usage="activeDirectoryMembershipProvider.ValidateUser (username, password)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">The name of the user to validate.</param>
        <param name="password">The password for the specified user.</param>
        <summary>Verifies that the specified user name and password exist in the Active Directory data store.</summary>
        <returns>
          <see langword="true" /> if the specified <paramref name="username" /> and <paramref name="password" /> are valid; otherwise, <see langword="false" />. If the user specified does not exist in the Active Directory data store, the <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> method returns <see langword="false" />.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 這個方法會呼叫<xref:System.Web.Security.Membership>類別來驗證使用者認證，針對 Active Directory 資料存放區。  
  
 如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`和提供的認證有效，而且會重設錯誤密碼解答的使用者追蹤計數器。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser%2A>方法可能會傳回`false`當正確的認證提供時，在下列情況：  
  
1.  使用者帳戶已鎖定目錄伺服器因為失敗的登入嘗試次數過多。 使用者無法登入目錄的鎖定期間到期之前。  
  
2.  如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`，如果使用者提供不正確的密碼解答次數太多鎖定的使用者帳戶。 使用者的帳戶將會解除鎖定中指定的時間之後<xref:System.Web.Security.ActiveDirectoryMembershipProvider.PasswordAnswerAttemptLockoutDuration%2A>屬性已通過。  
  
3.  使用者必須存在於連接字串中指定的容器。 位於不同的容器或不同的網域使用者帳戶提供有效的認證。 使用者必須存在於連接字串中指定的容器。  
  
 當驗證使用者時，提供者會藉由連接到使用指定的使用者名稱和密碼，不將應用程式組態檔中設定的認證在 Active Directory 資料存放區驗證認證。  
  
 不過，<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體將會連接到使用已設定的認證，原因如下的目錄。  
  
-   若要確認使用者是否存在的搜尋範圍由內<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體的連接字串。 提供者會使用樹狀子目錄搜尋從指定的連接字串中搜尋點開始，以判斷使用者是否存在。 使用者必須存在於指定的容器。 將不會驗證連接字串指定的容器外有效的認證。 請參閱<xref:System.Web.Security.ActiveDirectoryMembershipProvider>類別主題取得有關連接字串的詳細資訊。  
  
-   如果<xref:System.Web.Security.ActiveDirectoryMembershipProvider.EnablePasswordReset%2A>屬性是`true`、<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體會載入使用者執行個體，以檢查是否有已鎖定使用者因為他或她發出太多失敗的變更的密碼解答嘗試使用已設定的認證.  
  
> [!IMPORTANT]
>  啟用 「 來賓 」 帳戶連接到 Active Directory 網域控制站可能會造成安全性威脅。 啟用 「 來賓 」 帳戶的 Active Directory 網域控制站上所做的所有驗證嘗試會都成功。 若要使用的 Active Directory 網域控制站時，請提高安全性，您應該停用網域控制站上的 「 來賓 」 帳戶。  
  
 <xref:System.Web.Security.ActiveDirectoryMembershipProvider>當符合下列條件時，執行個體將會嘗試並行繫結，對 Active Directory:  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A> 屬性設定為 <xref:System.Web.Security.ActiveDirectoryConnectionProtection.None>。  
  
-   <xref:System.Web.Security.ActiveDirectoryMembershipProvider.CurrentConnectionProtection%2A>屬性設定為<xref:System.Web.Security.ActiveDirectoryConnectionProtection.SignAndSeal>和 SSL 會選擇<xref:System.Web.Security.ActiveDirectoryMembershipProvider>保障連線安全的執行個體。  
  
 此外，可供並行的繫結，下列條件必須成立：  
  
-   目錄伺服器必須執行 Windows Server 2003 上。  
  
-   執行網頁伺服器的作業系統<xref:System.Web.Security.ActiveDirectoryMembershipProvider>執行個體必須支援並行的繫結 (例如，Windows Server 2003)。  
  
 當使用並行的繫結時，使用者的上次登入日期不會更新目錄中;因此，<xref:System.Web.Security.ActiveDirectoryMembershipUser.LastLoginDate%2A>屬性無法依賴。  
  
 開頭和尾端空白會刪減`username`參數。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">The <see cref="M:System.Web.Security.ActiveDirectoryMembershipProvider.ValidateUser(System.String,System.String)" /> method is called before the <see cref="T:System.Web.Security.ActiveDirectoryMembershipProvider" /> instance is initialized.</exception>
      </Docs>
    </Member>
  </Members>
</Type>