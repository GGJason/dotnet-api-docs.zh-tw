<Type Name="Roles" FullName="System.Web.Security.Roles">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="7294af485a090712d17ab407ed80a685c229f77c" />
    <Meta Name="ms.sourcegitcommit" Value="5a49536d99d2d0b54e4cb7280870903e043272df" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-TW" />
    <Meta Name="ms.lasthandoff" Value="07/03/2018" />
    <Meta Name="ms.locfileid" Value="37545015" />
  </Metadata>
  <TypeSignature Language="C#" Value="public static class Roles" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi abstract sealed beforefieldinit Roles extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Web.Security.Roles" />
  <TypeSignature Language="VB.NET" Value="Public Class Roles" />
  <TypeSignature Language="C++ CLI" Value="public ref class Roles abstract sealed" />
  <TypeSignature Language="F#" Value="type Roles = class" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="744d1-101">Manages user membership in roles for authorization checking in an ASP.NET application.</span>
      <span class="sxs-lookup">
        <span data-stu-id="744d1-101">Manages user membership in roles for authorization checking in an ASP.NET application.</span>
      </span>
      <span data-ttu-id="744d1-102">This class cannot be inherited.</span>
      <span class="sxs-lookup">
        <span data-stu-id="744d1-102">This class cannot be inherited.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-103">ASP.NET 角色管理可讓您管理使用者群組，稱為角色為基礎的應用程式授權。</span><span class="sxs-lookup"><span data-stu-id="744d1-103">ASP.NET role management enables you to manage authorization for your application based on groups of users, referred to as roles.</span></span> <span data-ttu-id="744d1-104">將使用者指派給角色，您可以控制不同的組件或功能，而不是或，角色為基礎的 Web 應用程式的存取權來指定使用者名稱為基礎的授權。</span><span class="sxs-lookup"><span data-stu-id="744d1-104">By assigning users to roles, you can control access to different parts or features of your Web application based on role instead of, or in addition to, specifying authorization based on user name.</span></span> <span data-ttu-id="744d1-105">例如，員工應用程式可能有角色，例如經理員工、 經理等等，其中每個角色指定不同的權限。</span><span class="sxs-lookup"><span data-stu-id="744d1-105">For example, an employee application might have roles such as Managers, Employees, Directors, and so on, where different privileges are specified for each role.</span></span>  
  
 <span data-ttu-id="744d1-106">使用者可以屬於一個以上的角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-106">Users can belong to more than one role.</span></span> <span data-ttu-id="744d1-107">例如，如果您的網站論壇，某些使用者可能是角色的成員和仲裁者。</span><span class="sxs-lookup"><span data-stu-id="744d1-107">For example, if your site is a discussion forum, some users might be in the role of both Members and Moderators.</span></span> <span data-ttu-id="744d1-108">您可以定義每個角色，才能在網站上，具有不同的權限，而這兩個角色的使用者會擁有兩組權限。</span><span class="sxs-lookup"><span data-stu-id="744d1-108">You might define each role to have different privileges on the site, and a user who is in both roles would then have both sets of privileges.</span></span>  
  
 <span data-ttu-id="744d1-109">若要啟用角色管理 ASP.NET 應用程式，使用的項目`system.web`在您的應用程式的 Web.config 檔案區段，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="744d1-109">To enable role management for your ASP.NET application, use the  element of the `system.web` section in the Web.config file for your application, as shown in the following example.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="SqlServices" connectionString="Data Source=localhost;Initial Catalog=aspnetdb;Integrated Security=SSPI;" />  
  </connectionStrings>  
  
  <system.web>  
    <authentication mode="Forms" >  
      <forms loginUrl="login.aspx"  
      name=".ASPXFORMSAUTH" />  
    </authentication>  
  
  <roleManager defaultProvider="SqlProvider"   
    enabled="true"  
    cacheRolesInCookie="true"  
    cookieName=".ASPROLES"  
    cookieTimeout="30"  
    cookiePath="/"  
    cookieRequireSSL="false"  
    cookieSlidingExpiration="true"  
    cookieProtection="All" >  
    <providers>  
      <add  
        name="SqlProvider"  
        type="System.Web.Security.SqlRoleProvider"  
        connectionStringName="SqlServices"  
        applicationName="SampleApplication" />  
      </providers>  
    </roleManager>  
  </system.web>  
</configuration>  
```  
  
 <span data-ttu-id="744d1-110">在您的 Web 應用程式的組態檔中或以程式設計方式在程式碼中，您可以指定授權規則。</span><span class="sxs-lookup"><span data-stu-id="744d1-110">You can specify authorization rules in the configuration file for your Web application or programmatically in your code.</span></span> <span data-ttu-id="744d1-111">比方說，Web.config 檔案中的下列區段需要使用者登入 （藉由拒絕匿名使用者），並接著只允許使用者在系統管理員角色具有存取權。</span><span class="sxs-lookup"><span data-stu-id="744d1-111">For example, the following  section from a Web.config file requires users to log on (by denying anonymous users), and then allows only users in the Administrators role to have access.</span></span>  
  
```  
<authorization>  
  <deny users="?" />  
  <allow roles="Administrators" />  
  <deny users="*" />  
</authorization>  
```  
  
 <span data-ttu-id="744d1-112">如果您使用`authorization`區段來指定角色，應用程式的使用者為基礎的授權的應用程式的 Web.config 檔案中必須提供已驗證的使用者身分識別。</span><span class="sxs-lookup"><span data-stu-id="744d1-112">If you use the `authorization` section in your application's Web.config file to specify authorization based on roles, users of your application must supply an authenticated user identity.</span></span> <span data-ttu-id="744d1-113">您可以使用 Windows 或表單驗證驗證使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-113">You can authenticate users by using either Windows or Forms authentication.</span></span> <span data-ttu-id="744d1-114">匿名使用者無法指派給角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-114">Anonymous users cannot be assigned to a role.</span></span> <span data-ttu-id="744d1-115">獨立的或與 ASP.NET 搭配使用，就可以使用角色<xref:System.Web.Security.Membership>類別。</span><span class="sxs-lookup"><span data-stu-id="744d1-115">Roles can be used independently of, or in conjunction with, the ASP.NET <xref:System.Web.Security.Membership> classes.</span></span>  
  
 <span data-ttu-id="744d1-116">若要以程式設計方式驗證角色成員資格，您可以使用<xref:System.Web.Security.Roles>類別或<xref:System.Web.UI.Page.User%2A?displayProperty=nameWithType>屬性<xref:System.Web.Security.Roles.IsUserInRole%2A>方法，或者您可以使用<xref:System.Web.UI.Page.User%2A?displayProperty=nameWithType>屬性與<xref:System.Security.Principal.IPrincipal.IsInRole%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="744d1-116">To verify role membership programmatically, you can use the <xref:System.Web.Security.Roles> class or the <xref:System.Web.UI.Page.User%2A?displayProperty=nameWithType> property with the <xref:System.Web.Security.Roles.IsUserInRole%2A> method, or you can use the <xref:System.Web.UI.Page.User%2A?displayProperty=nameWithType> property with the <xref:System.Security.Principal.IPrincipal.IsInRole%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="744d1-117">以程式設計方式檢查角色成員資格的範例程式碼，請參閱本主題中的範例 > 一節。</span><span class="sxs-lookup"><span data-stu-id="744d1-117">For sample code that programmatically checks role membership, see the Example section in this topic.</span></span>  
  
 <span data-ttu-id="744d1-118"><xref:System.Web.Security.Roles>類別也可讓您建立及刪除角色，以將使用者加入或移除角色的使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-118">The <xref:System.Web.Security.Roles> class also enables you to create and delete roles and to add users to or remove users from roles.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="744d1-119">如果您已設定您的應用程式使用<xref:System.Web.Security.WindowsTokenRoleProvider>類別，您不能修改角色或角色成員資格。</span><span class="sxs-lookup"><span data-stu-id="744d1-119">If you have configured your application to use the <xref:System.Web.Security.WindowsTokenRoleProvider> class, you cannot modify roles or role membership.</span></span> <span data-ttu-id="744d1-120"><xref:System.Web.Security.WindowsTokenRoleProvider> Classverifies Windows 中的成員資格只群組。</span><span class="sxs-lookup"><span data-stu-id="744d1-120">The <xref:System.Web.Security.WindowsTokenRoleProvider> classverifies membership in Windows security groups only.</span></span> <span data-ttu-id="744d1-121">在此情況下，您必須使用 Windows 使用者帳戶管理，而不是 ASP.NET 角色建立和刪除群組及管理群組成員資格。</span><span class="sxs-lookup"><span data-stu-id="744d1-121">In this case, you must use Windows user account management rather than ASP.NET roles to create and delete groups and manage group membership.</span></span>  
  
 <span data-ttu-id="744d1-122">您可以將角色資訊儲存在數個資料來源。</span><span class="sxs-lookup"><span data-stu-id="744d1-122">You can store role information in several data sources.</span></span>  
  
-   <span data-ttu-id="744d1-123">您可以使用<xref:System.Web.Security.WindowsTokenRoleProvider>擷取角色資訊的類別，根據 Windows 群組的成員資格。</span><span class="sxs-lookup"><span data-stu-id="744d1-123">You can use the <xref:System.Web.Security.WindowsTokenRoleProvider> class to retrieve role information based on membership in Windows groups.</span></span>  
  
-   <span data-ttu-id="744d1-124">您也可以使用 SQL Server 資料庫中儲存角色資訊<xref:System.Web.Security.SqlRoleProvider>類別。</span><span class="sxs-lookup"><span data-stu-id="744d1-124">You can store role information in a SQL Server database by using the <xref:System.Web.Security.SqlRoleProvider> class.</span></span>  
  
-   <span data-ttu-id="744d1-125">如果您有現有的角色資訊，或想要儲存中的角色資訊，並從 Windows、 授權存放區或 SQL Server 以外的資料來源擷取角色資訊時，您可以藉由建立繼承實作自訂角色提供者<xref:System.Web.Security.RoleProvider>抽象類別。</span><span class="sxs-lookup"><span data-stu-id="744d1-125">If you have existing role information, or want to store role information in and retrieve role information from a data source other than Windows, an Authorization Store, or SQL Server, you can implement a custom role provider by creating a class that inherits the <xref:System.Web.Security.RoleProvider> abstract class.</span></span> <span data-ttu-id="744d1-126">如需詳細資訊，請參閱 <<c0> [ 實作角色提供者](http://msdn.microsoft.com/library/851671ce-bf9b-43f2-aba4-bc9d28b11c7d)。</span><span class="sxs-lookup"><span data-stu-id="744d1-126">For more information, see [Implementing a Role Provider](http://msdn.microsoft.com/library/851671ce-bf9b-43f2-aba4-bc9d28b11c7d).</span></span>  
  
 <span data-ttu-id="744d1-127">如果使用者的瀏覽器接受 cookie，則您可以在使用者的電腦上的 cookie 中儲存該使用者的角色資訊。</span><span class="sxs-lookup"><span data-stu-id="744d1-127">If a user's browser accepts cookies, you can store role information for that user in a cookie on the user's computer.</span></span> <span data-ttu-id="744d1-128">每個頁面要求時，ASP.NET 會從 cookie 讀取該使用者的角色資訊。</span><span class="sxs-lookup"><span data-stu-id="744d1-128">On each page request, ASP.NET reads the role information for that user from the cookie.</span></span> <span data-ttu-id="744d1-129">這可以減少擷取角色資訊與資料來源所需的通訊，以改善應用程式的效能。</span><span class="sxs-lookup"><span data-stu-id="744d1-129">This can improve application performance by reducing the amount of communication required with the data source to retrieve role information.</span></span> <span data-ttu-id="744d1-130">如果使用者的角色資訊太長而無法儲存在 cookie 中，ASP.NET 會就最近使用的角色資訊儲存在 cookie 中，並接著會尋找所需的資料來源中的其他角色資訊。</span><span class="sxs-lookup"><span data-stu-id="744d1-130">If the role information for a user is too long to store in a cookie, ASP.NET stores just the most recently used role information in the cookie and then looks up additional role information in the data source as required.</span></span> <span data-ttu-id="744d1-131">如果使用者的瀏覽器不支援 cookie，或停用 cookie，角色資訊不會快取 cookie。</span><span class="sxs-lookup"><span data-stu-id="744d1-131">If the user's browser does not support cookies or cookies are disabled, role information is not cached in a cookie.</span></span>  
  
 <span data-ttu-id="744d1-132">您可以改善快取在 cookie 中，藉由指定的角色名稱的可靠性<xref:System.Web.Security.Roles.CookieProtectionValue%2A>屬性，當您設定 ASP.NET 角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-132">You can improve the reliability of the role names cached in a cookie by specifying a <xref:System.Web.Security.Roles.CookieProtectionValue%2A> property when you configure ASP.NET roles.</span></span> <span data-ttu-id="744d1-133">預設值<xref:System.Web.Security.Roles.CookieProtectionValue%2A>是`All`，它會加密 cookie 中的角色名稱，並驗證尚未改變的 cookie 內容。</span><span class="sxs-lookup"><span data-stu-id="744d1-133">The default <xref:System.Web.Security.Roles.CookieProtectionValue%2A> is `All`, which encrypts role names in the cookie and validates that the cookie contents have not been altered.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-134">下列範例示範設定為使用 ASP.NET 成員資格和 ASP.NET 角色，並使用應用程式的 Web.config 檔案<xref:System.Web.Security.SqlRoleProvider>來儲存 SQL Server 資料庫中的成員資格和角色的資訊。</span><span class="sxs-lookup"><span data-stu-id="744d1-134">The following example shows the Web.config file for an application configured to use both ASP.NET membership and ASP.NET roles and to use the <xref:System.Web.Security.SqlRoleProvider> to store membership and role information in a SQL Server database.</span></span> <span data-ttu-id="744d1-135">使用表單驗證驗證使用者，只有系統管理員角色的使用者，才允許存取應用程式。</span><span class="sxs-lookup"><span data-stu-id="744d1-135">Users are authenticated with forms authentication and only users in the Administrators role are allowed access to the application.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="SqlServices" connectionString="Data Source=localhost;Initial Catalog=aspnetdb;Integrated Security=SSPI;" />  
  </connectionStrings>  
  
  <system.web>  
    <authentication mode="Forms" >  
      <forms loginUrl="login.aspx"  
      name=".ASPXFORMSAUTH" />  
    </authentication>  
  
    <authorization>  
      <deny users="?" />  
      <allow roles="Administrators" />  
      <deny users="*" />  
    </authorization>  
  
    <membership defaultProvider="AspNetSqlProvider" userIsOnlineTimeWindow="15">  
    </membership>  
  
    <roleManager defaultProvider="SqlProvider"   
      enabled="true"  
      cacheRolesInCookie="true"  
      cookieName=".ASPROLES"  
      cookieTimeout="30"  
      cookiePath="/"  
      cookieRequireSSL="true"  
      cookieSlidingExpiration="true"  
      cookieProtection="All" >  
  
      <providers>  
        <clear />  
        <add  
          name="SqlProvider"  
          type="System.Web.Security.SqlRoleProvider"  
          connectionStringName="SqlServices"  
          applicationName="SampleApplication" />  
        </providers>  
  
    </roleManager>  
  </system.web>  
</configuration>  
```  
  
 <span data-ttu-id="744d1-136">下列程式碼範例以程式設計方式檢查登入的使用者是否在系統管理員角色中，然後才讓使用者能夠檢視其他使用者的角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-136">The following code example programmatically checks whether the logged-on user is in the Administrators role before allowing the user to view other users' roles.</span></span>  
  
  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName="AddUsersToRole">
      <MemberSignature Language="C#" Value="public static void AddUsersToRole (string[] usernames, string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void AddUsersToRole(string[] usernames, string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.AddUsersToRole(System.String[],System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub AddUsersToRole (usernames As String(), roleName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void AddUsersToRole(cli::array &lt;System::String ^&gt; ^ usernames, System::String ^ roleName);" />
      <MemberSignature Language="F#" Value="static member AddUsersToRole : string[] * string -&gt; unit" Usage="System.Web.Security.Roles.AddUsersToRole (usernames, roleName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernames" Type="System.String[]" />
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="usernames">
          <span data-ttu-id="744d1-137">A string array of user names to add to the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-137">A string array of user names to add to the specified role.</span>
          </span>
        </param>
        <param name="roleName">
          <span data-ttu-id="744d1-138">The role to add the specified user names to.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-138">The role to add the specified user names to.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-139">Adds the specified users to the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-139">Adds the specified users to the specified role.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-140"><xref:System.Web.Security.Roles.AddUsersToRole%2A>方法會呼叫指定的使用者與指定的角色，在資料來源建立關聯的預設角色提供者。</span><span class="sxs-lookup"><span data-stu-id="744d1-140">The <xref:System.Web.Security.Roles.AddUsersToRole%2A> method calls the default role provider to associate the specified users with the specified role at the data source.</span></span>  
  
 <span data-ttu-id="744d1-141">如果您的應用程式會使用<xref:System.Web.Security.SqlRoleProvider>類別，會在呼叫期間執行資料庫更新<xref:System.Web.Security.SqlRoleProvider.AddUsersToRoles%2A>方法會在交易內進行。</span><span class="sxs-lookup"><span data-stu-id="744d1-141">If your application uses the <xref:System.Web.Security.SqlRoleProvider> class, the database updates that are performed during the call to the <xref:System.Web.Security.SqlRoleProvider.AddUsersToRoles%2A> method are made within a transaction.</span></span> <span data-ttu-id="744d1-142">如果發生錯誤，例如使用者名稱已在指定的角色，會回復交易，並會執行任何更新。</span><span class="sxs-lookup"><span data-stu-id="744d1-142">If an error is encountered, such as a user name that is already in a specified role, the transaction is rolled back and no updates are performed.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="744d1-143">使用者名稱和角色名稱不能包含逗號。</span><span class="sxs-lookup"><span data-stu-id="744d1-143">User names and role names cannot contain commas.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-144">下列程式碼範例的角色中加入一個或多個使用者，或根據使用者輸入在角色中移除使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-144">The following code example adds one or more users to a role or removes a user from a role based on user input.</span></span> <span data-ttu-id="744d1-145">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-145">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/adduserstorolecs.aspx#3)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/adduserstorolevb.aspx#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-146">
            <paramref name="roleName" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-146">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="744d1-147">-or-  One of the elements in <paramref name="usernames" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-147">-or-  One of the elements in <paramref name="usernames" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-148">
            <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-148">
              <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-149">-or-  One of the elements in <paramref name="usernames" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-149">-or-  One of the elements in <paramref name="usernames" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-150">-or-  <paramref name="usernames" /> contains a duplicate element.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-150">-or-  <paramref name="usernames" /> contains a duplicate element.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-151">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-151">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="AddUsersToRoles">
      <MemberSignature Language="C#" Value="public static void AddUsersToRoles (string[] usernames, string[] roleNames);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void AddUsersToRoles(string[] usernames, string[] roleNames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.AddUsersToRoles(System.String[],System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub AddUsersToRoles (usernames As String(), roleNames As String())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void AddUsersToRoles(cli::array &lt;System::String ^&gt; ^ usernames, cli::array &lt;System::String ^&gt; ^ roleNames);" />
      <MemberSignature Language="F#" Value="static member AddUsersToRoles : string[] * string[] -&gt; unit" Usage="System.Web.Security.Roles.AddUsersToRoles (usernames, roleNames)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernames" Type="System.String[]" />
        <Parameter Name="roleNames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="usernames">
          <span data-ttu-id="744d1-152">A string array of user names to add to the specified roles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-152">A string array of user names to add to the specified roles.</span>
          </span>
        </param>
        <param name="roleNames">
          <span data-ttu-id="744d1-153">A string array of role names to add the specified user names to.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-153">A string array of role names to add the specified user names to.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-154">Adds the specified users to the specified roles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-154">Adds the specified users to the specified roles.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-155"><xref:System.Web.Security.Roles.AddUsersToRoles%2A>方法會呼叫指定的使用者與指定的角色，在資料來源建立關聯的預設角色提供者。</span><span class="sxs-lookup"><span data-stu-id="744d1-155">The <xref:System.Web.Security.Roles.AddUsersToRoles%2A> method calls the default role provider to associate the specified users with the specified roles at the data source.</span></span>  
  
 <span data-ttu-id="744d1-156">如果您的應用程式會使用<xref:System.Web.Security.SqlRoleProvider>類別，會在呼叫期間執行資料庫更新<xref:System.Web.Security.SqlRoleProvider.AddUsersToRoles%2A>方法會在交易內進行。</span><span class="sxs-lookup"><span data-stu-id="744d1-156">If your application uses the <xref:System.Web.Security.SqlRoleProvider> class, the database updates that are performed during the call to the <xref:System.Web.Security.SqlRoleProvider.AddUsersToRoles%2A> method are made within a transaction.</span></span> <span data-ttu-id="744d1-157">如果發生錯誤，例如使用者名稱已在指定的角色，會回復交易，並會執行任何更新。</span><span class="sxs-lookup"><span data-stu-id="744d1-157">If an error is encountered, such as a user name that is already in a specified role, the transaction is rolled back and no updates are performed.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="744d1-158">使用者名稱和角色名稱不能包含逗號。</span><span class="sxs-lookup"><span data-stu-id="744d1-158">User names and role names cannot contain commas.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-159">下列程式碼範例會將一個或多個角色中的一個或多個使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-159">The following code example adds one or more users to one or more roles.</span></span> <span data-ttu-id="744d1-160">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-160">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/adduserstorolescs.aspx#1)]
 [!code-aspx-vb[System.Web.Security.Roles#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/adduserstorolesvb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-161">One of the roles in <paramref name="roleNames" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-161">One of the roles in <paramref name="roleNames" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="744d1-162">-or-  One of the users in <paramref name="usernames" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-162">-or-  One of the users in <paramref name="usernames" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-163">One of the roles in <paramref name="roleNames" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-163">One of the roles in <paramref name="roleNames" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-164">-or-  One of the users in <paramref name="usernames" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-164">-or-  One of the users in <paramref name="usernames" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-165">-or-  <paramref name="roleNames" /> contains a duplicate element.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-165">-or-  <paramref name="roleNames" /> contains a duplicate element.</span>
          </span>
          <span data-ttu-id="744d1-166">-or-  <paramref name="usernames" /> contains a duplicate element.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-166">-or-  <paramref name="usernames" /> contains a duplicate element.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-167">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-167">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="AddUserToRole">
      <MemberSignature Language="C#" Value="public static void AddUserToRole (string username, string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void AddUserToRole(string username, string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.AddUserToRole(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub AddUserToRole (username As String, roleName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void AddUserToRole(System::String ^ username, System::String ^ roleName);" />
      <MemberSignature Language="F#" Value="static member AddUserToRole : string * string -&gt; unit" Usage="System.Web.Security.Roles.AddUserToRole (username, roleName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">
          <span data-ttu-id="744d1-168">The user name to add to the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-168">The user name to add to the specified role.</span>
          </span>
        </param>
        <param name="roleName">
          <span data-ttu-id="744d1-169">The role to add the specified user name to.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-169">The role to add the specified user name to.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-170">Adds the specified user to the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-170">Adds the specified user to the specified role.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-171"><xref:System.Web.Security.Roles.AddUserToRole%2A>方法會呼叫指定的使用者相關聯的資料來源的指定角色的預設角色提供者。</span><span class="sxs-lookup"><span data-stu-id="744d1-171">The <xref:System.Web.Security.Roles.AddUserToRole%2A> method calls the default role provider to associate the specified user with the specified role at the data source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="744d1-172">使用者名稱和角色名稱不能包含逗號。</span><span class="sxs-lookup"><span data-stu-id="744d1-172">User names and role names cannot contain commas.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-173">下列程式碼範例會將使用者加入至角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-173">The following code example adds a user to a role.</span></span> <span data-ttu-id="744d1-174">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-174">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/addusertorolecs.aspx#2)]
 [!code-aspx-vb[System.Web.Security.Roles#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/addusertorolevb.aspx#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-175">
            <paramref name="roleName" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-175">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="744d1-176">-or-  <paramref name="username" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-176">-or-  <paramref name="username" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-177">
            <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-177">
              <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-178">-or-  <paramref name="username" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-178">-or-  <paramref name="username" /> is an empty string or contains a comma (,).</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-179">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-179">Role management is not enabled.</span>
          </span>
          <span data-ttu-id="744d1-180">-or-  User is already assigned to the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-180">-or-  User is already assigned to the specified role.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="AddUserToRoles">
      <MemberSignature Language="C#" Value="public static void AddUserToRoles (string username, string[] roleNames);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void AddUserToRoles(string username, string[] roleNames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.AddUserToRoles(System.String,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub AddUserToRoles (username As String, roleNames As String())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void AddUserToRoles(System::String ^ username, cli::array &lt;System::String ^&gt; ^ roleNames);" />
      <MemberSignature Language="F#" Value="static member AddUserToRoles : string * string[] -&gt; unit" Usage="System.Web.Security.Roles.AddUserToRoles (username, roleNames)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="roleNames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="username">
          <span data-ttu-id="744d1-181">The user name to add to the specified roles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-181">The user name to add to the specified roles.</span>
          </span>
        </param>
        <param name="roleNames">
          <span data-ttu-id="744d1-182">A string array of roles to add the specified user name to.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-182">A string array of roles to add the specified user name to.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-183">Adds the specified user to the specified roles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-183">Adds the specified user to the specified roles.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-184"><xref:System.Web.Security.Roles.AddUserToRoles%2A>方法會呼叫指定的使用者相關聯資料來源的指定角色的預設角色提供者。</span><span class="sxs-lookup"><span data-stu-id="744d1-184">The <xref:System.Web.Security.Roles.AddUserToRoles%2A> method calls the default role provider to associate the specified user with the specified roles at the data source.</span></span>  
  
 <span data-ttu-id="744d1-185">如果您的應用程式會使用<xref:System.Web.Security.SqlRoleProvider>類別，會在呼叫期間執行資料庫更新<xref:System.Web.Security.Roles.AddUserToRoles%2A>方法會在交易內進行。</span><span class="sxs-lookup"><span data-stu-id="744d1-185">If your application uses the <xref:System.Web.Security.SqlRoleProvider> class, the database updates that are performed during the call to the <xref:System.Web.Security.Roles.AddUserToRoles%2A> method are made within a transaction.</span></span> <span data-ttu-id="744d1-186">如果發生錯誤，例如使用者名稱已在指定的角色，會回復交易，並會執行任何更新。</span><span class="sxs-lookup"><span data-stu-id="744d1-186">If an error is encountered, such as a user name that is already in a specified role, the transaction is rolled back and no updates are performed.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="744d1-187">使用者名稱和角色名稱不能包含逗號。</span><span class="sxs-lookup"><span data-stu-id="744d1-187">User names and role names cannot contain commas.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-188">下列程式碼範例會將一個或多個角色中的使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-188">The following code example adds a user to one or more roles.</span></span> <span data-ttu-id="744d1-189">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-189">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/addusertorolescs.aspx#3)]
 [!code-aspx-vb[System.Web.Security.Roles#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/addusertorolesvb.aspx#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-190">One of the roles in <paramref name="roleNames" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-190">One of the roles in <paramref name="roleNames" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="744d1-191">-or-  <paramref name="username" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-191">-or-  <paramref name="username" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-192">One of the roles in <paramref name="roleNames" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-192">One of the roles in <paramref name="roleNames" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-193">-or-  <paramref name="username" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-193">-or-  <paramref name="username" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-194">-or-  <paramref name="roleNames" /> contains a duplicate element.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-194">-or-  <paramref name="roleNames" /> contains a duplicate element.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-195">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-195">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public static string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.Security.Roles.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-196">Gets or sets the name of the application to store and retrieve role information for.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-196">Gets or sets the name of the application to store and retrieve role information for.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-197">要儲存和擷取角色資訊的應用程式名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-197">The name of the application to store and retrieve role information for.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-198"><xref:System.Web.Security.Roles.ApplicationName%2A>屬性由<xref:System.Web.Security.Roles>類別不同的應用程式相關聯的使用者和角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-198">The <xref:System.Web.Security.Roles.ApplicationName%2A> property is used by the <xref:System.Web.Security.Roles> class to associate users and roles with different applications.</span></span> <span data-ttu-id="744d1-199">這可讓多個應用程式使用相同的資料來源來儲存使用者和角色資訊，而不重複的使用者名稱或重複的角色名稱之間發生衝突。</span><span class="sxs-lookup"><span data-stu-id="744d1-199">This enables multiple applications to use the same data source to store user and role information without running into conflicts between duplicate user names or duplicate role names.</span></span> <span data-ttu-id="744d1-200">多個 ASP.NET 應用程式可以藉由指定相同的值中使用相同的資料來源<xref:System.Web.Security.Roles.ApplicationName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-200">Multiple ASP.NET applications can use the same data source by specifying the same value in the <xref:System.Web.Security.Roles.ApplicationName%2A> property.</span></span> <span data-ttu-id="744d1-201">您可以設定<xref:System.Web.Security.Roles.ApplicationName%2A>屬性以程式設計的方式，或者您可以設定它以宣告方式在 Web 應用程式的組態檔中使用`applicationName`屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-201">You can set the <xref:System.Web.Security.Roles.ApplicationName%2A> property programmatically, or you can set it declaratively in the configuration file for the Web application by using the `applicationName` attribute.</span></span>  
  
 <span data-ttu-id="744d1-202">如果您的 Web 應用程式使用<xref:System.Web.Security.SqlRoleProvider>類別和值未指定`applicationName`組態檔中的屬性<xref:System.Web.HttpRequest.ApplicationPath%2A?displayProperty=nameWithType>目前的屬性值<xref:System.Web.HttpContext.Request%2A?displayProperty=nameWithType>屬性用。</span><span class="sxs-lookup"><span data-stu-id="744d1-202">If your Web application is using the <xref:System.Web.Security.SqlRoleProvider> class and a value is not specified for the `applicationName` attribute in the configuration file, the <xref:System.Web.HttpRequest.ApplicationPath%2A?displayProperty=nameWithType> property value for the current <xref:System.Web.HttpContext.Request%2A?displayProperty=nameWithType> property is used.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="744d1-203">因為單一的預設角色提供者執行個體用來提供所要求的所有<xref:System.Web.HttpApplication>物件，您可以有多個要求同時執行，而且嘗試設定<xref:System.Web.Security.Roles.ApplicationName%2A>屬性值。</span><span class="sxs-lookup"><span data-stu-id="744d1-203">Because a single default role provider instance is used for all of the requests served by an <xref:System.Web.HttpApplication> object, you can have multiple requests executing concurrently and attempting to set the <xref:System.Web.Security.Roles.ApplicationName%2A> property value.</span></span> <span data-ttu-id="744d1-204"><xref:System.Web.Security.Roles.ApplicationName%2A>屬性不是執行緒安全的多個寫入與變更<xref:System.Web.Security.Roles.ApplicationName%2A>屬性值可能會導致非預期的行為，應用程式的多個使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-204">The <xref:System.Web.Security.Roles.ApplicationName%2A> property is not thread safe for multiple writes, and changing the <xref:System.Web.Security.Roles.ApplicationName%2A> property value can result in unexpected behavior for multiple users of an application.</span></span> <span data-ttu-id="744d1-205">您應該避免撰寫程式碼，以讓使用者能夠設定<xref:System.Web.Security.Roles.ApplicationName%2A>屬性，除非另有需要。</span><span class="sxs-lookup"><span data-stu-id="744d1-205">You should avoid writing code to allow users to set the <xref:System.Web.Security.Roles.ApplicationName%2A> property, unless required.</span></span> <span data-ttu-id="744d1-206">應用程式的範例設定<xref:System.Web.Security.Roles.ApplicationName%2A>屬性可能需要管理多個應用程式的角色資料的系統管理應用程式。</span><span class="sxs-lookup"><span data-stu-id="744d1-206">An example of an application where setting the <xref:System.Web.Security.Roles.ApplicationName%2A> property may be required is an administrative application that manages role data for multiple applications.</span></span> <span data-ttu-id="744d1-207">這類應用程式應該是單一使用者應用程式並不是 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="744d1-207">Such an application should be a single-user application and not a Web application.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-208">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="744d1-208">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="744d1-209">它會指定應用程式會使用<xref:System.Web.Security.SqlRoleProvider>執行個體和集合`applicationName`屬性設定為`MyApplication`。</span><span class="sxs-lookup"><span data-stu-id="744d1-209">It specifies that the application uses a <xref:System.Web.Security.SqlRoleProvider> instance and sets the `applicationName` attribute to `MyApplication`.</span></span>  
  
```  
<roleManager defaultProvider="SqlProvider"   
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/"  
  cookieRequireSSL="false"  
  cookieSlidingExpiration="true"  
  cookieProtection="All" >  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.SqlRoleProvider"  
      connectionStringName="SqlServices"  
      applicationName="MyApplication" />  
  </providers>  
</roleManager>  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CacheRolesInCookie">
      <MemberSignature Language="C#" Value="public static bool CacheRolesInCookie { get; }" />
      <MemberSignature Language="ILAsm" Value=".property bool CacheRolesInCookie" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.CacheRolesInCookie" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property CacheRolesInCookie As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool CacheRolesInCookie { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CacheRolesInCookie : bool" Usage="System.Web.Security.Roles.CacheRolesInCookie" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-210">Gets a value indicating whether the current user's roles are cached in a cookie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-210">Gets a value indicating whether the current user's roles are cached in a cookie.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-211">
            <see langword="true" /> 如果目前使用者的角色會快取在 cookie 中，，否則， <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-211">
              <see langword="true" /> if the current user's roles are cached in a cookie; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="744d1-212">預設值為 <see langword="true" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-212">The default is <see langword="true" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-213">當<xref:System.Web.Security.Roles.CacheRolesInCookie%2A>屬性設定為`true`在 Web.config 檔案中，每個使用者的角色資訊會儲存在 cookie 中。</span><span class="sxs-lookup"><span data-stu-id="744d1-213">When the <xref:System.Web.Security.Roles.CacheRolesInCookie%2A> property is set to `true` in the Web.config file, role information for each user is stored in a cookie.</span></span> <span data-ttu-id="744d1-214">當角色管理會檢查使用者是否具有特定角色時，角色提供者會檢查資料來源的角色清單在呼叫之前檢查角色 cookie。</span><span class="sxs-lookup"><span data-stu-id="744d1-214">When role management checks to see whether a user is in a particular role, the roles cookie is checked before the role provider is called to check the list of roles at the data source.</span></span> <span data-ttu-id="744d1-215">Cookie 會動態更新快取最近驗證過的角色名稱。</span><span class="sxs-lookup"><span data-stu-id="744d1-215">The cookie is dynamically updated to cache the most recently validated role names.</span></span>  
  
 <span data-ttu-id="744d1-216">您可以改善快取在 cookie 中，藉由指定的角色名稱的可靠性<xref:System.Web.Security.Roles.CookieProtectionValue%2A>屬性，當您設定 ASP.NET 角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-216">You can improve the reliability of the role names cached in a cookie by specifying a <xref:System.Web.Security.Roles.CookieProtectionValue%2A> property when you configure ASP.NET roles.</span></span> <span data-ttu-id="744d1-217">預設值<xref:System.Web.Security.Roles.CookieProtectionValue%2A>是`All`，它會加密 cookie 中的角色名稱，並驗證尚未改變的 cookie 內容。</span><span class="sxs-lookup"><span data-stu-id="744d1-217">The default <xref:System.Web.Security.Roles.CookieProtectionValue%2A> is `All`, which encrypts role names in the cookie and validates that the cookie contents have not been altered.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="744d1-218">因為除了資料來源，可以在快取角色名稱，就可以變更在資料來源的角色管理不會反映在快取的值。</span><span class="sxs-lookup"><span data-stu-id="744d1-218">Because role names can be cached apart from the data source, it is possible that changes to role management at the data source would not be reflected in the cached values.</span></span> <span data-ttu-id="744d1-219">在此情況下，使用者必須關閉再重新開啟其瀏覽器，以清除快取的 cookie 值。</span><span class="sxs-lookup"><span data-stu-id="744d1-219">In this case, the user must close and re-open their browser to clear the cached cookie value.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-220">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="744d1-220">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="744d1-221">它會指定應用程式會使用<xref:System.Web.Security.SqlRoleProvider>執行個體和集合`cacheRolesInCookie`屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="744d1-221">It specifies that the application uses a <xref:System.Web.Security.SqlRoleProvider> instance and sets the `cacheRolesInCookie` attribute to `true`.</span></span>  
  
```  
<roleManager defaultProvider="SqlProvider"   
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/"  
  cookieRequireSSL="false"  
  cookieSlidingExpiration="true"  
  cookieProtection="All" >  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.SqlRoleProvider"  
      connectionStringName="SqlServices"  
      applicationName="MyApplication" />  
   </providers>  
</roleManager>  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CookieName">
      <MemberSignature Language="C#" Value="public static string CookieName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property string CookieName" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.CookieName" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property CookieName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::String ^ CookieName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.CookieName : string" Usage="System.Web.Security.Roles.CookieName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-222">Gets the name of the cookie where role names are cached.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-222">Gets the name of the cookie where role names are cached.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-223">快取角色名稱之 Cookie 的名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-223">The name of the cookie where role names are cached.</span>
          </span>
          <span data-ttu-id="744d1-224">預設值為 .ASPXROLES。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-224">The default is .ASPXROLES.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-225">您也可以設定您的應用程式指定的 cookie 會在快取角色名稱`cookieName`ASP.NET 應用程式的 Web.config 檔案中的屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-225">You can specify the name of the cookie where roles are cached for your application by setting the `cookieName` attribute in the Web.config file for your ASP.NET application.</span></span> <span data-ttu-id="744d1-226">當您想要唯一識別您的應用程式的 cookie 或 cookie 會在多個應用程式，例如網域 cookie 之間共用，這非常有用。</span><span class="sxs-lookup"><span data-stu-id="744d1-226">This is useful when you want to uniquely identify a cookie for your application or when a cookie is shared across multiple applications, such as a domain cookie.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-227">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="744d1-227">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="744d1-228">它會指定應用程式會使用<xref:System.Web.Security.SqlRoleProvider>執行個體和設定`cookieName`屬性。ASPROLES。</span><span class="sxs-lookup"><span data-stu-id="744d1-228">It specifies that the application uses a <xref:System.Web.Security.SqlRoleProvider> instance and sets the `cookieName` attribute to .ASPROLES.</span></span>  
  
```  
<roleManager defaultProvider="SqlProvider"   
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/"  
  cookieRequireSSL="false"  
  cookieSlidingExpiration="true"  
  cookieProtection="All" >  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.SqlRoleProvider"  
      connectionStringName="SqlServices"  
      applicationName="MyApplication" />  
  </providers>  
</roleManager>  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CookiePath">
      <MemberSignature Language="C#" Value="public static string CookiePath { get; }" />
      <MemberSignature Language="ILAsm" Value=".property string CookiePath" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.CookiePath" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property CookiePath As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::String ^ CookiePath { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.CookiePath : string" Usage="System.Web.Security.Roles.CookiePath" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-229">Gets the path for the cached role names cookie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-229">Gets the path for the cached role names cookie.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-230">快取角色名稱之 Cookie 的路徑。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-230">The path of the cookie where role names are cached.</span>
          </span>
          <span data-ttu-id="744d1-231">預設為 /。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-231">The default is /.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-232">您也可以設定您的應用程式指定會在快取角色 cookie 的路徑`cookiePath`ASP.NET 應用程式的 Web.config 檔案中的屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-232">You can specify the path of the cookie where roles are cached for your application by setting the `cookiePath` attribute in the Web.config file for your ASP.NET application.</span></span> <span data-ttu-id="744d1-233">如需有關 cookie 路徑的詳細資訊，請參閱<xref:System.Web.HttpCookie.Path%2A>。</span><span class="sxs-lookup"><span data-stu-id="744d1-233">For more information on cookie paths, see <xref:System.Web.HttpCookie.Path%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-234">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="744d1-234">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="744d1-235">它會指定應用程式會使用<xref:System.Web.Security.SqlRoleProvider>執行個體和設定`cookiePath`/MyApplication 此屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-235">It specifies that the application uses a <xref:System.Web.Security.SqlRoleProvider> instance and sets the `cookiePath` attribute to /MyApplication.</span></span>  
  
```  
<roleManager defaultProvider="SqlProvider"   
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/MyApplication"  
  cookieRequireSSL="false"  
  cookieSlidingExpiration="true"  
  cookieProtection="All" >  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.SqlRoleProvider"  
      connectionStringName="SqlServices"  
      applicationName="MyApplication" />  
  </providers>  
</roleManager>  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CookieProtectionValue">
      <MemberSignature Language="C#" Value="public static System.Web.Security.CookieProtection CookieProtectionValue { get; }" />
      <MemberSignature Language="ILAsm" Value=".property valuetype System.Web.Security.CookieProtection CookieProtectionValue" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.CookieProtectionValue" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property CookieProtectionValue As CookieProtection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Web::Security::CookieProtection CookieProtectionValue { System::Web::Security::CookieProtection get(); };" />
      <MemberSignature Language="F#" Value="member this.CookieProtectionValue : System.Web.Security.CookieProtection" Usage="System.Web.Security.Roles.CookieProtectionValue" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.CookieProtection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-236">Gets a value that indicates how role names cached in a cookie are protected.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-236">Gets a value that indicates how role names cached in a cookie are protected.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-237">其中一個<see cref="T:System.Web.Security.CookieProtection" />列舉值，表示如何保護在 cookie 中快取的角色名稱。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-237">One of the <see cref="T:System.Web.Security.CookieProtection" /> enumeration values indicating how role names that are cached in a cookie are protected.</span>
          </span>
          <span data-ttu-id="744d1-238">預設值為 <see langword="All" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-238">The default is <see langword="All" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-239">您也可以設定您的應用程式指定的 cookie 會在快取角色保護`cookieProtection`ASP.NET 應用程式的 Web.config 檔案中的屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-239">You can specify the protection of the cookie where roles are cached for your application by setting the `cookieProtection` attribute in the Web.config file for your ASP.NET application.</span></span> <span data-ttu-id="744d1-240">`cookieProtection`屬性採用<xref:System.Web.Security.CookieProtection>列舉值，指出是否已加密的角色名稱，驗證，兩者皆非。</span><span class="sxs-lookup"><span data-stu-id="744d1-240">The `cookieProtection` attribute takes a <xref:System.Web.Security.CookieProtection> enumeration value that indicates whether the role names are encrypted, validated, both, or neither.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-241">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="744d1-241">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="744d1-242">它會指定應用程式會使用<xref:System.Web.Security.SqlRoleProvider>執行個體和集合`cookieProtection`屬性設定為`Encrypted`。</span><span class="sxs-lookup"><span data-stu-id="744d1-242">It specifies that the application uses a <xref:System.Web.Security.SqlRoleProvider> instance and sets `cookieProtection` attribute to `Encrypted`.</span></span>  
  
```  
<roleManager defaultProvider="SqlProvider"   
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/MyApplication"  
  cookieRequireSSL="false"  
  cookieSlidingExpiration="true"  
  cookieProtection="Encrypted" >  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.SqlRoleProvider"  
      connectionStringName="SqlServices"  
      applicationName="MyApplication" />  
  </providers>  
</roleManager>  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CookieRequireSSL">
      <MemberSignature Language="C#" Value="public static bool CookieRequireSSL { get; }" />
      <MemberSignature Language="ILAsm" Value=".property bool CookieRequireSSL" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.CookieRequireSSL" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property CookieRequireSSL As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool CookieRequireSSL { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CookieRequireSSL : bool" Usage="System.Web.Security.Roles.CookieRequireSSL" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-243">Gets a value indicating whether the role names cookie requires SSL in order to be returned to the server.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-243">Gets a value indicating whether the role names cookie requires SSL in order to be returned to the server.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-244">
            <see langword="true" /> 如果需要將角色名稱 cookie 傳回給伺服器使用 SSL否則， <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-244">
              <see langword="true" /> if SSL is required to return the role names cookie to the server; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="744d1-245">預設值為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-245">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-246">您可以指定是否需要 SSL （安全通訊端層） 角色名稱 cookie 傳回至您的應用程式中的伺服器設定`cookieRequireSSL`ASP.NET 應用程式的 Web.config 檔案中的屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-246">You can specify whether SSL (Secure Sockets Layer) is required to return the role names cookie to the server in your application by setting the `cookieRequireSSL` attribute in the Web.config file for your ASP.NET application.</span></span> <span data-ttu-id="744d1-247">如需詳細資訊，請參閱<xref:System.Web.HttpCookie.Secure%2A>。</span><span class="sxs-lookup"><span data-stu-id="744d1-247">For more information, see <xref:System.Web.HttpCookie.Secure%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-248">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="744d1-248">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="744d1-249">它會指定應用程式會使用<xref:System.Web.Security.SqlRoleProvider>執行個體和集合`cookieRequireSSL`至`true`。</span><span class="sxs-lookup"><span data-stu-id="744d1-249">It specifies that the application uses a <xref:System.Web.Security.SqlRoleProvider> instance and sets `cookieRequireSSL` to `true`.</span></span>  
  
```  
<roleManager defaultProvider="SqlProvider"   
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/MyApplication"  
  cookieRequireSSL="true"  
  cookieSlidingExpiration="true"  
  cookieProtection="Encrypted" >  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.SqlRoleProvider"  
      connectionStringName="SqlServices"  
      applicationName="MyApplication" />  
  </providers>  
</roleManager>  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CookieSlidingExpiration">
      <MemberSignature Language="C#" Value="public static bool CookieSlidingExpiration { get; }" />
      <MemberSignature Language="ILAsm" Value=".property bool CookieSlidingExpiration" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.CookieSlidingExpiration" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property CookieSlidingExpiration As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool CookieSlidingExpiration { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CookieSlidingExpiration : bool" Usage="System.Web.Security.Roles.CookieSlidingExpiration" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-250">Indicates whether the role names cookie expiration date and time will be reset periodically.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-250">Indicates whether the role names cookie expiration date and time will be reset periodically.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-251">
            <see langword="true" /> 如果角色名稱 cookie 的到期日和時間會定期重設;否則， <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-251">
              <see langword="true" /> if the role names cookie expiration date and time will be reset periodically; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="744d1-252">預設值為 <see langword="true" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-252">The default is <see langword="true" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-253">您可以指定是否角色名稱 cookie 的到期日和時間將會重設與每個回應使用`cookieSlidingExpiration`ASP.NET 應用程式的 Web.config 檔案中的屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-253">You can specify whether role names cookie expiration date and time will be reset with each response by using the `cookieSlidingExpiration` attribute in the Web.config file for your ASP.NET application.</span></span> <span data-ttu-id="744d1-254">如果`true`，cookie 到期日一開始會設定為目前的日期和時間加上<xref:System.Web.Security.Roles.CookieTimeout%2A>以分鐘為單位。</span><span class="sxs-lookup"><span data-stu-id="744d1-254">If `true`, the cookie expiration will initially be set to the current date and time plus the <xref:System.Web.Security.Roles.CookieTimeout%2A> in minutes.</span></span> <span data-ttu-id="744d1-255">當使用者繼續積極地使用 ASP.NET 應用程式時的到期日期和時間的 cookie 會自動重新整理如果小於一半的<xref:System.Web.Security.Roles.CookieTimeout%2A>剩餘。</span><span class="sxs-lookup"><span data-stu-id="744d1-255">While the user continues to actively use the ASP.NET application, the expiration date and time of the cookie will be automatically refreshed if there is less than half of the <xref:System.Web.Security.Roles.CookieTimeout%2A> remaining.</span></span> <span data-ttu-id="744d1-256">如需詳細資訊，請參閱 <xref:System.Web.HttpCookie.Expires%2A> 屬性 (Property)。</span><span class="sxs-lookup"><span data-stu-id="744d1-256">For more information, see the <xref:System.Web.HttpCookie.Expires%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-257">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="744d1-257">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="744d1-258">它會指定應用程式會使用<xref:System.Web.Security.SqlRoleProvider>執行個體和集合<xref:System.Web.Security.Roles.CookieSlidingExpiration%2A>屬性設`false`。</span><span class="sxs-lookup"><span data-stu-id="744d1-258">It specifies that the application uses a <xref:System.Web.Security.SqlRoleProvider> instance and sets the <xref:System.Web.Security.Roles.CookieSlidingExpiration%2A> property to `false`.</span></span>  
  
```  
<roleManager defaultProvider="SqlProvider"   
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/MyApplication"  
  cookieRequireSSL="true"  
  cookieSlidingExpiration="false"  
  cookieProtection="Encrypted" >  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.SqlRoleProvider"  
      connectionStringName="SqlServices"  
      applicationName="MyApplication" />  
  </providers>  
</roleManager>  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CookieTimeout">
      <MemberSignature Language="C#" Value="public static int CookieTimeout { get; }" />
      <MemberSignature Language="ILAsm" Value=".property int32 CookieTimeout" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.CookieTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property CookieTimeout As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property int CookieTimeout { int get(); };" />
      <MemberSignature Language="F#" Value="member this.CookieTimeout : int" Usage="System.Web.Security.Roles.CookieTimeout" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-259">Gets the number of minutes before the roles cookie expires.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-259">Gets the number of minutes before the roles cookie expires.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-260">指定角色 Cookie 過期前分鐘數的整數。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-260">An integer specifying the number of minutes before the roles cookie expires.</span>
          </span>
          <span data-ttu-id="744d1-261">預設值是 30 分鐘。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-261">The default is 30 minutes.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-262"><xref:System.Web.Security.Roles.CookieTimeout%2A>屬性使用時<xref:System.Web.Security.Roles.CookieSlidingExpiration%2A>屬性是`true`，並指定以分鐘為單位的角色 cookie 的-存留時間。</span><span class="sxs-lookup"><span data-stu-id="744d1-262">The <xref:System.Web.Security.Roles.CookieTimeout%2A> property is used when the <xref:System.Web.Security.Roles.CookieSlidingExpiration%2A> property is `true` and specifies the time-to-live in minutes for the roles cookie.</span></span> <span data-ttu-id="744d1-263">若要設定<xref:System.Web.Security.Roles.CookieTimeout%2A>值，請新增`cookieTimeout`ASP.NET 應用程式的 Web.config 檔案中的項目屬性，並指定整數值。</span><span class="sxs-lookup"><span data-stu-id="744d1-263">To set the <xref:System.Web.Security.Roles.CookieTimeout%2A> value, add the `cookieTimeout` attribute to the  element in the Web.config file for the ASP.NET application and specify an integer value.</span></span>  
  
 <span data-ttu-id="744d1-264">如果<xref:System.Web.Security.Roles.CookieSlidingExpiration%2A>是`false`，會忽略這個屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-264">If <xref:System.Web.Security.Roles.CookieSlidingExpiration%2A> is `false`, this property is ignored.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-265">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="744d1-265">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="744d1-266">它會指定應用程式會使用<xref:System.Web.Security.SqlRoleProvider>執行個體和設定<xref:System.Web.Security.Roles.CookieTimeout%2A>屬性設為 30 分鐘。</span><span class="sxs-lookup"><span data-stu-id="744d1-266">It specifies that the application uses a <xref:System.Web.Security.SqlRoleProvider> instance and sets the <xref:System.Web.Security.Roles.CookieTimeout%2A> property to 30 minutes.</span></span>  
  
```  
<roleManager defaultProvider="SqlProvider"   
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/MyApplication"  
  cookieRequireSSL="true"  
  cookieSlidingExpiration="true"  
  cookieProtection="Encrypted" >  
  <providers>  
  <add  
    name="SqlProvider"  
    type="System.Web.Security.SqlRoleProvider"  
    connectionStringName="SqlServices"  
    applicationName="MyApplication" />  
  </providers>  
</roleManager>  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CreatePersistentCookie">
      <MemberSignature Language="C#" Value="public static bool CreatePersistentCookie { get; }" />
      <MemberSignature Language="ILAsm" Value=".property bool CreatePersistentCookie" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.CreatePersistentCookie" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property CreatePersistentCookie As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool CreatePersistentCookie { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CreatePersistentCookie : bool" Usage="System.Web.Security.Roles.CreatePersistentCookie" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-267">Gets a value indicating whether the role-names cookie is session-based or persistent.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-267">Gets a value indicating whether the role-names cookie is session-based or persistent.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-268">
            <see langword="true" /> 如果角色名稱 cookie 是永續性 cookie;否則<see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-268">
              <see langword="true" /> if the role-names cookie is a persistent cookie; otherwise <see langword="false" />.</span>
          </span>
          <span data-ttu-id="744d1-269">預設值為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-269">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-270"><xref:System.Web.Security.Roles.CreatePersistentCookie%2A>屬性值會設定 ASP.NET 應用程式使用的組態中`createPersistentCookie`組態項目的屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-270">The <xref:System.Web.Security.Roles.CreatePersistentCookie%2A> property value is set in the configuration for an ASP.NET application using the `createPersistentCookie` attribute of the  configuration element.</span></span>  
  
 <span data-ttu-id="744d1-271">當`false`角色名稱 cookie 是工作階段 cookie，也就是 cookie 不會遺失瀏覽器關閉時。</span><span class="sxs-lookup"><span data-stu-id="744d1-271">When `false`, the role-names cookie is a session cookie, that is, the cookie is lost when the browser is closed.</span></span> <span data-ttu-id="744d1-272">當`true`，角色名稱 cookie 是永續性 cookie 可跨多個瀏覽器工作階段。</span><span class="sxs-lookup"><span data-stu-id="744d1-272">When `true`, the role-names cookie is a persistent cookie that is available across multiple browser sessions.</span></span> <span data-ttu-id="744d1-273">永續性 cookie 的到期日和時間設定為目前的日期和時間加上<xref:System.Web.Security.Roles.CookieTimeout%2A>以分鐘為單位的值。</span><span class="sxs-lookup"><span data-stu-id="744d1-273">The persistent cookie expiration date and time are set to the current date and time plus the <xref:System.Web.Security.Roles.CookieTimeout%2A> value in minutes.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CreateRole">
      <MemberSignature Language="C#" Value="public static void CreateRole (string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateRole(string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.CreateRole(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateRole (roleName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateRole(System::String ^ roleName);" />
      <MemberSignature Language="F#" Value="static member CreateRole : string -&gt; unit" Usage="System.Web.Security.Roles.CreateRole roleName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="744d1-274">The name of the role to create.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-274">The name of the role to create.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-275">Adds a new role to the data source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-275">Adds a new role to the data source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-276"><xref:System.Web.Security.Roles.CreateRole%2A>方法會將資料來源中的角色名稱。</span><span class="sxs-lookup"><span data-stu-id="744d1-276">The <xref:System.Web.Security.Roles.CreateRole%2A> method adds a role name to the data source.</span></span> <span data-ttu-id="744d1-277"><xref:System.Web.Security.Roles.CreateRole%2A> 呼叫<xref:System.Web.Security.RoleProvider.CreateRole%2A>預設角色提供者，將指定的角色新增至資料來源的方法。</span><span class="sxs-lookup"><span data-stu-id="744d1-277"><xref:System.Web.Security.Roles.CreateRole%2A> calls the <xref:System.Web.Security.RoleProvider.CreateRole%2A> method of the default role provider to add the specified role to the data source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="744d1-278">角色名稱不能包含逗號。</span><span class="sxs-lookup"><span data-stu-id="744d1-278">Role names cannot contain commas.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-279">下列程式碼範例會建立新的角色中的資料來源。</span><span class="sxs-lookup"><span data-stu-id="744d1-279">The following code example creates a new role in the data source.</span></span> <span data-ttu-id="744d1-280">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-280">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="744d1-281">此範例包含一個文字方塊，接受使用者輸入，也就是潛在的安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="744d1-281">This example contains a text box that accepts user input, which is a potential security threat.</span></span> <span data-ttu-id="744d1-282">根據預設，ASP.NET Web 網頁會驗證使用者輸入未包含指令碼或 HTML 項目。</span><span class="sxs-lookup"><span data-stu-id="744d1-282">By default, ASP.NET Web pages validate that user input does not include script or HTML elements.</span></span> <span data-ttu-id="744d1-283">如需詳細資訊，請參閱 [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07) (指令碼攻擊概觀)。</span><span class="sxs-lookup"><span data-stu-id="744d1-283">For more information, see [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07).</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/createrolecs.aspx#1)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/createrolevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-284">
            <paramref name="roleName" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-284">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-285">
            <paramref name="roleName" /> is an empty string.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-285">
              <paramref name="roleName" /> is an empty string.</span>
          </span>
          <span data-ttu-id="744d1-286">-or-  <paramref name="roleName" /> contains a comma.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-286">-or-  <paramref name="roleName" /> contains a comma.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-287">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-287">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="DeleteCookie">
      <MemberSignature Language="C#" Value="public static void DeleteCookie ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteCookie() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.DeleteCookie" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteCookie ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteCookie();" />
      <MemberSignature Language="F#" Value="static member DeleteCookie : unit -&gt; unit" Usage="System.Web.Security.Roles.DeleteCookie " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="744d1-288">Deletes the cookie where role names are cached.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-288">Deletes the cookie where role names are cached.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-289"><xref:System.Web.Security.Roles.DeleteCookie%2A>方法會清除是用來快取存放角色名稱 cookie 的內容。</span><span class="sxs-lookup"><span data-stu-id="744d1-289">The <xref:System.Web.Security.Roles.DeleteCookie%2A> method clears the contents of the cookie that is used to cache role names.</span></span> <span data-ttu-id="744d1-290">如需有關快取角色名稱的詳細資訊，請參閱<xref:System.Web.Security.Roles.CacheRolesInCookie%2A>。</span><span class="sxs-lookup"><span data-stu-id="744d1-290">For more information on caching role names, see <xref:System.Web.Security.Roles.CacheRolesInCookie%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-291">下列程式碼範例會呼叫<xref:System.Web.Security.Roles.DeleteCookie%2A>方法，以清除任何快取角色名稱，當使用者登入。</span><span class="sxs-lookup"><span data-stu-id="744d1-291">The following code example calls the <xref:System.Web.Security.Roles.DeleteCookie%2A> method to clear any cached role names when a user logs in.</span></span> <span data-ttu-id="744d1-292">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-292">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="744d1-293">此範例包含一個文字方塊，接受使用者輸入，也就是潛在的安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="744d1-293">This example contains a text box that accepts user input, which is a potential security threat.</span></span> <span data-ttu-id="744d1-294">根據預設，ASP.NET Web 網頁會驗證使用者輸入未包含指令碼或 HTML 項目。</span><span class="sxs-lookup"><span data-stu-id="744d1-294">By default, ASP.NET Web pages validate that user input does not include script or HTML elements.</span></span> <span data-ttu-id="744d1-295">如需詳細資訊，請參閱 [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07) (指令碼攻擊概觀)。</span><span class="sxs-lookup"><span data-stu-id="744d1-295">For more information, see [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07).</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/logincs.aspx#5)]
 [!code-aspx-vb[System.Web.Security.Roles#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/loginvb.aspx#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-296">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-296">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteRole">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-297">Removes a role from the data source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-297">Removes a role from the data source.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteRole">
      <MemberSignature Language="C#" Value="public static bool DeleteRole (string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool DeleteRole(string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.DeleteRole(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function DeleteRole (roleName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool DeleteRole(System::String ^ roleName);" />
      <MemberSignature Language="F#" Value="static member DeleteRole : string -&gt; bool" Usage="System.Web.Security.Roles.DeleteRole roleName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="744d1-298">The name of the role to delete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-298">The name of the role to delete.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-299">Removes a role from the data source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-299">Removes a role from the data source.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="744d1-300">
            <see langword="true" /> if <paramref name="roleName" /> was deleted from the data source; otherwise, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-300">
              <see langword="true" /> if <paramref name="roleName" /> was deleted from the data source; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-301"><xref:System.Web.Security.Roles.DeleteRole%2A>方法會移除資料來源中的角色名稱。</span><span class="sxs-lookup"><span data-stu-id="744d1-301">The <xref:System.Web.Security.Roles.DeleteRole%2A> method removes a role name from the data source.</span></span> <span data-ttu-id="744d1-302"><xref:System.Web.Security.Roles.DeleteRole%2A> 呼叫<xref:System.Web.Security.RoleProvider.DeleteRole%2A>方法的預設角色提供者，從資料來源中移除指定的角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-302"><xref:System.Web.Security.Roles.DeleteRole%2A> calls the <xref:System.Web.Security.RoleProvider.DeleteRole%2A> method of the default role provider to remove the specified role from the data source.</span></span>  
  
 <span data-ttu-id="744d1-303">如果所識別的角色`roleName`參數有一個或多個成員，則會擲回例外狀況和角色將不會刪除。</span><span class="sxs-lookup"><span data-stu-id="744d1-303">If the role identified by the `roleName` parameter has one or more members, then an exception will be thrown and the role will not be deleted.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-304">下列程式碼範例會從資料來源刪除角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-304">The following code example deletes a role from the data source.</span></span> <span data-ttu-id="744d1-305">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-305">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/deleterolecs.aspx#2)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/deleterolevb.aspx#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-306">
            <paramref name="roleName" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-306">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-307">
            <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-307">
              <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-308">
            <paramref name="roleName" /> has one or more members.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-308">
              <paramref name="roleName" /> has one or more members.</span>
          </span>
          <span data-ttu-id="744d1-309">-or-  Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-309">-or-  Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="DeleteRole">
      <MemberSignature Language="C#" Value="public static bool DeleteRole (string roleName, bool throwOnPopulatedRole);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool DeleteRole(string roleName, bool throwOnPopulatedRole) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.DeleteRole(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function DeleteRole (roleName As String, throwOnPopulatedRole As Boolean) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool DeleteRole(System::String ^ roleName, bool throwOnPopulatedRole);" />
      <MemberSignature Language="F#" Value="static member DeleteRole : string * bool -&gt; bool" Usage="System.Web.Security.Roles.DeleteRole (roleName, throwOnPopulatedRole)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
        <Parameter Name="throwOnPopulatedRole" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="744d1-310">The name of the role to delete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-310">The name of the role to delete.</span>
          </span>
        </param>
        <param name="throwOnPopulatedRole">
          <span data-ttu-id="744d1-311">If <see langword="true" />, throws an exception if <c>roleName</c> has one or more members.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-311">If <see langword="true" />, throws an exception if <c>roleName</c> has one or more members.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-312">Removes a role from the data source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-312">Removes a role from the data source.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="744d1-313">
            <see langword="true" /> if <paramref name="roleName" /> was deleted from the data source; otherwise; <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-313">
              <see langword="true" /> if <paramref name="roleName" /> was deleted from the data source; otherwise; <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-314"><xref:System.Web.Security.Roles.DeleteRole%2A>方法會移除資料來源中的角色名稱。</span><span class="sxs-lookup"><span data-stu-id="744d1-314">The <xref:System.Web.Security.Roles.DeleteRole%2A> method removes a role name from the data source.</span></span> <span data-ttu-id="744d1-315"><xref:System.Web.Security.Roles.DeleteRole%2A> 呼叫<xref:System.Web.Security.RoleProvider.DeleteRole%2A>方法的預設角色提供者，從資料來源中移除指定的角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-315"><xref:System.Web.Security.Roles.DeleteRole%2A> calls the <xref:System.Web.Security.RoleProvider.DeleteRole%2A> method of the default role provider to remove the specified role from the data source.</span></span>  
  
 <span data-ttu-id="744d1-316">如果`throwOnPopulatedRole`已`true`則會擲回例外狀況，角色將不會刪除，如果所識別的角色`roleName`參數有一個或多個成員。</span><span class="sxs-lookup"><span data-stu-id="744d1-316">If `throwOnPopulatedRole` is `true`, then an exception will be thrown and the role will not be deleted if the role identified by the `roleName` parameter has one or more members.</span></span> <span data-ttu-id="744d1-317">如果`throwOnPopulatedRole`是`false`，則無論是空白或不會刪除該角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-317">If `throwOnPopulatedRole` is `false`, then the role will be deleted whether it is empty or not.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-318">下列程式碼範例會從資料來源刪除角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-318">The following code example deletes a role from the data source.</span></span> <span data-ttu-id="744d1-319">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-319">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/deleterolecs.aspx#2)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/deleterolevb.aspx#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-320">
            <paramref name="roleName" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-320">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-321">
            <paramref name="roleName" /> is an empty string.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-321">
              <paramref name="roleName" /> is an empty string.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-322">
            <paramref name="roleName" /> has one or more members and <paramref name="throwOnPopulatedRole" /> is <see langword="true" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-322">
              <paramref name="roleName" /> has one or more members and <paramref name="throwOnPopulatedRole" /> is <see langword="true" />.</span>
          </span>
          <span data-ttu-id="744d1-323">-or-  Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-323">-or-  Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="Domain">
      <MemberSignature Language="C#" Value="public static string Domain { get; }" />
      <MemberSignature Language="ILAsm" Value=".property string Domain" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.Domain" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property Domain As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::String ^ Domain { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Domain : string" Usage="System.Web.Security.Roles.Domain" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-324">Gets the value of the domain of the role-names cookie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-324">Gets the value of the domain of the role-names cookie.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-325">
            <see cref="P:System.Web.HttpCookie.Domain" />的角色名稱 cookie。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-325">The <see cref="P:System.Web.HttpCookie.Domain" /> of the role names cookie.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-326"><xref:System.Web.Security.Roles.Domain%2A>屬性值會設定 ASP.NET 應用程式使用的組態中`domain`組態項目的屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-326">The <xref:System.Web.Security.Roles.Domain%2A> property value is set in the configuration for an ASP.NET application using the `domain` attribute of the  configuration element.</span></span>  
  
 <span data-ttu-id="744d1-327">如果未不指定任何值，在針對網域屬性，設定<xref:System.Web.Security.Roles.Domain%2A>屬性會傳回`null`且角色名稱 cookie 網域預設的行為<xref:System.Web.HttpCookie><xref:System.Web.HttpCookie.Domain%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-327">If no value is specified in the configuration for the domain attribute, the <xref:System.Web.Security.Roles.Domain%2A> property returns `null` and the role-names cookie domain defaults to the behavior of the <xref:System.Web.HttpCookie><xref:System.Web.HttpCookie.Domain%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Enabled">
      <MemberSignature Language="C#" Value="public static bool Enabled { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property bool Enabled" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.Enabled" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property Enabled As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool Enabled { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.Enabled : bool with get, set" Usage="System.Web.Security.Roles.Enabled" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-328">Gets or sets a value indicating whether role management is enabled for the current Web application.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-328">Gets or sets a value indicating whether role management is enabled for the current Web application.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-329">
            <see langword="true" /> 如果已啟用角色管理否則， <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-329">
              <see langword="true" /> if role management is enabled; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="744d1-330">預設值為 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-330">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="744d1-331">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="744d1-331">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="744d1-332">它會指定應用程式會使用<xref:System.Web.Security.SqlRoleProvider>執行個體和集合`enabled`屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="744d1-332">It specifies that the application uses a <xref:System.Web.Security.SqlRoleProvider> instance and sets the `enabled` attribute to `true`.</span></span>  
  
```  
<roleManager defaultProvider="SqlProvider"   
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/"  
  cookieRequireSSL="false"  
  cookieSlidingExpiration="true"  
  cookieProtection="All" >  
  <providers>  
    <add  
      name="SqlProvider"  
      type="System.Web.Security.SqlRoleProvider"  
      connectionStringName="SqlServices"  
      applicationName="MyApplication" />  
  </providers>  
</roleManager>  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="FindUsersInRole">
      <MemberSignature Language="C#" Value="public static string[] FindUsersInRole (string roleName, string usernameToMatch);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string[] FindUsersInRole(string roleName, string usernameToMatch) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.FindUsersInRole(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindUsersInRole (roleName As String, usernameToMatch As String) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::String ^&gt; ^ FindUsersInRole(System::String ^ roleName, System::String ^ usernameToMatch);" />
      <MemberSignature Language="F#" Value="static member FindUsersInRole : string * string -&gt; string[]" Usage="System.Web.Security.Roles.FindUsersInRole (roleName, usernameToMatch)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
        <Parameter Name="usernameToMatch" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="744d1-333">The role to search in.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-333">The role to search in.</span>
          </span>
        </param>
        <param name="usernameToMatch">
          <span data-ttu-id="744d1-334">The user name to search for.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-334">The user name to search for.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-335">Gets a list of users in a specified role where the user name contains the specified user name to match.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-335">Gets a list of users in a specified role where the user name contains the specified user name to match.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="744d1-336">A string array containing the names of all the users whose user name matches <paramref name="usernameToMatch" /> and who are members of the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-336">A string array containing the names of all the users whose user name matches <paramref name="usernameToMatch" /> and who are members of the specified role.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-337"><xref:System.Web.Security.Roles.FindUsersInRole%2A> 傳回在角色中的使用者清單，其中的使用者名稱包含提供的相符項目`usernameToMatch`已設定`applicationName`。</span><span class="sxs-lookup"><span data-stu-id="744d1-337"><xref:System.Web.Security.Roles.FindUsersInRole%2A> returns a list of users in a role where the user name contains a match of the supplied `usernameToMatch` for the configured `applicationName`.</span></span> <span data-ttu-id="744d1-338">例如，如果`usernameToMatch`參數設定為 「 使用者 」，則"user1"，"user2，""user3，「 使用者，並傳回等。</span><span class="sxs-lookup"><span data-stu-id="744d1-338">For example, if the `usernameToMatch` parameter is set to "user," then the users "user1," "user2," "user3," and so on are returned.</span></span> <span data-ttu-id="744d1-339">使用者會傳回依字母順序，依使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="744d1-339">Users are returned in alphabetical order by user name.</span></span>  
  
 <span data-ttu-id="744d1-340"><xref:System.Web.Security.SqlRoleProvider>會執行其搜尋服務中使用 LIKE 子句針對`usernameToMatch`參數。</span><span class="sxs-lookup"><span data-stu-id="744d1-340">The <xref:System.Web.Security.SqlRoleProvider> performs its search using a LIKE clause against the `usernameToMatch` parameter.</span></span> <span data-ttu-id="744d1-341">子句可用於像是 SQL Server 中支援任何萬用字元`usernameToMatch`參數值。</span><span class="sxs-lookup"><span data-stu-id="744d1-341">Any wildcards that are supported by SQL Server in LIKE clauses can be used in the `usernameToMatch` parameter value.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-342">下列程式碼範例使用<xref:System.Web.Security.Roles.FindUsersInRole%2A>根據使用者輸入的方法，以顯示角色成員資格。</span><span class="sxs-lookup"><span data-stu-id="744d1-342">The following code example uses the <xref:System.Web.Security.Roles.FindUsersInRole%2A> method to display role membership based on user input.</span></span> <span data-ttu-id="744d1-343">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-343">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="744d1-344">此範例包含一個文字方塊，接受使用者輸入，也就是潛在的安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="744d1-344">This example contains a text box that accepts user input, which is a potential security threat.</span></span> <span data-ttu-id="744d1-345">根據預設，ASP.NET Web 網頁會驗證使用者輸入未包含指令碼或 HTML 項目。</span><span class="sxs-lookup"><span data-stu-id="744d1-345">By default, ASP.NET Web pages validate that user input does not include script or HTML elements.</span></span> <span data-ttu-id="744d1-346">如需詳細資訊，請參閱 [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07) (指令碼攻擊概觀)。</span><span class="sxs-lookup"><span data-stu-id="744d1-346">For more information, see [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07).</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#11](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/FindUsersInRolecs.aspx#11)]
 [!code-aspx-vb[System.Web.Security.Roles#11](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/FindUsersInRolevb.aspx#11)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-347">
            <paramref name="roleName" /> is <see langword="null" /> (<see langword="Nothing" /> in Visual Basic).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-347">
              <paramref name="roleName" /> is <see langword="null" /> (<see langword="Nothing" /> in Visual Basic).</span>
          </span>
          <span data-ttu-id="744d1-348">-or-  <paramref name="usernameToMatch" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-348">-or-  <paramref name="usernameToMatch" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-349">
            <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-349">
              <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-350">-or-  <paramref name="usernameToMatch" /> is an empty string.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-350">-or-  <paramref name="usernameToMatch" /> is an empty string.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-351">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-351">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="GetAllRoles">
      <MemberSignature Language="C#" Value="public static string[] GetAllRoles ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string[] GetAllRoles() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.GetAllRoles" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetAllRoles () As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::String ^&gt; ^ GetAllRoles();" />
      <MemberSignature Language="F#" Value="static member GetAllRoles : unit -&gt; string[]" Usage="System.Web.Security.Roles.GetAllRoles " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="744d1-352">Gets a list of all the roles for the application.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-352">Gets a list of all the roles for the application.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="744d1-353">A string array containing the names of all the roles stored in the data source for the application.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-353">A string array containing the names of all the roles stored in the data source for the application.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-354"><xref:System.Web.Security.Roles.GetAllRoles%2A>方法呼叫<xref:System.Web.Security.RoleProvider.GetAllRoles%2A?displayProperty=nameWithType>方法來取得資料來源的所有角色的清單，應用程式的預設角色提供者。</span><span class="sxs-lookup"><span data-stu-id="744d1-354">The <xref:System.Web.Security.Roles.GetAllRoles%2A> method calls the <xref:System.Web.Security.RoleProvider.GetAllRoles%2A?displayProperty=nameWithType> method of the default role provider to get a list of all the roles from the data source for an application.</span></span> <span data-ttu-id="744d1-355">應用程式中指定的角色<xref:System.Web.Security.Roles.ApplicationName%2A>擷取屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-355">Only the roles for the application that is specified in the <xref:System.Web.Security.Roles.ApplicationName%2A> property are retrieved.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-356">下列程式碼範例會使用<xref:System.Web.Security.Roles.GetAllRoles%2A>方法來取得應用程式的角色清單，並繫結至結果<xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType>控制項。</span><span class="sxs-lookup"><span data-stu-id="744d1-356">The following code example uses the <xref:System.Web.Security.Roles.GetAllRoles%2A> method to get the list of roles for an application and bind the results to a <xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType> control.</span></span> <span data-ttu-id="744d1-357">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-357">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="744d1-358">此範例包含一個文字方塊，接受使用者輸入，也就是潛在的安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="744d1-358">This example contains a text box that accepts user input, which is a potential security threat.</span></span> <span data-ttu-id="744d1-359">根據預設，ASP.NET Web 網頁會驗證使用者輸入未包含指令碼或 HTML 項目。</span><span class="sxs-lookup"><span data-stu-id="744d1-359">By default, ASP.NET Web pages validate that user input does not include script or HTML elements.</span></span> <span data-ttu-id="744d1-360">如需詳細資訊，請參閱 [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07) (指令碼攻擊概觀)。</span><span class="sxs-lookup"><span data-stu-id="744d1-360">For more information, see [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07).</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/createrolecs.aspx#1)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/createrolevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-361">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-361">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetRolesForUser">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-362">Gets a list of the roles that a user is in.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-362">Gets a list of the roles that a user is in.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetRolesForUser">
      <MemberSignature Language="C#" Value="public static string[] GetRolesForUser ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string[] GetRolesForUser() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.GetRolesForUser" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetRolesForUser () As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::String ^&gt; ^ GetRolesForUser();" />
      <MemberSignature Language="F#" Value="static member GetRolesForUser : unit -&gt; string[]" Usage="System.Web.Security.Roles.GetRolesForUser " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="744d1-363">Gets a list of the roles that the currently logged-on user is in.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-363">Gets a list of the roles that the currently logged-on user is in.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="744d1-364">A string array containing the names of all the roles that the currently logged-on user is in.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-364">A string array containing the names of all the roles that the currently logged-on user is in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-365"><xref:System.Web.Security.Roles.GetRolesForUser%2A>方法呼叫<xref:System.Web.Security.RoleProvider.GetRolesForUser%2A?displayProperty=nameWithType>方法的預設角色提供者，以擷取從資料來源的目前登入使用者的角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-365">The <xref:System.Web.Security.Roles.GetRolesForUser%2A> method calls the <xref:System.Web.Security.RoleProvider.GetRolesForUser%2A?displayProperty=nameWithType> method of the default role provider to retrieve from the data source the roles that the currently logged-on user is in.</span></span> <span data-ttu-id="744d1-366">目前登入的使用者由<xref:System.Web.HttpContext.User%2A?displayProperty=nameWithType>屬性的目前<xref:System.Web.HttpContext?displayProperty=nameWithType>，或由<xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType>非 http 裝載環境。</span><span class="sxs-lookup"><span data-stu-id="744d1-366">The currently logged-on user is identified by the <xref:System.Web.HttpContext.User%2A?displayProperty=nameWithType> property of the current <xref:System.Web.HttpContext?displayProperty=nameWithType>, or by <xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType> for non-HTTP hosting environments.</span></span> <span data-ttu-id="744d1-367">如果沒有使用者登入，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="744d1-367">If no user is logged on, an exception will be thrown.</span></span> <span data-ttu-id="744d1-368">應用程式中指定的角色<xref:System.Web.Security.Roles.ApplicationName%2A>擷取屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-368">Only the roles for the application that is specified in the <xref:System.Web.Security.Roles.ApplicationName%2A> property are retrieved.</span></span>  
  
 <span data-ttu-id="744d1-369">如果<xref:System.Web.Security.Roles.CacheRolesInCookie%2A>已`true`，然後將<xref:System.Web.Security.Roles.GetRolesForUser%2A>方法可能會傳回從角色內快取，而不是指定的角色提供者。</span><span class="sxs-lookup"><span data-stu-id="744d1-369">If <xref:System.Web.Security.Roles.CacheRolesInCookie%2A> is `true`, then the results of the <xref:System.Web.Security.Roles.GetRolesForUser%2A> method may be returned from the role cache rather than the specified role provider.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-370">下列程式碼範例會使用<xref:System.Web.Security.Roles.GetRolesForUser%2A>方法來擷取指定使用者角色的清單，並將傳回的角色，以繫結<xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType>控制項。</span><span class="sxs-lookup"><span data-stu-id="744d1-370">The following code example uses the <xref:System.Web.Security.Roles.GetRolesForUser%2A> method to retrieve a list of roles for a specified user and bind the returned roles to a <xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType> control.</span></span> <span data-ttu-id="744d1-371">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-371">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/ViewRolescs.aspx#4)]
 [!code-aspx-vb[System.Web.Security.Roles#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/ViewRolesvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-372">There is no current logged-on user.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-372">There is no current logged-on user.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-373">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-373">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="GetRolesForUser">
      <MemberSignature Language="C#" Value="public static string[] GetRolesForUser (string username);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string[] GetRolesForUser(string username) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.GetRolesForUser(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetRolesForUser (username As String) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::String ^&gt; ^ GetRolesForUser(System::String ^ username);" />
      <MemberSignature Language="F#" Value="static member GetRolesForUser : string -&gt; string[]" Usage="System.Web.Security.Roles.GetRolesForUser username" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">
          <span data-ttu-id="744d1-374">The user to return a list of roles for.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-374">The user to return a list of roles for.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-375">Gets a list of the roles that a user is in.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-375">Gets a list of the roles that a user is in.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="744d1-376">A string array containing the names of all the roles that the specified user is in.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-376">A string array containing the names of all the roles that the specified user is in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-377"><xref:System.Web.Security.Roles.GetRolesForUser%2A>方法呼叫<xref:System.Web.Security.RoleProvider.GetRolesForUser%2A?displayProperty=nameWithType>方法的預設角色提供者，以擷取從資料來源的使用者角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-377">The <xref:System.Web.Security.Roles.GetRolesForUser%2A> method calls the <xref:System.Web.Security.RoleProvider.GetRolesForUser%2A?displayProperty=nameWithType> method of the default role provider to retrieve from the data source the roles that the user is in.</span></span> <span data-ttu-id="744d1-378">應用程式中指定的角色<xref:System.Web.Security.Roles.ApplicationName%2A>擷取屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-378">Only the roles for the application that is specified in the <xref:System.Web.Security.Roles.ApplicationName%2A> property are retrieved.</span></span>  
  
 <span data-ttu-id="744d1-379">如果`username`是否等於目前的登入的使用者和<xref:System.Web.Security.Roles.CacheRolesInCookie%2A>是`true`，結果<xref:System.Web.Security.Roles.GetRolesForUser%2A>方法可能會傳回從角色內快取而非指定<xref:System.Web.Security.Roles.Provider%2A>。</span><span class="sxs-lookup"><span data-stu-id="744d1-379">If `username` is equal to the current logged-on user and <xref:System.Web.Security.Roles.CacheRolesInCookie%2A> is `true`, the results of the <xref:System.Web.Security.Roles.GetRolesForUser%2A> method may be returned from the role cache rather than the specified <xref:System.Web.Security.Roles.Provider%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-380">下列程式碼範例會使用<xref:System.Web.Security.Roles.GetRolesForUser%2A>方法來擷取指定使用者角色的清單，並將傳回的角色，以繫結<xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType>控制項。</span><span class="sxs-lookup"><span data-stu-id="744d1-380">The following code example uses the <xref:System.Web.Security.Roles.GetRolesForUser%2A> method to retrieve a list of roles for a specified user and bind the returned roles to a <xref:System.Web.UI.WebControls.GridView?displayProperty=nameWithType> control.</span></span> <span data-ttu-id="744d1-381">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-381">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/ViewRolescs.aspx#4)]
 [!code-aspx-vb[System.Web.Security.Roles#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/ViewRolesvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-382">
            <paramref name="username" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-382">
              <paramref name="username" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-383">
            <paramref name="username" /> contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-383">
              <paramref name="username" /> contains a comma (,).</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-384">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-384">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="GetUsersInRole">
      <MemberSignature Language="C#" Value="public static string[] GetUsersInRole (string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string[] GetUsersInRole(string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.GetUsersInRole(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetUsersInRole (roleName As String) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::String ^&gt; ^ GetUsersInRole(System::String ^ roleName);" />
      <MemberSignature Language="F#" Value="static member GetUsersInRole : string -&gt; string[]" Usage="System.Web.Security.Roles.GetUsersInRole roleName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="744d1-385">The role to get the list of users for.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-385">The role to get the list of users for.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-386">Gets a list of users in the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-386">Gets a list of users in the specified role.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="744d1-387">A string array containing the names of all the users who are members of the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-387">A string array containing the names of all the users who are members of the specified role.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-388"><xref:System.Web.Security.Roles.GetUsersInRole%2A>方法呼叫<xref:System.Web.Security.RoleProvider.GetUsersInRole%2A>方法來擷取從資料來源的角色相關聯的使用者名稱的預設角色提供者。</span><span class="sxs-lookup"><span data-stu-id="744d1-388">The <xref:System.Web.Security.Roles.GetUsersInRole%2A> method calls the <xref:System.Web.Security.RoleProvider.GetUsersInRole%2A> method of the default role provider to retrieve the user names associated with a role from the data source.</span></span> <span data-ttu-id="744d1-389">應用程式中指定的角色<xref:System.Web.Security.Roles.ApplicationName%2A>擷取屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-389">Only the roles for the application that is specified in the <xref:System.Web.Security.Roles.ApplicationName%2A> property are retrieved.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-390">下列程式碼範例會使用<xref:System.Web.Security.Roles.GetUsersInRole%2A>方法來取得特定角色的使用者清單，並繫結至結果<xref:System.Web.UI.WebControls.GridView>控制項。</span><span class="sxs-lookup"><span data-stu-id="744d1-390">The following code example uses the <xref:System.Web.Security.Roles.GetUsersInRole%2A> method to get a list of the users in a particular role and binds the results to a <xref:System.Web.UI.WebControls.GridView> control.</span></span> <span data-ttu-id="744d1-391">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-391">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/adduserstorolecs.aspx#3)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/adduserstorolevb.aspx#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-392">
            <paramref name="roleName" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-392">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-393">
            <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-393">
              <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-394">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-394">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="IsUserInRole">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-395">Gets a value indicating whether a user is in the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-395">Gets a value indicating whether a user is in the specified role.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="IsUserInRole">
      <MemberSignature Language="C#" Value="public static bool IsUserInRole (string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool IsUserInRole(string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.IsUserInRole(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function IsUserInRole (roleName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool IsUserInRole(System::String ^ roleName);" />
      <MemberSignature Language="F#" Value="static member IsUserInRole : string -&gt; bool" Usage="System.Web.Security.Roles.IsUserInRole roleName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="744d1-396">The name of the role to search in.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-396">The name of the role to search in.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-397">Gets a value indicating whether the currently logged-on user is in the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-397">Gets a value indicating whether the currently logged-on user is in the specified role.</span>
          </span>
          <span data-ttu-id="744d1-398">The API is only intended to be called within the context of an ASP.NET request thread, and in that sanctioned use case it is thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-398">The API is only intended to be called within the context of an ASP.NET request thread, and in that sanctioned use case it is thread-safe.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="744d1-399">
            <see langword="true" /> if the currently logged-on user is in the specified role; otherwise, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-399">
              <see langword="true" /> if the currently logged-on user is in the specified role; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-400"><xref:System.Web.Security.Roles.IsUserInRole%2A>方法呼叫<xref:System.Web.Security.RoleProvider.IsUserInRole%2A?displayProperty=nameWithType>方法來判斷目前登入的使用者是否來自應用程式的資料來源中指定的角色相關聯的預設角色提供者<xref:System.Web.Security.Roles.ApplicationName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-400">The <xref:System.Web.Security.Roles.IsUserInRole%2A> method calls the <xref:System.Web.Security.RoleProvider.IsUserInRole%2A?displayProperty=nameWithType> method of the default role provider to determine whether the currently logged-on user is associated with a role from the data source for the application that is specified in the <xref:System.Web.Security.Roles.ApplicationName%2A> property.</span></span> <span data-ttu-id="744d1-401">目前登入的使用者由<xref:System.Web.HttpContext.User%2A?displayProperty=nameWithType>屬性的目前<xref:System.Web.HttpContext?displayProperty=nameWithType>，或由<xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType>非 http 裝載環境。</span><span class="sxs-lookup"><span data-stu-id="744d1-401">The currently logged-on user is identified by the <xref:System.Web.HttpContext.User%2A?displayProperty=nameWithType> property of the current <xref:System.Web.HttpContext?displayProperty=nameWithType>, or by <xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType> for non-HTTP hosting environments.</span></span> <span data-ttu-id="744d1-402">如果沒有使用者登入，就會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="744d1-402">If no user is logged on, an exception will be thrown.</span></span> <span data-ttu-id="744d1-403">應用程式中指定的角色<xref:System.Web.Security.Roles.ApplicationName%2A>擷取屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-403">Only the roles for the application that is specified in the <xref:System.Web.Security.Roles.ApplicationName%2A> property are retrieved.</span></span>  
  
 <span data-ttu-id="744d1-404">如果<xref:System.Web.Security.Roles.CacheRolesInCookie%2A>已`true`，然後`roleName`可能核對角色快取，而不是指定的角色提供者。</span><span class="sxs-lookup"><span data-stu-id="744d1-404">If <xref:System.Web.Security.Roles.CacheRolesInCookie%2A> is `true`, then `roleName` may be checked against the roles cache rather than the specified role provider.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-405">下列程式碼範例以程式設計方式檢查目前登入的使用者是否在系統管理員角色中，然後才允許使用者檢視應用程式的角色設定。</span><span class="sxs-lookup"><span data-stu-id="744d1-405">The following code example programmatically checks whether the currently logged-on user is in the Administrators role before allowing the user to view roles settings for the application.</span></span> <span data-ttu-id="744d1-406">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-406">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/ViewRolescs.aspx#4)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/ViewRolesvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-407">
            <paramref name="roleName" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-407">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="744d1-408">-or-  There is no current logged-on user.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-408">-or-  There is no current logged-on user.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-409">
            <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-409">
              <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-410">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-410">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="IsUserInRole">
      <MemberSignature Language="C#" Value="public static bool IsUserInRole (string username, string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool IsUserInRole(string username, string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.IsUserInRole(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function IsUserInRole (username As String, roleName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool IsUserInRole(System::String ^ username, System::String ^ roleName);" />
      <MemberSignature Language="F#" Value="static member IsUserInRole : string * string -&gt; bool" Usage="System.Web.Security.Roles.IsUserInRole (username, roleName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">
          <span data-ttu-id="744d1-411">The name of the user to search for.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-411">The name of the user to search for.</span>
          </span>
        </param>
        <param name="roleName">
          <span data-ttu-id="744d1-412">The name of the role to search in.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-412">The name of the role to search in.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-413">Gets a value indicating whether the specified user is in the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-413">Gets a value indicating whether the specified user is in the specified role.</span>
          </span>
          <span data-ttu-id="744d1-414">The API is only intended to be called within the context of an ASP.NET request thread, and in that sanctioned use case it is thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-414">The API is only intended to be called within the context of an ASP.NET request thread, and in that sanctioned use case it is thread-safe.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="744d1-415">
            <see langword="true" /> if the specified user is in the specified role; otherwise, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-415">
              <see langword="true" /> if the specified user is in the specified role; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-416"><xref:System.Web.Security.Roles.IsUserInRole%2A>方法呼叫<xref:System.Web.Security.RoleProvider.IsUserInRole%2A>方法來判斷是否來自應用程式的資料來源中指定的角色相關聯的使用者名稱的預設角色提供者<xref:System.Web.Security.Roles.ApplicationName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-416">The <xref:System.Web.Security.Roles.IsUserInRole%2A> method calls the <xref:System.Web.Security.RoleProvider.IsUserInRole%2A> method of the default role provider to determine whether a user name is associated with a role from the data source for the application that is specified in the <xref:System.Web.Security.Roles.ApplicationName%2A> property.</span></span>  
  
 <span data-ttu-id="744d1-417">如果`username`是否等於目前的登入的使用者和<xref:System.Web.Security.Roles.CacheRolesInCookie%2A>屬性值是`true`，`roleName`可能核對角色快取，而非指定<xref:System.Web.Security.Roles.Provider%2A>。</span><span class="sxs-lookup"><span data-stu-id="744d1-417">If `username` is equal to the current logged-on user and the <xref:System.Web.Security.Roles.CacheRolesInCookie%2A> property value is `true`, `roleName` may be checked against the role cache rather than the specified <xref:System.Web.Security.Roles.Provider%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-418">下列程式碼範例以程式設計方式檢查使用者是否在系統管理員角色中，然後才允許使用者檢視應用程式的角色設定。</span><span class="sxs-lookup"><span data-stu-id="744d1-418">The following code example programmatically checks whether a user is in the Administrators role before allowing the user to view roles settings for the application.</span></span> <span data-ttu-id="744d1-419">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-419">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/ViewRolescs.aspx#4)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/ViewRolesvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-420">
            <paramref name="roleName" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-420">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="744d1-421">-or-  <paramref name="username" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-421">-or-  <paramref name="username" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-422">
            <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-422">
              <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-423">-or-  <paramref name="username" /> contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-423">-or-  <paramref name="username" /> contains a comma (,).</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-424">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-424">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="MaxCachedResults">
      <MemberSignature Language="C#" Value="public static int MaxCachedResults { get; }" />
      <MemberSignature Language="ILAsm" Value=".property int32 MaxCachedResults" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.MaxCachedResults" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property MaxCachedResults As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property int MaxCachedResults { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MaxCachedResults : int" Usage="System.Web.Security.Roles.MaxCachedResults" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-425">Gets the maximum number of role names to be cached for a user.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-425">Gets the maximum number of role names to be cached for a user.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-426">要為使用者快取角色名稱的最大數目。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-426">The maximum number of role names to be cached for a user.</span>
          </span>
          <span data-ttu-id="744d1-427">預設值為 25。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-427">The default is 25.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-428"><xref:System.Web.Security.Roles.MaxCachedResults%2A>屬性設定使用`maxCachedResults`組態屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-428">The <xref:System.Web.Security.Roles.MaxCachedResults%2A> property is set using the `maxCachedResults` configuration attribute.</span></span> <span data-ttu-id="744d1-429">值`maxCachedResults`組態屬性必須設為整數的值小於或等於零。</span><span class="sxs-lookup"><span data-stu-id="744d1-429">The value of the `maxCachedResults` configuration attribute must be set to an integer value greater than zero.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-430">下列範例示範中的項目`system.web`的 ASP.NET 應用程式的 Web.config 檔案區段。</span><span class="sxs-lookup"><span data-stu-id="744d1-430">The following example shows the  element in the `system.web` section of the Web.config file for an ASP.NET application.</span></span> <span data-ttu-id="744d1-431">它會指定應用程式會使用<xref:System.Web.Security.SqlRoleProvider>執行個體和設定`maxCachedResults`屬性設定為 10。</span><span class="sxs-lookup"><span data-stu-id="744d1-431">It specifies that the application uses a <xref:System.Web.Security.SqlRoleProvider> instance and sets the `maxCachedResults` attribute to 10.</span></span>  
  
```  
<roleManager  
  enabled="true"  
  cacheRolesInCookie="true"  
  cookieName=".ASPROLES"  
  cookieTimeout="30"  
  cookiePath="/"  
  cookieRequireSSL="false"  
  cookieSlidingExpiration="true"  
  cookieProtection="All"   
  maxCachedResults="10" />  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Provider">
      <MemberSignature Language="C#" Value="public static System.Web.Security.RoleProvider Provider { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Web.Security.RoleProvider Provider" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.Provider" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property Provider As RoleProvider" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Web::Security::RoleProvider ^ Provider { System::Web::Security::RoleProvider ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Provider : System.Web.Security.RoleProvider" Usage="System.Web.Security.Roles.Provider" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.RoleProvider</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-432">Gets the default role provider for the application.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-432">Gets the default role provider for the application.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-433">應用程式，其會公開為繼承的類別的預設角色提供者<see cref="T:System.Web.Security.RoleProvider" />抽象類別。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-433">The default role provider for the application, which is exposed as a class that inherits the <see cref="T:System.Web.Security.RoleProvider" /> abstract class.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-434"><xref:System.Web.Security.Roles.Provider%2A>屬性可讓您直接參考應用程式的預設角色提供者。</span><span class="sxs-lookup"><span data-stu-id="744d1-434">The <xref:System.Web.Security.Roles.Provider%2A> property enables you to directly reference the default role provider for an application.</span></span> <span data-ttu-id="744d1-435">這通常用來存取自訂的角色提供者的成員不屬於<xref:System.Web.Security.RoleProvider>抽象類別。</span><span class="sxs-lookup"><span data-stu-id="744d1-435">This is commonly used to access custom members of the role provider that are not part of the <xref:System.Web.Security.RoleProvider> abstract class.</span></span>  
  
 <span data-ttu-id="744d1-436">例如，<xref:System.Web.Security.WindowsTokenRoleProvider>類別包含的多載<xref:System.Web.Security.WindowsTokenRoleProvider.IsUserInRole%2A>方法，可讓您判斷使用者是否在常見的 Windows 角色中，使用<xref:System.Security.Principal.WindowsBuiltInRole>列舉值。</span><span class="sxs-lookup"><span data-stu-id="744d1-436">For example, the <xref:System.Web.Security.WindowsTokenRoleProvider> class includes an overload of the <xref:System.Web.Security.WindowsTokenRoleProvider.IsUserInRole%2A> method that enables you to determine whether a user is in a common Windows role by using a <xref:System.Security.Principal.WindowsBuiltInRole> enumeration value.</span></span> <span data-ttu-id="744d1-437">參考<xref:System.Web.Security.WindowsTokenRoleProvider>類別可取得應用程式，請使用<xref:System.Web.Security.Roles.Provider%2A>屬性，且可以轉換成<xref:System.Web.Security.WindowsTokenRoleProvider>為了參考<xref:System.Web.Security.WindowsTokenRoleProvider.IsUserInRole%2A>多載。</span><span class="sxs-lookup"><span data-stu-id="744d1-437">A reference to the <xref:System.Web.Security.WindowsTokenRoleProvider> class for an application can be obtained by using the <xref:System.Web.Security.Roles.Provider%2A> property and can be cast as a <xref:System.Web.Security.WindowsTokenRoleProvider> in order to refer to the <xref:System.Web.Security.WindowsTokenRoleProvider.IsUserInRole%2A> overload.</span></span>  
  
 <span data-ttu-id="744d1-438">如果多個角色提供者設定應用程式，您可以存取不同的角色提供者使用<xref:System.Web.Security.Roles.Providers%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="744d1-438">If multiple role providers are configured for an application, you can access different role providers using the <xref:System.Web.Security.Roles.Providers%2A> collection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-439">下列程式碼範例會轉換為預設角色提供者<xref:System.Web.Security.WindowsTokenRoleProvider>並檢查目前登入的使用者是否在系統管理員角色中，然後才允許使用者檢視應用程式的角色設定。</span><span class="sxs-lookup"><span data-stu-id="744d1-439">The following code example casts the default role provider as a <xref:System.Web.Security.WindowsTokenRoleProvider> and checks whether the currently logged-on user is in the Administrators role before allowing the user to view roles settings for the application.</span></span> <span data-ttu-id="744d1-440">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.WindowsTokenRoleProvider>。</span><span class="sxs-lookup"><span data-stu-id="744d1-440">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.WindowsTokenRoleProvider>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.WindowsTokenRoleProvider#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.WindowsTokenRoleProvider/CS/ViewRoles2cs.aspx#2)]
 [!code-aspx-vb[System.Web.Security.WindowsTokenRoleProvider#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.WindowsTokenRoleProvider/VB/ViewRoles2vb.aspx#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-441">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-441">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="Providers">
      <MemberSignature Language="C#" Value="public static System.Web.Security.RoleProviderCollection Providers { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Web.Security.RoleProviderCollection Providers" />
      <MemberSignature Language="DocId" Value="P:System.Web.Security.Roles.Providers" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property Providers As RoleProviderCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Web::Security::RoleProviderCollection ^ Providers { System::Web::Security::RoleProviderCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Providers : System.Web.Security.RoleProviderCollection" Usage="System.Web.Security.Roles.Providers" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Security.RoleProviderCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="744d1-442">Gets a collection of the role providers for the ASP.NET application.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-442">Gets a collection of the role providers for the ASP.NET application.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="744d1-443">A <see cref="T:System.Web.Security.RoleProviderCollection" /> ，其中包含為 ASP.NET 應用程式設定的角色提供者。</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-443">A <see cref="T:System.Web.Security.RoleProviderCollection" /> that contains the role providers configured for the ASP.NET application.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-444"><xref:System.Web.Security.Roles.Providers%2A>屬性會參考所有啟用的應用程式的角色提供者，包括任何提供者加入 Web.config 檔案中。</span><span class="sxs-lookup"><span data-stu-id="744d1-444">The <xref:System.Web.Security.Roles.Providers%2A> property references all the role providers enabled for an application, including any providers added in the Web.config file.</span></span> <span data-ttu-id="744d1-445">您可以使用哪些角色提供者是適用於應用程式來控制`providers`中您的應用程式的 Web.config 檔案區段的項目。</span><span class="sxs-lookup"><span data-stu-id="744d1-445">You can control which role providers are available for an application by using the `providers` element of the  section in the Web.config file for your application.</span></span>  
  
 <span data-ttu-id="744d1-446">下列範例顯示移除任何現有的提供者 （例如在 Machine.config 檔案中指定的那些） 區段，並將<xref:System.Web.Security.SqlRoleProvider>與應用程式的角色提供者執行個體。</span><span class="sxs-lookup"><span data-stu-id="744d1-446">The following example shows a  section that removes any existing providers (such as those specified in the Machine.config file) and adds a <xref:System.Web.Security.SqlRoleProvider> instance as the role provider for the application.</span></span>  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="SqlServices" connectionString="Data Source=MySqlServer;Integrated Security=SSPI;Initial Catalog=aspnetdb;" />  
  </connectionStrings>  
  
  <system.web>  
    <roleManager defaultProvider="SqlProvider"   
      enabled="true"  
      cacheRolesInCookie="true"  
      cookieName=".ASPROLES"  
      cookieTimeout="30"  
      cookiePath="/"  
      cookieRequireSSL="false"  
      cookieSlidingExpiration="true"  
      cookieProtection="Encrypted">  
  
      <providers>  
        <clear/>  
        <add  
          name="SqlProvider"  
          type="System.Web.Security.SqlRoleProvider"  
          connectionStringName="SqlServices"  
          applicationName="MyApplication" />  
         </providers>  
  
    </roleManager>  
  </system.web>  
</configuration>  
```  
  
 <span data-ttu-id="744d1-447">您可以取得的提供者的強型別的參考<xref:System.Web.Security.Roles.Providers%2A>集合中依名稱編製索引的角色提供者，並將它轉型為所需的類型。</span><span class="sxs-lookup"><span data-stu-id="744d1-447">You can obtain a strongly typed reference to a provider from the <xref:System.Web.Security.Roles.Providers%2A> collection by indexing the role provider by name and casting it as the desired type.</span></span>  
  
 <span data-ttu-id="744d1-448">您可以取得應用程式使用的預設提供者的參考<xref:System.Web.Security.Roles.Provider%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-448">You can obtain a reference to the default provider for an application using the <xref:System.Web.Security.Roles.Provider%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-449">下列程式碼範例會列出啟用應用程式和其各自的型別提供者。</span><span class="sxs-lookup"><span data-stu-id="744d1-449">The following code example lists the providers enabled for an application and their respective types.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#7](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/Providerscs.aspx#7)]
 [!code-aspx-vb[System.Web.Security.Roles#7](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/Providersvb.aspx#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-450">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-450">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="RemoveUserFromRole">
      <MemberSignature Language="C#" Value="public static void RemoveUserFromRole (string username, string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RemoveUserFromRole(string username, string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.RemoveUserFromRole(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub RemoveUserFromRole (username As String, roleName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void RemoveUserFromRole(System::String ^ username, System::String ^ roleName);" />
      <MemberSignature Language="F#" Value="static member RemoveUserFromRole : string * string -&gt; unit" Usage="System.Web.Security.Roles.RemoveUserFromRole (username, roleName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="username">
          <span data-ttu-id="744d1-451">The user to remove from the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-451">The user to remove from the specified role.</span>
          </span>
        </param>
        <param name="roleName">
          <span data-ttu-id="744d1-452">The role to remove the specified user from.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-452">The role to remove the specified user from.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-453">Removes the specified user from the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-453">Removes the specified user from the specified role.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-454"><xref:System.Web.Security.Roles.RemoveUserFromRole%2A>方法會呼叫預設角色提供者，從指定的角色，在資料來源中移除指定的使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-454">The <xref:System.Web.Security.Roles.RemoveUserFromRole%2A> method calls the default role provider to remove the specified user from the specified role at the data source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-455">下列程式碼範例會從角色移除使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-455">The following code example removes a user from a role.</span></span> <span data-ttu-id="744d1-456">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-456">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/adduserstorolecs.aspx#3)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/adduserstorolevb.aspx#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-457">
            <paramref name="roleName" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-457">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="744d1-458">-or-  <paramref name="username" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-458">-or-  <paramref name="username" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-459">
            <paramref name="roleName" /> is an empty string or contains a comma (,)  <paramref name="username" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-459">
              <paramref name="roleName" /> is an empty string or contains a comma (,)  <paramref name="username" /> is an empty string or contains a comma (,).</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-460">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-460">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="RemoveUserFromRoles">
      <MemberSignature Language="C#" Value="public static void RemoveUserFromRoles (string username, string[] roleNames);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RemoveUserFromRoles(string username, string[] roleNames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.RemoveUserFromRoles(System.String,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub RemoveUserFromRoles (username As String, roleNames As String())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void RemoveUserFromRoles(System::String ^ username, cli::array &lt;System::String ^&gt; ^ roleNames);" />
      <MemberSignature Language="F#" Value="static member RemoveUserFromRoles : string * string[] -&gt; unit" Usage="System.Web.Security.Roles.RemoveUserFromRoles (username, roleNames)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="username" Type="System.String" />
        <Parameter Name="roleNames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="username">
          <span data-ttu-id="744d1-461">The user to remove from the specified roles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-461">The user to remove from the specified roles.</span>
          </span>
        </param>
        <param name="roleNames">
          <span data-ttu-id="744d1-462">A string array of role names to remove the specified user from.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-462">A string array of role names to remove the specified user from.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-463">Removes the specified user from the specified roles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-463">Removes the specified user from the specified roles.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-464"><xref:System.Web.Security.Roles.RemoveUserFromRoles%2A>方法會呼叫預設角色提供者，從指定的角色，在資料來源中移除指定的使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-464">The <xref:System.Web.Security.Roles.RemoveUserFromRoles%2A> method calls the default role provider to remove the specified user from the specified roles at the data source.</span></span>  
  
 <span data-ttu-id="744d1-465">如果應用程式設定為使用<xref:System.Web.Security.SqlRoleProvider>類別，會在呼叫期間執行資料庫更新<xref:System.Web.Security.Roles.RemoveUserFromRoles%2A>方法會在交易內進行。</span><span class="sxs-lookup"><span data-stu-id="744d1-465">If the application is configured to use the <xref:System.Web.Security.SqlRoleProvider> class, the database updates that are performed during the call to the <xref:System.Web.Security.Roles.RemoveUserFromRoles%2A> method are made within a transaction.</span></span> <span data-ttu-id="744d1-466">如果發生錯誤，例如使用者名稱不在指定的角色中，會回復交易，並會執行任何更新。</span><span class="sxs-lookup"><span data-stu-id="744d1-466">If an error is encountered, such as a user name that is not in a specified role, the transaction is rolled back and no updates are performed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-467">下列程式碼範例使用<xref:System.Web.Security.Roles.RemoveUserFromRoles%2A>方法來移除一或多個角色的使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-467">The following code example uses the <xref:System.Web.Security.Roles.RemoveUserFromRoles%2A> method to remove a user from one or more roles.</span></span> <span data-ttu-id="744d1-468">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-468">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#10](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/RemoveUserFromRolescs.aspx#10)]
 [!code-aspx-vb[System.Web.Security.Roles#10](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/RemoveUserFromRolesvb.aspx#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-469">One of the roles in <paramref name="roleNames" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-469">One of the roles in <paramref name="roleNames" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="744d1-470">-or-  <paramref name="username" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-470">-or-  <paramref name="username" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-471">One of the roles in <paramref name="roleNames" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-471">One of the roles in <paramref name="roleNames" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-472">-or-  <paramref name="username" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-472">-or-  <paramref name="username" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-473">-or-  <paramref name="roleNames" /> contains a duplicate element.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-473">-or-  <paramref name="roleNames" /> contains a duplicate element.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-474">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-474">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="RemoveUsersFromRole">
      <MemberSignature Language="C#" Value="public static void RemoveUsersFromRole (string[] usernames, string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RemoveUsersFromRole(string[] usernames, string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.RemoveUsersFromRole(System.String[],System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub RemoveUsersFromRole (usernames As String(), roleName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void RemoveUsersFromRole(cli::array &lt;System::String ^&gt; ^ usernames, System::String ^ roleName);" />
      <MemberSignature Language="F#" Value="static member RemoveUsersFromRole : string[] * string -&gt; unit" Usage="System.Web.Security.Roles.RemoveUsersFromRole (usernames, roleName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernames" Type="System.String[]" />
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="usernames">
          <span data-ttu-id="744d1-475">A string array of user names to remove from the specified roles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-475">A string array of user names to remove from the specified roles.</span>
          </span>
        </param>
        <param name="roleName">
          <span data-ttu-id="744d1-476">The name of the role to remove the specified users from.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-476">The name of the role to remove the specified users from.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-477">Removes the specified users from the specified role.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-477">Removes the specified users from the specified role.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-478"><xref:System.Web.Security.Roles.RemoveUsersFromRole%2A>方法會呼叫預設角色提供者，從指定的角色，在資料來源中移除指定的使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-478">The <xref:System.Web.Security.Roles.RemoveUsersFromRole%2A> method calls the default role provider to remove the specified users from the specified role at the data source.</span></span>  
  
 <span data-ttu-id="744d1-479">如果應用程式使用<xref:System.Web.Security.SqlRoleProvider>類別，會在呼叫期間執行資料庫更新<xref:System.Web.Security.SqlRoleProvider.RemoveUsersFromRoles%2A>方法會在交易內進行。</span><span class="sxs-lookup"><span data-stu-id="744d1-479">If the application uses the <xref:System.Web.Security.SqlRoleProvider> class, the database updates that are performed during the call to the <xref:System.Web.Security.SqlRoleProvider.RemoveUsersFromRoles%2A> method are made within a transaction.</span></span> <span data-ttu-id="744d1-480">如果發生錯誤，例如使用者名稱不在指定的角色中，會回復交易，並會執行任何更新。</span><span class="sxs-lookup"><span data-stu-id="744d1-480">If an error is encountered, such as a user name that is not in a specified role, the transaction is rolled back and no updates are performed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-481">下列程式碼範例使用<xref:System.Web.Security.Roles.RemoveUsersFromRole%2A>方法來移除角色中的一個或多個使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-481">The following code example uses the <xref:System.Web.Security.Roles.RemoveUsersFromRole%2A> method to remove one or more users from a role.</span></span> <span data-ttu-id="744d1-482">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-482">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#9](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/RemoveUsersFromRolecs.aspx#9)]
 [!code-aspx-vb[System.Web.Security.Roles#9](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/RemoveUsersFromRolevb.aspx#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-483">
            <paramref name="roleName" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-483">
              <paramref name="roleName" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="744d1-484">-or-  One of the user names in <paramref name="usernames" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-484">-or-  One of the user names in <paramref name="usernames" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-485">
            <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-485">
              <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-486">-or-  One of the user names in <paramref name="usernames" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-486">-or-  One of the user names in <paramref name="usernames" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-487">-or-  <paramref name="usernames" /> contains a duplicate element.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-487">-or-  <paramref name="usernames" /> contains a duplicate element.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-488">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-488">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="RemoveUsersFromRoles">
      <MemberSignature Language="C#" Value="public static void RemoveUsersFromRoles (string[] usernames, string[] roleNames);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RemoveUsersFromRoles(string[] usernames, string[] roleNames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.RemoveUsersFromRoles(System.String[],System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub RemoveUsersFromRoles (usernames As String(), roleNames As String())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void RemoveUsersFromRoles(cli::array &lt;System::String ^&gt; ^ usernames, cli::array &lt;System::String ^&gt; ^ roleNames);" />
      <MemberSignature Language="F#" Value="static member RemoveUsersFromRoles : string[] * string[] -&gt; unit" Usage="System.Web.Security.Roles.RemoveUsersFromRoles (usernames, roleNames)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernames" Type="System.String[]" />
        <Parameter Name="roleNames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="usernames">
          <span data-ttu-id="744d1-489">A string array of user names to remove from the specified roles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-489">A string array of user names to remove from the specified roles.</span>
          </span>
        </param>
        <param name="roleNames">
          <span data-ttu-id="744d1-490">A string array of role names to remove the specified users from.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-490">A string array of role names to remove the specified users from.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-491">Removes the specified user names from the specified roles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-491">Removes the specified user names from the specified roles.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-492"><xref:System.Web.Security.Roles.RemoveUsersFromRoles%2A>方法會呼叫預設角色提供者，從指定的角色，在資料來源中移除指定的使用者。</span><span class="sxs-lookup"><span data-stu-id="744d1-492">The <xref:System.Web.Security.Roles.RemoveUsersFromRoles%2A> method calls the default role provider to remove the specified users from the specified roles at the data source.</span></span>  
  
 <span data-ttu-id="744d1-493">如果應用程式使用<xref:System.Web.Security.SqlRoleProvider>類別，會在呼叫期間執行資料庫更新<xref:System.Web.Security.SqlRoleProvider.RemoveUsersFromRoles%2A>方法會在交易內進行。</span><span class="sxs-lookup"><span data-stu-id="744d1-493">If the application uses the <xref:System.Web.Security.SqlRoleProvider> class, the database updates that are performed during the call to the <xref:System.Web.Security.SqlRoleProvider.RemoveUsersFromRoles%2A> method are made within a transaction.</span></span> <span data-ttu-id="744d1-494">如果發生錯誤，例如使用者名稱不在指定的角色中，會回復交易，並會執行任何更新。</span><span class="sxs-lookup"><span data-stu-id="744d1-494">If an error is encountered, such as a user name that is not in a specified role, the transaction is rolled back and no updates are performed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-495">下列程式碼範例使用<xref:System.Web.Security.Roles.RemoveUsersFromRoles%2A>方法，以從一或多個角色中移除一個或多個使用者根據使用者輸入。</span><span class="sxs-lookup"><span data-stu-id="744d1-495">The following code example uses the <xref:System.Web.Security.Roles.RemoveUsersFromRoles%2A> method to remove one or more users from one or more roles based on user input.</span></span> <span data-ttu-id="744d1-496">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-496">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.Roles#8](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.Roles/CS/RemoveUsersFromRolescs.aspx#8)]
 [!code-aspx-vb[System.Web.Security.Roles#8](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.Roles/VB/RemoveUsersFromRolesvb.aspx#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-497">One of the roles specified in <paramref name="roleNames" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-497">One of the roles specified in <paramref name="roleNames" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="744d1-498">-or-  One of the users specified in <paramref name="usernames" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-498">-or-  One of the users specified in <paramref name="usernames" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-499">One of the roles specified in <paramref name="roleNames" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-499">One of the roles specified in <paramref name="roleNames" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-500">-or-  One of the users specified in <paramref name="usernames" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-500">-or-  One of the users specified in <paramref name="usernames" /> is an empty string or contains a comma (,).</span>
          </span>
          <span data-ttu-id="744d1-501">-or-  <paramref name="roleNames" /> contains a duplicate element.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-501">-or-  <paramref name="roleNames" /> contains a duplicate element.</span>
          </span>
          <span data-ttu-id="744d1-502">-or-  <paramref name="usernames" /> contains a duplicate element.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-502">-or-  <paramref name="usernames" /> contains a duplicate element.</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-503">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-503">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="RoleExists">
      <MemberSignature Language="C#" Value="public static bool RoleExists (string roleName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool RoleExists(string roleName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Security.Roles.RoleExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function RoleExists (roleName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool RoleExists(System::String ^ roleName);" />
      <MemberSignature Language="F#" Value="static member RoleExists : string -&gt; bool" Usage="System.Web.Security.Roles.RoleExists roleName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="roleName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="roleName">
          <span data-ttu-id="744d1-504">The name of the role to search for in the data source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-504">The name of the role to search for in the data source.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="744d1-505">Gets a value indicating whether the specified role name already exists in the role data source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-505">Gets a value indicating whether the specified role name already exists in the role data source.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="744d1-506">
            <see langword="true" /> if the role name already exists in the data source; otherwise, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-506">
              <see langword="true" /> if the role name already exists in the data source; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="744d1-507"><xref:System.Web.Security.Roles.RoleExists%2A>方法呼叫`RoleExists`方法來判斷角色名稱是否存在於應用程式的資料來源中指定的預設角色提供者<xref:System.Web.Security.Roles.ApplicationName%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="744d1-507">The <xref:System.Web.Security.Roles.RoleExists%2A> method calls the `RoleExists` method of the default role provider to determine whether a role name exists in the data source for the application that is specified in the <xref:System.Web.Security.Roles.ApplicationName%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="744d1-508">下列程式碼範例使用<xref:System.Web.Security.Roles.RoleExists%2A>方法，以判斷角色名稱是否已經存在之前建立的角色。</span><span class="sxs-lookup"><span data-stu-id="744d1-508">The following code example uses the <xref:System.Web.Security.Roles.RoleExists%2A> method to determine whether a role name already exists before creating the role.</span></span> <span data-ttu-id="744d1-509">如需啟用角色管理的 Web.config 檔案的範例，請參閱<xref:System.Web.Security.Roles>。</span><span class="sxs-lookup"><span data-stu-id="744d1-509">For an example of a Web.config file that enables role management, see <xref:System.Web.Security.Roles>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="744d1-510">此範例包含一個文字方塊，接受使用者輸入，也就是潛在的安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="744d1-510">This example contains a text box that accepts user input, which is a potential security threat.</span></span> <span data-ttu-id="744d1-511">根據預設，ASP.NET Web 網頁會驗證使用者輸入未包含指令碼或 HTML 項目。</span><span class="sxs-lookup"><span data-stu-id="744d1-511">By default, ASP.NET Web pages validate that user input does not include script or HTML elements.</span></span> <span data-ttu-id="744d1-512">如需詳細資訊，請參閱 [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07) (指令碼攻擊概觀)。</span><span class="sxs-lookup"><span data-stu-id="744d1-512">For more information, see [Script Exploits Overview](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07).</span></span>  
  
 [!code-aspx-csharp[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/CS/createrolecs.aspx#1)]
 [!code-aspx-vb[System.Web.Security.SqlRoleProvider#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Security.SqlRoleProvider/VB/createrolevb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="744d1-513">
            <paramref name="roleName" /> is <see langword="null" /> (<see langword="Nothing" /> in Visual Basic).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-513">
              <paramref name="roleName" /> is <see langword="null" /> (<see langword="Nothing" /> in Visual Basic).</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="744d1-514">
            <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-514">
              <paramref name="roleName" /> is an empty string or contains a comma (,).</span>
          </span>
        </exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">
          <span data-ttu-id="744d1-515">Role management is not enabled.</span>
          <span class="sxs-lookup">
            <span data-stu-id="744d1-515">Role management is not enabled.</span>
          </span>
        </exception>
      </Docs>
    </Member>
  </Members>
</Type>